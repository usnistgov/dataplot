       SUBROUTINE DRTU1(ICHARN,IOP,X,Y,NUMCO,IXMINS,IXMAXS,IXDELS,
     1                  IBUGD2,IFOUND,IERROR)
C
C     PURPOSE--DEFINE AND SET THE HERSHEY CHARACTER SET COORDINATES
C              FOR ROMAN TRIPLEX UPPER CASE (PART 1).
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--87/4
C     ORIGINAL VERSION (AS A SEPARATE SUBROUTINE)--MARCH     1981.
C     UPDATED         --MAY       1982.
C     UPDATED         --MARCH     1987.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 IOP
      CHARACTER*4 IBUGD2
      CHARACTER*4 IFOUND
      CHARACTER*4 IERROR
C
      CHARACTER*4 IOPERA
C
C---------------------------------------------------------------------
C
      DIMENSION IOP(*)
      DIMENSION X(*)
      DIMENSION Y(*)
C
      DIMENSION IOPERA(300)
      DIMENSION IX(300)
      DIMENSION IY(300)
C
      DIMENSION IXMIND(30)
      DIMENSION IXMAXD(30)
      DIMENSION IXDELD(30)
      DIMENSION ISTARD(30)
      DIMENSION NUMCOO(30)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----DATA STATEMENTS-------------------------------------------------
C
C     DEFINE CHARACTER   3001--UPPER CASE A
C
      DATA IOPERA(   1),IX(   1),IY(   1)/'MOVE',   0,  12/
      DATA IOPERA(   2),IX(   2),IY(   2)/'DRAW',  -7,  -8/
      DATA IOPERA(   3),IX(   3),IY(   3)/'MOVE',  -1,   9/
      DATA IOPERA(   4),IX(   4),IY(   4)/'DRAW',   5,  -9/
      DATA IOPERA(   5),IX(   5),IY(   5)/'MOVE',   0,   9/
      DATA IOPERA(   6),IX(   6),IY(   6)/'DRAW',   6,  -9/
      DATA IOPERA(   7),IX(   7),IY(   7)/'MOVE',   0,  12/
      DATA IOPERA(   8),IX(   8),IY(   8)/'DRAW',   7,  -9/
      DATA IOPERA(   9),IX(   9),IY(   9)/'MOVE',  -5,  -3/
      DATA IOPERA(  10),IX(  10),IY(  10)/'DRAW',   4,  -3/
      DATA IOPERA(  11),IX(  11),IY(  11)/'MOVE',  -9,  -9/
      DATA IOPERA(  12),IX(  12),IY(  12)/'DRAW',  -3,  -9/
      DATA IOPERA(  13),IX(  13),IY(  13)/'MOVE',   2,  -9/
      DATA IOPERA(  14),IX(  14),IY(  14)/'DRAW',   9,  -9/
      DATA IOPERA(  15),IX(  15),IY(  15)/'MOVE',  -7,  -8/
      DATA IOPERA(  16),IX(  16),IY(  16)/'DRAW',  -8,  -9/
      DATA IOPERA(  17),IX(  17),IY(  17)/'MOVE',  -7,  -8/
      DATA IOPERA(  18),IX(  18),IY(  18)/'DRAW',  -5,  -9/
      DATA IOPERA(  19),IX(  19),IY(  19)/'MOVE',   5,  -8/
      DATA IOPERA(  20),IX(  20),IY(  20)/'DRAW',   3,  -9/
      DATA IOPERA(  21),IX(  21),IY(  21)/'MOVE',   5,  -7/
      DATA IOPERA(  22),IX(  22),IY(  22)/'DRAW',   4,  -9/
      DATA IOPERA(  23),IX(  23),IY(  23)/'MOVE',   6,  -7/
      DATA IOPERA(  24),IX(  24),IY(  24)/'DRAW',   8,  -9/
C
      DATA IXMIND(   1)/ -10/
      DATA IXMAXD(   1)/  10/
      DATA IXDELD(   1)/  20/
      DATA ISTARD(   1)/   1/
      DATA NUMCOO(   1)/  24/
C
C     DEFINE CHARACTER   3002--UPPER CASE B
C
      DATA IOPERA(  25),IX(  25),IY(  25)/'MOVE',  -6,  12/
      DATA IOPERA(  26),IX(  26),IY(  26)/'DRAW',  -6,  -9/
      DATA IOPERA(  27),IX(  27),IY(  27)/'MOVE',  -5,  11/
      DATA IOPERA(  28),IX(  28),IY(  28)/'DRAW',  -5,  -8/
      DATA IOPERA(  29),IX(  29),IY(  29)/'MOVE',  -4,  12/
      DATA IOPERA(  30),IX(  30),IY(  30)/'DRAW',  -4,  -9/
      DATA IOPERA(  31),IX(  31),IY(  31)/'MOVE',  -9,  12/
      DATA IOPERA(  32),IX(  32),IY(  32)/'DRAW',   3,  12/
      DATA IOPERA(  33),IX(  33),IY(  33)/'DRAW',   6,  11/
      DATA IOPERA(  34),IX(  34),IY(  34)/'DRAW',   7,  10/
      DATA IOPERA(  35),IX(  35),IY(  35)/'DRAW',   8,   8/
      DATA IOPERA(  36),IX(  36),IY(  36)/'DRAW',   8,   6/
      DATA IOPERA(  37),IX(  37),IY(  37)/'DRAW',   7,   4/
      DATA IOPERA(  38),IX(  38),IY(  38)/'DRAW',   6,   3/
      DATA IOPERA(  39),IX(  39),IY(  39)/'DRAW',   3,   2/
      DATA IOPERA(  40),IX(  40),IY(  40)/'MOVE',   6,  10/
      DATA IOPERA(  41),IX(  41),IY(  41)/'DRAW',   7,   8/
      DATA IOPERA(  42),IX(  42),IY(  42)/'DRAW',   7,   6/
      DATA IOPERA(  43),IX(  43),IY(  43)/'DRAW',   6,   4/
      DATA IOPERA(  44),IX(  44),IY(  44)/'MOVE',   3,  12/
      DATA IOPERA(  45),IX(  45),IY(  45)/'DRAW',   5,  11/
      DATA IOPERA(  46),IX(  46),IY(  46)/'DRAW',   6,   9/
      DATA IOPERA(  47),IX(  47),IY(  47)/'DRAW',   6,   5/
      DATA IOPERA(  48),IX(  48),IY(  48)/'DRAW',   5,   3/
      DATA IOPERA(  49),IX(  49),IY(  49)/'DRAW',   3,   2/
      DATA IOPERA(  50),IX(  50),IY(  50)/'MOVE',  -4,   2/
      DATA IOPERA(  51),IX(  51),IY(  51)/'DRAW',   3,   2/
      DATA IOPERA(  52),IX(  52),IY(  52)/'DRAW',   6,   1/
      DATA IOPERA(  53),IX(  53),IY(  53)/'DRAW',   7,   0/
      DATA IOPERA(  54),IX(  54),IY(  54)/'DRAW',   8,  -2/
      DATA IOPERA(  55),IX(  55),IY(  55)/'DRAW',   8,  -5/
      DATA IOPERA(  56),IX(  56),IY(  56)/'DRAW',   7,  -7/
      DATA IOPERA(  57),IX(  57),IY(  57)/'DRAW',   6,  -8/
      DATA IOPERA(  58),IX(  58),IY(  58)/'DRAW',   3,  -9/
      DATA IOPERA(  59),IX(  59),IY(  59)/'DRAW',  -9,  -9/
      DATA IOPERA(  60),IX(  60),IY(  60)/'MOVE',   6,   0/
      DATA IOPERA(  61),IX(  61),IY(  61)/'DRAW',   7,  -2/
      DATA IOPERA(  62),IX(  62),IY(  62)/'DRAW',   7,  -5/
      DATA IOPERA(  63),IX(  63),IY(  63)/'DRAW',   6,  -7/
      DATA IOPERA(  64),IX(  64),IY(  64)/'MOVE',   3,   2/
      DATA IOPERA(  65),IX(  65),IY(  65)/'DRAW',   5,   1/
      DATA IOPERA(  66),IX(  66),IY(  66)/'DRAW',   6,  -1/
      DATA IOPERA(  67),IX(  67),IY(  67)/'DRAW',   6,  -6/
      DATA IOPERA(  68),IX(  68),IY(  68)/'DRAW',   5,  -8/
      DATA IOPERA(  69),IX(  69),IY(  69)/'DRAW',   3,  -9/
      DATA IOPERA(  70),IX(  70),IY(  70)/'MOVE',  -8,  12/
      DATA IOPERA(  71),IX(  71),IY(  71)/'DRAW',  -6,  11/
      DATA IOPERA(  72),IX(  72),IY(  72)/'MOVE',  -7,  12/
      DATA IOPERA(  73),IX(  73),IY(  73)/'DRAW',  -6,  10/
      DATA IOPERA(  74),IX(  74),IY(  74)/'MOVE',  -3,  12/
      DATA IOPERA(  75),IX(  75),IY(  75)/'DRAW',  -4,  10/
      DATA IOPERA(  76),IX(  76),IY(  76)/'MOVE',  -2,  12/
      DATA IOPERA(  77),IX(  77),IY(  77)/'DRAW',  -4,  11/
      DATA IOPERA(  78),IX(  78),IY(  78)/'MOVE',  -6,  -8/
      DATA IOPERA(  79),IX(  79),IY(  79)/'DRAW',  -8,  -9/
      DATA IOPERA(  80),IX(  80),IY(  80)/'MOVE',  -6,  -7/
      DATA IOPERA(  81),IX(  81),IY(  81)/'DRAW',  -7,  -9/
      DATA IOPERA(  82),IX(  82),IY(  82)/'MOVE',  -4,  -7/
      DATA IOPERA(  83),IX(  83),IY(  83)/'DRAW',  -3,  -9/
      DATA IOPERA(  84),IX(  84),IY(  84)/'MOVE',  -4,  -8/
      DATA IOPERA(  85),IX(  85),IY(  85)/'DRAW',  -2,  -9/
C
      DATA IXMIND(   2)/ -11/
      DATA IXMAXD(   2)/  11/
      DATA IXDELD(   2)/  22/
      DATA ISTARD(   2)/  25/
      DATA NUMCOO(   2)/  61/
C
C     DEFINE CHARACTER   3003--UPPER CASE C
C
      DATA IOPERA(  86),IX(  86),IY(  86)/'MOVE',   6,   9/
      DATA IOPERA(  87),IX(  87),IY(  87)/'DRAW',   7,  12/
      DATA IOPERA(  88),IX(  88),IY(  88)/'DRAW',   7,   6/
      DATA IOPERA(  89),IX(  89),IY(  89)/'DRAW',   6,   9/
      DATA IOPERA(  90),IX(  90),IY(  90)/'DRAW',   4,  11/
      DATA IOPERA(  91),IX(  91),IY(  91)/'DRAW',   2,  12/
      DATA IOPERA(  92),IX(  92),IY(  92)/'DRAW',  -1,  12/
      DATA IOPERA(  93),IX(  93),IY(  93)/'DRAW',  -4,  11/
      DATA IOPERA(  94),IX(  94),IY(  94)/'DRAW',  -6,   9/
      DATA IOPERA(  95),IX(  95),IY(  95)/'DRAW',  -7,   7/
      DATA IOPERA(  96),IX(  96),IY(  96)/'DRAW',  -8,   4/
      DATA IOPERA(  97),IX(  97),IY(  97)/'DRAW',  -8,  -1/
      DATA IOPERA(  98),IX(  98),IY(  98)/'DRAW',  -7,  -4/
      DATA IOPERA(  99),IX(  99),IY(  99)/'DRAW',  -6,  -6/
      DATA IOPERA( 100),IX( 100),IY( 100)/'DRAW',  -4,  -8/
      DATA IOPERA( 101),IX( 101),IY( 101)/'DRAW',  -1,  -9/
      DATA IOPERA( 102),IX( 102),IY( 102)/'DRAW',   2,  -9/
      DATA IOPERA( 103),IX( 103),IY( 103)/'DRAW',   4,  -8/
      DATA IOPERA( 104),IX( 104),IY( 104)/'DRAW',   6,  -6/
      DATA IOPERA( 105),IX( 105),IY( 105)/'DRAW',   7,  -4/
      DATA IOPERA( 106),IX( 106),IY( 106)/'MOVE',  -5,   9/
      DATA IOPERA( 107),IX( 107),IY( 107)/'DRAW',  -6,   7/
      DATA IOPERA( 108),IX( 108),IY( 108)/'DRAW',  -7,   4/
      DATA IOPERA( 109),IX( 109),IY( 109)/'DRAW',  -7,  -1/
      DATA IOPERA( 110),IX( 110),IY( 110)/'DRAW',  -6,  -4/
      DATA IOPERA( 111),IX( 111),IY( 111)/'DRAW',  -5,  -6/
      DATA IOPERA( 112),IX( 112),IY( 112)/'MOVE',  -1,  12/
      DATA IOPERA( 113),IX( 113),IY( 113)/'DRAW',  -3,  11/
      DATA IOPERA( 114),IX( 114),IY( 114)/'DRAW',  -5,   8/
      DATA IOPERA( 115),IX( 115),IY( 115)/'DRAW',  -6,   4/
      DATA IOPERA( 116),IX( 116),IY( 116)/'DRAW',  -6,  -1/
      DATA IOPERA( 117),IX( 117),IY( 117)/'DRAW',  -5,  -5/
      DATA IOPERA( 118),IX( 118),IY( 118)/'DRAW',  -3,  -8/
      DATA IOPERA( 119),IX( 119),IY( 119)/'DRAW',  -1,  -9/
C
      DATA IXMIND(   3)/ -11/
      DATA IXMAXD(   3)/  10/
      DATA IXDELD(   3)/  21/
      DATA ISTARD(   3)/  86/
      DATA NUMCOO(   3)/  34/
C
C     DEFINE CHARACTER   3004--UPPER CASE D
C
      DATA IOPERA( 120),IX( 120),IY( 120)/'MOVE',  -6,  12/
      DATA IOPERA( 121),IX( 121),IY( 121)/'DRAW',  -6,  -9/
      DATA IOPERA( 122),IX( 122),IY( 122)/'MOVE',  -5,  11/
      DATA IOPERA( 123),IX( 123),IY( 123)/'DRAW',  -5,  -8/
      DATA IOPERA( 124),IX( 124),IY( 124)/'MOVE',  -4,  12/
      DATA IOPERA( 125),IX( 125),IY( 125)/'DRAW',  -4,  -9/
      DATA IOPERA( 126),IX( 126),IY( 126)/'MOVE',  -9,  12/
      DATA IOPERA( 127),IX( 127),IY( 127)/'DRAW',   1,  12/
      DATA IOPERA( 128),IX( 128),IY( 128)/'DRAW',   4,  11/
      DATA IOPERA( 129),IX( 129),IY( 129)/'DRAW',   6,   9/
      DATA IOPERA( 130),IX( 130),IY( 130)/'DRAW',   7,   7/
      DATA IOPERA( 131),IX( 131),IY( 131)/'DRAW',   8,   4/
      DATA IOPERA( 132),IX( 132),IY( 132)/'DRAW',   8,  -1/
      DATA IOPERA( 133),IX( 133),IY( 133)/'DRAW',   7,  -4/
      DATA IOPERA( 134),IX( 134),IY( 134)/'DRAW',   6,  -6/
      DATA IOPERA( 135),IX( 135),IY( 135)/'DRAW',   4,  -8/
      DATA IOPERA( 136),IX( 136),IY( 136)/'DRAW',   1,  -9/
      DATA IOPERA( 137),IX( 137),IY( 137)/'DRAW',  -9,  -9/
      DATA IOPERA( 138),IX( 138),IY( 138)/'MOVE',   5,   9/
      DATA IOPERA( 139),IX( 139),IY( 139)/'DRAW',   6,   7/
      DATA IOPERA( 140),IX( 140),IY( 140)/'DRAW',   7,   4/
      DATA IOPERA( 141),IX( 141),IY( 141)/'DRAW',   7,  -1/
      DATA IOPERA( 142),IX( 142),IY( 142)/'DRAW',   6,  -4/
      DATA IOPERA( 143),IX( 143),IY( 143)/'DRAW',   5,  -6/
      DATA IOPERA( 144),IX( 144),IY( 144)/'MOVE',   1,  12/
      DATA IOPERA( 145),IX( 145),IY( 145)/'DRAW',   3,  11/
      DATA IOPERA( 146),IX( 146),IY( 146)/'DRAW',   5,   8/
      DATA IOPERA( 147),IX( 147),IY( 147)/'DRAW',   6,   4/
      DATA IOPERA( 148),IX( 148),IY( 148)/'DRAW',   6,  -1/
      DATA IOPERA( 149),IX( 149),IY( 149)/'DRAW',   5,  -5/
      DATA IOPERA( 150),IX( 150),IY( 150)/'DRAW',   3,  -8/
      DATA IOPERA( 151),IX( 151),IY( 151)/'DRAW',   1,  -9/
      DATA IOPERA( 152),IX( 152),IY( 152)/'MOVE',  -8,  12/
      DATA IOPERA( 153),IX( 153),IY( 153)/'DRAW',  -6,  11/
      DATA IOPERA( 154),IX( 154),IY( 154)/'MOVE',  -7,  12/
      DATA IOPERA( 155),IX( 155),IY( 155)/'DRAW',  -6,  10/
      DATA IOPERA( 156),IX( 156),IY( 156)/'MOVE',  -3,  12/
      DATA IOPERA( 157),IX( 157),IY( 157)/'DRAW',  -4,  10/
      DATA IOPERA( 158),IX( 158),IY( 158)/'MOVE',  -2,  12/
      DATA IOPERA( 159),IX( 159),IY( 159)/'DRAW',  -4,  11/
      DATA IOPERA( 160),IX( 160),IY( 160)/'MOVE',  -6,  -8/
      DATA IOPERA( 161),IX( 161),IY( 161)/'DRAW',  -8,  -9/
      DATA IOPERA( 162),IX( 162),IY( 162)/'MOVE',  -6,  -7/
      DATA IOPERA( 163),IX( 163),IY( 163)/'DRAW',  -7,  -9/
      DATA IOPERA( 164),IX( 164),IY( 164)/'MOVE',  -4,  -7/
      DATA IOPERA( 165),IX( 165),IY( 165)/'DRAW',  -3,  -9/
      DATA IOPERA( 166),IX( 166),IY( 166)/'MOVE',  -4,  -8/
      DATA IOPERA( 167),IX( 167),IY( 167)/'DRAW',  -2,  -9/
C
      DATA IXMIND(   4)/ -11/
      DATA IXMAXD(   4)/  11/
      DATA IXDELD(   4)/  22/
      DATA ISTARD(   4)/ 120/
      DATA NUMCOO(   4)/  48/
C
C     DEFINE CHARACTER   3005--UPPER CASE E
C
      DATA IOPERA( 168),IX( 168),IY( 168)/'MOVE',  -6,  12/
      DATA IOPERA( 169),IX( 169),IY( 169)/'DRAW',  -6,  -9/
      DATA IOPERA( 170),IX( 170),IY( 170)/'MOVE',  -5,  11/
      DATA IOPERA( 171),IX( 171),IY( 171)/'DRAW',  -5,  -8/
      DATA IOPERA( 172),IX( 172),IY( 172)/'MOVE',  -4,  12/
      DATA IOPERA( 173),IX( 173),IY( 173)/'DRAW',  -4,  -9/
      DATA IOPERA( 174),IX( 174),IY( 174)/'MOVE',  -9,  12/
      DATA IOPERA( 175),IX( 175),IY( 175)/'DRAW',   7,  12/
      DATA IOPERA( 176),IX( 176),IY( 176)/'DRAW',   7,   6/
      DATA IOPERA( 177),IX( 177),IY( 177)/'MOVE',  -4,   2/
      DATA IOPERA( 178),IX( 178),IY( 178)/'DRAW',   2,   2/
      DATA IOPERA( 179),IX( 179),IY( 179)/'MOVE',   2,   6/
      DATA IOPERA( 180),IX( 180),IY( 180)/'DRAW',   2,  -2/
      DATA IOPERA( 181),IX( 181),IY( 181)/'MOVE',  -9,  -9/
      DATA IOPERA( 182),IX( 182),IY( 182)/'DRAW',   7,  -9/
      DATA IOPERA( 183),IX( 183),IY( 183)/'DRAW',   7,  -3/
      DATA IOPERA( 184),IX( 184),IY( 184)/'MOVE',  -8,  12/
      DATA IOPERA( 185),IX( 185),IY( 185)/'DRAW',  -6,  11/
      DATA IOPERA( 186),IX( 186),IY( 186)/'MOVE',  -7,  12/
      DATA IOPERA( 187),IX( 187),IY( 187)/'DRAW',  -6,  10/
      DATA IOPERA( 188),IX( 188),IY( 188)/'MOVE',  -3,  12/
      DATA IOPERA( 189),IX( 189),IY( 189)/'DRAW',  -4,  10/
      DATA IOPERA( 190),IX( 190),IY( 190)/'MOVE',  -2,  12/
      DATA IOPERA( 191),IX( 191),IY( 191)/'DRAW',  -4,  11/
      DATA IOPERA( 192),IX( 192),IY( 192)/'MOVE',   2,  12/
      DATA IOPERA( 193),IX( 193),IY( 193)/'DRAW',   7,  11/
      DATA IOPERA( 194),IX( 194),IY( 194)/'MOVE',   4,  12/
      DATA IOPERA( 195),IX( 195),IY( 195)/'DRAW',   7,  10/
      DATA IOPERA( 196),IX( 196),IY( 196)/'MOVE',   5,  12/
      DATA IOPERA( 197),IX( 197),IY( 197)/'DRAW',   7,   9/
      DATA IOPERA( 198),IX( 198),IY( 198)/'MOVE',   6,  12/
      DATA IOPERA( 199),IX( 199),IY( 199)/'DRAW',   7,   6/
      DATA IOPERA( 200),IX( 200),IY( 200)/'MOVE',   2,   6/
      DATA IOPERA( 201),IX( 201),IY( 201)/'DRAW',   1,   2/
      DATA IOPERA( 202),IX( 202),IY( 202)/'DRAW',   2,  -2/
      DATA IOPERA( 203),IX( 203),IY( 203)/'MOVE',   2,   4/
      DATA IOPERA( 204),IX( 204),IY( 204)/'DRAW',   0,   2/
      DATA IOPERA( 205),IX( 205),IY( 205)/'DRAW',   2,   0/
      DATA IOPERA( 206),IX( 206),IY( 206)/'MOVE',   2,   3/
      DATA IOPERA( 207),IX( 207),IY( 207)/'DRAW',  -2,   2/
      DATA IOPERA( 208),IX( 208),IY( 208)/'DRAW',   2,   1/
      DATA IOPERA( 209),IX( 209),IY( 209)/'MOVE',  -6,  -8/
      DATA IOPERA( 210),IX( 210),IY( 210)/'DRAW',  -8,  -9/
      DATA IOPERA( 211),IX( 211),IY( 211)/'MOVE',  -6,  -7/
      DATA IOPERA( 212),IX( 212),IY( 212)/'DRAW',  -7,  -9/
      DATA IOPERA( 213),IX( 213),IY( 213)/'MOVE',  -4,  -7/
      DATA IOPERA( 214),IX( 214),IY( 214)/'DRAW',  -3,  -9/
      DATA IOPERA( 215),IX( 215),IY( 215)/'MOVE',  -4,  -8/
      DATA IOPERA( 216),IX( 216),IY( 216)/'DRAW',  -2,  -9/
      DATA IOPERA( 217),IX( 217),IY( 217)/'MOVE',   2,  -9/
      DATA IOPERA( 218),IX( 218),IY( 218)/'DRAW',   7,  -8/
      DATA IOPERA( 219),IX( 219),IY( 219)/'MOVE',   4,  -9/
      DATA IOPERA( 220),IX( 220),IY( 220)/'DRAW',   7,  -7/
      DATA IOPERA( 221),IX( 221),IY( 221)/'MOVE',   5,  -9/
      DATA IOPERA( 222),IX( 222),IY( 222)/'DRAW',   7,  -6/
      DATA IOPERA( 223),IX( 223),IY( 223)/'MOVE',   6,  -9/
      DATA IOPERA( 224),IX( 224),IY( 224)/'DRAW',   7,  -3/
C
      DATA IXMIND(   5)/ -11/
      DATA IXMAXD(   5)/  10/
      DATA IXDELD(   5)/  21/
      DATA ISTARD(   5)/ 168/
      DATA NUMCOO(   5)/  57/
C
C     DEFINE CHARACTER   3006--UPPER CASE F
C
      DATA IOPERA( 225),IX( 225),IY( 225)/'MOVE',  -6,  12/
      DATA IOPERA( 226),IX( 226),IY( 226)/'DRAW',  -6,  -9/
      DATA IOPERA( 227),IX( 227),IY( 227)/'MOVE',  -5,  11/
      DATA IOPERA( 228),IX( 228),IY( 228)/'DRAW',  -5,  -8/
      DATA IOPERA( 229),IX( 229),IY( 229)/'MOVE',  -4,  12/
      DATA IOPERA( 230),IX( 230),IY( 230)/'DRAW',  -4,  -9/
      DATA IOPERA( 231),IX( 231),IY( 231)/'MOVE',  -9,  12/
      DATA IOPERA( 232),IX( 232),IY( 232)/'DRAW',   7,  12/
      DATA IOPERA( 233),IX( 233),IY( 233)/'DRAW',   7,   6/
      DATA IOPERA( 234),IX( 234),IY( 234)/'MOVE',  -4,   2/
      DATA IOPERA( 235),IX( 235),IY( 235)/'DRAW',   2,   2/
      DATA IOPERA( 236),IX( 236),IY( 236)/'MOVE',   2,   6/
      DATA IOPERA( 237),IX( 237),IY( 237)/'DRAW',   2,  -2/
      DATA IOPERA( 238),IX( 238),IY( 238)/'MOVE',  -9,  -9/
      DATA IOPERA( 239),IX( 239),IY( 239)/'DRAW',  -1,  -9/
      DATA IOPERA( 240),IX( 240),IY( 240)/'MOVE',  -8,  12/
      DATA IOPERA( 241),IX( 241),IY( 241)/'DRAW',  -6,  11/
      DATA IOPERA( 242),IX( 242),IY( 242)/'MOVE',  -7,  12/
      DATA IOPERA( 243),IX( 243),IY( 243)/'DRAW',  -6,  10/
      DATA IOPERA( 244),IX( 244),IY( 244)/'MOVE',  -3,  12/
      DATA IOPERA( 245),IX( 245),IY( 245)/'DRAW',  -4,  10/
      DATA IOPERA( 246),IX( 246),IY( 246)/'MOVE',  -2,  12/
      DATA IOPERA( 247),IX( 247),IY( 247)/'DRAW',  -4,  11/
      DATA IOPERA( 248),IX( 248),IY( 248)/'MOVE',   2,  12/
      DATA IOPERA( 249),IX( 249),IY( 249)/'DRAW',   7,  11/
      DATA IOPERA( 250),IX( 250),IY( 250)/'MOVE',   4,  12/
      DATA IOPERA( 251),IX( 251),IY( 251)/'DRAW',   7,  10/
      DATA IOPERA( 252),IX( 252),IY( 252)/'MOVE',   5,  12/
      DATA IOPERA( 253),IX( 253),IY( 253)/'DRAW',   7,   9/
      DATA IOPERA( 254),IX( 254),IY( 254)/'MOVE',   6,  12/
      DATA IOPERA( 255),IX( 255),IY( 255)/'DRAW',   7,   6/
      DATA IOPERA( 256),IX( 256),IY( 256)/'MOVE',   2,   6/
      DATA IOPERA( 257),IX( 257),IY( 257)/'DRAW',   1,   2/
      DATA IOPERA( 258),IX( 258),IY( 258)/'DRAW',   2,  -2/
      DATA IOPERA( 259),IX( 259),IY( 259)/'MOVE',   2,   4/
      DATA IOPERA( 260),IX( 260),IY( 260)/'DRAW',   0,   2/
      DATA IOPERA( 261),IX( 261),IY( 261)/'DRAW',   2,   0/
      DATA IOPERA( 262),IX( 262),IY( 262)/'MOVE',   2,   3/
      DATA IOPERA( 263),IX( 263),IY( 263)/'DRAW',  -2,   2/
      DATA IOPERA( 264),IX( 264),IY( 264)/'DRAW',   2,   1/
      DATA IOPERA( 265),IX( 265),IY( 265)/'MOVE',  -6,  -8/
      DATA IOPERA( 266),IX( 266),IY( 266)/'DRAW',  -8,  -9/
      DATA IOPERA( 267),IX( 267),IY( 267)/'MOVE',  -6,  -7/
      DATA IOPERA( 268),IX( 268),IY( 268)/'DRAW',  -7,  -9/
      DATA IOPERA( 269),IX( 269),IY( 269)/'MOVE',  -4,  -7/
      DATA IOPERA( 270),IX( 270),IY( 270)/'DRAW',  -3,  -9/
      DATA IOPERA( 271),IX( 271),IY( 271)/'MOVE',  -4,  -8/
      DATA IOPERA( 272),IX( 272),IY( 272)/'DRAW',  -2,  -9/
C
      DATA IXMIND(   6)/ -11/
      DATA IXMAXD(   6)/   9/
      DATA IXDELD(   6)/  20/
      DATA ISTARD(   6)/ 225/
      DATA NUMCOO(   6)/  48/
C
C-----START POINT-----------------------------------------------------
C
      IFOUND='YES'
      IERROR='NO'
C
      NUMCO=1
      ISTART=1
      ISTOP=1
      NC=1
C
C               ******************************************
C               **  TREAT THE ROMAN SIMPLEX UPPER CASE  **
C               **  HERSHEY CHARACTER SET CASE          **
C               ******************************************
C
C
      IF(IBUGD2.EQ.'OFF')GOTO90
      WRITE(ICOUT,999)
  999 FORMAT(1X)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,51)
   51 FORMAT('***** AT THE BEGINNING OF DRTU1--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,52)ICHARN
   52 FORMAT('ICHARN = ',I8)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,59)IBUGD2,IFOUND,IERROR
   59 FORMAT('IBUGD2,IFOUND,IERROR = ',A4,2X,A4,2X,A4)
      CALL DPWRST('XXX','BUG ')
   90 CONTINUE
C
C               **************************************
C               **  STEP 2--                        **
C               **  EXTRACT THE COORDINATES         **
C               **  FOR THIS PARTICULAR CHARACTER.  **
C               **************************************
C
      ISTART=ISTARD(ICHARN)
      NC=NUMCOO(ICHARN)
      ISTOP=ISTART+NC-1
      J=0
      DO1100I=ISTART,ISTOP
      J=J+1
      IOP(J)=IOPERA(I)
      X(J)=IX(I)
      Y(J)=IY(I)
 1100 CONTINUE
      NUMCO=J
      IXMINS=IXMIND(ICHARN)
      IXMAXS=IXMAXD(ICHARN)
      IXDELS=IXDELD(ICHARN)
C
      GOTO9000
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT       **
C               *****************
C
 9000 CONTINUE
      IF(IBUGD2.EQ.'OFF')GOTO9090
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9011)
 9011 FORMAT('***** AT THE END       OF DRTU1--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9012)IBUGD2,IFOUND,IERROR
 9012 FORMAT('IBUGD2,IFOUND,IERROR = ',A4,2X,A4,2X,A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9013)ICHARN
 9013 FORMAT('ICHARN = ',I8)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9014)ISTART,ISTOP,NC,NUMCO
 9014 FORMAT('ISTART,ISTOP,NC,NUMCO = ',4I8)
      CALL DPWRST('XXX','BUG ')
      IF(NUMCO.GE.1.AND.NUMCO.LE.1000)GOTO9019
      DO9015I=1,NUMCO
      WRITE(ICOUT,9016)I,IOP(I),X(I),Y(I)
 9016 FORMAT('I,IOP(I),X(I),Y(I) = ',I8,2X,A4,2F10.2)
      CALL DPWRST('XXX','BUG ')
 9015 CONTINUE
 9019 CONTINUE
      WRITE(ICOUT,9021)IXMINS,IXMAXS,IXDELS
 9021 FORMAT('IXMINS,IXMAXS,IXDELS = ',3I8)
      CALL DPWRST('XXX','BUG ')
 9090 CONTINUE
C
      RETURN
      END
      SUBROUTINE DRTU2(ICHARN,IOP,X,Y,NUMCO,IXMINS,IXMAXS,IXDELS,
     1IBUGD2,IFOUND,IERROR)
C
C     PURPOSE--DEFINE AND SET THE HERSHEY CHARACTER SET COORDINATES
C              FOR ROMAN TRIPLEX UPPER CASE (PART 2).
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--87/4
C     ORIGINAL VERSION (AS A SEPARATE SUBROUTINE)--MARCH     1981.
C     UPDATED         --MAY       1982.
C     UPDATED         --MARCH     1987.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 IOP
      CHARACTER*4 IBUGD2
      CHARACTER*4 IFOUND
      CHARACTER*4 IERROR
C
      CHARACTER*4 IOPERA
C
C---------------------------------------------------------------------
C
      DIMENSION IOP(*)
      DIMENSION X(*)
      DIMENSION Y(*)
C
      DIMENSION IOPERA(300)
      DIMENSION IX(300)
      DIMENSION IY(300)
C
      DIMENSION IXMIND(30)
      DIMENSION IXMAXD(30)
      DIMENSION IXDELD(30)
      DIMENSION ISTARD(30)
      DIMENSION NUMCOO(30)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----DATA STATEMENTS-------------------------------------------------
C
C     DEFINE CHARACTER   3007--UPPER CASE G
C
      DATA IOPERA(   1),IX(   1),IY(   1)/'MOVE',   6,   9/
      DATA IOPERA(   2),IX(   2),IY(   2)/'DRAW',   7,  12/
      DATA IOPERA(   3),IX(   3),IY(   3)/'DRAW',   7,   6/
      DATA IOPERA(   4),IX(   4),IY(   4)/'DRAW',   6,   9/
      DATA IOPERA(   5),IX(   5),IY(   5)/'DRAW',   4,  11/
      DATA IOPERA(   6),IX(   6),IY(   6)/'DRAW',   2,  12/
      DATA IOPERA(   7),IX(   7),IY(   7)/'DRAW',  -1,  12/
      DATA IOPERA(   8),IX(   8),IY(   8)/'DRAW',  -4,  11/
      DATA IOPERA(   9),IX(   9),IY(   9)/'DRAW',  -6,   9/
      DATA IOPERA(  10),IX(  10),IY(  10)/'DRAW',  -7,   7/
      DATA IOPERA(  11),IX(  11),IY(  11)/'DRAW',  -8,   4/
      DATA IOPERA(  12),IX(  12),IY(  12)/'DRAW',  -8,  -1/
      DATA IOPERA(  13),IX(  13),IY(  13)/'DRAW',  -7,  -4/
      DATA IOPERA(  14),IX(  14),IY(  14)/'DRAW',  -6,  -6/
      DATA IOPERA(  15),IX(  15),IY(  15)/'DRAW',  -4,  -8/
      DATA IOPERA(  16),IX(  16),IY(  16)/'DRAW',  -1,  -9/
      DATA IOPERA(  17),IX(  17),IY(  17)/'DRAW',   2,  -9/
      DATA IOPERA(  18),IX(  18),IY(  18)/'DRAW',   4,  -8/
      DATA IOPERA(  19),IX(  19),IY(  19)/'DRAW',   6,  -8/
      DATA IOPERA(  20),IX(  20),IY(  20)/'DRAW',   7,  -9/
      DATA IOPERA(  21),IX(  21),IY(  21)/'DRAW',   7,  -1/
      DATA IOPERA(  22),IX(  22),IY(  22)/'MOVE',  -5,   9/
      DATA IOPERA(  23),IX(  23),IY(  23)/'DRAW',  -6,   7/
      DATA IOPERA(  24),IX(  24),IY(  24)/'DRAW',  -7,   4/
      DATA IOPERA(  25),IX(  25),IY(  25)/'DRAW',  -7,  -1/
      DATA IOPERA(  26),IX(  26),IY(  26)/'DRAW',  -6,  -4/
      DATA IOPERA(  27),IX(  27),IY(  27)/'DRAW',  -5,  -6/
      DATA IOPERA(  28),IX(  28),IY(  28)/'MOVE',  -1,  12/
      DATA IOPERA(  29),IX(  29),IY(  29)/'DRAW',  -3,  11/
      DATA IOPERA(  30),IX(  30),IY(  30)/'DRAW',  -5,   8/
      DATA IOPERA(  31),IX(  31),IY(  31)/'DRAW',  -6,   4/
      DATA IOPERA(  32),IX(  32),IY(  32)/'DRAW',  -6,  -1/
      DATA IOPERA(  33),IX(  33),IY(  33)/'DRAW',  -5,  -5/
      DATA IOPERA(  34),IX(  34),IY(  34)/'DRAW',  -3,  -8/
      DATA IOPERA(  35),IX(  35),IY(  35)/'DRAW',  -1,  -9/
      DATA IOPERA(  36),IX(  36),IY(  36)/'MOVE',   6,  -2/
      DATA IOPERA(  37),IX(  37),IY(  37)/'DRAW',   6,  -7/
      DATA IOPERA(  38),IX(  38),IY(  38)/'MOVE',   5,  -1/
      DATA IOPERA(  39),IX(  39),IY(  39)/'DRAW',   5,  -7/
      DATA IOPERA(  40),IX(  40),IY(  40)/'DRAW',   4,  -8/
      DATA IOPERA(  41),IX(  41),IY(  41)/'MOVE',   2,  -1/
      DATA IOPERA(  42),IX(  42),IY(  42)/'DRAW',  10,  -1/
      DATA IOPERA(  43),IX(  43),IY(  43)/'MOVE',   3,  -1/
      DATA IOPERA(  44),IX(  44),IY(  44)/'DRAW',   5,  -2/
      DATA IOPERA(  45),IX(  45),IY(  45)/'MOVE',   4,  -1/
      DATA IOPERA(  46),IX(  46),IY(  46)/'DRAW',   5,  -3/
      DATA IOPERA(  47),IX(  47),IY(  47)/'MOVE',   8,  -1/
      DATA IOPERA(  48),IX(  48),IY(  48)/'DRAW',   7,  -3/
      DATA IOPERA(  49),IX(  49),IY(  49)/'MOVE',   9,  -1/
      DATA IOPERA(  50),IX(  50),IY(  50)/'DRAW',   7,  -2/
C
      DATA IXMIND(   7)/ -11/
      DATA IXMAXD(   7)/  12/
      DATA IXDELD(   7)/  23/
      DATA ISTARD(   7)/   1/
      DATA NUMCOO(   7)/  50/
C
C     DEFINE CHARACTER   3008--UPPER CASE H
C
      DATA IOPERA(  51),IX(  51),IY(  51)/'MOVE',  -7,  12/
      DATA IOPERA(  52),IX(  52),IY(  52)/'DRAW',  -7,  -9/
      DATA IOPERA(  53),IX(  53),IY(  53)/'MOVE',  -6,  11/
      DATA IOPERA(  54),IX(  54),IY(  54)/'DRAW',  -6,  -8/
      DATA IOPERA(  55),IX(  55),IY(  55)/'MOVE',  -5,  12/
      DATA IOPERA(  56),IX(  56),IY(  56)/'DRAW',  -5,  -9/
      DATA IOPERA(  57),IX(  57),IY(  57)/'MOVE',   5,  12/
      DATA IOPERA(  58),IX(  58),IY(  58)/'DRAW',   5,  -9/
      DATA IOPERA(  59),IX(  59),IY(  59)/'MOVE',   6,  11/
      DATA IOPERA(  60),IX(  60),IY(  60)/'DRAW',   6,  -8/
      DATA IOPERA(  61),IX(  61),IY(  61)/'MOVE',   7,  12/
      DATA IOPERA(  62),IX(  62),IY(  62)/'DRAW',   7,  -9/
      DATA IOPERA(  63),IX(  63),IY(  63)/'MOVE', -10,  12/
      DATA IOPERA(  64),IX(  64),IY(  64)/'DRAW',  -2,  12/
      DATA IOPERA(  65),IX(  65),IY(  65)/'MOVE',   2,  12/
      DATA IOPERA(  66),IX(  66),IY(  66)/'DRAW',  10,  12/
      DATA IOPERA(  67),IX(  67),IY(  67)/'MOVE',  -5,   2/
      DATA IOPERA(  68),IX(  68),IY(  68)/'DRAW',   5,   2/
      DATA IOPERA(  69),IX(  69),IY(  69)/'MOVE', -10,  -9/
      DATA IOPERA(  70),IX(  70),IY(  70)/'DRAW',  -2,  -9/
      DATA IOPERA(  71),IX(  71),IY(  71)/'MOVE',   2,  -9/
      DATA IOPERA(  72),IX(  72),IY(  72)/'DRAW',  10,  -9/
      DATA IOPERA(  73),IX(  73),IY(  73)/'MOVE',  -9,  12/
      DATA IOPERA(  74),IX(  74),IY(  74)/'DRAW',  -7,  11/
      DATA IOPERA(  75),IX(  75),IY(  75)/'MOVE',  -8,  12/
      DATA IOPERA(  76),IX(  76),IY(  76)/'DRAW',  -7,  10/
      DATA IOPERA(  77),IX(  77),IY(  77)/'MOVE',  -4,  12/
      DATA IOPERA(  78),IX(  78),IY(  78)/'DRAW',  -5,  10/
      DATA IOPERA(  79),IX(  79),IY(  79)/'MOVE',  -3,  12/
      DATA IOPERA(  80),IX(  80),IY(  80)/'DRAW',  -5,  11/
      DATA IOPERA(  81),IX(  81),IY(  81)/'MOVE',   3,  12/
      DATA IOPERA(  82),IX(  82),IY(  82)/'DRAW',   5,  11/
      DATA IOPERA(  83),IX(  83),IY(  83)/'MOVE',   4,  12/
      DATA IOPERA(  84),IX(  84),IY(  84)/'DRAW',   5,  10/
      DATA IOPERA(  85),IX(  85),IY(  85)/'MOVE',   8,  12/
      DATA IOPERA(  86),IX(  86),IY(  86)/'DRAW',   7,  10/
      DATA IOPERA(  87),IX(  87),IY(  87)/'MOVE',   9,  12/
      DATA IOPERA(  88),IX(  88),IY(  88)/'DRAW',   7,  11/
      DATA IOPERA(  89),IX(  89),IY(  89)/'MOVE',  -7,  -8/
      DATA IOPERA(  90),IX(  90),IY(  90)/'DRAW',  -9,  -9/
      DATA IOPERA(  91),IX(  91),IY(  91)/'MOVE',  -7,  -7/
      DATA IOPERA(  92),IX(  92),IY(  92)/'DRAW',  -8,  -9/
      DATA IOPERA(  93),IX(  93),IY(  93)/'MOVE',  -5,  -7/
      DATA IOPERA(  94),IX(  94),IY(  94)/'DRAW',  -4,  -9/
      DATA IOPERA(  95),IX(  95),IY(  95)/'MOVE',  -5,  -8/
      DATA IOPERA(  96),IX(  96),IY(  96)/'DRAW',  -3,  -9/
      DATA IOPERA(  97),IX(  97),IY(  97)/'MOVE',   5,  -8/
      DATA IOPERA(  98),IX(  98),IY(  98)/'DRAW',   3,  -9/
      DATA IOPERA(  99),IX(  99),IY(  99)/'MOVE',   5,  -7/
      DATA IOPERA( 100),IX( 100),IY( 100)/'DRAW',   4,  -9/
      DATA IOPERA( 101),IX( 101),IY( 101)/'MOVE',   7,  -7/
      DATA IOPERA( 102),IX( 102),IY( 102)/'DRAW',   8,  -9/
      DATA IOPERA( 103),IX( 103),IY( 103)/'MOVE',   7,  -8/
      DATA IOPERA( 104),IX( 104),IY( 104)/'DRAW',   9,  -9/
C
      DATA IXMIND(   8)/ -12/
      DATA IXMAXD(   8)/  12/
      DATA IXDELD(   8)/  24/
      DATA ISTARD(   8)/  51/
      DATA NUMCOO(   8)/  54/
C
C     DEFINE CHARACTER   3009--UPPER CASE I
C
      DATA IOPERA( 105),IX( 105),IY( 105)/'MOVE',  -1,  12/
      DATA IOPERA( 106),IX( 106),IY( 106)/'DRAW',  -1,  -9/
      DATA IOPERA( 107),IX( 107),IY( 107)/'MOVE',   0,  11/
      DATA IOPERA( 108),IX( 108),IY( 108)/'DRAW',   0,  -8/
      DATA IOPERA( 109),IX( 109),IY( 109)/'MOVE',   1,  12/
      DATA IOPERA( 110),IX( 110),IY( 110)/'DRAW',   1,  -9/
      DATA IOPERA( 111),IX( 111),IY( 111)/'MOVE',  -4,  12/
      DATA IOPERA( 112),IX( 112),IY( 112)/'DRAW',   4,  12/
      DATA IOPERA( 113),IX( 113),IY( 113)/'MOVE',  -4,  -9/
      DATA IOPERA( 114),IX( 114),IY( 114)/'DRAW',   4,  -9/
      DATA IOPERA( 115),IX( 115),IY( 115)/'MOVE',  -3,  12/
      DATA IOPERA( 116),IX( 116),IY( 116)/'DRAW',  -1,  11/
      DATA IOPERA( 117),IX( 117),IY( 117)/'MOVE',  -2,  12/
      DATA IOPERA( 118),IX( 118),IY( 118)/'DRAW',  -1,  10/
      DATA IOPERA( 119),IX( 119),IY( 119)/'MOVE',   2,  12/
      DATA IOPERA( 120),IX( 120),IY( 120)/'DRAW',   1,  10/
      DATA IOPERA( 121),IX( 121),IY( 121)/'MOVE',   3,  12/
      DATA IOPERA( 122),IX( 122),IY( 122)/'DRAW',   1,  11/
      DATA IOPERA( 123),IX( 123),IY( 123)/'MOVE',  -1,  -8/
      DATA IOPERA( 124),IX( 124),IY( 124)/'DRAW',  -3,  -9/
      DATA IOPERA( 125),IX( 125),IY( 125)/'MOVE',  -1,  -7/
      DATA IOPERA( 126),IX( 126),IY( 126)/'DRAW',  -2,  -9/
      DATA IOPERA( 127),IX( 127),IY( 127)/'MOVE',   1,  -7/
      DATA IOPERA( 128),IX( 128),IY( 128)/'DRAW',   2,  -9/
      DATA IOPERA( 129),IX( 129),IY( 129)/'MOVE',   1,  -8/
      DATA IOPERA( 130),IX( 130),IY( 130)/'DRAW',   3,  -9/
C
      DATA IXMIND(   9)/  -6/
      DATA IXMAXD(   9)/   6/
      DATA IXDELD(   9)/  12/
      DATA ISTARD(   9)/ 105/
      DATA NUMCOO(   9)/  26/
C
C     DEFINE CHARACTER   3010--UPPER CASE J
C
      DATA IOPERA( 131),IX( 131),IY( 131)/'MOVE',   1,  12/
      DATA IOPERA( 132),IX( 132),IY( 132)/'DRAW',   1,  -5/
      DATA IOPERA( 133),IX( 133),IY( 133)/'DRAW',   0,  -8/
      DATA IOPERA( 134),IX( 134),IY( 134)/'DRAW',  -1,  -9/
      DATA IOPERA( 135),IX( 135),IY( 135)/'MOVE',   2,  11/
      DATA IOPERA( 136),IX( 136),IY( 136)/'DRAW',   2,  -5/
      DATA IOPERA( 137),IX( 137),IY( 137)/'DRAW',   1,  -8/
      DATA IOPERA( 138),IX( 138),IY( 138)/'MOVE',   3,  12/
      DATA IOPERA( 139),IX( 139),IY( 139)/'DRAW',   3,  -5/
      DATA IOPERA( 140),IX( 140),IY( 140)/'DRAW',   2,  -8/
      DATA IOPERA( 141),IX( 141),IY( 141)/'DRAW',  -1,  -9/
      DATA IOPERA( 142),IX( 142),IY( 142)/'DRAW',  -3,  -9/
      DATA IOPERA( 143),IX( 143),IY( 143)/'DRAW',  -5,  -8/
      DATA IOPERA( 144),IX( 144),IY( 144)/'DRAW',  -6,  -6/
      DATA IOPERA( 145),IX( 145),IY( 145)/'DRAW',  -6,  -4/
      DATA IOPERA( 146),IX( 146),IY( 146)/'DRAW',  -5,  -3/
      DATA IOPERA( 147),IX( 147),IY( 147)/'DRAW',  -4,  -3/
      DATA IOPERA( 148),IX( 148),IY( 148)/'DRAW',  -3,  -4/
      DATA IOPERA( 149),IX( 149),IY( 149)/'DRAW',  -3,  -5/
      DATA IOPERA( 150),IX( 150),IY( 150)/'DRAW',  -4,  -6/
      DATA IOPERA( 151),IX( 151),IY( 151)/'DRAW',  -5,  -6/
      DATA IOPERA( 152),IX( 152),IY( 152)/'MOVE',  -5,  -4/
      DATA IOPERA( 153),IX( 153),IY( 153)/'DRAW',  -5,  -5/
      DATA IOPERA( 154),IX( 154),IY( 154)/'DRAW',  -4,  -5/
      DATA IOPERA( 155),IX( 155),IY( 155)/'DRAW',  -4,  -4/
      DATA IOPERA( 156),IX( 156),IY( 156)/'DRAW',  -5,  -4/
      DATA IOPERA( 157),IX( 157),IY( 157)/'MOVE',  -2,  12/
      DATA IOPERA( 158),IX( 158),IY( 158)/'DRAW',   6,  12/
      DATA IOPERA( 159),IX( 159),IY( 159)/'MOVE',  -1,  12/
      DATA IOPERA( 160),IX( 160),IY( 160)/'DRAW',   1,  11/
      DATA IOPERA( 161),IX( 161),IY( 161)/'MOVE',   0,  12/
      DATA IOPERA( 162),IX( 162),IY( 162)/'DRAW',   1,  10/
      DATA IOPERA( 163),IX( 163),IY( 163)/'MOVE',   4,  12/
      DATA IOPERA( 164),IX( 164),IY( 164)/'DRAW',   3,  10/
      DATA IOPERA( 165),IX( 165),IY( 165)/'MOVE',   5,  12/
      DATA IOPERA( 166),IX( 166),IY( 166)/'DRAW',   3,  11/
C
      DATA IXMIND(  10)/  -8/
      DATA IXMAXD(  10)/   8/
      DATA IXDELD(  10)/  16/
      DATA ISTARD(  10)/ 131/
      DATA NUMCOO(  10)/  36/
C
C     DEFINE CHARACTER   3011--UPPER CASE K
C
      DATA IOPERA( 167),IX( 167),IY( 167)/'MOVE',  -7,  12/
      DATA IOPERA( 168),IX( 168),IY( 168)/'DRAW',  -7,  -9/
      DATA IOPERA( 169),IX( 169),IY( 169)/'MOVE',  -6,  11/
      DATA IOPERA( 170),IX( 170),IY( 170)/'DRAW',  -6,  -8/
      DATA IOPERA( 171),IX( 171),IY( 171)/'MOVE',  -5,  12/
      DATA IOPERA( 172),IX( 172),IY( 172)/'DRAW',  -5,  -9/
      DATA IOPERA( 173),IX( 173),IY( 173)/'MOVE',   6,  11/
      DATA IOPERA( 174),IX( 174),IY( 174)/'DRAW',  -5,   0/
      DATA IOPERA( 175),IX( 175),IY( 175)/'MOVE',  -2,   2/
      DATA IOPERA( 176),IX( 176),IY( 176)/'DRAW',   5,  -9/
      DATA IOPERA( 177),IX( 177),IY( 177)/'MOVE',  -1,   2/
      DATA IOPERA( 178),IX( 178),IY( 178)/'DRAW',   6,  -9/
      DATA IOPERA( 179),IX( 179),IY( 179)/'MOVE',  -1,   4/
      DATA IOPERA( 180),IX( 180),IY( 180)/'DRAW',   7,  -9/
      DATA IOPERA( 181),IX( 181),IY( 181)/'MOVE', -10,  12/
      DATA IOPERA( 182),IX( 182),IY( 182)/'DRAW',  -2,  12/
      DATA IOPERA( 183),IX( 183),IY( 183)/'MOVE',   3,  12/
      DATA IOPERA( 184),IX( 184),IY( 184)/'DRAW',   9,  12/
      DATA IOPERA( 185),IX( 185),IY( 185)/'MOVE', -10,  -9/
      DATA IOPERA( 186),IX( 186),IY( 186)/'DRAW',  -2,  -9/
      DATA IOPERA( 187),IX( 187),IY( 187)/'MOVE',   2,  -9/
      DATA IOPERA( 188),IX( 188),IY( 188)/'DRAW',   9,  -9/
      DATA IOPERA( 189),IX( 189),IY( 189)/'MOVE',  -9,  12/
      DATA IOPERA( 190),IX( 190),IY( 190)/'DRAW',  -7,  11/
      DATA IOPERA( 191),IX( 191),IY( 191)/'MOVE',  -8,  12/
      DATA IOPERA( 192),IX( 192),IY( 192)/'DRAW',  -7,  10/
      DATA IOPERA( 193),IX( 193),IY( 193)/'MOVE',  -4,  12/
      DATA IOPERA( 194),IX( 194),IY( 194)/'DRAW',  -5,  10/
      DATA IOPERA( 195),IX( 195),IY( 195)/'MOVE',  -3,  12/
      DATA IOPERA( 196),IX( 196),IY( 196)/'DRAW',  -5,  11/
      DATA IOPERA( 197),IX( 197),IY( 197)/'MOVE',   5,  12/
      DATA IOPERA( 198),IX( 198),IY( 198)/'DRAW',   6,  11/
      DATA IOPERA( 199),IX( 199),IY( 199)/'MOVE',   8,  12/
      DATA IOPERA( 200),IX( 200),IY( 200)/'DRAW',   6,  11/
      DATA IOPERA( 201),IX( 201),IY( 201)/'MOVE',  -7,  -8/
      DATA IOPERA( 202),IX( 202),IY( 202)/'DRAW',  -9,  -9/
      DATA IOPERA( 203),IX( 203),IY( 203)/'MOVE',  -7,  -7/
      DATA IOPERA( 204),IX( 204),IY( 204)/'DRAW',  -8,  -9/
      DATA IOPERA( 205),IX( 205),IY( 205)/'MOVE',  -5,  -7/
      DATA IOPERA( 206),IX( 206),IY( 206)/'DRAW',  -4,  -9/
      DATA IOPERA( 207),IX( 207),IY( 207)/'MOVE',  -5,  -8/
      DATA IOPERA( 208),IX( 208),IY( 208)/'DRAW',  -3,  -9/
      DATA IOPERA( 209),IX( 209),IY( 209)/'MOVE',   5,  -7/
      DATA IOPERA( 210),IX( 210),IY( 210)/'DRAW',   3,  -9/
      DATA IOPERA( 211),IX( 211),IY( 211)/'MOVE',   5,  -7/
      DATA IOPERA( 212),IX( 212),IY( 212)/'DRAW',   8,  -9/
C
      DATA IXMIND(  11)/ -12/
      DATA IXMAXD(  11)/  10/
      DATA IXDELD(  11)/  22/
      DATA ISTARD(  11)/ 167/
      DATA NUMCOO(  11)/  46/
C
C     DEFINE CHARACTER   3012--UPPER CASE L
C
      DATA IOPERA( 213),IX( 213),IY( 213)/'MOVE',  -4,  12/
      DATA IOPERA( 214),IX( 214),IY( 214)/'DRAW',  -4,  -9/
      DATA IOPERA( 215),IX( 215),IY( 215)/'MOVE',  -3,  11/
      DATA IOPERA( 216),IX( 216),IY( 216)/'DRAW',  -3,  -8/
      DATA IOPERA( 217),IX( 217),IY( 217)/'MOVE',  -2,  12/
      DATA IOPERA( 218),IX( 218),IY( 218)/'DRAW',  -2,  -9/
      DATA IOPERA( 219),IX( 219),IY( 219)/'MOVE',  -7,  12/
      DATA IOPERA( 220),IX( 220),IY( 220)/'DRAW',   1,  12/
      DATA IOPERA( 221),IX( 221),IY( 221)/'MOVE',  -7,  -9/
      DATA IOPERA( 222),IX( 222),IY( 222)/'DRAW',   8,  -9/
      DATA IOPERA( 223),IX( 223),IY( 223)/'DRAW',   8,  -3/
      DATA IOPERA( 224),IX( 224),IY( 224)/'MOVE',  -6,  12/
      DATA IOPERA( 225),IX( 225),IY( 225)/'DRAW',  -4,  11/
      DATA IOPERA( 226),IX( 226),IY( 226)/'MOVE',  -5,  12/
      DATA IOPERA( 227),IX( 227),IY( 227)/'DRAW',  -4,  10/
      DATA IOPERA( 228),IX( 228),IY( 228)/'MOVE',  -1,  12/
      DATA IOPERA( 229),IX( 229),IY( 229)/'DRAW',  -2,  10/
      DATA IOPERA( 230),IX( 230),IY( 230)/'MOVE',   0,  12/
      DATA IOPERA( 231),IX( 231),IY( 231)/'DRAW',  -2,  11/
      DATA IOPERA( 232),IX( 232),IY( 232)/'MOVE',  -4,  -8/
      DATA IOPERA( 233),IX( 233),IY( 233)/'DRAW',  -6,  -9/
      DATA IOPERA( 234),IX( 234),IY( 234)/'MOVE',  -4,  -7/
      DATA IOPERA( 235),IX( 235),IY( 235)/'DRAW',  -5,  -9/
      DATA IOPERA( 236),IX( 236),IY( 236)/'MOVE',  -2,  -7/
      DATA IOPERA( 237),IX( 237),IY( 237)/'DRAW',  -1,  -9/
      DATA IOPERA( 238),IX( 238),IY( 238)/'MOVE',  -2,  -8/
      DATA IOPERA( 239),IX( 239),IY( 239)/'DRAW',   0,  -9/
      DATA IOPERA( 240),IX( 240),IY( 240)/'MOVE',   3,  -9/
      DATA IOPERA( 241),IX( 241),IY( 241)/'DRAW',   8,  -8/
      DATA IOPERA( 242),IX( 242),IY( 242)/'MOVE',   5,  -9/
      DATA IOPERA( 243),IX( 243),IY( 243)/'DRAW',   8,  -7/
      DATA IOPERA( 244),IX( 244),IY( 244)/'MOVE',   6,  -9/
      DATA IOPERA( 245),IX( 245),IY( 245)/'DRAW',   8,  -6/
      DATA IOPERA( 246),IX( 246),IY( 246)/'MOVE',   7,  -9/
      DATA IOPERA( 247),IX( 247),IY( 247)/'DRAW',   8,  -3/
C
      DATA IXMIND(  12)/  -9/
      DATA IXMAXD(  12)/   9/
      DATA IXDELD(  12)/  18/
      DATA ISTARD(  12)/ 213/
      DATA NUMCOO(  12)/  35/
C
C     DEFINE CHARACTER   3013--UPPER CASE M
C
      DATA IOPERA( 248),IX( 248),IY( 248)/'MOVE',  -8,  12/
      DATA IOPERA( 249),IX( 249),IY( 249)/'DRAW',  -8,  -8/
      DATA IOPERA( 250),IX( 250),IY( 250)/'MOVE',  -8,  12/
      DATA IOPERA( 251),IX( 251),IY( 251)/'DRAW',  -1,  -9/
      DATA IOPERA( 252),IX( 252),IY( 252)/'MOVE',  -7,  12/
      DATA IOPERA( 253),IX( 253),IY( 253)/'DRAW',  -1,  -6/
      DATA IOPERA( 254),IX( 254),IY( 254)/'MOVE',  -6,  12/
      DATA IOPERA( 255),IX( 255),IY( 255)/'DRAW',   0,  -6/
      DATA IOPERA( 256),IX( 256),IY( 256)/'MOVE',   6,  12/
      DATA IOPERA( 257),IX( 257),IY( 257)/'DRAW',  -1,  -9/
      DATA IOPERA( 258),IX( 258),IY( 258)/'MOVE',   6,  12/
      DATA IOPERA( 259),IX( 259),IY( 259)/'DRAW',   6,  -9/
      DATA IOPERA( 260),IX( 260),IY( 260)/'MOVE',   7,  11/
      DATA IOPERA( 261),IX( 261),IY( 261)/'DRAW',   7,  -8/
      DATA IOPERA( 262),IX( 262),IY( 262)/'MOVE',   8,  12/
      DATA IOPERA( 263),IX( 263),IY( 263)/'DRAW',   8,  -9/
      DATA IOPERA( 264),IX( 264),IY( 264)/'MOVE', -11,  12/
      DATA IOPERA( 265),IX( 265),IY( 265)/'DRAW',  -6,  12/
      DATA IOPERA( 266),IX( 266),IY( 266)/'MOVE',   6,  12/
      DATA IOPERA( 267),IX( 267),IY( 267)/'DRAW',  11,  12/
      DATA IOPERA( 268),IX( 268),IY( 268)/'MOVE', -11,  -9/
      DATA IOPERA( 269),IX( 269),IY( 269)/'DRAW',  -5,  -9/
      DATA IOPERA( 270),IX( 270),IY( 270)/'MOVE',   3,  -9/
      DATA IOPERA( 271),IX( 271),IY( 271)/'DRAW',  11,  -9/
      DATA IOPERA( 272),IX( 272),IY( 272)/'MOVE', -10,  12/
      DATA IOPERA( 273),IX( 273),IY( 273)/'DRAW',  -8,  11/
      DATA IOPERA( 274),IX( 274),IY( 274)/'MOVE',   9,  12/
      DATA IOPERA( 275),IX( 275),IY( 275)/'DRAW',   8,  10/
      DATA IOPERA( 276),IX( 276),IY( 276)/'MOVE',  10,  12/
      DATA IOPERA( 277),IX( 277),IY( 277)/'DRAW',   8,  11/
      DATA IOPERA( 278),IX( 278),IY( 278)/'MOVE',  -8,  -8/
      DATA IOPERA( 279),IX( 279),IY( 279)/'DRAW', -10,  -9/
      DATA IOPERA( 280),IX( 280),IY( 280)/'MOVE',  -8,  -8/
      DATA IOPERA( 281),IX( 281),IY( 281)/'DRAW',  -6,  -9/
      DATA IOPERA( 282),IX( 282),IY( 282)/'MOVE',   6,  -8/
      DATA IOPERA( 283),IX( 283),IY( 283)/'DRAW',   4,  -9/
      DATA IOPERA( 284),IX( 284),IY( 284)/'MOVE',   6,  -7/
      DATA IOPERA( 285),IX( 285),IY( 285)/'DRAW',   5,  -9/
      DATA IOPERA( 286),IX( 286),IY( 286)/'MOVE',   8,  -7/
      DATA IOPERA( 287),IX( 287),IY( 287)/'DRAW',   9,  -9/
      DATA IOPERA( 288),IX( 288),IY( 288)/'MOVE',   8,  -8/
      DATA IOPERA( 289),IX( 289),IY( 289)/'DRAW',  10,  -9/
C
      DATA IXMIND(  13)/ -13/
      DATA IXMAXD(  13)/  13/
      DATA IXDELD(  13)/  26/
      DATA ISTARD(  13)/ 248/
      DATA NUMCOO(  13)/  42/
C
C-----START POINT-----------------------------------------------------
C
      IFOUND='YES'
      IERROR='NO'
C
      NUMCO=1
      ISTART=1
      ISTOP=1
      NC=1
C
C               ******************************************
C               **  TREAT THE ROMAN SIMPLEX UPPER CASE  **
C               **  HERSHEY CHARACTER SET CASE          **
C               ******************************************
C
C
      IF(IBUGD2.EQ.'OFF')GOTO90
      WRITE(ICOUT,999)
  999 FORMAT(1X)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,51)
   51 FORMAT('***** AT THE BEGINNING OF DRTU2--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,52)ICHARN
   52 FORMAT('ICHARN = ',I8)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,59)IBUGD2,IFOUND,IERROR
   59 FORMAT('IBUGD2,IFOUND,IERROR = ',A4,2X,A4,2X,A4)
      CALL DPWRST('XXX','BUG ')
   90 CONTINUE
C
C               **************************************
C               **  STEP 2--                        **
C               **  EXTRACT THE COORDINATES         **
C               **  FOR THIS PARTICULAR CHARACTER.  **
C               **************************************
C
      ISTART=ISTARD(ICHARN)
      NC=NUMCOO(ICHARN)
      ISTOP=ISTART+NC-1
      J=0
      DO1100I=ISTART,ISTOP
      J=J+1
      IOP(J)=IOPERA(I)
      X(J)=IX(I)
      Y(J)=IY(I)
 1100 CONTINUE
      NUMCO=J
      IXMINS=IXMIND(ICHARN)
      IXMAXS=IXMAXD(ICHARN)
      IXDELS=IXDELD(ICHARN)
C
      GOTO9000
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT       **
C               *****************
C
 9000 CONTINUE
      IF(IBUGD2.EQ.'OFF')GOTO9090
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9011)
 9011 FORMAT('***** AT THE END       OF DRTU2--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9012)IBUGD2,IFOUND,IERROR
 9012 FORMAT('IBUGD2,IFOUND,IERROR = ',A4,2X,A4,2X,A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9013)ICHARN
 9013 FORMAT('ICHARN = ',I8)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9014)ISTART,ISTOP,NC,NUMCO
 9014 FORMAT('ISTART,ISTOP,NC,NUMCO = ',4I8)
      CALL DPWRST('XXX','BUG ')
      IF(NUMCO.GE.1.AND.NUMCO.LE.1000)GOTO9019
      DO9015I=1,NUMCO
      WRITE(ICOUT,9016)I,IOP(I),X(I),Y(I)
 9016 FORMAT('I,IOP(I),X(I),Y(I) = ',I8,2X,A4,2F10.2)
      CALL DPWRST('XXX','BUG ')
 9015 CONTINUE
 9019 CONTINUE
      WRITE(ICOUT,9021)IXMINS,IXMAXS,IXDELS
 9021 FORMAT('IXMINS,IXMAXS,IXDELS = ',3I8)
      CALL DPWRST('XXX','BUG ')
 9090 CONTINUE
C
      RETURN
      END
      SUBROUTINE DRTU3(ICHARN,IOP,X,Y,NUMCO,IXMINS,IXMAXS,IXDELS,
     1IBUGD2,IFOUND,IERROR)
C
C     PURPOSE--DEFINE AND SET THE HERSHEY CHARACTER SET COORDINATES
C              FOR ROMAN TRIPLEX UPPER CASE (PART 3).
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--87/4
C     ORIGINAL VERSION (AS A SEPARATE SUBROUTINE)--MARCH     1981.
C     UPDATED         --MAY       1982.
C     UPDATED         --MARCH     1987.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 IOP
      CHARACTER*4 IBUGD2
      CHARACTER*4 IFOUND
      CHARACTER*4 IERROR
C
      CHARACTER*4 IOPERA
C
C---------------------------------------------------------------------
C
      DIMENSION IOP(*)
      DIMENSION X(*)
      DIMENSION Y(*)
C
      DIMENSION IOPERA(300)
      DIMENSION IX(300)
      DIMENSION IY(300)
C
      DIMENSION IXMIND(30)
      DIMENSION IXMAXD(30)
      DIMENSION IXDELD(30)
      DIMENSION ISTARD(30)
      DIMENSION NUMCOO(30)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----DATA STATEMENTS-------------------------------------------------
C
C     DEFINE CHARACTER   3014--UPPER CASE N
C
      DATA IOPERA(   1),IX(   1),IY(   1)/'MOVE',  -7,  12/
      DATA IOPERA(   2),IX(   2),IY(   2)/'DRAW',  -7,  -8/
      DATA IOPERA(   3),IX(   3),IY(   3)/'MOVE',  -7,  12/
      DATA IOPERA(   4),IX(   4),IY(   4)/'DRAW',   7,  -9/
      DATA IOPERA(   5),IX(   5),IY(   5)/'MOVE',  -6,  12/
      DATA IOPERA(   6),IX(   6),IY(   6)/'DRAW',   6,  -6/
      DATA IOPERA(   7),IX(   7),IY(   7)/'MOVE',  -5,  12/
      DATA IOPERA(   8),IX(   8),IY(   8)/'DRAW',   7,  -6/
      DATA IOPERA(   9),IX(   9),IY(   9)/'MOVE',   7,  11/
      DATA IOPERA(  10),IX(  10),IY(  10)/'DRAW',   7,  -9/
      DATA IOPERA(  11),IX(  11),IY(  11)/'MOVE', -10,  12/
      DATA IOPERA(  12),IX(  12),IY(  12)/'DRAW',  -5,  12/
      DATA IOPERA(  13),IX(  13),IY(  13)/'MOVE',   4,  12/
      DATA IOPERA(  14),IX(  14),IY(  14)/'DRAW',  10,  12/
      DATA IOPERA(  15),IX(  15),IY(  15)/'MOVE', -10,  -9/
      DATA IOPERA(  16),IX(  16),IY(  16)/'DRAW',  -4,  -9/
      DATA IOPERA(  17),IX(  17),IY(  17)/'MOVE',  -9,  12/
      DATA IOPERA(  18),IX(  18),IY(  18)/'DRAW',  -7,  11/
      DATA IOPERA(  19),IX(  19),IY(  19)/'MOVE',   5,  12/
      DATA IOPERA(  20),IX(  20),IY(  20)/'DRAW',   7,  11/
      DATA IOPERA(  21),IX(  21),IY(  21)/'MOVE',   9,  12/
      DATA IOPERA(  22),IX(  22),IY(  22)/'DRAW',   7,  11/
      DATA IOPERA(  23),IX(  23),IY(  23)/'MOVE',  -7,  -8/
      DATA IOPERA(  24),IX(  24),IY(  24)/'DRAW',  -9,  -9/
      DATA IOPERA(  25),IX(  25),IY(  25)/'MOVE',  -7,  -8/
      DATA IOPERA(  26),IX(  26),IY(  26)/'DRAW',  -5,  -9/
C
      DATA IXMIND(  14)/ -12/
      DATA IXMAXD(  14)/  12/
      DATA IXDELD(  14)/  24/
      DATA ISTARD(  14)/   1/
      DATA NUMCOO(  14)/  26/
C
C     DEFINE CHARACTER   3015--UPPER CASE O
C
      DATA IOPERA(  27),IX(  27),IY(  27)/'MOVE',  -1,  12/
      DATA IOPERA(  28),IX(  28),IY(  28)/'DRAW',  -4,  11/
      DATA IOPERA(  29),IX(  29),IY(  29)/'DRAW',  -6,   9/
      DATA IOPERA(  30),IX(  30),IY(  30)/'DRAW',  -7,   7/
      DATA IOPERA(  31),IX(  31),IY(  31)/'DRAW',  -8,   3/
      DATA IOPERA(  32),IX(  32),IY(  32)/'DRAW',  -8,   0/
      DATA IOPERA(  33),IX(  33),IY(  33)/'DRAW',  -7,  -4/
      DATA IOPERA(  34),IX(  34),IY(  34)/'DRAW',  -6,  -6/
      DATA IOPERA(  35),IX(  35),IY(  35)/'DRAW',  -4,  -8/
      DATA IOPERA(  36),IX(  36),IY(  36)/'DRAW',  -1,  -9/
      DATA IOPERA(  37),IX(  37),IY(  37)/'DRAW',   1,  -9/
      DATA IOPERA(  38),IX(  38),IY(  38)/'DRAW',   4,  -8/
      DATA IOPERA(  39),IX(  39),IY(  39)/'DRAW',   6,  -6/
      DATA IOPERA(  40),IX(  40),IY(  40)/'DRAW',   7,  -4/
      DATA IOPERA(  41),IX(  41),IY(  41)/'DRAW',   8,   0/
      DATA IOPERA(  42),IX(  42),IY(  42)/'DRAW',   8,   3/
      DATA IOPERA(  43),IX(  43),IY(  43)/'DRAW',   7,   7/
      DATA IOPERA(  44),IX(  44),IY(  44)/'DRAW',   6,   9/
      DATA IOPERA(  45),IX(  45),IY(  45)/'DRAW',   4,  11/
      DATA IOPERA(  46),IX(  46),IY(  46)/'DRAW',   1,  12/
      DATA IOPERA(  47),IX(  47),IY(  47)/'DRAW',  -1,  12/
      DATA IOPERA(  48),IX(  48),IY(  48)/'MOVE',  -5,   9/
      DATA IOPERA(  49),IX(  49),IY(  49)/'DRAW',  -6,   7/
      DATA IOPERA(  50),IX(  50),IY(  50)/'DRAW',  -7,   4/
      DATA IOPERA(  51),IX(  51),IY(  51)/'DRAW',  -7,  -1/
      DATA IOPERA(  52),IX(  52),IY(  52)/'DRAW',  -6,  -4/
      DATA IOPERA(  53),IX(  53),IY(  53)/'DRAW',  -5,  -6/
      DATA IOPERA(  54),IX(  54),IY(  54)/'MOVE',   5,  -6/
      DATA IOPERA(  55),IX(  55),IY(  55)/'DRAW',   6,  -4/
      DATA IOPERA(  56),IX(  56),IY(  56)/'DRAW',   7,  -1/
      DATA IOPERA(  57),IX(  57),IY(  57)/'DRAW',   7,   4/
      DATA IOPERA(  58),IX(  58),IY(  58)/'DRAW',   6,   7/
      DATA IOPERA(  59),IX(  59),IY(  59)/'DRAW',   5,   9/
      DATA IOPERA(  60),IX(  60),IY(  60)/'MOVE',  -1,  12/
      DATA IOPERA(  61),IX(  61),IY(  61)/'DRAW',  -3,  11/
      DATA IOPERA(  62),IX(  62),IY(  62)/'DRAW',  -5,   8/
      DATA IOPERA(  63),IX(  63),IY(  63)/'DRAW',  -6,   4/
      DATA IOPERA(  64),IX(  64),IY(  64)/'DRAW',  -6,  -1/
      DATA IOPERA(  65),IX(  65),IY(  65)/'DRAW',  -5,  -5/
      DATA IOPERA(  66),IX(  66),IY(  66)/'DRAW',  -3,  -8/
      DATA IOPERA(  67),IX(  67),IY(  67)/'DRAW',  -1,  -9/
      DATA IOPERA(  68),IX(  68),IY(  68)/'MOVE',   1,  -9/
      DATA IOPERA(  69),IX(  69),IY(  69)/'DRAW',   3,  -8/
      DATA IOPERA(  70),IX(  70),IY(  70)/'DRAW',   5,  -5/
      DATA IOPERA(  71),IX(  71),IY(  71)/'DRAW',   6,  -1/
      DATA IOPERA(  72),IX(  72),IY(  72)/'DRAW',   6,   4/
      DATA IOPERA(  73),IX(  73),IY(  73)/'DRAW',   5,   8/
      DATA IOPERA(  74),IX(  74),IY(  74)/'DRAW',   3,  11/
      DATA IOPERA(  75),IX(  75),IY(  75)/'DRAW',   1,  12/
C
      DATA IXMIND(  15)/ -11/
      DATA IXMAXD(  15)/  11/
      DATA IXDELD(  15)/  22/
      DATA ISTARD(  15)/  27/
      DATA NUMCOO(  15)/  49/
C
C     DEFINE CHARACTER   3016--UPPER CASE P
C
      DATA IOPERA(  76),IX(  76),IY(  76)/'MOVE',  -6,  12/
      DATA IOPERA(  77),IX(  77),IY(  77)/'DRAW',  -6,  -9/
      DATA IOPERA(  78),IX(  78),IY(  78)/'MOVE',  -5,  11/
      DATA IOPERA(  79),IX(  79),IY(  79)/'DRAW',  -5,  -8/
      DATA IOPERA(  80),IX(  80),IY(  80)/'MOVE',  -4,  12/
      DATA IOPERA(  81),IX(  81),IY(  81)/'DRAW',  -4,  -9/
      DATA IOPERA(  82),IX(  82),IY(  82)/'MOVE',  -9,  12/
      DATA IOPERA(  83),IX(  83),IY(  83)/'DRAW',   3,  12/
      DATA IOPERA(  84),IX(  84),IY(  84)/'DRAW',   6,  11/
      DATA IOPERA(  85),IX(  85),IY(  85)/'DRAW',   7,  10/
      DATA IOPERA(  86),IX(  86),IY(  86)/'DRAW',   8,   8/
      DATA IOPERA(  87),IX(  87),IY(  87)/'DRAW',   8,   5/
      DATA IOPERA(  88),IX(  88),IY(  88)/'DRAW',   7,   3/
      DATA IOPERA(  89),IX(  89),IY(  89)/'DRAW',   6,   2/
      DATA IOPERA(  90),IX(  90),IY(  90)/'DRAW',   3,   1/
      DATA IOPERA(  91),IX(  91),IY(  91)/'DRAW',  -4,   1/
      DATA IOPERA(  92),IX(  92),IY(  92)/'MOVE',   6,  10/
      DATA IOPERA(  93),IX(  93),IY(  93)/'DRAW',   7,   8/
      DATA IOPERA(  94),IX(  94),IY(  94)/'DRAW',   7,   5/
      DATA IOPERA(  95),IX(  95),IY(  95)/'DRAW',   6,   3/
      DATA IOPERA(  96),IX(  96),IY(  96)/'MOVE',   3,  12/
      DATA IOPERA(  97),IX(  97),IY(  97)/'DRAW',   5,  11/
      DATA IOPERA(  98),IX(  98),IY(  98)/'DRAW',   6,   9/
      DATA IOPERA(  99),IX(  99),IY(  99)/'DRAW',   6,   4/
      DATA IOPERA( 100),IX( 100),IY( 100)/'DRAW',   5,   2/
      DATA IOPERA( 101),IX( 101),IY( 101)/'DRAW',   3,   1/
      DATA IOPERA( 102),IX( 102),IY( 102)/'MOVE',  -9,  -9/
      DATA IOPERA( 103),IX( 103),IY( 103)/'DRAW',  -1,  -9/
      DATA IOPERA( 104),IX( 104),IY( 104)/'MOVE',  -8,  12/
      DATA IOPERA( 105),IX( 105),IY( 105)/'DRAW',  -6,  11/
      DATA IOPERA( 106),IX( 106),IY( 106)/'MOVE',  -7,  12/
      DATA IOPERA( 107),IX( 107),IY( 107)/'DRAW',  -6,  10/
      DATA IOPERA( 108),IX( 108),IY( 108)/'MOVE',  -3,  12/
      DATA IOPERA( 109),IX( 109),IY( 109)/'DRAW',  -4,  10/
      DATA IOPERA( 110),IX( 110),IY( 110)/'MOVE',  -2,  12/
      DATA IOPERA( 111),IX( 111),IY( 111)/'DRAW',  -4,  11/
      DATA IOPERA( 112),IX( 112),IY( 112)/'MOVE',  -6,  -8/
      DATA IOPERA( 113),IX( 113),IY( 113)/'DRAW',  -8,  -9/
      DATA IOPERA( 114),IX( 114),IY( 114)/'MOVE',  -6,  -7/
      DATA IOPERA( 115),IX( 115),IY( 115)/'DRAW',  -7,  -9/
      DATA IOPERA( 116),IX( 116),IY( 116)/'MOVE',  -4,  -7/
      DATA IOPERA( 117),IX( 117),IY( 117)/'DRAW',  -3,  -9/
      DATA IOPERA( 118),IX( 118),IY( 118)/'MOVE',  -4,  -8/
      DATA IOPERA( 119),IX( 119),IY( 119)/'DRAW',  -2,  -9/
C
      DATA IXMIND(  16)/ -11/
      DATA IXMAXD(  16)/  11/
      DATA IXDELD(  16)/  22/
      DATA ISTARD(  16)/  76/
      DATA NUMCOO(  16)/  44/
C
C     DEFINE CHARACTER   3017--UPPER CASE Q
C
      DATA IOPERA( 120),IX( 120),IY( 120)/'MOVE',  -1,  12/
      DATA IOPERA( 121),IX( 121),IY( 121)/'DRAW',  -4,  11/
      DATA IOPERA( 122),IX( 122),IY( 122)/'DRAW',  -6,   9/
      DATA IOPERA( 123),IX( 123),IY( 123)/'DRAW',  -7,   7/
      DATA IOPERA( 124),IX( 124),IY( 124)/'DRAW',  -8,   3/
      DATA IOPERA( 125),IX( 125),IY( 125)/'DRAW',  -8,   0/
      DATA IOPERA( 126),IX( 126),IY( 126)/'DRAW',  -7,  -4/
      DATA IOPERA( 127),IX( 127),IY( 127)/'DRAW',  -6,  -6/
      DATA IOPERA( 128),IX( 128),IY( 128)/'DRAW',  -4,  -8/
      DATA IOPERA( 129),IX( 129),IY( 129)/'DRAW',  -1,  -9/
      DATA IOPERA( 130),IX( 130),IY( 130)/'DRAW',   1,  -9/
      DATA IOPERA( 131),IX( 131),IY( 131)/'DRAW',   4,  -8/
      DATA IOPERA( 132),IX( 132),IY( 132)/'DRAW',   6,  -6/
      DATA IOPERA( 133),IX( 133),IY( 133)/'DRAW',   7,  -4/
      DATA IOPERA( 134),IX( 134),IY( 134)/'DRAW',   8,   0/
      DATA IOPERA( 135),IX( 135),IY( 135)/'DRAW',   8,   3/
      DATA IOPERA( 136),IX( 136),IY( 136)/'DRAW',   7,   7/
      DATA IOPERA( 137),IX( 137),IY( 137)/'DRAW',   6,   9/
      DATA IOPERA( 138),IX( 138),IY( 138)/'DRAW',   4,  11/
      DATA IOPERA( 139),IX( 139),IY( 139)/'DRAW',   1,  12/
      DATA IOPERA( 140),IX( 140),IY( 140)/'DRAW',  -1,  12/
      DATA IOPERA( 141),IX( 141),IY( 141)/'MOVE',  -5,   9/
      DATA IOPERA( 142),IX( 142),IY( 142)/'DRAW',  -6,   7/
      DATA IOPERA( 143),IX( 143),IY( 143)/'DRAW',  -7,   4/
      DATA IOPERA( 144),IX( 144),IY( 144)/'DRAW',  -7,  -1/
      DATA IOPERA( 145),IX( 145),IY( 145)/'DRAW',  -6,  -4/
      DATA IOPERA( 146),IX( 146),IY( 146)/'DRAW',  -5,  -6/
      DATA IOPERA( 147),IX( 147),IY( 147)/'MOVE',   5,  -6/
      DATA IOPERA( 148),IX( 148),IY( 148)/'DRAW',   6,  -4/
      DATA IOPERA( 149),IX( 149),IY( 149)/'DRAW',   7,  -1/
      DATA IOPERA( 150),IX( 150),IY( 150)/'DRAW',   7,   4/
      DATA IOPERA( 151),IX( 151),IY( 151)/'DRAW',   6,   7/
      DATA IOPERA( 152),IX( 152),IY( 152)/'DRAW',   5,   9/
      DATA IOPERA( 153),IX( 153),IY( 153)/'MOVE',  -1,  12/
      DATA IOPERA( 154),IX( 154),IY( 154)/'DRAW',  -3,  11/
      DATA IOPERA( 155),IX( 155),IY( 155)/'DRAW',  -5,   8/
      DATA IOPERA( 156),IX( 156),IY( 156)/'DRAW',  -6,   4/
      DATA IOPERA( 157),IX( 157),IY( 157)/'DRAW',  -6,  -1/
      DATA IOPERA( 158),IX( 158),IY( 158)/'DRAW',  -5,  -5/
      DATA IOPERA( 159),IX( 159),IY( 159)/'DRAW',  -3,  -8/
      DATA IOPERA( 160),IX( 160),IY( 160)/'DRAW',  -1,  -9/
      DATA IOPERA( 161),IX( 161),IY( 161)/'MOVE',   1,  -9/
      DATA IOPERA( 162),IX( 162),IY( 162)/'DRAW',   3,  -8/
      DATA IOPERA( 163),IX( 163),IY( 163)/'DRAW',   5,  -5/
      DATA IOPERA( 164),IX( 164),IY( 164)/'DRAW',   6,  -1/
      DATA IOPERA( 165),IX( 165),IY( 165)/'DRAW',   6,   4/
      DATA IOPERA( 166),IX( 166),IY( 166)/'DRAW',   5,   8/
      DATA IOPERA( 167),IX( 167),IY( 167)/'DRAW',   3,  11/
      DATA IOPERA( 168),IX( 168),IY( 168)/'DRAW',   1,  12/
      DATA IOPERA( 169),IX( 169),IY( 169)/'MOVE',  -4,  -6/
      DATA IOPERA( 170),IX( 170),IY( 170)/'DRAW',  -3,  -4/
      DATA IOPERA( 171),IX( 171),IY( 171)/'DRAW',  -1,  -3/
      DATA IOPERA( 172),IX( 172),IY( 172)/'DRAW',   0,  -3/
      DATA IOPERA( 173),IX( 173),IY( 173)/'DRAW',   2,  -4/
      DATA IOPERA( 174),IX( 174),IY( 174)/'DRAW',   3,  -6/
      DATA IOPERA( 175),IX( 175),IY( 175)/'DRAW',   4, -12/
      DATA IOPERA( 176),IX( 176),IY( 176)/'DRAW',   5, -14/
      DATA IOPERA( 177),IX( 177),IY( 177)/'DRAW',   7, -14/
      DATA IOPERA( 178),IX( 178),IY( 178)/'DRAW',   8, -12/
      DATA IOPERA( 179),IX( 179),IY( 179)/'DRAW',   8, -10/
      DATA IOPERA( 180),IX( 180),IY( 180)/'MOVE',   4, -10/
      DATA IOPERA( 181),IX( 181),IY( 181)/'DRAW',   5, -12/
      DATA IOPERA( 182),IX( 182),IY( 182)/'DRAW',   6, -13/
      DATA IOPERA( 183),IX( 183),IY( 183)/'DRAW',   7, -13/
      DATA IOPERA( 184),IX( 184),IY( 184)/'MOVE',   3,  -6/
      DATA IOPERA( 185),IX( 185),IY( 185)/'DRAW',   5, -11/
      DATA IOPERA( 186),IX( 186),IY( 186)/'DRAW',   6, -12/
      DATA IOPERA( 187),IX( 187),IY( 187)/'DRAW',   7, -12/
      DATA IOPERA( 188),IX( 188),IY( 188)/'DRAW',   8, -11/
C
      DATA IXMIND(  17)/ -11/
      DATA IXMAXD(  17)/  11/
      DATA IXDELD(  17)/  22/
      DATA ISTARD(  17)/ 120/
      DATA NUMCOO(  17)/  69/
C
C     DEFINE CHARACTER   3018--UPPER CASE R
C
      DATA IOPERA( 189),IX( 189),IY( 189)/'MOVE',  -6,  12/
      DATA IOPERA( 190),IX( 190),IY( 190)/'DRAW',  -6,  -9/
      DATA IOPERA( 191),IX( 191),IY( 191)/'MOVE',  -5,  11/
      DATA IOPERA( 192),IX( 192),IY( 192)/'DRAW',  -5,  -8/
      DATA IOPERA( 193),IX( 193),IY( 193)/'MOVE',  -4,  12/
      DATA IOPERA( 194),IX( 194),IY( 194)/'DRAW',  -4,  -9/
      DATA IOPERA( 195),IX( 195),IY( 195)/'MOVE',  -9,  12/
      DATA IOPERA( 196),IX( 196),IY( 196)/'DRAW',   3,  12/
      DATA IOPERA( 197),IX( 197),IY( 197)/'DRAW',   6,  11/
      DATA IOPERA( 198),IX( 198),IY( 198)/'DRAW',   7,  10/
      DATA IOPERA( 199),IX( 199),IY( 199)/'DRAW',   8,   8/
      DATA IOPERA( 200),IX( 200),IY( 200)/'DRAW',   8,   6/
      DATA IOPERA( 201),IX( 201),IY( 201)/'DRAW',   7,   4/
      DATA IOPERA( 202),IX( 202),IY( 202)/'DRAW',   6,   3/
      DATA IOPERA( 203),IX( 203),IY( 203)/'DRAW',   3,   2/
      DATA IOPERA( 204),IX( 204),IY( 204)/'DRAW',  -4,   2/
      DATA IOPERA( 205),IX( 205),IY( 205)/'MOVE',   6,  10/
      DATA IOPERA( 206),IX( 206),IY( 206)/'DRAW',   7,   8/
      DATA IOPERA( 207),IX( 207),IY( 207)/'DRAW',   7,   6/
      DATA IOPERA( 208),IX( 208),IY( 208)/'DRAW',   6,   4/
      DATA IOPERA( 209),IX( 209),IY( 209)/'MOVE',   3,  12/
      DATA IOPERA( 210),IX( 210),IY( 210)/'DRAW',   5,  11/
      DATA IOPERA( 211),IX( 211),IY( 211)/'DRAW',   6,   9/
      DATA IOPERA( 212),IX( 212),IY( 212)/'DRAW',   6,   5/
      DATA IOPERA( 213),IX( 213),IY( 213)/'DRAW',   5,   3/
      DATA IOPERA( 214),IX( 214),IY( 214)/'DRAW',   3,   2/
      DATA IOPERA( 215),IX( 215),IY( 215)/'MOVE',   0,   2/
      DATA IOPERA( 216),IX( 216),IY( 216)/'DRAW',   2,   1/
      DATA IOPERA( 217),IX( 217),IY( 217)/'DRAW',   3,  -1/
      DATA IOPERA( 218),IX( 218),IY( 218)/'DRAW',   5,  -7/
      DATA IOPERA( 219),IX( 219),IY( 219)/'DRAW',   6,  -9/
      DATA IOPERA( 220),IX( 220),IY( 220)/'DRAW',   8,  -9/
      DATA IOPERA( 221),IX( 221),IY( 221)/'DRAW',   9,  -7/
      DATA IOPERA( 222),IX( 222),IY( 222)/'DRAW',   9,  -5/
      DATA IOPERA( 223),IX( 223),IY( 223)/'MOVE',   5,  -5/
      DATA IOPERA( 224),IX( 224),IY( 224)/'DRAW',   6,  -7/
      DATA IOPERA( 225),IX( 225),IY( 225)/'DRAW',   7,  -8/
      DATA IOPERA( 226),IX( 226),IY( 226)/'DRAW',   8,  -8/
      DATA IOPERA( 227),IX( 227),IY( 227)/'MOVE',   2,   1/
      DATA IOPERA( 228),IX( 228),IY( 228)/'DRAW',   3,   0/
      DATA IOPERA( 229),IX( 229),IY( 229)/'DRAW',   6,  -6/
      DATA IOPERA( 230),IX( 230),IY( 230)/'DRAW',   7,  -7/
      DATA IOPERA( 231),IX( 231),IY( 231)/'DRAW',   8,  -7/
      DATA IOPERA( 232),IX( 232),IY( 232)/'DRAW',   9,  -6/
      DATA IOPERA( 233),IX( 233),IY( 233)/'MOVE',  -9,  -9/
      DATA IOPERA( 234),IX( 234),IY( 234)/'DRAW',  -1,  -9/
      DATA IOPERA( 235),IX( 235),IY( 235)/'MOVE',  -8,  12/
      DATA IOPERA( 236),IX( 236),IY( 236)/'DRAW',  -6,  11/
      DATA IOPERA( 237),IX( 237),IY( 237)/'MOVE',  -7,  12/
      DATA IOPERA( 238),IX( 238),IY( 238)/'DRAW',  -6,  10/
      DATA IOPERA( 239),IX( 239),IY( 239)/'MOVE',  -3,  12/
      DATA IOPERA( 240),IX( 240),IY( 240)/'DRAW',  -4,  10/
      DATA IOPERA( 241),IX( 241),IY( 241)/'MOVE',  -2,  12/
      DATA IOPERA( 242),IX( 242),IY( 242)/'DRAW',  -4,  11/
      DATA IOPERA( 243),IX( 243),IY( 243)/'MOVE',  -6,  -8/
      DATA IOPERA( 244),IX( 244),IY( 244)/'DRAW',  -8,  -9/
      DATA IOPERA( 245),IX( 245),IY( 245)/'MOVE',  -6,  -7/
      DATA IOPERA( 246),IX( 246),IY( 246)/'DRAW',  -7,  -9/
      DATA IOPERA( 247),IX( 247),IY( 247)/'MOVE',  -4,  -7/
      DATA IOPERA( 248),IX( 248),IY( 248)/'DRAW',  -3,  -9/
      DATA IOPERA( 249),IX( 249),IY( 249)/'MOVE',  -4,  -8/
      DATA IOPERA( 250),IX( 250),IY( 250)/'DRAW',  -2,  -9/
C
      DATA IXMIND(  18)/ -11/
      DATA IXMAXD(  18)/  11/
      DATA IXDELD(  18)/  22/
      DATA ISTARD(  18)/ 189/
      DATA NUMCOO(  18)/  62/
C
C     DEFINE CHARACTER   3019--UPPER CASE S
C
      DATA IOPERA( 251),IX( 251),IY( 251)/'MOVE',   6,   9/
      DATA IOPERA( 252),IX( 252),IY( 252)/'DRAW',   7,  12/
      DATA IOPERA( 253),IX( 253),IY( 253)/'DRAW',   7,   6/
      DATA IOPERA( 254),IX( 254),IY( 254)/'DRAW',   6,   9/
      DATA IOPERA( 255),IX( 255),IY( 255)/'DRAW',   4,  11/
      DATA IOPERA( 256),IX( 256),IY( 256)/'DRAW',   1,  12/
      DATA IOPERA( 257),IX( 257),IY( 257)/'DRAW',  -2,  12/
      DATA IOPERA( 258),IX( 258),IY( 258)/'DRAW',  -5,  11/
      DATA IOPERA( 259),IX( 259),IY( 259)/'DRAW',  -7,   9/
      DATA IOPERA( 260),IX( 260),IY( 260)/'DRAW',  -7,   6/
      DATA IOPERA( 261),IX( 261),IY( 261)/'DRAW',  -6,   4/
      DATA IOPERA( 262),IX( 262),IY( 262)/'DRAW',  -3,   2/
      DATA IOPERA( 263),IX( 263),IY( 263)/'DRAW',   3,   0/
      DATA IOPERA( 264),IX( 264),IY( 264)/'DRAW',   5,  -1/
      DATA IOPERA( 265),IX( 265),IY( 265)/'DRAW',   6,  -3/
      DATA IOPERA( 266),IX( 266),IY( 266)/'DRAW',   6,  -6/
      DATA IOPERA( 267),IX( 267),IY( 267)/'DRAW',   5,  -8/
      DATA IOPERA( 268),IX( 268),IY( 268)/'MOVE',  -6,   6/
      DATA IOPERA( 269),IX( 269),IY( 269)/'DRAW',  -5,   4/
      DATA IOPERA( 270),IX( 270),IY( 270)/'DRAW',  -3,   3/
      DATA IOPERA( 271),IX( 271),IY( 271)/'DRAW',   3,   1/
      DATA IOPERA( 272),IX( 272),IY( 272)/'DRAW',   5,   0/
      DATA IOPERA( 273),IX( 273),IY( 273)/'DRAW',   6,  -2/
      DATA IOPERA( 274),IX( 274),IY( 274)/'MOVE',  -5,  11/
      DATA IOPERA( 275),IX( 275),IY( 275)/'DRAW',  -6,   9/
      DATA IOPERA( 276),IX( 276),IY( 276)/'DRAW',  -6,   7/
      DATA IOPERA( 277),IX( 277),IY( 277)/'DRAW',  -5,   5/
      DATA IOPERA( 278),IX( 278),IY( 278)/'DRAW',  -3,   4/
      DATA IOPERA( 279),IX( 279),IY( 279)/'DRAW',   3,   2/
      DATA IOPERA( 280),IX( 280),IY( 280)/'DRAW',   6,   0/
      DATA IOPERA( 281),IX( 281),IY( 281)/'DRAW',   7,  -2/
      DATA IOPERA( 282),IX( 282),IY( 282)/'DRAW',   7,  -5/
      DATA IOPERA( 283),IX( 283),IY( 283)/'DRAW',   6,  -7/
      DATA IOPERA( 284),IX( 284),IY( 284)/'DRAW',   5,  -8/
      DATA IOPERA( 285),IX( 285),IY( 285)/'DRAW',   2,  -9/
      DATA IOPERA( 286),IX( 286),IY( 286)/'DRAW',  -1,  -9/
      DATA IOPERA( 287),IX( 287),IY( 287)/'DRAW',  -4,  -8/
      DATA IOPERA( 288),IX( 288),IY( 288)/'DRAW',  -6,  -6/
      DATA IOPERA( 289),IX( 289),IY( 289)/'DRAW',  -7,  -3/
      DATA IOPERA( 290),IX( 290),IY( 290)/'DRAW',  -7,  -9/
      DATA IOPERA( 291),IX( 291),IY( 291)/'DRAW',  -6,  -6/
C
      DATA IXMIND(  19)/ -10/
      DATA IXMAXD(  19)/  10/
      DATA IXDELD(  19)/  20/
      DATA ISTARD(  19)/ 251/
      DATA NUMCOO(  19)/  41/
C
C-----START POINT-----------------------------------------------------
C
      IFOUND='YES'
      IERROR='NO'
C
      NUMCO=1
      ISTART=1
      ISTOP=1
      NC=1
C
C               ******************************************
C               **  TREAT THE ROMAN SIMPLEX UPPER CASE  **
C               **  HERSHEY CHARACTER SET CASE          **
C               ******************************************
C
C
      IF(IBUGD2.EQ.'OFF')GOTO90
      WRITE(ICOUT,999)
  999 FORMAT(1X)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,51)
   51 FORMAT('***** AT THE BEGINNING OF DRTU3--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,52)ICHARN
   52 FORMAT('ICHARN = ',I8)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,59)IBUGD2,IFOUND,IERROR
   59 FORMAT('IBUGD2,IFOUND,IERROR = ',A4,2X,A4,2X,A4)
      CALL DPWRST('XXX','BUG ')
   90 CONTINUE
C
C               **************************************
C               **  STEP 2--                        **
C               **  EXTRACT THE COORDINATES         **
C               **  FOR THIS PARTICULAR CHARACTER.  **
C               **************************************
C
      ISTART=ISTARD(ICHARN)
      NC=NUMCOO(ICHARN)
      ISTOP=ISTART+NC-1
      J=0
      DO1100I=ISTART,ISTOP
      J=J+1
      IOP(J)=IOPERA(I)
      X(J)=IX(I)
      Y(J)=IY(I)
 1100 CONTINUE
      NUMCO=J
      IXMINS=IXMIND(ICHARN)
      IXMAXS=IXMAXD(ICHARN)
      IXDELS=IXDELD(ICHARN)
C
      GOTO9000
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT       **
C               *****************
C
 9000 CONTINUE
      IF(IBUGD2.EQ.'OFF')GOTO9090
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9011)
 9011 FORMAT('***** AT THE END       OF DRTU3--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9012)IBUGD2,IFOUND,IERROR
 9012 FORMAT('IBUGD2,IFOUND,IERROR = ',A4,2X,A4,2X,A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9013)ICHARN
 9013 FORMAT('ICHARN = ',I8)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9014)ISTART,ISTOP,NC,NUMCO
 9014 FORMAT('ISTART,ISTOP,NC,NUMCO = ',4I8)
      CALL DPWRST('XXX','BUG ')
      IF(NUMCO.GE.1.AND.NUMCO.LE.1000)GOTO9019
      DO9015I=1,NUMCO
      WRITE(ICOUT,9016)I,IOP(I),X(I),Y(I)
 9016 FORMAT('I,IOP(I),X(I),Y(I) = ',I8,2X,A4,2F10.2)
      CALL DPWRST('XXX','BUG ')
 9015 CONTINUE
 9019 CONTINUE
      WRITE(ICOUT,9021)IXMINS,IXMAXS,IXDELS
 9021 FORMAT('IXMINS,IXMAXS,IXDELS = ',3I8)
      CALL DPWRST('XXX','BUG ')
 9090 CONTINUE
C
      RETURN
      END
      SUBROUTINE DRTU4(ICHARN,IOP,X,Y,NUMCO,IXMINS,IXMAXS,IXDELS,
     1IBUGD2,IFOUND,IERROR)
C
C     PURPOSE--DEFINE AND SET THE HERSHEY CHARACTER SET COORDINATES
C              FOR ROMAN TRIPLEX UPPER CASE (PART 4).
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--87/4
C     ORIGINAL VERSION (AS A SEPARATE SUBROUTINE)--MARCH     1981.
C     UPDATED         --MAY       1982.
C     UPDATED         --MARCH     1987.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 IOP
      CHARACTER*4 IBUGD2
      CHARACTER*4 IFOUND
      CHARACTER*4 IERROR
C
      CHARACTER*4 IOPERA
C
C---------------------------------------------------------------------
C
      DIMENSION IOP(*)
      DIMENSION X(*)
      DIMENSION Y(*)
C
      DIMENSION IOPERA(300)
      DIMENSION IX(300)
      DIMENSION IY(300)
C
      DIMENSION IXMIND(30)
      DIMENSION IXMAXD(30)
      DIMENSION IXDELD(30)
      DIMENSION ISTARD(30)
      DIMENSION NUMCOO(30)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----DATA STATEMENTS-------------------------------------------------
C
C     DEFINE CHARACTER   3020--UPPER CASE T
C
      DATA IOPERA(   1),IX(   1),IY(   1)/'MOVE',  -8,  12/
      DATA IOPERA(   2),IX(   2),IY(   2)/'DRAW',  -8,   6/
      DATA IOPERA(   3),IX(   3),IY(   3)/'MOVE',  -1,  12/
      DATA IOPERA(   4),IX(   4),IY(   4)/'DRAW',  -1,  -9/
      DATA IOPERA(   5),IX(   5),IY(   5)/'MOVE',   0,  11/
      DATA IOPERA(   6),IX(   6),IY(   6)/'DRAW',   0,  -8/
      DATA IOPERA(   7),IX(   7),IY(   7)/'MOVE',   1,  12/
      DATA IOPERA(   8),IX(   8),IY(   8)/'DRAW',   1,  -9/
      DATA IOPERA(   9),IX(   9),IY(   9)/'MOVE',   8,  12/
      DATA IOPERA(  10),IX(  10),IY(  10)/'DRAW',   8,   6/
      DATA IOPERA(  11),IX(  11),IY(  11)/'MOVE',  -8,  12/
      DATA IOPERA(  12),IX(  12),IY(  12)/'DRAW',   8,  12/
      DATA IOPERA(  13),IX(  13),IY(  13)/'MOVE',  -4,  -9/
      DATA IOPERA(  14),IX(  14),IY(  14)/'DRAW',   4,  -9/
      DATA IOPERA(  15),IX(  15),IY(  15)/'MOVE',  -7,  12/
      DATA IOPERA(  16),IX(  16),IY(  16)/'DRAW',  -8,   6/
      DATA IOPERA(  17),IX(  17),IY(  17)/'MOVE',  -6,  12/
      DATA IOPERA(  18),IX(  18),IY(  18)/'DRAW',  -8,   9/
      DATA IOPERA(  19),IX(  19),IY(  19)/'MOVE',  -5,  12/
      DATA IOPERA(  20),IX(  20),IY(  20)/'DRAW',  -8,  10/
      DATA IOPERA(  21),IX(  21),IY(  21)/'MOVE',  -3,  12/
      DATA IOPERA(  22),IX(  22),IY(  22)/'DRAW',  -8,  11/
      DATA IOPERA(  23),IX(  23),IY(  23)/'MOVE',   3,  12/
      DATA IOPERA(  24),IX(  24),IY(  24)/'DRAW',   8,  11/
      DATA IOPERA(  25),IX(  25),IY(  25)/'MOVE',   5,  12/
      DATA IOPERA(  26),IX(  26),IY(  26)/'DRAW',   8,  10/
      DATA IOPERA(  27),IX(  27),IY(  27)/'MOVE',   6,  12/
      DATA IOPERA(  28),IX(  28),IY(  28)/'DRAW',   8,   9/
      DATA IOPERA(  29),IX(  29),IY(  29)/'MOVE',   7,  12/
      DATA IOPERA(  30),IX(  30),IY(  30)/'DRAW',   8,   6/
      DATA IOPERA(  31),IX(  31),IY(  31)/'MOVE',  -1,  -8/
      DATA IOPERA(  32),IX(  32),IY(  32)/'DRAW',  -3,  -9/
      DATA IOPERA(  33),IX(  33),IY(  33)/'MOVE',  -1,  -7/
      DATA IOPERA(  34),IX(  34),IY(  34)/'DRAW',  -2,  -9/
      DATA IOPERA(  35),IX(  35),IY(  35)/'MOVE',   1,  -7/
      DATA IOPERA(  36),IX(  36),IY(  36)/'DRAW',   2,  -9/
      DATA IOPERA(  37),IX(  37),IY(  37)/'MOVE',   1,  -8/
      DATA IOPERA(  38),IX(  38),IY(  38)/'DRAW',   3,  -9/
C
      DATA IXMIND(  20)/ -10/
      DATA IXMAXD(  20)/  10/
      DATA IXDELD(  20)/  20/
      DATA ISTARD(  20)/   1/
      DATA NUMCOO(  20)/  38/
C
C     DEFINE CHARACTER   3021--UPPER CASE U
C
      DATA IOPERA(  39),IX(  39),IY(  39)/'MOVE',  -7,  12/
      DATA IOPERA(  40),IX(  40),IY(  40)/'DRAW',  -7,  -3/
      DATA IOPERA(  41),IX(  41),IY(  41)/'DRAW',  -6,  -6/
      DATA IOPERA(  42),IX(  42),IY(  42)/'DRAW',  -4,  -8/
      DATA IOPERA(  43),IX(  43),IY(  43)/'DRAW',  -1,  -9/
      DATA IOPERA(  44),IX(  44),IY(  44)/'DRAW',   1,  -9/
      DATA IOPERA(  45),IX(  45),IY(  45)/'DRAW',   4,  -8/
      DATA IOPERA(  46),IX(  46),IY(  46)/'DRAW',   6,  -6/
      DATA IOPERA(  47),IX(  47),IY(  47)/'DRAW',   7,  -3/
      DATA IOPERA(  48),IX(  48),IY(  48)/'DRAW',   7,  11/
      DATA IOPERA(  49),IX(  49),IY(  49)/'MOVE',  -6,  11/
      DATA IOPERA(  50),IX(  50),IY(  50)/'DRAW',  -6,  -4/
      DATA IOPERA(  51),IX(  51),IY(  51)/'DRAW',  -5,  -6/
      DATA IOPERA(  52),IX(  52),IY(  52)/'MOVE',  -5,  12/
      DATA IOPERA(  53),IX(  53),IY(  53)/'DRAW',  -5,  -4/
      DATA IOPERA(  54),IX(  54),IY(  54)/'DRAW',  -4,  -7/
      DATA IOPERA(  55),IX(  55),IY(  55)/'DRAW',  -3,  -8/
      DATA IOPERA(  56),IX(  56),IY(  56)/'DRAW',  -1,  -9/
      DATA IOPERA(  57),IX(  57),IY(  57)/'MOVE', -10,  12/
      DATA IOPERA(  58),IX(  58),IY(  58)/'DRAW',  -2,  12/
      DATA IOPERA(  59),IX(  59),IY(  59)/'MOVE',   4,  12/
      DATA IOPERA(  60),IX(  60),IY(  60)/'DRAW',  10,  12/
      DATA IOPERA(  61),IX(  61),IY(  61)/'MOVE',  -9,  12/
      DATA IOPERA(  62),IX(  62),IY(  62)/'DRAW',  -7,  11/
      DATA IOPERA(  63),IX(  63),IY(  63)/'MOVE',  -8,  12/
      DATA IOPERA(  64),IX(  64),IY(  64)/'DRAW',  -7,  10/
      DATA IOPERA(  65),IX(  65),IY(  65)/'MOVE',  -4,  12/
      DATA IOPERA(  66),IX(  66),IY(  66)/'DRAW',  -5,  10/
      DATA IOPERA(  67),IX(  67),IY(  67)/'MOVE',  -3,  12/
      DATA IOPERA(  68),IX(  68),IY(  68)/'DRAW',  -5,  11/
      DATA IOPERA(  69),IX(  69),IY(  69)/'MOVE',   5,  12/
      DATA IOPERA(  70),IX(  70),IY(  70)/'DRAW',   7,  11/
      DATA IOPERA(  71),IX(  71),IY(  71)/'MOVE',   9,  12/
      DATA IOPERA(  72),IX(  72),IY(  72)/'DRAW',   7,  11/
C
      DATA IXMIND(  21)/ -12/
      DATA IXMAXD(  21)/  12/
      DATA IXDELD(  21)/  24/
      DATA ISTARD(  21)/  39/
      DATA NUMCOO(  21)/  34/
C
C     DEFINE CHARACTER   3022--UPPER CASE V
C
      DATA IOPERA(  73),IX(  73),IY(  73)/'MOVE',  -7,  12/
      DATA IOPERA(  74),IX(  74),IY(  74)/'DRAW',   0,  -9/
      DATA IOPERA(  75),IX(  75),IY(  75)/'MOVE',  -6,  12/
      DATA IOPERA(  76),IX(  76),IY(  76)/'DRAW',   0,  -6/
      DATA IOPERA(  77),IX(  77),IY(  77)/'DRAW',   0,  -9/
      DATA IOPERA(  78),IX(  78),IY(  78)/'MOVE',  -5,  12/
      DATA IOPERA(  79),IX(  79),IY(  79)/'DRAW',   1,  -6/
      DATA IOPERA(  80),IX(  80),IY(  80)/'MOVE',   7,  11/
      DATA IOPERA(  81),IX(  81),IY(  81)/'DRAW',   0,  -9/
      DATA IOPERA(  82),IX(  82),IY(  82)/'MOVE',  -9,  12/
      DATA IOPERA(  83),IX(  83),IY(  83)/'DRAW',  -2,  12/
      DATA IOPERA(  84),IX(  84),IY(  84)/'MOVE',   3,  12/
      DATA IOPERA(  85),IX(  85),IY(  85)/'DRAW',   9,  12/
      DATA IOPERA(  86),IX(  86),IY(  86)/'MOVE',  -8,  12/
      DATA IOPERA(  87),IX(  87),IY(  87)/'DRAW',  -6,  10/
      DATA IOPERA(  88),IX(  88),IY(  88)/'MOVE',  -4,  12/
      DATA IOPERA(  89),IX(  89),IY(  89)/'DRAW',  -5,  10/
      DATA IOPERA(  90),IX(  90),IY(  90)/'MOVE',  -3,  12/
      DATA IOPERA(  91),IX(  91),IY(  91)/'DRAW',  -5,  11/
      DATA IOPERA(  92),IX(  92),IY(  92)/'MOVE',   5,  12/
      DATA IOPERA(  93),IX(  93),IY(  93)/'DRAW',   7,  11/
      DATA IOPERA(  94),IX(  94),IY(  94)/'MOVE',   8,  12/
      DATA IOPERA(  95),IX(  95),IY(  95)/'DRAW',   7,  11/
C
      DATA IXMIND(  22)/ -10/
      DATA IXMAXD(  22)/  10/
      DATA IXDELD(  22)/  20/
      DATA ISTARD(  22)/  73/
      DATA NUMCOO(  22)/  23/
C
C     DEFINE CHARACTER   3023--UPPER CASE W
C
      DATA IOPERA(  96),IX(  96),IY(  96)/'MOVE',  -8,  12/
      DATA IOPERA(  97),IX(  97),IY(  97)/'DRAW',  -4,  -9/
      DATA IOPERA(  98),IX(  98),IY(  98)/'MOVE',  -7,  12/
      DATA IOPERA(  99),IX(  99),IY(  99)/'DRAW',  -4,  -4/
      DATA IOPERA( 100),IX( 100),IY( 100)/'DRAW',  -4,  -9/
      DATA IOPERA( 101),IX( 101),IY( 101)/'MOVE',  -6,  12/
      DATA IOPERA( 102),IX( 102),IY( 102)/'DRAW',  -3,  -4/
      DATA IOPERA( 103),IX( 103),IY( 103)/'MOVE',   0,  12/
      DATA IOPERA( 104),IX( 104),IY( 104)/'DRAW',  -3,  -4/
      DATA IOPERA( 105),IX( 105),IY( 105)/'DRAW',  -4,  -9/
      DATA IOPERA( 106),IX( 106),IY( 106)/'MOVE',   0,  12/
      DATA IOPERA( 107),IX( 107),IY( 107)/'DRAW',   4,  -9/
      DATA IOPERA( 108),IX( 108),IY( 108)/'MOVE',   1,  12/
      DATA IOPERA( 109),IX( 109),IY( 109)/'DRAW',   4,  -4/
      DATA IOPERA( 110),IX( 110),IY( 110)/'DRAW',   4,  -9/
      DATA IOPERA( 111),IX( 111),IY( 111)/'MOVE',   2,  12/
      DATA IOPERA( 112),IX( 112),IY( 112)/'DRAW',   5,  -4/
      DATA IOPERA( 113),IX( 113),IY( 113)/'MOVE',   8,  11/
      DATA IOPERA( 114),IX( 114),IY( 114)/'DRAW',   5,  -4/
      DATA IOPERA( 115),IX( 115),IY( 115)/'DRAW',   4,  -9/
      DATA IOPERA( 116),IX( 116),IY( 116)/'MOVE', -11,  12/
      DATA IOPERA( 117),IX( 117),IY( 117)/'DRAW',  -3,  12/
      DATA IOPERA( 118),IX( 118),IY( 118)/'MOVE',   0,  12/
      DATA IOPERA( 119),IX( 119),IY( 119)/'DRAW',   2,  12/
      DATA IOPERA( 120),IX( 120),IY( 120)/'MOVE',   5,  12/
      DATA IOPERA( 121),IX( 121),IY( 121)/'DRAW',  11,  12/
      DATA IOPERA( 122),IX( 122),IY( 122)/'MOVE', -10,  12/
      DATA IOPERA( 123),IX( 123),IY( 123)/'DRAW',  -7,  11/
      DATA IOPERA( 124),IX( 124),IY( 124)/'MOVE',  -9,  12/
      DATA IOPERA( 125),IX( 125),IY( 125)/'DRAW',  -7,  10/
      DATA IOPERA( 126),IX( 126),IY( 126)/'MOVE',  -5,  12/
      DATA IOPERA( 127),IX( 127),IY( 127)/'DRAW',  -6,  10/
      DATA IOPERA( 128),IX( 128),IY( 128)/'MOVE',  -4,  12/
      DATA IOPERA( 129),IX( 129),IY( 129)/'DRAW',  -6,  11/
      DATA IOPERA( 130),IX( 130),IY( 130)/'MOVE',   6,  12/
      DATA IOPERA( 131),IX( 131),IY( 131)/'DRAW',   8,  11/
      DATA IOPERA( 132),IX( 132),IY( 132)/'MOVE',  10,  12/
      DATA IOPERA( 133),IX( 133),IY( 133)/'DRAW',   8,  11/
C
      DATA IXMIND(  23)/ -12/
      DATA IXMAXD(  23)/  12/
      DATA IXDELD(  23)/  24/
      DATA ISTARD(  23)/  96/
      DATA NUMCOO(  23)/  38/
C
C     DEFINE CHARACTER   3024--UPPER CASE X
C
      DATA IOPERA( 134),IX( 134),IY( 134)/'MOVE',  -7,  12/
      DATA IOPERA( 135),IX( 135),IY( 135)/'DRAW',   5,  -9/
      DATA IOPERA( 136),IX( 136),IY( 136)/'MOVE',  -6,  12/
      DATA IOPERA( 137),IX( 137),IY( 137)/'DRAW',   6,  -9/
      DATA IOPERA( 138),IX( 138),IY( 138)/'MOVE',  -5,  12/
      DATA IOPERA( 139),IX( 139),IY( 139)/'DRAW',   7,  -9/
      DATA IOPERA( 140),IX( 140),IY( 140)/'MOVE',   6,  11/
      DATA IOPERA( 141),IX( 141),IY( 141)/'DRAW',  -6,  -8/
      DATA IOPERA( 142),IX( 142),IY( 142)/'MOVE',  -9,  12/
      DATA IOPERA( 143),IX( 143),IY( 143)/'DRAW',  -2,  12/
      DATA IOPERA( 144),IX( 144),IY( 144)/'MOVE',   3,  12/
      DATA IOPERA( 145),IX( 145),IY( 145)/'DRAW',   9,  12/
      DATA IOPERA( 146),IX( 146),IY( 146)/'MOVE',  -9,  -9/
      DATA IOPERA( 147),IX( 147),IY( 147)/'DRAW',  -3,  -9/
      DATA IOPERA( 148),IX( 148),IY( 148)/'MOVE',   2,  -9/
      DATA IOPERA( 149),IX( 149),IY( 149)/'DRAW',   9,  -9/
      DATA IOPERA( 150),IX( 150),IY( 150)/'MOVE',  -8,  12/
      DATA IOPERA( 151),IX( 151),IY( 151)/'DRAW',  -5,  10/
      DATA IOPERA( 152),IX( 152),IY( 152)/'MOVE',  -4,  12/
      DATA IOPERA( 153),IX( 153),IY( 153)/'DRAW',  -5,  10/
      DATA IOPERA( 154),IX( 154),IY( 154)/'MOVE',  -3,  12/
      DATA IOPERA( 155),IX( 155),IY( 155)/'DRAW',  -5,  11/
      DATA IOPERA( 156),IX( 156),IY( 156)/'MOVE',   4,  12/
      DATA IOPERA( 157),IX( 157),IY( 157)/'DRAW',   6,  11/
      DATA IOPERA( 158),IX( 158),IY( 158)/'MOVE',   8,  12/
      DATA IOPERA( 159),IX( 159),IY( 159)/'DRAW',   6,  11/
      DATA IOPERA( 160),IX( 160),IY( 160)/'MOVE',  -6,  -8/
      DATA IOPERA( 161),IX( 161),IY( 161)/'DRAW',  -8,  -9/
      DATA IOPERA( 162),IX( 162),IY( 162)/'MOVE',  -6,  -8/
      DATA IOPERA( 163),IX( 163),IY( 163)/'DRAW',  -4,  -9/
      DATA IOPERA( 164),IX( 164),IY( 164)/'MOVE',   5,  -8/
      DATA IOPERA( 165),IX( 165),IY( 165)/'DRAW',   3,  -9/
      DATA IOPERA( 166),IX( 166),IY( 166)/'MOVE',   5,  -7/
      DATA IOPERA( 167),IX( 167),IY( 167)/'DRAW',   4,  -9/
      DATA IOPERA( 168),IX( 168),IY( 168)/'MOVE',   5,  -7/
      DATA IOPERA( 169),IX( 169),IY( 169)/'DRAW',   8,  -9/
C
      DATA IXMIND(  24)/ -10/
      DATA IXMAXD(  24)/  10/
      DATA IXDELD(  24)/  20/
      DATA ISTARD(  24)/ 134/
      DATA NUMCOO(  24)/  36/
C
C     DEFINE CHARACTER   3025--UPPER CASE Y
C
      DATA IOPERA( 170),IX( 170),IY( 170)/'MOVE',  -8,  12/
      DATA IOPERA( 171),IX( 171),IY( 171)/'DRAW',  -1,   1/
      DATA IOPERA( 172),IX( 172),IY( 172)/'DRAW',  -1,  -9/
      DATA IOPERA( 173),IX( 173),IY( 173)/'MOVE',  -7,  12/
      DATA IOPERA( 174),IX( 174),IY( 174)/'DRAW',   0,   1/
      DATA IOPERA( 175),IX( 175),IY( 175)/'DRAW',   0,  -8/
      DATA IOPERA( 176),IX( 176),IY( 176)/'MOVE',  -6,  12/
      DATA IOPERA( 177),IX( 177),IY( 177)/'DRAW',   1,   1/
      DATA IOPERA( 178),IX( 178),IY( 178)/'DRAW',   1,  -9/
      DATA IOPERA( 179),IX( 179),IY( 179)/'MOVE',   7,  11/
      DATA IOPERA( 180),IX( 180),IY( 180)/'DRAW',   1,   1/
      DATA IOPERA( 181),IX( 181),IY( 181)/'MOVE', -10,  12/
      DATA IOPERA( 182),IX( 182),IY( 182)/'DRAW',  -3,  12/
      DATA IOPERA( 183),IX( 183),IY( 183)/'MOVE',   4,  12/
      DATA IOPERA( 184),IX( 184),IY( 184)/'DRAW',  10,  12/
      DATA IOPERA( 185),IX( 185),IY( 185)/'MOVE',  -4,  -9/
      DATA IOPERA( 186),IX( 186),IY( 186)/'DRAW',   4,  -9/
      DATA IOPERA( 187),IX( 187),IY( 187)/'MOVE',  -9,  12/
      DATA IOPERA( 188),IX( 188),IY( 188)/'DRAW',  -7,  11/
      DATA IOPERA( 189),IX( 189),IY( 189)/'MOVE',  -4,  12/
      DATA IOPERA( 190),IX( 190),IY( 190)/'DRAW',  -6,  11/
      DATA IOPERA( 191),IX( 191),IY( 191)/'MOVE',   5,  12/
      DATA IOPERA( 192),IX( 192),IY( 192)/'DRAW',   7,  11/
      DATA IOPERA( 193),IX( 193),IY( 193)/'MOVE',   9,  12/
      DATA IOPERA( 194),IX( 194),IY( 194)/'DRAW',   7,  11/
      DATA IOPERA( 195),IX( 195),IY( 195)/'MOVE',  -1,  -8/
      DATA IOPERA( 196),IX( 196),IY( 196)/'DRAW',  -3,  -9/
      DATA IOPERA( 197),IX( 197),IY( 197)/'MOVE',  -1,  -7/
      DATA IOPERA( 198),IX( 198),IY( 198)/'DRAW',  -2,  -9/
      DATA IOPERA( 199),IX( 199),IY( 199)/'MOVE',   1,  -7/
      DATA IOPERA( 200),IX( 200),IY( 200)/'DRAW',   2,  -9/
      DATA IOPERA( 201),IX( 201),IY( 201)/'MOVE',   1,  -8/
      DATA IOPERA( 202),IX( 202),IY( 202)/'DRAW',   3,  -9/
C
      DATA IXMIND(  25)/ -11/
      DATA IXMAXD(  25)/  11/
      DATA IXDELD(  25)/  22/
      DATA ISTARD(  25)/ 170/
      DATA NUMCOO(  25)/  33/
C
C     DEFINE CHARACTER   3026--UPPER CASE Z
C
      DATA IOPERA( 203),IX( 203),IY( 203)/'MOVE',   7,  12/
      DATA IOPERA( 204),IX( 204),IY( 204)/'DRAW',  -7,  12/
      DATA IOPERA( 205),IX( 205),IY( 205)/'DRAW',  -7,   6/
      DATA IOPERA( 206),IX( 206),IY( 206)/'MOVE',   5,  12/
      DATA IOPERA( 207),IX( 207),IY( 207)/'DRAW',  -7,  -9/
      DATA IOPERA( 208),IX( 208),IY( 208)/'MOVE',   6,  12/
      DATA IOPERA( 209),IX( 209),IY( 209)/'DRAW',  -6,  -9/
      DATA IOPERA( 210),IX( 210),IY( 210)/'MOVE',   7,  12/
      DATA IOPERA( 211),IX( 211),IY( 211)/'DRAW',  -5,  -9/
      DATA IOPERA( 212),IX( 212),IY( 212)/'MOVE',  -7,  -9/
      DATA IOPERA( 213),IX( 213),IY( 213)/'DRAW',   7,  -9/
      DATA IOPERA( 214),IX( 214),IY( 214)/'DRAW',   7,  -3/
      DATA IOPERA( 215),IX( 215),IY( 215)/'MOVE',  -6,  12/
      DATA IOPERA( 216),IX( 216),IY( 216)/'DRAW',  -7,   6/
      DATA IOPERA( 217),IX( 217),IY( 217)/'MOVE',  -5,  12/
      DATA IOPERA( 218),IX( 218),IY( 218)/'DRAW',  -7,   9/
      DATA IOPERA( 219),IX( 219),IY( 219)/'MOVE',  -4,  12/
      DATA IOPERA( 220),IX( 220),IY( 220)/'DRAW',  -7,  10/
      DATA IOPERA( 221),IX( 221),IY( 221)/'MOVE',  -2,  12/
      DATA IOPERA( 222),IX( 222),IY( 222)/'DRAW',  -7,  11/
      DATA IOPERA( 223),IX( 223),IY( 223)/'MOVE',   2,  -9/
      DATA IOPERA( 224),IX( 224),IY( 224)/'DRAW',   7,  -8/
      DATA IOPERA( 225),IX( 225),IY( 225)/'MOVE',   4,  -9/
      DATA IOPERA( 226),IX( 226),IY( 226)/'DRAW',   7,  -7/
      DATA IOPERA( 227),IX( 227),IY( 227)/'MOVE',   5,  -9/
      DATA IOPERA( 228),IX( 228),IY( 228)/'DRAW',   7,  -6/
      DATA IOPERA( 229),IX( 229),IY( 229)/'MOVE',   6,  -9/
      DATA IOPERA( 230),IX( 230),IY( 230)/'DRAW',   7,  -3/
C
      DATA IXMIND(  26)/ -10/
      DATA IXMAXD(  26)/  10/
      DATA IXDELD(  26)/  20/
      DATA ISTARD(  26)/ 203/
      DATA NUMCOO(  26)/  28/
C
C-----START POINT-----------------------------------------------------
C
      IFOUND='YES'
      IERROR='NO'
C
      NUMCO=1
      ISTART=1
      ISTOP=1
      NC=1
C
C               ******************************************
C               **  TREAT THE ROMAN SIMPLEX UPPER CASE  **
C               **  HERSHEY CHARACTER SET CASE          **
C               ******************************************
C
C
      IF(IBUGD2.EQ.'OFF')GOTO90
      WRITE(ICOUT,999)
  999 FORMAT(1X)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,51)
   51 FORMAT('***** AT THE BEGINNING OF DRTU4--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,52)ICHARN
   52 FORMAT('ICHARN = ',I8)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,59)IBUGD2,IFOUND,IERROR
   59 FORMAT('IBUGD2,IFOUND,IERROR = ',A4,2X,A4,2X,A4)
      CALL DPWRST('XXX','BUG ')
   90 CONTINUE
C
C               **************************************
C               **  STEP 2--                        **
C               **  EXTRACT THE COORDINATES         **
C               **  FOR THIS PARTICULAR CHARACTER.  **
C               **************************************
C
      ISTART=ISTARD(ICHARN)
      NC=NUMCOO(ICHARN)
      ISTOP=ISTART+NC-1
      J=0
      DO1100I=ISTART,ISTOP
      J=J+1
      IOP(J)=IOPERA(I)
      X(J)=IX(I)
      Y(J)=IY(I)
 1100 CONTINUE
      NUMCO=J
      IXMINS=IXMIND(ICHARN)
      IXMAXS=IXMAXD(ICHARN)
      IXDELS=IXDELD(ICHARN)
C
      GOTO9000
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT       **
C               *****************
C
 9000 CONTINUE
      IF(IBUGD2.EQ.'OFF')GOTO9090
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9011)
 9011 FORMAT('***** AT THE END       OF DRTU4--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9012)IBUGD2,IFOUND,IERROR
 9012 FORMAT('IBUGD2,IFOUND,IERROR = ',A4,2X,A4,2X,A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9013)ICHARN
 9013 FORMAT('ICHARN = ',I8)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9014)ISTART,ISTOP,NC,NUMCO
 9014 FORMAT('ISTART,ISTOP,NC,NUMCO = ',4I8)
      CALL DPWRST('XXX','BUG ')
      IF(NUMCO.GE.1.AND.NUMCO.LE.1000)GOTO9019
      DO9015I=1,NUMCO
      WRITE(ICOUT,9016)I,IOP(I),X(I),Y(I)
 9016 FORMAT('I,IOP(I),X(I),Y(I) = ',I8,2X,A4,2F10.2)
      CALL DPWRST('XXX','BUG ')
 9015 CONTINUE
 9019 CONTINUE
      WRITE(ICOUT,9021)IXMINS,IXMAXS,IXDELS
 9021 FORMAT('IXMINS,IXMAXS,IXDELS = ',3I8)
      CALL DPWRST('XXX','BUG ')
 9090 CONTINUE
C
      RETURN
      END
      SUBROUTINE DRWFIL(XC,YC,NMX,NSEG,NPTS,
     1                  SNSE,CLSD,NSGX,
     1                  X,Y,IMX,JMX,
     1                  IB,JB,NBX,PRMTR,NS,D,CN,WLN,IDSH,KOLR,
     1                  LBL,LDEC,SZL,DLMM,
     1                  XTEMP,YTEMP,TATEMP,NTEMP,NTRACE,
     1                  IBUGG3,ISUBRO,IERROR)
C
C     PURPOSE--XX
C
C     WRITTEN BY--DAVID W. BEHRINGER NOAA/AOML (MIAMI).
C                 AS PART OF NOAA'S CONCX V.3   MARCH 1988.
C     ORIGINAL VERSION (IN DATAPLOT)--AUGUST    1988.
C
C     UPDATED         --JANUARY   1989.  MORE CHANGES TO STANDARD FORTRAN 77--
C                                        REPLACED ENCODE WITH
C                                        INTERNAL WRITE (ALAN HECKERT).
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOCP.INC'
C
C---------------------------------------------------------------------
C
      CHARACTER CHR(15)*1
      CHARACTER*15 CHRTMP
C
CCCCC INTEGER NPTS(NSGX,3),SNSE(NSGX,3),CLSD(NSGX,3),NSEG(3),NSGE(3),
CCCCC1 NSGCL(3),NSGCH(3),NTPE(3),NTPCL(3),NTPCH(3)
CCCCC DIMENSION XC(NMX,3),YC(NMX,3),D(2,NSGX,3),IB(NBX),JB(NBX),
CCCCC1 X(IMX),Y(JMX),NS(2,NSGX,3)
C
      CHARACTER*4 IBUGG3
      CHARACTER*4 ISUBRO
      CHARACTER*4 IERROR
C
      INTEGER NPTS
      INTEGER SNSE
      INTEGER CLSD
      INTEGER NSEG
      INTEGER NSGE
      INTEGER NSGCL
      INTEGER NSGCH
      INTEGER NTPE
      INTEGER NTPCL
      INTEGER NTPCH
C
      DIMENSION NPTS(MAXNSG,3)
      DIMENSION SNSE(MAXNSG,3)
      DIMENSION CLSD(MAXNSG,3)
      DIMENSION NSEG(3)
      DIMENSION NSGE(3)
      DIMENSION NSGCL(3)
      DIMENSION NSGCH(3)
      DIMENSION NTPE(3)
      DIMENSION NTPCL(3)
      DIMENSION NTPCH(3)
C
      DIMENSION XC(MAXNMX,3)
      DIMENSION YC(MAXNMX,3)
      DIMENSION D(2,MAXNSG,3)
      DIMENSION IB(*)
      DIMENSION JB(*)
      DIMENSION X(*)
      DIMENSION Y(*)
      DIMENSION NS(2,MAXNSG,3)
C
      DIMENSION XTEMP(*)
      DIMENSION YTEMP(*)
      DIMENSION TATEMP(*)
C
      INCLUDE 'DPCOP2.INC'
C
      DATA FRM/0.0/
C
C-----START POINT-----------------------------------------------------
C
C   SORT THE CONTOUR SEGMENTS AND CREATE POLYGONS FOR COLOR FILL
C
      IF(IBUGG3.EQ.'ON' .OR. ISUBRO.EQ.'WFIL')THEN
        WRITE(ICOUT,101)NMX,IMX,JMX,NBX,WLN
  101   FORMAT('NMX,IMX,JMX,NBX,WLN = ',5I6,G15.7)
        CALL DPWRST('XXX','BUG ')
        DO115II=1,MIN(10,NBX)
          WRITE(ICOUT,119)II,IB(II),JB(II)
  119     FORMAT('II,IB(II),JB(II) = ',3I8)
          CALL DPWRST('XXX','BUG ')
  115   CONTINUE
      ENDIF
C
      CALL PLYSRT(XC,YC,NMX,NSEG,NSGE,NSGCL,NSGCH,NPTS,NTPE,NTPCL,
     1            NTPCH,SNSE,CLSD,NSGX,X,Y,IMX,JMX,IB,JB,NBX,PRMTR,NS,D,
     1            IBUGG3,ISUBRO,IERROR)
C
C   FILL THE POLYGONS WITH COLOR
C
      IF (KOLR.GE.0) THEN
        L1=1
        DO 10 N=1,NSEG(3)
          NP=NPTS(N,3)
          CALL RSURF(XC(L1,3),YC(L1,3),NP,KOLR,FRM,
     1XTEMP,YTEMP,TATEMP,NTEMP,NTRACE,
     1IBUGG3,ISUBRO,IERROR)
          L1=L1+NP
 10     CONTINUE
      END IF
C
C   DRAW THE CONTOURS (USE *(*,3) ARRAYS TO PREVENT DATA LOSS DUE TO GVECT)
C
      IF (CN.NE.999.999) THEN
CCCCC   CALL GWICOL(WLN,1)    AUGUST 1988
        IF (LBL.GT.0) THEN
          IPOW=MAX0(LDEC+1,1)
CCCCC THE FOLLOWING 2 LINES WERE CORRECTED JANUARY 1989
CCCCC     ENCODE(15,999,CHR) CN+SIGN(10.**-IPOW,CN)
C999      FORMAT(F15.5)
          WRITE(CHRTMP,'(F15.5)') CN+SIGN(10.**(-IPOW),CN)
          DO 15 III=1,15
            CHR(III)=CHRTMP(III:III)
 15       CONTINUE
C  END CHANGE
          I=MAX0(0,INT(LOG10(ABS(CN+SIGN(0.001,CN)))))+1
          IF (CN.LT.0.) I=I+1
          IS=MAX0(1,10-I)
          IE=10+LDEC
          DO 20 I=IS,IE
            NCHR=I-IS+1
            CHR(NCHR)=CHR(I)
 20       CONTINUE
        END IF
        L2=0
        DO 30 NSG=1,NSEG(1)
          L1=L2+1
          NP=IABS(NPTS(NSG,1))
          L2=L2+NP
          DO 40 L=L1,L2
            LL=L-L1+1
            LLL=L2-L+L1
            XC(LL,3)=XC(LLL,1)
            YC(LL,3)=YC(LLL,1)
 40       CONTINUE
          IF (LBL.LE.0) THEN
            CALL DRAW0(XC(1,3),YC(1,3),NP,IDSH,
     1XTEMP,YTEMP,TATEMP,NTEMP,NTRACE,
     1IBUGG3,ISUBRO,IERROR)
          ELSE
            CALL DRAWL(XC(1,3),YC(1,3),D(1,1,3),NP,IDSH,CHR,
     1                          NCHR,SZL,DLMM,
     1XTEMP,YTEMP,TATEMP,NTEMP,NTRACE,
     1IBUGG3,ISUBRO,IERROR)
          END IF
 30     CONTINUE
      END IF
C
C   CONVERT *(*,2) ARRAYS TO *(*,1) ARRAYS
C
      N=0
      LE=0
      DO 50 K=1,3
        IF (K.EQ.1) THEN
          NSG=NSGE(2)
          NSGE(1)=NSG
          NTPE(1)=NTPE(2)
          NN=0
          LOFF=0
        ELSE IF (K.EQ.2) THEN
          NSG=NSGCH(2)
          NSGCL(1)=NSG
          NTPCL(1)=NTPCH(2)
          NN=NSGE(2)+NSGCL(2)
          LOFF=NTPCL(2)
        ELSE
          NSG=NSGCL(2)
          NSGCH(1)=NSG
          NTPCH(1)=NTPCL(2)
          NN=NSGE(2)
          LOFF=-NTPCH(2)
        END IF
        DO 60 N0=1,NSG
          N=N+1
          NN=NN+1
          NPTS(N,1)=IABS(NPTS(NN,2))
          SNSE(N,1)=1
          CLSD(N,1)=-CLSD(NN,2)
          LS=LE+1
          LE=LE+NPTS(N,1)
          DO 70 L=LS,LE
            LL=LE-L+LS+LOFF
            XC(L,1)=XC(LL,2)
            YC(L,1)=YC(LL,2)
 70       CONTINUE
          IF (K.EQ.1) THEN
            DO 80 I=1,2
              II=MOD(I,2)+1
              NS(I,N,1)=NS(II,NN,2)
              D(I,N,1)=D(II,NN,2)
 80         CONTINUE
          ELSE
            D(1,N,1)=D(1,NN,2)
          END IF
 60     CONTINUE
 50   CONTINUE
      NSEG(1)=NSEG(2)
      RETURN
      END
      SUBROUTINE DSCAL(N,DA,DX,INCX)
C
C     SCALES A VECTOR BY A CONSTANT.
C     USES UNROLLED LOOPS FOR INCREMENT EQUAL TO ONE.
C     JACK DONGARRA, LINPACK, 3/11/78.
C     MODIFIED 3/93 TO RETURN IF INCX .LE. 0.
C
      DOUBLE PRECISION DA,DX(1)
      INTEGER I,INCX,M,MP1,N,NINCX
C
      IF( N.LE.0 .OR. INCX.LE.0 )RETURN
      IF(INCX.EQ.1)GO TO 20
C
C        CODE FOR INCREMENT NOT EQUAL TO 1
C
      NINCX = N*INCX
      DO 10 I = 1,NINCX,INCX
        DX(I) = DA*DX(I)
   10 CONTINUE
      RETURN
C
C        CODE FOR INCREMENT EQUAL TO 1
C
C
C        CLEAN-UP LOOP
C
   20 M = MOD(N,5)
      IF( M .EQ. 0 ) GO TO 40
      DO 30 I = 1,M
        DX(I) = DA*DX(I)
   30 CONTINUE
      IF( N .LT. 5 ) RETURN
   40 MP1 = M + 1
      DO 50 I = MP1,N,5
        DX(I) = DA*DX(I)
        DX(I + 1) = DA*DX(I + 1)
        DX(I + 2) = DA*DX(I + 2)
        DX(I + 3) = DA*DX(I + 3)
        DX(I + 4) = DA*DX(I + 4)
   50 CONTINUE
      RETURN
      END
      SUBROUTINE DSET (N, X, CONST)
C
C     MARK VANGEL, NIST, JANUARY 1994
C     SUBROUTINE DSET SETS THE N VALUES IN X TO THE CONSTANT CONST
C
C
      DOUBLE PRECISION X, CONST
      DIMENSION X(N)
      DO 10 I=1, N
         X(I) = CONST
 10   CONTINUE
      RETURN
      END
      SUBROUTINE DSCORE(X,N,IWRITE,XSCORE,TEMP1,MAXNXT,
     1                  IBUGA3,ISUBRO,IERROR)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE MEDIAN SCORES
C              OF THE N ELEMENTS OF THE SINGLE PRECISION VECTOR X, AND
C              PUTS THE RESULTING N SCORES INTO THE SINGLE PRECISION
C              VECTOR XSCORE.
C
C              THE MEDIAN SCORES ARE DEFINED AS
C
C                 M(X(i)) = 1   IF X(i) >  (N+1)/2
C                         = 0   IF X(i) <= (N+1)/2
C
C              WITH R(i) DENOTING THE RANK OF THE i-TH OBSERVATION.
C
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VECTOR OF
C                                OBSERVATIONS TO BE SCORED.
C                     --N      = THE INTEGER NUMBER OF OBSERVATIONS
C                                IN THE VECTOR X.
C     OUTPUT ARGUMENTS--XSCORE = THE SINGLE PRECISION VECTOR INTO WHICH
C                                THE SCORES FROM X WILL BE PLACED.
C     OUTPUT--THE SINGLE PRECISION VECTOR XSCORE CONTAINING THE MEDIAN
C             SCORES IN THE SINGLE PRECISION VECTOR X.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     OTHER DATAPAC   SUBROUTINES NEEDED--RANK
C     FORTRAN LIBRARY SUBROUTINES NEEDED--NONE.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--xx
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATION INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2023.06
C     ORIGINAL VERSION--JUNE      2023.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 IWRITE
      CHARACTER*4 IBUGA3
      CHARACTER*4 ISUBRO
      CHARACTER*4 IERROR
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
C
C---------------------------------------------------------------------
C
      DIMENSION X(*)
      DIMENSION XSCORE(*)
      DIMENSION TEMP1(*)
C
C---------------------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='DSCO'
      ISUBN2='RE  '
      IERROR='NO'
C
      IF(IBUGA3.EQ.'ON' .OR. ISUBRO.EQ.'CORE')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,51)
   51   FORMAT('***** AT THE BEGINNING OF DSCORE--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,53)N,IBUGA3,ISUBRO
   53   FORMAT('N,IBUGA3,ISUBRO = ',I8,2(2X,A4))
        CALL DPWRST('XXX','BUG ')
        DO55I=1,N
          WRITE(ICOUT,56)I,X(I)
   56     FORMAT('I,X(I) = ',I8,G15.7)
          CALL DPWRST('XXX','BUG ')
   55   CONTINUE
      ENDIF
C
C               ********************************************
C               **  STEP 1--                              **
C               **  CHECK THE INPUT ARGUMENTS FOR ERRORS  **
C               ********************************************
C
      AN=N
C
      IF(N.LT.1)THEN
        IERROR='YES'
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,111)
  111   FORMAT('***** ERROR IN MEDIAN SCORES--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,113)
  113   FORMAT('      THE NUMBER OF OBSERVATIONS IS LESS THAN 1.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,118)N
  118   FORMAT('      THE NUMBER OF OBSERVATIONS IS ',I8)
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
C
C               ********************************************
C               **  STEP 2--                              **
C               **  GENERATE THE MOOD   SCORES            **
C               ********************************************
C
        CALL RANK(X,N,IWRITE,XSCORE,TEMP1,MAXNXT,IBUGA3,IERROR)
        TERM1=(REAL(N)+1.0)/2.0
        DO211K=1,N
          AVAL=XSCORE(K)
          IF(AVAL.GT.TERM1)THEN
            XSCORE(K)=1.0
          ELSE
            XSCORE(K)=0.0
          ENDIF
  211   CONTINUE
C
C
C               ******************************
C               **  STEP 4--                **
C               **  WRITE OUT A FEW LINES   **
C               **  OF SUMMARY INFORMATION  **
C               **  ABOUT THE CODING.       **
C               ******************************
C
      IF(IFEEDB.EQ.'ON' .AND. IWRITE.EQ.'ON')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        IINDX=1
        WRITE(ICOUT,912)IINDX,XSCORE(IINDX)
  912   FORMAT('THE MEDIAN SCORE OF ROW ',I10,' = ',G15.7)
        CALL DPWRST('XXX','BUG ')
        IINDX=N
        WRITE(ICOUT,912)IINDX,XSCORE(IINDX)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT.      **
C               *****************
C
 9000 CONTINUE
C
      IF(IBUGA3.EQ.'ON' .OR. ISUBRO.EQ.'CORE')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9011)
 9011   FORMAT('***** AT THE END       OF DSCORE--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9012)IERROR
 9012   FORMAT('IERROR = ',A4)
        CALL DPWRST('XXX','BUG ')
        DO9015I=1,N
          WRITE(ICOUT,9016)I,X(I),XSCORE(I)
 9016     FORMAT('I,X(I),XSCORE(I) = ',I8,2G15.7)
          CALL DPWRST('XXX','BUG ')
 9015   CONTINUE
      ENDIF
C
      RETURN
      END
      SUBROUTINE DSORT (DX, DY, N, KFLAG, IERROR)
C***BEGIN PROLOGUE  DSORT
C***PURPOSE  Sort an array and optionally make the same interchanges in
C            an auxiliary array.  The array may be sorted in increasing
C            or decreasing order.  A slightly modified QUICKSORT
C            algorithm is used.
C***LIBRARY   SLATEC
C***CATEGORY  N6A2B
C***TYPE      DOUBLE PRECISION (SSORT-S, DSORT-D, ISORT-I)
C***KEYWORDS  SINGLETON QUICKSORT, SORT, SORTING
C***AUTHOR  Jones, R. E., (SNLA)
C           Wisniewski, J. A., (SNLA)
C***DESCRIPTION
C
C   DSORT sorts array DX and optionally makes the same interchanges in
C   array DY.  The array DX may be sorted in increasing order or
C   decreasing order.  A slightly modified quicksort algorithm is used.
C
C   Description of Parameters
C      DX - array of values to be sorted   (usually abscissas)
C      DY - array to be (optionally) carried along
C      N  - number of values in array DX to be sorted
C      KFLAG - control parameter
C            =  2  means sort DX in increasing order and carry DY along.
C            =  1  means sort DX in increasing order (ignoring DY)
C            = -1  means sort DX in decreasing order (ignoring DY)
C            = -2  means sort DX in decreasing order and carry DY along.
C
C***REFERENCES  R. C. Singleton, Algorithm 347, An efficient algorithm
C                 for sorting with minimal storage, Communications of
C                 the ACM, 12, 3 (1969), pp. 185-187.
C***ROUTINES CALLED  XERMSG
C***REVISION HISTORY  (YYMMDD)
C   761101  DATE WRITTEN
C   761118  Modified to use the Singleton quicksort algorithm.  (JAW)
C   890531  Changed all specific intrinsics to generic.  (WRB)
C   890831  Modified array declarations.  (WRB)
C   891009  Removed unreferenced statement labels.  (WRB)
C   891024  Changed category.  (WRB)
C   891024  REVISION DATE from Version 3.2
C   891214  Prologue converted to Version 4.0 format.  (BAB)
C   900315  CALLs to XERROR changed to CALLs to XERMSG.  (THJ)
C   901012  Declared all variables; changed X,Y to DX,DY; changed
C           code to parallel SSORT. (M. McClain)
C   920501  Reformatted the REFERENCES section.  (DWL, WRB)
C   920519  Clarified error messages.  (DWL)
C   920801  Declarations section rebuilt and code restructured to use
C           IF-THEN-ELSE-ENDIF.  (RWC, WRB)
C   970821  Minor modifications to error handling and printing to
C           incorporate into Dataplot
C***END PROLOGUE  DSORT
C     .. Scalar Arguments ..
C
      CHARACTER*4 IERROR
      INCLUDE 'DPCOP2.INC'
C
      INTEGER KFLAG, N
C     .. Array Arguments ..
      DOUBLE PRECISION DX(*), DY(*)
C     .. Local Scalars ..
      DOUBLE PRECISION R, T, TT, TTY, TY
      INTEGER I, IJ, J, K, KK, L, M, NN
C     .. Local Arrays ..
      INTEGER IL(21), IU(21)
C     .. External Subroutines ..
CCCCC EXTERNAL XERMSG
C     .. Intrinsic Functions ..
      INTRINSIC ABS, INT
C***FIRST EXECUTABLE STATEMENT  DSORT
      IERROR='NO'
      NN = N
      IF (NN .LT. 1) THEN
CCCCC    CALL XERMSG ('SLATEC', 'DSORT',
CCCCC+      'The number of values to be sorted is not positive.', 1, 1)
         WRITE(ICOUT,1001)
         CALL DPWRST('XXX','BUG ')
         WRITE(ICOUT,1002)
         CALL DPWRST('XXX','BUG ')
         IERROR='YES'
         RETURN
      ENDIF
 1001 FORMAT('***** RECIPE ERROR: INTERNAL ERROR FROM DSORT')
 1002 FORMAT('      THE NUMBER OF VALUES TO BE SORTED IS NOT POSITIVE.')
C
      KK = ABS(KFLAG)
      IF (KK.NE.1 .AND. KK.NE.2) THEN
CCCCC    CALL XERMSG ('SLATEC', 'DSORT',
CCCCC+      'The sort control parameter, K, is not 2, 1, -1, or -2.', 2,
CCCCC+      1)
         WRITE(ICOUT,1003)
         CALL DPWRST('XXX','BUG ')
         WRITE(ICOUT,1004)
         CALL DPWRST('XXX','BUG ')
         IERROR='YES'
         RETURN
      ENDIF
 1003 FORMAT('***** RECIPE ERROR: INTERNAL ERROR FROM DSORT')
 1004 FORMAT('      THE SORT CONTROL PARAMETER, K, IS NOT 2, 1, ',
     1'-1, OR -2.')
C
C     Alter array DX to get decreasing order if needed
C
      IF (KFLAG .LE. -1) THEN
         DO 10 I=1,NN
            DX(I) = -DX(I)
   10    CONTINUE
      ENDIF
C
      IF (KK .EQ. 2) GO TO 100
C
C     Sort DX only
C
      M = 1
      I = 1
      J = NN
      R = 0.375D0
C
   20 IF (I .EQ. J) GO TO 60
      IF (R .LE. 0.5898437D0) THEN
         R = R+3.90625D-2
      ELSE
         R = R-0.21875D0
      ENDIF
C
   30 K = I
C
C     Select a central element of the array and save it in location T
C
      IJ = I + INT((J-I)*R)
      T = DX(IJ)
C
C     If first element of array is greater than T, interchange with T
C
      IF (DX(I) .GT. T) THEN
         DX(IJ) = DX(I)
         DX(I) = T
         T = DX(IJ)
      ENDIF
      L = J
C
C     If last element of array is less than than T, interchange with T
C
      IF (DX(J) .LT. T) THEN
         DX(IJ) = DX(J)
         DX(J) = T
         T = DX(IJ)
C
C        If first element of array is greater than T, interchange with T
C
         IF (DX(I) .GT. T) THEN
            DX(IJ) = DX(I)
            DX(I) = T
            T = DX(IJ)
         ENDIF
      ENDIF
C
C     Find an element in the second half of the array which is smaller
C     than T
C
   40 L = L-1
      IF (DX(L) .GT. T) GO TO 40
C
C     Find an element in the first half of the array which is greater
C     than T
C
   50 K = K+1
      IF (DX(K) .LT. T) GO TO 50
C
C     Interchange these elements
C
      IF (K .LE. L) THEN
         TT = DX(L)
         DX(L) = DX(K)
         DX(K) = TT
         GO TO 40
      ENDIF
C
C     Save upper and lower subscripts of the array yet to be sorted
C
      IF (L-I .GT. J-K) THEN
         IL(M) = I
         IU(M) = L
         I = K
         M = M+1
      ELSE
         IL(M) = K
         IU(M) = J
         J = L
         M = M+1
      ENDIF
      GO TO 70
C
C     Begin again on another portion of the unsorted array
C
   60 M = M-1
      IF (M .EQ. 0) GO TO 190
      I = IL(M)
      J = IU(M)
C
   70 IF (J-I .GE. 1) GO TO 30
      IF (I .EQ. 1) GO TO 20
      I = I-1
C
   80 I = I+1
      IF (I .EQ. J) GO TO 60
      T = DX(I+1)
      IF (DX(I) .LE. T) GO TO 80
      K = I
C
   90 DX(K+1) = DX(K)
      K = K-1
      IF (T .LT. DX(K)) GO TO 90
      DX(K+1) = T
      GO TO 80
C
C     Sort DX and carry DY along
C
  100 M = 1
      I = 1
      J = NN
      R = 0.375D0
C
  110 IF (I .EQ. J) GO TO 150
      IF (R .LE. 0.5898437D0) THEN
         R = R+3.90625D-2
      ELSE
         R = R-0.21875D0
      ENDIF
C
  120 K = I
C
C     Select a central element of the array and save it in location T
C
      IJ = I + INT((J-I)*R)
      T = DX(IJ)
      TY = DY(IJ)
C
C     If first element of array is greater than T, interchange with T
C
      IF (DX(I) .GT. T) THEN
         DX(IJ) = DX(I)
         DX(I) = T
         T = DX(IJ)
         DY(IJ) = DY(I)
         DY(I) = TY
         TY = DY(IJ)
      ENDIF
      L = J
C
C     If last element of array is less than T, interchange with T
C
      IF (DX(J) .LT. T) THEN
         DX(IJ) = DX(J)
         DX(J) = T
         T = DX(IJ)
         DY(IJ) = DY(J)
         DY(J) = TY
         TY = DY(IJ)
C
C        If first element of array is greater than T, interchange with T
C
         IF (DX(I) .GT. T) THEN
            DX(IJ) = DX(I)
            DX(I) = T
            T = DX(IJ)
            DY(IJ) = DY(I)
            DY(I) = TY
            TY = DY(IJ)
         ENDIF
      ENDIF
C
C     Find an element in the second half of the array which is smaller
C     than T
C
  130 L = L-1
      IF (DX(L) .GT. T) GO TO 130
C
C     Find an element in the first half of the array which is greater
C     than T
C
  140 K = K+1
      IF (DX(K) .LT. T) GO TO 140
C
C     Interchange these elements
C
      IF (K .LE. L) THEN
         TT = DX(L)
         DX(L) = DX(K)
         DX(K) = TT
         TTY = DY(L)
         DY(L) = DY(K)
         DY(K) = TTY
         GO TO 130
      ENDIF
C
C     Save upper and lower subscripts of the array yet to be sorted
C
      IF (L-I .GT. J-K) THEN
         IL(M) = I
         IU(M) = L
         I = K
         M = M+1
      ELSE
         IL(M) = K
         IU(M) = J
         J = L
         M = M+1
      ENDIF
      GO TO 160
C
C     Begin again on another portion of the unsorted array
C
  150 M = M-1
      IF (M .EQ. 0) GO TO 190
      I = IL(M)
      J = IU(M)
C
  160 IF (J-I .GE. 1) GO TO 120
      IF (I .EQ. 1) GO TO 110
      I = I-1
C
  170 I = I+1
      IF (I .EQ. J) GO TO 150
      T = DX(I+1)
      TY = DY(I+1)
      IF (DX(I) .LE. T) GO TO 170
      K = I
C
  180 DX(K+1) = DX(K)
      DY(K+1) = DY(K)
      K = K-1
      IF (T .LT. DX(K)) GO TO 180
      DX(K+1) = T
      DY(K+1) = TY
      GO TO 170
C
C     Clean up
C
  190 IF (KFLAG .LE. -1) THEN
         DO 200 I=1,NN
            DX(I) = -DX(I)
  200    CONTINUE
      ENDIF
      RETURN
      END
      DOUBLE PRECISION FUNCTION DSPENC (X)
C***BEGIN PROLOGUE  DSPENC
C***PURPOSE  Compute a form of Spence's integral due to K. Mitchell.
C***LIBRARY   SLATEC (FNLIB)
C***CATEGORY  C5
C***TYPE      DOUBLE PRECISION (SPENC-S, DSPENC-D)
C***KEYWORDS  FNLIB, SPECIAL FUNCTIONS, SPENCE'S INTEGRAL
C***AUTHOR  Fullerton, W., (LANL)
C***DESCRIPTION
C
C DSPENC(X) calculates the double precision Spence's integral
C for double precision argument X.  Spence's function defined by
C        integral from 0 to X of  -LOG(1-Y)/Y  DY.
C For ABS(X) .LE. 1, the uniformly convergent expansion
C        DSPENC = sum K=1,infinity  X**K / K**2     is valid.
C This is a form of Spence's integral due to K. Mitchell which differs
C from the definition in the NBS Handbook of Mathematical Functions.
C
C Spence's function can be used to evaluate much more general integral
C forms.  For example,
C        integral from 0 to Z of  LOG(A*X+B)/(C*X+D)  DX  =
C             LOG(ABS(B-A*D/C))*LOG(ABS(A*(C*X+D)/(A*D-B*C)))/C
C             - DSPENC (A*(C*Z+D)/(A*D-B*C)) / C.
C
C Ref -- K. Mitchell, Philosophical Magazine, 40, p.351 (1949).
C        Stegun and Abromowitz, AMS 55, p.1004.
C
C
C Series for SPEN       on the interval  0.          to  5.00000E-01
C                                        with weighted error   4.74E-32
C                                         log weighted error  31.32
C                               significant figures required  30.37
C                                    decimal places required  32.11
C
C***REFERENCES  (NONE)
C***ROUTINES CALLED  D1MACH, DCSEVL, INITDS
C***REVISION HISTORY  (YYMMDD)
C   780201  DATE WRITTEN
C   890531  Changed all specific intrinsics to generic.  (WRB)
C   891115  Corrected third argument in reference to INITDS.  (WRB)
C   891115  REVISION DATE from Version 3.2
C   891214  Prologue converted to Version 4.0 format.  (BAB)
C***END PROLOGUE  DSPENC
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOMC.INC'
      INCLUDE 'DPCOP2.INC'
C
      DOUBLE PRECISION X, SPENCS(38), ALN, PI26, XBIG, DCSEVL
      LOGICAL FIRST
      SAVE SPENCS, PI26, NSPENC, XBIG, FIRST
      DATA SPENCS(  1) / +.1527365598 8924058729 4668491002 8 D+0      /
      DATA SPENCS(  2) / +.8169658058 0510144035 0183818527 1 D-1      /
      DATA SPENCS(  3) / +.5814157140 7787308729 7735064118 2 D-2      /
      DATA SPENCS(  4) / +.5371619814 5415275422 4788900531 9 D-3      /
      DATA SPENCS(  5) / +.5724704675 1858262332 1060305478 2 D-4      /
      DATA SPENCS(  6) / +.6674546121 6493363436 0783543858 9 D-5      /
      DATA SPENCS(  7) / +.8276467339 7156769815 8439168901 1 D-6      /
      DATA SPENCS(  8) / +.1073315673 0306789512 7000587335 4 D-6      /
      DATA SPENCS(  9) / +.1440077294 3032394023 3459033151 3 D-7      /
      DATA SPENCS( 10) / +.1984442029 9659063678 9887713960 8 D-8      /
      DATA SPENCS( 11) / +.2794005822 1636387202 0199482161 5 D-9      /
      DATA SPENCS( 12) / +.4003991310 8833118230 7258044590 8 D-10     /
      DATA SPENCS( 13) / +.5823462892 0446384713 6813583575 7 D-11     /
      DATA SPENCS( 14) / +.8576708692 6386892780 9791477122 4 D-12     /
      DATA SPENCS( 15) / +.1276862586 2801930459 8948303343 3 D-12     /
      DATA SPENCS( 16) / +.1918826209 0425170811 6238041606 2 D-13     /
      DATA SPENCS( 17) / +.2907319206 9771381777 9579971967 3 D-14     /
      DATA SPENCS( 18) / +.4437112685 2767804625 5747364174 5 D-15     /
      DATA SPENCS( 19) / +.6815727787 4145995278 6735913560 7 D-16     /
      DATA SPENCS( 20) / +.1053017386 0155744295 4701941664 4 D-16     /
      DATA SPENCS( 21) / +.1635389806 7523771000 5182173457 0 D-17     /
      DATA SPENCS( 22) / +.2551852874 9404639323 1090164258 1 D-18     /
      DATA SPENCS( 23) / +.3999020621 9993601127 7047037951 9 D-19     /
      DATA SPENCS( 24) / +.6291501645 2168118765 1414917119 9 D-20     /
      DATA SPENCS( 25) / +.9933827435 6756776438 0388775253 3 D-21     /
      DATA SPENCS( 26) / +.1573679570 7499648167 2176380586 6 D-21     /
      DATA SPENCS( 27) / +.2500595316 8494761293 6927095466 6 D-22     /
      DATA SPENCS( 28) / +.3984740918 3838111392 1066325333 3 D-23     /
      DATA SPENCS( 29) / +.6366473210 0828438926 9132629333 3 D-24     /
      DATA SPENCS( 30) / +.1019674287 2396783670 7706197333 3 D-24     /
      DATA SPENCS( 31) / +.1636881058 9135188411 1107413333 3 D-25     /
      DATA SPENCS( 32) / +.2633310439 4176501173 4527999999 9 D-26     /
      DATA SPENCS( 33) / +.4244811560 1239768172 2436266666 6 D-27     /
      DATA SPENCS( 34) / +.6855411983 6800529168 2474666666 6 D-28     /
      DATA SPENCS( 35) / +.1109122433 4380564340 1898666666 6 D-28     /
      DATA SPENCS( 36) / +.1797431304 9998914573 6533333333 3 D-29     /
      DATA SPENCS( 37) / +.2917505845 9760951732 9066666666 6 D-30     /
      DATA SPENCS( 38) / +.4742646808 9286710613 3333333333 3 D-31     /
      DATA PI26 / +1.644934066 8482264364 7241516664 6025189219 D0 /
      DATA FIRST /.TRUE./
C***FIRST EXECUTABLE STATEMENT  DSPENC
      IF (FIRST) THEN
         NSPENC = INITDS (SPENCS, 38, 0.1*REAL(D1MACH(3)))
         XBIG = 1.0D0/D1MACH(3)
      ENDIF
      FIRST = .FALSE.
C
      IF (X.GT.2.0D0) GO TO 60
      IF (X.GT.1.0D0) GO TO 50
      IF (X.GT.0.5D0) GO TO 40
      IF (X.GE.0.0D0) GO TO 30
      IF (X.GT.(-1.D0)) GO TO 20
C
C HERE IF X .LE. -1.0
C
      ALN = LOG(1.0D0-X)
      DSPENC = -PI26 - 0.5D0*ALN*(2.0D0*LOG(-X)-ALN)
      IF (X.GT.(-XBIG)) DSPENC = DSPENC
     1  + (1.D0 + DCSEVL (4.D0/(1.D0-X)-1.D0, SPENCS, NSPENC))/(1.D0-X)
      RETURN
C
C -1.0 .LT. X .LT. 0.0
C
 20   DSPENC = -0.5D0*LOG(1.0D0-X)**2
     1  - X*(1.D0+DCSEVL(4.D0*X/(X-1.D0)-1.D0, SPENCS, NSPENC))/(X-1.D0)
      RETURN
C
C 0.0 .LE. X .LE. 0.5
C
 30   DSPENC = X*(1.D0 + DCSEVL (4.D0*X-1.D0, SPENCS, NSPENC))
      RETURN
C
C 0.5 .LT. X .LE. 1.0
C
 40   DSPENC = PI26
      IF (X.NE.1.D0) DSPENC = PI26 - LOG(X)*LOG(1.0D0-X)
     1  - (1.D0-X)*(1.D0+DCSEVL(4.D0*(1.D0-X)-1.D0, SPENCS, NSPENC))
      RETURN
C
C 1.0 .LT. X .LE. 2.0
C
 50   DSPENC = PI26 - 0.5D0*LOG(X)*LOG((X-1.D0)**2/X)
     1  + (X-1.D0)*(1.D0+DCSEVL(4.D0*(X-1.D0)/X-1.D0, SPENCS, NSPENC))/X
      RETURN
C
C X .GT. 2.0
C
 60   DSPENC = 2.0D0*PI26 - 0.5D0*LOG(X)**2
      IF (X.LT.XBIG) DSPENC = DSPENC
     1  - (1.D0 + DCSEVL (4.D0/X-1.D0, SPENCS, NSPENC))/X
      RETURN
C
      END
      DOUBLE PRECISION FUNCTION DSUM (N, DX, INCX)
C
C     MARK VANGEL, NIST, JANUARY 1994
C     FUNCTION DSUM SUMS DX((I-1)*INCX+1), FOR I=1, ..., N.
C     COMPARE TO BLAS LEVEL 1 ROUTINE DASUM.
C
      IMPLICIT DOUBLE PRECISION (A-H, O-Z)
      DIMENSION DX(1)
      DSUM = 0.D0
      DO 10 I=1, N
         DSUM = DSUM +DX ((I-1)*INCX +1)
 10   CONTINUE
      RETURN
      END
      SUBROUTINE DSVDC(X,LDX,N,P,S,E,U,LDU,V,LDV,WORK,JOB,INFO)
      INTEGER LDX,N,P,LDU,LDV,JOB,INFO
      DOUBLE PRECISION X(LDX,1),S(1),E(1),U(LDU,1),V(LDV,1),WORK(1)
C
C
C     DSVDC IS A SUBROUTINE TO REDUCE A DOUBLE PRECISION NXP MATRIX X
C     BY ORTHOGONAL TRANSFORMATIONS U AND V TO DIAGONAL FORM.  THE
C     DIAGONAL ELEMENTS S(I) ARE THE SINGULAR VALUES OF X.  THE
C     COLUMNS OF U ARE THE CORRESPONDING LEFT SINGULAR VECTORS,
C     AND THE COLUMNS OF V THE RIGHT SINGULAR VECTORS.
C
C     ON ENTRY
C
C         X         DOUBLE PRECISION(LDX,P), WHERE LDX.GE.N.
C                   X CONTAINS THE MATRIX WHOSE SINGULAR VALUE
C                   DECOMPOSITION IS TO BE COMPUTED.  X IS
C                   DESTROYED BY DSVDC.
C
C         LDX       INTEGER.
C                   LDX IS THE LEADING DIMENSION OF THE ARRAY X.
C
C         N         INTEGER.
C                   N IS THE NUMBER OF ROWS OF THE MATRIX X.
C
C         P         INTEGER.
C                   P IS THE NUMBER OF COLUMNS OF THE MATRIX X.
C
C         LDU       INTEGER.
C                   LDU IS THE LEADING DIMENSION OF THE ARRAY U.
C                   (SEE BELOW).
C
C         LDV       INTEGER.
C                   LDV IS THE LEADING DIMENSION OF THE ARRAY V.
C                   (SEE BELOW).
C
C         WORK      DOUBLE PRECISION(N).
C                   WORK IS A SCRATCH ARRAY.
C
C         JOB       INTEGER.
C                   JOB CONTROLS THE COMPUTATION OF THE SINGULAR
C                   VECTORS.  IT HAS THE DECIMAL EXPANSION AB
C                   WITH THE FOLLOWING MEANING
C
C                        A.EQ.0    DO NOT COMPUTE THE LEFT SINGULAR
C                                  VECTORS.
C                        A.EQ.1    RETURN THE N LEFT SINGULAR VECTORS
C                                  IN U.
C                        A.GE.2    RETURN THE FIRST MIN(N,P) SINGULAR
C                                  VECTORS IN U.
C                        B.EQ.0    DO NOT COMPUTE THE RIGHT SINGULAR
C                                  VECTORS.
C                        B.EQ.1    RETURN THE RIGHT SINGULAR VECTORS
C                                  IN V.
C
C     ON RETURN
C
C         S         DOUBLE PRECISION(MM), WHERE MM=MIN(N+1,P).
C                   THE FIRST MIN(N,P) ENTRIES OF S CONTAIN THE
C                   SINGULAR VALUES OF X ARRANGED IN DESCENDING
C                   ORDER OF MAGNITUDE.
C
C         E         DOUBLE PRECISION(P),
C                   E ORDINARILY CONTAINS ZEROS.  HOWEVER SEE THE
C                   DISCUSSION OF INFO FOR EXCEPTIONS.
C
C         U         DOUBLE PRECISION(LDU,K), WHERE LDU.GE.N.  IF
C                                   JOBA.EQ.1 THEN K.EQ.N, IF JOBA.GE.2
C                                   THEN K.EQ.MIN(N,P).
C                   U CONTAINS THE MATRIX OF LEFT SINGULAR VECTORS.
C                   U IS NOT REFERENCED IF JOBA.EQ.0.  IF N.LE.P
C                   OR IF JOBA.EQ.2, THEN U MAY BE IDENTIFIED WITH X
C                   IN THE SUBROUTINE CALL.
C
C         V         DOUBLE PRECISION(LDV,P), WHERE LDV.GE.P.
C                   V CONTAINS THE MATRIX OF RIGHT SINGULAR VECTORS.
C                   V IS NOT REFERENCED IF JOB.EQ.0.  IF P.LE.N,
C                   THEN V MAY BE IDENTIFIED WITH X IN THE
C                   SUBROUTINE CALL.
C
C         INFO      INTEGER.
C                   THE SINGULAR VALUES (AND THEIR CORRESPONDING
C                   SINGULAR VECTORS) S(INFO+1),S(INFO+2),...,S(M)
C                   ARE CORRECT (HERE M=MIN(N,P)).  THUS IF
C                   INFO.EQ.0, ALL THE SINGULAR VALUES AND THEIR
C                   VECTORS ARE CORRECT.  IN ANY EVENT, THE MATRIX
C                   B = TRANS(U)*X*V IS THE BIDIAGONAL MATRIX
C                   WITH THE ELEMENTS OF S ON ITS DIAGONAL AND THE
C                   ELEMENTS OF E ON ITS SUPER-DIAGONAL (TRANS(U)
C                   IS THE TRANSPOSE OF U).  THUS THE SINGULAR
C                   VALUES OF X AND B ARE THE SAME.
C
C     LINPACK. THIS VERSION DATED 08/14/78 .
C              CORRECTION MADE TO SHIFT 2/84.
C     G.W. STEWART, UNIVERSITY OF MARYLAND, ARGONNE NATIONAL LAB.
C
C     DSVDC USES THE FOLLOWING FUNCTIONS AND SUBPROGRAMS.
C
C     EXTERNAL DROT
C     BLAS DAXPY,DDOT,DSCAL,DSWAP,DNRM2,DROTG
C     FORTRAN DABS,DMAX1,MAX0,MIN0,MOD,DSQRT
C
C     INTERNAL VARIABLES
C
      INTEGER I,ITER,J,JOBU,K,KASE,KK,L,LL,LLS,LM1,LP1,LS,LU,M,MAXIT,
     *        MM,MM1,MP1,NCT,NCTP1,NCU,NRT,NRTP1
      DOUBLE PRECISION DDOT,T
      DOUBLE PRECISION B,C,CS,EL,EMM1,F,G,DNRM2,SCALE,SHIFT,SL,SM,SN,
     *                 SMM1,T1,TEST,ZTEST
      LOGICAL WANTU,WANTV
C
C
C     SET THE MAXIMUM NUMBER OF ITERATIONS.
C
      L=0
      LS=0
      MAXIT = 30
C
C     DETERMINE WHAT IS TO BE COMPUTED.
C
      WANTU = .FALSE.
      WANTV = .FALSE.
      JOBU = MOD(JOB,100)/10
      NCU = N
      IF (JOBU .GT. 1) NCU = MIN0(N,P)
      IF (JOBU .NE. 0) WANTU = .TRUE.
      IF (MOD(JOB,10) .NE. 0) WANTV = .TRUE.
C
C     REDUCE X TO BIDIAGONAL FORM, STORING THE DIAGONAL ELEMENTS
C     IN S AND THE SUPER-DIAGONAL ELEMENTS IN E.
C
      INFO = 0
      NCT = MIN0(N-1,P)
      NRT = MAX0(0,MIN0(P-2,N))
      LU = MAX0(NCT,NRT)
      IF (LU .LT. 1) GO TO 170
      DO 160 L = 1, LU
         LP1 = L + 1
         IF (L .GT. NCT) GO TO 20
C
C           COMPUTE THE TRANSFORMATION FOR THE L-TH COLUMN AND
C           PLACE THE L-TH DIAGONAL IN S(L).
C
            S(L) = DNRM2(N-L+1,X(L,L),1)
            IF (S(L) .EQ. 0.0D0) GO TO 10
               IF (X(L,L) .NE. 0.0D0) S(L) = DSIGN(S(L),X(L,L))
               CALL DSCAL(N-L+1,1.0D0/S(L),X(L,L),1)
               X(L,L) = 1.0D0 + X(L,L)
   10       CONTINUE
            S(L) = -S(L)
   20    CONTINUE
         IF (P .LT. LP1) GO TO 50
         DO 40 J = LP1, P
            IF (L .GT. NCT) GO TO 30
            IF (S(L) .EQ. 0.0D0) GO TO 30
C
C              APPLY THE TRANSFORMATION.
C
               T = -DDOT(N-L+1,X(L,L),1,X(L,J),1)/X(L,L)
               CALL DAXPY(N-L+1,T,X(L,L),1,X(L,J),1)
   30       CONTINUE
C
C           PLACE THE L-TH ROW OF X INTO  E FOR THE
C           SUBSEQUENT CALCULATION OF THE ROW TRANSFORMATION.
C
            E(J) = X(L,J)
   40    CONTINUE
   50    CONTINUE
         IF (.NOT.WANTU .OR. L .GT. NCT) GO TO 70
C
C           PLACE THE TRANSFORMATION IN U FOR SUBSEQUENT BACK
C           MULTIPLICATION.
C
            DO 60 I = L, N
               U(I,L) = X(I,L)
   60       CONTINUE
   70    CONTINUE
         IF (L .GT. NRT) GO TO 150
C
C           COMPUTE THE L-TH ROW TRANSFORMATION AND PLACE THE
C           L-TH SUPER-DIAGONAL IN E(L).
C
            E(L) = DNRM2(P-L,E(LP1),1)
            IF (E(L) .EQ. 0.0D0) GO TO 80
               IF (E(LP1) .NE. 0.0D0) E(L) = DSIGN(E(L),E(LP1))
               CALL DSCAL(P-L,1.0D0/E(L),E(LP1),1)
               E(LP1) = 1.0D0 + E(LP1)
   80       CONTINUE
            E(L) = -E(L)
            IF (LP1 .GT. N .OR. E(L) .EQ. 0.0D0) GO TO 120
C
C              APPLY THE TRANSFORMATION.
C
               DO 90 I = LP1, N
                  WORK(I) = 0.0D0
   90          CONTINUE
               DO 100 J = LP1, P
                  CALL DAXPY(N-L,E(J),X(LP1,J),1,WORK(LP1),1)
  100          CONTINUE
               DO 110 J = LP1, P
                  CALL DAXPY(N-L,-E(J)/E(LP1),WORK(LP1),1,X(LP1,J),1)
  110          CONTINUE
  120       CONTINUE
            IF (.NOT.WANTV) GO TO 140
C
C              PLACE THE TRANSFORMATION IN V FOR SUBSEQUENT
C              BACK MULTIPLICATION.
C
               DO 130 I = LP1, P
                  V(I,L) = E(I)
  130          CONTINUE
  140       CONTINUE
  150    CONTINUE
  160 CONTINUE
  170 CONTINUE
C
C     SET UP THE FINAL BIDIAGONAL MATRIX OR ORDER M.
C
      M = MIN0(P,N+1)
      NCTP1 = NCT + 1
      NRTP1 = NRT + 1
      IF (NCT .LT. P) S(NCTP1) = X(NCTP1,NCTP1)
      IF (N .LT. M) S(M) = 0.0D0
      IF (NRTP1 .LT. M) E(NRTP1) = X(NRTP1,M)
      E(M) = 0.0D0
C
C     IF REQUIRED, GENERATE U.
C
      IF (.NOT.WANTU) GO TO 300
         IF (NCU .LT. NCTP1) GO TO 200
         DO 190 J = NCTP1, NCU
            DO 180 I = 1, N
               U(I,J) = 0.0D0
  180       CONTINUE
            U(J,J) = 1.0D0
  190    CONTINUE
  200    CONTINUE
         IF (NCT .LT. 1) GO TO 290
         DO 280 LL = 1, NCT
            L = NCT - LL + 1
            IF (S(L) .EQ. 0.0D0) GO TO 250
               LP1 = L + 1
               IF (NCU .LT. LP1) GO TO 220
               DO 210 J = LP1, NCU
                  T = -DDOT(N-L+1,U(L,L),1,U(L,J),1)/U(L,L)
                  CALL DAXPY(N-L+1,T,U(L,L),1,U(L,J),1)
  210          CONTINUE
  220          CONTINUE
               CALL DSCAL(N-L+1,-1.0D0,U(L,L),1)
               U(L,L) = 1.0D0 + U(L,L)
               LM1 = L - 1
               IF (LM1 .LT. 1) GO TO 240
               DO 230 I = 1, LM1
                  U(I,L) = 0.0D0
  230          CONTINUE
  240          CONTINUE
            GO TO 270
  250       CONTINUE
               DO 260 I = 1, N
                  U(I,L) = 0.0D0
  260          CONTINUE
               U(L,L) = 1.0D0
  270       CONTINUE
  280    CONTINUE
  290    CONTINUE
  300 CONTINUE
C
C     IF IT IS REQUIRED, GENERATE V.
C
      IF (.NOT.WANTV) GO TO 350
         DO 340 LL = 1, P
            L = P - LL + 1
            LP1 = L + 1
            IF (L .GT. NRT) GO TO 320
            IF (E(L) .EQ. 0.0D0) GO TO 320
               DO 310 J = LP1, P
                  T = -DDOT(P-L,V(LP1,L),1,V(LP1,J),1)/V(LP1,L)
                  CALL DAXPY(P-L,T,V(LP1,L),1,V(LP1,J),1)
  310          CONTINUE
  320       CONTINUE
            DO 330 I = 1, P
               V(I,L) = 0.0D0
  330       CONTINUE
            V(L,L) = 1.0D0
  340    CONTINUE
  350 CONTINUE
C
C     MAIN ITERATION LOOP FOR THE SINGULAR VALUES.
C
      MM = M
      ITER = 0
  360 CONTINUE
C
C        QUIT IF ALL THE SINGULAR VALUES HAVE BEEN FOUND.
C
C     ...EXIT
         IF (M .EQ. 0) GO TO 620
C
C        IF TOO MANY ITERATIONS HAVE BEEN PERFORMED, SET
C        FLAG AND RETURN.
C
         IF (ITER .LT. MAXIT) GO TO 370
            INFO = M
C     ......EXIT
            GO TO 620
  370    CONTINUE
C
C        THIS SECTION OF THE PROGRAM INSPECTS FOR
C        NEGLIGIBLE ELEMENTS IN THE S AND E ARRAYS.  ON
C        COMPLETION THE VARIABLES KASE AND L ARE SET AS FOLLOWS.
C
C           KASE = 1     IF S(M) AND E(L-1) ARE NEGLIGIBLE AND L.LT.M
C           KASE = 2     IF S(L) IS NEGLIGIBLE AND L.LT.M
C           KASE = 3     IF E(L-1) IS NEGLIGIBLE, L.LT.M, AND
C                        S(L), ..., S(M) ARE NOT NEGLIGIBLE (QR STEP).
C           KASE = 4     IF E(M-1) IS NEGLIGIBLE (CONVERGENCE).
C
         DO 390 LL = 1, M
            L = M - LL
C        ...EXIT
            IF (L .EQ. 0) GO TO 400
            TEST = DABS(S(L)) + DABS(S(L+1))
            ZTEST = TEST + DABS(E(L))
            IF (ZTEST .NE. TEST) GO TO 380
               E(L) = 0.0D0
C        ......EXIT
               GO TO 400
  380       CONTINUE
  390    CONTINUE
  400    CONTINUE
         IF (L .NE. M - 1) GO TO 410
            KASE = 4
         GO TO 480
  410    CONTINUE
            LP1 = L + 1
            MP1 = M + 1
            DO 430 LLS = LP1, MP1
               LS = M - LLS + LP1
C           ...EXIT
               IF (LS .EQ. L) GO TO 440
               TEST = 0.0D0
               IF (LS .NE. M) TEST = TEST + DABS(E(LS))
               IF (LS .NE. L + 1) TEST = TEST + DABS(E(LS-1))
               ZTEST = TEST + DABS(S(LS))
               IF (ZTEST .NE. TEST) GO TO 420
                  S(LS) = 0.0D0
C           ......EXIT
                  GO TO 440
  420          CONTINUE
  430       CONTINUE
  440       CONTINUE
            IF (LS .NE. L) GO TO 450
               KASE = 3
            GO TO 470
  450       CONTINUE
            IF (LS .NE. M) GO TO 460
               KASE = 1
            GO TO 470
  460       CONTINUE
               KASE = 2
               L = LS
  470       CONTINUE
  480    CONTINUE
         L = L + 1
C
C        PERFORM THE TASK INDICATED BY KASE.
C
         GO TO (490,520,540,570), KASE
C
C        DEFLATE NEGLIGIBLE S(M).
C
  490    CONTINUE
            MM1 = M - 1
            F = E(M-1)
            E(M-1) = 0.0D0
            DO 510 KK = L, MM1
               K = MM1 - KK + L
               T1 = S(K)
               CALL DROTG(T1,F,CS,SN)
               S(K) = T1
               IF (K .EQ. L) GO TO 500
                  F = -SN*E(K-1)
                  E(K-1) = CS*E(K-1)
  500          CONTINUE
               IF (WANTV) CALL DROT(P,V(1,K),1,V(1,M),1,CS,SN)
  510       CONTINUE
         GO TO 610
C
C        SPLIT AT NEGLIGIBLE S(L).
C
  520    CONTINUE
            F = E(L-1)
            E(L-1) = 0.0D0
            DO 530 K = L, M
               T1 = S(K)
               CALL DROTG(T1,F,CS,SN)
               S(K) = T1
               F = -SN*E(K)
               E(K) = CS*E(K)
               IF (WANTU) CALL DROT(N,U(1,K),1,U(1,L-1),1,CS,SN)
  530       CONTINUE
         GO TO 610
C
C        PERFORM ONE QR STEP.
C
  540    CONTINUE
C
C           CALCULATE THE SHIFT.
C
            SCALE = DMAX1(DABS(S(M)),DABS(S(M-1)),DABS(E(M-1)),
     *                    DABS(S(L)),DABS(E(L)))
            SM = S(M)/SCALE
            SMM1 = S(M-1)/SCALE
            EMM1 = E(M-1)/SCALE
            SL = S(L)/SCALE
            EL = E(L)/SCALE
            B = ((SMM1 + SM)*(SMM1 - SM) + EMM1**2)/2.0D0
            C = (SM*EMM1)**2
            SHIFT = 0.0D0
            IF (B .EQ. 0.0D0 .AND. C .EQ. 0.0D0) GO TO 550
               SHIFT = DSQRT(B**2+C)
               IF (B .LT. 0.0D0) SHIFT = -SHIFT
               SHIFT = C/(B + SHIFT)
  550       CONTINUE
            F = (SL + SM)*(SL - SM) + SHIFT
            G = SL*EL
C
C           CHASE ZEROS.
C
            MM1 = M - 1
            DO 560 K = L, MM1
               CALL DROTG(F,G,CS,SN)
               IF (K .NE. L) E(K-1) = F
               F = CS*S(K) + SN*E(K)
               E(K) = CS*E(K) - SN*S(K)
               G = SN*S(K+1)
               S(K+1) = CS*S(K+1)
               IF (WANTV) CALL DROT(P,V(1,K),1,V(1,K+1),1,CS,SN)
               CALL DROTG(F,G,CS,SN)
               S(K) = F
               F = CS*E(K) + SN*S(K+1)
               S(K+1) = -SN*E(K) + CS*S(K+1)
               G = SN*E(K+1)
               E(K+1) = CS*E(K+1)
               IF (WANTU .AND. K .LT. N)
     *            CALL DROT(N,U(1,K),1,U(1,K+1),1,CS,SN)
  560       CONTINUE
            E(M-1) = F
            ITER = ITER + 1
         GO TO 610
C
C        CONVERGENCE.
C
  570    CONTINUE
C
C           MAKE THE SINGULAR VALUE  POSITIVE.
C
            IF (S(L) .GE. 0.0D0) GO TO 580
               S(L) = -S(L)
               IF (WANTV) CALL DSCAL(P,-1.0D0,V(1,L),1)
  580       CONTINUE
C
C           ORDER THE SINGULAR VALUE.
C
  590       IF (L .EQ. MM) GO TO 600
C           ...EXIT
               IF (S(L) .GE. S(L+1)) GO TO 600
               T = S(L)
               S(L) = S(L+1)
               S(L+1) = T
               IF (WANTV .AND. L .LT. P)
     *            CALL DSWAP(P,V(1,L),1,V(1,L+1),1)
               IF (WANTU .AND. L .LT. N)
     *            CALL DSWAP(N,U(1,L),1,U(1,L+1),1)
               L = L + 1
            GO TO 590
  600       CONTINUE
            ITER = 0
            M = M - 1
  610    CONTINUE
      GO TO 360
  620 CONTINUE
      RETURN
      END
      SUBROUTINE DSWAP (N,DX,INCX,DY,INCY)
C
C     INTERCHANGES TWO VECTORS.
C     USES UNROLLED LOOPS FOR INCREMENTS EQUAL ONE.
C     JACK DONGARRA, LINPACK, 3/11/78.
C
      DOUBLE PRECISION DX(1),DY(1),DTEMP
      INTEGER I,INCX,INCY,IX,IY,M,MP1,N
C
      IF(N.LE.0)RETURN
      IF(INCX.EQ.1.AND.INCY.EQ.1)GO TO 20
C
C       CODE FOR UNEQUAL INCREMENTS OR EQUAL INCREMENTS NOT EQUAL
C         TO 1
C
      IX = 1
      IY = 1
      IF(INCX.LT.0)IX = (-N+1)*INCX + 1
      IF(INCY.LT.0)IY = (-N+1)*INCY + 1
      DO 10 I = 1,N
        DTEMP = DX(IX)
        DX(IX) = DY(IY)
        DY(IY) = DTEMP
        IX = IX + INCX
        IY = IY + INCY
   10 CONTINUE
      RETURN
C
C       CODE FOR BOTH INCREMENTS EQUAL TO 1
C
C
C       CLEAN-UP LOOP
C
   20 M = MOD(N,3)
      IF( M .EQ. 0 ) GO TO 40
      DO 30 I = 1,M
        DTEMP = DX(I)
        DX(I) = DY(I)
        DY(I) = DTEMP
   30 CONTINUE
      IF( N .LT. 3 ) RETURN
   40 MP1 = M + 1
      DO 50 I = MP1,N,3
        DTEMP = DX(I)
        DX(I) = DY(I)
        DY(I) = DTEMP
        DTEMP = DX(I + 1)
        DX(I + 1) = DY(I + 1)
        DY(I + 1) = DTEMP
        DTEMP = DX(I + 2)
        DX(I + 2) = DY(I + 2)
        DY(I + 2) = DTEMP
   50 CONTINUE
      RETURN
      END
      SUBROUTINE DTRCO(T,LDT,N,RCOND,Z,JOB)
C***BEGIN PROLOGUE  DTRCO
C***DATE WRITTEN   780814   (YYMMDD)
C***REVISION DATE  820801   (YYMMDD)
C***REVISION HISTORY  (YYMMDD)
C   000330  Modified array declarations.  (JEC)
C***CATEGORY NO.  D2A3
C***KEYWORDS  CONDITION,DOUBLE PRECISION,FACTOR,LINEAR ALGEBRA,LINPACK,
C             MATRIX,TRIANGULAR
C***AUTHOR  MOLER, C. B., (U. OF NEW MEXICO)
C***PURPOSE  Estimates the condition of a double precision TRIANGULAR
C            matrix.
C***DESCRIPTION
C
C     DTRCO estimates the condition of a double precision triangular
C     matrix.
C
C     On Entry
C
C        T       DOUBLE PRECISION(LDT,N)
C                T contains the triangular matrix.  The zero
C                elements of the matrix are not referenced, and
C                the corresponding elements of the array can be
C                used to store other information.
C
C        LDT     INTEGER
C                LDT is the leading dimension of the array T.
C
C        N       INTEGER
C                N is the order of the system.
C
C        JOB     INTEGER
C                = 0         T  is lower triangular.
C                = nonzero   T  is upper triangular.
C
C     On Return
C
C        RCOND   DOUBLE PRECISION
C                an estimate of the reciprocal condition of  T .
C                For the system  T*X = B , relative perturbations
C                in  T  and  B  of size  EPSILON  may cause
C                relative perturbations in  X  of size  EPSILON/RCOND .
C                If  RCOND  is so small that the logical expression
C                           1.0 + RCOND .EQ. 1.0
C                is true, then  T  may be singular to working
C                precision.  In particular,  RCOND  is zero  if
C                exact singularity is detected or the estimate
C                underflows.
C
C        Z       DOUBLE PRECISION(N)
C                a work vector whose contents are usually unimportant.
C                If  T  is close to a singular matrix, then  Z  is
C                an approximate null vector in the sense that
C                NORM(A*Z) = RCOND*NORM(A)*NORM(Z) .
C
C     LINPACK.  This version dated 08/14/78 .
C     Cleve Moler, University of New Mexico, Argonne National Lab.
C
C     Subroutines and Functions
C
C     BLAS DAXPY,DSCAL,DASUM
C     Fortran DABS,DMAX1,DSIGN
C***REFERENCES  DONGARRA J.J., BUNCH J.R., MOLER C.B., STEWART G.W.,
C                 *LINPACK USERS  GUIDE*, SIAM, 1979.
C***ROUTINES CALLED  DASUM,DAXPY,DSCAL
C***END PROLOGUE  DTRCO
      INTEGER LDT,N,JOB
      DOUBLE PRECISION T(LDT,*),Z(*)
      DOUBLE PRECISION RCOND
C
      DOUBLE PRECISION W,WK,WKM,EK
      DOUBLE PRECISION TNORM,YNORM,S,SM,DASUM
      INTEGER I1,J,J1,J2,K,KK,L
      LOGICAL LOWER
C***FIRST EXECUTABLE STATEMENT  DTRCO
      LOWER = JOB .EQ. 0
C
C     COMPUTE 1-NORM OF T
C
      TNORM = 0.0D0
      DO 10 J = 1, N
         L = J
         IF (LOWER) L = N + 1 - J
         I1 = 1
         IF (LOWER) I1 = J
         TNORM = DMAX1(TNORM,DASUM(L,T(I1,J),1))
   10 CONTINUE
C
C     RCOND = 1/(NORM(T)*(ESTIMATE OF NORM(INVERSE(T)))) .
C     ESTIMATE = NORM(Z)/NORM(Y) WHERE  T*Z = Y  AND  TRANS(T)*Y = E .
C     TRANS(T)  IS THE TRANSPOSE OF T .
C     THE COMPONENTS OF  E  ARE CHOSEN TO CAUSE MAXIMUM LOCAL
C     GROWTH IN THE ELEMENTS OF Y .
C     THE VECTORS ARE FREQUENTLY RESCALED TO AVOID OVERFLOW.
C
C     SOLVE TRANS(T)*Y = E
C
      EK = 1.0D0
      DO 20 J = 1, N
         Z(J) = 0.0D0
   20 CONTINUE
      DO 100 KK = 1, N
         K = KK
         IF (LOWER) K = N + 1 - KK
         IF (Z(K) .NE. 0.0D0) EK = DSIGN(EK,-Z(K))
         IF (DABS(EK-Z(K)) .LE. DABS(T(K,K))) GO TO 30
            S = DABS(T(K,K))/DABS(EK-Z(K))
            CALL DSCAL(N,S,Z,1)
            EK = S*EK
   30    CONTINUE
         WK = EK - Z(K)
         WKM = -EK - Z(K)
         S = DABS(WK)
         SM = DABS(WKM)
         IF (T(K,K) .EQ. 0.0D0) GO TO 40
            WK = WK/T(K,K)
            WKM = WKM/T(K,K)
         GO TO 50
   40    CONTINUE
            WK = 1.0D0
            WKM = 1.0D0
   50    CONTINUE
         IF (KK .EQ. N) GO TO 90
            J1 = K + 1
            IF (LOWER) J1 = 1
            J2 = N
            IF (LOWER) J2 = K - 1
            DO 60 J = J1, J2
               SM = SM + DABS(Z(J)+WKM*T(K,J))
               Z(J) = Z(J) + WK*T(K,J)
               S = S + DABS(Z(J))
   60       CONTINUE
            IF (S .GE. SM) GO TO 80
               W = WKM - WK
               WK = WKM
               DO 70 J = J1, J2
                  Z(J) = Z(J) + W*T(K,J)
   70          CONTINUE
   80       CONTINUE
   90    CONTINUE
         Z(K) = WK
  100 CONTINUE
      S = 1.0D0/DASUM(N,Z,1)
      CALL DSCAL(N,S,Z,1)
C
      YNORM = 1.0D0
C
C     SOLVE T*Z = Y
C
      DO 130 KK = 1, N
         K = N + 1 - KK
         IF (LOWER) K = KK
         IF (DABS(Z(K)) .LE. DABS(T(K,K))) GO TO 110
            S = DABS(T(K,K))/DABS(Z(K))
            CALL DSCAL(N,S,Z,1)
            YNORM = S*YNORM
  110    CONTINUE
         IF (T(K,K) .NE. 0.0D0) Z(K) = Z(K)/T(K,K)
         IF (T(K,K) .EQ. 0.0D0) Z(K) = 1.0D0
         I1 = 1
         IF (LOWER) I1 = K + 1
         IF (KK .GE. N) GO TO 120
            W = -Z(K)
            CALL DAXPY(N-KK,W,T(I1,K),1,Z(I1),1)
  120    CONTINUE
  130 CONTINUE
C     MAKE ZNORM = 1.0
      S = 1.0D0/DASUM(N,Z,1)
      CALL DSCAL(N,S,Z,1)
      YNORM = S*YNORM
C
      IF (TNORM .NE. 0.0D0) RCOND = YNORM/TNORM
      IF (TNORM .EQ. 0.0D0) RCOND = 0.0D0
      RETURN
      END
      SUBROUTINE DTRSL(T,LDT,N,B,JOB,INFO)
C***BEGIN PROLOGUE  DTRSL
C***DATE WRITTEN   780814   (YYMMDD)
C***REVISION DATE  820801   (YYMMDD)
C***REVISION HISTORY  (YYMMDD)
C   000330  Modified array declarations.  (JEC)
C***CATEGORY NO.  D2A3
C***KEYWORDS  DOUBLE PRECISION,LINEAR ALGEBRA,LINPACK,MATRIX,SOLVE,
C             TRIANGULAR
C***AUTHOR  STEWART, G. W., (U. OF MARYLAND)
C***PURPOSE  Solves systems of the form  T*X=B or  TRANS(T)*X=B  where T
C            is a TRIANGULAR matrix of order N.
C***DESCRIPTION
C
C     DTRSL solves systems of the form
C
C                   T * X = B
C     or
C                   TRANS(T) * X = B
C
C     where T is a triangular matrix of order N.  Here TRANS(T)
C     denotes the transpose of the matrix T.
C
C     On Entry
C
C         T         DOUBLE PRECISION(LDT,N)
C                   T contains the matrix of the system.  The zero
C                   elements of the matrix are not referenced, and
C                   the corresponding elements of the array can be
C                   used to store other information.
C
C         LDT       INTEGER
C                   LDT is the leading dimension of the array T.
C
C         N         INTEGER
C                   N is the order of the system.
C
C         B         DOUBLE PRECISION(N).
C                   B contains the right hand side of the system.
C
C         JOB       INTEGER
C                   JOB specifies what kind of system is to be solved.
C                   If JOB is
C
C                        00   solve T*X=B, T lower triangular,
C                        01   solve T*X=B, T upper triangular,
C                        10   solve TRANS(T)*X=B, T lower triangular,
C                        11   solve TRANS(T)*X=B, T upper triangular.
C
C     On Return
C
C         B         B contains the solution, if INFO .EQ. 0.
C                   Otherwise B is unaltered.
C
C         INFO      INTEGER
C                   INFO contains zero if the system is nonsingular.
C                   Otherwise INFO contains the index of
C                   the first zero diagonal element of T.
C
C     LINPACK.  This version dated 08/14/78 .
C     G. W. Stewart, University of Maryland, Argonne National Lab.
C
C     Subroutines and Functions
C
C     BLAS DAXPY,DDOT
C     Fortran MOD
C***REFERENCES  DONGARRA J.J., BUNCH J.R., MOLER C.B., STEWART G.W.,
C                 *LINPACK USERS  GUIDE*, SIAM, 1979.
C***ROUTINES CALLED  DAXPY,DDOT
C***END PROLOGUE  DTRSL
      INTEGER LDT,N,JOB,INFO
      DOUBLE PRECISION T(LDT,*),B(*)
C
C
      DOUBLE PRECISION DDOT,TEMP
      INTEGER CASE,J,JJ
C
C     BEGIN BLOCK PERMITTING ...EXITS TO 150
C
C        CHECK FOR ZERO DIAGONAL ELEMENTS.
C
C***FIRST EXECUTABLE STATEMENT  DTRSL
         DO 10 INFO = 1, N
C     ......EXIT
            IF (T(INFO,INFO) .EQ. 0.0D0) GO TO 150
   10    CONTINUE
         INFO = 0
C
C        DETERMINE THE TASK AND GO TO IT.
C
         CASE = 1
         IF (MOD(JOB,10) .NE. 0) CASE = 2
         IF (MOD(JOB,100)/10 .NE. 0) CASE = CASE + 2
         GO TO (20,50,80,110), CASE
C
C        SOLVE T*X=B FOR T LOWER TRIANGULAR
C
   20    CONTINUE
            B(1) = B(1)/T(1,1)
            IF (N .LT. 2) GO TO 40
            DO 30 J = 2, N
               TEMP = -B(J-1)
               CALL DAXPY(N-J+1,TEMP,T(J,J-1),1,B(J),1)
               B(J) = B(J)/T(J,J)
   30       CONTINUE
   40       CONTINUE
         GO TO 140
C
C        SOLVE T*X=B FOR T UPPER TRIANGULAR.
C
   50    CONTINUE
            B(N) = B(N)/T(N,N)
            IF (N .LT. 2) GO TO 70
            DO 60 JJ = 2, N
               J = N - JJ + 1
               TEMP = -B(J+1)
               CALL DAXPY(J,TEMP,T(1,J+1),1,B(1),1)
               B(J) = B(J)/T(J,J)
   60       CONTINUE
   70       CONTINUE
         GO TO 140
C
C        SOLVE TRANS(T)*X=B FOR T LOWER TRIANGULAR.
C
   80    CONTINUE
            B(N) = B(N)/T(N,N)
            IF (N .LT. 2) GO TO 100
            DO 90 JJ = 2, N
               J = N - JJ + 1
               B(J) = B(J) - DDOT(JJ-1,T(J+1,J),1,B(J+1),1)
               B(J) = B(J)/T(J,J)
   90       CONTINUE
  100       CONTINUE
         GO TO 140
C
C        SOLVE TRANS(T)*X=B FOR T UPPER TRIANGULAR.
C
  110    CONTINUE
            B(1) = B(1)/T(1,1)
            IF (N .LT. 2) GO TO 130
            DO 120 J = 2, N
               B(J) = B(J) - DDOT(J-1,T(1,J),1,B(1),1)
               B(J) = B(J)/T(J,J)
  120       CONTINUE
  130       CONTINUE
  140    CONTINUE
  150 CONTINUE
      RETURN
      END
      REAL FUNCTION DUMFUN(X0)
C
C     PURPOSE--AUXILLARY FUNCTION FOR COMPUTING A USER-DEFINED
C              FUNCTION.  USED BY THE NUMERICAL DERIVATIVE ROUTINE
C              INITIALLY, BUT MAY BE APPLICABLE TO OTHER APPLICATIONS.
C              IT COMPUTES THE FUNCTION AT THE VALUE X0
C              AND RETURNS THE FUNCTION VALUE IN DUMFUN.
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2004/1
C     ORIGINAL VERSION--JANUARY   2004.
C     UPDATED         --SEPTEMBER 2015. SUPPORT FOR FUNCTION BLOCKS
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      REAL X0
C
      CHARACTER*4 IH
      CHARACTER*4 IH2
C
      INCLUDE 'DPCOPA.INC'
      INCLUDE 'DPCOHK.INC'
      INCLUDE 'DPCODA.INC'
      INCLUDE 'DPCOFB.INC'
C
      COMMON/IFBL2/IFLGFB
C
      CHARACTER*8 IFBNAM
      CHARACTER*8 IFBANS
C
      CHARACTER*4 IFEESV
      COMMON/IFEED/IFEESV
C
      CHARACTER*4 ZMODEL
      CHARACTER*4 IPARN
      CHARACTER*4 IPARN2
      CHARACTER*4 IANGLU
      CHARACTER*4 ITYPEH
      CHARACTER*4 IW21HO
      CHARACTER*4 IW22HO
      CHARACTER*4 IVARN
      CHARACTER*4 IVARN2
      CHARACTER*4 IZNAME
      CHARACTER*4 IZNAM2
      CHARACTER*4 IBUGA3
      CHARACTER*4 IBUGCO
      CHARACTER*4 IBUGEV
      CHARACTER*4 IERROR
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
      CHARACTER*4 ISTEPN
      CHARACTER*4 IFTEXP
      CHARACTER*4 IFTORD
      CHARACTER*4 IFORSW
      CHARACTER*4 ISUBRO
      CHARACTER*4 IFOUND
C
C---------------------------------------------------------------------
C
      PARAMETER (IDUMCH=1000)
      PARAMETER (IDUMC2=100)
C
      DIMENSION PARAM(IDUMC2)
      DIMENSION IPARN(IDUMC2)
      DIMENSION IPARN2(IDUMC2)
      DIMENSION IVARN(IDUMC2)
      DIMENSION IVARN2(IDUMC2)
C
      DIMENSION ZMODEL(IDUMCH)
      DIMENSION ITYPEH(IDUMCH)
      DIMENSION IW21HO(IDUMCH)
      DIMENSION IW22HO(IDUMCH)
      DIMENSION W2HOLD(IDUMCH)
C
      DIMENSION ILOCV(IDUMC2)
C
      COMMON /DUMCMC/ IBUGA3, ITYPEH, IW21HO, IW22HO, IPARN, IPARN2, 
     &                IVARN, IVARN2, ZMODEL, IZNAME, IZNAM2, IZNDEX
      COMMON /DUMCMR/ PARAM, W2HOLD,
     &                NUMCHA, NUMVAR, NWHOLD, NUMDV, ILOCV
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      IERROR='OFF'
      IFOUND='NO'
      ISUBRO='NULL'
      IFTEXP='+'
      IFTORD='DATA'
      IFORSW='E'
C
      MAXCP1=MAXCOL+1
      MAXCP2=MAXCOL+2
      MAXCP3=MAXCOL+3
      MAXCP4=MAXCOL+4
      MAXCP5=MAXCOL+5
      MAXCP6=MAXCOL+6
C
      IF(IBUGA3.EQ.'ON')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,51)
   51   FORMAT('AT THE BEGINNING OF DUMFUN--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,52)IBUGA3
   52   FORMAT('IBUGA3 = ',A4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,53)NUMCHA,NUMDV,NUMVAR
   53   FORMAT('NUMCHA,NUMDV,NUMVAR = ',3I8)
        CALL DPWRST('XXX','BUG ')
        NMAX=NUMCHA
        IF(NMAX.GT.25)NMAX=25
        WRITE(ICOUT,54)(MODEL(J),J=1,NMAX)
   54   FORMAT('MODEL(I) = ',25A4)
        CALL DPWRST('XXX','BUG ')
        DO55I=1,NUMVAR
          WRITE(ICOUT,56)I,PARAM(I),IPARN(I),IPARN2(I)
   56     FORMAT('I,PARAM(I),IPARN(I),IPARN2(I) = ',I8,E15.7,A4,A4)
          CALL DPWRST('XXX','BUG ')
   55   CONTINUE
        DO59I=1,NUMDV
          WRITE(ICOUT,61)I,IVARN(I),IVARN2(I)
   61     FORMAT('I, IVARN(I),IVARN2(I) = ',I8,2X,A4,A4)
          CALL DPWRST('XXX','BUG ')
   59   CONTINUE
        WRITE(ICOUT,69)X0
   69   FORMAT('X0 = ',G15.7)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
C               ***************************
C               **  STEP 3--             **
C               **  INITIALIZE PARAMETERS**
C               ***************************
C
      ISTEPN='3'
      IF(IBUGA3.EQ.'ON')CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      IPASS=2
      IBUGCO=IBUGA3
      IBUGEV=IBUGA3
      FX=0.0
C
      IFBNAM=' '
      IFBANS=' '
      IF(IFLGFB.EQ.1)THEN
        IFBNAM=IFBNA1
        IFBANS=IFBAN1
        IH=IFBPL1(1)(1:4)
        IH2=IFBPL1(1)(5:8)
      ELSEIF(IFLGFB.EQ.2)THEN
        IFBNAM=IFBNA2
        IFBANS=IFBAN2
        IH=IFBPL2(1)(1:4)
        IH2=IFBPL2(1)(5:8)
      ELSEIF(IFLGFB.EQ.3)THEN
        IFBNAM=IFBNA3
        IFBANS=IFBAN3
        IH=IFBPL3(1)(1:4)
        IH2=IFBPL3(1)(5:8)
      ENDIF
C
      IF(IFLGFB.LE.0)THEN
        PARAM(IZNDEX)=X0
        CALL COMPIM(ZMODEL,NUMCHA,IPASS,PARAM,IPARN,IPARN2,NUMVAR,
     1              IANGLU,ITYPEH,IW21HO,IW22HO,W2HOLD,NWHOLD,FX,
     1              IBUGCO,IBUGEV,IERROR)
      ELSE
C
C       FUNCTION BLOCK CASE:
C
C       STEP 1: COMPUTE FUNCTION BLOCK (BUT FIRST SET CURRENT
C               VALUE OF DESIRED PARAMETER)
C
        DO3305II=1,NUMNAM
          IF(IH.EQ.IHNAME(II) .AND. IH2.EQ.IHNAM2(II) .AND.
     1       IUSE(II).EQ.'P')THEN
            VALUE(II)=X0
            IVALUE(II)=INT(X0+0.5)
            GOTO3309
          ENDIF
 3305   CONTINUE
C
C       PARAMETER NAME NOT FOUND IN CURRENT LIST, SO NEED TO ADD
C       TO NAME LIST
C
        IF(NUMNAM.LT.MAXNAM)THEN
          NUMNAM=NUMNAM+1
          IHNAME(NUMNAM)=IH
          IHNAM2(NUMNAM)=IH2
          IUSE(NUMNAM)='P'
          VALUE(NUMNAM)=X0
          IVALUE(NUMNAM)=INT(X0 + 0.5)
        ELSE
          WRITE(ICOUT,999)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,3306)
 3306     FORMAT('***** ERROR IN NUMERICAL DERIVATIVE--')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,3307)
 3307     FORMAT('      MAXIMUM NUMBER OF NAMES EXCEEDED.')
          CALL DPWRST('XXX','BUG ')
        ENDIF
C
 3309   CONTINUE
C
        IFEEDB='OFF'
        CALL DPFBEX(IFBNAM,IANGLU,ISEED,IFTEXP,IFTORD,IFORSW,
     1              IBUGA3,IBUGA3,IBUGCO,IBUGEV,IBUGEV,
     1              ISUBRO,IFOUND,IERROR)
        IFEEDB=IFEESV
C
C       STEP 2: RETRIEVE RESPONSE
C
        DO3320II=1,NUMNAM
          IF(IFBANS(1:4).EQ.IHNAME(II) .AND.
     1       IFBANS(5:8).EQ.IHNAM2(II))THEN
            IF(IUSE(II).EQ.'P')THEN
              FX=VALUE(II)
              GOTO3329
            ELSEIF(IUSE(II).EQ.'V')THEN
              ICOLR=IVALUE(II)
              IJ=MAXN*(ICOLR-1)+1
              IF(ICOLR.LE.MAXCOL)FX=V(IJ)
              IF(ICOLR.EQ.MAXCP1)FX=PRED(1)
              IF(ICOLR.EQ.MAXCP2)FX=RES(1)
              IF(ICOLR.EQ.MAXCP3)FX=YPLOT(1)
              IF(ICOLR.EQ.MAXCP4)FX=XPLOT(1)
              IF(ICOLR.EQ.MAXCP5)FX=X2PLOT(1)
              IF(ICOLR.EQ.MAXCP6)FX=TAGPLO(1)
              GOTO3329
            ENDIF
          ENDIF
 3320   CONTINUE
C
C       PARAMETER/VARIABLE NAME NOT FOUND
C
        WRITE(ICOUT,3306)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,3321)
 3321   FORMAT('      EXPECTED PARAMETER/VARIABLE NOT FOUND IN ',
     1         'NAME TABLE.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,3323)IFBANS
 3323   FORMAT('      EXPECTED NAME = ',A8)
        CALL DPWRST('XXX','BUG ')
C
 3329   CONTINUE
C
      ENDIF
C
      DUMFUN=FX
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT       **
C               *****************
C
      IF(IBUGA3.EQ.'ON')THEN
        WRITE(ICOUT,9011)
 9011   FORMAT('***** AT THE END      OF DUMFUN--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9021)FX,IERROR
 9021   FORMAT('FX,IERROR = ',G15.7,A4)
        CALL DPWRST('XXX','BUG ')
        DO9102KK=1,NUMDV
          WRITE(ICOUT,9103)KK,PARAM(KK)
 9103     FORMAT('I,PARAM(I) = ',I5,1X,G15.7)
          CALL DPWRST('XXX','BUG ')
 9102   CONTINUE
      ENDIF
C
      RETURN
      END
      SUBROUTINE DUNRAN(N,NPAR,ISEED,X)
C
C     PURPOSE--THIS SUBROUTINE GENERATES A RANDOM SAMPLE OF SIZE N
C              FROM THE DISCRETE UNIFORM DISTRIBUTION
C              WITH INTEGER 'NUMBER OF ITEMS' = NPAR
C     INPUT  ARGUMENTS--N      = THE DESIRED INTEGER NUMBER
C                                OF RANDOM NUMBERS TO BE
C                                GENERATED.
C                     --NPAR   = THE INTEGER VALUE
C                                OF THE 'NUMBER OF ITEMS' PARAMETER.
C                                NPAR SHOULD BE A POSITIVE INTEGER.
C     OUTPUT ARGUMENTS--X      = A SINGLE PRECISION VECTOR
C                                (OF DIMENSION AT LEAST N)
C                                INTO WHICH THE GENERATED
C                                RANDOM SAMPLE WILL BE PLACED.
C     OUTPUT--A RANDOM SAMPLE OF SIZE N
C             FROM THE DISCRETE UNIFORM DISTRIBUTION
C             WITH 'NUMBER OF ITEMS' PARAMETER = NPAR.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--THERE IS NO RESTRICTION ON THE MAXIMUM VALUE
C                   OF N FOR THIS SUBROUTINE.
C                 --NPAR SHOULD BE A POSITIVE INTEGER.
C     OTHER DATAPAC   SUBROUTINES NEEDED--UNIRAN.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--NONE.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     COMMENT--NOTE THAT EVEN THOUGH THE OUTPUT
C              FROM THIS DISCRETE RANDOM NUMBER
C              GENERATOR MUST NECESSARILY BE A
C              SEQUENCE OF ***INTEGER*** VALUES,
C              THE OUTPUT VECTOR X IS SINGLE
C              PRECISION IN MODE.
C              X HAS BEEN SPECIFIED AS SINGLE
C              PRECISION SO AS TO CONFORM WITH THE DATAPAC
C              CONVENTION THAT ALL OUTPUT VECTORS FROM ALL
C              DATAPAC SUBROUTINES ARE SINGLE PRECISION.
C              THIS CONVENTION IS BASED ON THE BELIEF THAT
C              1) A MIXTURE OF MODES (FLOATING POINT
C              VERSUS INTEGER) IS INCONSISTENT AND
C              AN UNNECESSARY COMPLICATION
C              IN A DATA ANALYSIS; AND
C              2) FLOATING POINT MACHINE ARITHMETIC
C              (AS OPPOSED TO INTEGER ARITHMETIC)
C              IS THE MORE NATURAL MODE FOR DOING
C              DATA ANALYSIS.
C     REFERENCE--JOHNSON AND KOTZ
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--89/1
C     ORIGINAL VERSION--DECEMBER  1988.
C     UPDATED         --JUNE      2005. ROUTINE WAS GENERATING RANDOM
C                                       NUMBERS FROM 1 TO N RATHER
C                                       THAN 0 TO N.  CORRECTED TO
C                                       GENERATE FROM 0 TO N.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C---------------------------------------------------------------------
C
      DIMENSION X(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(N.LT.1)THEN
        WRITE(ICOUT, 5)
    5   FORMAT('***** ERROR--THE REQUESTED NUMBER OF DISCRETE ',
     1         'UNIFORM RANDOM NUMBERS IS NON-POSITIVE *****')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,47)N
   47   FORMAT('***** THE VALUE OF THE ARGUMENT IS ',I8,' *****')
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(NPAR.LT.1)THEN
        WRITE(ICOUT,25)
   25   FORMAT('***** ERROR--THE SHAPE PARAMETER (N) FOR THE DISCRETE',
     1         'UNIFORM RANDOM NUMBERS IS NON-POSITIVE *****')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,47)NPAR
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
C
C     GENERATE N UNIFORM (0,1) (CONTINOUS) RANDOM NUMBERS;
C
      CALL UNIRAN(N,ISEED,X)
C
C     CONVERT THE N CONTINUOUS UNIFORM RANDOM NUMBERS OVER [0,1]
C     TO N DISCRETE UNIFORM RANDOM NUMBERS OVER [0,NPAR]
C
CCCCC JUNE 2005. GENERATE OVER [0,NPAR] RATHER THAN [1,NPAR].  USE
CCCCC CURRENT ALGORITHM FOR [1,NPAR+1] THEN SUBTRACT 1.
C
      NPART=NPAR+1
      ANPAR=NPART
      DO1100I=1,N
        U=X(I)
        PROD=ANPAR*U
        IPROD=INT(PROD)
        IPROD=IPROD+1
        IF(IPROD.LT.1)IPROD=1
        IF(IPROD.GT.NPART)IPROD=NPART
        X(I)=IPROD - 1
 1100 CONTINUE
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE DUNRA2(N,NPAR,ISEED,X)
C
C     PURPOSE--THIS SUBROUTINE GENERATES A RANDOM SAMPLE OF SIZE N
C              FROM THE DISCRETE UNIFORM DISTRIBUTION
C              WITH INTEGER 'NUMBER OF ITEMS' = NPAR
C     INPUT  ARGUMENTS--N      = THE DESIRED INTEGER NUMBER
C                                OF RANDOM NUMBERS TO BE
C                                GENERATED.
C                     --NPAR   = THE INTEGER VALUE
C                                OF THE 'NUMBER OF ITEMS' PARAMETER.
C                                NPAR SHOULD BE A POSITIVE INTEGER.
C     OUTPUT ARGUMENTS--X      = A SINGLE PRECISION VECTOR
C                                (OF DIMENSION AT LEAST N)
C                                INTO WHICH THE GENERATED
C                                RANDOM SAMPLE WILL BE PLACED.
C     OUTPUT--A RANDOM SAMPLE OF SIZE N
C             FROM THE DISCRETE UNIFORM DISTRIBUTION
C             WITH 'NUMBER OF ITEMS' PARAMETER = NPAR.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--THERE IS NO RESTRICTION ON THE MAXIMUM VALUE
C                   OF N FOR THIS SUBROUTINE.
C                 --NPAR SHOULD BE A POSITIVE INTEGER.
C     OTHER DATAPAC   SUBROUTINES NEEDED--UNIRAN.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--NONE.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     COMMENT--NOTE THAT EVEN THOUGH THE OUTPUT
C              FROM THIS DISCRETE RANDOM NUMBER
C              GENERATOR MUST NECESSARILY BE A
C              SEQUENCE OF ***INTEGER*** VALUES,
C              THE OUTPUT VECTOR X IS SINGLE
C              PRECISION IN MODE.
C              X HAS BEEN SPECIFIED AS SINGLE
C              PRECISION SO AS TO CONFORM WITH THE DATAPAC
C              CONVENTION THAT ALL OUTPUT VECTORS FROM ALL
C              DATAPAC SUBROUTINES ARE SINGLE PRECISION.
C              THIS CONVENTION IS BASED ON THE BELIEF THAT
C              1) A MIXTURE OF MODES (FLOATING POINT
C              VERSUS INTEGER) IS INCONSISTENT AND
C              AN UNNECESSARY COMPLICATION
C              IN A DATA ANALYSIS; AND
C              2) FLOATING POINT MACHINE ARITHMETIC
C              (AS OPPOSED TO INTEGER ARITHMETIC)
C              IS THE MORE NATURAL MODE FOR DOING
C              DATA ANALYSIS.
C     REFERENCE--JOHNSON AND KOTZ
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--89/1
C     ORIGINAL VERSION--DECEMBER  1988.
C     UPDATED         --JUNE      2005. ROUTINE WAS GENERATING RANDOM
C                                       NUMBERS FROM 1 TO N RATHER
C                                       THAN 0 TO N.  CORRECTED TO
C                                       GENERATE FROM 0 TO N.
C     UPDATED         --AUGUST    2005. THIS IS A COPY OF THE ORIGINAL
C                                       DUNRAN THAT GOES FROM 1 TO N.
C                                       THIS VERSION OF ROUTINE USED
C                                       BY BOOTSTRAP COMMAND.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C---------------------------------------------------------------------
C
      DIMENSION X(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(N.LT.1)THEN
        WRITE(ICOUT, 5)
    5   FORMAT('***** ERROR--THE REQUESTED NUMBER OF DISCRETE ',
     1         'UNIFORM RANDOM NUMBERS IS NON-POSITIVE *****')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,47)N
   47   FORMAT('***** THE VALUE OF THE ARGUMENT IS ',I8,' *****')
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(NPAR.LT.1)THEN
        WRITE(ICOUT,25)
   25   FORMAT('***** ERROR--THE SHAPE PARAMETER (N) FOR THE DISCRETE',
     1         'UNIFORM RANDOM NUMBERS IS NON-POSITIVE *****')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,47)NPAR
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
C
C     GENERATE N UNIFORM (0,1) (CONTINOUS) RANDOM NUMBERS;
C
      CALL UNIRAN(N,ISEED,X)
C
C     CONVERT THE N CONTINUOUS UNIFORM RANDOM NUMBERS OVER [0,1]
C     TO N DISCRETE UNIFORM RANDOM NUMBERS OVER [1,NPAR]
C
      ANPAR=NPAR
      DO1100I=1,N
      U=X(I)
      PROD=ANPAR*U
      IPROD=INT(PROD)
      IPROD=IPROD+1
      IF(IPROD.LT.1)IPROD=1
      IF(IPROD.GT.NPAR)IPROD=NPAR
      X(I)=IPROD
 1100 CONTINUE
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE DVLA(VA,X,PD)
C
C       ====================================================
C       Purpose: Compute parabolic cylinder functions Dv(x)
C                for large argument
C       Input:   x  --- Argument
C                va --- Order
C       Output:  PD --- Dv(x)
C       Routines called:
C             (1) VVLA for computing Vv(x) for large |x|
C             (2) GAMMA for computing (x)
C                 SUBSTITUTE CMLIB DGAMMA FUNCTION
C       ====================================================
C
        IMPLICIT DOUBLE PRECISION (A-H,O-Z)
        PI=3.141592653589793D0           
        EPS=1.0D-12
        EP=DEXP(-.25*X*X)
        A0=DABS(X)**VA*EP
        R=1.0D0
        PD=1.0D0
        DO 10 K=1,16
           R=-0.5D0*R*(2.0*K-VA-1.0)*(2.0*K-VA-2.0)/(K*X*X)
           PD=PD+R
           IF (DABS(R/PD).LT.EPS) GO TO 15
10      CONTINUE
15      PD=A0*PD
        IF (X.LT.0.0D0) THEN
            X1=-X
            CALL VVLA(VA,X1,VL)
CCCCC       CALL GAMMA(-VA,GL)
            GL=DGAMMA(-VA)
            PD=PI*VL/GL+DCOS(PI*VA)*PD
        ENDIF
        RETURN
        END
      SUBROUTINE DVSA(VA,X,PD)
C
C       ===================================================
C       Purpose: Compute parabolic cylinder function Dv(x)
C                for small argument
C       Input:   x  --- Argument
C                va --- Order
C       Output:  PD --- Dv(x)
C       Routine called: GAMMA for computing (x)
C                SUBSTITUTE CMLIB DGAMMA FUNCTION
C       ===================================================
C
        IMPLICIT DOUBLE PRECISION (A-H,O-Z)
        EPS=1.0D-15
        PI=3.141592653589793D0
        SQ2=DSQRT(2.0D0)
        EP=DEXP(-.25D0*X*X)
        VA0=0.5D0*(1.0D0-VA)
        IF (VA.EQ.0.0) THEN
           PD=EP
        ELSE
           IF (X.EQ.0.0) THEN
              IF (VA0.LE.0.0.AND.VA0.EQ.INT(VA0)) THEN
                 PD=0.0D0
              ELSE
CCCCC            CALL GAMMA(VA0,GA0)
                 GA0=DGAMMA(VA0)
                 PD=DSQRT(PI)/(2.0D0**(-.5D0*VA)*GA0)
              ENDIF
           ELSE
CCCCC         CALL GAMMA(-VA,G1)
              G1=DGAMMA(-VA)
              A0=2.0D0**(-0.5D0*VA-1.0D0)*EP/G1
              VT=-.5D0*VA
CCCCC         CALL GAMMA(VT,G0)
              G0=DGAMMA(VT)
              PD=G0
              R=1.0D0
              DO 10 M=1,250
                 VM=.5D0*(M-VA)
CCCCC            CALL GAMMA(VM,GM)
                 GM=DGAMMA(VM)
                 R=-R*SQ2*X/M
                 R1=GM*R
                 PD=PD+R1
                 IF (DABS(R1).LT.DABS(PD)*EPS) GO TO 15
10            CONTINUE
15            PD=A0*PD
           ENDIF
        ENDIF
        RETURN
        END
      SUBROUTINE DWECDF(X,GAMMA,CDF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE CUMULATIVE DISTRIBUTION
C              FUNCTION VALUE FOR THE DOUBLE WEIBULL
C              DISTRIBUTION WITH SINGLE PRECISION
C              TAIL LENGTH PARAMETER = GAMMA.
C              THE DOUBLE WEIBULL DISTRIBUTION USED
C              HEREIN IS DEFINED FOR ALL REAL X,
C              AND HAS THE PROBABILITY DENSITY FUNCTION
C                 F(X) = (C/2)*X*EXP(-ABS(X)**C)
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE AT
C                                WHICH THE PROBABILITY DENSITY
C                                FUNCTION IS TO BE EVALUATED.
C                     --GAMMA  = THE SHAPE PARAMETER
C                                GAMMA SHOULD BE POSITIVE.
C     OUTPUT ARGUMENTS--CDF    = THE SINGLE PRECISION PROBABILITY
C                                DENSITY FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION PROBABILITY DENSITY
C             FUNCTION VALUE CDF FOR THE DOUBLE WEIBULL DISTRIBUTION
C             WITH TAIL LENGHT PARAMETER = GAMMA.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--GAMMA SHOULD BE POSITIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--EXP.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCE --JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--2, 1994, CHAPTER 21
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1966)
C               EXCEPTION--HOLLERITH STRINGS IN FORMAT STATEMENTS
C                          DENOTED BY QUOTES RATHER THAN NH.
C     VERSION NUMBER--95/10
C     ORIGINAL VERSION--OCTOBER   1995.
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      CDF=0.0
      IF(GAMMA.LE.0)THEN
        WRITE(ICOUT,15)
   15   FORMAT('***** ERROR--THE SECOND ARGUMENT TO DWECDF IS ',
     1         'NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)GAMMA
   46   FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7)
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
C
CCCCC THE FOLLOWING SECTION WAS REWRITTEN      JANUARY 1994
      MINMAX=1
      IF(X.EQ.0.0)THEN
        CDF=0.5
      ELSEIF(X.GT.0.0)THEN
        CALL WEICDF(X,GAMMA,MINMAX,CDF2)
        CDF=0.5+CDF2/2.0
      ELSE
        ARG1=-X
        CALL WEICDF(ARG1,GAMMA,MINMAX,CDF2)
        CDF=0.5-CDF2/2.0
      ENDIF
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE DWEPDF(X,GAMMA,PDF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE PROBABILITY DENSITY
C              FUNCTION VALUE FOR THE DOUBLE WEIBULL
C              DISTRIBUTION WITH SINGLE PRECISION
C              TAIL LENGTH PARAMETER = GAMMA.
C              THE DOUBLE WEIBULL DISTRIBUTION USED
C              HEREIN IS DEFINED FOR ALL REAL X,
C              AND HAS THE PROBABILITY DENSITY FUNCTION
C                 F(X) = (C/2)*X*EXP(-ABS(X)**C)
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE AT
C                                WHICH THE PROBABILITY DENSITY
C                                FUNCTION IS TO BE EVALUATED.
C                     --GAMMA  = THE SHAPE PARAMETER
C                                GAMMA SHOULD BE POSITIVE.
C     OUTPUT ARGUMENTS--PDF    = THE SINGLE PRECISION PROBABILITY
C                                DENSITY FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION PROBABILITY DENSITY
C             FUNCTION VALUE PDF FOR THE DOUBLE WEIBULL DISTRIBUTION
C             WITH TAIL LENGHT PARAMETER = GAMMA.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--GAMMA SHOULD BE POSITIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--WEIPDF.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--EXP.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCE --JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--2, 1994, CHAPTER 21
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--95/10
C     ORIGINAL VERSION--OCTOBER   1995.
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      PDF=0.0
      IF(GAMMA.LE.0)THEN
        WRITE(ICOUT,15)
   15   FORMAT('***** ERROR--THE SECOND ARGUMENT TO DWEPDF IS ',
     1         'NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)GAMMA
   46   FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7)
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
C
CCCCC THE FOLLOWING SECTION WAS REWRITTEN      JANUARY 1994
      MINMAX=1
      ARG1=ABS(X)
      CALL WEIPDF(ARG1,GAMMA,MINMAX,PDF2)
      PDF=PDF2/2.0
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE DWEPPF(P,GAMMA,PPF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE PROBABILITY DENSITY
C              FUNCTION VALUE FOR THE DOUBLE WEIBULL
C              DISTRIBUTION WITH SINGLE PRECISION
C              TAIL LENGTH PARAMETER = GAMMA.
C              THE DOUBLE WEIBULL DISTRIBUTION USED
C              HEREIN IS DEFINED FOR ALL REAL X,
C              AND HAS THE PROBABILITY DENSITY FUNCTION
C                 F(X) = (C/2)*X*EXP(-ABS(X)**C)
C     INPUT  ARGUMENTS--P      = THE SINGLE PRECISION VALUE
C                                (BETWEEN 0.0 (INCLUSIVELY)
C                                AND 1.0 (EXCLUSIVELY))
C                                AT WHICH THE PERCENT POINT
C                                FUNCTION IS TO BE EVALUATED.
C                     --GAMMA  = THE SINGLE PRECISION VALUE
C                                OF THE TAIL LENGTH PARAMETER.
C                                GAMMA SHOULD BE POSITIVE.
C     OUTPUT ARGUMENTS--PPF    = THE SINGLE PRECISION PERCENT
C                                POINT FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION PERCENT POINT FUNCTION .
C             VALUE PPF FOR THE WEIBULL DISTRIBUTION
C             WITH TAIL LENGTH PARAMETER VALUE = GAMMA.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--GAMMA SHOULD BE POSITIVE.
C                 --P SHOULD BE BETWEEN 0.0 (EXCLUSIVELY)
C                   AND 1.0 (EXCLUSIVELY).
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--LOG.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCE --JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--2, 1994, CHAPTER 21
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--95/10
C     ORIGINAL VERSION--OCTOBER   1995.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      PPF=0.0
      IF(P.LE.0.0.OR.P.GE.1.0)THEN
        WRITE(ICOUT,1)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)P
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(GAMMA.LE.0.0)THEN
        WRITE(ICOUT,15)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)GAMMA
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
    1 FORMAT('***** ERROR--THE FIRST ARGUMENT TO DWEPPF IS ',
     1       'OUTSIDE THE ALLOWABLE (0,1) INTERVAL')
   15 FORMAT('***** ERROR--THE SECOND ARGUMENT TO DWEPPF IS ',
     1       'NON-POSITIVE')
   46 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7)
C
      MINMAX=1
      IF(P.EQ.0.5)THEN
        PPF=0.0
      ELSEIF(P.LT.0.5)THEN
        ARG1=2.0*(0.5-P)
        CALL WEIPPF(ARG1,GAMMA,MINMAX,PPF)
        PPF=-PPF
      ELSE
        ARG1=2.0*(P-0.5)
        CALL WEIPPF(ARG1,GAMMA,MINMAX,PPF)
      ENDIF
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE DWERAN(N,GAMMA,ISEED,X)
C
C     PURPOSE--THIS SUBROUTINE GENERATES A RANDOM SAMPLE OF SIZE N
C              FROM THE DOUBLE WEIBULL DISTRIBUTION
C              WITH TAIL LENGTH PARAMETER VALUE = GAMMA.
C     INPUT  ARGUMENTS--N      = THE DESIRED INTEGER NUMBER
C                                OF RANDOM NUMBERS TO BE
C                                GENERATED.
C                     --GAMMA  = THE SINGLE PRECISION VALUE OF THE
C                                TAIL LENGTH PARAMETER.
C                                GAMMA SHOULD BE POSITIVE.
C     OUTPUT ARGUMENTS--X      = A SINGLE PRECISION VECTOR
C                                (OF DIMENSION AT LEAST N)
C                                INTO WHICH THE GENERATED
C                                RANDOM SAMPLE WILL BE PLACED.
C     OUTPUT--A RANDOM SAMPLE OF SIZE N
C             FROM THE DOUBLE WEIBULL DISTRIBUTION
C             WITH TAIL LENGTH PARAMETER VALUE = GAMMA.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--THERE IS NO RESTRICTION ON THE MAXIMUM VALUE
C                   OF N FOR THIS SUBROUTINE.
C                 --GAMMA SHOULD BE POSITIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--UNIRAN.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--NON E.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--1, 2ND. ED., 1994.
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1966)
C               EXCEPTION--HOLLERITH STRINGS IN FORMAT STATEMENTS
C                          DENOTED BY QUOTES RATHER THAN NH.
C     VERSION NUMBER--2001.9
C     ORIGINAL VERSION--SEPTEMBER 2001.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C---------------------------------------------------------------------
C
      DIMENSION X(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(N.LT.1)THEN
        WRITE(ICOUT, 5)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,47)N
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(GAMMA.LE.0.0)THEN
        WRITE(ICOUT,15)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)GAMMA
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
    5 FORMAT('***** ERROR--THE REQUESTED NUMBER OF DOUBLE WEIBULL ',
     1       'RANDOM NUMBERS IS NON-POSITIVE')
   15 FORMAT('***** ERROR--THE SPECIFIED VALUE OF GAMMA FOR THE ',
     1       'DOUBLE WEIBULL RANDOM NUMBERS IS NON-POSITIVE')
   46 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7)
   47 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',I8)
C
C     GENERATE N UNIFORM (0,1) RANDOM NUMBERS;
C
      CALL UNIRAN(N,ISEED,X)
C
C     GENERATE N DOUBLE WEIBULL DISTRIBUTION RANDOM NUMBERS
C     USING THE PERCENT POINT FUNCTION TRANSFORMATION METHOD.
C
      DO100I=1,N
        CALL DWEPPF(X(I),GAMMA,XTEMP)
        X(I)=XTEMP
  100 CONTINUE
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE DXADD (X, IX, Y, IY, Z, IZ, IERROR)
C***BEGIN PROLOGUE  DXADD
C***PURPOSE  To provide double-precision floating-point arithmetic
C            with an extended exponent range.
C***LIBRARY   SLATEC
C***CATEGORY  A3D
C***TYPE      DOUBLE PRECISION (XADD-S, DXADD-D)
C***KEYWORDS  EXTENDED-RANGE DOUBLE-PRECISION ARITHMETIC
C***AUTHOR  Lozier, Daniel W., (NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY)
C           Smith, John M., (NBS and George Mason University)
C***DESCRIPTION
C     DOUBLE PRECISION X, Y, Z
C     INTEGER IX, IY, IZ
C
C                  FORMS THE EXTENDED-RANGE SUM  (Z,IZ) =
C                  (X,IX) + (Y,IY).  (Z,IZ) IS ADJUSTED
C                  BEFORE RETURNING. THE INPUT OPERANDS
C                  NEED NOT BE IN ADJUSTED FORM, BUT THEIR
C                  PRINCIPAL PARTS MUST SATISFY
C                  RADIX**(-2L).LE.ABS(X).LE.RADIX**(2L),
C                  RADIX**(-2L).LE.ABS(Y).LE.RADIX**(2L).
C
C***SEE ALSO  DXSET
C***REFERENCES  (NONE)
C***ROUTINES CALLED  DXADJ
C***COMMON BLOCKS    DXBLK2
C***REVISION HISTORY  (YYMMDD)
C   820712  DATE WRITTEN
C   881020  Revised to meet SLATEC CML recommendations.  (DWL and JMS)
C   901019  Revisions to prologue.  (DWL and WRB)
C   901106  Changed all specific intrinsics to generic.  (WRB)
C           Corrected order of sections in prologue and added TYPE
C           section.  (WRB)
C   920127  Revised PURPOSE section of prologue.  (DWL)
C***END PROLOGUE  DXADD
      DOUBLE PRECISION X, Y, Z
      INTEGER IX, IY, IZ
      DOUBLE PRECISION RADIX, RADIXL, RAD2L, DLG10R
      INTEGER L, L2, KMAX
      COMMON /DXBLK2/ RADIX, RADIXL, RAD2L, DLG10R, L, L2, KMAX
      SAVE /DXBLK2/
      DOUBLE PRECISION S, T
C
C   THE CONDITIONS IMPOSED ON L AND KMAX BY THIS SUBROUTINE
C ARE
C     (1) 1 .LT. L .LE. 0.5D0*LOGR(0.5D0*DZERO)
C
C     (2) NRADPL .LT. L .LE. KMAX/6
C
C     (3) KMAX .LE. (2**NBITS - 4*L - 1)/2
C
C THESE CONDITIONS MUST BE MET BY APPROPRIATE CODING
C IN SUBROUTINE DXSET.
C
C***FIRST EXECUTABLE STATEMENT  DXADD
      IERROR=0
      IF (X.NE.0.0D0) GO TO 10
      Z = Y
      IZ = IY
      GO TO 220
   10 IF (Y.NE.0.0D0) GO TO 20
      Z = X
      IZ = IX
      GO TO 220
   20 CONTINUE
      IF (IX.GE.0 .AND. IY.GE.0) GO TO 40
      IF (IX.LT.0 .AND. IY.LT.0) GO TO 40
      IF (ABS(IX).LE.6*L .AND. ABS(IY).LE.6*L) GO TO 40
      IF (IX.GE.0) GO TO 30
      Z = Y
      IZ = IY
      GO TO 220
   30 CONTINUE
      Z = X
      IZ = IX
      GO TO 220
   40 I = IX - IY
CCCCC IF (I) 80, 50, 90
      IF(I.LT.0)GOTO80
      IF(I.GT.0)GOTO90
      IF (ABS(X).GT.1.0D0 .AND. ABS(Y).GT.1.0D0) GO TO 60
      IF (ABS(X).LT.1.0D0 .AND. ABS(Y).LT.1.0D0) GO TO 70
      Z = X + Y
      IZ = IX
      GO TO 220
   60 S = X/RADIXL
      T = Y/RADIXL
      Z = S + T
      IZ = IX + L
      GO TO 220
   70 S = X*RADIXL
      T = Y*RADIXL
      Z = S + T
      IZ = IX - L
      GO TO 220
   80 S = Y
      IS = IY
      T = X
      GO TO 100
   90 S = X
      IS = IX
      T = Y
  100 CONTINUE
C
C  AT THIS POINT, THE ONE OF (X,IX) OR (Y,IY) THAT HAS THE
C LARGER AUXILIARY INDEX IS STORED IN (S,IS). THE PRINCIPAL
C PART OF THE OTHER INPUT IS STORED IN T.
C
      I1 = ABS(I)/L
      I2 = MOD(ABS(I),L)
      IF (ABS(T).GE.RADIXL) GO TO 130
      IF (ABS(T).GE.1.0D0) GO TO 120
      IF (RADIXL*ABS(T).GE.1.0D0) GO TO 110
      J = I1 + 1
      T = T*RADIX**(L-I2)
      GO TO 140
  110 J = I1
      T = T*RADIX**(-I2)
      GO TO 140
  120 J = I1 - 1
      IF (J.LT.0) GO TO 110
      T = T*RADIX**(-I2)/RADIXL
      GO TO 140
  130 J = I1 - 2
      IF (J.LT.0) GO TO 120
      T = T*RADIX**(-I2)/RAD2L
  140 CONTINUE
C
C  AT THIS POINT, SOME OR ALL OF THE DIFFERENCE IN THE
C AUXILIARY INDICES HAS BEEN USED TO EFFECT A LEFT SHIFT
C OF T.  THE SHIFTED VALUE OF T SATISFIES
C
C       RADIX**(-2*L) .LE. ABS(T) .LE. 1.0D0
C
C AND, IF J=0, NO FURTHER SHIFTING REMAINS TO BE DONE.
C
      IF (J.EQ.0) GO TO 190
      IF (ABS(S).GE.RADIXL .OR. J.GT.3) GO TO 150
      IF (ABS(S).GE.1.0D0) GO TO (180, 150, 150), J
      IF (RADIXL*ABS(S).GE.1.0D0) GO TO (180, 170, 150), J
      GO TO (180, 170, 160), J
  150 Z = S
      IZ = IS
      GO TO 220
  160 S = S*RADIXL
  170 S = S*RADIXL
  180 S = S*RADIXL
  190 CONTINUE
C
C   AT THIS POINT, THE REMAINING DIFFERENCE IN THE
C AUXILIARY INDICES HAS BEEN USED TO EFFECT A RIGHT SHIFT
C OF S.  IF THE SHIFTED VALUE OF S WOULD HAVE EXCEEDED
C RADIX**L, THEN (S,IS) IS RETURNED AS THE VALUE OF THE
C SUM.
C
      IF (ABS(S).GT.1.0D0 .AND. ABS(T).GT.1.0D0) GO TO 200
      IF (ABS(S).LT.1.0D0 .AND. ABS(T).LT.1.0D0) GO TO 210
      Z = S + T
      IZ = IS - J*L
      GO TO 220
  200 S = S/RADIXL
      T = T/RADIXL
      Z = S + T
      IZ = IS - J*L + L
      GO TO 220
  210 S = S*RADIXL
      T = T*RADIXL
      Z = S + T
      IZ = IS - J*L - L
  220 CALL DXADJ(Z, IZ,IERROR)
      RETURN
      END
      SUBROUTINE DXADJ (X, IX, IERROR)
C***BEGIN PROLOGUE  DXADJ
C***PURPOSE  To provide double-precision floating-point arithmetic
C            with an extended exponent range.
C***LIBRARY   SLATEC
C***CATEGORY  A3D
C***TYPE      DOUBLE PRECISION (XADJ-S, DXADJ-D)
C***KEYWORDS  EXTENDED-RANGE DOUBLE-PRECISION ARITHMETIC
C***AUTHOR  Lozier, Daniel W., (NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY)
C           Smith, John M., (NBS and George Mason University)
C***DESCRIPTION
C     DOUBLE PRECISION X
C     INTEGER IX
C
C                  TRANSFORMS (X,IX) SO THAT
C                  RADIX**(-L) .LE. ABS(X) .LT. RADIX**L.
C                  ON MOST COMPUTERS THIS TRANSFORMATION DOES
C                  NOT CHANGE THE MANTISSA OF X PROVIDED RADIX IS
C                  THE NUMBER BASE OF DOUBLE-PRECISION ARITHMETIC.
C
C***SEE ALSO  DXSET
C***REFERENCES  (NONE)
C***ROUTINES CALLED  XERMSG
C***COMMON BLOCKS    DXBLK2
C***REVISION HISTORY  (YYMMDD)
C   820712  DATE WRITTEN
C   881020  Revised to meet SLATEC CML recommendations.  (DWL and JMS)
C   901019  Revisions to prologue.  (DWL and WRB)
C   901106  Changed all specific intrinsics to generic.  (WRB)
C           Corrected order of sections in prologue and added TYPE
C           section.  (WRB)
C           CALLs to XERROR changed to CALLs to XERMSG.  (WRB)
C   920127  Revised PURPOSE section of prologue.  (DWL)
C***END PROLOGUE  DXADJ
      DOUBLE PRECISION X
      INTEGER IX
      DOUBLE PRECISION RADIX, RADIXL, RAD2L, DLG10R
      INTEGER L, L2, KMAX
      COMMON /DXBLK2/ RADIX, RADIXL, RAD2L, DLG10R, L, L2, KMAX
      SAVE /DXBLK2/
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C   THE CONDITION IMPOSED ON L AND KMAX BY THIS SUBROUTINE
C IS
C     2*L .LE. KMAX
C
C THIS CONDITION MUST BE MET BY APPROPRIATE CODING
C IN SUBROUTINE DXSET.
C
C***FIRST EXECUTABLE STATEMENT  DXADJ
      IERROR=0
      IF (X.EQ.0.0D0) GO TO 50
      IF (ABS(X).GE.1.0D0) GO TO 20
      IF (RADIXL*ABS(X).GE.1.0D0) GO TO 60
      X = X*RAD2L
      IF (IX.LT.0) GO TO 10
      IX = IX - L2
      GO TO 70
   10 IF (IX.LT.-KMAX+L2) GO TO 40
      IX = IX - L2
      GO TO 70
   20 IF (ABS(X).LT.RADIXL) GO TO 60
      X = X/RAD2L
      IF (IX.GT.0) GO TO 30
      IX = IX + L2
      GO TO 70
   30 IF (IX.GT.KMAX-L2) GO TO 40
      IX = IX + L2
      GO TO 70
   40 CONTINUE
CCC40 CALL XERMSG ('SLATEC', 'DXADJ', 'overflow in auxiliary index',
CCCCC+             207, 1)
      IERROR=207
      WRITE(ICOUT,901)
      CALL DPWRST('XXX','BUG ')
  901 FORMAT('***** ERROR FROM DXADJ, OVERFLOW IN AUXILIARY INDEX.')
      RETURN
   50 IX = 0
   60 IF (ABS(IX).GT.KMAX) GO TO 40
   70 RETURN
      END
      SUBROUTINE DXLEGF (DNU1, NUDIFF, MU1, MU2, THETA, ID, PQA, IPQA,
     1   IERROR)
C***BEGIN PROLOGUE  DXLEGF
C***PURPOSE  Compute normalized Legendre polynomials and associated
C            Legendre functions.
C***LIBRARY   SLATEC
C***CATEGORY  C3A2, C9
C***TYPE      DOUBLE PRECISION (XLEGF-S, DXLEGF-D)
C***KEYWORDS  LEGENDRE FUNCTIONS
C***AUTHOR  Smith, John M., (NBS and George Mason University)
C***DESCRIPTION
C
C   DXLEGF: Extended-range Double-precision Legendre Functions
C
C   A feature of the DXLEGF subroutine for Legendre functions is
C the use of extended-range arithmetic, a software extension of
C ordinary floating-point arithmetic that greatly increases the
C exponent range of the representable numbers. This avoids the
C need for scaling the solutions to lie within the exponent range
C of the most restrictive manufacturer's hardware. The increased
C exponent range is achieved by allocating an integer storage
C location together with each floating-point storage location.
C
C   The interpretation of the pair (X,I) where X is floating-point
C and I is integer is X*(IR**I) where IR is the internal radix of
C the computer arithmetic.
C
C   This subroutine computes one of the following vectors:
C
C 1. Legendre function of the first kind of negative order, either
C    a. P(-MU1,NU,X), P(-MU1-1,NU,X), ..., P(-MU2,NU,X) or
C    b. P(-MU,NU1,X), P(-MU,NU1+1,X), ..., P(-MU,NU2,X)
C 2. Legendre function of the second kind, either
C    a. Q(MU1,NU,X), Q(MU1+1,NU,X), ..., Q(MU2,NU,X) or
C    b. Q(MU,NU1,X), Q(MU,NU1+1,X), ..., Q(MU,NU2,X)
C 3. Legendre function of the first kind of positive order, either
C    a. P(MU1,NU,X), P(MU1+1,NU,X), ..., P(MU2,NU,X) or
C    b. P(MU,NU1,X), P(MU,NU1+1,X), ..., P(MU,NU2,X)
C 4. Normalized Legendre polynomials, either
C    a. PN(MU1,NU,X), PN(MU1+1,NU,X), ..., PN(MU2,NU,X) or
C    b. PN(MU,NU1,X), PN(MU,NU1+1,X), ..., PN(MU,NU2,X)
C
C where X = COS(THETA).
C
C   The input values to DXLEGF are DNU1, NUDIFF, MU1, MU2, THETA,
C and ID. These must satisfy
C
C    DNU1 is DOUBLE PRECISION and greater than or equal to -0.5;
C    NUDIFF is INTEGER and non-negative;
C    MU1 is INTEGER and non-negative;
C    MU2 is INTEGER and greater than or equal to MU1;
C    THETA is DOUBLE PRECISION and in the half-open interval (0,PI/2];
C    ID is INTEGER and equal to 1, 2, 3 or 4;
C
C and  additionally either NUDIFF = 0 or MU2 = MU1.
C
C   If ID=1 and NUDIFF=0, a vector of type 1a above is computed
C with NU=DNU1.
C
C   If ID=1 and MU1=MU2, a vector of type 1b above is computed
C with NU1=DNU1, NU2=DNU1+NUDIFF and MU=MU1.
C
C   If ID=2 and NUDIFF=0, a vector of type 2a above is computed
C with NU=DNU1.
C
C   If ID=2 and MU1=MU2, a vector of type 2b above is computed
C with NU1=DNU1, NU2=DNU1+NUDIFF and MU=MU1.
C
C   If ID=3 and NUDIFF=0, a vector of type 3a above is computed
C with NU=DNU1.
C
C   If ID=3 and MU1=MU2, a vector of type 3b above is computed
C with NU1=DNU1, NU2=DNU1+NUDIFF and MU=MU1.
C
C   If ID=4 and NUDIFF=0, a vector of type 4a above is computed
C with NU=DNU1.
C
C   If ID=4 and MU1=MU2, a vector of type 4b above is computed
C with NU1=DNU1, NU2=DNU1+NUDIFF and MU=MU1.
C
C   In each case the vector of computed Legendre function values
C is returned in the extended-range vector (PQA(I),IPQA(I)). The
C length of this vector is either MU2-MU1+1 or NUDIFF+1.
C
C   Where possible, DXLEGF returns IPQA(I) as zero. In this case the
C value of the Legendre function is contained entirely in PQA(I),
C so it can be used in subsequent computations without further
C consideration of extended-range arithmetic. If IPQA(I) is nonzero,
C then the value of the Legendre function is not representable in
C floating-point because of underflow or overflow. The program that
C calls DXLEGF must test IPQA(I) to ensure correct usage.
C
C   IERROR is an error indicator. If no errors are detected, IERROR=0
C when control returns to the calling routine. If an error is detected,
C IERROR is returned as nonzero. The calling routine must check the
C value of IERROR.
C
C   If IERROR=210 or 211, invalid input was provided to DXLEGF.
C   If IERROR=201,202,203, or 204, invalid input was provided to DXSET.
C   If IERROR=205 or 206, an internal consistency error occurred in
C DXSET (probably due to a software malfunction in the library routine
C I1MACH).
C   If IERROR=207, an overflow or underflow of an extended-range number
C was detected in DXADJ.
C   If IERROR=208, an overflow or underflow of an extended-range number
C was detected in DXC210.
C
C***SEE ALSO  DXSET
C***REFERENCES  Olver and Smith, Associated Legendre Functions on the
C                 Cut, J Comp Phys, v 51, n 3, Sept 1983, pp 502--518.
C               Smith, Olver and Lozier, Extended-Range Arithmetic and
C                 Normalized Legendre Polynomials, ACM Trans on Math
C                 Softw, v 7, n 1, March 1981, pp 93--105.
C***ROUTINES CALLED  DXPMU, DXPMUP, DXPNRM, DXPQNU, DXQMU, DXQNU, DXRED,
C                    DXSET, XERMSG
C***REVISION HISTORY  (YYMMDD)
C   820728  DATE WRITTEN
C   890126  Revised to meet SLATEC CML recommendations.  (DWL and JMS)
C   901019  Revisions to prologue.  (DWL and WRB)
C   901106  Changed all specific intrinsics to generic.  (WRB)
C           Corrected order of sections in prologue and added TYPE
C           section.  (WRB)
C           CALLs to XERROR changed to CALLs to XERMSG.  (WRB)
C   920127  Revised PURPOSE section of prologue.  (DWL)
C***END PROLOGUE  DXLEGF
      DOUBLE PRECISION PQA,DNU1,DNU2,SX,THETA,X,PI2
      DIMENSION PQA(*),IPQA(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C***FIRST EXECUTABLE STATEMENT  DXLEGF
      IERROR=0
      CALL DXSET (0, 0, 0.0D0, 0,IERROR)
      IF (IERROR.NE.0) RETURN
      PI2=2.D0*ATAN(1.D0)
C
C        ZERO OUTPUT ARRAYS
C
      L=(MU2-MU1)+NUDIFF+1
      DO 290 I=1,L
        PQA(I)=0.D0
        IPQA(I)=0
  290 CONTINUE
C
C        CHECK FOR VALID INPUT VALUES
C
      IF(NUDIFF.LT.0) GO TO 400
      IF(DNU1.LT.-.5D0) GO TO 400
      IF(MU2.LT.MU1) GO TO 400
      IF(MU1.LT.0) GO TO 400
      IF(THETA.LE.0.D0.OR.THETA.GT.PI2) GO TO 420
      IF(ID.LT.1.OR.ID.GT.4) GO TO 400
      IF((MU1.NE.MU2).AND.(NUDIFF.GT.0)) GO TO 400
C
C        IF DNU1 IS NOT AN INTEGER, NORMALIZED P(MU,DNU,X)
C        CANNOT BE CALCULATED.  IF DNU1 IS AN INTEGER AND
C        MU1.GT.DNU2 THEN ALL VALUES OF P(+MU,DNU,X) AND
C        NORMALIZED P(MU,NU,X) WILL BE ZERO.
C
      DNU2=DNU1+NUDIFF
      IF((ID.EQ.3).AND.(MOD(DNU1,1.D0).NE.0.D0)) GO TO 295
      IF((ID.EQ.4).AND.(MOD(DNU1,1.D0).NE.0.D0)) GO TO 400
      IF((ID.EQ.3.OR.ID.EQ.4).AND.MU1.GT.DNU2) RETURN
  295 CONTINUE
C
      X=COS(THETA)
      SX=1.D0/SIN(THETA)
      IF(ID.EQ.2) GO TO 300
      IF(MU2-MU1.LE.0) GO TO 360
C
C        FIXED NU, VARIABLE MU
C        CALL DXPMU TO CALCULATE P(-MU1,NU,X),....,P(-MU2,NU,X)
C
      CALL DXPMU(DNU1,DNU2,MU1,MU2,THETA,X,SX,ID,PQA,IPQA,IERROR)
      IF (IERROR.NE.0) RETURN
      GO TO 380
C
  300 IF(MU2.EQ.MU1) GO TO 320
C
C        FIXED NU, VARIABLE MU
C        CALL DXQMU TO CALCULATE Q(MU1,NU,X),....,Q(MU2,NU,X)
C
      CALL DXQMU(DNU1,DNU2,MU1,MU2,THETA,X,SX,ID,PQA,IPQA,IERROR)
      IF (IERROR.NE.0) RETURN
      GO TO 390
C
C        FIXED MU, VARIABLE NU
C        CALL DXQNU TO CALCULATE Q(MU,DNU1,X),....,Q(MU,DNU2,X)
C
  320 CALL DXQNU(DNU1,DNU2,MU1,THETA,X,SX,ID,PQA,IPQA,IERROR)
      IF (IERROR.NE.0) RETURN
      GO TO 390
C
C        FIXED MU, VARIABLE NU
C        CALL DXPQNU TO CALCULATE P(-MU,DNU1,X),....,P(-MU,DNU2,X)
C
  360 CALL DXPQNU(DNU1,DNU2,MU1,THETA,ID,PQA,IPQA,IERROR)
      IF (IERROR.NE.0) RETURN
C
C        IF ID = 3, TRANSFORM P(-MU,NU,X) VECTOR INTO
C        P(MU,NU,X) VECTOR.
C
  380 IF(ID.EQ.3) CALL DXPMUP(DNU1,DNU2,MU1,MU2,PQA,IPQA,IERROR)
      IF (IERROR.NE.0) RETURN
C
C        IF ID = 4, TRANSFORM P(-MU,NU,X) VECTOR INTO
C        NORMALIZED P(MU,NU,X) VECTOR.
C
      IF(ID.EQ.4) CALL DXPNRM(DNU1,DNU2,MU1,MU2,PQA,IPQA,IERROR)
      IF (IERROR.NE.0) RETURN
C
C        PLACE RESULTS IN REDUCED FORM IF POSSIBLE
C        AND RETURN TO MAIN PROGRAM.
C
  390 DO 395 I=1,L
      CALL DXRED(PQA(I),IPQA(I),IERROR)
      IF (IERROR.NE.0) RETURN
  395 CONTINUE
      RETURN
C
C        *****     ERROR TERMINATION     *****
C
  400 CONTINUE
CCCCC CALL XERMSG ('SLATEC', 'DXLEGF',
CCCCC+             'DNU1, NUDIFF, MU1, MU2, or ID not valid', 210, 1)
      WRITE(ICOUT,901)
      CALL DPWRST('XXX','BUG ')
  901 FORMAT('***** ERROR FROM DXLEGF, INVALID INPUT ARGUMENTS.')
      IERROR=210
      RETURN
  420 CONTINUE
CCCCC CALL XERMSG ('SLATEC', 'DXLEGF', 'THETA out of range', 211, 1)
      WRITE(ICOUT,902)
      CALL DPWRST('XXX','BUG ')
  902 FORMAT('***** ERROR FROM DXLEGF, THETA OUT OF RANGE.')
      IERROR=211
      RETURN
      END
      SUBROUTINE DXNRMP (NU, MU1, MU2, DARG, MODE, DPN, IPN, ISIG,
     1   IERROR)
C***BEGIN PROLOGUE  DXNRMP
C***PURPOSE  Compute normalized Legendre polynomials.
C***LIBRARY   SLATEC
C***CATEGORY  C3A2, C9
C***TYPE      DOUBLE PRECISION (XNRMP-S, DXNRMP-D)
C***KEYWORDS  LEGENDRE FUNCTIONS
C***AUTHOR  Lozier, Daniel W., (NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY)
C           Smith, John M., (NBS and George Mason University)
C***DESCRIPTION
C
C        SUBROUTINE TO CALCULATE NORMALIZED LEGENDRE POLYNOMIALS
C        (XNRMP is single-precision version)
C        DXNRMP calculates normalized Legendre polynomials of varying
C        order and fixed argument and degree. The order MU and degree
C        NU are non-negative integers and the argument is real. Because
C        the algorithm requires the use of numbers outside the normal
C        machine range, this subroutine employs a special arithmetic
C        called extended-range arithmetic. See J.M. Smith, F.W.J. Olver,
C        and D.W. Lozier, Extended-Range Arithmetic and Normalized
C        Legendre Polynomials, ACM Transactions on Mathematical Soft-
C        ware, 93-105, March 1981, for a complete description of the
C        algorithm and special arithmetic. Also see program comments
C        in DXSET.
C
C        The normalized Legendre polynomials are multiples of the
C        associated Legendre polynomials of the first kind where the
C        normalizing coefficients are chosen so as to make the integral
C        from -1 to 1 of the square of each function equal to 1. See
C        E. Jahnke, F. Emde and F. Losch, Tables of Higher Functions,
C        McGraw-Hill, New York, 1960, p. 121.
C
C        The input values to DXNRMP are NU, MU1, MU2, DARG, and MODE.
C        These must satisfy
C          1. NU .GE. 0 specifies the degree of the normalized Legendre
C             polynomial that is wanted.
C          2. MU1 .GE. 0 specifies the lowest-order normalized Legendre
C             polynomial that is wanted.
C          3. MU2 .GE. MU1 specifies the highest-order normalized Leg-
C             endre polynomial that is wanted.
C         4a. MODE = 1 and -1.0D0 .LE. DARG .LE. 1.0D0 specifies that
C             Normalized Legendre(NU, MU, DARG) is wanted for MU = MU1,
C             MU1 + 1, ..., MU2.
C         4b. MODE = 2 and -3.14159... .LT. DARG .LT. 3.14159... spec-
C             ifies that Normalized Legendre(NU, MU, COS(DARG)) is
C             wanted for MU = MU1, MU1 + 1, ..., MU2.
C
C        The output of DXNRMP consists of the two vectors DPN and IPN
C        and the error estimate ISIG. The computed values are stored as
C        extended-range numbers such that
C             (DPN(1),IPN(1))=NORMALIZED LEGENDRE(NU,MU1,DX)
C             (DPN(2),IPN(2))=NORMALIZED LEGENDRE(NU,MU1+1,DX)
C                .
C                .
C             (DPN(K),IPN(K))=NORMALIZED LEGENDRE(NU,MU2,DX)
C        where K = MU2 - MU1 + 1 and DX = DARG or COS(DARG) according
C        to whether MODE = 1 or 2. Finally, ISIG is an estimate of the
C        number of decimal digits lost through rounding errors in the
C        computation. For example if DARG is accurate to 12 significant
C        decimals, then the computed function values are accurate to
C        12 - ISIG significant decimals (except in neighborhoods of
C        zeros).
C
C        The interpretation of (DPN(I),IPN(I)) is DPN(I)*(IR**IPN(I))
C        where IR is the internal radix of the computer arithmetic. When
C        IPN(I) = 0 the value of the normalized Legendre polynomial is
C        contained entirely in DPN(I) and subsequent double-precision
C        computations can be performed without further consideration of
C        extended-range arithmetic. However, if IPN(I) .NE. 0 the corre-
C        sponding value of the normalized Legendre polynomial cannot be
C        represented in double-precision because of overflow or under-
C        flow. THE USER MUST TEST IPN(I) IN HIS/HER PROGRAM. In the case
C        that IPN(I) is nonzero, the user could rewrite his/her program
C        to use extended range arithmetic.
C
C
C
C        The interpretation of (DPN(I),IPN(I)) can be changed to
C        DPN(I)*(10**IPN(I)) by calling the extended-range subroutine
C        DXCON. This should be done before printing the computed values.
C        As an example of usage, the Fortran coding
C              J = K
C              DO 20 I = 1, K
C              CALL DXCON(DPN(I), IPN(I),IERROR)
C              IF (IERROR.NE.0) RETURN
C              PRINT 10, DPN(I), IPN(I)
C           10 FORMAT(1X, D30.18 , I15)
C              IF ((IPN(I) .EQ. 0) .OR. (J .LT. K)) GO TO 20
C              J = I - 1
C           20 CONTINUE
C        will print all computed values and determine the largest J
C        such that IPN(1) = IPN(2) = ... = IPN(J) = 0. Because of the
C        change of representation caused by calling DXCON, (DPN(I),
C        IPN(I)) for I = J+1, J+2, ... cannot be used in subsequent
C        extended-range computations.
C
C        IERROR is an error indicator. If no errors are detected,
C        IERROR=0 when control returns to the calling routine. If
C        an error is detected, IERROR is returned as nonzero. The
C        calling routine must check the value of IERROR.
C
C        If IERROR=212 or 213, invalid input was provided to DXNRMP.
C        If IERROR=201,202,203, or 204, invalid input was provided
C        to DXSET.
C        If IERROR=205 or 206, an internal consistency error occurred
C        in DXSET (probably due to a software malfunction in the
C        library routine I1MACH).
C        If IERROR=207, an overflow or underflow of an extended-range
C        number was detected in DXADJ.
C        If IERROR=208, an overflow or underflow of an extended-range
C        number was detected in DXC210.
C
C***SEE ALSO  DXSET
C***REFERENCES  Smith, Olver and Lozier, Extended-Range Arithmetic and
C                 Normalized Legendre Polynomials, ACM Trans on Math
C                 Softw, v 7, n 1, March 1981, pp 93--105.
C***ROUTINES CALLED  DXADD, DXADJ, DXRED, DXSET, XERMSG
C***REVISION HISTORY  (YYMMDD)
C   820712  DATE WRITTEN
C   890126  Revised to meet SLATEC CML recommendations.  (DWL and JMS)
C   901019  Revisions to prologue.  (DWL and WRB)
C   901106  Changed all specific intrinsics to generic.  (WRB)
C           Corrected order of sections in prologue and added TYPE
C           section.  (WRB)
C           CALLs to XERROR changed to CALLs to XERMSG.  (WRB)
C   920127  Revised PURPOSE section of prologue.  (DWL)
C***END PROLOGUE  DXNRMP
      INTEGER NU, MU1, MU2, MODE, IPN, ISIG
      DOUBLE PRECISION DARG, DPN
      DIMENSION DPN(*), IPN(*)
      DOUBLE PRECISION C1,C2,P,P1,P2,P3,S,SX,T,TX,X,DK
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C CALL DXSET TO INITIALIZE EXTENDED-RANGE ARITHMETIC (SEE DXSET
C LISTING FOR DETAILS)
C***FIRST EXECUTABLE STATEMENT  DXNRMP
      IERROR=0
      CALL DXSET (0, 0, 0.0D0, 0,IERROR)
      IF (IERROR.NE.0) RETURN
C
C        TEST FOR PROPER INPUT VALUES.
C
      IF (NU.LT.0) GO TO 110
      IF (MU1.LT.0) GO TO 110
      IF (MU1.GT.MU2) GO TO 110
      IF (NU.EQ.0) GO TO 90
      IF (MODE.LT.1 .OR. MODE.GT.2) GO TO 110
      GO TO (10, 20), MODE
   10 IF (ABS(DARG).GT.1.0D0) GO TO 120
      IF (ABS(DARG).EQ.1.0D0) GO TO 90
      X = DARG
      SX = SQRT((1.0D0+ABS(X))*((0.5D0-ABS(X))+0.5D0))
      TX = X/SX
      ISIG = INT(LOG10(2.0D0*NU*(5.0D0+TX**2)))
      GO TO 30
   20 IF (ABS(DARG).GT.4.0D0*ATAN(1.0D0)) GO TO 120
      IF (DARG.EQ.0.0D0) GO TO 90
      X = COS(DARG)
      SX = ABS(SIN(DARG))
      TX = X/SX
      ISIG = INT(LOG10(2.0D0*NU*(5.0D0+ABS(DARG*TX))))
C
C        BEGIN CALCULATION
C
   30 MU = MU2
      I = MU2 - MU1 + 1
C
C        IF MU.GT.NU, NORMALIZED LEGENDRE(NU,MU,X)=0.
C
   40 IF (MU.LE.NU) GO TO 50
      DPN(I) = 0.0D0
      IPN(I) = 0
      I = I - 1
      MU = MU - 1
      IF (I .GT. 0) GO TO 40
      ISIG = 0
      GO TO 160
   50 MU = NU
C
C        P1 = 0. = NORMALIZED LEGENDRE(NU,NU+1,X)
C
      P1 = 0.0D0
      IP1 = 0
C
C        CALCULATE P2 = NORMALIZED LEGENDRE(NU,NU,X)
C
      P2 = 1.0D0
      IP2 = 0
      P3 = 0.5D0
      DK = 2.0D0
      DO 60 J=1,NU
        P3 = ((DK+1.0D0)/DK)*P3
        P2 = P2*SX
        CALL DXADJ(P2, IP2,IERROR)
        IF (IERROR.NE.0) RETURN
        DK = DK + 2.0D0
   60 CONTINUE
      P2 = P2*SQRT(P3)
      CALL DXADJ(P2, IP2,IERROR)
      IF (IERROR.NE.0) RETURN
      S = 2.0D0*TX
      T = 1.0D0/NU
      IF (MU2.LT.NU) GO TO 70
      DPN(I) = P2
      IPN(I) = IP2
      I = I - 1
      IF (I .EQ. 0) GO TO 140
C
C        RECURRENCE PROCESS
C
   70 P = MU*T
      C1 = 1.0D0/SQRT((1.0D0-P+T)*(1.0D0+P))
      C2 = S*P*C1*P2
      C1 = -SQRT((1.0D0+P+T)*(1.0D0-P))*C1*P1
      CALL DXADD(C2, IP2, C1, IP1, P, IP,IERROR)
      IF (IERROR.NE.0) RETURN
      MU = MU - 1
      IF (MU.GT.MU2) GO TO 80
C
C        STORE IN ARRAY DPN FOR RETURN TO CALLING ROUTINE.
C
      DPN(I) = P
      IPN(I) = IP
      I = I - 1
      IF (I .EQ. 0) GO TO 140
   80 P1 = P2
      IP1 = IP2
      P2 = P
      IP2 = IP
      IF (MU.LE.MU1) GO TO 140
      GO TO 70
C
C        SPECIAL CASE WHEN X=-1 OR +1, OR NU=0.
C
   90 K = MU2 - MU1 + 1
      DO 100 I=1,K
        DPN(I) = 0.0D0
        IPN(I) = 0
  100 CONTINUE
      ISIG = 0
      IF (MU1.GT.0) GO TO 160
      ISIG = 1
      DPN(1) = SQRT(NU+0.5D0)
      IPN(1) = 0
      IF (MOD(NU,2).EQ.0) GO TO 160
      IF (MODE.EQ.1 .AND. DARG.EQ.1.0D0) GO TO 160
      IF (MODE.EQ.2) GO TO 160
      DPN(1) = -DPN(1)
      GO TO 160
C
C          ERROR PRINTOUTS AND TERMINATION.
C
  110 CONTINUE
CCCCC CALL XERMSG ('SLATEC', 'DXNRMP', 'NU, MU1, MU2 or MODE not valid',
CCCCC+             212, 1)
      WRITE(ICOUT,901)
      CALL DPWRST('XXX','BUG ')
  901 FORMAT('***** ERROR FROM DXNRMP, INVALID INOUT ARGUMENTS.')
      IERROR=212
      RETURN
  120 CONTINUE
CCCCC CALL XERMSG ('SLATEC', 'DXNRMP', 'DARG out of range', 213, 1)
      WRITE(ICOUT,902)
      CALL DPWRST('XXX','BUG ')
  902 FORMAT('***** ERROR FROM DXNRMP, FIRST ARGUMENT OUT OF RANGE.')
      IERROR=213
      RETURN
C
C        RETURN TO CALLING PROGRAM
C
  140 K = MU2 - MU1 + 1
      DO 150 I=1,K
        CALL DXRED(DPN(I),IPN(I),IERROR)
        IF (IERROR.NE.0) RETURN
  150 CONTINUE
  160 RETURN
      END
      SUBROUTINE DXPMU (NU1, NU2, MU1, MU2, THETA, X, SX, ID, PQA, IPQA,
     1   IERROR)
C***BEGIN PROLOGUE  DXPMU
C***SUBSIDIARY
C***PURPOSE  To compute the values of Legendre functions for DXLEGF.
C            Method: backward mu-wise recurrence for P(-MU,NU,X) for
C            fixed nu to obtain P(-MU2,NU1,X), P(-(MU2-1),NU1,X), ...,
C            P(-MU1,NU1,X) and store in ascending mu order.
C***LIBRARY   SLATEC
C***CATEGORY  C3A2, C9
C***TYPE      DOUBLE PRECISION (XPMU-S, DXPMU-D)
C***KEYWORDS  LEGENDRE FUNCTIONS
C***AUTHOR  Smith, John M., (NBS and George Mason University)
C***ROUTINES CALLED  DXADD, DXADJ, DXPQNU
C***REVISION HISTORY  (YYMMDD)
C   820728  DATE WRITTEN
C   890126  Revised to meet SLATEC CML recommendations.  (DWL and JMS)
C   901019  Revisions to prologue.  (DWL and WRB)
C   901106  Changed all specific intrinsics to generic.  (WRB)
C           Corrected order of sections in prologue and added TYPE
C           section.  (WRB)
C   920127  Revised PURPOSE section of prologue.  (DWL)
C***END PROLOGUE  DXPMU
      DOUBLE PRECISION PQA,NU1,NU2,P0,X,SX,THETA,X1,X2
      DIMENSION PQA(*),IPQA(*)
C
C        CALL DXPQNU TO OBTAIN P(-MU2,NU,X)
C
C***FIRST EXECUTABLE STATEMENT  DXPMU
      IERROR=0
      CALL DXPQNU(NU1,NU2,MU2,THETA,ID,PQA,IPQA,IERROR)
      IF (IERROR.NE.0) RETURN
      P0=PQA(1)
      IP0=IPQA(1)
      MU=MU2-1
C
C        CALL DXPQNU TO OBTAIN P(-MU2-1,NU,X)
C
      CALL DXPQNU(NU1,NU2,MU,THETA,ID,PQA,IPQA,IERROR)
      IF (IERROR.NE.0) RETURN
      N=MU2-MU1+1
      PQA(N)=P0
      IPQA(N)=IP0
      IF(N.EQ.1) GO TO 300
      PQA(N-1)=PQA(1)
      IPQA(N-1)=IPQA(1)
      IF(N.EQ.2) GO TO 300
      J=N-2
  290 CONTINUE
C
C        BACKWARD RECURRENCE IN MU TO OBTAIN
C              P(-MU2,NU1,X),P(-(MU2-1),NU1,X),....P(-MU1,NU1,X)
C              USING
C              (NU-MU)*(NU+MU+1.)*P(-(MU+1),NU,X)=
C                2.*MU*X*SQRT((1./(1.-X**2))*P(-MU,NU,X)-P(-(MU-1),NU,X)
C
      X1=2.D0*MU*X*SX*PQA(J+1)
      X2=-(NU1-MU)*(NU1+MU+1.D0)*PQA(J+2)
      CALL DXADD(X1,IPQA(J+1),X2,IPQA(J+2),PQA(J),IPQA(J),IERROR)
      IF (IERROR.NE.0) RETURN
      CALL DXADJ(PQA(J),IPQA(J),IERROR)
      IF (IERROR.NE.0) RETURN
      IF(J.EQ.1) GO TO 300
      J=J-1
      MU=MU-1
      GO TO 290
  300 RETURN
      END
      SUBROUTINE DXPMUP (NU1, NU2, MU1, MU2, PQA, IPQA, IERROR)
C***BEGIN PROLOGUE  DXPMUP
C***SUBSIDIARY
C***PURPOSE  To compute the values of Legendre functions for DXLEGF.
C            This subroutine transforms an array of Legendre functions
C            of the first kind of negative order stored in array PQA
C            into Legendre functions of the first kind of positive
C            order stored in array PQA. The original array is destroyed.
C***LIBRARY   SLATEC
C***CATEGORY  C3A2, C9
C***TYPE      DOUBLE PRECISION (XPMUP-S, DXPMUP-D)
C***KEYWORDS  LEGENDRE FUNCTIONS
C***AUTHOR  Smith, John M., (NBS and George Mason University)
C***ROUTINES CALLED  DXADJ
C***REVISION HISTORY  (YYMMDD)
C   820728  DATE WRITTEN
C   890126  Revised to meet SLATEC CML recommendations.  (DWL and JMS)
C   901019  Revisions to prologue.  (DWL and WRB)
C   901106  Changed all specific intrinsics to generic.  (WRB)
C           Corrected order of sections in prologue and added TYPE
C           section.  (WRB)
C   920127  Revised PURPOSE section of prologue.  (DWL)
C***END PROLOGUE  DXPMUP
      DOUBLE PRECISION DMU,NU,NU1,NU2,PQA,PROD
      DIMENSION PQA(*),IPQA(*)
C***FIRST EXECUTABLE STATEMENT  DXPMUP
      IERROR=0
      NU=NU1
      MU=MU1
      DMU=MU
      N=INT(NU2-NU1+.1D0)+(MU2-MU1)+1
      J=1
      IF(MOD(REAL(NU),1.).NE.0.) GO TO 210
  200 IF(DMU.LT.NU+1.D0) GO TO 210
      PQA(J)=0.D0
      IPQA(J)=0
      J=J+1
      IF(J.GT.N) RETURN
C        INCREMENT EITHER MU OR NU AS APPROPRIATE.
      IF(NU2-NU1.GT..5D0) NU=NU+1.D0
      IF(MU2.GT.MU1) MU=MU+1
      GO TO 200
C
C        TRANSFORM P(-MU,NU,X) TO P(MU,NU,X) USING
C        P(MU,NU,X)=(NU-MU+1)*(NU-MU+2)*...*(NU+MU)*P(-MU,NU,X)*(-1)**MU
C
  210 PROD=1.D0
      IPROD=0
      K=2*MU
      IF(K.EQ.0) GO TO 222
      DO 220 L=1,K
        PROD=PROD*(DMU-NU-L)
        CALL DXADJ(PROD,IPROD,IERROR)
  220 CONTINUE
      IF (IERROR.NE.0) RETURN
  222 CONTINUE
      DO 240 I=J,N
      IF(MU.EQ.0) GO TO 225
      PQA(I)=PQA(I)*PROD*(-1)**MU
      IPQA(I)=IPQA(I)+IPROD
      CALL DXADJ(PQA(I),IPQA(I),IERROR)
      IF (IERROR.NE.0) RETURN
  225 IF(NU2-NU1.GT..5D0) GO TO 230
      PROD=(DMU-NU)*PROD*(-DMU-NU-1.D0)
      CALL DXADJ(PROD,IPROD,IERROR)
      IF (IERROR.NE.0) RETURN
      MU=MU+1
      DMU=DMU+1.D0
      GO TO 240
  230 PROD=PROD*(-DMU-NU-1.D0)/(DMU-NU-1.D0)
      CALL DXADJ(PROD,IPROD,IERROR)
      IF (IERROR.NE.0) RETURN
      NU=NU+1.D0
  240 CONTINUE
      RETURN
      END
      SUBROUTINE DXPNRM (NU1, NU2, MU1, MU2, PQA, IPQA, IERROR)
C***BEGIN PROLOGUE  DXPNRM
C***SUBSIDIARY
C***PURPOSE  To compute the values of Legendre functions for DXLEGF.
C            This subroutine transforms an array of Legendre functions
C            of the first kind of negative order stored in array PQA
C            into normalized Legendre polynomials stored in array PQA.
C            The original array is destroyed.
C***LIBRARY   SLATEC
C***CATEGORY  C3A2, C9
C***TYPE      DOUBLE PRECISION (XPNRM-S, DXPNRM-D)
C***KEYWORDS  LEGENDRE FUNCTIONS
C***AUTHOR  Smith, John M., (NBS and George Mason University)
C***ROUTINES CALLED  DXADJ
C***REVISION HISTORY  (YYMMDD)
C   820728  DATE WRITTEN
C   890126  Revised to meet SLATEC CML recommendations.  (DWL and JMS)
C   901019  Revisions to prologue.  (DWL and WRB)
C   901106  Changed all specific intrinsics to generic.  (WRB)
C           Corrected order of sections in prologue and added TYPE
C           section.  (WRB)
C   920127  Revised PURPOSE section of prologue.  (DWL)
C***END PROLOGUE  DXPNRM
      DOUBLE PRECISION C1,DMU,NU,NU1,NU2,PQA,PROD
      DIMENSION PQA(*),IPQA(*)
C***FIRST EXECUTABLE STATEMENT  DXPNRM
      IERROR=0
      L=INT((MU2-MU1)+(NU2-NU1+1.5D0))
      MU=MU1
      DMU=MU1
      NU=NU1
C
C         IF MU .GT.NU, NORM P =0.
C
      J=1
  500 CONTINUE
      IF(DMU.LE.NU) GO TO 505
      PQA(J)=0.D0
      IPQA(J)=0
      J=J+1
      IF(J.GT.L) RETURN
C
C        INCREMENT EITHER MU OR NU AS APPROPRIATE.
C
      IF(MU2.GT.MU1) DMU=DMU+1.D0
      IF(NU2-NU1.GT..5D0) NU=NU+1.D0
      GO TO 500
C
C         TRANSFORM P(-MU,NU,X) INTO NORMALIZED P(MU,NU,X) USING
C              NORM P(MU,NU,X)=
C                 SQRT((NU+.5)*FACTORIAL(NU+MU)/FACTORIAL(NU-MU))
C                              *P(-MU,NU,X)
C
  505 CONTINUE
      PROD=1.D0
      IPROD=0
      K=2*MU
      IF(K.LE.0) GO TO 520
      DO 510 I=1,K
        PROD=PROD*SQRT(NU+DMU+1.D0-I)
        CALL DXADJ(PROD,IPROD,IERROR)
  510 CONTINUE
      IF (IERROR.NE.0) RETURN
  520 CONTINUE
      DO 540 I=J,L
      C1=PROD*SQRT(NU+.5D0)
      PQA(I)=PQA(I)*C1
      IPQA(I)=IPQA(I)+IPROD
      CALL DXADJ(PQA(I),IPQA(I),IERROR)
      IF (IERROR.NE.0) RETURN
      IF(NU2-NU1.GT..5D0) GO TO 530
      IF(DMU.GE.NU) GO TO 525
      PROD=SQRT(NU+DMU+1.D0)*PROD
      IF(NU.GT.DMU) PROD=PROD*SQRT(NU-DMU)
      CALL DXADJ(PROD,IPROD,IERROR)
      IF (IERROR.NE.0) RETURN
      MU=MU+1
      DMU=DMU+1.D0
      GO TO 540
  525 PROD=0.D0
      IPROD=0
      MU=MU+1
      DMU=DMU+1.D0
      GO TO 540
  530 PROD=SQRT(NU+DMU+1.D0)*PROD
      IF(NU.NE.DMU-1.D0) PROD=PROD/SQRT(NU-DMU+1.D0)
      CALL DXADJ(PROD,IPROD,IERROR)
      IF (IERROR.NE.0) RETURN
      NU=NU+1.D0
  540 CONTINUE
      RETURN
      END
      SUBROUTINE DXPQNU (NU1, NU2, MU, THETA, ID, PQA, IPQA, IERROR)
C***BEGIN PROLOGUE  DXPQNU
C***SUBSIDIARY
C***PURPOSE  To compute the values of Legendre functions for DXLEGF.
C            This subroutine calculates initial values of P or Q using
C            power series, then performs forward nu-wise recurrence to
C            obtain P(-MU,NU,X), Q(0,NU,X), or Q(1,NU,X). The nu-wise
C            recurrence is stable for P for all mu and for Q for mu=0,1.
C***LIBRARY   SLATEC
C***CATEGORY  C3A2, C9
C***TYPE      DOUBLE PRECISION (XPQNU-S, DXPQNU-D)
C***KEYWORDS  LEGENDRE FUNCTIONS
C***AUTHOR  Smith, John M., (NBS and George Mason University)
C***ROUTINES CALLED  DXADD, DXADJ, DXPSI
C***COMMON BLOCKS    DXBLK1
C***REVISION HISTORY  (YYMMDD)
C   820728  DATE WRITTEN
C   890126  Revised to meet SLATEC CML recommendations.  (DWL and JMS)
C   901019  Revisions to prologue.  (DWL and WRB)
C   901106  Changed all specific intrinsics to generic.  (WRB)
C           Corrected order of sections in prologue and added TYPE
C           section.  (WRB)
C   920127  Revised PURPOSE section of prologue.  (DWL)
C***END PROLOGUE  DXPQNU
      DOUBLE PRECISION A,NU,NU1,NU2,PQ,PQA,DXPSI,R,THETA,W,X,X1,X2,XS,
     1 Y,Z
      DOUBLE PRECISION DI,DMU,PQ1,PQ2,FACTMU,FLOK
      DIMENSION PQA(*),IPQA(*)
      COMMON /DXBLK1/ NBITSF
      SAVE /DXBLK1/
C
C        J0, IPSIK, AND IPSIX ARE INITIALIZED IN THIS SUBROUTINE.
C        J0 IS THE NUMBER OF TERMS USED IN SERIES EXPANSION
C        IN SUBROUTINE DXPQNU.
C        IPSIK, IPSIX ARE VALUES OF K AND X RESPECTIVELY
C        USED IN THE CALCULATION OF THE DXPSI FUNCTION.
C
C***FIRST EXECUTABLE STATEMENT  DXPQNU
      IERROR=0
      J0=NBITSF
      IPSIK=1+(NBITSF/10)
      IPSIX=5*IPSIK
      IPQ=0
C        FIND NU IN INTERVAL [-.5,.5) IF ID=2  ( CALCULATION OF Q )
      NU=MOD(NU1,1.D0)
      IF(NU.GE..5D0) NU=NU-1.D0
C        FIND NU IN INTERVAL (-1.5,-.5] IF ID=1,3, OR 4  ( CALC. OF P )
      IF(ID.NE.2.AND.NU.GT.-.5D0) NU=NU-1.D0
C        CALCULATE MU FACTORIAL
      K=MU
      DMU=MU
      IF(MU.LE.0) GO TO 60
      FACTMU=1.D0
      IF=0
      DO 50 I=1,K
        FACTMU=FACTMU*I
        CALL DXADJ(FACTMU,IF,IERROR)
   50 CONTINUE
      IF (IERROR.NE.0) RETURN
   60 IF(K.EQ.0) FACTMU=1.D0
      IF(K.EQ.0) IF=0
C
C        X=COS(THETA)
C        Y=SIN(THETA/2)**2=(1-X)/2=.5-.5*X
C        R=TAN(THETA/2)=SQRT((1-X)/(1+X)
C
      X=COS(THETA)
      Y=SIN(THETA/2.D0)**2
      R=TAN(THETA/2.D0)
C
C        USE ASCENDING SERIES TO CALCULATE TWO VALUES OF P OR Q
C        FOR USE AS STARTING VALUES IN RECURRENCE RELATION.
C
      PQ2=0.0D0
      DO 100 J=1,2
      IPQ1=0
      IF(ID.EQ.2) GO TO 80
C
C        SERIES FOR P ( ID = 1, 3, OR 4 )
C        P(-MU,NU,X)=1./FACTORIAL(MU)*SQRT(((1.-X)/(1.+X))**MU)
C                *SUM(FROM 0 TO J0-1)A(J)*(.5-.5*X)**J
C
      IPQ=0
      PQ=1.D0
      A=1.D0
      IA=0
      DO 65 I=2,J0
      DI=I
      A=A*Y*(DI-2.D0-NU)*(DI-1.D0+NU)/((DI-1.D0+DMU)*(DI-1.D0))
      CALL DXADJ(A,IA,IERROR)
      IF (IERROR.NE.0) RETURN
      IF(A.EQ.0.D0) GO TO 66
      CALL DXADD(PQ,IPQ,A,IA,PQ,IPQ,IERROR)
      IF (IERROR.NE.0) RETURN
   65 CONTINUE
   66 CONTINUE
      IF(MU.LE.0) GO TO 90
      X2=R
      X1=PQ
      K=MU
      DO 77 I=1,K
        X1=X1*X2
        CALL DXADJ(X1,IPQ,IERROR)
   77 CONTINUE
      IF (IERROR.NE.0) RETURN
      PQ=X1/FACTMU
      IPQ=IPQ-IF
      CALL DXADJ(PQ,IPQ,IERROR)
      IF (IERROR.NE.0) RETURN
      GO TO 90
C
C        Z=-LN(R)=.5*LN((1+X)/(1-X))
C
   80 Z=-LOG(R)
      W=DXPSI(NU+1.D0,IPSIK,IPSIX)
      XS=1.D0/SIN(THETA)
C
C        SERIES SUMMATION FOR Q ( ID = 2 )
C        Q(0,NU,X)=SUM(FROM 0 TO J0-1)((.5*LN((1+X)/(1-X))
C    +DXPSI(J+1,IPSIK,IPSIX)-DXPSI(NU+1,IPSIK,IPSIX)))*A(J)*(.5-.5*X)**J
C
C        Q(1,NU,X)=-SQRT(1./(1.-X**2))+SQRT((1-X)/(1+X))
C             *SUM(FROM 0 T0 J0-1)(-NU*(NU+1)/2*LN((1+X)/(1-X))
C                 +(J-NU)*(J+NU+1)/(2*(J+1))+NU*(NU+1)*
C     (DXPSI(NU+1,IPSIK,IPSIX)-DXPSI(J+1,IPSIK,IPSIX))*A(J)*(.5-.5*X)**J
C
C        NOTE, IN THIS LOOP K=J+1
C
      PQ=0.D0
      IPQ=0
      IA=0
      A=1.D0
      DO 85 K=1,J0
      FLOK=K
      IF(K.EQ.1) GO TO 81
      A=A*Y*(FLOK-2.D0-NU)*(FLOK-1.D0+NU)/((FLOK-1.D0+DMU)*(FLOK-1.D0))
      CALL DXADJ(A,IA,IERROR)
      IF (IERROR.NE.0) RETURN
   81 CONTINUE
      IF(MU.GE.1) GO TO 83
      X1=(DXPSI(FLOK,IPSIK,IPSIX)-W+Z)*A
      IX1=IA
      CALL DXADD(PQ,IPQ,X1,IX1,PQ,IPQ,IERROR)
      IF (IERROR.NE.0) RETURN
      GO TO 85
   83 X1=(NU*(NU+1.D0)*(Z-W+DXPSI(FLOK,IPSIK,IPSIX))+(NU-FLOK+1.D0)
     1  *(NU+FLOK)/(2.D0*FLOK))*A
      IX1=IA
      CALL DXADD(PQ,IPQ,X1,IX1,PQ,IPQ,IERROR)
      IF (IERROR.NE.0) RETURN
   85 CONTINUE
      IF(MU.GE.1) PQ=-R*PQ
      IXS=0
      IF(MU.GE.1) CALL DXADD(PQ,IPQ,-XS,IXS,PQ,IPQ,IERROR)
      IF (IERROR.NE.0) RETURN
      IF(J.EQ.2) MU=-MU
      IF(J.EQ.2) DMU=-DMU
   90 IF(J.EQ.1) PQ2=PQ
      IF(J.EQ.1) IPQ2=IPQ
      NU=NU+1.D0
  100 CONTINUE
      K=0
      IF(NU-1.5D0.LT.NU1) GO TO 120
      K=K+1
      PQA(K)=PQ2
      IPQA(K)=IPQ2
      IF(NU.GT.NU2+.5D0) RETURN
  120 PQ1=PQ
      IPQ1=IPQ
      IF(NU.LT.NU1+.5D0) GO TO 130
      K=K+1
      PQA(K)=PQ
      IPQA(K)=IPQ
      IF(NU.GT.NU2+.5D0) RETURN
C
C        FORWARD NU-WISE RECURRENCE FOR F(MU,NU,X) FOR FIXED MU
C        USING
C        (NU+MU+1)*F(MU,NU,X)=(2.*NU+1)*F(MU,NU,X)-(NU-MU)*F(MU,NU-1,X)
C        WHERE F(MU,NU,X) MAY BE P(-MU,NU,X) OR IF MU IS REPLACED
C        BY -MU THEN F(MU,NU,X) MAY BE Q(MU,NU,X).
C        NOTE, IN THIS LOOP, NU=NU+1
C
  130 X1=(2.D0*NU-1.D0)/(NU+DMU)*X*PQ1
      X2=(NU-1.D0-DMU)/(NU+DMU)*PQ2
      CALL DXADD(X1,IPQ1,-X2,IPQ2,PQ,IPQ,IERROR)
      IF (IERROR.NE.0) RETURN
      CALL DXADJ(PQ,IPQ,IERROR)
      IF (IERROR.NE.0) RETURN
      NU=NU+1.D0
      PQ2=PQ1
      IPQ2=IPQ1
      GO TO 120
C
      END
      DOUBLE PRECISION FUNCTION DXPSI (A, IPSIK, IPSIX)
C***BEGIN PROLOGUE  DXPSI
C***SUBSIDIARY
C***PURPOSE  To compute values of the Psi function for DXLEGF.
C***LIBRARY   SLATEC
C***CATEGORY  C7C
C***TYPE      DOUBLE PRECISION (XPSI-S, DXPSI-D)
C***KEYWORDS  PSI FUNCTION
C***AUTHOR  Smith, John M., (NBS and George Mason University)
C***ROUTINES CALLED  (NONE)
C***REVISION HISTORY  (YYMMDD)
C   820728  DATE WRITTEN
C   890126  Revised to meet SLATEC CML recommendations.  (DWL and JMS)
C   901019  Revisions to prologue.  (DWL and WRB)
C   901106  Changed all specific intrinsics to generic.  (WRB)
C           Corrected order of sections in prologue and added TYPE
C           section.  (WRB)
C   920127  Revised PURPOSE section of prologue.  (DWL)
C***END PROLOGUE  DXPSI
      DOUBLE PRECISION A,B,C,CNUM,CDENOM
      DIMENSION CNUM(12),CDENOM(12)
      SAVE CNUM, CDENOM
C
C        CNUM(I) AND CDENOM(I) ARE THE ( REDUCED ) NUMERATOR
C        AND 2*I*DENOMINATOR RESPECTIVELY OF THE 2*I TH BERNOULLI
C        NUMBER.
C
      DATA CNUM(1),CNUM(2),CNUM(3),CNUM(4),CNUM(5),CNUM(6),CNUM(7),
     1CNUM(8),CNUM(9),CNUM(10),CNUM(11),CNUM(12)
     2    / 1.D0,     -1.D0,    1.D0,     -1.D0, 1.D0,
     3   -691.D0,  1.D0,     -3617.D0, 43867.D0, -174611.D0, 77683.D0,
     4   -236364091.D0/
      DATA CDENOM(1),CDENOM(2),CDENOM(3),CDENOM(4),CDENOM(5),CDENOM(6),
     1 CDENOM(7),CDENOM(8),CDENOM(9),CDENOM(10),CDENOM(11),CDENOM(12)
     2/12.D0,120.D0,   252.D0,   240.D0,132.D0,
     3  32760.D0, 12.D0,  8160.D0, 14364.D0, 6600.D0, 276.D0, 65520.D0/
C***FIRST EXECUTABLE STATEMENT  DXPSI
      N=MAX(0,IPSIX-INT(A))
      B=N+A
      K1=IPSIK-1
C
C        SERIES EXPANSION FOR A .GT. IPSIX USING IPSIK-1 TERMS.
C
      C=0.D0
      DO 12 I=1,K1
        K=IPSIK-I
        C=(C+CNUM(K)/CDENOM(K))/B**2
   12 CONTINUE
      DXPSI=LOG(B)-(C+.5D0/B)
      IF(N.EQ.0) GO TO 20
      B=0.D0
C
C        RECURRENCE FOR A .LE. IPSIX.
C
      DO 15 M=1,N
        B=B+1.D0/(N-M+A)
   15 CONTINUE
      DXPSI=DXPSI-B
   20 RETURN
      END
      SUBROUTINE DXQMU (NU1, NU2, MU1, MU2, THETA, X, SX, ID, PQA, IPQA,
     1   IERROR)
C***BEGIN PROLOGUE  DXQMU
C***SUBSIDIARY
C***PURPOSE  To compute the values of Legendre functions for DXLEGF.
C            Method: forward mu-wise recurrence for Q(MU,NU,X) for fixed
C            nu to obtain Q(MU1,NU,X), Q(MU1+1,NU,X), ..., Q(MU2,NU,X).
C***LIBRARY   SLATEC
C***CATEGORY  C3A2, C9
C***TYPE      DOUBLE PRECISION (XQMU-S, DXQMU-D)
C***KEYWORDS  LEGENDRE FUNCTIONS
C***AUTHOR  Smith, John M., (NBS and George Mason University)
C***ROUTINES CALLED  DXADD, DXADJ, DXPQNU
C***REVISION HISTORY  (YYMMDD)
C   820728  DATE WRITTEN
C   890126  Revised to meet SLATEC CML recommendations.  (DWL and JMS)
C   901019  Revisions to prologue.  (DWL and WRB)
C   901106  Corrected order of sections in prologue and added TYPE
C           section.  (WRB)
C   920127  Revised PURPOSE section of prologue.  (DWL)
C***END PROLOGUE  DXQMU
      DIMENSION PQA(*),IPQA(*)
      DOUBLE PRECISION DMU,NU,NU1,NU2,PQ,PQA,PQ1,PQ2,SX,X,X1,X2
      DOUBLE PRECISION THETA
C***FIRST EXECUTABLE STATEMENT  DXQMU
      IERROR=0
      MU=0
C
C        CALL DXPQNU TO OBTAIN Q(0.,NU1,X)
C
      CALL DXPQNU(NU1,NU2,MU,THETA,ID,PQA,IPQA,IERROR)
      IF (IERROR.NE.0) RETURN
      PQ2=PQA(1)
      IPQ2=IPQA(1)
      MU=1
C
C        CALL DXPQNU TO OBTAIN Q(1.,NU1,X)
C
      CALL DXPQNU(NU1,NU2,MU,THETA,ID,PQA,IPQA,IERROR)
      IF (IERROR.NE.0) RETURN
      NU=NU1
      K=0
      MU=1
      DMU=1.D0
      PQ1=PQA(1)
      IPQ1=IPQA(1)
      IF(MU1.GT.0) GO TO 310
      K=K+1
      PQA(K)=PQ2
      IPQA(K)=IPQ2
      IF(MU2.LT.1) GO TO 330
  310 IF(MU1.GT.1) GO TO 320
      K=K+1
      PQA(K)=PQ1
      IPQA(K)=IPQ1
      IF(MU2.LE.1) GO TO 330
  320 CONTINUE
C
C        FORWARD RECURRENCE IN MU TO OBTAIN
C                  Q(MU1,NU,X),Q(MU1+1,NU,X),....,Q(MU2,NU,X) USING
C             Q(MU+1,NU,X)=-2.*MU*X*SQRT(1./(1.-X**2))*Q(MU,NU,X)
C                               -(NU+MU)*(NU-MU+1.)*Q(MU-1,NU,X)
C
      X1=-2.D0*DMU*X*SX*PQ1
      X2=(NU+DMU)*(NU-DMU+1.D0)*PQ2
      CALL DXADD(X1,IPQ1,-X2,IPQ2,PQ,IPQ,IERROR)
      IF (IERROR.NE.0) RETURN
      CALL DXADJ(PQ,IPQ,IERROR)
      IF (IERROR.NE.0) RETURN
      PQ2=PQ1
      IPQ2=IPQ1
      PQ1=PQ
      IPQ1=IPQ
      MU=MU+1
      DMU=DMU+1.D0
      IF(MU.LT.MU1) GO TO 320
      K=K+1
      PQA(K)=PQ
      IPQA(K)=IPQ
      IF(MU2.GT.MU) GO TO 320
  330 RETURN
      END
      SUBROUTINE DXQNU (NU1, NU2, MU1, THETA, X, SX, ID, PQA, IPQA,
     1   IERROR)
C***BEGIN PROLOGUE  DXQNU
C***SUBSIDIARY
C***PURPOSE  To compute the values of Legendre functions for DXLEGF.
C            Method: backward nu-wise recurrence for Q(MU,NU,X) for
C            fixed mu to obtain Q(MU1,NU1,X), Q(MU1,NU1+1,X), ...,
C            Q(MU1,NU2,X).
C***LIBRARY   SLATEC
C***CATEGORY  C3A2, C9
C***TYPE      DOUBLE PRECISION (XQNU-S, DXQNU-D)
C***KEYWORDS  LEGENDRE FUNCTIONS
C***AUTHOR  Smith, John M., (NBS and George Mason University)
C***ROUTINES CALLED  DXADD, DXADJ, DXPQNU
C***REVISION HISTORY  (YYMMDD)
C   820728  DATE WRITTEN
C   890126  Revised to meet SLATEC CML recommendations.  (DWL and JMS)
C   901019  Revisions to prologue.  (DWL and WRB)
C   901106  Corrected order of sections in prologue and added TYPE
C           section.  (WRB)
C   920127  Revised PURPOSE section of prologue.  (DWL)
C***END PROLOGUE  DXQNU
      DIMENSION PQA(*),IPQA(*)
      DOUBLE PRECISION DMU,NU,NU1,NU2,PQ,PQA,PQ1,PQ2,SX,X,X1,X2
      DOUBLE PRECISION THETA,PQL1,PQL2
C***FIRST EXECUTABLE STATEMENT  DXQNU
      IERROR=0
      K=0
      PQ2=0.0D0
      IPQ2=0
      PQL2=0.0D0
      IPQL2=0
      IF(MU1.EQ.1) GO TO 290
      MU=0
C
C        CALL DXPQNU TO OBTAIN Q(0.,NU2,X) AND Q(0.,NU2-1,X)
C
      CALL DXPQNU(NU1,NU2,MU,THETA,ID,PQA,IPQA,IERROR)
      IF (IERROR.NE.0) RETURN
      IF(MU1.EQ.0) RETURN
      K=INT((NU2-NU1+1.5D0))
      PQ2=PQA(K)
      IPQ2=IPQA(K)
      PQL2=PQA(K-1)
      IPQL2=IPQA(K-1)
  290 MU=1
C
C        CALL DXPQNU TO OBTAIN Q(1.,NU2,X) AND Q(1.,NU2-1,X)
C
      CALL DXPQNU(NU1,NU2,MU,THETA,ID,PQA,IPQA,IERROR)
      IF (IERROR.NE.0) RETURN
      IF(MU1.EQ.1) RETURN
      NU=NU2
      PQ1=PQA(K)
      IPQ1=IPQA(K)
      PQL1=PQA(K-1)
      IPQL1=IPQA(K-1)
  300 MU=1
      DMU=1.D0
  320 CONTINUE
C
C        FORWARD RECURRENCE IN MU TO OBTAIN Q(MU1,NU2,X) AND
C              Q(MU1,NU2-1,X) USING
C              Q(MU+1,NU,X)=-2.*MU*X*SQRT(1./(1.-X**2))*Q(MU,NU,X)
C                   -(NU+MU)*(NU-MU+1.)*Q(MU-1,NU,X)
C
C              FIRST FOR NU=NU2
C
      X1=-2.D0*DMU*X*SX*PQ1
      X2=(NU+DMU)*(NU-DMU+1.D0)*PQ2
      CALL DXADD(X1,IPQ1,-X2,IPQ2,PQ,IPQ,IERROR)
      IF (IERROR.NE.0) RETURN
      CALL DXADJ(PQ,IPQ,IERROR)
      IF (IERROR.NE.0) RETURN
      PQ2=PQ1
      IPQ2=IPQ1
      PQ1=PQ
      IPQ1=IPQ
      MU=MU+1
      DMU=DMU+1.D0
      IF(MU.LT.MU1) GO TO 320
      PQA(K)=PQ
      IPQA(K)=IPQ
      IF(K.EQ.1) RETURN
      IF(NU.LT.NU2) GO TO 340
C
C              THEN FOR NU=NU2-1
C
      NU=NU-1.D0
      PQ2=PQL2
      IPQ2=IPQL2
      PQ1=PQL1
      IPQ1=IPQL1
      K=K-1
      GO TO 300
C
C         BACKWARD RECURRENCE IN NU TO OBTAIN
C              Q(MU1,NU1,X),Q(MU1,NU1+1,X),....,Q(MU1,NU2,X)
C              USING
C              (NU-MU+1.)*Q(MU,NU+1,X)=
C                       (2.*NU+1.)*X*Q(MU,NU,X)-(NU+MU)*Q(MU,NU-1,X)
C
  340 PQ1=PQA(K)
      IPQ1=IPQA(K)
      PQ2=PQA(K+1)
      IPQ2=IPQA(K+1)
  350 IF(NU.LE.NU1) RETURN
      K=K-1
      X1=(2.D0*NU+1.D0)*X*PQ1/(NU+DMU)
      X2=-(NU-DMU+1.D0)*PQ2/(NU+DMU)
      CALL DXADD(X1,IPQ1,X2,IPQ2,PQ,IPQ,IERROR)
      IF (IERROR.NE.0) RETURN
      CALL DXADJ(PQ,IPQ,IERROR)
      IF (IERROR.NE.0) RETURN
      PQ2=PQ1
      IPQ2=IPQ1
      PQ1=PQ
      IPQ1=IPQ
      PQA(K)=PQ
      IPQA(K)=IPQ
      NU=NU-1.D0
      GO TO 350
      END
      SUBROUTINE DXRED (X, IX, IERROR)
C***BEGIN PROLOGUE  DXRED
C***PURPOSE  To provide double-precision floating-point arithmetic
C            with an extended exponent range.
C***LIBRARY   SLATEC
C***CATEGORY  A3D
C***TYPE      DOUBLE PRECISION (XRED-S, DXRED-D)
C***KEYWORDS  EXTENDED-RANGE DOUBLE-PRECISION ARITHMETIC
C***AUTHOR  Lozier, Daniel W., (NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY)
C           Smith, John M., (NBS and George Mason University)
C***DESCRIPTION
C     DOUBLE PRECISION X
C     INTEGER IX
C
C                  IF
C                  RADIX**(-2L) .LE. (ABS(X),IX) .LE. RADIX**(2L)
C                  THEN DXRED TRANSFORMS (X,IX) SO THAT IX=0.
C                  IF (X,IX) IS OUTSIDE THE ABOVE RANGE,
C                  THEN DXRED TAKES NO ACTION.
C                  THIS SUBROUTINE IS USEFUL IF THE
C                  RESULTS OF EXTENDED-RANGE CALCULATIONS
C                  ARE TO BE USED IN SUBSEQUENT ORDINARY
C                  DOUBLE-PRECISION CALCULATIONS.
C
C***SEE ALSO  DXSET
C***REFERENCES  (NONE)
C***ROUTINES CALLED  (NONE)
C***COMMON BLOCKS    DXBLK2
C***REVISION HISTORY  (YYMMDD)
C   820712  DATE WRITTEN
C   881020  Revised to meet SLATEC CML recommendations.  (DWL and JMS)
C   901019  Revisions to prologue.  (DWL and WRB)
C   901106  Changed all specific intrinsics to generic.  (WRB)
C           Corrected order of sections in prologue and added TYPE
C           section.  (WRB)
C   920127  Revised PURPOSE section of prologue.  (DWL)
C***END PROLOGUE  DXRED
      DOUBLE PRECISION X
      INTEGER IX
      DOUBLE PRECISION RADIX, RADIXL, RAD2L, DLG10R, XA
      INTEGER L, L2, KMAX
      COMMON /DXBLK2/ RADIX, RADIXL, RAD2L, DLG10R, L, L2, KMAX
      SAVE /DXBLK2/
C
C***FIRST EXECUTABLE STATEMENT  DXRED
      IERROR=0
      IF (X.EQ.0.0D0) GO TO 90
      XA = ABS(X)
      IF (IX.EQ.0) GO TO 70
      IXA = ABS(IX)
      IXA1 = IXA/L2
      IXA2 = MOD(IXA,L2)
      IF (IX.GT.0) GO TO 40
   10 CONTINUE
      IF (XA.GT.1.0D0) GO TO 20
      XA = XA*RAD2L
      IXA1 = IXA1 + 1
      GO TO 10
   20 XA = XA/RADIX**IXA2
      IF (IXA1.EQ.0) GO TO 70
      DO 30 I=1,IXA1
        IF (XA.LT.1.0D0) GO TO 100
        XA = XA/RAD2L
   30 CONTINUE
      GO TO 70
C
   40 CONTINUE
      IF (XA.LT.1.0D0) GO TO 50
      XA = XA/RAD2L
      IXA1 = IXA1 + 1
      GO TO 40
   50 XA = XA*RADIX**IXA2
      IF (IXA1.EQ.0) GO TO 70
      DO 60 I=1,IXA1
        IF (XA.GT.1.0D0) GO TO 100
        XA = XA*RAD2L
   60 CONTINUE
   70 IF (XA.GT.RAD2L) GO TO 100
      IF (XA.GT.1.0D0) GO TO 80
      IF (RAD2L*XA.LT.1.0D0) GO TO 100
   80 X = SIGN(XA,X)
   90 IX = 0
  100 RETURN
      END
      SUBROUTINE DXSET (IRAD, NRADPL, DZERO, NBITS, IERROR)
C***BEGIN PROLOGUE  DXSET
C***PURPOSE  To provide double-precision floating-point arithmetic
C            with an extended exponent range.
C***LIBRARY   SLATEC
C***CATEGORY  A3D
C***TYPE      DOUBLE PRECISION (XSET-S, DXSET-D)
C***KEYWORDS  EXTENDED-RANGE DOUBLE-PRECISION ARITHMETIC
C***AUTHOR  Lozier, Daniel W., (NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY)
C           Smith, John M., (NBS and George Mason University)
C***DESCRIPTION
C
C   SUBROUTINE  DXSET  MUST BE CALLED PRIOR TO CALLING ANY OTHER
C EXTENDED-RANGE SUBROUTINE. IT CALCULATES AND STORES SEVERAL
C MACHINE-DEPENDENT CONSTANTS IN COMMON BLOCKS. THE USER MUST
C SUPPLY FOUR CONSTANTS THAT PERTAIN TO HIS PARTICULAR COMPUTER.
C THE CONSTANTS ARE
C
C          IRAD = THE INTERNAL BASE OF DOUBLE-PRECISION
C                 ARITHMETIC IN THE COMPUTER.
C        NRADPL = THE NUMBER OF RADIX PLACES CARRIED IN
C                 THE DOUBLE-PRECISION REPRESENTATION.
C         DZERO = THE SMALLEST OF 1/DMIN, DMAX, DMAXLN WHERE
C                 DMIN = THE SMALLEST POSITIVE DOUBLE-PRECISION
C                 NUMBER OR AN UPPER BOUND TO THIS NUMBER,
C                 DMAX = THE LARGEST DOUBLE-PRECISION NUMBER
C                 OR A LOWER BOUND TO THIS NUMBER,
C                 DMAXLN = THE LARGEST DOUBLE-PRECISION NUMBER
C                 SUCH THAT LOG10(DMAXLN) CAN BE COMPUTED BY THE
C                 FORTRAN SYSTEM (ON MOST SYSTEMS DMAXLN = DMAX).
C         NBITS = THE NUMBER OF BITS (EXCLUSIVE OF SIGN) IN
C                 AN INTEGER COMPUTER WORD.
C
C ALTERNATIVELY, ANY OR ALL OF THE CONSTANTS CAN BE GIVEN
C THE VALUE 0 (0.0D0 FOR DZERO). IF A CONSTANT IS ZERO, DXSET TRIES
C TO ASSIGN AN APPROPRIATE VALUE BY CALLING I1MACH
C (SEE P.A.FOX, A.D.HALL, N.L.SCHRYER, ALGORITHM 528 FRAMEWORK
C FOR A PORTABLE LIBRARY, ACM TRANSACTIONS ON MATH SOFTWARE,
C V.4, NO.2, JUNE 1978, 177-188).
C
C   THIS IS THE SETTING-UP SUBROUTINE FOR A PACKAGE OF SUBROUTINES
C THAT FACILITATE THE USE OF EXTENDED-RANGE ARITHMETIC. EXTENDED-RANGE
C ARITHMETIC ON A PARTICULAR COMPUTER IS DEFINED ON THE SET OF NUMBERS
C OF THE FORM
C
C               (X,IX) = X*RADIX**IX
C
C WHERE X IS A DOUBLE-PRECISION NUMBER CALLED THE PRINCIPAL PART,
C IX IS AN INTEGER CALLED THE AUXILIARY INDEX, AND RADIX IS THE
C INTERNAL BASE OF THE DOUBLE-PRECISION ARITHMETIC.  OBVIOUSLY,
C EACH REAL NUMBER IS REPRESENTABLE WITHOUT ERROR BY MORE THAN ONE
C EXTENDED-RANGE FORM.  CONVERSIONS BETWEEN  DIFFERENT FORMS ARE
C ESSENTIAL IN CARRYING OUT ARITHMETIC OPERATIONS.  WITH THE CHOICE
C OF RADIX WE HAVE MADE, AND THE SUBROUTINES WE HAVE WRITTEN, THESE
C CONVERSIONS ARE PERFORMED WITHOUT ERROR (AT LEAST ON MOST COMPUTERS).
C (SEE SMITH, J.M., OLVER, F.W.J., AND LOZIER, D.W., EXTENDED-RANGE
C ARITHMETIC AND NORMALIZED LEGENDRE POLYNOMIALS, ACM TRANSACTIONS ON
C MATHEMATICAL SOFTWARE, MARCH 1981).
C
C   AN EXTENDED-RANGE NUMBER  (X,IX)  IS SAID TO BE IN ADJUSTED FORM IF
C X AND IX ARE ZERO OR
C
C           RADIX**(-L) .LE. ABS(X) .LT. RADIX**L
C
C IS SATISFIED, WHERE L IS A COMPUTER-DEPENDENT INTEGER DEFINED IN THIS
C SUBROUTINE. TWO EXTENDED-RANGE NUMBERS IN ADJUSTED FORM CAN BE ADDED,
C SUBTRACTED, MULTIPLIED OR DIVIDED (IF THE DIVISOR IS NONZERO) WITHOUT
C CAUSING OVERFLOW OR UNDERFLOW IN THE PRINCIPAL PART OF THE RESULT.
C WITH PROPER USE OF THE EXTENDED-RANGE SUBROUTINES, THE ONLY OVERFLOW
C THAT CAN OCCUR IS INTEGER OVERFLOW IN THE AUXILIARY INDEX. IF THIS
C IS DETECTED, THE SOFTWARE CALLS XERROR (A GENERAL ERROR-HANDLING
C FORTRAN SUBROUTINE PACKAGE).
C
C   MULTIPLICATION AND DIVISION IS PERFORMED BY SETTING
C
C                 (X,IX)*(Y,IY) = (X*Y,IX+IY)
C OR
C                 (X,IX)/(Y,IY) = (X/Y,IX-IY).
C
C PRE-ADJUSTMENT OF THE OPERANDS IS ESSENTIAL TO AVOID
C OVERFLOW OR  UNDERFLOW OF THE PRINCIPAL PART. SUBROUTINE
C DXADJ (SEE BELOW) MAY BE CALLED TO TRANSFORM ANY EXTENDED-
C RANGE NUMBER INTO ADJUSTED FORM.
C
C   ADDITION AND SUBTRACTION REQUIRE THE USE OF SUBROUTINE DXADD
C (SEE BELOW).  THE INPUT OPERANDS NEED NOT BE IN ADJUSTED FORM.
C HOWEVER, THE RESULT OF ADDITION OR SUBTRACTION IS RETURNED
C IN ADJUSTED FORM.  THUS, FOR EXAMPLE, IF (X,IX),(Y,IY),
C (U,IU),  AND (V,IV) ARE IN ADJUSTED FORM, THEN
C
C                 (X,IX)*(Y,IY) + (U,IU)*(V,IV)
C
C CAN BE COMPUTED AND STORED IN ADJUSTED FORM WITH NO EXPLICIT
C CALLS TO DXADJ.
C
C   WHEN AN EXTENDED-RANGE NUMBER IS TO BE PRINTED, IT MUST BE
C CONVERTED TO AN EXTENDED-RANGE FORM WITH DECIMAL RADIX.  SUBROUTINE
C DXCON IS PROVIDED FOR THIS PURPOSE.
C
C   THE SUBROUTINES CONTAINED IN THIS PACKAGE ARE
C
C     SUBROUTINE DXADD
C USAGE
C                  CALL DXADD(X,IX,Y,IY,Z,IZ,IERROR)
C                  IF (IERROR.NE.0) RETURN
C DESCRIPTION
C                  FORMS THE EXTENDED-RANGE SUM  (Z,IZ) =
C                  (X,IX) + (Y,IY).  (Z,IZ) IS ADJUSTED
C                  BEFORE RETURNING. THE INPUT OPERANDS
C                  NEED NOT BE IN ADJUSTED FORM, BUT THEIR
C                  PRINCIPAL PARTS MUST SATISFY
C                  RADIX**(-2L).LE.ABS(X).LE.RADIX**(2L),
C                  RADIX**(-2L).LE.ABS(Y).LE.RADIX**(2L).
C
C     SUBROUTINE DXADJ
C USAGE
C                  CALL DXADJ(X,IX,IERROR)
C                  IF (IERROR.NE.0) RETURN
C DESCRIPTION
C                  TRANSFORMS (X,IX) SO THAT
C                  RADIX**(-L) .LE. ABS(X) .LT. RADIX**L.
C                  ON MOST COMPUTERS THIS TRANSFORMATION DOES
C                  NOT CHANGE THE MANTISSA OF X PROVIDED RADIX IS
C                  THE NUMBER BASE OF DOUBLE-PRECISION ARITHMETIC.
C
C     SUBROUTINE DXC210
C USAGE
C                  CALL DXC210(K,Z,J,IERROR)
C                  IF (IERROR.NE.0) RETURN
C DESCRIPTION
C                  GIVEN K THIS SUBROUTINE COMPUTES J AND Z
C                  SUCH THAT  RADIX**K = Z*10**J, WHERE Z IS IN
C                  THE RANGE 1/10 .LE. Z .LT. 1.
C                  THE VALUE OF Z WILL BE ACCURATE TO FULL
C                  DOUBLE-PRECISION PROVIDED THE NUMBER
C                  OF DECIMAL PLACES IN THE LARGEST
C                  INTEGER PLUS THE NUMBER OF DECIMAL
C                  PLACES CARRIED IN DOUBLE-PRECISION DOES NOT
C                  EXCEED 60. DXC210 IS CALLED BY SUBROUTINE
C                  DXCON WHEN NECESSARY. THE USER SHOULD
C                  NEVER NEED TO CALL DXC210 DIRECTLY.
C
C     SUBROUTINE DXCON
C USAGE
C                  CALL DXCON(X,IX,IERROR)
C                  IF (IERROR.NE.0) RETURN
C DESCRIPTION
C                  CONVERTS (X,IX) = X*RADIX**IX
C                  TO DECIMAL FORM IN PREPARATION FOR
C                  PRINTING, SO THAT (X,IX) = X*10**IX
C                  WHERE 1/10 .LE. ABS(X) .LT. 1
C                  IS RETURNED, EXCEPT THAT IF
C                  (ABS(X),IX) IS BETWEEN RADIX**(-2L)
C                  AND RADIX**(2L) THEN THE REDUCED
C                  FORM WITH IX = 0 IS RETURNED.
C
C     SUBROUTINE DXRED
C USAGE
C                  CALL DXRED(X,IX,IERROR)
C                  IF (IERROR.NE.0) RETURN
C DESCRIPTION
C                  IF
C                  RADIX**(-2L) .LE. (ABS(X),IX) .LE. RADIX**(2L)
C                  THEN DXRED TRANSFORMS (X,IX) SO THAT IX=0.
C                  IF (X,IX) IS OUTSIDE THE ABOVE RANGE,
C                  THEN DXRED TAKES NO ACTION.
C                  THIS SUBROUTINE IS USEFUL IF THE
C                  RESULTS OF EXTENDED-RANGE CALCULATIONS
C                  ARE TO BE USED IN SUBSEQUENT ORDINARY
C                  DOUBLE-PRECISION CALCULATIONS.
C
C***REFERENCES  Smith, Olver and Lozier, Extended-Range Arithmetic and
C                 Normalized Legendre Polynomials, ACM Trans on Math
C                 Softw, v 7, n 1, March 1981, pp 93--105.
C***ROUTINES CALLED  I1MACH, XERMSG
C***COMMON BLOCKS    DXBLK1, DXBLK2, DXBLK3
C***REVISION HISTORY  (YYMMDD)
C   820712  DATE WRITTEN
C   881020  Revised to meet SLATEC CML recommendations.  (DWL and JMS)
C   901019  Revisions to prologue.  (DWL and WRB)
C   901106  Changed all specific intrinsics to generic.  (WRB)
C           Corrected order of sections in prologue and added TYPE
C           section.  (WRB)
C           CALLs to XERROR changed to CALLs to XERMSG.  (WRB)
C   920127  Revised PURPOSE section of prologue.  (DWL)
C***END PROLOGUE  DXSET
      INTEGER IRAD, NRADPL, NBITS
      DOUBLE PRECISION DZERO, DZEROX
      COMMON /DXBLK1/ NBITSF
      SAVE /DXBLK1/
      DOUBLE PRECISION RADIX, RADIXL, RAD2L, DLG10R
      INTEGER L, L2, KMAX
      COMMON /DXBLK2/ RADIX, RADIXL, RAD2L, DLG10R, L, L2, KMAX
      SAVE /DXBLK2/
      INTEGER NLG102, MLG102, LG102
      COMMON /DXBLK3/ NLG102, MLG102, LG102(21)
      SAVE /DXBLK3/
      INTEGER IFLAG
      SAVE IFLAG
C
      DIMENSION LOG102(20), LGTEMP(20)
      SAVE LOG102
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOMC.INC'
      INCLUDE 'DPCOP2.INC'
C
C
C   LOG102 CONTAINS THE FIRST 60 DIGITS OF LOG10(2) FOR USE IN
C CONVERSION OF EXTENDED-RANGE NUMBERS TO BASE 10 .
      DATA LOG102 /301,029,995,663,981,195,213,738,894,724,493,026,768,
     * 189,881,462,108,541,310,428/
C
C FOLLOWING CODING PREVENTS DXSET FROM BEING EXECUTED MORE THAN ONCE.
C THIS IS IMPORTANT BECAUSE SOME SUBROUTINES (SUCH AS DXNRMP AND
C DXLEGF) CALL DXSET TO MAKE SURE EXTENDED-RANGE ARITHMETIC HAS
C BEEN INITIALIZED. THE USER MAY WANT TO PRE-EMPT THIS CALL, FOR
C EXAMPLE WHEN I1MACH IS NOT AVAILABLE. SEE CODING BELOW.
      DATA IFLAG /0/
C***FIRST EXECUTABLE STATEMENT  DXSET
      IERROR=0
      IF (IFLAG .NE. 0) RETURN
      IRADX = IRAD
      NRDPLC = NRADPL
      DZEROX = DZERO
      IMINEX = 0
      IMAXEX = 0
      NBITSX = NBITS
C FOLLOWING 5 STATEMENTS SHOULD BE DELETED IF I1MACH IS
C NOT AVAILABLE OR NOT CONFIGURED TO RETURN THE CORRECT
C MACHINE-DEPENDENT VALUES.
      IF (IRADX .EQ. 0) IRADX = I1MACH (10)
      IF (NRDPLC .EQ. 0) NRDPLC = I1MACH (14)
      IF (DZEROX .EQ. 0.0D0) IMINEX = I1MACH (15)
      IF (DZEROX .EQ. 0.0D0) IMAXEX = I1MACH (16)
      IF (NBITSX .EQ. 0) NBITSX = I1MACH (8)
      IF (IRADX.EQ.2) GO TO 10
      IF (IRADX.EQ.4) GO TO 10
      IF (IRADX.EQ.8) GO TO 10
      IF (IRADX.EQ.16) GO TO 10
CCCCC CALL XERMSG ('SLATEC', 'DXSET', 'IMPROPER VALUE OF IRAD', 201, 1)
      WRITE(ICOUT,901)
      CALL DPWRST('XXX','BUG ')
  901 FORMAT('***** ERROR FROM DXSET, IMPROPER VALUE OF IRAD.')
      IERROR=201
      RETURN
   10 CONTINUE
      LOG2R=0
      IF (IRADX.EQ.2) LOG2R = 1
      IF (IRADX.EQ.4) LOG2R = 2
      IF (IRADX.EQ.8) LOG2R = 3
      IF (IRADX.EQ.16) LOG2R = 4
      NBITSF=LOG2R*NRDPLC
      RADIX = IRADX
      DLG10R = LOG10(RADIX)
      IF (DZEROX .NE. 0.0D0) GO TO 14
      LX = MIN ((1-IMINEX)/2, (IMAXEX-1)/2)
      GO TO 16
   14 CONTINUE
      LX = INT(0.5D0*LOG10(DZEROX)/DLG10R)
C RADIX**(2*L) SHOULD NOT OVERFLOW, BUT REDUCE L BY 1 FOR FURTHER
C PROTECTION.
      LX=LX-1
   16 CONTINUE
      L2 = 2*LX
      IF (LX.GE.4) GO TO 20
CCCCC CALL XERMSG ('SLATEC', 'DXSET', 'IMPROPER VALUE OF DZERO', 202, 1)
      WRITE(ICOUT,902)
      CALL DPWRST('XXX','BUG ')
  902 FORMAT('***** ERROR FROM DXSET, IMPROPER VALUE OF DZERO.')
      IERROR=202
      RETURN
   20 CONTINUE
      L = LX
      RADIXL = RADIX**L
      RAD2L = RADIXL**2
C    IT IS NECESSARY TO RESTRICT NBITS (OR NBITSX) TO BE LESS THAN SOME
C UPPER LIMIT BECAUSE OF BINARY-TO-DECIMAL CONVERSION. SUCH CONVERSION
C IS DONE BY DXC210 AND REQUIRES A CONSTANT THAT IS STORED TO SOME FIXED
C PRECISION. THE STORED CONSTANT (LOG102 IN THIS ROUTINE) PROVIDES
C FOR CONVERSIONS ACCURATE TO THE LAST DECIMAL DIGIT WHEN THE INTEGER
C WORD LENGTH DOES NOT EXCEED 63. A LOWER LIMIT OF 15 BITS IS IMPOSED
C BECAUSE THE SOFTWARE IS DESIGNED TO RUN ON COMPUTERS WITH INTEGER WORD
C LENGTH OF AT LEAST 16 BITS.
      IF (15.LE.NBITSX .AND. NBITSX.LE.63) GO TO 30
CCCCC CALL XERMSG ('SLATEC', 'DXSET', 'IMPROPER VALUE OF NBITS', 203, 1)
      WRITE(ICOUT,913)
      CALL DPWRST('XXX','BUG ')
  913 FORMAT('***** ERROR FROM DXSET, IMPROPER VALUE OF NBITS.')
      IERROR=203
      RETURN
   30 CONTINUE
      KMAX = 2**(NBITSX-1) - L2
      NB = (NBITSX-1)/2
      MLG102 = 2**NB
      IF (1.LE.NRDPLC*LOG2R .AND. NRDPLC*LOG2R.LE.120) GO TO 40
CCCCC CALL XERMSG ('SLATEC', 'DXSET', 'IMPROPER VALUE OF NRADPL', 204,
CCCCC+             1)
      WRITE(ICOUT,903)
      CALL DPWRST('XXX','BUG ')
  903 FORMAT('***** ERROR FROM DXSET, IMPROPER VALUE OF NRADPL.')
      IERROR=204
      RETURN
   40 CONTINUE
      NLG102 = NRDPLC*LOG2R/NB + 3
      NP1 = NLG102 + 1
C
C   AFTER COMPLETION OF THE FOLLOWING LOOP, IC CONTAINS
C THE INTEGER PART AND LGTEMP CONTAINS THE FRACTIONAL PART
C OF LOG10(IRADX) IN RADIX 1000.
      IC = 0
      DO 50 II=1,20
        I = 21 - II
        IT = LOG2R*LOG102(I) + IC
        IC = IT/1000
        LGTEMP(I) = MOD(IT,1000)
   50 CONTINUE
C
C   AFTER COMPLETION OF THE FOLLOWING LOOP, LG102 CONTAINS
C LOG10(IRADX) IN RADIX MLG102. THE RADIX POINT IS
C BETWEEN LG102(1) AND LG102(2).
      LG102(1) = IC
      DO 80 I=2,NP1
        LG102X = 0
        DO 70 J=1,NB
          IC = 0
          DO 60 KK=1,20
            K = 21 - KK
            IT = 2*LGTEMP(K) + IC
            IC = IT/1000
            LGTEMP(K) = MOD(IT,1000)
   60     CONTINUE
          LG102X = 2*LG102X + IC
   70   CONTINUE
        LG102(I) = LG102X
   80 CONTINUE
C
C CHECK SPECIAL CONDITIONS REQUIRED BY SUBROUTINES...
      IF (NRDPLC.LT.L) GO TO 90
CCCCC CALL XERMSG ('SLATEC', 'DXSET', 'NRADPL .GE. L', 205, 1)
      WRITE(ICOUT,904)
      CALL DPWRST('XXX','BUG ')
  904 FORMAT('***** ERROR FROM DXSET, IMPROPER VALUE OF NRADPL.')
      IERROR=205
      RETURN
   90 IF (6*L.LE.KMAX) GO TO 100
CCCCC CALL XERMSG ('SLATEC', 'DXSET', '6*L .GT. KMAX', 206, 1)
      WRITE(ICOUT,905)
      CALL DPWRST('XXX','BUG ')
  905 FORMAT('***** ERROR FROM DXSET, IMPROPER VALUE OF L.')
      IERROR=206
      RETURN
  100 CONTINUE
      IFLAG = 1
      RETURN
      END
      SUBROUTINE D3DEDC(X,Y,Z,N,
     1                  X3DEYE,Y3DEYE,Z3DEYE,
     1                  D3DCXX,D3DCXY,D3DCXZ,
     1                  D3DCYX,D3DCYY,D3DCYZ,
     1                  D3DCZX,D3DCZY,D3DCZZ,
     1                  TERMXX,TERMXY,TERMXZ,
     1                  TERMYX,TERMYY,TERMYZ,
     1                  TERMZX,TERMZY,TERMZZ,
     1                  IBUGPL,ISUBRO,IERROR)
C
C     PURPOSE--COMPUTE DIRECTION COSINES
C              WHICH WILL BE NEEDED TO ROTATE
C              THE 3-D DATA CLOUD ONTO A 2-D PLANE.
C     NOTE--THE DN.. ARE DIRECTION NUMBERS.
C           THE DC.. ARE DIRECTION COSINES.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--88/10
C     ORIGINAL VERSION--MARCH     1979.
C     ORIGINAL VERSION (AS A SEPARATE SUBROUTINE)--SEPTEMBER 1988.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      DIMENSION X(*)
      DIMENSION Y(*)
      DIMENSION Z(*)
C
      CHARACTER*4 IBUGPL
      CHARACTER*4 ISUBRO
      CHARACTER*4 IERROR
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
      CHARACTER*4 ISTEPN
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='D3DE'
      ISUBN2='DC  '
      IERROR='NO'
C
      EPS=0.0000001
C
      IF(IBUGPL.EQ.'OFF'.AND.ISUBRO.NE.'DEDC')GOTO90
      WRITE(ICOUT,999)
  999 FORMAT(1X)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,51)
   51 FORMAT('***** AT THE BEGINNING OF D3DEDC--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,52)IBUGPL,ISUBRO,IERROR,N
   52 FORMAT('IBUGPL,ISUBRO,IERROR,N = ',3(A4,2X),I8)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,61)X3DEYE,Y3DEYE,Z3DEYE
   61 FORMAT('X3DEYE, Y3DEYE, Z3DEYE  = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      DO70II=1,N
        WRITE(ICOUT,73)II,X(II),Y(II),Z(II)
   73   FORMAT('II,X(II),Y(II),Z(II) = ',I8,3G15.7)
        CALL DPWRST('XXX','BUG ')
   70 CONTINUE
   90 CONTINUE
C
C               *********************************************************
C               **  GENERAL DISCUSSION--                               **
C               **  DETERMINE (IN ORIGINAL COORDINATE SYSTEM VALUES)   **
C               **  WHERE THE DATA POINTS FALL ON THE VISUAL PLANE.    **
C               **  FOR EACH (XD,YD,ZD) DATA POINT,                    **
C               **  DETERMINE WHERE THE VISUAL RAY FROM                **
C               **  THE DATA POINT TO OUR EYE                          **
C               **  STRIKES THE VISUAL (PERSPECTIVE) PLANE.            **
C               **  THE VISUAL PLANE IS THAT PLANE                     **
C               **  WHICH IS NORMAL TO OUR EYE                         **
C               **  AND WHICH CONTAINS THE AVERAGE POINT (XM,YM,ZM).   **
C               **  THE EQUATION OF THE VISUAL PLANE IS                **
C               **  (X3DEYE-XM)(X-XM) + (Y3DEYE-YM)(Y-YM) +
C               **                    + (Z3DEYE-YM)(Z-ZM) = 0          **
C               **  WHERE X, Y, Z ARE THE DUMMY VARIABLES              **
C               **  REPRESENTING ANY POINT (X,Y,Z) ON THAT PLANE.      **
C               **  THIS EQUATION MUST BE SOLVED FOR X, Y, AND Z.      **
C               **  THE EQUATIONS OF THE LINE FROM THE DATA POINT
C               **  (XD,YD,ZD)
C               **  TO OUR EYE (X3DEYE,Y3DEYE,Z3DEYE) ARE
C               **  (X-XD)/(X3DEYE-XD) = (Y-YD)/(Y3DEYE-YD)
C               **                     = (Z-ZD)/(Z3DEYE-ZD)
C               **  WHERE (XD,YD,ZD) REPRESENTS A DATA POINT.           **
C               **  THE VISUAL PLANE EQUATION AND THE LINE EQUATIONS    **
C               **  MUST BE COMBINED TO SOLVE FOR THE VALUES (X,Y,Z)    **
C               **  ON THE VISUAL PLANE AS OUR EYE SEES THEM.           **
C               **********************************************************
C
C               **********************************************************
C               **  THE FINAL PLOT STATEMENT WILL INVOLVE
C               **  ONLY 2 VECTORS.
C               **  AT THE MOMENT, THE POINTS (XP,YP,ZP)
C               **  ON THE VISUAL PLANE ARE DEFINED
C               **  BY 3 COORDINATE VALUES.
C               **  TO REDUCE THE 3 COORDINATE VALUES
C               **  TO 2 COORDINATE VALUES,
C               **  WE MUST ROTATE THE VISUAL PLANE
C               **  SO THAT IT IS PARALLEL TO THE ORIGINAL XZ PLANE.
C               **  TO CARRY OUT SUCH A ROTATION, WE MUST
C               **  DETERMINE THE DIRECTION NUMBERS AND DIRECTION COSINES
C               **  OF THE NEW AXES IN TERMS OF THE OLD COORDINATE SYSTEM.
C               **  THE NEW Y AXIS WILL (BY CONSTRUCTION) BE
C               **  ON THE NORMAL LINE TRAVELING FROM
C               **  THE AVERAGE POINT (XM,YM,ZM) TO OUR EYE POINT
C               **  (X3DEYE,Y3DEYE,Z3DEYE)
C               **  AND WILL THEREFORE HAVE DIRECTIONS NUMBERS
C               **  X3DEYE, Y3DEYE, Z3DEYE
C               **  THE NEW Z AXIS WILL BE PERPENDICULAR TO THE NEW Y AXIS
C               **  AND WILL RESIDE IN THE PLANE CONTAINING THE
C               **  THE FOLLOWING 3 POINTS--
C               **      1) THE AVERAGE POINT (XM,YM,ZM)
C               **      2) THE EYE POINT (X3DEYE,Y3DEYE,Z3DEYE)
C               **      3) SOME POINT (SAY (XM,YM,ZM+1)) OF THE OLD Z AXIS
C               **         DISPLACED OVER SO AS TO EMANATE FROM (XM,YM,ZM).
C               **  THE ABOVE 3 POINTS DEFINE A VERTICAL PLANE.
C               **  THE PURPOSE OF THE VERTICAL PLANE IS TO DEFINE
C               **  WHICH DIRECTION IS 'UP' IN THE FINAL PICTURE.
C               **  THE EQUATION OF THE VERTICAL PLANE IS
C               **  (A-XM)(X-XM) + (B-YM)(Y-YM) + (C-ZM)(Z-ZM) = 0 .
C               **  THIS EQUATION MUST BE SOLVED FOR A, B, AND C.
C               **  WITHOUT LOSS OF GENERALITY, A MAY BE INITIALLY SET TO 1.
C               **  THE SOLUTION TURNS OUT TO BE
C               **      A = 1
C               **      B = -X3DEYE/Y3DEYE
C               **      C = 0
C               **  NOTE, HOWEVER, THAT THESE A, B, AND C VALUES
C               **  FOR THIS VERTICAL PLANE WILL BE IDENTICAL TO THE
C               **  DIRECTION NUMBERS FOR THE NORMAL TO THIS VERTICAL PLANE
C               **  WHICH IS IDENTICALLY THE NEW X AXIS
C               **  AND SO THE ABOVE A, B, AND C VALUES DEFINE THE DIRECTION
C               **  DIRECTION NUMBERS FOR THE NEW X AXIS.
C               **  TO SOLVE FOR THE DIRECTION NUMBERS FOR THE NEW Z AXIS,
C               **  WE SEEK 3 DIRECTION NUMBERS D, E, AND F
C               **  WHICH MUST BE PERPENDICULAR TO BOTH THE
C               **  NEW Y AXIS (WITH DIRECTION NUMBERS X3DEYE, Y3DEYE,
C               **  AND Z3DEYE)
C               **  AND THE NEW X AXIS (WITH DIRECTION NUMBERS A, B, AND C ABOVE
C               **  WITHOUT LOSS OF GENERALITY, D MAY BE INITIALLY SET TO 1.
C               **  NOTE THAT WHENEVER 2 LINES ARE PERPENDICULAR,
C               **  THE INNER PRODUCT OF THE DIRECTION NUMBERS MUST = 0.
C               **  WITHOUT LOSS OF GENERALITY, D MAY BE INITIALLY SET TO 1.
C               **  INCORPORATING THE 2 INNER PRODUCT EQUATIONS,
C               **  WE MAY SOLVE FOR E AND F.
C               **  THE SOLUTIONS TURN OUT TO BE
C               **      D = 1
C               **      E = Y3DEYE/X3DEYE
C               **      F = (-X3DEYE*X3DEYE - Y3DEYE*Y3DEYE) / (X3DEYE*Z3DEYE)
C               **
C               **  IN SUMMARY, THE DIRECTION NUMBERS FOR THE 3 NEW AXES
C               **  MAY BE WRITTEN AS
C               **      NEW X AXIS:  Y3DEYE       -X3DEYE     0
C               **      NEW Y AXIS:  X3DEYE       Y3DEYE      Z3DEYE
C               **      NEW Z AXIS:  -X3DEYE*Z3DEYE   -Y3DEYE*Z3DEYE
C               **                                        X3DEYE*X3DEYE+Y3DEYE
C               **  NOTE THAT BY INSPECTION WE SEE RETROSPECTIVELY
C               **  THAT THE 3 INNER PRODUCTS ALL = 0
C               **  AND SO THE 3 DEFINED AXES ARE ALL PERPENDICULAR
C               **  (AS THEY SHOULD BE).
C               **
C               **  THE CORRESPONDING DIRECTION COSINES
C               **  ARE GOTTEN BY NORMALIZATION TO UNITY;
C               **  LET US SYMBOLICALLY REPRESENT THEM BY--
C               **      D3DCXX   D3DCXY   D3DCXZ
C               **      D3DCYX   D3DCYY   D3DCYZ
C               **      D3DCZX   D3DCZY   D3DCZZ
C               **  THE ABOVE RESULTS WERE ACTUALLY ARRIVED AT
C               **  (AND ARE VALID FOR) BY DISPLACING THE OLD ORIGIN
C               **  FROM (0,0,0) TO (XM,YM,ZM).
C               **  THIS SIMPLIFIES THE EQUATIONS CONSIDERABLY.
C               **
C               **  GIVEN THAT WE NOW HAVE THE DIRECTION COSINES
C               **  OF THE NEW AXES IN TERMS OF THE OLD COORDINATES,
C               **  WE MAKE USE OF
C               **  EISENHART (COORDINATE GEOMETRY, PAGE 160) WHICH STATES
C               **  THAT THE LINEAR TRANSFORMATION THAT IS NEEDED TO CARRY OUT
C               **  THE ROTATION FROM THE VISUAL PLANE TO THE XZ PLANE
C               **  IS GIVEN BY
C               **      XT = XM + D3DCXX(X-XM) + D3DCXY(Y-YM) + D3DCXZ(Z-ZM)
C               **      YT = YM + D3DCYX(X-XM) + D3DCYY(Y-YM) + D3DCYZ(Z-ZM)
C               **      ZT = ZM + D3DCZX(X-XM) + D3DCZY(Y-YM) + D3DCZZ(Z-ZM)
C               **
C               **  NOTE THAT BY INSPECTION OF THE ABOVE TRANSFORMATION
C               **  IT IS SEEN THAT (XM,YM,ZM) IS MAPPED INTO (XM,YM,ZM)
C               **  (AS IT SHOULD BE).
C               **  NOTE ALSO THAT THE EYE POINT AND ANY POINT ALONG THE LINE
C               **  OF SIGHT WOULD HAVE BEEN MAPPED INTO (XM,YM,ZM)
C               **  AS IT SHOULD BE.
C               **  NOTE ALSO THAT ALL POINTS ON THE VISUAL PLANE
C               **  SINCE THEY SATISFY
C               **     (X3DEYE-XM)(X-XM) + (Y3DEYE-YM)(Y-YM) + (Z3DEYE-ZM)(Z-ZM)
C               **     = 0
C               **  GETS MAPPED INTO THE CONSTANT YT VALUE OF YT = YM
C               **  AND SO THE TRANSFORMED PLOT SURFACE IS ONE WHICH
C               **  IS PARALLEL TO THE XZ PLANE BUT IS DISPLACED
C               **  YM UNITS OUT FROM THE XZ PLANE.
C               **  THIS PLOT PLANE WILL CONTAIN THE POINT (XM,YM,ZM).
C               ****************************************************************
C
      ISTEPN='31'
      IF(IBUGPL.EQ.'ON'.OR.ISUBRO.EQ.'DEDC')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      DNXX=Y3DEYE
      DNXY=-X3DEYE
      DNXZ=0.0
      DNYX=X3DEYE
      DNYY=Y3DEYE
      DNYZ=Z3DEYE
      DNZX=-X3DEYE*Z3DEYE
      DNZY=-Y3DEYE*Z3DEYE
      DNZZ=X3DEYE*X3DEYE+Y3DEYE*Y3DEYE
C
      ARGX=DNXX**2+DNXY**2+DNXZ**2
      ARGY=DNYX**2+DNYY**2+DNYZ**2
      ARGZ=DNZX**2+DNZY**2+DNZZ**2
      DENOMX=0.0
      DENOMY=0.0
      DENOMZ=0.0
      IF(ARGX.GT.0.0)DENOMX=SQRT(ARGX)
      IF(ARGY.GT.0.0)DENOMY=SQRT(ARGY)
      IF(ARGZ.GT.0.0)DENOMZ=SQRT(ARGZ)
C
C     ***** 15 LINES OF CODE TO CHECK FOR DIVISION BY 0 ADDED AUGUST 1983 *****
C
      D3DCXX=CPUMAX
      D3DCXY=CPUMAX
      D3DCXZ=CPUMAX
      IF(DENOMX.EQ.0.0)GOTO1119
      D3DCXX=DNXX/DENOMX
      D3DCXY=DNXY/DENOMX
      D3DCXZ=DNXZ/DENOMX
 1119 CONTINUE
C
      D3DCYX=CPUMAX
      D3DCYY=CPUMAX
      D3DCYZ=CPUMAX
      IF(DENOMY.EQ.0.0)GOTO1129
      D3DCYX=DNYX/DENOMY
      D3DCYY=DNYY/DENOMY
      D3DCYZ=DNYZ/DENOMY
 1129 CONTINUE
C
      D3DCZX=CPUMAX
      D3DCZY=CPUMAX
      D3DCZZ=CPUMAX
      IF(DENOMZ.EQ.0.0)GOTO1139
      D3DCZX=DNZX/DENOMZ
      D3DCZY=DNZY/DENOMZ
      D3DCZZ=DNZZ/DENOMZ
 1139 CONTINUE
C
C     THE FOLLOWING IS FROM EIDE ET AL (1985),
C     ENGINEERING GRAPHICS FUNDAMENTALS
C     PAGE 386-387, FORMULA 17.42.
C     ALPHA IS THE ANGLE FROM MY XY (= BOTTTOM) PLANE TO THE EYE VECTOR
C     BETA  IS THE ANGLE FROM MY YZ (= LEFT) TO THE EYE VECTOR
C     (NOTE DIFFERENCE HERE TO EIDE'S NOTATION, HIS Z = MY Y, & VV.)
C
      ARGALP=X3DEYE**2+Y3DEYE**2+Z3DEYE**2
      DENALP=0.0
      IF(ARGALP.GT.0.0)DENALP=SQRT(ARGALP)
      SINALP=Z3DEYE/DENALP
      COSALP=SQRT(1.0-SINALP**2)
C
      SINBET=0.0
      COSBET=1.0
      DENBET=0.0
      ARGBET=X3DEYE**2+Y3DEYE**2
      IF(ARGBET.LE.EPS)GOTO1159
      IF(ARGBET.GT.EPS)DENBET=SQRT(ARGBET)
      SINBET=X3DEYE/DENBET
      COSBET=SQRT(1.0-SINBET**2)
 1159 CONTINUE
C
      TERMXX=COSBET
      TERMXY=(-SINBET)
      TERMXZ=0.0
C
      TERMYX=COSALP*SINBET
      TERMYY=COSALP*COSBET
      TERMYZ=SINALP
C
      TERMZX=(-SINALP*SINBET)
      TERMZY=(-SINALP*COSBET)
      TERMZZ=COSALP
C
      GOTO9000
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT.      **
C               *****************
C
 9000 CONTINUE
      IF(IBUGPL.EQ.'OFF'.AND.ISUBRO.NE.'DEDC')GOTO9090
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9011)
 9011 FORMAT('***** AT THE END       OF D3DEDC--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9012)IBUGPL,ISUBRO,IERROR
 9012 FORMAT('IBUGPL,ISUBRO,IERROR = ',3A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9013)X3DEYE,Y3DEYE,Z3DEYE
 9013 FORMAT('X3DEYE,Y3DEYE,Z3DEYE = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9021)DNXX,DNXY,DNXZ
 9021 FORMAT('DNXX,DNXY,DNXZ = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9022)DNYX,DNYY,DNYZ
 9022 FORMAT('DNYX,DNYY,DNYZ = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9023)DNYX,DNYY,DNYZ
 9023 FORMAT('DNZX,DNZY,DNZZ = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9024)D3DCXX,D3DCXY,D3DCXZ
 9024 FORMAT('D3DCXX,D3DCXY,D3DCXZ = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9025)D3DCYX,D3DCYY,D3DCYZ
 9025 FORMAT('D3DCYX,D3DCYY,D3DCYZ = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9026)D3DCZX,D3DCZY,D3DCZZ
 9026 FORMAT('D3DCZX,D3DCZY,D3DCZZ = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9034)TERMXX,TERMXY,TERMXZ
 9034 FORMAT('TERMXX,TERMXY,TERMXZ = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9035)TERMYX,TERMYY,TERMYZ
 9035 FORMAT('TERMYX,TERMYY,TERMYZ = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9036)TERMZX,TERMZY,TERMZZ
 9036 FORMAT('TERMZX,TERMZY,TERMZZ = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
 9090 CONTINUE
C
      RETURN
      END
      SUBROUTINE D3DELI(X,Y,Z,N,
     1XEYE0,YEYE0,ZEYE0,
     1XORIG,YORIG,ZORIG,
     1X3DMIN,Y3DMIN,Z3DMIN,
     1X3DMAX,Y3DMAX,Z3DMAX,
     1X3DMID,Y3DMID,Z3DMID,
     1X3DRAN,Y3DRAN,Z3DRAN,
     1X3DEYE,Y3DEYE,Z3DEYE,
     1X3DORI,Y3DORI,Z3DORI,
     1XPRIME,YPRIME,ZPRIME,
     1IBUGPL,ISUBRO,IERROR)
C
C     PURPOSE--COMPUTE MIN, MAX, MID, AND RANGE OF THE RAW DATA.
C              COMPUTE EYE COORDINATES.
C              COMPUTE ORIGIN COORDINATES
C              COMPUTE VISUAL EXTREME POINTS ON THE
C                 ORTHOGNORMAL PLANE THROUGH (X3DMID,Y3DMID,Z3DMID)
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--88/10
C     ORIGINAL VERSION--MARCH     1979.
C     ORIGINAL VERSION (AS A SEPARATE SUBROUTINE)--SEPTEMBER 1988.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 IBUGPL
      CHARACTER*4 ISUBRO
      CHARACTER*4 IERROR
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
      CHARACTER*4 ISTEPN
C
C---------------------------------------------------------------------
C
      DIMENSION X(*)
      DIMENSION Y(*)
      DIMENSION Z(*)
C
      DIMENSION XPRIME(*)
      DIMENSION YPRIME(*)
      DIMENSION ZPRIME(*)
C
C---------------------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='D3DE'
      ISUBN2='LI  '
      IERROR='NO'
C
      EPS=0.0000001
C
      IF(IBUGPL.NE.'ON'.AND.ISUBRO.NE.'DELI')GOTO90
      WRITE(ICOUT,999)
  999 FORMAT(1X)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,51)
   51 FORMAT('***** AT THE BEGINNING OF D3DELI--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,52)IBUGPL,ISUBRO,IERROR
   52 FORMAT('IBUGPL,ISUBRO,IERROR = ',3A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,61)XEYE0,YEYE0,ZEYE0
   61 FORMAT('XEYE0, YEYE0, ZEYE0  = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,62)XORIG,YORIG,ZORIG
   62 FORMAT('XORIG, YORIG, ZORIG  = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,71)N
   71 FORMAT('N = ',I8)
      CALL DPWRST('XXX','BUG ')
      DO72I=1,N
      WRITE(ICOUT,73)I,X(I),Y(I),Z(I)
   73 FORMAT('I,X(I),Y(I),Z(I) = ',I8,3E15.7)
      CALL DPWRST('XXX','BUG ')
   72 CONTINUE
   90 CONTINUE
C
C               ************************************************
C               **  STEP 11--                                 **
C               **  COMPUTE THE MIN AND MAX OF THE RAW DATA.  **
C               ************************************************
C
      ISTEPN='11'
      IF(IBUGPL.EQ.'ON'.OR.ISUBRO.EQ.'DELI')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      X3DMIN=X(1)
      X3DMAX=X(1)
      Y3DMIN=Y(1)
      Y3DMAX=Y(1)
      Z3DMIN=Z(1)
      Z3DMAX=Z(1)
C
      DO1100I=1,N
      IF(X(I).LT.X3DMIN)X3DMIN=X(I)
      IF(X(I).GT.X3DMAX)X3DMAX=X(I)
      IF(Y(I).LT.Y3DMIN)Y3DMIN=Y(I)
      IF(Y(I).GT.Y3DMAX)Y3DMAX=Y(I)
      IF(Z(I).LT.Z3DMIN)Z3DMIN=Z(I)
      IF(Z(I).GT.Z3DMAX)Z3DMAX=Z(I)
 1100 CONTINUE
      X3DRAN=X3DMAX-X3DMIN
      Y3DRAN=Y3DMAX-Y3DMIN
      Z3DRAN=Z3DMAX-Z3DMIN
C
C               *******************************************
C               **  STEP 12--                            **
C               **  COMPUTE MIDRANGES FOR THE X, Y,      **
C               **  AND Z VECTORS.                       **
C               **  THIS WILL DEFINE THE 'MIDDLE POINT'  **
C               **  OF THE 3-D PLOT.                     **
C               *******************************************
C
      ISTEPN='12'
      IF(IBUGPL.EQ.'ON'.OR.ISUBRO.EQ.'DELI')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      X3DMID=(X3DMIN+X3DMAX)/2.0
      Y3DMID=(Y3DMIN+Y3DMAX)/2.0
      Z3DMID=(Z3DMIN+Z3DMAX)/2.0
C
C               *******************************************
C               **  STEP 13--                            **
C               **  COMPUTE EYE COORDINATES.             88
C               **  IF (XEYE0,YEYE0,ZEYE0) IS UNDEFINED  **
C               **  (THAT IS,    = CPU MINIMUM),         **
C               **  THEN COMPUTE DEFAULT VALUES.         **
C               *******************************************
C
      ISTEPN='13'
      IF(IBUGPL.EQ.'ON'.OR.ISUBRO.EQ.'DELI')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
      X3DEYE=XEYE0
      Y3DEYE=YEYE0
      Z3DEYE=ZEYE0
      IF(XEYE0.LE.CPUMIN)X3DEYE=X3DMAX+3.0*X3DRAN
      IF(YEYE0.LE.CPUMIN)Y3DEYE=Y3DMAX+3.0*Y3DRAN
      IF(ZEYE0.LE.CPUMIN)Z3DEYE=Z3DMAX+3.0*Z3DRAN
C
C               ***************************************************
C               **  STEP 14--                                    **
C               **  COMPUTE THE ENDPONTS OF THE 3-PRONGED AXIS.  **
C               ***************************************************
C
      ISTEPN='14'
      IF(IBUGPL.EQ.'ON'.OR.ISUBRO.EQ.'DELI')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      FACTOR=1.25
C
      X3DORI=XORIG
      Y3DORI=YORIG
      Z3DORI=ZORIG
      IF(XORIG.EQ.CPUMIN)X3DORI=X3DMIN
      IF(YORIG.EQ.CPUMIN)Y3DORI=Y3DMIN
      IF(ZORIG.EQ.CPUMIN)Z3DORI=Z3DMIN
C
      XPRIME(1)=X3DORI
      YPRIME(1)=Y3DORI
      ZPRIME(1)=Z3DORI
C
      XPRIME(2)=X3DORI+FACTOR*X3DRAN
      YPRIME(2)=Y3DORI
      ZPRIME(2)=Z3DORI
C
      XPRIME(3)=X3DORI
      YPRIME(3)=Y3DORI
      ZPRIME(3)=Z3DORI
C
      XPRIME(4)=X3DORI
      YPRIME(4)=Y3DORI+FACTOR*Y3DRAN
      ZPRIME(4)=Z3DORI
C
      XPRIME(5)=X3DORI
      YPRIME(5)=Y3DORI
      ZPRIME(5)=Z3DORI
C
      XPRIME(6)=X3DORI
      YPRIME(6)=Y3DORI
      ZPRIME(6)=Z3DORI+FACTOR*Z3DRAN
C
C               ***************************************************************
C               **  STEP 15--                                                **
C               **  DETERMINE 3 POINTS WHICH WILL DEFINE EXTREMAL POINTS     **
C               **  ON THE VISUAL PLANE.                                     **
C               **  THIS IS NEEDED SO THAT THE UNDERLYING GRAPHICS SOFTWARE  **
C               **  WILL SHOW A CLOSE POINT/CLOUD/FIGURE                     **
C               **  AS BEING LARGE IN APPEARANCE,                            **
C               **  AND A DISTANT POINT/CLOUD/FIGURE                         **
C               **  AS BEING SMALL IN APPEARANCE.                            **
C               **  SUCH A STEP IS NECESSARY BECAUSE THE                     **
C               **  UNDERLYING GRAPHICS SOFTWARE WILL BY DEFAULT             **
C               **  GIVE FULL RESOLUTION TO ALL DATA CLOUDS/FIGRUES          **
C               **  WHICH WILL HAVE THE NET EFFECT OF                        **
C               **  ALL DATA CLOUDS/FIGURES BEING LARGE.                     **
C               **  THE 3 CALCULATED EXTREMAL POINTS WILL NEVER              **
C               **  EXPLICITELY APPEAR ON THE PLOT (THEY WILL                **
C               **  HAVE A BLANK PLOT CHARAXCTER AUTOMATICALLY);             **
C               **  THERE EXISTENCE ONLY SERVES TO ASSURE THAT THE           **
C               **  PLOT WINDOW IS APPROPRIATELY STRETCHED.                  **
C               ***************************************************************
C
C               ************************************************************
C               **  STEP 15.1--                                           **
C               **  DEFINE THE PERIPHERAL VISION ANGLE.                   **
C               **  THIS HAS BEEN SET TO 60 DEGREES                       **
C               **  (30   DEGREES ABOVE THE NORMAL LINE                   **
C               **  TO THE VISUAL PLANE AND 30   DEGREES BELOW            **
C               **  THE NORMAL LINE TO THE PLANE).                        **
C               **  COMPUTE THE RADIUS OF THE CIRCLE ON THE VISUAL PLANE  **
C               **  WHICH IS JUST AT THE EDGE OF VISIBILITY--             **
C               **  THE LARGER THE PERIPHERAL ANGLE,                      **
C               **  THE LARGER THE RADIUS, AND VICE VERSA.                **
C               ************************************************************
C
      ISTEPN='15.1'
      IF(IBUGPL.EQ.'ON'.OR.ISUBRO.EQ.'DELI')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      THETA=3.1415926/12.0
      ARG=(X3DEYE-X3DMID)**2+(Y3DEYE-Y3DMID)**2+(Z3DEYE-Z3DMID)**2
      DIST=0.0
      IF(ARG.GT.0.0)DIST=SQRT(ARG)
      RADIUS=DIST*TAN(THETA)
      IF(IBUGPL.NE.'ON'.AND.ISUBRO.NE.'DELI')GOTO1519
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1511)
 1511 FORMAT('***** FROM THE MIDDLE OF D3DELI--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1512)THETA,ARG,DIST,RADIUS
 1512 FORMAT('THETA,ARG,DIST,RADIUS = ',4E15.7)
      CALL DPWRST('XXX','BUG ')
 1519 CONTINUE
C
C               ***********************************************************
C               **  STEP 15.2--                                          **
C               **  DETERMINE THE 2 POINTS ON THIS CIRCLE OF VISIBILITY  **
C               **  WHICH INTERSECT WITH THE X = X3DMID PLANE.             **
C               ***********************************************************
C
      ISTEPN='15.2'
      IF(IBUGPL.EQ.'ON'.OR.ISUBRO.EQ.'DELI')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      XD=X3DMID
      YD1=Y3DMID
      YD2=Y3DMID
      ZD1=Z3DMID
      ZD2=Z3DMID
C
C     ***** 7 LINES OF CODE TO ADJUST FOR DIVISION BY 0 ADDED AUGUST 1983 *****
      XDEL=X3DEYE-X3DMID
      IF(XDEL.EQ.0.0)XDEL=EPS
      YDEL=Y3DEYE-Y3DMID
      IF(YDEL.EQ.0.0)YDEL=EPS
      ZDEL=Z3DEYE-Z3DMID
      IF(ZDEL.EQ.0.0)ZDEL=EPS
C
      DISC=1.0+(ZDEL/YDEL)**2
      DENOM=0.0
      IF(DISC.GT.0.0)DENOM=SQRT(DISC)
      IF(DISC.LT.0.0)GOTO1520
      ZD1=Z3DMID+RADIUS/DENOM
      ZD2=Z3DMID+RADIUS/(-DENOM)
      YD1=CPUMIN
      IF(YDEL.NE.0.0)YD1=Y3DMID-ZDEL*(ZD1-Z3DMID)/YDEL
      YD2=CPUMAX
      IF(YDEL.NE.0.0)YD2=Y3DMID-ZDEL*(ZD2-Z3DMID)/YDEL
 1520 CONTINUE
C
      XPRIME(7)=X3DMID
      YPRIME(7)=YD1
      ZPRIME(7)=ZD1
C
      XPRIME(8)=X3DMID
      YPRIME(8)=YD2
      ZPRIME(8)=ZD2
C
      IF(IBUGPL.NE.'ON'.AND.ISUBRO.NE.'DELI')GOTO1529
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1521)X3DMID,RADIUS
 1521 FORMAT('X3DMID,RADIUS = ',2E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1522)DISC,DENOM
 1522 FORMAT('DISC,DENOM = ',2E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1523)XD,YD1,YD2,ZD1,ZD2
 1523 FORMAT('XD,YD1,YD2,ZD1,ZD2 = ',5E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1524)XPRIME(7),YPRIME(7),ZPRIME(7)
 1524 FORMAT('XPRIME(7),YPRIME(7),ZPRIME(7)    = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1525)XPRIME(8),YPRIME(8),ZPRIME(8)
 1525 FORMAT('XPRIME(8),YPRIME(8),ZPRIME(8)    = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
 1529 CONTINUE
C
C               ***********************************************************
C               **  STEP 15.3--                                          **
C               **  DETERMINE THE 2 POINTS ON THIS CIRCLE OF VISIBILITY  **
C               **  WHICH INTERSECT WITH THE Y = Y3DMID PLANE.             **
C               ***********************************************************
C
      ISTEPN='15.3'
      IF(IBUGPL.EQ.'ON'.OR.ISUBRO.EQ.'DELI')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      XD1=X3DMID
      XD2=X3DMID
      YD=Y3DMID
      ZD1=Z3DMID
      ZD2=Z3DMID
C
C     ***** 3 LINES OF CODE TO CHECK FOR DIVISION BY 0 ADDED AUGUST 1983 *****
      DISC=CPUMAX
      IF(XDEL.NE.0.0)DISC=1.0+(ZDEL/XDEL)**2
      DENOM=0.0
      IF(DISC.GT.0.0)DENOM=SQRT(DISC)
      IF(DISC.LT.0.0)GOTO1530
      ZD1=Z3DMID+RADIUS/DENOM
      ZD2=Z3DMID+RADIUS/(-DENOM)
      XD1=CPUMIN
      IF(XDEL.NE.0.0)XD1=X3DMID-ZDEL*(ZD1-Z3DMID)/XDEL
      XD2=CPUMAX
      IF(XDEL.NE.0.0)XD2=X3DMID-ZDEL*(ZD2-Z3DMID)/XDEL
C
 1530 CONTINUE
      XPRIME(9)=XD1
      YPRIME(9)=Y3DMID
      ZPRIME(9)=ZD1
C
      XPRIME(10)=XD2
      YPRIME(10)=Y3DMID
      ZPRIME(10)=ZD2
C
      IF(IBUGPL.NE.'ON'.AND.ISUBRO.NE.'DELI')GOTO1539
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1531)Y3DMID,RADIUS
 1531 FORMAT('Y3DMID,RADIUS = ',2E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1532)DISC,DENOM
 1532 FORMAT('DISC,DENOM = ',2E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1533)XD1,XD2,YD,ZD1,ZD2
 1533 FORMAT('XD1,XD2,YD,ZD1,ZD2 = ',5E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1534)XPRIME(9),YPRIME(9),ZPRIME(9)
 1534 FORMAT('XPRIME(9),YPRIME(9),ZPRIME(9)    = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1535)XPRIME(10),YPRIME(10),ZPRIME(10)
 1535 FORMAT('XPRIME(10),YPRIME(10),ZPRIME(10) = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
 1539 CONTINUE
C
C               ***********************************************************
C               **  STEP 15.4--                                          **
C               **  DETERMINE THE 2 POINTS ON THIS CIRCLE OF VISIBILITY  **
C               **  WHICH INTERSECT WITH THE Z = Z3DMID PLANE.             **
C               ***********************************************************
C
      ISTEPN='15.4'
      IF(IBUGPL.EQ.'ON'.OR.ISUBRO.EQ.'DELI')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      XD1=X3DMID
      XD2=X3DMID
      YD1=Y3DMID
      YD2=Y3DMID
      ZD=Z3DMID
C
C     ***** 3 LINES OF CODE TO CHECK FOR DIVISION BY 0 ADDED AUGUST 1983 *****
      DISC=CPUMAX
      IF(YDEL.NE.0.0)DISC=1.0+(XDEL/YDEL)**2
      DENOM=0.0
      IF(DISC.GT.0.0)DENOM=SQRT(DISC)
      IF(DISC.LT.0.0)GOTO1540
      XD1=X3DMID+RADIUS/DENOM
      XD2=X3DMID+RADIUS/(-DENOM)
      YD1=CPUMIN
      IF(YDEL.NE.0.0)YD1=Y3DMID-XDEL*(XD1-X3DMID)/YDEL
      YD2=CPUMAX
      IF(YDEL.NE.0.0)YD2=Y3DMID-XDEL*(XD2-X3DMID)/YDEL
C
 1540 CONTINUE
      XPRIME(11)=XD1
      YPRIME(11)=YD1
      ZPRIME(11)=Z3DMID
C
      XPRIME(12)=XD2
      YPRIME(12)=YD2
      ZPRIME(12)=Z3DMID
C
      IF(IBUGPL.NE.'ON'.AND.ISUBRO.NE.'DELI')GOTO1549
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1541)Z3DMID,RADIUS
 1541 FORMAT('Z3DMID,RADIUS = ',2E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1542)DISC,DENOM
 1542 FORMAT('DISC,DENOM = ',2E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1543)XD1,XD2,YD1,YD2,ZD
 1543 FORMAT('XD1,XD2,YD1,YD2,ZD = ',5E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1544)XPRIME(11),YPRIME(11),ZPRIME(11)
 1544 FORMAT('XPRIME(11),YPRIME(11),ZPRIME(11) = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1545)XPRIME(12),YPRIME(12),ZPRIME(12)
 1545 FORMAT('XPRIME(12),YPRIME(12),ZPRIME(12) = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
 1549 CONTINUE
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT.      **
C               *****************
C
      IF(IBUGPL.NE.'ON'.AND.ISUBRO.NE.'DELI')GOTO9090
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9011)
 9011 FORMAT('***** AT THE END       OF D3DELI--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9012)IBUGPL,ISUBRO,IERROR
 9012 FORMAT('IBUGPL,ISUBRO,IERROR = ',3A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9021)N
 9021 FORMAT('N = ',I8)
      CALL DPWRST('XXX','BUG ')
      DO9022I=1,N
      WRITE(ICOUT,9023)I,X(I),Y(I),Z(I)
 9023 FORMAT('I,X(I),Y(I),Z(I) = ',I8,3E15.7)
      CALL DPWRST('XXX','BUG ')
 9022 CONTINUE
      WRITE(ICOUT,9031)X3DMIN,Y3DMIN,Z3DMIN
 9031 FORMAT('X3DMIN,Y3DMIN,Z3DMIN       = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9032)X3DMAX,Y3DMAX,Z3DMAX
 9032 FORMAT('X3DMAX,Y3DMAX,Z3DMAX       = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9033)X3DMID,Y3DMID,Z3DMID
 9033 FORMAT('X3DMID,Y3DMID,Z3DMID       = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9034)X3DRAN,Y3DRAN,Z3DRAN
 9034 FORMAT('X3DRAN,Y3DRAN,Z3DRAN = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9041)XEYE0,YEYE0,ZEYE0
 9041 FORMAT('XEYE0,YEYE0,ZEYE0    = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9042)X3DEYE,Y3DEYE,Z3DEYE
 9042 FORMAT('X3DEYE,Y3DEYE,Z3DEYE       = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9043)XORIG,YORIG,ZORIG
 9043 FORMAT('XORIG,YORIG,ZORIG    = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9044)X3DORI,Y3DORI,Z3DORI
 9044 FORMAT('X3DORI,Y3DORI,Z3DORI = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      DO9051I=1,12
      WRITE(ICOUT,9052)I,XPRIME(I),YPRIME(I),ZPRIME(I)
 9052 FORMAT('I,XPRIME(I),YPRIME(I),ZPRIME(I) = ',I8,3E15.7)
      CALL DPWRST('XXX','BUG ')
 9051 CONTINUE
 9090 CONTINUE
C
      RETURN
      END
      SUBROUTINE D3DEMD(X,Y,Z,TEMP,N,
     1XDELMN,YDELMN,ZDELMN)
C
C     PURPOSE--COMPUTE MINIMUM DIFFERENCE
C              BETWEEN X VALUES,
C              BETWEEN Y VALUES,
C              BETWEEN Z VALUES.
C
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--88/11
C     ORIGINAL VERSION--OCTOBER   1979.
C     UPDATED         --JULY      1989.  CHAR*4 STATEMETN FOR IWRITE
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
CCCCC THE FOLLOWING LINE WAS ADDED JULY 1989
      CHARACTER*4 IWRITE
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
      CHARACTER*4 ISTEPN
C
C---------------------------------------------------------------------
C
      INCLUDE 'DPCOBE.INC'
C
      DIMENSION X(*)
      DIMENSION Y(*)
      DIMENSION Z(*)
      DIMENSION TEMP(*)
C
C---------------------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='D3DE'
      ISUBN2='MD  '
C
      IF(IBUGG4.NE.'ON'.AND.ISUBG4.NE.'DEMD')GOTO90
      WRITE(ICOUT,999)
  999 FORMAT(1X)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,51)
   51 FORMAT('***** AT THE BEGINNING OF D3DEMD--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,52)IBUGG4,ISUBG4,IERRG4
   52 FORMAT('IBUGG4,ISUBG4,IERRG4 = ',3A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,71)N
   71 FORMAT('N = ',I8)
      CALL DPWRST('XXX','BUG ')
      DO72I=1,N
      WRITE(ICOUT,73)I,X(I),Y(I),Z(I)
   73 FORMAT('I,X(I),Y(I),Z(I) = ',I8,3E15.7)
      CALL DPWRST('XXX','BUG ')
   72 CONTINUE
   90 CONTINUE
C
C               ************************************************
C               **  STEP 11--                                 **
C               **  COMPUTE MINIMUM DIFFERENCES               **
C               ************************************************
C
      ISTEPN='11'
      IF(IBUGG4.EQ.'ON'.OR.ISUBG4.EQ.'DEMD')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      IWRITE='OFF'
C
      XDELMN=CPUMAX
      CALL DISTIN(X,N,IWRITE,TEMP,NTEMP,IBUGG4,IERRG4)
      CALL SORT(TEMP,NTEMP,TEMP)
      IF(NTEMP.LE.1)XDELMN=0.0
      IF(NTEMP.LE.1)GOTO1190
      DO1100I=2,NTEMP
      IM1=I-1
      DEL=TEMP(I)-TEMP(IM1)
      IF(DEL.LE.0.0)GOTO1100
      IF(DEL.LT.XDELMN)XDELMN=DEL
 1100 CONTINUE
 1190 CONTINUE
C
      YDELMN=CPUMAX
      CALL DISTIN(Y,N,IWRITE,TEMP,NTEMP,IBUGG4,IERRG4)
      CALL SORT(TEMP,NTEMP,TEMP)
      IF(NTEMP.LE.1)YDELMN=0.0
      IF(NTEMP.LE.1)GOTO1290
      DO1200I=2,NTEMP
      IM1=I-1
      DEL=TEMP(I)-TEMP(IM1)
      IF(DEL.LE.0.0)GOTO1200
      IF(DEL.LT.YDELMN)YDELMN=DEL
 1200 CONTINUE
 1290 CONTINUE
C
      ZDELMN=CPUMAX
      CALL DISTIN(Z,N,IWRITE,TEMP,NTEMP,IBUGG4,IERRG4)
      CALL SORT(TEMP,NTEMP,TEMP)
      IF(NTEMP.LE.1)ZDELMN=0.0
      IF(NTEMP.LE.1)GOTO1390
      DO1300I=2,NTEMP
      IM1=I-1
      DEL=TEMP(I)-TEMP(IM1)
      IF(DEL.LE.0.0)GOTO1300
      IF(DEL.LT.ZDELMN)ZDELMN=DEL
 1300 CONTINUE
 1390 CONTINUE
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT.      **
C               *****************
C
      IF(IBUGG4.NE.'ON'.AND.ISUBG4.NE.'DEMD')GOTO9090
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9011)
 9011 FORMAT('***** AT THE END       OF D3DEMD--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9012)IBUGG4,ISUBG4,IERRG4
 9012 FORMAT('IBUGG4,ISUBG4,IERRG4 = ',3A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9021)N,NTEMP
 9021 FORMAT('N,NTEMP = ',2I8)
      CALL DPWRST('XXX','BUG ')
      DO9022I=1,N
      WRITE(ICOUT,9023)I,X(I),Y(I),Z(I),TEMP(I)
 9023 FORMAT('I,X(I),Y(I),Z(I),TEMP(I) = ',I8,4E15.7)
      CALL DPWRST('XXX','BUG ')
 9022 CONTINUE
      WRITE(ICOUT,9031)XDELMN,YDELMN,ZDELMN
 9031 FORMAT('XDELMN,YDELMN,ZDELMN = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
 9090 CONTINUE
C
      RETURN
      END
      SUBROUTINE D3DRBA(XRAW,YRAW,ZRAW,NP,
     1                  PX,PY,PZ,PX2,PY2,PZ2,PX3,PY3,
     1                  ICASPL,ICAS3D,ISORSW,
     1                  IBA2SW,ABA2WI,ABA2BA,
     1                  IBA2BL,IBA2BC,IBA2BR,IBA2BG,IBA2BB,PBA2BT,
     1                  IBA2FS,IBA2FC,IBA2FR,IBA2FG,IBA2FB,
     1                  IBA2PT,IBA2PL,IBA2PC,IBA2PR,IBA2PG,IBA2PB,
     1                  IBA2TY,IBA2DI,PBA2PS,PBA2PT,
     1                  XDELMN,YDELMN,ZDELMN,
     1                  PXMIN,PXMAX,PYMIN,PYMAX,
     1                  FX1MIN,FX1MAX,FY1MIN,FY1MAX,
     1                  IX1TSC,IY1TSC)
C
C     PURPOSE--FOR A GENERAL GRAPHICS DEVICE, AND FOR EACH VALUE IN
C              X(.), DRAW A BAR (= VERTICAL OR HORIZONTAL BAR) FROM THE
C              BASE POINT ABA2BA TO THE POINT Y(.).  DO SO FOR A
C              SPECIFIED BAR LINE TYPE, LINES COLOR, AND LINE THICKNESS.
C     NOTE--THE VARIABLES PY(.) AND PX(.) ARE DUMMY VARIABLES WHICH ARE
C           USED IN THE INTERMEDIATE CALCULATIONS AND WHOSE DIMENSIONS
C           ARE DEFINED (FOR EASY OF CHANGE) BACK IN THE MAIN ROUTINE.
C
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--87.5
C     ORIGINAL VERSION (AS A SEPARATE SUBROUTINE)--MAY       1983.
C     UPDATED         --MAY       1987.
C     UPDATED         --MARCH     1988. TO FIX PROBLEM WHEREBY ONLY FIRST BAR
C                                       HAD PROPER PATTERN (STOLNICKI).
C     UPDATED         --SEPTEMBER 1988. RENUMBER
C     UPDATED         --APRIL     1992. ASP2BA  TO  ABA2BA
C     UPDATED         --APRIL     1992. IPATTT TO IPATT
C     UPDATED         --OCTOBER   2020. SUPPORT FOR RGB COLOR
C
C-----NON-COMMON VARIABLES (GRAPHICS)-------------------------------------------
C
      CHARACTER*4 ICASPL
      CHARACTER*4 ICAS3D
      CHARACTER*4 ISORSW
      CHARACTER*4 IBA2SW
      CHARACTER*4 IBA2BL
      CHARACTER*4 IBA2BC
      CHARACTER*4 IBA2FS
      CHARACTER*4 IBA2FC
      CHARACTER*4 IBA2PT
      CHARACTER*4 IBA2PL
      CHARACTER*4 IBA2PC
      CHARACTER*4 IBA2TY
      CHARACTER*4 IBA2DI
      CHARACTER*4 IX1TSC
      CHARACTER*4 IY1TSC
      CHARACTER*4 ITYPE
C
      CHARACTER*4 IFIG
      CHARACTER*4 IPATT
      CHARACTER*4 ICOL
CCCCC CHARACTER*4 ICOLF
CCCCC CHARACTER*4 ICOLP
      CHARACTER*4 IDIR
      CHARACTER*4 ICASE
C
      CHARACTER*4 IHORPA
      CHARACTER*4 IVERPA
      CHARACTER*4 IDUPPA
      CHARACTER*4 IDDOPA
C
CCCCC CHARACTER*4 IFIGSV
C
      DIMENSION XRAW(*)
      DIMENSION YRAW(*)
      DIMENSION ZRAW(*)
      DIMENSION PX(*)
      DIMENSION PY(*)
      DIMENSION PZ(*)
      DIMENSION PX2(*)
      DIMENSION PY2(*)
      DIMENSION PZ2(*)
      DIMENSION PX3(*)
      DIMENSION PY3(*)
C
      DIMENSION XVECT(2)
      DIMENSION YVECT(2)
      DIMENSION ZVECT(2)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOGR.INC'
      INCLUDE 'DPCOBE.INC'
      INCLUDE 'DPCO3D.INC'
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      J=0
      HOLD=1.0
      ABASE=0.0
      PBASE=0.0
      PBASE2=0.0
      PLEFT=0.0
      PRIGHT=0.0
      AWIDTH=0.0
      PWIDTH=0.0
C
      FXMIN=FX1MIN
      FXMAX=FX1MAX
      FYMIN=FY1MIN
      FYMAX=FY1MAX
C
      IF(IBUGG4.EQ.'ON' .OR. ISUBG4.EQ.'DRBA')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,51)
   51   FORMAT('***** AT THE BEGINNING OF D3DRBA--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,53)ICASPL,ICAS3D,ISORSW,NP
   53   FORMAT('ICASPL,ICAS3D,ISORSW,NP = ',3(A4,2X),3I6)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,54)XDELMN,YDELMN,ZDELMN
   54   FORMAT('XDELMN,YDELMN,ZDELMN = ',3G15.7)
        CALL DPWRST('XXX','BUG ')
        IF(NP.GT.3)THEN
          DO65I=1,3
            WRITE(ICOUT,66)I,XRAW(I),YRAW(I),ZRAW(I)
   66       FORMAT('I,XRAW(I),YRAW(I),ZRAW(I) = ',I8,3G15.7)
            CALL DPWRST('XXX','BUG ')
   65     CONTINUE
          NPM2=NP-2
          DO67I=NPM2,NP
            WRITE(ICOUT,68)I,XRAW(I),YRAW(I),ZRAW(I)
   68       FORMAT('I,XRAW(I),YRAW(I),ZRAW(I) = ',I8,3G15.7)
            CALL DPWRST('XXX','BUG ')
   67     CONTINUE
        ENDIF
        WRITE(ICOUT,71)IBA2SW,ABA2WI,ABA2BA
   71   FORMAT('IBA2SW,ABA2WI,ABA2BA = ',A4,2X,2E15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,72)IBA2BL,IBA2BC,PBA2BT,IBA2BR,IBA2BG,IBA2BB
   72   FORMAT('IBA2BL,IBA2BC,PBA2BT,IBA2BR,IBA2BG,IBA2BB = ',
     1         2(A4,2X),G15.7,3I6)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,73)IBA2FS,IBA2FC,IBA2FR,IBA2FG,IBA2FB
   73   FORMAT('IBA2FS,IBA2FC,IBA2FR,IBA2FG,IBA2FB = ',2(A4,2X),3I6)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,74)IBA2PT,IBA2PL,IBA2PC,IBA2TY,IBA2DI,PBA2PS,PBA2PT
   74   FORMAT('IBA2PT,IBA2PL,IBA2PC,IBA2TY,IBA2DI,PBA2PS,PBA2PT = ',
     1         5(A4,2X),2G15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,75)IBA2PR,IBA2PG,IBA2PB
   75   FORMAT('IBA2PR,IBA2PG,IBA2PB = ',3I6)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,81)X3DEYE,Y3DEYE,Z3DEYE
   81   FORMAT('X3DEYE,Y3DEYE,Z3DEYE = ',3G15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,84)PXMIN,PXMAX,PYMIN,PYMAX
   84   FORMAT('PXMIN,PXMAX,PYMIN,PYMAX= ',4G15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,85)FX1MIN,FX1MAX,FY1MIN,FY1MAX
   85   FORMAT('FX1MIN,FX1MAX,FY1MIN,FY1MAX= ',4G15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,86)IX1TSC,IY1TSC
   86   FORMAT('IX1TSC,IY1TSC = ',A4,2X,A4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,89)IBUGG4,ISUBG4,IERRG4
   89   FORMAT('IBUGG4,ISUBG4,IERRG4 = ',A4,2X,A4,2X,A4)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
C               *************************************************
C               **  STEP 11--                                  **
C               **  IF CALLED FOR, SORT THE DATA               **
C               **  ACCORDING TO THE HORIZONTAL AXIS VARIABLE  **
C               *************************************************
C
      IDIR=IBA2DI
C
      IF(ISORSW.EQ.'OFF'  .OR. ICASPL.EQ.'PIEC' .OR.
     1   ICAS3D.EQ.'ON'   .OR. ICASPL.EQ.'CONT')THEN
        DO1160I=1,NP
          PX(I)=XRAW(I)
          PY(I)=YRAW(I)
          PZ(I)=ZRAW(I)
 1160   CONTINUE
      ENDIF
C
C               ************************************************
C               **  STEP 12--                                 **
C               **  IF A LOG SCALE PLOT IS CALLED FOR,        **
C               **  CHECK THAT ALL DATA POINTS ARE POSITIVE.  **
C               ************************************************
C
      IF(IX1TSC.EQ.'LOG')THEN
        IF(IDIR.EQ.'H')THEN
          IF(ABA2BA.LE.0.0)HOLD=ABA2BA
          IF(ABA2BA.LE.0.0)GOTO1250
        ENDIF
C
        IF(ISORSW.EQ.'ON')THEN
          J=1
          IF(PX(J).LE.0.0)GOTO1250
          GOTO1290
        ELSE
          DO1235I=1,NP
            J=I
            IF(PX(J).LE.0.0)GOTO1250
 1235     CONTINUE
          GOTO1290
        ENDIF
C
 1250   CONTINUE
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1251)
 1251   FORMAT('***** ERROR IN D3DRBA--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1252)
 1252   FORMAT('      THE LOG OF A NON-POSITIVE DATA VALUE WAS ',
     1         'ENCOUNTERED')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1254)
 1254   FORMAT('      IN FORMING A PLOT.  DATA MAY NOT BE ZERO OR ',
     1         'NEGATIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1255)
 1255   FORMAT('      WHEN A LOG SCALE PLOT IS USED.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1256)PX(J)
 1256   FORMAT('      THE VALUE = ',E15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1257)
 1257   FORMAT('      THIS VALUE CAME FROM THE HORIZONTAL AXIS ',
     1         'VARIABLE.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1259)
 1259   FORMAT('      CORRECTIVE ACTION--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1260)
 1260   FORMAT('      CHANGE DATA OR CHANGE LIMITS.')
        CALL DPWRST('XXX','BUG ')
        IERRG4='YES'
        GOTO9000
C
      ENDIF
 1290 CONTINUE
C
      IF(IY1TSC.EQ.'LOG')THEN
        IF(IDIR.EQ.'V')THEN
          IF(ABA2BA.LE.0.0)HOLD=ABA2BA
          IF(ABA2BA.LE.0.0)GOTO1350
        ENDIF
C
        IF(ISORSW.EQ.'ON')THEN
          J=1
          IF(PY(J).LE.0.0)HOLD=PY(J)
          IF(PY(J).LE.0.0)GOTO1350
          GOTO1390
        ELSE
          DO1335I=1,NP
            J=I
            IF(PY(J).LE.0.0)HOLD=PY(J)
            IF(PY(J).LE.0.0)GOTO1350
 1335     CONTINUE
          GOTO1390
        ENDIF
C
 1350   CONTINUE
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1251)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1252)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1254)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1255)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1256)HOLD
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1357)
 1357   FORMAT('      THIS VALUE CAME FROM THE VERTICAL AXIS VARIABLE.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1259)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1260)
        CALL DPWRST('XXX','BUG ')
        IERRG4='YES'
      ENDIF
C
 1390 CONTINUE
C
C               ******************************************
C               **  STEP 40--                           **
C               **  IF A LOG SCALE PLOT IS CALLED FOR,  **
C               **  TRANSFORM THE DATA                  **
C               ******************************************
C
      ABASE=ABA2BA
      AWIDTH=ABA2WI
C
      WIDTHX=AWIDTH
      IF(WIDTHX.EQ.CPUMIN.AND.XDELMN.LE.0.0)WIDTHX=1.0
      IF(WIDTHX.EQ.CPUMIN.AND.XDELMN.GT.0.0)WIDTHX=XDELMN
      WIDTHY=AWIDTH
      IF(WIDTHY.EQ.CPUMIN.AND.YDELMN.LE.0.0)WIDTHY=1.0
      IF(WIDTHY.EQ.CPUMIN.AND.YDELMN.GT.0.0)WIDTHY=YDELMN
      WIDTHZ=AWIDTH
      IF(WIDTHZ.EQ.CPUMIN.AND.ZDELMN.LE.0.0)WIDTHZ=1.0
      IF(WIDTHZ.EQ.CPUMIN.AND.ZDELMN.GT.0.0)WIDTHZ=ZDELMN
C
      IF(IX1TSC.EQ.'LOG')THEN
        IF(IDIR.EQ.'H')ABASE=LOG10(ABASE)
        DO4015I=1,NP
          PX(I)=LOG10(PX(I))
 4015   CONTINUE
      ENDIF
C
      IF(IY1TSC.EQ.'LOG')THEN
        IF(IDIR.EQ.'V')ABASE=LOG10(ABASE)
        DO4025I=1,NP
          PY(I)=LOG10(PY(I))
 4025   CONTINUE
      ENDIF
C
C               *******************************
C               **  STEP 60--                **
C               **  PREPARE TO MAKE VARIOUS  **
C               **  LINE SETTINGS            **
C               *******************************
C
      ITYPE='LINE'
C
C               **********************************************
C               **  STEP 61--                               **
C               **  TRANSLATE THE CHARACTER REPRESENTATION  **
C               **  OF THE LINE PATTERN                     **
C               **  INTO A NUMERIC REPRESENTATION           **
C               **  WHICH CAN BE UNDERSTOOD BY THE          **
C               **  GRAPHICS DEVICE.                        **
C               **********************************************
C
      IPATT=IBA2BL
      CALL GRTRPA(ITYPE,IPATT,PXSPA,PYSPA,
     1JPATT,IHORPA,IVERPA,IDUPPA,IDDOPA,PXSPA2,PYSPA2)
C
C               *******************************
C               **  STEP 62--                **
C               **  SET THE LINE PATTERN     **
C               **  ON THE GRAPHICS DEVICE.  **
C               *******************************
C
      CALL GRSEPA(ITYPE,IPATT,PXSPA,PYSPA,
     1JPATT,IHORPA,IVERPA,IDUPPA,IDDOPA,PXSPA2,PYSPA2)
C
C               **********************************************
C               **  STEP 63--                               **
C               **  TRANSLATE THE  DESIRED                  **
C               **  LINE THICKNESS                          **
C               **  INTO A NUMERIC REPRESENTATION           **
C               **  WHICH CAN BE UNDERSTOOD BY THE          **
C               **  GRAPHICS DEVICE.                        **
C               **********************************************
C
      PTHICK=PBA2BT
      CALL GRTRTH(ITYPE,PTHICK,JTHICK,PTHIC2)
C
C               *******************************
C               **  STEP 64--                **
C               **  SET THE LINE THICKNESS   **
C               **  ON THE GRAPHICS DEVICE.  **
C               *******************************
C
      CALL GRSETH(ITYPE,PTHICK,JTHICK,PTHIC2)
C
C               **********************************************
C               **  STEP 65--                               **
C               **  TRANSLATE THE CHARACTER REPRESENTATION  **
C               **  OF THE LINE COLOR                       **
C               **  INTO A NUMERIC REPRESENTATION           **
C               **  WHICH CAN BE UNDERSTOOD BY THE          **
C               **  GRAPHICS DEVICE.                        **
C               **********************************************
C
      ICASE='LINE'
      ICOLR=IBA2BR
      ICOLG=IBA2BG
      ICOLB=IBA2BB
      CALL GRTRC2(ICOLR,ICOLG,ICOLB,ARED,AGREEN,ABLUE,
     1            AALPHA,IRGBFL)
      IF(IRGBFL.EQ.1)THEN
        CALL GRSEC2(ICASE,IRGBFL,ARED,AGREEN,ABLUE,AALPHA)
      ELSE
        ICOL=IBA2BC
        CALL GRTRCO(ITYPE,ICOL,JCOL)
C
C               *******************************
C               **  STEP 66--                **
C               **  SET THE LINE COLOR       **
C               **  ON THE GRAPHICS DEVICE.  **
C               *******************************
C
        CALL GRSECO(ITYPE,ICOL,JCOL)
      ENDIF
C
C               **************************************************
C               **  STEP 71--                                   **
C               **  FOR EACH RAW 3-D DATA POINT--               **
C               **     1) MAKE THE BAR                          **
C               **     2) TRANSLATE IT TO 2 DIMENSIONS          **
C               **     3) TRANSLATE IT TO 0-100 UNITS           **
C               **     4) CLIP THE BAR   IF NEEDED              **
C               **     5) DRAW OUT THE BAR                      **
C               **************************************************
C
      IFIG='GENE'
C
      FXMIN=FX1MIN
      FXMAX=FX1MAX
      IF(IX1TSC.EQ.'LOG')FXMIN=LOG10(FX1MIN)
      IF(IX1TSC.EQ.'LOG')FXMAX=LOG10(FX1MAX)
C
      FYMIN=FY1MIN
      FYMAX=FY1MAX
      IF(IY1TSC.EQ.'LOG')FYMIN=LOG10(FY1MIN)
      IF(IY1TSC.EQ.'LOG')FYMAX=LOG10(FY1MAX)
C
      FXRANG=FXMAX-FXMIN
      FYRANG=FYMAX-FYMIN
      PXRANG=PXMAX-PXMIN
      PYRANG=PYMAX-PYMIN
C
C
      BASEX=ABASE
      BASEY=ABASE
      BASEZ=ABASE
C
      DO7100I=1,NP
C
        CALL D3MKBA(PX,PY,PZ,NP,I,
     1              IDIR,WIDTHX,WIDTHY,WIDTHZ,
     1              BASEX,BASEY,BASEZ,
     1              XVECT,YVECT,ZVECT,IXNEAR,IXFAR,
     1              IYNEAR,IYFAR,IZNEAR,IZFAR,
     1              PX2,PY2,PZ2,NP2)
C
        CALL D3TR32(PX2,PY2,PZ2,NP2,PX3,PY3,NP3)
C
        CALL D3TRXP(PX3,PY3,NP3,IDIR,ABASE,
     1              FXMIN,FXMAX,FXRANG,FYMIN,FYMAX,FYRANG,
     1              PXMIN,PXMAX,PXRANG,PYMIN,PYMAX,PYRANG,
     1              PX3,PY3,NP3,PBASE)
C
        CALL DPSQUE(PX3,PY3,NP3,PXMIN,PXMAX,PYMIN,PYMAX)
C
      CALL GRDRPL(PX3,PY3,NP3,
     1            IFIG,IPATT,PTHICK,
     1            ICOL,ICOLR,ICOLG,ICOLB,IRGBFL,
     1            JPATTT,JTHICK,PTHIC2,JCOL)
C
 7100 CONTINUE
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT       **
C               *****************
C
 9000 CONTINUE
      IF(IBUGG4.EQ.'ON' .OR. ISUBG4.EQ.'DRBA')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9011)
 9011   FORMAT('***** AT THE END       OF D3DRBA--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9042)WIDTHX,WIDTHY,WIDTHZ
 9042   FORMAT('WIDTHX,WIDTHY,WIDTHZ = ',3E15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9043)BASEX,BASEY,BASEZ
 9043   FORMAT('BASEX,BASEY,BASEZ    = ',3E15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9044)PXMIN,PXMAX,PYMIN,PYMAX
 9044   FORMAT('PXMIN,PXMAX,PYMIN,PYMAX= ',4E15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9045)FX1MIN,FX1MAX,FY1MIN,FY1MAX
 9045   FORMAT('FX1MIN,FX1MAX,FY1MIN,FY1MAX= ',4E15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9046)FXMIN,FXMAX,FYMIN,FYMAX
 9046   FORMAT('FXMIN,FXMAX,FYMIN,FYMAX= ',4E15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9053)PTHICK,JTHICK,PTHIC2
 9053   FORMAT('PTHICK,JTHICK,PTHIC2 = ',G15.7,I8,G15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9054)ICOL,JCOL,IDIR
 9054   FORMAT('ICOL,JCOL,IDIR = ',A4,I8,2X,A4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9069)IFIG,ITYPE,IERRG4,IPATT,JPATT
 9069   FORMAT('IFIG,ITYPE,IBUGG4,IPATT,JPATT = ',4(A4,2X),I8)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
      RETURN
      END
      SUBROUTINE D3DRCH(XRAW,YRAW,ZRAW,PX,PY,PZ,NP,PY2,PX2,NP2,
     1                  X3D2,
     1                  ICASPL,ICAS3D,ISORSW,
     1                  ICH2PA,ICH2FO,ICH2CA,ICH2JU,ICH2DI,ACH2AN,
     1                  ICH2FI,ICH2CO,ICH2CR,ICH2CG,ICH2CB,
     1                  PCH2HE,PCH2WI,PCH2TH,PCH2HO,PCH2VO,
     1                  ITEXSP,
     1                  PXMIN,PXMAX,PYMIN,PYMAX,
     1                  FX1MIN,FX1MAX,FY1MIN,FY1MAX,
     1                  IX1TSC,IY1TSC,
     1                  IMPSW2,AMPSCH,AMPSCW)
C
C     PURPOSE--FOR A GENERAL GRAPHICS DEVICE, DRAW A CHARACTER TRACE OF
C              Y(.) VERSUS X(.), THAT IS, DRAW A SPECIFIED MARKER
C              (= CHARACTER) TYPE AT EACH OF THE PLOT POINTS.
C     NOTE--THE VARIABLES PY(.) AND PX(.) ARE DUMMY VARIABLES
C           WHICH ARE USED IN THE INTERMEDIATE CALCULATIONS
C           AND WHOSE DIMENSIONS ARE DEFINED (FOR EASY OF CHANGE)
C           BACK IN THE MAIN ROUTINE.
C
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--83.6
C     ORIGINAL VERSION (AS A SEPARATE SUBROUTINE)--MAY       1983.
C     UPDATED         --DECEMBER  1987. INDEPENDENT CONTROL OF CHAR WIDTH.
C     UPDATED         --SEPTEMBER 1988. LOG/WEIBULL CHECK AS A SUBROUTINE
C     UPDATED         --SEPTEMBER 1988. RENUMBER
C     UPDATED         --OCTOBER   2020. SUPPORT FOR RGB COLOR
C
C-----NON-COMMON VARIABLES (GRAPHICS)-------------------------------------------
C
      CHARACTER*4 ICASPL
      CHARACTER*4 ICAS3D
      CHARACTER*4 ISORSW
      CHARACTER*24 ICH2PA
      CHARACTER*4 ICH2FO
      CHARACTER*4 ICH2CA
      CHARACTER*4 ICH2JU
      CHARACTER*4 ICH2DI
      CHARACTER*4 ICH2FI
      CHARACTER*4 ICH2CO
      CHARACTER*4 ITEXSP
      CHARACTER*4 IX1TSC
      CHARACTER*4 IY1TSC
C
      CHARACTER*4 IFIG
      CHARACTER*24 IPATT
      CHARACTER*4 IFONT
      CHARACTER*4 ICASE
      CHARACTER*4 IJUST
      CHARACTER*4 IDIR
      CHARACTER*4 IFILL
      CHARACTER*4 ICOL
      CHARACTER*24 ISYMBL
      CHARACTER*4 ISPAC
      CHARACTER*4 IMPSW2
      CHARACTER*4 ICASAX
C
      DIMENSION XRAW(*)
      DIMENSION YRAW(*)
      DIMENSION ZRAW(*)
      DIMENSION PX(*)
      DIMENSION PY(*)
      DIMENSION PZ(*)
      DIMENSION PY2(*)
      DIMENSION PX2(*)
      DIMENSION X3D2(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOGR.INC'
      INCLUDE 'DPCOBE.INC'
      INCLUDE 'DPCO3D.INC'
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      FXMIN=FX1MIN
      FXMAX=FX1MAX
      FYMIN=FY1MIN
      FYMAX=FY1MAX
      AHUNDR=100.0
C
      IF(IBUGG4.EQ.'ON' .OR. ISUBG4.EQ.'DRCH')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,51)
   51   FORMAT('***** AT THE BEGINNING OF D3DRCH--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,53)ICASPL,ICAS3D,ISORSW,NP
   53   FORMAT('ICASPL,ICAS3D,ISORSW,NP = ',3(A4,2X),I8)
        CALL DPWRST('XXX','BUG ')
        IF(NP.GT.3)THEN
          DO65I=1,3
            WRITE(ICOUT,66)I,XRAW(I),YRAW(I),ZRAW(I)
   66       FORMAT('I,XRAW(I),YRAW(I),ZRAW(I) = ',I8,3G15.7)
            CALL DPWRST('XXX','BUG ')
   65     CONTINUE
          NPM2=NP-2
          DO67I=NPM2,NP
            WRITE(ICOUT,68)I,XRAW(I),YRAW(I),ZRAW(I)
   68       FORMAT('I,XRAW(I),YRAW(I),ZRAW(I) = ',I8,3G15.7)
            CALL DPWRST('XXX','BUG ')
   67     CONTINUE
        ENDIF
        WRITE(ICOUT,74)ICH2PA,ACH2AN,ICH2CR,ICH2CG,ICH2CB
   74   FORMAT('ICH2PA,ACH2AN,ICH2CR,ICH2CG,ICH2CB = ',A24,2X,G15.7,3I6)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,75)ICH2FO,ICH2JU,ICH2DI,ICH2FI,ICH2CO,ITEXSP
   75   FORMAT('ICH2FO,ICH2JU,ICH2DI,ICH2FI,ICH2CO,ITEXSP = ',
     1         5(A4,2X),A4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,81)PCH2HE,PCH2WI
   81   FORMAT('PCH2HE,PCH2WI = ',2G15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,83)PCH2TH,PCH2VO,PCH2HO
   83   FORMAT('PCH2TH,PCH2VO,PCH2HO= ',3G15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,85)PXMIN,PXMAX,PYMIN,PYMAX
   85   FORMAT('PXMIN,PXMAX,PYMIN,PYMAX= ',4G15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,86)FX1MIN,FX1MAX,FY1MIN,FY1MAX
   86   FORMAT('FX1MIN,FX1MAX,FY1MIN,FY1MAX= ',4G15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,87)IX1TSC,IY1TSC
   87   FORMAT('IX1TSC,IY1TSC = ',A4,2X,A4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,89)IBUGG4,ISUBG4,IERRG4
   89   FORMAT('IBUGG4,ISUBG4,IERRG4 = ',2(A4,2X),A4)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
C               *************************************************
C               **  STEP 10--                                  **
C               **  IF CALLED FOR, SORT THE DATA               **
C               **  ACCORDING TO THE HORIZONTAL AXIS VARIABLE  **
C               *************************************************
C
      IF(ISORSW.EQ.'OFF' .OR. ICASPL.EQ.'PIEC' .OR.
     1   ICAS3D.EQ.'ON')THEN
        DO1160I=1,NP
          PX(I)=XRAW(I)
          PY(I)=YRAW(I)
          PZ(I)=ZRAW(I)
 1160   CONTINUE
      ENDIF
C
C
C               **********************************************************
C               **  STEP 21--                                           **
C               **  IF A NON-LINEAR SCALE PLOT IS CALLED FOR,           **
C               **  CHECK THAT ALL   HORIZ. AXIS DATA POINTS            **
C               **  ARE IN VALID RANGE.                                 **
C               **  IF A LOG SCALE PLOT IS CALLED FOR,                  **
C               **  CHECK THAT ALL   HORIZ.  AXIS DATA POINTS ARE > 0.  **
C               **  IF A WEIBULL SCALE PLOT IS CALLED FOR,              **
C               **  CHECK THAT ALL   HORIZ. AXIS DATA POINTS ARE        **
C               **  STRICTLY > 0 AND STRICTLY < 100                     **
C               **********************************************************
C
C               ******************************************
C               **  STEP 41--                           **
C               **  IF A LOG SCALE PLOT IS CALLED FOR,  **
C               **  TRANSFORM THE DATA                  **
C               ******************************************
C
C               ******************************************
C               **  STEP 42--                           **
C               **  IF A WEIBULL SCALE PLOT IS CALLED   **
C               **  FOR, TRANSFORM THE DATA             **
C               ******************************************
C
      IF(IX1TSC.EQ.'LOG')THEN
        ICASAX='2DHO'
        CALL CKLOSC(PX,NP,ISORSW,ICASAX,
     1              ISUBG4,IBUGG4,IERRG4)
        IF(IERRG4.EQ.'YES')GOTO9000
        DO4115I=1,NP
          PX(I)=LOG10(PX(I))
 4115   CONTINUE
      ELSEIF(IX1TSC.EQ.'WEIB')THEN
        ICASAX='2DHO'
        CALL CKPRSC(PX,NP,ISORSW,ICASAX,
     1              ISUBG4,IBUGG4,IERRG4)
        IF(IERRG4.EQ.'YES')GOTO9000
        DO4215I=1,NP
          PX(I)=LOG(LOG(AHUNDR/(AHUNDR-PX(I))))
 4215   CONTINUE
      ENDIF
C
C               **********************************************************
C               **  STEP 22--                                           **
C               **  IF A NON-LINEAR SCALE PLOT IS CALLED FOR,           **
C               **  CHECK THAT ALL   VERT.  AXIS DATA POINTS            **
C               **  ARE IN VALID RANGE.                                 **
C               **  IF A LOG SCALE PLOT IS CALLED FOR,                  **
C               **  CHECK THAT ALL   VERT.   AXIS DATA POINTS ARE > 0.  **
C               **  IF A WEIBULL SCALE PLOT IS CALLED FOR,              **
C               **  CHECK THAT ALL   VERT.  AXIS DATA POINTS ARE        **
C               **  STRICTLY > 0 AND STRICTLY < 100                     **
C               **********************************************************
C
      IF(IY1TSC.EQ.'LOG')THEN
        ICASAX='2DVE'
        CALL CKLOSC(PY,NP,ISORSW,ICASAX,
     1              ISUBG4,IBUGG4,IERRG4)
        IF(IERRG4.EQ.'YES')GOTO9000
        DO4125I=1,NP
          PY(I)=LOG10(PY(I))
 4125   CONTINUE
      ELSEIF(IY1TSC.EQ.'WEIB')THEN
        ICASAX='2DVE'
        CALL CKPRSC(PY,NP,ISORSW,ICASAX,
     1              ISUBG4,IBUGG4,IERRG4)
        IF(IERRG4.EQ.'YES')GOTO9000
        DO4225I=1,NP
          PY(I)=LOG(LOG(AHUNDR/(AHUNDR-PY(I))))
 4225   CONTINUE
      ENDIF
C
C               **************************************************
C               **  STEP 51--                                   **
C               **  FORM THE CHARACTERS IN RAW 3-D SPACE.       **
C               **************************************************
C
C               **************************************************
C               **  STEP 52--                                   **
C               **  IF HIDDEN LINE REMOVAL IS ON,               **
C               **  DETERMINE IF ANY PART                       **
C               **  OF THE CHARACTER IS VISIBLE;                **
C               **  FORM SUBCHARACTERS.                         **
C               **************************************************
C
C               **************************************************
C               **  STEP 53--                                   **
C               **  TRANSLATE THE VISIBLE SUB-CHARACTERS        **
C               **  FROM THE RAW 3-D SPACE                      **
C               **  TO THE FINAL VISUAL 2-D PLANE.              **
C               **************************************************
C
      CALL D3TR32(PX,PY,PZ,NP,PX,PY,NP)
C
C               *****************************************************
C               **  STEP 54--                                      **
C               **  TRANSLATE THE 2-D PLANE DATA POINTS            **
C               **  INTO STANDARDIZED (0.0 TO 100.0) COORDINATES.  **
C               *****************************************************
C
      FXMIN=FX1MIN
      FXMAX=FX1MAX
      IF(IX1TSC.EQ.'LOG')FXMIN=LOG10(FX1MIN)
      IF(IX1TSC.EQ.'LOG')FXMAX=LOG10(FX1MAX)
      IF(IX1TSC.EQ.'WEIB')FXMIN=LOG(LOG(AHUNDR/(AHUNDR-FX1MIN)))
      IF(IX1TSC.EQ.'WEIB')FXMAX=LOG(LOG(AHUNDR/(AHUNDR-FX1MAX)))
C
      FYMIN=FY1MIN
      FYMAX=FY1MAX
      IF(IY1TSC.EQ.'LOG')FYMIN=LOG10(FY1MIN)
      IF(IY1TSC.EQ.'LOG')FYMAX=LOG10(FY1MAX)
      IF(IY1TSC.EQ.'WEIB')FYMIN=LOG(LOG(AHUNDR/(AHUNDR-FY1MIN)))
      IF(IY1TSC.EQ.'WEIB')FYMAX=LOG(LOG(AHUNDR/(AHUNDR-FY1MAX)))
C
      FXRANG=FXMAX-FXMIN
      FYRANG=FYMAX-FYMIN
      PXRANG=PXMAX-PXMIN
      PYRANG=PYMAX-PYMIN
C
      DO5410I=1,NP
        FXRATI=(PX(I)-FXMIN)/FXRANG
        FYRATI=(PY(I)-FYMIN)/FYRANG
        PX(I)=PXMIN+FXRATI*PXRANG
        PY(I)=PYMIN+FYRATI*PYRANG
 5410 CONTINUE
C
      DO5420I=1,NP
        PX(I)=PX(I)+PCH2HO
        PY(I)=PY(I)+PCH2VO
 5420 CONTINUE
C
C               ***********************************************
C               **  STEP 60--                                **
C               **  WRITE OUT THE MARKERS (PLOT CHARACTERS)  **
C               **  AT THE PLOT POINTS                       **
C               ***********************************************
C
      IFIG='GENE'
      IPATT=ICH2PA
      IFONT=ICH2FO
      ICASE=ICH2CA
      IJUST=ICH2JU
      IDIR=ICH2DI
      ANGLE=ACH2AN
      IFILL=ICH2FI
      ICOL=ICH2CO
      ICOLR=ICH2CR
      ICOLG=ICH2CG
      ICOLB=ICH2CB
      PHEIGH=PCH2HE
CCCCC PWIDTH=0.5*PHEIGH
CCCCC PWIDTH=PHEIGH*(ANUMVP/ANUMHP)      DECEMBER 1987  TEST
      PWIDTH=PCH2WI
      PVEGAP=PHEIGH/2.0
      PHOGAP=PWIDTH/2.0
      PTHICK=PCH2TH
      ISYMBL=ICH2PA
      ISPAC=ITEXSP
C
      CALL DPCLCH(PX,PY,NP,PX2,PY2,NP2,X3D2,
     1            PXMIN,PXMAX,PYMIN,PYMAX,
     1            ISORSW,
     1            IFIG,IPATT,IFONT,ICASE,IJUST,IDIR,ANGLE,IFILL,
     1            ICOL,ICOLR,ICOLG,ICOLB,
     1            PHEIGH,PWIDTH,PVEGAP,PHOGAP,PTHICK,
     1            IMPSW2,AMPSCH,AMPSCW,
     1            ISYMBL,ISPAC)
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT       **
C               *****************
C
 9000 CONTINUE
      IF(IBUGG4.EQ.'ON' .OR. ISUBG4.NE.'DRCH')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9011)
 9011   FORMAT('***** AT THE END       OF D3DRCH--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9045)PXMIN,PXMAX,PYMIN,PYMAX
 9045   FORMAT('PXMIN,PXMAX,PYMIN,PYMAX= ',4G15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9059)IBUGG4,ISUBG4,IERRG4
 9059   FORMAT('IBUGG4,ISUBG4,IERRG4 = ',A4,2X,A4,2X,A4)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
      RETURN
      END
      SUBROUTINE D3DRFL(ICASPL,ICAS3D,FRAM3D,
     1                  X3DMIN,X3DMAX,Y3DMIN,Y3DMAX,Z3DMIN,Z3DMAX,
     1                  IX1FSW,IX2FSW,IY1FSW,IY2FSW,
     1                  IX1FPA,IX2FPA,IY1FPA,IY2FPA,
     1                  IX1FCO,IX2FCO,IY1FCO,IY2FCO,
     1                  IX1FC2,IX2FC2,IY1FC2,IY2FC2,
     1                  PFRATH)
C     PURPOSE--DRAW THE 3 TO 8 (IF CALLED FOR) 3-D FRAME LINES
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--93.10
C     ORIGINAL VERSION (AS A SEPARATE SUBROUTINE)--SEPTEMBER 1993.
C
C-----NON-COMMON VARIABLES (GRAPHICS)-------------------------------------------
C
      CHARACTER*4 ICASPL
      CHARACTER*4 ICAS3D
      CHARACTER*4 FRAM3D
      CHARACTER*4 IX1FSW
      CHARACTER*4 IX2FSW
      CHARACTER*4 IY1FSW
      CHARACTER*4 IY2FSW
      CHARACTER*4 IX1FPA
      CHARACTER*4 IX2FPA
      CHARACTER*4 IY1FPA
      CHARACTER*4 IY2FPA
      CHARACTER*4 IX1FCO
      CHARACTER*4 IX2FCO
      CHARACTER*4 IY1FCO
      CHARACTER*4 IY2FCO
C
      DIMENSION IX1FC2(3)
      DIMENSION IX2FC2(3)
      DIMENSION IY1FC2(3)
      DIMENSION IY2FC2(3)
C
      CHARACTER*4 IFIG
      CHARACTER*4 IPATT
      CHARACTER*4 ICOL
      CHARACTER*4 IFLAG
C
      DIMENSION PX(100)
      DIMENSION PY(100)
      DIMENSION PZ(100)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOGR.INC'
      INCLUDE 'DPCOBE.INC'
      INCLUDE 'DPCOP2.INC'
C
C
C-----START POINT-----------------------------------------------------
C
      IF(IBUGG4.EQ.'ON' .OR. ISUBG4.EQ.'DRFL')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,51)
   51   FORMAT('***** AT THE BEGINNING OF D3DRFL--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,52)X3DMIN,X3DMAX,Y3DMIN,Y3DMAX,Z3DMIN,Z3DMAX
   52   FORMAT('X3DMIN,X3DMAX,Y3DMIN,Y3DMAX,Z3DMIN,Z3DMAX = ',6F10.5)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,55)ICASPL,ICAS3D,FRAM3D,PFRATH
   55   FORMAT('ICASPL,ICAS3D,FRAM3D,PFRATH = ',3(A4,2X),G15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,61)IX1FSW,IX2FSW,IY1FSW,IY2FSW
   61   FORMAT('IX1FSW,IX2FSW,IY1FSW,IY2FSW = ',3(A4,2X),A4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,62)IX1FPA,IX2FPA,IY1FPA,IY2FPA
   62   FORMAT('IX1FPA,IX2FPA,IY1FPA,IY2FPA = ',3(A4,2X),A4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,63)IX1FCO,IX2FCO,IY1FCO,IY2FCO
   63   FORMAT('IX1FCO,IX2FCO,IY1FCO,IY2FCO = ',3(A4,2X),A4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,64)IX1FC2(1),IX2FC2(1),IY1FC2(1),IY2FC2(1)
   64   FORMAT('IX1FC2(1),IX2FC2(1),IY1FC2(1),IY2FC2(1) = ',4I6)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,65)IBUGG4,ISUBG4,IERRG4
   65   FORMAT('IBUGG4,ISUBG4,IERRG4 = ',2(A4,2X),A4)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
      ICOLR=-99
      ICOLG=-99
      ICOLB=-99
C
      IF(ICASPL.EQ.'PIEC')GOTO9000
      IF(ICASPL.EQ.'STAR')GOTO9000
C
      IFIG='LINE'
      PTHICK=PFRATH
C
C               *********************************************
C               **  STEP 1--                               **
C               **  IF CALLED FOR,                         **
C               **  DRAW OUT THE "3 PRONG" FRAME           **
C               *********************************************
C
      IF(FRAM3D.EQ.'3PRO')THEN
         PX(1)=X3DMIN
         PX(2)=X3DMAX
         PX(3)=X3DMIN
         PX(4)=X3DMIN
         PX(5)=X3DMIN
         PX(6)=X3DMIN
C
         PY(1)=Y3DMIN
         PY(2)=Y3DMIN
         PY(3)=Y3DMIN
         PY(4)=Y3DMIN
         PY(5)=Y3DMIN
         PY(6)=Y3DMAX
C
         PZ(1)=Z3DMIN
         PZ(2)=Z3DMIN
         PZ(3)=Z3DMIN
         PZ(4)=Z3DMAX
         PZ(5)=Z3DMIN
         PZ(6)=Z3DMIN
         NP=6
         IPATT=IX1FPA
         ICOL=IX1FCO
         ICOLR=IX1FC2(1)
         ICOLG=IX1FC2(2)
         ICOLB=IX1FC2(3)
         IFLAG='ON'
C
         CALL D3TR32(PX,PY,PZ,NP,PX,PY,NP)
         CALL D3SCAL(PX,PY,NP)
         CALL DPDRPL(PX,PY,NP,
     1               IFIG,IPATT,PTHICK,
     1               ICOL,ICOLR,ICOLG,ICOLB,
     1               JPATT,JTHICK,PTHIC2,JCOL,IFLAG)
      ENDIF
C
C               *********************************************
C               **  STEP 2--                               **
C               **  IF CALLED FOR,                         **
C               **  DRAW OUT THE "3 PLANE" STYLE FRAME     **
C               *********************************************
C
      IF(FRAM3D.EQ.'3PLA')THEN
         PX(1)=X3DMIN
         PX(2)=X3DMAX
         PX(3)=X3DMAX
         PX(4)=X3DMIN
         PX(5)=X3DMIN
         PX(6)=X3DMIN
         PX(7)=X3DMIN
         PX(8)=X3DMIN
         PX(9)=X3DMIN
         PX(10)=X3DMAX
         PX(11)=X3DMAX
         PX(12)=X3DMIN
         PX(13)=X3DMIN
C
         PY(1)=Y3DMIN
         PY(2)=Y3DMIN
         PY(3)=Y3DMIN
         PY(4)=Y3DMIN
         PY(5)=Y3DMIN
         PY(6)=Y3DMAX
         PY(7)=Y3DMAX
         PY(8)=Y3DMIN
         PY(9)=Y3DMIN
         PY(10)=Y3DMIN
         PY(11)=Y3DMAX
         PY(12)=Y3DMAX
         PY(13)=Y3DMIN
C
         PZ(1)=Z3DMIN
         PZ(2)=Z3DMIN
         PZ(3)=Z3DMAX
         PZ(4)=Z3DMAX
         PZ(5)=Z3DMIN
         PZ(6)=Z3DMIN
         PZ(7)=Z3DMAX
         PZ(8)=Z3DMAX
         PZ(9)=Z3DMIN
         PZ(10)=Z3DMIN
         PZ(11)=Z3DMIN
         PZ(12)=Z3DMIN
         PZ(13)=Z3DMIN
         NP=13
         IPATT=IX1FPA
         ICOLR=IX1FC2(1)
         ICOLG=IX1FC2(2)
         ICOLB=IX1FC2(3)
         IFLAG='ON'
         CALL D3TR32(PX,PY,PZ,NP,PX,PY,NP)
         CALL D3SCAL(PX,PY,NP)
         CALL DPDRPL(PX,PY,NP,
     1               IFIG,IPATT,PTHICK,
     1               ICOL,ICOLR,ICOLG,ICOLB,
     1               JPATT,JTHICK,PTHIC2,JCOL,IFLAG)
      ENDIF
C
C               *********************************************
C               **  STEP 3--                               **
C               **  IF CALLED FOR,                         **
C               **  DRAW OUT THE "BOX" STYLE FRAME         **
C               *********************************************
C
      IF(FRAM3D.EQ.'BOX')THEN
         PX(1)=X3DMIN
         PX(2)=X3DMAX
         PX(3)=X3DMAX
         PX(4)=X3DMIN
         PX(5)=X3DMIN
         PX(6)=X3DMIN
         PX(7)=X3DMIN
         PX(8)=X3DMIN
         PX(9)=X3DMIN
         PX(10)=X3DMAX
         PX(11)=X3DMAX
         PX(12)=X3DMAX
         PX(13)=X3DMAX
         PX(14)=X3DMAX
         PX(15)=X3DMIN
         PX(16)=X3DMAX
         PX(17)=X3DMAX
         PX(18)=X3DMIN
         PX(19)=X3DMIN
C
         PY(1)=Y3DMIN
         PY(2)=Y3DMIN
         PY(3)=Y3DMIN
         PY(4)=Y3DMIN
         PY(5)=Y3DMIN
         PY(6)=Y3DMAX
         PY(7)=Y3DMAX
         PY(8)=Y3DMIN
         PY(9)=Y3DMIN
         PY(10)=Y3DMIN
         PY(11)=Y3DMAX
         PY(12)=Y3DMAX
         PY(13)=Y3DMIN
         PY(14)=Y3DMAX
         PY(15)=Y3DMAX
         PY(16)=Y3DMAX
         PY(17)=Y3DMAX
         PY(18)=Y3DMAX
         PY(19)=Y3DMIN
C
         PZ(1)=Z3DMIN
         PZ(2)=Z3DMIN
         PZ(3)=Z3DMAX
         PZ(4)=Z3DMAX
         PZ(5)=Z3DMIN
         PZ(6)=Z3DMIN
         PZ(7)=Z3DMAX
         PZ(8)=Z3DMAX
         PZ(9)=Z3DMIN
         PZ(10)=Z3DMIN
         PZ(11)=Z3DMIN
         PZ(12)=Z3DMAX
         PZ(13)=Z3DMAX
         PZ(14)=Z3DMAX
         PZ(15)=Z3DMAX
         PZ(16)=Z3DMAX
         PZ(17)=Z3DMIN
         PZ(18)=Z3DMIN
         PZ(19)=Z3DMIN
         NP=19
         IPATT=IX1FPA
         ICOL=IX1FCO
         ICOLR=IX1FC2(1)
         ICOLG=IX1FC2(2)
         ICOLB=IX1FC2(3)
         IFLAG='ON'
         CALL D3TR32(PX,PY,PZ,NP,PX,PY,NP)
         CALL D3SCAL(PX,PY,NP)
         CALL DPDRPL(PX,PY,NP,
     1               IFIG,IPATT,PTHICK,
     1               ICOL,ICOLR,ICOLG,ICOLB,
     1               JPATT,JTHICK,PTHIC2,JCOL,IFLAG)
      ENDIF
C
C               *********************************************
C               **  STEP 4--                               **
C               **  IF CALLED FOR,                         **
C               **  DRAW OUT THE "ZIGZAG" FRAME            **
C               *********************************************
C
      IF(FRAM3D.EQ.'ZIGZ')THEN
         PX(1)=X3DMIN
         PX(2)=X3DMIN
         PX(3)=X3DMAX
         PX(4)=X3DMAX
C
         PY(1)=Y3DMAX
         PY(2)=Y3DMAX
         PY(3)=Y3DMAX
         PY(4)=Y3DMIN
C
         PZ(1)=Z3DMAX
         PZ(2)=Z3DMIN
         PZ(3)=Z3DMIN
         PZ(4)=Z3DMIN
         NP=4
         IPATT=IX1FPA
         ICOL=IX1FCO
         ICOLR=IX1FC2(1)
         ICOLG=IX1FC2(2)
         ICOLB=IX1FC2(3)
         IFLAG='ON'
         CALL D3TR32(PX,PY,PZ,NP,PX,PY,NP)
         CALL D3SCAL(PX,PY,NP)
         CALL DPDRPL(PX,PY,NP,
     1               IFIG,IPATT,PTHICK,
     1               ICOL,ICOLR,ICOLG,ICOLB,
     1               JPATT,JTHICK,PTHIC2,JCOL,IFLAG)
      ENDIF
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT       **
C               *****************
C
 9000 CONTINUE
      IF(IBUGG4.EQ.'ON' .OR. ISUBG4.EQ.'DRFL')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9011)
 9011   FORMAT('***** AT THE END       OF D3DRFL--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9025)IERRG4
 9025   FORMAT('IERRG4 = ',A4)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
      RETURN
      END
      SUBROUTINE D3DRFR(ICASPL,ICAS3D,FRAM3D,
     1                  X3DMIN,X3DMAX,Y3DMIN,Y3DMAX,Z3DMIN,Z3DMAX,
     1                  IVGMSW,IHGMSW)
C
C     PURPOSE--DRAW 3-D FRAME LINES (ALONG WITH TIC MARKS,
C              TIC MARK LABELS, AND GRID LINES
C              FOR A PLOT.
C
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--93.6
C     ORIGINAL VERSION (AS A SEPARATE SUBROUTINE)--SEPTEMBER 1993.
C
C-----NON-COMMON VARIABLES (GRAPHICS)-------------------------------------------
C
      CHARACTER*4 ICASPL
      CHARACTER*4 ICAS3D
      CHARACTER*4 FRAM3D
      CHARACTER*4 IVGMSW
      CHARACTER*4 IHGMSW
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOPA.INC'
      INCLUDE 'DPCOPC.INC'
      INCLUDE 'DPCOGR.INC'
      INCLUDE 'DPCOBE.INC'
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C
      IF(IBUGG4.EQ.'ON' .OR. ISUBG4.EQ.'DRFR')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,51)
   51   FORMAT('***** AT THE BEGINNING OF D3DRFR--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,52)IMANUF,IMODEL,ICASPL,ICAS3D
   52   FORMAT('IMANUF,IMODEL,ICASPL,ICAS3D = ',3(A4,2X),A4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,55)IBUGG4,ISUBG4,IERRG4
   55   FORMAT('IBUGG4,ISUBG4,IERRG4 = ',2(A4,2X),A4)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
C               *******************************
C               **  STEP 1--                 **
C               **  FILL  THE MARGIN REGION  **
C               *******************************
C
      IFLAG=0
      IF(IMARC2(1).LT.0 .OR. IMARC2(1).LT.0 .OR.
     1   IMARC2(3).LT.0)THEN
        IFLAG=0
      ELSE
        IF(IMARC2(1).NE.IBACC2(1))IFLAG=1
        IF(IMARC2(2).NE.IBACC2(2))IFLAG=1
        IF(IMARC2(3).NE.IBACC2(3))IFLAG=1
      ENDIF
      IF(IMARCO.NE.IBACCO)IFLAG=1
      IF(IFLAG.EQ.1)
     1CALL DPFIMA(PXMIN,PYMIN,PXMAX,PYMAX,
     1            ICASPL,ICAS3D,
     1            IMARCO,IMARC2,IRGBFL)
C
C               ****************************
C               **  STEP 2--              **
C               **  DRAW THE FRAME LINES  **
C               ****************************
C
      CALL D3DRFL(ICASPL,ICAS3D,FRAM3D,
     1            X3DMIN,X3DMAX,Y3DMIN,Y3DMAX,Z3DMIN,Z3DMAX,
     1            IX1FSW,IX2FSW,IY1FSW,IY2FSW,
     1            IX1FPA,IX2FPA,IY1FPA,IY2FPA,
     1            IX1FCO,IX2FCO,IY1FCO,IY2FCO,
     1            IX1FC2,IX2FC2,IY1FC2,IY2FC2,
     1            PFRATH)
C
C               **************************
C               **  STEP 3--            **
C               **  DRAW THE TIC MARKS  **
C               **************************
C
      CALL DPDRTM(PXMIN,PYMIN,PXMAX,PYMAX,
     1            FX1MIN,FY1MIN,FX1MAX,FY1MAX,
     1            ICASPL,ICAS3D,
     1            IX1FSW,IX2FSW,IY1FSW,IY2FSW,
     1            IX1TSW,IX2TSW,IY1TSW,IY2TSW,
     1            PX1COO,PX2COO,PY1COO,PY2COO,
     1            NX1COO,NX2COO,NY1COO,NY2COO,
     1            PX1CMN,PX2CMN,PY1CMN,PY2CMN,
     1            NX1CMN,NX2CMN,NY1CMN,NY2CMN,
     1            PX1TLE,PX2TLE,PY1TLE,PY2TLE,
     1            PTICTH,PMNTFA,
     1            IX1TJU,IX2TJU,IY1TJU,IY2TJU,
     1            IX1TCO,IX2TCO,IY1TCO,IY2TCO,
     1            IX1TC2,IX2TC2,IY1TC2,IY2TC2)
C
C               *************************************
C               **  STEP 4--                       **
C               **  WRITE OUT THE TIC MARK LABELS  **
C               *************************************
C
      CALL DPWRTL(ICASPL,ICAS3D)
C
C               ***************************
C               **  STEP 5--             **
C               **  DRAW THE GRID LINES  **
C               ***************************
C
      CALL DPDRGL(PXMIN,PYMIN,PXMAX,PYMAX,
     1            FX1MIN,FY1MIN,FX1MAX,FY1MAX,
     1            ICASPL,ICAS3D,
     1            IVGRSW,IHGRSW,
     1            IVGMSW,IHGMSW,
     1            PX1COO,PX2COO,PY1COO,PY2COO,
     1            X1COOR,X2COOR,Y1COOR,Y2COOR,
     1            NX1COO,NX2COO,NY1COO,NY2COO,
     1            PX1CMN,PX2CMN,PY1CMN,PY2CMN,
     1            X1COMN,X2COMN,Y1COMN,Y2COMN,
     1            NX1CMN,NX2CMN,NY1CMN,NY2CMN,
     1            IVGRPA,IHGRPA,IVGRCO,IHGRCO,IVGRC2,IHGRC2,
     1            PVGRTH,PHGRTH,
     1            PX1TOL,PX1TOR,PY1TOB,PY1TOT)
CCCC ABOVE LINE ADDED MAY, 1990 (FOR TIC OFFSETS)
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT       **
C               *****************
C
      IF(IBUGG4.EQ.'ON' .OR. ISUBG4.EQ.'DRFR')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9011)
 9011   FORMAT('***** AT THE END       OF D3DRFR--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9015)IERRG4
 9015   FORMAT('IERRG4 = ',A4)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
      RETURN
      END
      SUBROUTINE D3DRSP(XRAW,YRAW,ZRAW,NP,
     1                  PX,PY,PZ,PX2,PY2,PZ2,PX3,PY3,
     1                  ICASPL,ICAS3D,ISORSW,
     1                  ISP2LI,ISP2CO,ISP2CR,ISP2CG,ISP2CB,
     1                  ISP2DI,PSP2TH,ASP2BA,
     1                  PXMIN,PXMAX,PYMIN,PYMAX,
     1                  FX1MIN,FX1MAX,FY1MIN,FY1MAX,
     1                  IX1TSC,IY1TSC)
C
C     PURPOSE--FOR A GENERAL GRAPHICS DEVICE, AND FOR EACH VALUE IN
C              X(.), DRAW A SPIKE (= A VERTICAL OR HORIZONTAL LINE
C              SEGMENT) FROM THE BASE POINT ASP2BA TO THE POINT Y(.).
C              DO SO FOR A SPECIFIED SPIKE LINE TYPE, LINES COLOR,
C              LINE DIRECTION, AND LINE THICKNESS.
C     NOTE--THE VARIABLES PY(.) AND PX(.) ARE DUMMY VARIABLES
C           WHICH ARE USED IN THE INTERMEDIATE CALCULATIONS
C           AND WHOSE DIMENSIONS ARE DEFINED (FOR EASY OF CHANGE)
C           BACK IN THE MAIN ROUTINE.
C
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--87.6
C     ORIGINAL VERSION (AS A SEPARATE SUBROUTINE)--MAY       1983.
C     UPDATED--APRIL     1987.
C     UPDATED         --SEPTEMBER 1988. RENUMBER
C     UPDATED         --OCTOBER   2020. SUPPORT FOR RGB COLOR
C
C-----NON-COMMON VARIABLES (GRAPHICS)-------------------------------------------
C
      CHARACTER*4 ICASPL
      CHARACTER*4 ICAS3D
      CHARACTER*4 ISORSW
      CHARACTER*4 ISP2LI
      CHARACTER*4 ISP2CO
      CHARACTER*4 ISP2DI
      CHARACTER*4 IX1TSC
      CHARACTER*4 IY1TSC
C
      CHARACTER*4 ITYPE
      CHARACTER*4 IFIG
      CHARACTER*4 IPATTT
      CHARACTER*4 ICOL
      CHARACTER*4 IDIR
      CHARACTER*4 ICASE
C
C     6/23/86
C     HOW COME THE FOLLOWING 4 VARIABLES ARE NOT CARRIED
C     AS INPUT TO THIS SUBROUTINE--NOT NEEDED???
C     CHECK ON THIS.
C
      CHARACTER*4 IHORPA
      CHARACTER*4 IVERPA
      CHARACTER*4 IDUPPA
      CHARACTER*4 IDDOPA
C
      DIMENSION XRAW(*)
      DIMENSION YRAW(*)
      DIMENSION ZRAW(*)
      DIMENSION PX(*)
      DIMENSION PY(*)
      DIMENSION PZ(*)
      DIMENSION PX2(*)
      DIMENSION PY2(*)
      DIMENSION PZ2(*)
      DIMENSION PX3(*)
      DIMENSION PY3(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOGR.INC'
      INCLUDE 'DPCOBE.INC'
      INCLUDE 'DPCO3D.INC'
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      J=0
      HOLD=1.0
      ABASE=0.0
      PBASE=0.0
      PBASE2=0.0
C
      FXMIN=FX1MIN
      FXMAX=FX1MAX
      FYMIN=FY1MIN
      FYMAX=FY1MAX
C
      IF(IBUGG4.EQ.'ON' .OR. ISUBG4.EQ.'DRSP')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,51)
   51   FORMAT('***** AT THE BEGINNING OF D3DRSP--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,53)ICASPL,ICAS3D,ISORSW,NP
   53   FORMAT('ICASPL,ICAS3D,ISORSW,NP = ',3(A4,2X),I8)
        CALL DPWRST('XXX','BUG ')
        IF(NP.GT.3)THEN
          DO65I=1,3
            WRITE(ICOUT,66)I,XRAW(I),YRAW(I),ZRAW(I)
   66       FORMAT('I,XRAW(I),YRAW(I),ZRAW(I) = ',I8,3G15.7)
            CALL DPWRST('XXX','BUG ')
   65     CONTINUE
          NPM2=NP-2
          DO67I=NPM2,NP
            WRITE(ICOUT,68)I,XRAW(I),YRAW(I),ZRAW(I)
   68       FORMAT('I,XRAW(I),YRAW(I),ZRAW(I) = ',I8,3G15.7)
            CALL DPWRST('XXX','BUG ')
   67     CONTINUE
        ENDIF
        WRITE(ICOUT,72)ISP2LI,ISP2CO,ISP2DI
   72   FORMAT('ISP2LI,ISP2CO,ISP2DI= ',2(A4,2X),A4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,73)PSP2TH,ASP2BA,ISP2CR,ISP2CG,ISP2CB
   73   FORMAT('PSP2TH,ASP2BA,ISP2CR,ISP2CG,ISP2CB = ',2G15.7,3I6)
        CALL DPWRST('XXX','BUG ')
        DO81I=1,NP
          WRITE(ICOUT,82)I,PX3(I),PY3(I)
   82     FORMAT('I,PX3(I),PY3(I) = ',I8,2G15.7)
          CALL DPWRST('XXX','BUG ')
   81   CONTINUE
        WRITE(ICOUT,84)PXMIN,PXMAX,PYMIN,PYMAX
   84   FORMAT('PXMIN,PXMAX,PYMIN,PYMAX= ',4G15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,85)FX1MIN,FX1MAX,FY1MIN,FY1MAX
   85   FORMAT('FX1MIN,FX1MAX,FY1MIN,FY1MAX= ',4G15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,86)IX1TSC,IY1TSC
   86   FORMAT('IX1TSC,IY1TSC = ',A4,2X,A4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,89)IBUGG4,ISUBG4,IERRG4
   89   FORMAT('IBUGG4,ISUBG4,IERRG4 = ',A4,2X,A4,2X,A4)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
C               *************************************************
C               **  STEP 11--                                  **
C               **  IF CALLED FOR, SORT THE DATA               **
C               **  ACCORDING TO THE HORIZONTAL AXIS VARIABLE  **
C               *************************************************
C
      IDIR=ISP2DI
C
      IF(ISORSW.EQ.'OFF' .OR. ICASPL.EQ.'PIEC' .OR.
     1   ICAS3D.EQ.'ON'  .OR. ICASPL.EQ.'CONT')THEN
        DO1160I=1,NP
          PX(I)=XRAW(I)
          PY(I)=YRAW(I)
          PZ(I)=ZRAW(I)
 1160   CONTINUE
      ENDIF
C
C               ************************************************
C               **  STEP 12--                                 **
C               **  IF A LOG SCALE PLOT IS CALLED FOR,        **
C               **  CHECK THAT ALL DATA POINTS ARE POSITIVE.  **
C               ************************************************
C
C               ******************************************
C               **  STEP 40--                           **
C               **  IF A LOG SCALE PLOT IS CALLED FOR,  **
C               **  TRANSFORM THE DATA                  **
C               ******************************************
C
C
      ABASE=ASP2BA
      IF(IX1TSC.EQ.'LOG')THEN
        IF(IDIR.EQ.'H')THEN
          IF(ASP2BA.LE.0.0)HOLD=ASP2BA
          IF(ASP2BA.LE.0.0)GOTO1250
        ENDIF
C
        IF(ISORSW.EQ.'ON')THEN
          J=1
          IF(PX(J).LE.0.0)GOTO1250
        ELSE
          DO1235I=1,NP
            J=I
            IF(PX(J).LE.0.0)GOTO1250
 1235     CONTINUE
        ENDIF
        GOTO1290
C
 1250   CONTINUE
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1251)
 1251   FORMAT('***** ERROR IN 3-D SPIKES (D3DRSP)--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1252)
 1252   FORMAT('      THE LOG OF A NON-POSITIVE DATA VALUE WAS ',
     1         'ENCOUNTERED')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1254)
 1254   FORMAT('      IN FORMING A PLOT.  DATA MAY NOT BE ZERO OR ',
     1         'NEGATIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1255)
 1255   FORMAT('      WHEN A LOG SCALE PLOT IS USED.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1256)PX(J)
 1256   FORMAT('      THE VALUE = ',G15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1257)
 1257   FORMAT('      THIS VALUE CAME FROM THE HORIZONTAL AXIS ',
     1         'VARIABLE.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1259)
 1259   FORMAT('      CORRECTIVE ACTION--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1260)
 1260   FORMAT('      CHANGE DATA OR CHANGE LIMITS.')
        CALL DPWRST('XXX','BUG ')
        IERRG4='YES'
        IF(IDIR.EQ.'H')ABASE=LOG10(ABASE)
C
 1290   CONTINUE
        DO4015I=1,NP
          PX(I)=LOG10(PX(I))
 4015   CONTINUE
C
      ENDIF
C
      IF(IY1TSC.EQ.'LOG')THEN
        IF(IDIR.EQ.'V')THEN
          IF(ASP2BA.LE.0.0)HOLD=ASP2BA
          IF(ASP2BA.LE.0.0)GOTO1350
        ENDIF
C
        IF(ISORSW.EQ.'ON')THEN
          J=1
          IF(PY(J).LE.0.0)HOLD=PY(J)
          IF(PY(J).LE.0.0)GOTO1350
        ELSE
          DO1335I=1,NP
            J=I
            IF(PY(J).LE.0.0)HOLD=PY(J)
            IF(PY(J).LE.0.0)GOTO1350
 1335     CONTINUE
        ENDIF
        GOTO1390
C
 1350   CONTINUE
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1251)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1252)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1254)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1255)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1256)HOLD
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1357)
 1357   FORMAT('      THIS VALUE CAME FROM THE VERTICAL AXIS VARIABLE.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1259)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1260)
        CALL DPWRST('XXX','BUG ')
        IERRG4='YES'
        GOTO9000
C
 1390   CONTINUE
C
        IF(IDIR.EQ.'V')ABASE=LOG10(ABASE)
        DO4025I=1,NP
          PY(I)=LOG10(PY(I))
 4025   CONTINUE
C
      ENDIF

C
C
C
C               *******************************
C               **  STEP 60--                **
C               **  PREPARE TO MAKE VARIOUS  **
C               **  LINE SETTINGS            **
C               *******************************
C
      ITYPE='LINE'
C
C               **********************************************
C               **  STEP 61--                               **
C               **  TRANSLATE THE CHARACTER REPRESENTATION  **
C               **  OF THE LINE PATTERN                     **
C               **  INTO A NUMERIC REPRESENTATION           **
C               **  WHICH CAN BE UNDERSTOOD BY THE          **
C               **  GRAPHICS DEVICE.                        **
C               **********************************************
C
      IPATTT=ISP2LI
      CALL GRTRPA(ITYPE,IPATTT,PXSPA,PYSPA,
     1JPATTT,IHORPA,IVERPA,IDUPPA,IDDOPA,PXSPA2,PYSPA2)
C
C               *******************************
C               **  STEP 62--                **
C               **  SET THE LINE PATTERN     **
C               **  ON THE GRAPHICS DEVICE.  **
C               *******************************
C
      CALL GRSEPA(ITYPE,IPATTT,PXSPA,PYSPA,
     1JPATTT,IHORPA,IVERPA,IDUPPA,IDDOPA,PXSPA2,PYSPA2)
C
C               **********************************************
C               **  STEP 63--                               **
C               **  TRANSLATE THE  DESIRED                  **
C               **  LINE THICKNESS                          **
C               **  INTO A NUMERIC REPRESENTATION           **
C               **  WHICH CAN BE UNDERSTOOD BY THE          **
C               **  GRAPHICS DEVICE.                        **
C               **********************************************
C
      PTHICK=PSP2TH
      CALL GRTRTH(ITYPE,PTHICK,JTHICK,PTHIC2)
C
C               *******************************
C               **  STEP 64--                **
C               **  SET THE LINE THICKNESS   **
C               **  ON THE GRAPHICS DEVICE.  **
C               *******************************
C
      CALL GRSETH(ITYPE,PTHICK,JTHICK,PTHIC2)
C
C               **********************************************
C               **  STEP 65--                               **
C               **  TRANSLATE THE CHARACTER REPRESENTATION  **
C               **  OF THE LINE COLOR                       **
C               **  INTO A NUMERIC REPRESENTATION           **
C               **  WHICH CAN BE UNDERSTOOD BY THE          **
C               **  GRAPHICS DEVICE.                        **
C               **********************************************
C
      ICOL=ISP2CO
      ICASE='LINE'
      ICOLR=ISP2CR
      ICOLG=ISP2CG
      ICOLB=ISP2CB
      CALL GRTRC2(ICOLR,ICOLG,ICOLB,ARED,AGREEN,ABLUE,
     1            AALPHA,IRGBFL)
      IF(IRGBFL.EQ.1)THEN
        CALL GRSEC2(ICASE,IRGBFL,ARED,AGREEN,ABLUE,AALPHA)
      ELSE
        CALL GRTRCO(ITYPE,ICOL,JCOL)
C
C               *******************************
C               **  STEP 66--                **
C               **  SET THE LINE COLOR       **
C               **  ON THE GRAPHICS DEVICE.  **
C               *******************************
C
        CALL GRSECO(ITYPE,ICOL,JCOL)
      ENDIF
C
C               **************************************************
C               **  STEP 71--                                   **
C               **  FOR EACH RAW 3-D DATA POINT--               **
C               **     1) MAKE THE SPIKE                        **
C               **     2) TRANSLATE IT TO 2 DIMENSIONS          **
C               **     3) TRANSLATE IT TO 0-100 UNITS           **
C               **     4) CLIP THE SPIKE IF NEEDED              **
C               **     5) DRAW OUT THE SPIKE                    **
C               **************************************************
C
C
      IFIG='GENE'
C
      FXMIN=FX1MIN
      FXMAX=FX1MAX
      IF(IX1TSC.EQ.'LOG')FXMIN=LOG10(FX1MIN)
      IF(IX1TSC.EQ.'LOG')FXMAX=LOG10(FX1MAX)
C
      FYMIN=FY1MIN
      FYMAX=FY1MAX
      IF(IY1TSC.EQ.'LOG')FYMIN=LOG10(FY1MIN)
      IF(IY1TSC.EQ.'LOG')FYMAX=LOG10(FY1MAX)
C
      FXRANG=FXMAX-FXMIN
      FYRANG=FYMAX-FYMIN
      PXRANG=PXMAX-PXMIN
      PYRANG=PYMAX-PYMIN
C
      DO7100I=1,NP
C
        CALL D3MKSP(PX,PY,PZ,NP,I,
     1              IDIR,
     1              ABASE,ABASE,ABASE,
     1              PX2,PY2,PZ2,NP2)
C
        CALL D3TR32(PX2,PY2,PZ2,NP2,PX3,PY3,NP3)
C
        CALL D3TRXP(PX3,PY3,NP3,IDIR,ABASE,
     1              FXMIN,FXMAX,FXRANG,FYMIN,FYMAX,FYRANG,
     1              PXMIN,PXMAX,PXRANG,PYMIN,PYMAX,PYRANG,
     1              PX3,PY3,NP3,PBASE)
C
        CALL DPSQUE(PX3,PY3,NP3,PXMIN,PXMAX,PYMIN,PYMAX)
C
        CALL GRDRPL(PX3,PY3,NP3,
     1              IFIG,IPATTT,PTHICK,
     1              ICOL,ICOLF,ICOLG,ICOLB,IRGBFL,
     1              JPATTT,JTHICK,PTHIC2,JCOL)
C
 7100 CONTINUE
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT       **
C               *****************
C
 9000 CONTINUE
      IF(IBUGG4.EQ.'ON' .OR. ISUBG4.EQ.'DRSP')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9011)
 9011   FORMAT('***** AT THE END       OF D3DRSP--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9014)ITYPE,IFIG,IERRG4,HOLD,NP2,NP3
 9014   FORMAT('ITYPE,IFIG,IERRG4,HOLD,NP2,NP3 = ',3(A4,2X),G15.7,2I8)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9044)PXMIN,PXMAX,PYMIN,PYMAX
 9044   FORMAT('PXMIN,PXMAX,PYMIN,PYMAX= ',4E15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9045)FX1MIN,FX1MAX,FY1MIN,FY1MAX
 9045   FORMAT('FX1MIN,FX1MAX,FY1MIN,FY1MAX= ',4E15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9046)FXMIN,FXMAX,FYMIN,FYMAX
 9046   FORMAT('FXMIN,FXMAX,FYMIN,FYMAX= ',4E15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9052)IPATTT,JPATTT
 9052   FORMAT('IPATTT,JPATTT = ',A4,I8)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9053)PTHICK,JTHICK,PTHIC2
 9053   FORMAT('PTHICK,JTHICK,PTHIC2 = ',E15.7,I8,E15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9054)ICOL,JCOL,IDIR
 9054   FORMAT('ICOL,JCOL,IDIR = ',A4,I8,2X,A4)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
      RETURN
      END
      SUBROUTINE D3DRTR(XRAW,YRAW,ZRAW,PX,PY,PZ,NP,PY2,PX2,NP2,
     1                  PY3,PX3,NP3,
     1                  ICASPL,ICAS3D,ISORSW,
     1                  ILI2PA,ILI2CO,ILI2CR,ILI2CG,ILI2CB,PLI2TH,
     1                  ARE2BA,IRE2FS,IRE2FC,IRE2FR,IRE2FG,IRE2FB,
     1                  IRE2PT,IRE2PL,IRE2PC,IRE2PR,IRE2PG,IRE2PB,
     1                  PRE2PT,PRE2PS,
     1                  PXMIN,PXMAX,PYMIN,PYMAX,
     1                  FX1MIN,FX1MAX,FY1MIN,FY1MAX,
     1                  IX1TSC,IY1TSC)
C
C     PURPOSE--FOR A GENERAL GRAPHICS DEVICE,
C              DRAW A SINGLE TRACE OF Y(.) VERSUS X(.)
C              FOR A SPECIFIED LINE TYPE, COLOR, AND THICKNESS.
C              AND (IF CALLED FOR) FILL IN BELOW/ABOVE THE TRACE
C              TO THE BASE LINE ARE2BA.
C     NOTE--THE VARIABLES PY(.) AND PX(.) ARE DUMMY VARIABLES
C           WHICH ARE USED IN THE INTERMEDIATE CALCULATIONS
C           AND WHOSE DIMENSIONS ARE DEFINED (FOR EASY OF CHANGE)
C           BACK IN THE MAIN ROUTINE.
C
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--83.6
C     ORIGINAL VERSION (AS A SEPARATE SUBROUTINE)--MAY       1983.
C     UPDATED         --FEBRUARY  1988. STAR PLOT
C     UPDATED         --SEPTEMBER 1988. LOG/WEIBULL CHECK AS A SUBROUTINE
C     UPDATED         --SEPTEMBER 1988. RENUMBER
C     UPDATED         --AUGUST    1992. CALL TO DPFIRE
C     UPDATED         --JULY      1993. NORMAL SCALE (JJF)
C     UPDATED         --OCTOBER   2020. SUPPORT FOR RGB COLOR
C
C-----NON-COMMON VARIABLES (GRAPHICS)-------------------------------------------
C
      CHARACTER*4 ICASPL
      CHARACTER*4 ICAS3D
      CHARACTER*4 ISORSW
C
      CHARACTER*4 ILI2PA
      CHARACTER*4 ILI2CO
C
      CHARACTER*4 IRE2FS
      CHARACTER*4 IRE2FC
      CHARACTER*4 IRE2PT
      CHARACTER*4 IRE2PL
      CHARACTER*4 IRE2PC
C
      CHARACTER*4 IX1TSC
      CHARACTER*4 IY1TSC
C
      CHARACTER*4 IFIG
      CHARACTER*4 IPATT
      CHARACTER*4 ICOL
C
      CHARACTER*4 ICOLF
      CHARACTER*4 ICOLP
C
      CHARACTER*4 ICASAX
C
CCCCC AUGUST 1992.
      CHARACTER*4 IPATT2
C
      DIMENSION XRAW(*)
      DIMENSION YRAW(*)
      DIMENSION ZRAW(*)
      DIMENSION PX(*)
      DIMENSION PY(*)
      DIMENSION PZ(*)
      DIMENSION PY2(*)
      DIMENSION PX2(*)
      DIMENSION PY3(*)
      DIMENSION PX3(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOGR.INC'
      INCLUDE 'DPCOBE.INC'
      INCLUDE 'DPCO3D.INC'
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      HOLD=1.0
      ABASE=0.0
      PBASE=0.0
      PBASE2=0.0
      PLEFT=0.0
      PRIGHT=0.0
      AWIDTH=0.0
      PWIDTH=0.0
      FYRATI=0.0
      FXMIN=FX1MIN
      FXMAX=FX1MAX
      FYMIN=FY1MIN
      FYMAX=FY1MAX
      AHUNDR=100.0
      ABASE2=0.0
C
      IF(IBUGG4.EQ.'ON' .OR. ISUBG4.EQ.'DRTR')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,51)
   51   FORMAT('***** AT THE BEGINNING OF D3DRTR--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,52)ISORSW,ICASPL,ICAS3D,NP,NP3
   52   FORMAT('ISORSW,ICASPL,ICAS3D,NP,NP3 = ',3(A4,2X),2I8)
        CALL DPWRST('XXX','BUG ')
        DO45I=1,NP3
          WRITE(ICOUT,46)I,PX3(I),PY3(I)
   46     FORMAT('I,PX3(I),PY3(I) = ',I8,2G15.7)
          CALL DPWRST('XXX','BUG ')
   45   CONTINUE
        IF(NP.GT.3)THEN
          DO65I=1,3
            WRITE(ICOUT,66)I,XRAW(I),YRAW(I),ZRAW(I)
   66       FORMAT('I,XRAW(I),YRAW(I),ZRAW(I) = ',I8,3G15.7)
            CALL DPWRST('XXX','BUG ')
   65     CONTINUE
          NPM2=NP-2
          DO67I=NPM2,NP
            WRITE(ICOUT,68)I,XRAW(I),YRAW(I),ZRAW(I)
   68       FORMAT('I,XRAW(I),YRAW(I),ZRAW(I) = ',I8,3G15.7)
            CALL DPWRST('XXX','BUG ')
   67     CONTINUE
        ENDIF
        WRITE(ICOUT,71)ILI2PA,ILI2CO,PLI2TH,ILI2CR,ILI2CG,ILI2CB
   71   FORMAT('ILI2PA,ILI2CO,PLI2TH,ILI2CR,ILI2CG,ILI2CB = ',
     1         A4,2X,A4,G15.7,3I6)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,73)IRE2FS,IRE2FC,ARE2BA
   73   FORMAT('IRE2FS,IRE2FC,ARE2BA = ',2(A4,2X),G15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,74)IRE2PT,IRE2PL,IRE2PC,PRE2PT,PRE2PS
   74   FORMAT('IRE2PT,IRE2PL,IRE2PC,PRE2PT,PRE2PS = ',
     1         3(A4,2X),2E15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,84)PXMIN,PXMAX,PYMIN,PYMAX
   84   FORMAT('PXMIN,PXMAX,PYMIN,PYMAX= ',4G15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,85)FX1MIN,FX1MAX,FY1MIN,FY1MAX
   85   FORMAT('FX1MIN,FX1MAX,FY1MIN,FY1MAX= ',4G15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,86)IX1TSC,IY1TSC
   86   FORMAT('IX1TSC,IY1TSC = ',A4,2X,A4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,89)IBUGG4,ISUBG4,IERRG4
   89   FORMAT('IBUGG4,ISUBG4,IERRG4 = ',2(A4,2X),A4)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
C               *************************************************
C               **  STEP 11--                                  **
C               **  IF CALLED FOR, SORT THE DATA               **
C               **  ACCORDING TO THE HORIZONTAL AXIS VARIABLE  **
C               *************************************************
C               ******************************************
C               **  STEP 41--                           **
C               **  IF A LOG SCALE PLOT IS CALLED FOR,  **
C               **  TRANSFORM THE DATA                  **
C               ******************************************
C
C               ******************************************
C               **  STEP 42--                           **
C               **  IF A WEIBULL SCALE PLOT IS CALLED   **
C               **  FOR TRANSFORM THE DATA              **
C               ******************************************
C
C               ******************************************
C               **  STEP 43--                           **
C               **  IF A NORMAL  SCALE PLOT IS CALLED   **
C               **  FOR TRANSFORM THE DATA              **
C               ******************************************
C
      IF(ISORSW.EQ.'OFF'  .OR. ICASPL.EQ.'PIEC' .OR.
     1   ICASPL.EQ.'STAR' .OR. ICAS3D.EQ.'ON'   .OR.
     1   ICASPL.EQ.'CONT')THEN
        DO1160I=1,NP
          PX(I)=XRAW(I)
          PY(I)=YRAW(I)
          PZ(I)=ZRAW(I)
 1160   CONTINUE
      ENDIF
C
C               **********************************************************
C               **  STEP 21--                                           **
C               **  IF A NON-LINEAR SCALE PLOT IS CALLED FOR,           **
C               **  CHECK THAT ALL   HORIZ. AXIS DATA POINTS            **
C               **  ARE IN VALID RANGE.                                 **
C               **  IF A LOG SCALE PLOT IS CALLED FOR,                  **
C               **  CHECK THAT ALL   HORIZ.  AXIS DATA POINTS ARE > 0.  **
C               **  IF A WEIBULL SCALE PLOT IS CALLED FOR,              **
C               **  CHECK THAT ALL   HORIZ. AXIS DATA POINTS ARE        **
C               **  IF A NORMAL SCALE PLOT IS CALLED FOR,              **
C               **  CHECK THAT ALL   HORIZ. AXIS DATA POINTS ARE        **
C               **  STRICTLY > 0 AND STRICTLY < 100                     **
C               **********************************************************
C
      IF(IX1TSC.EQ.'LOG')THEN
        ICASAX='2DHO'
        CALL CKLOSC(PX,NP,ISORSW,ICASAX,ISUBG4,IBUGG4,IERRG4)
        IF(IERRG4.EQ.'YES')GOTO9000
        DO4115I=1,NP
          PX(I)=LOG10(PX(I))
 4115   CONTINUE
      ELSEIF(IX1TSC.EQ.'WEIB')THEN
        ICASAX='2DHO'
        DO4215I=1,NP
          PX(I)=LOG(LOG(AHUNDR/(AHUNDR-PX(I))))
 4215   CONTINUE
      ELSEIF(IX1TSC.EQ.'NORM')THEN
        ICASAX='2DHO'
        DO4315I=1,NP
          CALL NORCDF(PX(I),ATEMP)
          PX(I)=AHUNDR*ATEMP
 4315   CONTINUE
      ENDIF
C
C               **********************************************************
C               **  STEP 22--                                           **
C               **  IF A NON-LINEAR SCALE PLOT IS CALLED FOR,           **
C               **  CHECK THAT ALL   VERT.  AXIS DATA POINTS            **
C               **  ARE IN VALID RANGE.                                 **
C               **  IF A LOG SCALE PLOT IS CALLED FOR,                  **
C               **  CHECK THAT ALL   VERT.   AXIS DATA POINTS ARE > 0.  **
C               **  IF A WEIBULL SCALE PLOT IS CALLED FOR,              **
C               **  CHECK THAT ALL   VERT.  AXIS DATA POINTS ARE        **
C               **  STRICTLY > 0 AND STRICTLY < 100                     **
C               **  IF A NORMAL  SCALE PLOT IS CALLED FOR,              **
C               **  CHECK THAT ALL   VERT.  AXIS DATA POINTS ARE        **
C               **  STRICTLY > 0 AND STRICTLY < 100                     **
C               **********************************************************
C
      ABASE=ARE2BA
      IF(IY1TSC.EQ.'LOG')THEN
        ICASAX='2DVE'
        CALL CKLOSC(PY,NP,ISORSW,ICASAX,ISUBG4,IBUGG4,IERRG4)
        IF(IERRG4.EQ.'YES')GOTO9000
        IF(ABASE.NE.CPUMAX.AND.ABASE.GT.0.0)ABASE=LOG10(ABASE)
        IF(ABASE.NE.CPUMAX.AND.ABASE.LE.0.0)ABASE=1.0
        DO4125I=1,NP
          PY(I)=LOG10(PY(I))
 4125   CONTINUE
      ELSEIF(IY1TSC.EQ.'WEIB')THEN
        ICASAX='2DVE'
        IF(ABASE.NE.CPUMAX.AND.ABASE.GT.0.0.AND.ABASE.LT.AHUNDR)
     1     ABASE2=LOG(LOG(AHUNDR/(AHUNDR-ABASE)))
        IF(ABASE.NE.CPUMAX.AND.ABASE.LE.0.0)ABASE2=0.1
        IF(ABASE.NE.CPUMAX.AND.ABASE.GE.AHUNDR)ABASE2=0.1
        ABASE=ABASE2
        DO4225I=1,NP
          PY(I)=LOG(LOG(AHUNDR/(AHUNDR-PY(I))))
 4225   CONTINUE
      ELSEIF(IY1TSC.EQ.'NORM')THEN
        ICASAX='2DVE'
        CALL NORCDF(ABASE,ATEMP)
        IF(ABASE.NE.CPUMAX.AND.ABASE.GT.0.0.AND.ABASE.LT.AHUNDR)
     1     ABASE2=AHUNDR*ATEMP
        IF(ABASE.NE.CPUMAX.AND.ABASE.LE.0.0)ABASE2=0.1
        IF(ABASE.NE.CPUMAX.AND.ABASE.GE.AHUNDR)ABASE2=0.1
        ABASE=ABASE2
        DO4325I=1,NP
          CALL NORCDF(PY(I),ATEMP)
          PY(I)=AHUNDR*ATEMP
 4325   CONTINUE
      ENDIF
C
C               **************************************************
C               **  STEP 51--                                   **
C               **  FORM THE TRACE IN RAW 3-D SPACE.            **
C               **************************************************
C
C               **************************************************
C               **  STEP 52--                                   **
C               **  IF HIDDEN LINE REMOVAL IS ON,               **
C               **  DETERMINE IF ANY PART                       **
C               **  OF THE TRACE IS VISIBLE;                    **
C               **  FORM SUBTRACES.                             **
C               **************************************************
C
C               **************************************************
C               **  STEP 53--                                   **
C               **  TRANSLATE THE VISIBLE SUB-TRACES            **
C               **  FROM THE RAW 3-D SPACE                      **
C               **  TO THE FINAL VISUAL 2-D PLANE.              **
C               **************************************************
C
      CALL D3TR32(PX,PY,PZ,NP,PX,PY,NP)
C
C               *****************************************************
C               **  STEP 54--                                      **
C               **  TRANSLATE THE 2-D PLANE DATA POINTS            **
C               **  INTO STANDARDIZED (0.0 TO 100.0) COORDINATES.  **
C               *****************************************************
C
      FXMIN=FX1MIN
      FXMAX=FX1MAX
      CALL NORCDF(FX1MIN,ATEMP)
      IF(IX1TSC.EQ.'LOG')THEN
        FXMIN=LOG10(FX1MIN)
        FXMAX=LOG10(FX1MAX)
      ELSEIF(IX1TSC.EQ.'WEIB')THEN
        FXMIN=LOG(LOG(AHUNDR/(AHUNDR-FX1MIN)))
        FXMAX=LOG(LOG(AHUNDR/(AHUNDR-FX1MAX)))
      ELSEIF(IX1TSC.EQ.'NORM')THEN
        FXMIN=AHUNDR*ATEMP
        CALL NORCDF(FX1MAX,ATEMP)
        FXMAX=AHUNDR*ATEMP
      ENDIF
C
      FYMIN=FY1MIN
      FYMAX=FY1MAX
      CALL NORCDF(FY1MIN,ATEMP)
      IF(IY1TSC.EQ.'LOG')THEN
        FYMIN=LOG10(FY1MIN)
        FYMAX=LOG10(FY1MAX)
      ELSEIF(IY1TSC.EQ.'WEIB')THEN
        FYMIN=LOG(LOG(AHUNDR/(AHUNDR-FY1MIN)))
        FYMAX=LOG(LOG(AHUNDR/(AHUNDR-FY1MAX)))
      ELSEIF(IY1TSC.EQ.'NORM')THEN
        FYMIN=AHUNDR*ATEMP
        CALL NORCDF(FY1MAX,ATEMP)
        FYMAX=AHUNDR*ATEMP
      ENDIF
C
      FXRANG=FXMAX-FXMIN
      FYRANG=FYMAX-FYMIN
      PXRANG=PXMAX-PXMIN
      PYRANG=PYMAX-PYMIN
C
      DO5410I=1,NP
        FXRATI=(PX(I)-FXMIN)/FXRANG
        FYRATI=(PY(I)-FYMIN)/FYRANG
        PX(I)=PXMIN+FXRATI*PXRANG
        PY(I)=PYMIN+FYRATI*PYRANG
 5410 CONTINUE
      IF(ABASE.NE.CPUMAX)FYRATI=(ABASE-FYMIN)/FYRANG
      IF(ABASE.NE.CPUMAX)PBASE=PYMIN+FYRATI*PYRANG
C
C               **************************************
C               **  STEP 60--                       **
C               **  IF CALLED FOR,                  **
C               **  FILL OVER/UNDER THE TRACE       **
C               **  (BUT CLIP FIRST, IF NECESSARY)  **
C               **************************************
C
      IFIG='GENE'
C
      IF(IRE2FS.EQ.'OFF')GOTO6190
      IPATT=IRE2PT
      PTHICK=PRE2PT
      PXGAP=PRE2PS
      PYGAP=PRE2PS
      ICOLF=IRE2FC
      ICOLFR=IRE2FR
      ICOLFG=IRE2FG
      ICOLFB=IRE2FB
      ICOLP=IRE2PC
      ICOLPR=IRE2PR
      ICOLPG=IRE2PG
      ICOLPB=IRE2PB
      IPATT2='SOLI'
C
      CALL DPSQUE(PX,PY,NP,PXMIN,PXMAX,PYMIN,PYMAX)
C
      IF(ABASE.EQ.CPUMAX)GOTO6110
      GOTO6120
C
 6110 CONTINUE
      DO6115I=1,NP
        PX2(I)=PX(I)
        PY2(I)=PY(I)
 6115 CONTINUE
      NP2=NP+1
      PX2(NP2)=PX(1)
      PY2(NP2)=PY(1)
C
      DO6116J=1,NP2
        IF(PX2(J).LT.PXMIN)PX2(J)=PXMIN
        IF(PX2(J).GT.PXMAX)PX2(J)=PXMAX
        IF(PY2(J).LT.PYMIN)PY2(J)=PYMIN
        IF(PY2(J).GT.PYMAX)PY2(J)=PYMAX
 6116 CONTINUE
C
      CALL DPFIRE(PX2,PY2,NP2,
     1            IFIG,IPATT,PTHICK,PXGAP,PYGAP,
     1            ICOLF,ICOLFR,ICOLFG,ICOLFB,
     1            ICOLP,ICOLPR,ICOLPG,ICOLPB,
     1            IPATT2)
C
      GOTO6190
C
 6120 CONTINUE
      PBASE2=PBASE
      IF(PBASE2.LT.PYMIN.AND.(PYMIN-PBASE2).LE.0.0001)PBASE2=PYMIN
      IF(PBASE2.GT.PYMAX.AND.(PBASE2-PYMAX).LE.0.0001)PBASE2=PYMAX
C
      NP2=5
      NPM1=NP-1
      IF(NPM1.LE.0)GOTO6190
      DO6125I=1,NPM1
        IP1=I+1
C
        PLEFT=PX(I)
        PRIGHT=PX(IP1)
        IF(PLEFT.LT.PXMIN.AND.(PXMIN-PLEFT).LE.0.0001)PLEFT=PXMIN
        IF(PRIGHT.GT.PXMAX.AND.(PRIGHT-PXMAX).LE.0.0001)PRIGHT=PXMAX
C
        IF(PRIGHT.LT.PXMIN)GOTO6125
        IF(PLEFT.GT.PXMAX)GOTO6125
        IF(PY(I).LT.PYMIN.AND.PBASE2.LT.PYMIN)GOTO6125
        IF(PY(I).GT.PYMAX.AND.PBASE2.GT.PYMAX)GOTO6125
C
        PX2(1)=PLEFT
        PX2(2)=PRIGHT
        PX2(3)=PRIGHT
        PX2(4)=PLEFT
        PX2(5)=PLEFT
C
        PY2(1)=PBASE2
        PY2(2)=PBASE2
        PY2(3)=PY(IP1)
        PY2(4)=PY(I)
        PY2(5)=PBASE2
C
        DO6126J=1,NP2
          IF(PX2(J).LT.PXMIN)PX2(J)=PXMIN
          IF(PX2(J).GT.PXMAX)PX2(J)=PXMAX
          IF(PY2(J).LT.PYMIN)PY2(J)=PYMIN
          IF(PY2(J).GT.PYMAX)PY2(J)=PYMAX
 6126   CONTINUE
C
        CALL DPFIRE(PX2,PY2,NP2,
     1              IFIG,IPATT,PTHICK,PXGAP,PYGAP,
     1              ICOLF,ICOLFR,ICOLFG,ICOLBB,
     1              ICOLP,ICOLPR,ICOLPG,ICOLPB,
     1              IPATT2)
 6125 CONTINUE
C
      GOTO6190
C
 6190 CONTINUE
C
C               *****************************************
C               **  STEP 70--                          **
C               **  DRAW OUT THE TRACE                 **
C               **  (BUT CLIP IT FIRST, IF NECESSARY)  **
C               *****************************************
C
      IFIG='GENE'
      IPATT=ILI2PA
      PTHICK=PLI2TH
      ICOL=ILI2CO
      ICOLR=ILI2CR
      ICOLG=ILI2CG
      ICOLB=ILI2CB
C
CCCCC PX3 AND PY3 COMMENTED OUT IN DPCLTR, SO TREAT AS
CCCCC SCALAR HERE FOR NOW.
C
      CALL DPCLTR(PX,PY,NP,PX2,PY2,NP2,
     1            PXMIN,PXMAX,PYMIN,PYMAX,
     1            ISORSW,IFIG,IPATT,PTHICK,
     1            ICOL,ICOLR,ICOLG,ICOLB)
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT       **
C               *****************
C
 9000 CONTINUE
      IF(IBUGG4.EQ.'ON' .OR. ISUBG4.EQ.'DRTR')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9011)
 9011   FORMAT('***** AT THE END       OF D3DRTR--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9032)ARE2BA
 9032   FORMAT('ARE2BA = ',G15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9046)FXMIN,FXMAX,FYMIN,FYMAX
 9046   FORMAT('FXMIN,FXMAX,FYMIN,FYMAX= ',4E15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9049)IBUGG4,ISUBG4,IERRG4
 9049   FORMAT('IBUGG4,ISUBG4,IERRG4 = ',A4,2X,A4,2X,A4)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
      RETURN
      END
      SUBROUTINE D3MKBA(XRAW,YRAW,ZRAW,NRAW,IRAW,IDIR,
     1                  WIDTHX,WIDTHY,WIDTHZ,
     1                  BASEX,BASEY,BASEZ,
     1                  XVECT,YVECT,ZVECT,IXNEAR,IXFAR,IYNEAR,IYFAR,
     1                  IZNEAR,IZFAR,
     1                  XBAR,YBAR,ZBAR,NBAR)
C
C     PURPOSE--GIVEN A SINGLE POINT (XRAW(IRAW),YRAW(IRAW),ZRAW(IRAW))
C              IN 3-SPACE, AND AN EYE POSITION,
C              MAKE (= CONSTRUCT) A 3-D BAR.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISIONBAR
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--88/10
C     ORIGINAL VERSION--SEPTEMBER 1988.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 IDIR
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
C
C---------------------------------------------------------------------
C
      DIMENSION XRAW(*)
      DIMENSION YRAW(*)
      DIMENSION ZRAW(*)
C
      DIMENSION XVECT(*)
      DIMENSION YVECT(*)
      DIMENSION ZVECT(*)
C
      DIMENSION XBAR(*)
      DIMENSION YBAR(*)
      DIMENSION ZBAR(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOBE.INC'
      INCLUDE 'DPCO3D.INC'
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='D3MK'
      ISUBN2='BA  '
C
      IF(IBUGG4.NE.'ON'.AND.ISUBG4.NE.'MKBA')GOTO90
      WRITE(ICOUT,999)
  999 FORMAT(1X)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,51)
   51 FORMAT('***** AT THE BEGINNING OF D3MKBA--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,52)IBUGG4,ISUBG4,IERRG4
   52 FORMAT('IBUGG4,ISUBG4,IERRG4 = ',3A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,53)IDIR
   53 FORMAT('IDIR = ',A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,54)WIDTHX,WIDTHY,WIDTHZ
   54 FORMAT('WIDTHX,WIDTHY,WIDTHZ = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,55)BASEX,BASEY,BASEZ
   55 FORMAT('BASEX,BASEY,BASEZ    = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,56)X3DEYE,Y3DEYE,Z3DEYE
   56 FORMAT('X3DEYE,Y3DEYE,Z3DEYE    = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,61)XVECT(1),YVECT(1),ZVECT(1)
   61 FORMAT('XVECT(1),YVECT(1),ZVECT(1) = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,62)XVECT(2),YVECT(2),ZVECT(2)
   62 FORMAT('XVECT(2),YVECT(2),ZVECT(2) = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,63)IXNEAR,IXFAR,IYNEAR,IYFAR,IZNEAR,IZFAR
   63 FORMAT('IXNEAR,IXFAR,IYNEAR,IYFAR,IZNEAR,IZFAR = ',6I8)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,71)NRAW,IRAW
   71 FORMAT('NRAW,IRAW = ',2I8)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,72)IRAW,XRAW(IRAW),YRAW(IRAW),ZRAW(IRAW)
   72 FORMAT('IRAW,XRAW(IRAW),YRAW(IRAW),ZRAW(IRAW) = ',I8,3E15.7)
      CALL DPWRST('XXX','BUG ')
   90 CONTINUE
C
C               **************************************************
C               **  MAKE (= CONSTRUCT) A BAR.                 **
C               **************************************************
C
C               **************************************************
C               **  STEP 11-                                    **
C               **  FIND THE NEAREST (TO THE EYE) VERTEX        **
C               **  OF OF THE 8 VERTICES OF THE 3-D BAR         **
C               **************************************************
C
      X0=XRAW(IRAW)
      Y0=YRAW(IRAW)
      Z0=ZRAW(IRAW)
C
      IF(IDIR.EQ.'V')GOTO1110
      IF(IDIR.EQ.'H1')GOTO1120
      IF(IDIR.EQ.'H2')GOTO1130
      GOTO1110
C
 1110 CONTINUE
      XVECT(1)=X0-WIDTHX/2.0
      XVECT(2)=X0+WIDTHX/2.0
      YVECT(1)=Y0-WIDTHY/2.0
      YVECT(2)=Y0+WIDTHY/2.0
      ZVECT(1)=BASEZ
      ZVECT(2)=Z0
      GOTO1150
C
 1120 CONTINUE
      XVECT(1)=BASEX
      XVECT(2)=X0
      YVECT(1)=Y0-WIDTHY/2.0
      YVECT(2)=Y0+WIDTHY/2.0
      ZVECT(1)=Z0-WIDTHZ/2.0
      ZVECT(2)=Z0+WIDTHZ/2.0
      GOTO1150
C
 1130 CONTINUE
      XVECT(1)=X0-WIDTHX/2.0
      XVECT(2)=X0+WIDTHX/2.0
      YVECT(1)=BASEY
      YVECT(2)=Y0
      ZVECT(1)=Z0-WIDTHZ/2.0
      ZVECT(2)=Z0+WIDTHZ/2.0
      GOTO1150
C
 1150 CONTINUE
C
      DISTSQ=CPUMAX
      DO1151IX=1,2
      XVECT2=XVECT(IX)
      DO1152IY=1,2
      YVECT2=YVECT(IY)
      DO1153IZ=1,2
      ZVECT2=ZVECT(IZ)
      DISTS2=(XVECT2-X3DEYE)**2+(YVECT2-Y3DEYE)**2+(ZVECT2-Z3DEYE)**2
      IF(DISTS2.LT.DISTSQ)GOTO1155
      GOTO1153
 1155 CONTINUE
      IXNEAR=IX
      IYNEAR=IY
      IZNEAR=IZ
 1153 CONTINUE
 1152 CONTINUE
 1151 CONTINUE
C
      IXFAR=1
      IF(IXNEAR.EQ.1)IXFAR=2
      IYFAR=1
      IF(IYNEAR.EQ.1)IYFAR=2
      IZFAR=1
      IF(IZNEAR.EQ.1)IZFAR=2
C
      XBAR(1)=XVECT(IXNEAR)
      XBAR(2)=XVECT(IXNEAR)
      XBAR(3)=XVECT(IXNEAR)
      XBAR(4)=XVECT(IXNEAR)
      XBAR(5)=XVECT(IXNEAR)
      YBAR(1)=YVECT(IYNEAR)
      YBAR(2)=YVECT(IYNEAR)
      YBAR(3)=YVECT(IYFAR)
      YBAR(4)=YVECT(IYFAR)
      YBAR(5)=YVECT(IYNEAR)
      ZBAR(1)=ZVECT(IZNEAR)
      ZBAR(2)=ZVECT(IZFAR)
      ZBAR(3)=ZVECT(IZFAR)
      ZBAR(4)=ZVECT(IZNEAR)
      ZBAR(5)=ZVECT(IZNEAR)
C
      XBAR(6)=XVECT(IXNEAR)
      XBAR(7)=XVECT(IXFAR)
      XBAR(8)=XVECT(IXFAR)
      XBAR(9)=XVECT(IXNEAR)
      XBAR(10)=XVECT(IXNEAR)
      YBAR(6)=YVECT(IYNEAR)
      YBAR(7)=YVECT(IYNEAR)
      YBAR(8)=YVECT(IYNEAR)
      YBAR(9)=YVECT(IYNEAR)
      YBAR(10)=YVECT(IYNEAR)
      ZBAR(6)=ZVECT(IZNEAR)
      ZBAR(7)=ZVECT(IZNEAR)
      ZBAR(8)=ZVECT(IZFAR)
      ZBAR(9)=ZVECT(IZFAR)
      ZBAR(10)=ZVECT(IZNEAR)
C
      XBAR(11)=XVECT(IXNEAR)
      XBAR(12)=XVECT(IXNEAR)
      XBAR(13)=XVECT(IXFAR)
      XBAR(14)=XVECT(IXFAR)
      XBAR(15)=XVECT(IXNEAR)
      YBAR(11)=YVECT(IYNEAR)
      YBAR(12)=YVECT(IYFAR)
      YBAR(13)=YVECT(IYFAR)
      YBAR(14)=YVECT(IYNEAR)
      YBAR(15)=YVECT(IYNEAR)
      ZBAR(11)=ZVECT(IZNEAR)
      ZBAR(12)=ZVECT(IZNEAR)
      ZBAR(13)=ZVECT(IZNEAR)
      ZBAR(14)=ZVECT(IZNEAR)
      ZBAR(15)=ZVECT(IZNEAR)
C
      NBAR=15
C
C               *****************
C               **  EXIT.      **
C               *****************
C
      IF(IBUGG4.NE.'ON'.AND.ISUBG4.NE.'MKBA')GOTO9090
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9011)
 9011 FORMAT('***** AT THE END       OF D3MKBA--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9012)IBUGG4,ISUBG4,IERRG4
 9012 FORMAT('IBUGG4,ISUBG4,IERRG4 = ',3A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9013)IDIR
 9013 FORMAT('IDIR = ',A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9014)WIDTHX,WIDTHY,WIDTHZ
 9014 FORMAT('WIDTHX,WIDTHY,WIDTHZ = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9015)BASEX,BASEY,BASEZ
 9015 FORMAT('BASEX,BASEY,BASEZ    = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9016)X3DEYE,Y3DEYE,Z3DEYE
 9016 FORMAT('X3DEYE,Y3DEYE,Z3DEYE    = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9021)XVECT(1),YVECT(1),ZVECT(1)
 9021 FORMAT('XVECT(1),YVECT(1),ZVECT(1) = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9022)XVECT(2),YVECT(2),ZVECT(2)
 9022 FORMAT('XVECT(2),YVECT(2),ZVECT(2) = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9023)IXNEAR,IXFAR,IYNEAR,IYFAR,IZNEAR,IZFAR
 9023 FORMAT('IXNEAR,IXFAR,IYNEAR,IYFAR,IZNEAR,IZFAR = ',6I8)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9031)NRAW,IRAW
 9031 FORMAT('NRAW,IRAW = ',2I8)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9032)IRAW,XRAW(IRAW),YRAW(IRAW),ZRAW(IRAW)
 9032 FORMAT('IRAW,XRAW(IRAW),YRAW(IRAW),ZRAW(IRAW) = ',I8,3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9041)NBAR
 9041 FORMAT('NBAR = ',I8)
      CALL DPWRST('XXX','BUG ')
      DO9042I=1,NBAR
      WRITE(ICOUT,9043)I,XBAR(I),YBAR(I),ZBAR(I)
 9043 FORMAT('I,XBAR(I),YBAR(I),ZBAR(I) = ',I8,3E15.7)
      CALL DPWRST('XXX','BUG ')
 9042 CONTINUE
 9090 CONTINUE
C
      RETURN
      END
      SUBROUTINE D3MKSP(XRAW,YRAW,ZRAW,NRAW,IRAW,
     1IDIR,
     1BASEX,BASEY,BASEZ,
     1XSPIKE,YSPIKE,ZSPIKE,NSPIKE)
C
C     PURPOSE--GIVEN A SINGLE POINT (XRAW(IRAW),YRAW(IRAW),ZRAW(IRAW))
C              IN 3-SPACE,
C              MAKE (= CONSTRUCT) A 3-D SPIKE.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISIONSPIKE
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--88/10
C     ORIGINAL VERSION--SEPTEMBER 1988.
C     UPDATED         --APRIL   1992.  BASE2 TO BASEX/Y/Z
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 IDIR
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
C
C---------------------------------------------------------------------
C
      DIMENSION XRAW(*)
      DIMENSION YRAW(*)
      DIMENSION ZRAW(*)
C
      DIMENSION XSPIKE(*)
      DIMENSION YSPIKE(*)
      DIMENSION ZSPIKE(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOBE.INC'
      INCLUDE 'DPCO3D.INC'
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='D3MK'
      ISUBN2='SP  '
C
      IF(IBUGG4.NE.'ON'.AND.ISUBG4.NE.'MKSP')GOTO90
      WRITE(ICOUT,999)
  999 FORMAT(1X)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,51)
   51 FORMAT('***** AT THE BEGINNING OF D3MKSP--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,52)IBUGG4,ISUBG4,IERRG4
   52 FORMAT('IBUGG4,ISUBG4,IERRG4 = ',3A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,53)NRAW,IRAW
   53 FORMAT('NRAW,IRAW = ',2I8)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,61)IDIR
   61 FORMAT('IDIR = ',A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,62)BASEX,BASEY,BASEZ
   62 FORMAT('BASEX,BASEY,BASEZ = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,63)IRAW,XRAW(IRAW),YRAW(IRAW),ZRAW(IRAW)
   63 FORMAT('IRAW,XRAW(IRAW),YRAW(IRAW),ZRAW(IRAW) = ',I8,3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,71)X3DEYE,Y3DEYE,Z3DEYE
   71 FORMAT('X3DEYE,Y3DEYE,Z3DEYE = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
   90 CONTINUE
C
C               **************************************************
C               **  STEP 11-                                    **
C               **  MAKE (= CONSTRUCT) A SPIKE.                 **
C               **************************************************
C
      IF(IDIR.EQ.'V')GOTO1110
      IF(IDIR.EQ.'HX')GOTO1120
      IF(IDIR.EQ.'HY')GOTO1130
      GOTO1110
C
 1110 CONTINUE
      XSPIKE(1)=XRAW(IRAW)
      YSPIKE(1)=YRAW(IRAW)
CCCCC THE FOLLOWING LINE WAS FIXED    APRIL 1992 (ALAN)
CCCCC ZSPIKE(1)=BASE2
      ZSPIKE(1)=BASEZ
      GOTO1150
C
 1120 CONTINUE
CCCCC THE FOLLOWING LINE WAS FIXED    APRIL 1992 (ALAN)
CCCCC XSPIKE(1)=BASE2
      XSPIKE(1)=BASEX
      YSPIKE(1)=YRAW(IRAW)
      ZSPIKE(1)=ZRAW(IRAW)
      GOTO1150
C
 1130 CONTINUE
      XSPIKE(1)=XRAW(IRAW)
CCCCC THE FOLLOWING LINE WAS FIXED    APRIL 1992 (ALAN)
CCCCC YSPIKE(1)=BASE2
      YSPIKE(1)=BASEY
      ZSPIKE(1)=ZRAW(IRAW)
      GOTO1150
C
 1150 CONTINUE
C
      XSPIKE(2)=XRAW(IRAW)
      YSPIKE(2)=YRAW(IRAW)
      ZSPIKE(2)=ZRAW(IRAW)
C
      NSPIKE=2
C
C               *****************
C               **  EXIT.      **
C               *****************
C
      IF(IBUGG4.NE.'ON'.AND.ISUBG4.NE.'MKSP')GOTO9090
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9011)
 9011 FORMAT('***** AT THE END       OF D3MKSP--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9012)IBUGG4,ISUBG4,IERRG4
 9012 FORMAT('IBUGG4,ISUBG4,IERRG4 = ',3A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9013)IDIR
 9013 FORMAT('IDIR = ',A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9014)BASEX,BASEY,BASEZ
 9014 FORMAT('BASEX,BASEY,BASEZ = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9021)NRAW,IRAW
 9021 FORMAT('NRAW,IRAW = ',2I8)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9022)IRAW,XRAW(IRAW),YRAW(IRAW),ZRAW(IRAW)
 9022 FORMAT('IRAW,XRAW(IRAW),YRAW(IRAW),ZRAW(IRAW) = ',I8,3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9031)X3DEYE,Y3DEYE,Z3DEYE
 9031 FORMAT('X3DEYE,Y3DEYE,Z3DEYE = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9041)NSPIKE
 9041 FORMAT('NSPIKE = ',I8)
      CALL DPWRST('XXX','BUG ')
      DO9042I=1,NSPIKE
      WRITE(ICOUT,9043)I,XSPIKE(I),YSPIKE(I),ZSPIKE(I)
 9043 FORMAT('I,XSPIKE(I),YSPIKE(I),ZSPIKE(I) = ',I8,3E15.7)
      CALL DPWRST('XXX','BUG ')
 9042 CONTINUE
 9090 CONTINUE
C
      RETURN
      END
      SUBROUTINE D3SCAL(PX,PY,NP)
C
C     PURPOSE--EXECUTE A SCALING AND TRANSLATION
C      OF 3D POINTS THAT HAVE ALREADY
C     BEEN TRANSLATED INTO 2D VALUES
C     BUT NOW NEED TO BE SCALED AND TRANSLATED
C     TO PROPER 0 TO 100 SCREEN VALUES.
C     WRITTEN BY--JAMES J. FILLIBEN
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--93/10
C     ORIGINAL VERSION--SEPTEMBER 1993.
C     ORIGINAL VERSION (AS A SEPARATE SUBROUTINE)--SEPTEMBER 1993.
C
C-----COMMON STATEMENTS-----------------------------------------------
C
      INCLUDE 'DPCOPA.INC'
C
      INCLUDE 'DPCO3D.INC'
      INCLUDE 'DPCOPC.INC'
      INCLUDE 'DPCOBE.INC'
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
CCCCC CHARACTER*4 ISTEPN
C
C---------------------------------------------------------------------
C
      DIMENSION PX(*)
      DIMENSION PY(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='D3SC'
      ISUBN2='AL  '
C
      FXMIN=FX1MIN
      FXMAX=FX1MAX
      FYMIN=FY1MIN
      FYMAX=FY1MAX
C
      FXRANG=FXMAX-FXMIN
      FYRANG=FYMAX-FYMIN
      PXRANG=PXMAX-PXMIN
      PYRANG=PYMAX-PYMIN
C
      DO1000I=1,NP
      FXRATI=(PX(I)-FXMIN)/FXRANG
      FYRATI=(PY(I)-FYMIN)/FYRANG
      PX(I)=PXMIN+FXRATI*PXRANG
      PY(I)=PYMIN+FYRATI*PYRANG
 1000 CONTINUE
C
      RETURN
      END
      SUBROUTINE D3TR32(X,Y,Z,N,XT,ZT,NT)
C
C     PURPOSE--EXECUTE A 3-D TRANSFORMATION
C              (ORTHOGRAPHIC OR PERSPECTIVE)
C              WHICH TAKES A 3-D DATA CLOUD
C              AND MAPS IN ONTO A 2-D PLANE
C              (IDENTICALLY THE ORIGINAL XZ PLANE).
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--88/10
C     ORIGINAL VERSION--MARCH     1979.
C     ORIGINAL VERSION (AS A SEPARATE SUBROUTINE)--SEPTEMBER 1988.
C     UPDATE          --JUNE      1990.  COMPILE ERROR IN A WRITE STATEMENT
C
C-----COMMON STATEMENTS-----------------------------------------------
C
      INCLUDE 'DPCO3D.INC'
      INCLUDE 'DPCOBE.INC'
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
      CHARACTER*4 ISTEPN
C
C---------------------------------------------------------------------
C
      DIMENSION X(*)
      DIMENSION Y(*)
      DIMENSION Z(*)
      DIMENSION XT(*)
      DIMENSION ZT(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='D3TR'
      ISUBN2='32  '
      IERRG4='NO'
C
      EPS=0.0000001
      TERMZX=0.0
      TERMZY=0.0
      TERMZZ=0.0
      TERMXX=0.0
      TERMXY=0.0
      TERMXZ=0.0
C
      IF(IBUGG4.EQ.'OFF'.AND.ISUBG4.NE.'TR32')GOTO90
      WRITE(ICOUT,999)
  999 FORMAT(1X)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,51)
   51 FORMAT('***** AT THE BEGINNING OF D3TR32--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,52)IBUGG4,ISUBG4,IERRG4
   52 FORMAT('IBUGG4,ISUBG4,IERRG4 = ',A4,2X,A4,2X,A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,53)I3DPRO
   53 FORMAT('I3DPRO = ',A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,54)X3DEYE,Y3DEYE,Z3DEYE
   54 FORMAT('X3DEYE,Y3DEYE,Z3DEYE = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,55)X3DMID,Y3DMID,Z3DMID
   55 FORMAT('X3DMID,Y3DMID,Z3DMID = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,64)D3DCXX,D3DCXY,D3DCXZ
   64 FORMAT('D3DCXX,D3DCXY,D3DCXZ = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,65)D3DCYX,D3DCYY,D3DCYZ
   65 FORMAT('D3DCYX,D3DCYY,D3DCYZ = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,66)D3DCZX,D3DCZY,D3DCZZ
   66 FORMAT('D3DCZX,D3DCZY,D3DCZZ = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,71)N
   71 FORMAT('N = ',I8)
      CALL DPWRST('XXX','BUG ')
      DO72I=1,N
      WRITE(ICOUT,73)I,X(I),Y(I),Z(I)
   73 FORMAT('I,X(I),Y(I),Z(I) = ',I8,3E15.7)
      CALL DPWRST('XXX','BUG ')
   72 CONTINUE
   90 CONTINUE
C
C               *********************************************************
C               **  GENERAL DISCUSSION--                               **
C               **  DETERMINE (IN ORIGINAL COORDINATE SYSTEM VALUES)   **
C               **  WHERE THE DATA POINTS FALL ON THE VISUAL PLANE.    **
C               **  FOR EACH (XD,YD,ZD) DATA POINT,                    **
C               **  DETERMINE WHERE THE VISUAL RAY FROM                **
C               **  THE DATA POINT TO OUR EYE                          **
C               **  STRIKES THE VISUAL (PERSPECTIVE) PLANE.            **
C               **  THE VISUAL PLANE IS THAT PLANE                     **
C               **  WHICH IS NORMAL TO OUR EYE                         **
C               **  AND WHICH CONTAINS THE AVERAGE POINT (XM,YM,ZM).   **
C               **  THE EQUATION OF THE VISUAL PLANE IS                **
C               **  (X3DEYE-XM)(X-XM) + (Y3DEYE-YM)(Y-YM) +
C               **                    + (Z3DEYE-YM)(Z-ZM) = 0          **
C               **  WHERE X, Y, Z ARE THE DUMMY VARIABLES              **
C               **  REPRESENTING ANY POINT (X,Y,Z) ON THAT PLANE.      **
C               **  THIS EQUATION MUST BE SOLVED FOR X, Y, AND Z.      **
C               **  THE EQUATIONS OF THE LINE FROM THE DATA POINT
C               **  (XD,YD,ZD)
C               **  TO OUR EYE (X3DEYE,Y3DEYE,Z3DEYE) ARE
C               **  (X-XD)/(X3DEYE-XD) = (Y-YD)/(Y3DEYE-YD)
C               **                     = (Z-ZD)/(Z3DEYE-ZD)
C               **  WHERE (XD,YD,ZD) REPRESENTS A DATA POINT.           **
C               **  THE VISUAL PLANE EQUATION AND THE LINE EQUATIONS    **
C               **  MUST BE COMBINED TO SOLVE FOR THE VALUES (X,Y,Z)    **
C               **  ON THE VISUAL PLANE AS OUR EYE SEES THEM.           **
C               **********************************************************
C
C               **********************************************************
C               **  THE FINAL PLOT STATEMENT WILL INVOLVE
C               **  ONLY 2 VECTORS.
C               **  AT THE MOMENT, THE POINTS (XP,YP,ZP)
C               **  ON THE VISUAL PLANE ARE DEFINED
C               **  BY 3 COORDINATE VALUES.
C               **  TO REDUCE THE 3 COORDINATE VALUES
C               **  TO 2 COORDINATE VALUES,
C               **  WE MUST ROTATE THE VISUAL PLANE
C               **  SO THAT IT IS PARALLEL TO THE ORIGINAL XZ PLANE.
C               **  TO CARRY OUT SUCH A ROTATION, WE MUST
C               **  DETERMINE THE DIRECTION NUMBERS AND DIRECTION COSINES
C               **  OF THE NEW AXES IN TERMS OF THE OLD COORDINATE SYSTEM.
C               **  THE NEW Y AXIS WILL (BY CONSTRUCTION) BE
C               **  ON THE NORMAL LINE TRAVELING FROM
C               **  THE AVERAGE POINT (XM,YM,ZM) TO OUR EYE POINT
C               **  (X3DEYE,Y3DEYE,Z3DEYE)
C               **  AND WILL THEREFORE HAVE DIRECTIONS NUMBERS
C               **  X3DEYE, Y3DEYE, Z3DEYE
C               **  THE NEW Z AXIS WILL BE PERPENDICULAR TO THE NEW Y AXIS
C               **  AND WILL RESIDE IN THE PLANE CONTAINING THE
C               **  THE FOLLOWING 3 POINTS--
C               **      1) THE AVERAGE POINT (XM,YM,ZM)
C               **      2) THE EYE POINT (X3DEYE,Y3DEYE,Z3DEYE)
C               **      3) SOME POINT (SAY (XM,YM,ZM+1)) OF THE OLD Z AXIS
C               **         DISPLACED OVER SO AS TO EMANATE FROM (XM,YM,ZM).
C               **  THE ABOVE 3 POINTS DEFINE A VERTICAL PLANE.
C               **  THE PURPOSE OF THE VERTICAL PLANE IS TO DEFINE
C               **  WHICH DIRECTION IS 'UP' IN THE FINAL PICTURE.
C               **  THE EQUATION OF THE VERTICAL PLANE IS
C               **  (A-XM)(X-XM) + (B-YM)(Y-YM) + (C-ZM)(Z-ZM) = 0 .
C               **  THIS EQUATION MUST BE SOLVED FOR A, B, AND C.
C               **  WITHOUT LOSS OF GENERALITY, A MAY BE INITIALLY SET TO 1.
C               **  THE SOLUTION TURNS OUT TO BE
C               **      A = 1
C               **      B = -X3DEYE/Y3DEYE
C               **      C = 0
C               **  NOTE, HOWEVER, THAT THESE A, B, AND C VALUES
C               **  FOR THIS VERTICAL PLANE WILL BE IDENTICAL TO THE
C               **  DIRECTION NUMBERS FOR THE NORMAL TO THIS VERTICAL PLANE
C               **  WHICH IS IDENTICALLY THE NEW X AXIS
C               **  AND SO THE ABOVE A, B, AND C VALUES DEFINE THE DIRECTION
C               **  DIRECTION NUMBERS FOR THE NEW X AXIS.
C               **  TO SOLVE FOR THE DIRECTION NUMBERS FOR THE NEW Z AXIS,
C               **  WE SEEK 3 DIRECTION NUMBERS D, E, AND F
C               **  WHICH MUST BE PERPENDICULAR TO BOTH THE
C               **  NEW Y AXIS (WITH DIRECTION NUMBERS X3DEYE, Y3DEYE,
C               **  AND Z3DEYE)
C               **  AND THE NEW X AXIS (WITH DIRECTION NUMBERS A, B, AND C ABOVE
C               **  WITHOUT LOSS OF GENERALITY, D MAY BE INITIALLY SET TO 1.
C               **  NOTE THAT WHENEVER 2 LINES ARE PERPENDICULAR,
C               **  THE INNER PRODUCT OF THE DIRECTION NUMBERS MUST = 0.
C               **  WITHOUT LOSS OF GENERALITY, D MAY BE INITIALLY SET TO 1.
C               **  INCORPORATING THE 2 INNER PRODUCT EQUATIONS,
C               **  WE MAY SOLVE FOR E AND F.
C               **  THE SOLUTIONS TURN OUT TO BE
C               **      D = 1
C               **      E = Y3DEYE/X3DEYE
C               **      F = (-X3DEYE*X3DEYE - Y3DEYE*Y3DEYE) / (X3DEYE*Z3DEYE)
C               **
C               **  IN SUMMARY, THE DIRECTION NUMBERS FOR THE 3 NEW AXES
C               **  MAY BE WRITTEN AS
C               **      NEW X AXIS:  Y3DEYE       -X3DEYE     0
C               **      NEW Y AXIS:  X3DEYE       Y3DEYE      Z3DEYE
C               **      NEW Z AXIS:  -X3DEYE*Z3DEYE   -Y3DEYE*Z3DEYE
C               **                                        X3DEYE*X3DEYE+Y3DEYE
C               **  NOTE THAT BY INSPECTION WE SEE RETROSPECTIVELY
C               **  THAT THE 3 INNER PRODUCTS ALL = 0
C               **  AND SO THE 3 DEFINED AXES ARE ALL PERPENDICULAR
C               **  (AS THEY SHOULD BE).
C               **
C               **  THE CORRESPONDING DIRECTION COSINES
C               **  ARE GOTTEN BY NORMALIZATION TO UNITY;
C               **  LET US SYMBOLICALLY REPRESENT THEM BY--
C               **      D3DCXX   D3DCXY   D3DCXZ
C               **      D3DCYX   D3DCYY   D3DCYZ
C               **      D3DCZX   D3DCZY   D3DCZZ
C               **  THE ABOVE RESULTS WERE ACTUALLY ARRIVED AT
C               **  (AND ARE VALID FOR) BY DISPLACING THE OLD ORIGIN
C               **  FROM (0,0,0) TO (XM,YM,ZM).
C               **  THIS SIMPLIFIES THE EQUATIONS CONSIDERABLY.
C               **
C               **  GIVEN THAT WE NOW HAVE THE DIRECTION COSINES
C               **  OF THE NEW AXES IN TERMS OF THE OLD COORDINATES,
C               **  WE MAKE USE OF
C               **  EISENHART (COORDINATE GEOMETRY, PAGE 160) WHICH STATES
C               **  THAT THE LINEAR TRANSFORMATION THAT IS NEEDED TO CARRY OUT
C               **  THE ROTATION FROM THE VISUAL PLANE TO THE XZ PLANE
C               **  IS GIVEN BY
C               **      XT = XM + D3DCXX(X-XM) + D3DCXY(Y-YM) + D3DCXZ(Z-ZM)
C               **      YT = YM + D3DCYX(X-XM) + D3DCYY(Y-YM) + D3DCYZ(Z-ZM)
C               **      ZT = ZM + D3DCZX(X-XM) + D3DCZY(Y-YM) + D3DCZZ(Z-ZM)
C               **
C               **  NOTE THAT BY INSPECTION OF THE ABOVE TRANSFORMATION
C               **  IT IS SEEN THAT (XM,YM,ZM) IS MAPPED INTO (XM,YM,ZM)
C               **  (AS IT SHOULD BE).
C               **  NOTE ALSO THAT THE EYE POINT AND ANY POINT ALONG THE LINE
C               **  OF SIGHT WOULD HAVE BEEN MAPPED INTO (XM,YM,ZM)
C               **  AS IT SHOULD BE.
C               **  NOTE ALSO THAT ALL POINTS ON THE VISUAL PLANE
C               **  SINCE THEY SATISFY
C               **     (X3DEYE-XM)(X-XM) + (Y3DEYE-YM)(Y-YM) + (Z3DEYE-ZM)(Z-ZM)
C               **     = 0
C               **  GETS MAPPED INTO THE CONSTANT YT VALUE OF YT = YM
C               **  AND SO THE TRANSFORMED PLOT SURFACE IS ONE WHICH
C               **  IS PARALLEL TO THE XZ PLANE BUT IS DISPLACED
C               **  YM UNITS OUT FROM THE XZ PLANE.
C               **  THIS PLOT PLANE WILL CONTAIN THE POINT (XM,YM,ZM).
C               ****************************************************************
C
C               **************************************************
C               **  STEP 11--                                   **
C               **  BRANCH TO THE APPROPRIATE                   **
C               **  TRANSFORMATION                              **
C               **************************************************
C
      ISTEPN='11'
      IF(IBUGG4.EQ.'ON'.OR.ISUBG4.EQ.'TR32')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      NT=N
C
      XDEL=X3DEYE-X3DMID
      IF(XDEL.EQ.0.0)XDEL=EPS
      YDEL=Y3DEYE-Y3DMID
      IF(YDEL.EQ.0.0)YDEL=EPS
      ZDEL=Z3DEYE-Z3DMID
      IF(ZDEL.EQ.0.0)ZDEL=EPS
C
      IF(I3DPRO.EQ.'ORTH')GOTO2100
      GOTO3100
C
C               **************************************************
C               **  STEP 21--                                   **
C               **  TREAT THE ORTHOGRAPHIC TRANSFORMATION CASE  **
C               **************************************************
C
 2100 CONTINUE
C
      ISTEPN='21'
      IF(IBUGG4.EQ.'ON'.OR.ISUBG4.EQ.'TR32')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
C     THE FOLLOWING IS INCORRECT (XM FOR X(I) ETC.)
CCCCC MAY 1996.  NP12 IS UNDEFINED.  USE NT.
CCCCC DO2110I=1,NP12
      DO2110I=1,NT
C
C     ***** 5 LINES OF CODE TO ADJUST FOR DIVISION BY 0 ADDED AUGUST 1983 *****
CCCCC A11=XDEL
CCCCC A12=YDEL
CCCCC A13=ZDEL
CCCCC A23=Y3DEYE-Y3DMID
CCCCC IF(A23.EQ.0.0)A21=EPS
CCCCC A23=-(X3DEYE-X3DMID)
CCCCC IF(A23.EQ.0.0)A22=EPS
CCCCC A23=0.0
CCCCC A31=0.0
CCCCC A32=Z3DEYE-Z3DMID
CCCCC IF(A32.EQ.0.0)A32=EPS
CCCCC A33=-(Y3DEYE-Y3DMID)
CCCCC IF(A33.EQ.0.0)A33=EPS
C
CCCCC R1=XDEL*X3DMID+YDEL*Y3DMID+ZDEL*Z3DMID
CCCCC R2=(Y3DEYE-Y3DMID)*X3DMID-(X3DEYE-X3DMID)*YM
CCCCC R3=(Z3DEYE-Z3DMID)*Y3DMID-(Y3DEYE-Y3DMID)*Z3DMID
C
CCCCC P12=-A23/A11
CCCCC P13=-A32/(P12*A12+A23)
C
CCCCC ZPI=(P13*(P12*R1+R2)+R3)/
CCCCC1(P13*P12*A13+A33)
CCCCC YPI=(R3-A33*ZPI)/A32
CCCCC XPI=(R2-A23*YPI)/A21
CCCCC IF(IBUGG4.EQ.'ON'.OR.ISUBG4.EQ.'TR32')
CCCCC1WRITE(ICOUT,2111)I,XPI,YPI,ZPI
C2111 FORMAT('I,XPI,YPI,ZPI = ',I8,3E15.7)
CCCCC IF(IBUGG4.EQ.'ON'.OR.ISUBG4.EQ.'TR32')
CCCCC1CALL DPWRST('XXX','BUG ')
C
CCCCC DELX=XPI-X3DMID
CCCCC DELY=YPI-Y3DMID
CCCCC DELZ=ZPI-Z3DMID
CCCCC XT(I)=X3DMID+D3DCXX*DELX+D3DCXY*DELY+D3DCXZ*DELZ
CCCCC YT(I)=Y3DMID+D3DCYX*DELX+D3DCYY*DELY+D3DCYZ*DELZ
CCCCC ZT(I)=X3DMID+D3DCZX*DELX+D3DCZY*DELY+D3DCZZ*DELZ
      DELX=X(I)-X3DMID
      DELY=Y(I)-Y3DMID
      DELZ=Z(I)-Z3DMID
      XT(I)=X3DMID+TERMXX*DELX+TERMXY*DELY+TERMXZ*DELZ
      ZT(I)=X3DMID+TERMZX*DELX+TERMZY*DELY+TERMZZ*DELZ
C
 2110 CONTINUE
      GOTO9000
C
C               **************************************************
C               **  STEP 31--                                   **
C               **  TREAT THE PERSPECTIVE TRANSFORMATION CASE   **
C               **************************************************
C
 3100 CONTINUE
C
      ISTEPN='31'
      IF(IBUGG4.EQ.'ON'.OR.ISUBG4.EQ.'TR32')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      DO3110I=1,N
C
C     ***** 5 LINES OF CODE TO ADJUST FOR DIVISION BY 0 ADDED AUGUST 1983 *****
      A11=XDEL
      A12=YDEL
      A13=ZDEL
      A21=Y3DEYE-Y(I)
      IF(A21.EQ.0.0)A21=EPS
      A22=-(X3DEYE-X(I))
      IF(A22.EQ.0.0)A22=EPS
      A23=0.0
      A31=0.0
      A32=Z3DEYE-Z(I)
      IF(A32.EQ.0.0)A32=EPS
      A33=-(Y3DEYE-Y(I))
      IF(A33.EQ.0.0)A33=EPS
C
      R1=XDEL*X3DMID+YDEL*Y3DMID+ZDEL*Z3DMID
      R2=(Y3DEYE-Y(I))*X(I)-(X3DEYE-X(I))*Y(I)
      R3=(Z3DEYE-Z(I))*Y(I)-(Y3DEYE-Y(I))*Z(I)
C
      P12=-A21/A11
      P13=-A32/(P12*A12+A22)
C
      ZPI=(P13*(P12*R1+R2)+R3)/
     1(P13*P12*A13+A33)
      YPI=(R3-A33*ZPI)/A32
      XPI=(R2-A22*YPI)/A21
      IF(IBUGG4.EQ.'ON'.OR.ISUBG4.EQ.'TR32')
     1WRITE(ICOUT,3111)I,XPI,YPI,ZPI
 3111 FORMAT('I,XPI,YPI,ZPI = ',I8,3E15.7)
      IF(IBUGG4.EQ.'ON'.OR.ISUBG4.EQ.'TR32')
     1CALL DPWRST('XXX','BUG ')
C
      DELX=XPI-X3DMID
      DELY=YPI-Y3DMID
      DELZ=ZPI-Z3DMID
      XT(I)=X3DMID+D3DCXX*DELX+D3DCXY*DELY+D3DCXZ*DELZ
CCCCC YT(I)=Y3DMID+D3DCYX*DELX+D3DCYY*DELY+D3DCYZ*DELZ
      ZT(I)=X3DMID+D3DCZX*DELX+D3DCZY*DELY+D3DCZZ*DELZ
C
 3110 CONTINUE
      GOTO9000
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT.      **
C               *****************
C
 9000 CONTINUE
      IF(IBUGG4.EQ.'OFF'.AND.ISUBG4.NE.'TR32')GOTO9090
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9011)
 9011 FORMAT('***** AT THE END       OF D3TR32--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9012)IBUGG4,ISUBG4,IERRG4
 9012 FORMAT('IBUGG4,ISUBG4,IERRG4 = ',3A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9013)I3DPRO
 9013 FORMAT('I3DPRO = ',A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9014)IBUGG4,ISUBG4,IERRG4
 9014 FORMAT('IBUGG4,ISUBG4,IERRG4 = ',3A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9015)X3DEYE,Y3DEYE,Z3DEYE
 9015 FORMAT('X3DEYE,Y3DEYE,Z3DEYE = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9016)X3DMID,Y3DMID,Z3DMID
 9016 FORMAT('X3DMID,Y3DMID,Z3DMID = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9024)D3DCXX,D3DCXY,D3DCXZ
 9024 FORMAT('D3DCXX,D3DCXY,D3DCXZ = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9025)D3DCYX,D3DCYY,D3DCYZ
 9025 FORMAT('D3DCYX,D3DCYY,D3DCYZ = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9026)D3DCZX,D3DCZY,D3DCZZ
 9026 FORMAT('D3DCZX,D3DCZY,D3DCZZ = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9031)XDEL,YDEL,ZDEL
 9031 FORMAT('XDEL,YDEL,ZDEL = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9032)A11,A12,A13
 9032 FORMAT('A11,A12,A13    = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9033)A21,A22,A23
 9033 FORMAT('A21,A22,A23    = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9034)A31,A32,A33
 9034 FORMAT('A31,A32,A33    = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9035)R1,R2,R3
 9035 FORMAT('R1,R2,R3       = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9036)P12,P13
 9036 FORMAT('P12,P13        = ',2E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9037)XPI,YPI,ZPI
 9037 FORMAT('XPI,YPI,ZPI    = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9038)DELX,DELY,DELZ
 9038 FORMAT('DELX,DELY,DELZ = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9039)XT(N),ZT(N)
 9039 FORMAT('XT(N),ZT(N)    = ',2E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9041)N,NT
 9041 FORMAT('N,NT = ',2I8)
      CALL DPWRST('XXX','BUG ')
      DO9042I=1,N
      WRITE(ICOUT,9043)I,X(I),Y(I),Z(I),XT(I),ZT(I)
 9043 FORMAT('I,X(I),Y(I),Z(I),XT(I),ZT(I) = ',I8,5E11.3)
      CALL DPWRST('XXX','BUG ')
 9042 CONTINUE
 9090 CONTINUE
C
      RETURN
      END
      SUBROUTINE D3TRXP(X,Y,N,IDIR,ABASE,
     1FXMIN,FXMAX,FXRANG,FYMIN,FYMAX,FYRANG,
     1PXMIN,PXMAX,PXRANG,PYMIN,PYMAX,PYRANG,
     1PX,PY,NP,PBASE)
C
C     PURPOSE--TRANSLATE 2-D RAW OR INTERMEDIATE DATA
C              INTO 2-D VISUAL PLANE (0 TO 100) DATA
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--88/10
C     ORIGINAL VERSION--SEPTEMBER 1988.
C
C-----COMMON STATEMENTS-----------------------------------------------
C
      INCLUDE 'DPCO3D.INC'
      INCLUDE 'DPCOBE.INC'
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 IDIR
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
CCCCC CHARACTER*4 ISTEPN
C
C---------------------------------------------------------------------
C
      DIMENSION X(*)
      DIMENSION Y(*)
      DIMENSION PX(*)
      DIMENSION PY(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='D3TR'
      ISUBN2='XP  '
      IERRG4='NO'
C
      IF(IBUGG4.EQ.'OFF'.AND.ISUBG4.NE.'TRXP')GOTO90
      WRITE(ICOUT,999)
  999 FORMAT(1X)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,51)
   51 FORMAT('***** AT THE BEGINNING OF D3TRXP--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,52)IBUGG4,ISUBG4,IERRG4
   52 FORMAT('IBUGG4,ISUBG4,IERRG4 = ',A4,2X,A4,2X,A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,53)FXMIN,FXMAX,FXRANG
   53 FORMAT('FXMIN,FXMAX,FXRANG = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,54)FYMIN,FYMAX,FYRANG
   54 FORMAT('FYMIN,FYMAX,FYRANG = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,55)PXMIN,PXMAX,PXRANG
   55 FORMAT('PXMIN,PXMAX,PXRANG = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,56)PYMIN,PYMAX,PYRANG
   56 FORMAT('PYMIN,PYMAX,PYRANG = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,57)ABASE
   57 FORMAT('ABASE = ',E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,61)N,IDIR
   61 FORMAT('N,IDIR = ',I8,2X,A4)
      CALL DPWRST('XXX','BUG ')
      DO62I=1,N
      WRITE(ICOUT,63)I,X(I),Y(I)
   63 FORMAT('I,X(I),Y(I) = ',I8,2E15.7)
      CALL DPWRST('XXX','BUG ')
   62 CONTINUE
   90 CONTINUE
C
C               *****************************************************
C               **  STEP 11--                                      **
C               **  TRANSLATE THE 2-D PLANE DATA POINTS            **
C               **  INTO STANDARDIZED (0.0 TO 100.0) COORDINATES.  **
C               *****************************************************
C
      NP=N
C
      DO1110I=1,N
      FXRATI=(X(I)-FXMIN)/FXRANG
      FYRATI=(Y(I)-FYMIN)/FYRANG
      PX(I)=PXMIN+FXRATI*PXRANG
      PY(I)=PYMIN+FYRATI*PYRANG
 1110 CONTINUE
C
      IF(IDIR.EQ.'V')GOTO1120
      GOTO1129
 1120 CONTINUE
      FYRATI=(ABASE-FYMIN)/FYRANG
      PBASE=PYMIN+FYRATI*PYRANG
 1129 CONTINUE
C
      IF(IDIR.EQ.'H')GOTO1130
      GOTO1139
 1130 CONTINUE
      FXRATI=(ABASE-FXMIN)/FXRANG
      PBASE=PXMIN+FXRATI*PXRANG
 1139 CONTINUE
C
C               **************************************************
C               **  STEP 90--                                   **
C               **  EXIT.                                       **
C               **************************************************
C
      IF(IBUGG4.EQ.'OFF'.AND.ISUBG4.NE.'TRXP')GOTO9090
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9011)
 9011 FORMAT('***** AT THE END       OF D3TRXP--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9012)IBUGG4,ISUBG4,IERRG4
 9012 FORMAT('IBUGG4,ISUBG4,IERRG4 = ',A4,2X,A4,2X,A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9013)FXMIN,FXMAX,FXRANG
 9013 FORMAT('FXMIN,FXMAX,FXRANG = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9014)FYMIN,FYMAX,FYRANG
 9014 FORMAT('FYMIN,FYMAX,FYRANG = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9015)PXMIN,PXMAX,PXRANG
 9015 FORMAT('PXMIN,PXMAX,PXRANG = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9016)PYMIN,PYMAX,PYRANG
 9016 FORMAT('PYMIN,PYMAX,PYRANG = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9017)ABASE
 9017 FORMAT('ABASE = ',E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9021)N,NP,IDIR
 9021 FORMAT('N,NP,IDIR = ',2I8,2X,A4)
      CALL DPWRST('XXX','BUG ')
      DO9022I=1,N
      WRITE(ICOUT,9023)I,X(I),Y(I),PX(I),PY(I)
 9023 FORMAT('I,X(I),Y(I),PX(I),PY(I) = ',I8,4E15.7)
      CALL DPWRST('XXX','BUG ')
 9022 CONTINUE
 9090 CONTINUE
C
      RETURN
      END
      FUNCTION E1 (X)
C***BEGIN PROLOGUE  E1
C***PURPOSE  Compute the exponential integral E1(X).
C***LIBRARY   SLATEC (FNLIB)
C***CATEGORY  C5
C***TYPE      SINGLE PRECISION (E1-S, DE1-D)
C***KEYWORDS  E1 FUNCTION, EXPONENTIAL INTEGRAL, FNLIB,
C             SPECIAL FUNCTIONS
C***AUTHOR  Fullerton, W., (LANL)
C***DESCRIPTION
C
C E1 calculates the single precision exponential integral, E1(X), for
C positive single precision argument X and the Cauchy principal value
C for negative X.  If principal values are used everywhere, then, for
C all X,
C
C    E1(X) = -Ei(-X)
C or
C    Ei(X) = -E1(-X).
C
C
C Series for AE11       on the interval -1.00000D-01 to  0.
C                                        with weighted error   1.76E-17
C                                         log weighted error  16.75
C                               significant figures required  15.70
C                                    decimal places required  17.55
C
C
C Series for AE12       on the interval -2.50000D-01 to -1.00000D-01
C                                        with weighted error   5.83E-17
C                                         log weighted error  16.23
C                               significant figures required  15.76
C                                    decimal places required  16.93
C
C
C Series for E11        on the interval -4.00000D+00 to -1.00000D+00
C                                        with weighted error   1.08E-18
C                                         log weighted error  17.97
C                               significant figures required  19.02
C                                    decimal places required  18.61
C
C
C Series for E12        on the interval -1.00000D+00 to  1.00000D+00
C                                        with weighted error   3.15E-18
C                                         log weighted error  17.50
C                        approx significant figures required  15.8
C                                    decimal places required  18.10
C
C
C Series for AE13       on the interval  2.50000D-01 to  1.00000D+00
C                                        with weighted error   2.34E-17
C                                         log weighted error  16.63
C                               significant figures required  16.14
C                                    decimal places required  17.33
C
C
C Series for AE14       on the interval  0.          to  2.50000D-01
C                                        with weighted error   5.41E-17
C                                         log weighted error  16.27
C                               significant figures required  15.38
C                                    decimal places required  16.97
C
C***REFERENCES  (NONE)
C***ROUTINES CALLED  CSEVL, INITS, R1MACH, XERMSG
C***REVISION HISTORY  (YYMMDD)
C   770701  DATE WRITTEN
C   890531  Changed all specific intrinsics to generic.  (WRB)
C   891115  Modified prologue description.  (WRB)
C   891115  REVISION DATE from Version 3.2
C   891214  Prologue converted to Version 4.0 format.  (BAB)
C   900315  CALLs to XERROR changed to CALLs to XERMSG.  (THJ)
C   920618  Removed space from variable names.  (RWC, WRB)
C***END PROLOGUE  E1
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOMC.INC'
      INCLUDE 'DPCOP2.INC'
C
      DIMENSION AE11CS(39), AE12CS(25), E11CS(19), E12CS(16),
     1  AE13CS(25), AE14CS(26)
      LOGICAL FIRST
      SAVE AE11CS, AE12CS, E11CS, E12CS, AE13CS, AE14CS,
     1 NTAE11, NTAE12, NTE11, NTE12, NTAE13, NTAE14, XMAX, FIRST
      DATA AE11CS( 1) /    .1215032397 1606579E0 /
      DATA AE11CS( 2) /   -.0650887785 13550150E0 /
      DATA AE11CS( 3) /    .0048976513 57459670E0 /
      DATA AE11CS( 4) /   -.0006492378 43027216E0 /
      DATA AE11CS( 5) /    .0000938404 34587471E0 /
      DATA AE11CS( 6) /    .0000004202 36380882E0 /
      DATA AE11CS( 7) /   -.0000081133 74735904E0 /
      DATA AE11CS( 8) /    .0000028042 47688663E0 /
      DATA AE11CS( 9) /    .0000000564 87164441E0 /
      DATA AE11CS(10) /   -.0000003448 09174450E0 /
      DATA AE11CS(11) /    .0000000582 09273578E0 /
      DATA AE11CS(12) /    .0000000387 11426349E0 /
      DATA AE11CS(13) /   -.0000000124 53235014E0 /
      DATA AE11CS(14) /   -.0000000051 18504888E0 /
      DATA AE11CS(15) /    .0000000021 48771527E0 /
      DATA AE11CS(16) /    .0000000008 68459898E0 /
      DATA AE11CS(17) /   -.0000000003 43650105E0 /
      DATA AE11CS(18) /   -.0000000001 79796603E0 /
      DATA AE11CS(19) /    .0000000000 47442060E0 /
      DATA AE11CS(20) /    .0000000000 40423282E0 /
      DATA AE11CS(21) /   -.0000000000 03543928E0 /
      DATA AE11CS(22) /   -.0000000000 08853444E0 /
      DATA AE11CS(23) /   -.0000000000 00960151E0 /
      DATA AE11CS(24) /    .0000000000 01692921E0 /
      DATA AE11CS(25) /    .0000000000 00607990E0 /
      DATA AE11CS(26) /   -.0000000000 00224338E0 /
      DATA AE11CS(27) /   -.0000000000 00200327E0 /
      DATA AE11CS(28) /   -.0000000000 00006246E0 /
      DATA AE11CS(29) /    .0000000000 00045571E0 /
      DATA AE11CS(30) /    .0000000000 00016383E0 /
      DATA AE11CS(31) /   -.0000000000 00005561E0 /
      DATA AE11CS(32) /   -.0000000000 00006074E0 /
      DATA AE11CS(33) /   -.0000000000 00000862E0 /
      DATA AE11CS(34) /    .0000000000 00001223E0 /
      DATA AE11CS(35) /    .0000000000 00000716E0 /
      DATA AE11CS(36) /   -.0000000000 00000024E0 /
      DATA AE11CS(37) /   -.0000000000 00000201E0 /
      DATA AE11CS(38) /   -.0000000000 00000082E0 /
      DATA AE11CS(39) /    .0000000000 00000017E0 /
      DATA AE12CS( 1) /    .5824174951 3472674E0 /
      DATA AE12CS( 2) /   -.1583488509 0578275E0 /
      DATA AE12CS( 3) /   -.0067642755 90323141E0 /
      DATA AE12CS( 4) /    .0051258439 50185725E0 /
      DATA AE12CS( 5) /    .0004352324 92169391E0 /
      DATA AE12CS( 6) /   -.0001436133 66305483E0 /
      DATA AE12CS( 7) /   -.0000418013 20556301E0 /
      DATA AE12CS( 8) /   -.0000027133 95758640E0 /
      DATA AE12CS( 9) /    .0000011513 81913647E0 /
      DATA AE12CS(10) /    .0000004206 50022012E0 /
      DATA AE12CS(11) /    .0000000665 81901391E0 /
      DATA AE12CS(12) /    .0000000006 62143777E0 /
      DATA AE12CS(13) /   -.0000000028 44104870E0 /
      DATA AE12CS(14) /   -.0000000009 40724197E0 /
      DATA AE12CS(15) /   -.0000000001 77476602E0 /
      DATA AE12CS(16) /   -.0000000000 15830222E0 /
      DATA AE12CS(17) /    .0000000000 02905732E0 /
      DATA AE12CS(18) /    .0000000000 01769356E0 /
      DATA AE12CS(19) /    .0000000000 00492735E0 /
      DATA AE12CS(20) /    .0000000000 00093709E0 /
      DATA AE12CS(21) /    .0000000000 00010707E0 /
      DATA AE12CS(22) /   -.0000000000 00000537E0 /
      DATA AE12CS(23) /   -.0000000000 00000716E0 /
      DATA AE12CS(24) /   -.0000000000 00000244E0 /
      DATA AE12CS(25) /   -.0000000000 00000058E0 /
      DATA E11CS( 1) / -16.1134616555 71494026E0 /
      DATA E11CS( 2) /   7.7940727787 426802769E0 /
      DATA E11CS( 3) /  -1.9554058188 631419507E0 /
      DATA E11CS( 4) /    .3733729386 6277945612E0 /
      DATA E11CS( 5) /   -.0569250319 1092901938E0 /
      DATA E11CS( 6) /    .0072110777 6966009185E0 /
      DATA E11CS( 7) /   -.0007810490 1449841593E0 /
      DATA E11CS( 8) /    .0000738809 3356262168E0 /
      DATA E11CS( 9) /   -.0000062028 6187580820E0 /
      DATA E11CS(10) /    .0000004681 6002303176E0 /
      DATA E11CS(11) /   -.0000000320 9288853329E0 /
      DATA E11CS(12) /    .0000000020 1519974874E0 /
      DATA E11CS(13) /   -.0000000001 1673686816E0 /
      DATA E11CS(14) /    .0000000000 0627627066E0 /
      DATA E11CS(15) /   -.0000000000 0031481541E0 /
      DATA E11CS(16) /    .0000000000 0001479904E0 /
      DATA E11CS(17) /   -.0000000000 0000065457E0 /
      DATA E11CS(18) /    .0000000000 0000002733E0 /
      DATA E11CS(19) /   -.0000000000 0000000108E0 /
      DATA E12CS( 1) /  -0.0373902147 92202795E0 /
      DATA E12CS( 2) /   0.0427239860 62209577E0 /
      DATA E12CS( 3) /   -.1303182079 849700544E0 /
      DATA E12CS( 4) /    .0144191240 2469889073E0 /
      DATA E12CS( 5) /   -.0013461707 8051068022E0 /
      DATA E12CS( 6) /    .0001073102 9253063780E0 /
      DATA E12CS( 7) /   -.0000074299 9951611943E0 /
      DATA E12CS( 8) /    .0000004537 7325690753E0 /
      DATA E12CS( 9) /   -.0000000247 6417211390E0 /
      DATA E12CS(10) /    .0000000012 2076581374E0 /
      DATA E12CS(11) /   -.0000000000 5485141480E0 /
      DATA E12CS(12) /    .0000000000 0226362142E0 /
      DATA E12CS(13) /   -.0000000000 0008635897E0 /
      DATA E12CS(14) /    .0000000000 0000306291E0 /
      DATA E12CS(15) /   -.0000000000 0000010148E0 /
      DATA E12CS(16) /    .0000000000 0000000315E0 /
      DATA AE13CS( 1) /   -.6057732466 4060346E0 /
      DATA AE13CS( 2) /   -.1125352434 8366090E0 /
      DATA AE13CS( 3) /    .0134322662 47902779E0 /
      DATA AE13CS( 4) /   -.0019268451 87381145E0 /
      DATA AE13CS( 5) /    .0003091183 37720603E0 /
      DATA AE13CS( 6) /   -.0000535641 32129618E0 /
      DATA AE13CS( 7) /    .0000098278 12880247E0 /
      DATA AE13CS( 8) /   -.0000018853 68984916E0 /
      DATA AE13CS( 9) /    .0000003749 43193568E0 /
      DATA AE13CS(10) /   -.0000000768 23455870E0 /
      DATA AE13CS(11) /    .0000000161 43270567E0 /
      DATA AE13CS(12) /   -.0000000034 66802211E0 /
      DATA AE13CS(13) /    .0000000007 58754209E0 /
      DATA AE13CS(14) /   -.0000000001 68864333E0 /
      DATA AE13CS(15) /    .0000000000 38145706E0 /
      DATA AE13CS(16) /   -.0000000000 08733026E0 /
      DATA AE13CS(17) /    .0000000000 02023672E0 /
      DATA AE13CS(18) /   -.0000000000 00474132E0 /
      DATA AE13CS(19) /    .0000000000 00112211E0 /
      DATA AE13CS(20) /   -.0000000000 00026804E0 /
      DATA AE13CS(21) /    .0000000000 00006457E0 /
      DATA AE13CS(22) /   -.0000000000 00001568E0 /
      DATA AE13CS(23) /    .0000000000 00000383E0 /
      DATA AE13CS(24) /   -.0000000000 00000094E0 /
      DATA AE13CS(25) /    .0000000000 00000023E0 /
      DATA AE14CS( 1) /   -.1892918000 753017E0 /
      DATA AE14CS( 2) /   -.0864811785 5259871E0 /
      DATA AE14CS( 3) /    .0072241015 4374659E0 /
      DATA AE14CS( 4) /   -.0008097559 4575573E0 /
      DATA AE14CS( 5) /    .0001099913 4432661E0 /
      DATA AE14CS( 6) /   -.0000171733 2998937E0 /
      DATA AE14CS( 7) /    .0000029856 2751447E0 /
      DATA AE14CS( 8) /   -.0000005659 6491457E0 /
      DATA AE14CS( 9) /    .0000001152 6808397E0 /
      DATA AE14CS(10) /   -.0000000249 5030440E0 /
      DATA AE14CS(11) /    .0000000056 9232420E0 /
      DATA AE14CS(12) /   -.0000000013 5995766E0 /
      DATA AE14CS(13) /    .0000000003 3846628E0 /
      DATA AE14CS(14) /   -.0000000000 8737853E0 /
      DATA AE14CS(15) /    .0000000000 2331588E0 /
      DATA AE14CS(16) /   -.0000000000 0641148E0 /
      DATA AE14CS(17) /    .0000000000 0181224E0 /
      DATA AE14CS(18) /   -.0000000000 0052538E0 /
      DATA AE14CS(19) /    .0000000000 0015592E0 /
      DATA AE14CS(20) /   -.0000000000 0004729E0 /
      DATA AE14CS(21) /    .0000000000 0001463E0 /
      DATA AE14CS(22) /   -.0000000000 0000461E0 /
      DATA AE14CS(23) /    .0000000000 0000148E0 /
      DATA AE14CS(24) /   -.0000000000 0000048E0 /
      DATA AE14CS(25) /    .0000000000 0000016E0 /
      DATA AE14CS(26) /   -.0000000000 0000005E0 /
      DATA FIRST /.TRUE./
C***FIRST EXECUTABLE STATEMENT  E1
      IF (FIRST) THEN
         ETA = 0.1*R1MACH(3)
         NTAE11 = INITS (AE11CS, 39, ETA)
         NTAE12 = INITS (AE12CS, 25, ETA)
         NTE11 = INITS (E11CS, 19, ETA)
         NTE12 = INITS (E12CS, 16, ETA)
         NTAE13 = INITS (AE13CS, 25, ETA)
         NTAE14 = INITS (AE14CS, 26, ETA)
C
         XMAXT = -LOG (R1MACH(1))
         XMAX = XMAXT - LOG(XMAXT)
      ENDIF
      FIRST = .FALSE.
C
      IF (X.GT.(-10.)) GO TO 20
C
C E1(X) = -EI(-X) FOR X .LE. -10.
C
      E1 = EXP(-X)/X * (1.+CSEVL (20./X+1., AE11CS, NTAE11))
      RETURN
C
 20   IF (X.GT.(-4.0)) GO TO 30
C
C E1(X) = -EI(-X) FOR -10. .LT. X .LE. -4.
C
      E1 = EXP(-X)/X * (1.+CSEVL ((40./X+7.)/3., AE12CS, NTAE12))
      RETURN
C
 30   IF (X.GT.(-1.0)) GO TO 40
C
C E1(X) = -EI(-X) FOR -4. .LT. X .LE. -1.
C
      E1 = -LOG(ABS(X)) + CSEVL ((2.*X+5.)/3., E11CS, NTE11)
      RETURN
C
 40   IF (X.GT.1.) GO TO 50
      IF (X .EQ. 0.) THEN
        WRITE(ICOUT,41)
   41   FORMAT('***** ERORR FROM E1, X IS ZER0.  *******')
        CALL DPWRST('XXX','BUG ')
        E1=0.0
        RETURN
      ENDIF
C
C E1(X) = -EI(-X) FOR -1. .LT. X .LE. 1.,  X .NE. 0.
C
      E1 = (-LOG(ABS(X)) - 0.6875 + X) + CSEVL (X, E12CS, NTE12)
      RETURN
C
 50   IF (X.GT.4.) GO TO 60
C
C E1(X) = -EI(-X) FOR 1. .LT. X .LE. 4.
C
      E1 = EXP(-X)/X * (1.+CSEVL ((8./X-5.)/3., AE13CS, NTAE13))
      RETURN
C
 60   IF (X.GT.XMAX) GO TO 70
C
C E1(X) = -EI(-X) FOR 4. .LT. X .LE. XMAX
C
      E1 = EXP(-X)/X * (1. + CSEVL (8./X-1., AE14CS, NTAE14))
      RETURN
C
C E1(X) = -EI(-X) FOR X .GT. XMAX
C
 70   CONTINUE
      WRITE(ICOUT,71)
      CALL DPWRST('XXX','BUG ')
   71 FORMAT('***** WARNING FROM E1, UNDERFLOW BECAUSE THE ',
     1       'VALUE OF X IS SO LARGE.  ****')
      E1 = 0.
      RETURN
C
      END
      SUBROUTINE EA(NEWFLG,SVALUE,LIMEXP,RESULT,ABSERR,EPSTAB,IERR)
C   PART OF QAGI CODE.
C***BEGIN PROLOGUE  EA
C***DATE WRITTEN   800101  (YYMMDD)
C***REVISION DATE  871208   (YYMMDD)
C***CATEGORY NO.  E5
C***KEYWORDS  CONVERGENCE ACCELERATION,EPSILON ALGORITHM,EXTRAPOLATION
C***AUTHOR  PIESSENS, ROBERT, APPLIED MATH. AND PROGR. DIV. -
C             K. U. LEUVEN
C           DE DONCKER-KAPENGA, ELISE,WESTERN MICHIGAN UNIVERSITY
C           KAHANER, DAVID K., NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C           STARKENBURG, C. B., NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C***PURPOSE  Given a slowly convergent sequence, this routine attempts
C            to extrapolate nonlinearly to a better estimate of the
C            sequence's limiting value, thus improving the rate of
C            convergence. Routine is based on the epsilon algorithm
C            of P. Wynn. An estimate of the absolute error is also
C            given.
C     THIS PROLOGUE HAS BEEN REMOVED FOR REASONS OF SPACE
C     FOR A COMPLETE COPY OF THIS ROUTINE CONTACT THE AUTHORS
C     From the book "Numerical Methods and Software"
C          by  D. Kahaner, C. Moler, S. Nash
C               Prentice Hall 1988
C***END PROLOGUE  EA
      REAL ABSERR,DELTA1,DELTA2,DELTA3,EPRN,EPSTAB(*),
     1   ERROR,ERR1,ERR2,ERR3,E0,E1,E2,E3,RELPR,RES,RESULT,
     2   RES3LA(3),R1MACH,SS,SVALUE,TOL1,TOL2,TOL3
      INTEGER I,IB,IB2,IE,IERR,IN,K1,K2,K3,LIMEXP,N,NEWELM,NUM,NRES
      LOGICAL NEWFLG
C
      INCLUDE 'DPCOMC.INC'
      INCLUDE 'DPCOP2.INC'
C
C***FIRST EXECUTABLE STATEMENT  EA
      IF(LIMEXP.LT.3) THEN
        IERR = 1
CCCCC   CALL XERROR('LIMEXP IS LESS THAN 3',21,1,1)
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,901)
  901   FORMAT('***** ERROR--NUMERICAL INTEGRATION ROUTINE EA (CALLED ',
     1         'BY QAGI ROUTINE).')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,903)
  903   FORMAT('      LIMEXP IS LESS THAN 3.')
        CALL DPWRST('XXX','BUG ')
        GO TO 110
      ENDIF
      IERR = 0
      RES3LA(1)=EPSTAB(LIMEXP+5)
      RES3LA(2)=EPSTAB(LIMEXP+6)
      RES3LA(3)=EPSTAB(LIMEXP+7)
      RESULT=SVALUE
      IF(NEWFLG) THEN
        N=1
        NRES=0
        NEWFLG=.FALSE.
        EPSTAB(N)=SVALUE
        ABSERR=ABS(RESULT)
        GO TO 100
      ELSE
        N=INT(EPSTAB(LIMEXP+3))
        NRES=INT(EPSTAB(LIMEXP+4))
        IF(N.EQ.2) THEN
          EPSTAB(N)=SVALUE
          ABSERR=.6E+01*ABS(RESULT-EPSTAB(1))
          GO TO 100
        ENDIF
      ENDIF
      EPSTAB(N)=SVALUE
      RELPR=R1MACH(4)
      EPRN=1.0E+01*RELPR
      EPSTAB(N+2)=EPSTAB(N)
      NEWELM=(N-1)/2
      NUM=N
      K1=N
      DO 40 I=1,NEWELM
        K2=K1-1
        K3=K1-2
        RES=EPSTAB(K1+2)
        E0=EPSTAB(K3)
        E1=EPSTAB(K2)
        E2=RES
        DELTA2=E2-E1
        ERR2=ABS(DELTA2)
        TOL2=MAX(ABS(E2),ABS(E1))*RELPR
        DELTA3=E1-E0
        ERR3=ABS(DELTA3)
        TOL3=MAX(ABS(E1),ABS(E0))*RELPR
        IF(ERR2.GT.TOL2.OR.ERR3.GT.TOL3) GO TO 10
C
C           IF E0, E1 AND E2 ARE EQUAL TO WITHIN MACHINE
C           ACCURACY, CONVERGENCE IS ASSUMED.
C           RESULT=E2
C           ABSERR=ABS(E1-E0)+ABS(E2-E1)
C
        RESULT=RES
        ABSERR=ERR2+ERR3
        GO TO 50
   10   IF(I.NE.1) THEN
          E3=EPSTAB(K1)
          EPSTAB(K1)=E1
          DELTA1=E1-E3
          ERR1=ABS(DELTA1)
          TOL1=MAX(ABS(E1),ABS(E3))*RELPR
C
C           IF TWO ELEMENTS ARE VERY CLOSE TO EACH OTHER, OMIT
C           A PART OF THE TABLE BY ADJUSTING THE VALUE OF N
C
          IF(ERR1.LE.TOL1.OR.ERR2.LE.TOL2.OR.ERR3.LE.TOL3) GO TO 20
          SS=0.1E+01/DELTA1+0.1E+01/DELTA2-0.1E+01/DELTA3
        ELSE
          EPSTAB(K1)=E1
          IF(ERR2.LE.TOL2.OR.ERR3.LE.TOL3) GO TO 20
          SS=0.1E+01/DELTA2-0.1E+01/DELTA3
        ENDIF
C
C           TEST TO DETECT IRREGULAR BEHAVIOUR IN THE TABLE, AND
C           EVENTUALLY OMIT A PART OF THE TABLE ADJUSTING THE VALUE
C           OF N
C
        IF(ABS(SS*E1).GT.0.1E-03) GO TO 30
   20   N=I+I-1
        IF(NRES.EQ.0) THEN
          ABSERR=ERR2+ERR3
          RESULT=RES
        ELSE IF(NRES.EQ.1) THEN
          RESULT=RES3LA(1)
        ELSE IF(NRES.EQ.2) THEN
          RESULT=RES3LA(2)
        ELSE
          RESULT=RES3LA(3)
        ENDIF
        GO TO 50
C
C           COMPUTE A NEW ELEMENT AND EVENTUALLY ADJUST
C           THE VALUE OF RESULT
C
   30   RES=E1+0.1E+01/SS
        EPSTAB(K1)=RES
        K1=K1-2
        IF(NRES.EQ.0) THEN
          ABSERR=ERR2+ABS(RES-E2)+ERR3
          RESULT=RES
          GO TO 40
        ELSE IF(NRES.EQ.1) THEN
          ERROR=.6E+01*(ABS(RES-RES3LA(1)))
        ELSE IF(NRES.EQ.2) THEN
          ERROR=.2E+01*(ABS(RES-RES3LA(2))+ABS(RES-RES3LA(1)))
        ELSE
          ERROR=ABS(RES-RES3LA(3))+ABS(RES-RES3LA(2))
     1          +ABS(RES-RES3LA(1))
        ENDIF
        IF(ERROR.GT.1.0E+01*ABSERR) GO TO 40
        ABSERR=ERROR
        RESULT=RES
   40 CONTINUE
C
C           COMPUTE ERROR ESTIMATE
C
        IF(NRES.EQ.1) THEN
          ABSERR=.6E+01*(ABS(RESULT-RES3LA(1)))
        ELSE IF(NRES.EQ.2) THEN
          ABSERR=.2E+01*ABS(RESULT-RES3LA(2))+ABS(RESULT-RES3LA(1))
        ELSE IF(NRES.GT.2) THEN
          ABSERR=ABS(RESULT-RES3LA(3))+ABS(RESULT-RES3LA(2))
     1          +ABS(RESULT-RES3LA(1))
        ENDIF
C
C           SHIFT THE TABLE
C
   50 IF(N.EQ.LIMEXP) N=2*(LIMEXP/2)-1
      IB=1
      IF((NUM/2)*2.EQ.NUM) IB=2
      IE=NEWELM+1
      DO 60 I=1,IE
        IB2=IB+2
        EPSTAB(IB)=EPSTAB(IB2)
        IB=IB2
   60 CONTINUE
      IF(NUM.EQ.N) GO TO 80
      IN=NUM-N+1
      DO 70 I=1,N
        EPSTAB(I)=EPSTAB(IN)
        IN=IN+1
   70 CONTINUE
C
C           UPDATE RES3LA
C
   80 IF(NRES.EQ.0) THEN
        RES3LA(1)=RESULT
      ELSE IF(NRES.EQ.1) THEN
        RES3LA(2)=RESULT
      ELSE IF(NRES.EQ.2) THEN
        RES3LA(3)=RESULT
      ELSE
        RES3LA(1)=RES3LA(2)
        RES3LA(2)=RES3LA(3)
        RES3LA(3)=RESULT
      ENDIF
      ABSERR=MAX(ABSERR,EPRN*ABS(RESULT))
      NRES=NRES+1
  100 N=N+1
*     IF(N.LE.3) ABSERR = R1MACH(2) * (0.1D-03)
      EPSTAB(LIMEXP+3)=REAL(N)
      EPSTAB(LIMEXP+4)=REAL(NRES)
      EPSTAB(LIMEXP+5)=RES3LA(1)
      EPSTAB(LIMEXP+6)=RES3LA(2)
      EPSTAB(LIMEXP+7)=RES3LA(3)
  110 RETURN
      END
      FUNCTION EI (X)
C***BEGIN PROLOGUE  EI
C***PURPOSE  Compute the exponential integral Ei(X).
C***LIBRARY   SLATEC (FNLIB)
C***CATEGORY  C5
C***TYPE      SINGLE PRECISION (EI-S, DEI-D)
C***KEYWORDS  EI FUNCTION, EXPONENTIAL INTEGRAL, FNLIB,
C             SPECIAL FUNCTIONS
C***AUTHOR  Fullerton, W., (LANL)
C***DESCRIPTION
C
C EI calculates the single precision exponential integral, Ei(X), for
C positive single precision argument X and the Cauchy principal value
C for negative X.  If principal values are used everywhere, then, for
C all X,
C
C    Ei(X) = -E1(-X)
C or
C    E1(X) = -Ei(-X).
C
C***REFERENCES  (NONE)
C***ROUTINES CALLED  E1
C***REVISION HISTORY  (YYMMDD)
C   770401  DATE WRITTEN
C   891115  Modified prologue description.  (WRB)
C   891115  REVISION DATE from Version 3.2
C   891214  Prologue converted to Version 4.0 format.  (BAB)
C***END PROLOGUE  EI
C***FIRST EXECUTABLE STATEMENT  EI
      EI = -E1(-X)
C
      RETURN
      END
      SUBROUTINE EDGEF (NK,FC,GC,XX,YY,BFK,CDFX,POI,POJ,EPS3,IFLAG,L) 
C
C--- COMPUTE THE BETA C.D.F.'S BY A RECURRENCE RELATION ALONG THE EDGES
C--- I = IMIN AND J = JMIN OF A GRID.  THE CORRESPONDING COMPONENTS OF
C--- THE F" C.D.F. ARE INCLUDED IN THE SUMMATION.  TERMS WHICH MIGHT
C--- CAUSE UNDERFLOW ARE SET TO ZERO.
C
      DIMENSION BFK(*),POI(*),POJ(*)
      DOUBLE PRECISION DARG,DEUFLO,DLNGAM
      DATA DEUFLO / -30.0D0 / 
      EPS3=0.000001
      IFLAG=0
      FD = FC-1.0
      K = MAX0(L,MIN0(NK,INT((GC-1.0)*XX/YY-FD))) 
      FK = FD+REAL(K)
CCCCC CALL CDFBET (XX,FK,GC,EPS3,IFLAG,BFK(K))
      CALL BETCDF(XX,FK,GC,BFK(K))
CCCCC IF (IFLAG.NE.0) RETURN
      IF (L.EQ.1) BFK(K) = 1.0-BFK(K)
      IF (NK.EQ.1) GO TO 40
      DARG = DBLE(FK)*DLOG(DBLE(XX))+DBLE(GC)*DLOG(DBLE(YY))-
     *   DLOG(DBLE(FK))+DLNGAM(DBLE(FK+GC))-DLNGAM(DBLE(FK))-
     *   DLNGAM(DBLE(GC))
      IF (DARG.LT.DEUFLO) THEN
         DK = 0.0
      ELSE
         DK = SNGL(DEXP(DARG))*(-1.0)**L
      ENDIF
      IF (K.GE.NK) GO TO 20
      BFK(K+1) = BFK(K)-DK
      DI = DK
      KFLAG = 1
      DO 10 I = K+1, NK-1
         IF (KFLAG.EQ.1) THEN 
            DI = DI*(FD+GC+REAL(I-1))*XX/(FD+REAL(I))
            IF (DK+DI.EQ.DK) THEN
               KFLAG = 0
               DI = 0.0
            ENDIF
         ENDIF
         BFK(I+1) = BFK(I)-DI 
   10 CONTINUE
   20 DI = DK
      KFLAG = 1
      DO 30 I = K-1, L, -1
         IF (KFLAG.EQ.1) THEN 
            DI = DI*(FC+REAL(I))/((FD+GC+REAL(I))*XX)
            IF (DK+DI.EQ.DK) THEN
               KFLAG = 0
               DI = 0.0
            ENDIF
         ENDIF
         BFK(I) = BFK(I+1)+DI 
   30 CONTINUE
   40 DO 50 I = L, NK
         CDFX = CDFX+POI(I)*POJ(1)*BFK(I)
   50 CONTINUE
      RETURN
      END 
      SUBROUTINE EDGET(NK,FC,GC,XX,YY,BFK,CDFX,POI,POJ,EPS3,IFLAG,L) 
CCCCC CONVERT TO DOUBLE PRECISION.  SINGLE PRECISION GIVES INACCURATE
CCCCC RESULTS FOR 32-BIT MACHINES.
C
C--- COMPUTE THE BETA C.D.F.'S BY A RECURRENCE RELATION ALONG THE EDGES
C--- I = IMIN AND J = JMIN OF A GRID.  THE CORRESPONDING COMPONENTS OF
C--- THE T" C.D.F. ARE INCLUDED IN THE SUMMATION.  TERMS WHICH MIGHT
C--- CAUSE UNDERFLOW ARE SET TO ZERO.
C
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C
      DIMENSION BFK(*),POI(*),POJ(*)
CCCCC DOUBLE PRECISION DARG,DEUFLO,DLNGAM
      DATA DEUFLO / -69.0D0 / 
C
      EPS3=0.0
C
      FD = FC-1.0D0
      K = MAX0(L,MIN0(NK,INT((GC-1.0D0)*XX/YY-FD))) 
      FK = FD+DBLE(K)
CCCCC CALL BETCDF(SNGL(XX),SNGL(FK),SNGL(GC),ATEMP)
      BFK(K)=DBETAI(XX,FK,GC)
C
      IF (IFLAG.NE.0) RETURN
      IF (L.EQ.1) BFK(K) = 1.0D0-BFK(K)
      IF (NK.EQ.1) GO TO 40
      DARG = FK*DLOG(XX)+GC*DLOG(YY)-
     *   DLOG(FK)+DLNGAM(FK+GC)-DLNGAM(FK)-
     *   DLNGAM(GC)
      IF (DARG.LT.DEUFLO) THEN
         DK = 0.0D0
      ELSE
         DK = DEXP(DARG)*(-1.0D0)**L
      ENDIF
      IF (K.GE.NK) GO TO 20
      BFK(K+1) = BFK(K)-DK
      DI = DK
      KFLAG = 1
      DO 10 I = K+1, NK-1
         IF (KFLAG.EQ.1) THEN 
            DI = DI*(FD+GC+DBLE(I-1))*XX/(FD+DBLE(I))
            IF (DK+DI.EQ.DK) THEN
               KFLAG = 0
               DI = 0.0D0
            ENDIF
         ENDIF
         BFK(I+1) = BFK(I)-DI 
   10 CONTINUE
   20 DI = DK
      KFLAG = 1
      DO 30 I = K-1, L, -1
         IF (KFLAG.EQ.1) THEN 
            DI = DI*(FC+DBLE(I))/((FD+GC+DBLE(I))*XX)
            IF (DK+DI.EQ.DK) THEN
               KFLAG = 0
               DI = 0.0D0
            ENDIF
         ENDIF
         BFK(I) = BFK(I+1)+DI 
   30 CONTINUE
   40 DO 50 I = L, NK
         CDFX = CDFX+POI(I)*POJ(1)*BFK(I)
   50 CONTINUE
      RETURN
      END 
      SUBROUTINE EDGVER(EDGE1,EDGE2,NEDGE,Y,X,NVERT,IWRITE,
     1Y2,X2,TAG,NOUT,
     1IBUGA3,IERROR)
C
C     PURPOSE--GIVEN A LIST OF EDGES AND A SET OF ORIGINAL
C              VERTICES, GENERATE A NEW LIST OF VERTICES
C              CORRESPONDING TO THE EDGES.  NOTE THAT A
C              NUMBER OF COMBINATORIC/COMPUTATIONAL GEOMETRY
C              ALGORITHMS WORK WITH EDGES.  THIS IS A UTILITY
C              ROUTINE THAT MAKES IT EASIER TO PLOT THESE EDGES.
C     EXAMPLES--LET Y2 X2 TAG = EDGES TO VERTICES EDGE1 EDGE2 Y X
C     INPUT  ARGUMENTS--EDGE1  VECTOR IDENTIFYING FIRST VERTEX IN EDGE
C                       EDGE2  VECTOR IDENTIFYING SECOND VERTEX IN EDGE
C                       Y      Y-AXIS VECTOR
C                       X      X-AXIS VECTOR
C                       NEDGE  NUMBER OF EDGES
C                       NVERT  NUMBER OF VERTICES
C     OUTPUT ARGUMENTS--Y2     Y-AXIS VECTOR OF THE NEW VERTICES
C                       X2     X-AXIS VECTOR OF THE NEW VERTICES
C                       TAG    VECTOR IDENTIFYING PAIRS OF VERTICES
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2008/4
C     ORIGINAL VERSION--APRIL    2008.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 IWRITE
      CHARACTER*4 IBUGA3
      CHARACTER*4 IERROR
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
C
      DIMENSION EDGE1(*)
      DIMENSION EDGE2(*)
      DIMENSION Y(*)
      DIMENSION X(*)
      DIMENSION Y2(*)
      DIMENSION X2(*)
      DIMENSION TAG(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='EDGV'
      ISUBN2='ER  '
      IERROR='NO'
C
      IF(IBUGA3.EQ.'ON')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,51)
   51   FORMAT('***** AT THE BEGINNING OF EDGVER--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,52)IBUGA3,IWRITE,NEDGE,NVERT
   52   FORMAT('IBUGA3,IWRITE,NEDGE,NVERT = ',A4,2X,A4,2X,2I10)
        CALL DPWRST('XXX','BUG ')
        DO55I=1,NEDGE
          WRITE(ICOUT,56)I,EDGE1(I),EDGE2(I)
   56     FORMAT('I,EDGE1(I),EDGE2(I) = ',I8,2G15.7)
          CALL DPWRST('XXX','BUG ')
   55   CONTINUE
        DO65I=1,NVERT
          WRITE(ICOUT,66)I,Y(I),X(I)
   66     FORMAT('I,Y(I),X(I) = ',I8,2G15.7)
          CALL DPWRST('XXX','BUG ')
   65   CONTINUE
      ENDIF
C
C               ******************************************
C               **  STEP 1: CHECK THAT VERTICES ARE IN  **
C               **          THE RANGE (1,NVERT)         **
C               ******************************************
C
      DO100I=1,NEDGE
        ITEMP1=INT(EDGE1(I)+0.01)
        IF(ITEMP1.LT.1 .OR. ITEMP1.GT.NVERT)THEN
          WRITE(ICOUT,999)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,101)
  101     FORMAT('***** ERROR FROM EDGES TO VERTICES--')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,103)I
  103     FORMAT('      THE FIRST VERTEX FOR EDGE ',I8,' IS LESS ',
     1           'THAN ONE')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,105)NVERT
  105     FORMAT('      OR GREATER THAN THE NUMBER OF VERTICES (',I8,
     1           ').')
          CALL DPWRST('XXX','BUG ')
          IERROR='YES'
          GOTO9000
        ENDIF
C
        ITEMP2=INT(EDGE2(I)+0.01)
        IF(ITEMP2.LT.1 .OR. ITEMP2.GT.NVERT)THEN
          WRITE(ICOUT,999)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,101)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,113)I
  113     FORMAT('      THE SECOND VERTEX FOR EDGE ',I8,' IS LESS THAN')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,105)NVERT
          CALL DPWRST('XXX','BUG ')
          IERROR='YES'
          GOTO9000
        ENDIF
C
  100 CONTINUE
C
      ICNT1=0
      ICNT2=0
      DO200I=1,NEDGE
        ICNT2=ICNT2+1
        ITEMP1=INT(EDGE1(I)+0.01)
        ITEMP2=INT(EDGE2(I)+0.01)
        ICNT1=ICNT1+1
        Y2(ICNT1)=Y(ITEMP1)
        X2(ICNT1)=X(ITEMP1)
        TAG(ICNT1)=REAL(ICNT2)
        ICNT1=ICNT1+1
        Y2(ICNT1)=Y(ITEMP2)
        X2(ICNT1)=X(ITEMP2)
        TAG(ICNT1)=REAL(ICNT2)
  200 CONTINUE
C
      NOUT=ICNT1
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT.      **
C               *****************
C
 9000 CONTINUE
C
      IF(IBUGA3.EQ.'ON')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9011)
 9011   FORMAT('***** AT THE END OF EDGVER--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9014)NOUT
 9014   FORMAT('NOUT = ',I8)
        CALL DPWRST('XXX','BUG ')
        DO9015I=1,NOUT
          WRITE(ICOUT,9016)I,Y2(I),X2(I),TAG(I)
 9016     FORMAT('I,Y2(I),X2(I),TAG(I) = ',I8,3G15.7)
          CALL DPWRST('XXX','BUG ')
 9015   CONTINUE
      ENDIF
C
      RETURN
      END
      SUBROUTINE EEWCDF(X,AL,GAMMA1,SCALE1,GAMMA2,SCALE2,CDF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE CUMULATIVE DISTRIBUTION
C              FUNCTION VALUE FOR THE END-EFFECTS WEIBULL DISTRIBUTION.
C              THIS DISTRIBUTION IS USED IN MODELING FAILURES OF
C              CARBON FIBERS UNDER STRESS.  THE CDF IS DEFINED AS:
C
C              F(X,L,S1,G1,L2,S2,G2) =
C                 1 - EXP[-L*(X/S1)**G1 - (X/S2)**G2]
C                     X, L, S1, G1, S2, G2 > 0 
C
C             HERE, S1 AND G1 ARE THE SCALE AND SHAPE PARAMETERS
C             OF A WEIBULL DISTRIBUTION THAT MODELS "TRUE" FLAWS
C             AND S2 AND G2 ARE SCALE AND SHAPE PARAMETERS OF A
C             WEIBULL DISTRIBUTION THAT MODELS "END EFFECTS".  L
C             IS THE LENGTH OF THE FIBER (THIS SHOULD TYPICALLY BE
C             A KNOWN, FIXED VALUE).  NOTE THAT END-EFFECTS TYPICALLY
C             BECOME LESS PROMINENT AS THE FIBER LENGTH INCREASES
C             SINCE THE FIBER IS MORE LIKELY TO CONTAIN A FATAL FLAW.
C             
C     INPUT  ARGUMENTS--X      = THE DOUBLE PRECISION VALUE AT
C                                WHICH THE CUMULATIVE DISTRIBUTION
C                                FUNCTION IS TO BE EVALUATED.
C                                X SHOULD BE NON-NEGATIVE.
C                     --AL     = FIBER LENGTH
C                     --SCALE1 = SCALE PARAMETER (FIRST PART)
C                     --GAMMA1 = SHAPE PARAMETER (FIRST PART)
C                     --SCALE2 = SCALE PARAMETER (SECOND PART)
C                     --GAMMA2 = SHAPE PARAMETER (SECOND PART)
C     OUTPUT ARGUMENTS--CDF    = THE DOUBLE PRECISION CUMULATIVE
C                                DISTRIBUTION FUNCTION VALUE.
C     OUTPUT--THE DOUBLE PRECISION CUMULATIVE DISTRIBUTION
C             FUNCTION VALUE CDF FOR THE END-EFFECTS WEIBULL DISTRIBUTION
C             WITH 5 SHAPE PARAMETERS
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--X SHOULD BE NON-NEGATIVE.
C                 --GAMMA1,GAMMA2,SCALE1,SCALE2,AL SHOULD BE POSITIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--EXP.
C     MODE OF INTERNAL OPERATIONS--DOUBLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--STONER, EDIE, AND DURHAM (1994), "AN END-EFFECT MODEL
C                 FOR THE SINGLE-FILAMENT TENSILE TEST", JOURNAL OF
C                 OF MATERIALS SCIENCE, 29, PP. 6561-6574.
C               --NEWELL AND SAGENDORF (1999), "EXPERIMENTAL VERIFICATION
C                 OF THE END-EFFECT WEIBULL MODEL AS A PREDICTOR OF THE
C                 TENSILE STRENGTH OF KEVLAR-29 (POLY
C                 p-PHENYLENETEREPHTHALAMIDE) FIBRES AT DIFFERENCE GAUGE
C                 LENGTHS", HIGH PERFORMANCE POLYMERS, 11, PP. 297-305.
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2010.7
C     ORIGINAL VERSION--JULY      2010.
C
C---------------------------------------------------------------------
C
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      CDF=0.0D0
      IF(SCALE1.LE.0.0D0)THEN
        WRITE(ICOUT,5)
    5   FORMAT('***** ERROR--THE SCALE(1) PARAMETER FOR EEWCDF ',
     1         'IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)SCALE1
   46   FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7)
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(GAMMA1.LE.0.0D0)THEN
        WRITE(ICOUT,15)
   15   FORMAT('***** ERROR--THE GAMMA(1) SHAPE PARAMETER FOR EEWCDF ',
     1         'IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)GAMMA1
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(SCALE2.LE.0.0D0)THEN
        WRITE(ICOUT,25)
   25   FORMAT('***** ERROR--THE SCALE(2) PARAMETER FOR EEWCDF ',
     1         'IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)SCALE2
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(GAMMA2.LE.0.0D0)THEN
        WRITE(ICOUT,35)
   35   FORMAT('***** ERROR--THE GAMMA(2) SHAPE PARAMETER FOR EEWCDF ',
     1         'IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)GAMMA2
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(AL.LE.0.0D0)THEN
        WRITE(ICOUT,45)
   45   FORMAT('***** ERROR--THE FIBER LENGTH PARAMETER FOR EEWCDF ',
     1         'IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)AL
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
C
      IF(X.LE.0.0D0)THEN
        CDF=0.0D0
      ELSE
        DTERM1=-AL*(X/SCALE1)**GAMMA1
        DTERM2=(X/SCALE2)**GAMMA2
        CDF=DEXP(DTERM1 - DTERM2)
        CDF=1.0D0 - CDF
      ENDIF
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE EEWCD2(X,NX,LI,PI,NI,GAMMA1,SCALE1,GAMMA2,SCALE2,ALOC,
     1                  CDF,
     1                  ISUBRO,IBUGA2,IERROR)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE CUMULATIVE DISTRIBUTION
C              FUNCTION VALUE FOR THE END-EFFECTS WEIBULL DISTRIBUTION.
C              THIS DISTRIBUTION IS USED IN MODELING FAILURES OF
C              CARBON FIBERS UNDER STRESS.  THE CDF IS DEFINED AS:
C
C              F(X,L,S1,G1,L2,S2,G2) =
C                 1 - EXP[-L*(X/S1)**G1 - (X/S2)**G2]
C                     X, L, S1, G1, S2, G2 > 0 
C
C             HERE, S1 AND G1 ARE THE SCALE AND SHAPE PARAMETERS
C             OF A WEIBULL DISTRIBUTION THAT MODELS "TRUE" FLAWS
C             AND S2 AND G2 ARE SCALE AND SHAPE PARAMETERS OF A
C             WEIBULL DISTRIBUTION THAT MODELS "END EFFECTS".  L
C             IS THE LENGTH OF THE FIBER (THIS SHOULD TYPICALLY BE
C             A KNOWN, FIXED VALUE).  NOTE THAT END-EFFECTS TYPICALLY
C             BECOME LESS PROMINENT AS THE FIBER LENGTH INCREASES
C             SINCE THE FIBER IS MORE LIKELY TO CONTAIN A FATAL FLAW.
C
C             THE EEWCDF ROUTINE COMPUTES THIS FUNCTION FOR A SINGLE
C             VALUE OF L.  THIS ROUTINE COMPUTES THIS FUNCTION FOR
C             MULTIPLE VALUES OF L.  IT DOES THIS USING A MIXTURE
C             APPROACH.  THAT IS
C
C              F(X;L,GAMMA1,SCALE1,GAMMA2,SCALE2) = SUM[i=1 to NI]
C                  [p(i)*EEFCDF(X;L(i),GAMMA1,SCALE1,GAMMA2,SCALE2)]
C
C              WHERE NI IS THE NUMBER OF DISTINCT VALUES FOR L.
C
C              THIS ROUTINE ASSUMES THAT THE SCALE/SHAPE
C              PARAMETERS ARE FIXED (I.E., ONLY L VARIES).
C
C              CURRENTLY, WE RESTRICT L TO A MAXIMUM OF 10 DISTINCT
C              LEVELS.
C
C     INPUT  ARGUMENTS--X      = A VARIABLE CONTAINING THE VALUES AT WHICH
C                                THE CUMULATIVE DISTRIBUTION FUNCTION IS
C                                TO BE EVALUATED.
C                     --NX     = A PARAMETER THAT SPECIFIES THE NUMBER
C                                OF VALUES FOR X.
C                     --LI     = A VARIABLE CONTAINING THE GAUGE LENGTH
C                                PARAMETER L.
C                     --PI     = A VARIABLE CONTAINING THE "MIXING"
C                                PROPORTIONS FOR LI.
C                     --NI     = A PARAMETER THAT SPECIFIES THE NUMBER
C                                OF VALUES FOR LI AND PI.
C                     --GAMMA1 = SHAPE PARAMETER (FIRST PART)
C                     --SCALE1 = SCALE PARAMETER (FIRST PART)
C                     --GAMMA2 = SHAPE PARAMETER (SECOND PART)
C                     --SCALE2 = SCALE PARAMETER (SECOND PART)
C     OUTPUT ARGUMENTS--PDF    = A VARIABLE CONTAINING THE CUMULATIVE
C                                DISTRIBUTION FUNCTION VALUES.
C     OUTPUT--THE DOUBLE PRECISION CUMULATIVE DISTRIBUTION FUNCTION VALUES
C             CDF FOR THE END-EFFECTS WEIBULL DISTRIBUTION
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--X SHOULD BE NON-NEGATIVE.
C                 --GAMMA1,GAMMA2,SCALE1,SCALE2,AL SHOULD BE POSITIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--EEWCDF.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--NONE.
C     MODE OF INTERNAL OPERATIONS--DOUBLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--STONER, EDIE, AND DURHAM (1994), "AN END-EFFECT MODEL
C                 FOR THE SINGLE-FILAMENT TENSILE TEST", JOURNAL OF
C                 OF MATERIALS SCIENCE, 29, PP. 6561-6574.
C               --NEWELL AND SAGENDORF (1999), "EXPERIMENTAL VERIFICATION
C                 OF THE END-EFFECT WEIBULL MODEL AS A PREDICTOR OF THE
C                 TENSILE STRENGTH OF KEVLAR-29 (POLY
C                 p-PHENYLENETEREPHTHALAMIDE) FIBRES AT DIFFERENCE GAUGE
C                 LENGTHS", HIGH PERFORMANCE POLYMERS, 11, PP. 297-305.
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2010.10
C     ORIGINAL VERSION--NOVEMBER  2010.
C
C---------------------------------------------------------------------
C
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      DOUBLE PRECISION X(*)
      DOUBLE PRECISION LI(*)
      DOUBLE PRECISION PI(*)
      DOUBLE PRECISION CDF(*)
C
      CHARACTER*4 ISUBRO
      CHARACTER*4 IBUGA2
      CHARACTER*4 IERROR
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(IBUGA2.EQ.'ON' .OR. ISUBRO.EQ.'WCD2')THEN
        WRITE(ICOUT,51)
   51   FORMAT('***** AT THE BEGINNING OF EEWCD2')
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
      IF(NX.LT.1)THEN
        WRITE(ICOUT,1)
    1   FORMAT('***** ERROR IN END EFFECTS WEIBULL CDF--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,3)
    3   FORMAT('      THE NUMBER OF REQUESTED CDF VALUES IS ',
     1         'NON-POSITIVE.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,5)NX
    5   FORMAT('      THE NUMBER OF REQUESTED CDF VALUES  = ',I8)
        CALL DPWRST('XXX','BUG ')
        IERROR='YES'
        GOTO9000
      ELSEIF(NI.LT.1)THEN
        WRITE(ICOUT,1)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,13)
   13   FORMAT('      THE NUMBER OF DISTINCT GAUGE LENGTH (L) VALUES ',
     1         'IS NON-POSITIVE.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,15)NI
   15   FORMAT('      THE NUMBER OF REQUESTED L VALUES  = ',I8)
        CALL DPWRST('XXX','BUG ')
        IERROR='YES'
        GOTO9000
      ELSEIF(NI.GT.10)THEN
        WRITE(ICOUT,1)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,18)
   18   FORMAT('      THE NUMBER OF DISTINCT GAUGE LENGTH (L) VALUES ',
     1         'IS GREATER THAN 10.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,15)NI
        CALL DPWRST('XXX','BUG ')
        IERROR='YES'
        GOTO9000
      ELSEIF(SCALE1.LE.0.0D0)THEN
        WRITE(ICOUT,1)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,21)
   21   FORMAT('      THE SCALE(1) PARAMETER IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)SCALE1
   46   FORMAT('      THE VALUE OF THE ARGUMENT IS ',G15.7)
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(GAMMA1.LE.0.0D0)THEN
        WRITE(ICOUT,1)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,23)
   23   FORMAT('      THE GAMMA(1) SHAPE PARAMETER IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)GAMMA1
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(SCALE2.LE.0.0D0)THEN
        WRITE(ICOUT,1)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,25)
   25   FORMAT('      THE SCALE(2) PARAMETER IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)SCALE2
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(GAMMA2.LE.0.0D0)THEN
        WRITE(ICOUT,1)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,27)
   27   FORMAT('      THE GAMMA(2) SHAPE PARAMETER IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)GAMMA2
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
C
      DSUM1=0.0D0
      DO60I=1,NI
        IF(LI(I).LE.0.0D0)THEN
          WRITE(ICOUT,1)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,62)I
   62     FORMAT('      FOR ROW ',I8,' THE VALUE OF THE GAUGE LENGTH ',
     1           'ARGUMENT (L) IS NON-POSITIVE.')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,64)LI(I)
   64     FORMAT('      THE VALUE OF L(I)  = ',G15.7)
          CALL DPWRST('XXX','BUG ')
          GOTO9000
          IERROR='YES'
        ELSEIF(PI(I).LE.0.0D0 .OR. PI(I).GT.1.0D0)THEN
          WRITE(ICOUT,1)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,67)I
   67     FORMAT('      FOR ROW ',I8,' THE VALUE OF THE MIXING ',
     1           'ARGUMENT (P)')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,68)
   68     FORMAT('      IS OUTSIDE THE (0,1) INTERVAL).')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,69)PI(I)
   69     FORMAT('      THE VALUE OF P(I)  = ',G15.7)
          CALL DPWRST('XXX','BUG ')
          GOTO9000
          IERROR='YES'
        ENDIF
        DSUM1=DSUM1 + PI(I)
   60 CONTINUE
C
C     CHECK THAT MIXING PROPORTIONS SUM TO 1
C
      IF(ABS(DSUM1 - 1.0D0).GT.0.000001D0)THEN
        WRITE(ICOUT,1)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,63)
   63   FORMAT('      THE MIXING PROPORTIONS DO NOT SUM TO ONE.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,65)REAL(DSUM1)
   65   FORMAT('      THE SUM OF THE MIXING PROPORTIONS  = ',G15.7)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
C     NOW COMPUTE THE CDF BY SUMMING OVER THE L(I) CASES
C
      DO100I=1,NX
        IF(X(I).LE.ALOC)THEN
          CDF(I)=0.0D0
          GOTO100
        ENDIF
        DSUM1=0.0D0
        DO200J=1,NI
          DTERM1=X(I)-ALOC
          CALL EEWCDF(DTERM1,LI(J),GAMMA1,SCALE1,GAMMA2,SCALE2,DTERM2)
          DSUM1=DSUM1 + PI(J)*DTERM2
  200   CONTINUE
        CDF(I)=DSUM1
  100 CONTINUE
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE EEWPDF(X,AL,GAMMA1,SCALE1,GAMMA2,SCALE2,PDF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE PROBABILUITY DENSITY
C              FUNCTION VALUE FOR THE END-EFFECTS WEIBULL DISTRIBUTION.
C              THIS DISTRIBUTION IS USED IN MODELING FAILURES OF
C              CARBON FIBERS UNDER STRESS.  THE PDF IS DEFINED AS:
C
C              f(X,L,S1,G1,L2,S2,G2) =
C                 [L*G1*X**(G1-1)/S1**G1 + G2*X**(G2-1)/S2**G2]*
C                 EXP[-L*(X/S1)**G1 - (X/S2)**G2]
C                 X, L, S1, G1, S2, G2 > 0 
C
C             HERE, S1 AND G1 ARE THE SCALE AND SHAPE PARAMETERS
C             OF A WEIBULL DISTRIBUTION THAT MODELS "TRUE" FLAWS
C             AND S2 AND G2 ARE SCALE AND SHAPE PARAMETERS OF A
C             WEIBULL DISTRIBUTION THAT MODELS "END EFFECTS".  L
C             IS THE LENGTH OF THE FIBER (THIS SHOULD TYPICALLY BE
C             A KNOWN, FIXED VALUE).  NOTE THAT END-EFFECTS TYPICALLY
C             BECOME LESS PROMINENT AS THE FIBER LENGTH INCREASES
C             SINCE THE FIBER IS MORE LIKELY TO CONTAIN A FATAL FLAW.
C             
C     INPUT  ARGUMENTS--X      = THE DOUBLE PRECISION VALUE AT
C                                WHICH THE PROBABILITY DENSITY
C                                FUNCTION IS TO BE EVALUATED.
C                                X SHOULD BE NON-NEGATIVE.
C                     --AL     = FIBER LENGTH
C                     --SCALE1 = SCALE PARAMETER (FIRST PART)
C                     --GAMMA1 = SHAPE PARAMETER (FIRST PART)
C                     --SCALE2 = SCALE PARAMETER (SECOND PART)
C                     --GAMMA2 = SHAPE PARAMETER (SECOND PART)
C     OUTPUT ARGUMENTS--PDF    = THE DOUBLE PRECISION PROBABILITY DENSITY
C                                FUNCTION VALUE.
C     OUTPUT--THE DOUBLE PRECISION PROBABILITY DENSITY FUNCTION VALUE PDF
C             FOR THE END-EFFECTS WEIBULL DISTRIBUTION
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--X SHOULD BE NON-NEGATIVE.
C                 --GAMMA1,GAMMA2,SCALE1,SCALE2,AL SHOULD BE POSITIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--EXP.
C     MODE OF INTERNAL OPERATIONS--DOUBLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--STONER, EDIE, AND DURHAM (1994), "AN END-EFFECT MODEL
C                 FOR THE SINGLE-FILAMENT TENSILE TEST", JOURNAL OF
C                 OF MATERIALS SCIENCE, 29, PP. 6561-6574.
C               --NEWELL AND SAGENDORF (1999), "EXPERIMENTAL VERIFICATION
C                 OF THE END-EFFECT WEIBULL MODEL AS A PREDICTOR OF THE
C                 TENSILE STRENGTH OF KEVLAR-29 (POLY
C                 p-PHENYLENETEREPHTHALAMIDE) FIBRES AT DIFFERENCE GAUGE
C                 LENGTHS", HIGH PERFORMANCE POLYMERS, 11, PP. 297-305.
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2010.7
C     ORIGINAL VERSION--JULY      2010.
C
C---------------------------------------------------------------------
C
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      PDF=0.0D0
      IF(X.LE.0.0D0)THEN
        WRITE(ICOUT,55)
   55   FORMAT('***** ERROR--THE FIRST ARGUMENT TO EEWPDF IS ',
     1         'NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)X
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(SCALE1.LE.0.0D0)THEN
        WRITE(ICOUT,5)
    5   FORMAT('***** ERROR--THE SCALE(1) PARAMETER FOR EEWPDF ',
     1         'IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)SCALE1
   46   FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7)
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(GAMMA1.LE.0.0D0)THEN
        WRITE(ICOUT,15)
   15   FORMAT('***** ERROR--THE GAMMA(1) SHAPE PARAMETER FOR EEWPDF ',
     1         'IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)GAMMA1
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(SCALE2.LE.0.0D0)THEN
        WRITE(ICOUT,25)
   25   FORMAT('***** ERROR--THE SCALE(2) PARAMETER FOR EEWPDF ',
     1         'IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)SCALE2
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(GAMMA2.LE.0.0D0)THEN
        WRITE(ICOUT,35)
   35   FORMAT('***** ERROR--THE GAMMA(2) SHAPE PARAMETER FOR EEWPDF ',
     1         'IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)GAMMA2
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(AL.LE.0.0D0)THEN
        WRITE(ICOUT,45)
   45   FORMAT('***** ERROR--THE FIBER LENGTH PARAMETER FOR EEWPDF ',
     1         'IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)AL
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
C
      DTERM1=AL*GAMMA1*(X**(GAMMA1-1.0D0))/(SCALE1**GAMMA1)
      DTERM2=GAMMA2*(X**(GAMMA2-1.0D0))/(SCALE2**GAMMA2)
      DTERM3=-AL*(X/SCALE1)**GAMMA1
      DTERM4=(X/SCALE2)**GAMMA2
      PDF=(DTERM1 + DTERM2)*DEXP(DTERM3 - DTERM4)
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE EEWPD2(X,NX,LI,PI,NI,GAMMA1,SCALE1,GAMMA2,SCALE2,ALOC,
     1                  PDF,
     1                  ISUBRO,IBUGA2,IERROR)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE PROBABILUITY DENSITY
C              FUNCTION VALUE FOR THE END-EFFECTS WEIBULL DISTRIBUTION.
C              THIS DISTRIBUTION IS USED IN MODELING FAILURES OF
C              CARBON FIBERS UNDER STRESS.  THE PDF IS DEFINED AS:
C
C              f(X,L,S1,G1,L2,S2,G2) =
C                 [L*G1*X**(G1-1)/S1**G1 + G2*X**(G2-1)/S2**G2]*
C                 EXP[-L*(X/S1)**G1 - (X/S2)**G2]
C                 X, L, S1, G1, S2, G2 > 0 
C
C             HERE, S1 AND G1 ARE THE SCALE AND SHAPE PARAMETERS
C             OF A WEIBULL DISTRIBUTION THAT MODELS "TRUE" FLAWS
C             AND S2 AND G2 ARE SCALE AND SHAPE PARAMETERS OF A
C             WEIBULL DISTRIBUTION THAT MODELS "END EFFECTS".  L
C             IS THE LENGTH OF THE FIBER (THIS SHOULD TYPICALLY BE
C             A KNOWN, FIXED VALUE).  NOTE THAT END-EFFECTS TYPICALLY
C             BECOME LESS PROMINENT AS THE FIBER LENGTH INCREASES
C             SINCE THE FIBER IS MORE LIKELY TO CONTAIN A FATAL FLAW.
C
C             THE EEWPDF ROUTINE COMPUTES THIS FUNCTION FOR A SINGLE
C             VALUE OF L.  THIS ROUTINE COMPUTES THIS FUNCTION FOR
C             MULTIPLE VALUES OF L.  IT DOES THIS USING A MIXTURE
C             APPROACH.  THAT IS
C
C              f(X;L,GAMMA1,SCALE1,GAMMA2,SCALE2) = SUM[i=1 to NI]
C                  [p(i)*EEFPDF(X;L(i),GAMMA1,SCALE1,GAMMA2,SCALE2)]
C
C              WHERE NI IS THE NUMBER OF DISTINCT VALUES FOR L.
C
C              THIS ROUTINE ASSUMES THAT THE SCALE/SHAPE
C              PARAMETERS ARE FIXED (I.E., ONLY L VARIES).
C
C              CURRENTLY, WE RESTRICT L TO A MAXIMUM OF 10 DISTINCT
C              LEVELS.
C
C     INPUT  ARGUMENTS--X      = A VARIABLE CONTAINING THE VALUES AT WHICH
C                                THE PROBABILITY DENSITY FUNCTION IS TO
C                                BE EVALUATED.
C                     --NX     = A PARAMETER THAT SPECIFIES THE NUMBER
C                                OF VALUES FOR X.
C                     --LI     = A VARIABLE CONTAINING THE GAUGE LENGTH
C                                PARAMETER L.
C                     --PI     = A VARIABLE CONTAINING THE "MIXING"
C                                PROPORTIONS FOR LI.
C                     --NI     = A PARAMETER THAT SPECIFIES THE NUMBER
C                                OF VALUES FOR LI AND PI.
C                     --GAMMA1 = SHAPE PARAMETER (FIRST PART)
C                     --SCALE1 = SCALE PARAMETER (FIRST PART)
C                     --GAMMA2 = SHAPE PARAMETER (SECOND PART)
C                     --SCALE2 = SCALE PARAMETER (SECOND PART)
C     OUTPUT ARGUMENTS--PDF    = A VARIABLE CONTAINING THE PROBABILITY
C                                DENSITY FUNCTION VALUES.
C     OUTPUT--THE DOUBLE PRECISION PROBABILITY DENSITY FUNCTION VALUE PDF
C             FOR THE END-EFFECTS WEIBULL DISTRIBUTION
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--X SHOULD BE NON-NEGATIVE.
C                 --GAMMA1,GAMMA2,SCALE1,SCALE2,AL SHOULD BE POSITIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--EEWPDF.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--NONE.
C     MODE OF INTERNAL OPERATIONS--DOUBLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--STONER, EDIE, AND DURHAM (1994), "AN END-EFFECT MODEL
C                 FOR THE SINGLE-FILAMENT TENSILE TEST", JOURNAL OF
C                 OF MATERIALS SCIENCE, 29, PP. 6561-6574.
C               --NEWELL AND SAGENDORF (1999), "EXPERIMENTAL VERIFICATION
C                 OF THE END-EFFECT WEIBULL MODEL AS A PREDICTOR OF THE
C                 TENSILE STRENGTH OF KEVLAR-29 (POLY
C                 p-PHENYLENETEREPHTHALAMIDE) FIBRES AT DIFFERENCE GAUGE
C                 LENGTHS", HIGH PERFORMANCE POLYMERS, 11, PP. 297-305.
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2010.10
C     ORIGINAL VERSION--NOVEMBER  2010.
C
C---------------------------------------------------------------------
C
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      DOUBLE PRECISION X(*)
      DOUBLE PRECISION LI(*)
      DOUBLE PRECISION PI(*)
      DOUBLE PRECISION PDF(*)
C
      CHARACTER*4 ISUBRO
      CHARACTER*4 IBUGA2
      CHARACTER*4 IERROR
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IERROR='NO'
      IF(NX.LT.1)THEN
        WRITE(ICOUT,1)
    1   FORMAT('***** ERROR IN END EFFECTS WEIBULL PDF--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,3)
    3   FORMAT('      THE NUMBER OF REQUESTED PDF VALUES IS ',
     1         'NON-POSITIVE.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,5)NX
    5   FORMAT('      THE NUMBER OF REQUESTED PDF VALUES  = ',I8)
        CALL DPWRST('XXX','BUG ')
        IERROR='YES'
        GOTO9000
      ELSEIF(NI.LT.1)THEN
        WRITE(ICOUT,1)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,13)
   13   FORMAT('      THE NUMBER OF DISTINCT GAUGE LENGTH (L) VALUES ',
     1         'IS NON-POSITIVE.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,15)NI
   15   FORMAT('      THE NUMBER OF REQUESTED L VALUES  = ',I8)
        CALL DPWRST('XXX','BUG ')
        IERROR='YES'
        GOTO9000
      ELSEIF(NI.GT.10)THEN
        WRITE(ICOUT,1)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,18)
   18   FORMAT('      THE NUMBER OF DISTINCT GAUGE LENGTH (L) VALUES ',
     1         'IS GREATER THAN 10.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,15)NI
        CALL DPWRST('XXX','BUG ')
        IERROR='YES'
        GOTO9000
      ELSEIF(SCALE1.LE.0.0D0)THEN
        WRITE(ICOUT,1)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,21)
   21   FORMAT('      THE SCALE(1) PARAMETER IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)SCALE1
   46   FORMAT('      THE VALUE OF THE ARGUMENT IS ',G15.7)
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(GAMMA1.LE.0.0D0)THEN
        WRITE(ICOUT,1)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,23)
   23   FORMAT('      THE GAMMA(1) SHAPE PARAMETER IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)GAMMA1
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(SCALE2.LE.0.0D0)THEN
        WRITE(ICOUT,1)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,25)
   25   FORMAT('      THE SCALE(2) PARAMETER IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)SCALE2
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(GAMMA2.LE.0.0D0)THEN
        WRITE(ICOUT,1)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,27)
   27   FORMAT('      THE GAMMA(2) SHAPE PARAMETER IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)GAMMA2
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
C
      DO50I=1,NX
        IF(X(I).LE.ALOC)THEN
          WRITE(ICOUT,1)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,55)I
   55     FORMAT('      FOR ROW ',I8,' THE VALUE OF THE INPUT ',
     1           'ARGUMENT IS')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,56)
   56     FORMAT('      LESS THAN OR EQUAL TO THE VALUE OF THE ',
     1           'LOCATION PARAMETER')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,58)X(I)
   58     FORMAT('      THE VALUE OF X(I)                    = ',G15.7)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,59)ALOC
   59     FORMAT('      THE VALUE OF THE LOCATION PARAMETER  = ',G15.7)
          CALL DPWRST('XXX','BUG ')
          GOTO9000
          IERROR='YES'
        ENDIF
   50 CONTINUE
C
      DSUM1=0.0D0
      DO60I=1,NI
        IF(LI(I).LE.0.0D0)THEN
          WRITE(ICOUT,1)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,62)I
   62     FORMAT('      FOR ROW ',I8,' THE VALUE OF THE GAUGE LENGTH ',
     1           'ARGUMENT (L) IS NON-POSITIVE.')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,64)LI(I)
   64     FORMAT('      THE VALUE OF L(I)  = ',G15.7)
          CALL DPWRST('XXX','BUG ')
          GOTO9000
          IERROR='YES'
        ELSEIF(PI(I).LE.0.0D0 .OR. PI(I).GT.1.0D0)THEN
          WRITE(ICOUT,1)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,67)I
   67     FORMAT('      FOR ROW ',I8,' THE VALUE OF THE MIXING ',
     1           'ARGUMENT (P)')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,68)
   68     FORMAT('      IS OUTSIDE THE (0,1) INTERVAL).')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,69)PI(I)
   69     FORMAT('      THE VALUE OF P(I)  = ',G15.7)
          CALL DPWRST('XXX','BUG ')
          GOTO9000
          IERROR='YES'
        ENDIF
        DSUM1=DSUM1 + PI(I)
   60 CONTINUE
C
C     CHECK THAT MIXING PROPORTIONS SUM TO 1
C
      IF(ABS(DSUM1 - 1.0D0).GT.0.000001D0)THEN
        WRITE(ICOUT,1)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,63)
   63   FORMAT('      THE MIXING PROPORTIONS DO NOT SUM TO ONE.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,65)REAL(DSUM1)
   65   FORMAT('      THE SUM OF THE MIXING PROPORTIONS  = ',G15.7)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
C     NOW COMPUTE THE PDF BY SUMMING OVER THE L(I) CASES
C
      DO100I=1,NX
        DSUM1=0.0D0
        DO200J=1,NI
          DTERM1=X(I)-ALOC
          CALL EEWPDF(DTERM1,LI(J),GAMMA1,SCALE1,GAMMA2,SCALE2,DTERM2)
          DSUM1=DSUM1 + PI(J)*DTERM2
  200   CONTINUE
        PDF(I)=DSUM1
  100 CONTINUE
C
 9000 CONTINUE
C
      IF(IBUGA2.EQ.'ON' .OR. ISUBRO.EQ.'WPDF')THEN
        WRITE(ICOUT,9010)
 9010   FORMAT('****** AT THE END OF EEWPD2')
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
      RETURN
      END
      SUBROUTINE EEWPPF(P,AL,GAMMA1,SCALE1,GAMMA2,SCALE2,PPF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE PERCENT POINT
C              FUNCTION VALUE FOR THE END-EFFECTS WEIBULL DISTRIBUTION.
C              THIS DISTRIBUTION IS USED IN MODELING FAILURES OF
C              CARBON FIBERS UNDER STRESS.  THE CDF IS DEFINED AS:
C
C              F(X,L,S1,G1,L2,S2,G2) =
C                 1 - EXP[-L*(X/S1)**G1 - (X/S2)**G2]
C                     X, L, S1, G1, S2, G2 > 0 
C
C             HERE, S1 AND G1 ARE THE SCALE AND SHAPE PARAMETERS
C             OF A WEIBULL DISTRIBUTION THAT MODELS "TRUE" FLAWS
C             AND S2 AND G2 ARE SCALE AND SHAPE PARAMETERS OF A
C             WEIBULL DISTRIBUTION THAT MODELS "END EFFECTS".  L
C             IS THE LENGTH OF THE FIBER (THIS SHOULD TYPICALLY BE
C             A KNOWN, FIXED VALUE).  NOTE THAT END-EFFECTS TYPICALLY
C             BECOME LESS PROMINENT AS THE FIBER LENGTH INCREASES
C             SINCE THE FIBER IS MORE LIKELY TO CONTAIN A FATAL FLAW.
C
C             THE PERCENT POINT FUNCTION IS COMPUTED BY NUMERICALLY
C             INVERTING THE CDF FUNCTION.
C
C     INPUT  ARGUMENTS--P      = THE DOUBLE PRECISION VALUE AT
C                                WHICH THE PERCENT POINT
C                                FUNCTION IS TO BE EVALUATED.
C                     --AL     = FIBER LENGTH
C                     --SCALE1 = SCALE PARAMETER (FIRST PART)
C                     --GAMMA1 = SHAPE PARAMETER (FIRST PART)
C                     --SCALE2 = SCALE PARAMETER (SECOND PART)
C                     --GAMMA2 = SHAPE PARAMETER (SECOND PART)
C     OUTPUT ARGUMENTS--CDF    = THE DOUBLE PRECISION CUMULATIVE
C                                DISTRIBUTION FUNCTION VALUE.
C     OUTPUT--THE DOUBLE PRECISION CUMULATIVE DISTRIBUTION
C             FUNCTION VALUE CDF FOR THE END-EFFECTS WEIBULL DISTRIBUTION
C             WITH 5 SHAPE PARAMETERS
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--X SHOULD BE NON-NEGATIVE.
C                 --GAMMA1,GAMMA2,SCALE1,SCALE2,AL SHOULD BE POSITIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--EXP.
C     MODE OF INTERNAL OPERATIONS--DOUBLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--STONER, EDIE, AND DURHAM (1994), "AN END-EFFECT MODEL
C                 FOR THE SINGLE-FILAMENT TENSILE TEST", JOURNAL OF
C                 OF MATERIALS SCIENCE, 29, PP. 6561-6574.
C               --NEWELL AND SAGENDORF (1999), "EXPERIMENTAL VERIFICATION
C                 OF THE END-EFFECT WEIBULL MODEL AS A PREDICTOR OF THE
C                 TENSILE STRENGTH OF KEVLAR-29 (POLY
C                 p-PHENYLENETEREPHTHALAMIDE) FIBRES AT DIFFERENCE GAUGE
C                 LENGTHS", HIGH PERFORMANCE POLYMERS, 11, PP. 297-305.
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2010.7
C     ORIGINAL VERSION--JULY      2010.
C
C---------------------------------------------------------------------
C
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C
      INCLUDE 'DPCOP2.INC'
C
      DATA DEPS /0.000000001/
      DATA DSIG /1.0D-9/
      DATA MAXIT /2000/
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      PPF=0.0D0
      IF(P.LT.0.0D0 .OR. P.GE.1.0D0)THEN
        WRITE(ICOUT,55)
   55   FORMAT('***** ERROR--THE FIRST ARGUMENT TO EEWPPF IS OUTSIDE ',
     1         'THE (0,1) INTERVAL')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)P
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(SCALE1.LE.0.0D0)THEN
        WRITE(ICOUT,5)
    5   FORMAT('***** ERROR--THE SCALE(1) PARAMETER FOR EEWPPF ',
     1         'IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)SCALE1
   46   FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7)
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(GAMMA1.LE.0.0D0)THEN
        WRITE(ICOUT,15)
   15   FORMAT('***** ERROR--THE GAMMA(1) SHAPE PARAMETER FOR EEWPPF ',
     1         'IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)GAMMA1
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(SCALE2.LE.0.0D0)THEN
        WRITE(ICOUT,25)
   25   FORMAT('***** ERROR--THE SCALE(2) PARAMETER FOR EEWPPF ',
     1         'IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)SCALE2
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(GAMMA2.LE.0.0D0)THEN
        WRITE(ICOUT,35)
   35   FORMAT('***** ERROR--THE GAMMA(2) SHAPE PARAMETER FOR EEWPPF ',
     1         'IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)GAMMA2
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(AL.LE.0.0D0)THEN
        WRITE(ICOUT,45)
   45   FORMAT('***** ERROR--THE FIBER LENGTH PARAMETER FOR EEWPPF ',
     1         'IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)AL
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
C
      IF(P.LE.0.0D0)THEN
        PPF=0.0D0
        GOTO9000
      ENDIF
C
C     COMPUTE PPF NUMERICALLY
C
C
C     FIND BRACKETING INTERVAL.
C
      DXL=0.0D0
      DXINC=MAX(SCALE1,SCALE2)
      IF(DXINC.LT.1.0D0)DXINC=1.0D0
      ICOUNT=0
      MAXCNT=10000
C
   91 CONTINUE
      DXR=DXL+DXINC
      IF(DXL.LE.0.0D0)DXL=0.0D0
      IF(DXR.LE.0.0D0)DXR=DXL+DXINC
      CALL EEWCDF(DXL,AL,GAMMA1,SCALE1,GAMMA2,SCALE2,CDFL)
      CALL EEWCDF(DXR,AL,GAMMA1,SCALE1,GAMMA2,SCALE2,CDFR)
      IF(CDFL.LT.P .AND. CDFR.LT.P)THEN
        DXL=DXR
      ELSEIF(CDFL.GT.P .AND. CDFR.GT.P)THEN
        DXL=DXL-DXINC
      ELSE
        GOTO99
      ENDIF
      ICOUNT=ICOUNT+1
      IF(ICOUNT.GT.MAXCNT)THEN
        WRITE(ICOUT,96)
        CALL DPWRST('XXX','BUG ')
        PPF=0.0D0
        GOTO9000
      ENDIF
   96 FORMAT('***** ERROR--EEWPPF UNABLE TO FIND BRACKETING INTERVAL')
      GOTO91
C
C  BISECTION METHOD
C
   99 CONTINUE
      IC = 0
      DFXL = -P
      DFXR = 1.0D0 - P
  105 CONTINUE
      DX = (DXL+DXR)*0.5D0
      CALL EEWCDF(DX,AL,GAMMA1,SCALE1,GAMMA2,SCALE2,DCDF)
      DP1=DCDF
      DPPF=DX
      PPF=DPPF
      DFCS = DP1 - P
      IF(DFCS*DFXL.GT.0.0D0)GOTO110
      DXR = DX
      DFXR = DFCS 
      GOTO115
  110 CONTINUE
      DXL = DX
      DFXL = DFCS
  115 CONTINUE
      DXRML = DXR - DXL
      IF(DXRML.LE.DSIG .AND. DABS(DFCS).LE.DEPS)GOTO9000
      IC = IC + 1
      IF(IC.LE.MAXIT)GOTO105
      WRITE(ICOUT,130)
      CALL DPWRST('XXX','BUG ')
  130 FORMAT('***** ERROR--EEWPPF ROUTINE DID NOT CONVERGE. ***')
      GOTO9000
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE EEWPP2(P,NX,LI,PI,NI,GAMMA1,SCALE1,GAMMA2,SCALE2,ALOC,
     1                  PPF,
     1                  ISUBRO,IBUGA2,IERROR)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE PERCENT POINT
C              FUNCTION VALUE FOR THE END EFFECTS WEIBULL
C              DISTRIBUTION.
C
C              THE EEWPPF ROUTINE COMPUTES THIS FUNCTION FOR A SINGLE
C              VALUE OF L.  THIS ROUTINE COMPUTES THIS FUNCTION FOR
C              MULTIPLE VALUES OF L.  IT DOES THIS USING A MIXTURE
C              APPROACH.  EEWPP2 COMPUTES THE PPF FUNCTION BY
C              NUMERICALLY INVERTING THE CUMULATIVE DISTRIBUTION
C              FUNCTION.
C
C              THIS ROUTINE ASSUMES THAT THE LOCATION/SCALE/SHAPE
C              PARAMETERS ARE FIXED (I.E., ONLY L VARIES).
C
C              CURRENTLY, WE RESTRICT L TO A MAXIMUM OF 10 DISTINCT
C              LEVELS.
C
C     INPUT  ARGUMENTS--P      = A VARIABLE CONTAINING THE VALUES AT WHICH
C                                THE PERCENT POINT FUNCTION IS
C                                TO BE EVALUATED.
C                     --NX     = A PARAMETER THAT SPECIFIES THE NUMBER
C                                OF VALUES FOR P.
C                     --LI     = A VARIABLE CONTAINING THE GAUGE LENGTH
C                                PARAMETER L.
C                     --PI     = A VARIABLE CONTAINING THE "MIXING"
C                                PROPORTIONS FOR LI.
C                     --NI     = A PARAMETER THAT SPECIFIES THE NUMBER
C                                OF VALUES FOR LI AND PI.
C                     --GAMMA1 = SHAPE PARAMETER (FIRST PART)
C                     --SCALE1 = SCALE PARAMETER (FIRST PART)
C                     --GAMMA2 = SHAPE PARAMETER (SECOND PART)
C                     --SCALE2 = SCALE PARAMETER (SECOND PART)
C     OUTPUT ARGUMENTS--PPF    = A VARIABLE CONTAINING THE PERCENT POINT
C                                FUNCTION VALUES.
C     OUTPUT--THE DOUBLE PRECISION PERCENT POINT FUNCTION VALUES.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     OTHER DATAPAC   SUBROUTINES NEEDED--EEWCD2.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--NONE.
C     MODE OF INTERNAL OPERATIONS--DOUBLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--STONER, EDIE, AND DURHAM (1994), "AN END-EFFECT MODEL
C                 FOR THE SINGLE-FILAMENT TENSILE TEST", JOURNAL OF
C                 OF MATERIALS SCIENCE, 29, PP. 6561-6574.
C               --NEWELL AND SAGENDORF (1999), "EXPERIMENTAL VERIFICATION
C                 OF THE END-EFFECT WEIBULL MODEL AS A PREDICTOR OF THE
C                 TENSILE STRENGTH OF KEVLAR-29 (POLY
C                 p-PHENYLENETEREPHTHALAMIDE) FIBRES AT DIFFERENCE GAUGE
C                 LENGTHS", HIGH PERFORMANCE POLYMERS, 11, PP. 297-305.
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2010.11
C     ORIGINAL VERSION--NOVEMBER  2010.
C
C---------------------------------------------------------------------
C
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C
      DOUBLE PRECISION P(*)
      DOUBLE PRECISION LI(*)
      DOUBLE PRECISION PI(*)
      DOUBLE PRECISION PPF(*)
C
      DOUBLE PRECISION DCDF(1)
      DOUBLE PRECISION DX(1)
C
      DOUBLE PRECISION LMIN
      DOUBLE PRECISION LMAX
C
      CHARACTER*4 ISUBRO
      CHARACTER*4 IBUGA2
      CHARACTER*4 IERROR
C
      INCLUDE 'DPCOP2.INC'
C
      DATA DEPS /1.0D-14/
      DATA DSIG /1.0D-14/
      DATA MAXIT /1000/
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(NX.LT.1)THEN
        WRITE(ICOUT,1)
    1   FORMAT('***** ERROR IN END EFFECTS WEIBULL PPF--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,3)
    3   FORMAT('      THE NUMBER OF REQUESTED PPF VALUES IS ',
     1         'NON-POSITIVE.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,5)NX
    5   FORMAT('      THE NUMBER OF REQUESTED PPF VALUES  = ',I8)
        CALL DPWRST('XXX','BUG ')
        IERROR='YES'
        GOTO9000
      ELSEIF(NI.LT.1)THEN
        WRITE(ICOUT,1)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,13)
   13   FORMAT('      THE NUMBER OF DISTINCT GAUGE LENGTH (L) VALUES ',
     1         'IS NON-POSITIVE.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,15)NI
   15   FORMAT('      THE NUMBER OF REQUESTED L VALUES  = ',I8)
        CALL DPWRST('XXX','BUG ')
        IERROR='YES'
        GOTO9000
      ELSEIF(NI.GT.10)THEN
        WRITE(ICOUT,1)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,18)
   18   FORMAT('      THE NUMBER OF DISTINCT GAUGE LENGTH (L) VALUES ',
     1         'IS GREATER THAN 10.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,15)NI
        CALL DPWRST('XXX','BUG ')
        IERROR='YES'
        GOTO9000
      ELSEIF(SCALE1.LE.0.0D0)THEN
        WRITE(ICOUT,1)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,21)
   21   FORMAT('      THE SCALE(1) PARAMETER IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)SCALE1
   46   FORMAT('      THE VALUE OF THE ARGUMENT IS ',G15.7)
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(GAMMA1.LE.0.0D0)THEN
        WRITE(ICOUT,1)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,23)
   23   FORMAT('      THE GAMMA(1) SHAPE PARAMETER IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)GAMMA1
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(SCALE2.LE.0.0D0)THEN
        WRITE(ICOUT,1)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,25)
   25   FORMAT('      THE SCALE(2) PARAMETER IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)SCALE2
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(GAMMA2.LE.0.0D0)THEN
        WRITE(ICOUT,1)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,27)
   27   FORMAT('      THE GAMMA(2) SHAPE PARAMETER IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)GAMMA2
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
C
      DSUM1=0.0D0
      DO50I=1,NI
        IF(LI(I).LE.0.0D0)THEN
          WRITE(ICOUT,1)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,52)I
   52     FORMAT('      FOR ROW ',I8,' THE VALUE OF THE GAUGE LENGTH ',
     1           'ARGUMENT (L) IS NON-POSITIVE.')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,54)LI(I)
   54     FORMAT('      THE VALUE OF L(I)  = ',G15.7)
          CALL DPWRST('XXX','BUG ')
          GOTO9000
          IERROR='YES'
        ELSEIF(PI(I).LE.0.0D0 .OR. PI(I).GT.1.0D0)THEN
          WRITE(ICOUT,1)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,57)I
   57     FORMAT('      FOR ROW ',I8,' THE VALUE OF THE MIXING ',
     1           'ARGUMENT (P)')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,58)
   58     FORMAT('      OUTSIDE THE (0,1) INTERVAL).')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,59)PI(I)
   59     FORMAT('      THE VALUE OF P(I)  = ',G15.7)
          CALL DPWRST('XXX','BUG ')
          GOTO9000
          IERROR='YES'
        ENDIF
        DSUM1=DSUM1 + PI(I)
   50 CONTINUE
C
C     CHECK THAT MIXING PROPORTIONS SUM TO 1
C
      IF(ABS(DSUM1 - 1.0D0).GT.0.000001D0)THEN
        WRITE(ICOUT,1)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,63)
   63   FORMAT('      THE MIXING PROPORTIONS DO NOT SUM TO ONE.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,65)REAL(DSUM1)
   65   FORMAT('      THE SUM OF THE MIXING PROPORTIONS  = ',G15.7)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
C     NOW COMPUTE THE PPF BY NUMERICALLY INVERTING THE CDF FUNCTION
C
      NTEMP=1
      LMIN=LI(1)
      LMAX=LI(1)
      DO90I=1,NI
        IF(LI(I).LT.LMIN)LMIN=LI(I)
        IF(LI(I).GT.LMAX)LMAX=LI(I)
   90 CONTINUE
C
      DO100I=1,NX
        DP=P(I)
C
        IF(DP.LT.0.0D0 .OR. DP.GE.1.0D0)THEN
          WRITE(ICOUT,1)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,105)I
  105     FORMAT('      FOR ROW ',I8,' THE PROBABILITY PARAMETER (P) ',
     1           'IS OUTSIDE THE (0,1) INTERVAL.')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,106)DP
  106     FORMAT('      THE VALUE OF P  = ',G15.7)
          CALL DPWRST('XXX','BUG ')
          IERROR='YES'
          GOTO9000
        ELSEIF(1.0D0 - DP.LE.0.0D0)THEN
          WRITE(ICOUT,1)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,108)I
  108     FORMAT('      FOR ROW ',I8,' THE PROBABILITY PARAMETER (P) ',
     1           'IS TOO CLOSE TO 1 TO COMPUTE.')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,106)DP
          CALL DPWRST('XXX','BUG ')
          IERROR='YES'
          GOTO9000
        ENDIF
        IF(DP.EQ.0.0D0)THEN
          PPF(I)=ALOC
          GOTO100
        ENDIF
C
C       STEP 1: FIND BRACKETING INTERVAL
C
        CALL EEWPPF(DP,LMIN,GAMMA1,SCALE1,GAMMA2,SCALE2,DTERM1)
        DTERM1=ALOC + DTERM1
        CALL EEWPPF(DP,LMAX,GAMMA1,SCALE1,GAMMA2,SCALE2,DTERM2)
        DTERM2=ALOC + DTERM2
        DXL=MIN(DTERM1,DTERM2)
        DXR=MAX(DTERM1,DTERM2)
        IF(DXL.EQ.DXR)THEN
          PPF(I)=DXL
          GOTO100
        ENDIF
        NTEMP=1
        DX(1)=DXL
        CALL EEWCD2(DX,NTEMP,LI,PI,NI,GAMMA1,SCALE1,GAMMA2,SCALE2,ALOC,
     1              DCDF,
     1              ISUBRO,IBUGA2,IERROR)
        DCDFL=DCDF(1)
        DX(1)=DXR
        CALL EEWCD2(DX,NTEMP,LI,PI,NI,GAMMA1,SCALE1,GAMMA2,SCALE2,ALOC,
     1              DCDF,
     1              ISUBRO,IBUGA2,IERROR)
        DCDFR=DCDF(1)
C
        IF(DCDFL.LT.DP .AND. DCDFR.LT.DP)THEN
          PPF(I)=CPUMIN
          GOTO100
        ELSEIF(DCDFL.GT.DP .AND. DCDFR.GT.DP)THEN
          PPF(I)=CPUMIN
          GOTO100
        ENDIF
C
C       STEP 2: BISECTION METHOD
C
        IC = 0
        DFXL = -DP
        DFXR = 1.0D0 - DP
  205   CONTINUE
        DX(1)=(DXL+DXR)*0.5D0
        CALL EEWCD2(DX,NTEMP,LI,PI,NI,GAMMA1,SCALE1,GAMMA2,SCALE2,ALOC,
     1              DCDF,
     1              ISUBRO,IBUGA2,IERROR)
        DP1=DCDF(1)
        DPPF=DX(1)
        DFCS = DP1 - DP
C
        IF(DFCS*DFXL.GT.0.0D0)THEN
          DXL = DX(1)
          DFXL = DFCS
        ELSE
          DXR = DX(1)
          DFXR = DFCS 
        ENDIF
C
        DXRML = DXR - DXL
        IF(DXRML.LE.DSIG .AND. DABS(DFCS).LE.DEPS)THEN
          PPF(I)=DPPF
          GOTO100
        ENDIF
C
C       STEP 3: ERROR MESSAGE FOR NO CONVERGENCE
C
        IC = IC + 1
        IF(IC.LE.MAXIT)GOTO205
        WRITE(ICOUT,1)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,230)I,DP
  230   FORMAT('      FOR ROW ',I8,' (P = ',G15.7,'), THERE WAS ',
     1         'NO CONVERGENCE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,233)
  233   FORMAT('      LAST VALUE OBTAINED WILL BE USED.')
        CALL DPWRST('XXX','BUG ')
        PPF(I)=DPPF
        GOTO100
C
  100 CONTINUE
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE EMPQUA(X,NX,IWRITE,Y,U,NY,IBUGA3,ISUBRO,IERROR)
C
C     PURPOSE--COMPUTE THE EMPIRICAL QUANTILE FUNCTION OF A VARIABLE--
C              THE FORMULA IS:
C
C                 Qhat(u) = (N*u - j + (1/2))*X(j+1) +
C                           (j + (1/2) - N*u)*X(j)
C
C                           (2-j-1)/(2*N) <= u < (2*j+1)/(2*n)
C                           j = 1, 2, ... n-1
C
C               THIS WILL BE COMPUTED FOR A SPECIFIED NUMBER OF
C               EQUI-SPACED POINTS BETWEEN THE LOWER AND UPPER LIMITS.
C
C     REFERENCE--"MIL-HDBK-17-1F Volume 1: Guidelines for Characterization
C                of Structural Materials", Depeartment of Defense,
C                chapter 8, 2002.
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATION INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATION INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2017/2
C     ORIGINAL VERSION--FEBRUARY  2017.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 IWRITE
      CHARACTER*4 ISUBRO
      CHARACTER*4 IBUGA3
      CHARACTER*4 IERROR
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
C
C---------------------------------------------------------------------
C
      DIMENSION X(*)
      DIMENSION Y(*)
      DIMENSION U(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='EMPQ'
      ISUBN2='UA  '
C
      IERROR='NO'
C
      IF(IBUGA3.EQ.'ON' .OR. ISUBRO.EQ.'PQUA')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,51)
   51   FORMAT('***** AT THE BEGINNING OF EMPQUA--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,52)IWRITE,IBUGA3,NX
   52   FORMAT('IWRITE,IBUGA3,NX = ',2(A4,2X),I8)
        CALL DPWRST('XXX','BUG ')
        DO55I=1,NX
          WRITE(ICOUT,56)I,X(I)
   56     FORMAT('I,X(I) = ',I8,G15.7)
          CALL DPWRST('XXX','BUG ')
   55   CONTINUE
      ENDIF
C
C               **************************************
C               **  SORT THE DATA                   **
C               **************************************
C
      CALL SORT(X,NX,X)
C
      NY=0
      AN=REAL(NX)
      IF(NX.GT.1000)THEN
        NINC=1
      ELSE
        NTOT=1000
        AINC=REAL(NTOT)/REAL(NX)
        NINC=INT(AINC+0.5)
        IF(NINC.LE.0)NINC=1
      ENDIF
C
      DO100J=1,NX-1
        AJ=REAL(J)
        ALOW=(2.0*AJ - 1.0)/(2.0*AN)
        AUPP=(2.0*AJ + 1.0)/(2.0*AN)
        IF(NINC.EQ.1)THEN
          AMID=(ALOW+AUPP)/2.0
          NY=NY+1
          TERM1=AN*AMID - AJ + 0.5
          TERM2=AJ + 0.5 - AN*AMID
          U(NY)=AMID
          Y(NY)=TERM1*X(J+1) + TERM2*X(J)
        ELSE
          AINC=(AUPP-ALOW)/REAL(NINC)
          DO200K=1,NINC
            AVAL=ALOW + REAL(K-1)*AINC
            NY=NY+1
            TERM1=AN*AVAL - AJ + 0.5
            TERM2=AJ + 0.5 - AN*AVAL
            U(NY)=AVAL
            Y(NY)=TERM1*X(J+1) + TERM2*X(J)
  200     CONTINUE
        ENDIF
  100 CONTINUE
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT.      **
C               *****************
C
      IF(IBUGA3.EQ.'ON' .OR. ISUBRO.EQ.'PQUA')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9011)
 9011   FORMAT('***** AT THE END       OF EMPQUA--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9013)IERROR,NX,NY
 9013   FORMAT('IERROR,NX,NY = ',A4,2X,2I8)
        CALL DPWRST('XXX','BUG ')
        DO9015I=1,NY
          WRITE(ICOUT,9016)I,U(I),Y(I)
 9016     FORMAT('I,U(I),Y(I) = ',I8,2G15.7)
          CALL DPWRST('XXX','BUG ')
 9015   CONTINUE
      ENDIF
C
      RETURN
      END
      SUBROUTINE EMPTIQ(X,NX,IWRITE,AIQHAT,TIQHAT,U,QUHAT,NY,
     1                  IBUGA3,ISUBRO,IERROR)
C
C     PURPOSE--COMPUTE THE INFORMATIVE QUANTILE (IQ) FUNCTION.
C
C              THE EMPIRICAL QUANTILE FUNCTION OF A VARIABLE IS
C              COMPUTED WITH THE FORMULA:
C
C                 Qhat(u) = (N*u - j + (1/2))*X(j+1) +
C                           (j + (1/2) - N*u)*X(j)
C
C                           (2-j-1)/(2*N) <= u < (2*j+1)/(2*n)
C                           j = 1, 2, ... n-1
C
C               THIS WILL BE COMPUTED FOR A SPECIFIED NUMBER OF
C               EQUI-SPACED POINTS BETWEEN THE LOWER AND UPPER LIMITS.
C
C               THE ESTIMATED IQ FUNCTION IS DEFINED AS:
C
C                 IQHAT(u) = (QHAT(u) - QHAT(0.5))/
C                            {2*(QHAT(0.75) - QHAT(0.25))}
C
C               THE ESTIMATED TRUNCATED IQ FUNCTION IS DEFINED AS:
C
C                 TIQHAT(u) = (QHAT(u) - QHAT(0.5))/
C                             {2*(QHAT(0.75) - QHAT(0.25))} -1 < IQHAT(u) <= 1
C
C                             -1                                 IQHAT(u) <= -1
C                             +1                                 IQHAT(u) >  +1
C
C     REFERENCE--"MIL-HDBK-17-1F Volume 1: Guidelines for Characterization
C                of Structural Materials", Depeartment of Defense,
C                chapter 8, 2002.
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATION INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATION INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2017/03
C     ORIGINAL VERSION--MARCH     2017.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 IWRITE
      CHARACTER*4 ISUBRO
      CHARACTER*4 IBUGA3
      CHARACTER*4 IERROR
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
C
      REAL LININ3
      EXTERNAL LININ3
C
C---------------------------------------------------------------------
C
      DIMENSION X(*)
      DIMENSION QUHAT(*)
      DIMENSION AIQHAT(*)
      DIMENSION TIQHAT(*)
      DIMENSION U(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='EMPT'
      ISUBN2='IQ  '
C
      IERROR='NO'
C
      IF(IBUGA3.EQ.'ON' .OR. ISUBRO.EQ.'PTIQ')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,51)
   51   FORMAT('***** AT THE BEGINNING OF EMPTIQ--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,52)IWRITE,IBUGA3,NX
   52   FORMAT('IWRITE,IBUGA3,NX = ',2(A4,2X),I8)
        CALL DPWRST('XXX','BUG ')
        DO55I=1,NX
          WRITE(ICOUT,56)I,X(I)
   56     FORMAT('I,X(I) = ',I8,G15.7)
          CALL DPWRST('XXX','BUG ')
   55   CONTINUE
      ENDIF
C
C               ***********************************************
C               **  COMPUTE THE EMPIRICAL QUANTILE FUNCTION  **
C               ***********************************************
C
      CALL SORT(X,NX,X)
C
      NY=0
      AN=REAL(NX)
      IF(NX.GT.1000)THEN
        NINC=1
      ELSE
        NTOT=1000
        AINC=REAL(NTOT)/REAL(NX)
        NINC=INT(AINC+0.5)
        IF(NINC.LE.0)NINC=1
      ENDIF
C
      DO100J=1,NX-1
        AJ=REAL(J)
        ALOW=(2.0*AJ - 1.0)/(2.0*AN)
        AUPP=(2.0*AJ + 1.0)/(2.0*AN)
        IF(NINC.EQ.1)THEN
          AMID=(ALOW+AUPP)/2.0
          NY=NY+1
          TERM1=AN*AMID - AJ + 0.5
          TERM2=AJ + 0.5 - AN*AMID
          U(NY)=AMID
          QUHAT(NY)=TERM1*X(J+1) + TERM2*X(J)
        ELSE
          AINC=(AUPP-ALOW)/REAL(NINC)
          DO200K=1,NINC
            AVAL=ALOW + REAL(K-1)*AINC
            NY=NY+1
            TERM1=AN*AVAL - AJ + 0.5
            TERM2=AJ + 0.5 - AN*AVAL
            U(NY)=AVAL
            QUHAT(NY)=TERM1*X(J+1) + TERM2*X(J)
  200     CONTINUE
        ENDIF
  100 CONTINUE
C
C               *****************************************************
C               **  NOW COMPUTE THE INFORMATIVE QUANTILE FUNCTION  **
C               *****************************************************
C
C      SEARCH THE LIST FOR THE CLOSEST MATCH TO U = 0.5, .25, and .75
C
      IFLAG1=0
      IFLAG2=0
      DO300I=1,NY-1
        IF(U(I).LE.0.25 .AND. U(I+1).GE.0.25 .AND. IFLAG1.EQ.0)THEN
          AVAL=0.25
          QU25=LININ3(U(I),QUHAT(I),U(I+1),QUHAT(I+1),AVAL,
     1                IBUGA3,ISUBRO,IERROR)
          IFLAG1=1
        ELSEIF(U(I).LE.0.5 .AND. U(I+1).GE.0.5 .AND. IFLAG2.EQ.0)THEN
          AVAL=0.50
          QU50=LININ3(U(I),QUHAT(I),U(I+1),QUHAT(I+1),AVAL,
     1                IBUGA3,ISUBRO,IERROR)
          IFLAG2=1
        ELSEIF(U(I).LE.0.75 .AND. U(I+1).GE.0.75)THEN
          AVAL=0.75
          QU75=LININ3(U(I),QUHAT(I),U(I+1),QUHAT(I+1),AVAL,
     1                IBUGA3,ISUBRO,IERROR)
          GOTO309
        ENDIF
  300 CONTINUE
  309 CONTINUE
C
      DO400I=1,NY
        AIQHAT(I)=(QUHAT(I) - QU50)/(2.0*(QU75 - QU25))
        IF(AIQHAT(I).LE.-1.0)THEN
          TIQHAT(I)=-1.0
        ELSEIF(AIQHAT(I).GT.1.0)THEN
          TIQHAT(I)=1.0
        ELSE
          TIQHAT(I)=AIQHAT(I)
        ENDIF
  400  CONTINUE
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT.      **
C               *****************
C
      IF(IBUGA3.EQ.'ON' .OR. ISUBRO.EQ.'PTIQ')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9011)
 9011   FORMAT('***** AT THE END       OF EMPTIQ--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9013)IERROR,NX,NY,QU25,QU50,QU75
 9013   FORMAT('IERROR,NX,NY,QU25,QU50,QU75 = ',A4,2X,2I8,3G15.7)
        CALL DPWRST('XXX','BUG ')
        DO9015I=1,NY
          WRITE(ICOUT,9016)I,U(I),QUHAT(I),AIQHAT(I),TIQHAT(I)
 9016     FORMAT('I,U(I),QUHAT(I),AIQHAT(I),TIQHAT(I) = ',I8,4G15.7)
          CALL DPWRST('XXX','BUG ')
 9015   CONTINUE
      ENDIF
C
      RETURN
      END
      SUBROUTINE EN(X,ULAB,XREF,UREF,N,IWRITE,ENOUT,
     1              IBUGA3,ISUBRO,IERROR)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE EN STATISTIC:
C
C                 EN(i) = (x(i) - XREF)/SQRT(U(lab)**2 + U(ref)**2)
C
C              WHERE
C
C                   XREF    = THE ASSIGNED VALUE (DETERMINED FROM A
C                             REFERENCE LABORATORY)
C                   U(ref)  = THE EXPANDED UNCERTAINTY FOR THE ASSIGNED
C                             VALUE
C                   U(lab)  = THE EXPANDED UNCERTAINTY FOR THE LAB
C
C              NOTE THAT SINCE THE LAB UNCERTAINTY CAN VARY DEPENDING
C              ON THE LAB, THIS IS INPUT AS A VECTOR RATHER THAN A
C              PARAMETER.  XREF AND UREF ARE INPUT AS PARAMETERS SINCE
C              THEY ARE FIXED FOR ALL LABS.  ULAB EFFECTIVELY ACTS AS
C              AS A PROXY FOR LAB-ID, SO NO NEED TO INPUT THIS AS A
C              SEPARATE VALUE.
C
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VECTOR OF
C                                (UNSORTED OR SORTED) OBSERVATIONS.
C                     --ULAB   = THE SINGLE PRECISION VECTOR OF
C                                LAB EXPANDED UNCERTAINTIES
C                     --XREF   = THE SINGLE PRECISION VALUE CONTAINING
C                                THE ASSIGNED VALUE
C                     --UREF   = THE SINGLE PRECISION VALUE CONTAINING
C                                THE EXPANDED UNCERTAINTY FOR THE
C                                ASSIGNED VALUE
C                     --N      = THE INTEGER NUMBER OF OBSERVATIONS
C                                IN THE VECTOR X.
C     OUTPUT ARGUMENTS--ENOUT  = THE SINGLE PRECISION VECTOR OF THE
C                                COMPUTED EN VALUES.
C     OUTPUT--THE COMPUTED SINGLE PRECISION VECTOR OF THE SAMPLE EN
C             VALUES.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--SQRT.
C     MODE OF INTERNAL OPERATIONS--DOUBLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCE--ISO 13528, FIRST EDITION, STATISTICAL METHODS FOR USE
C                IN PROFICIENCY TESTING BY INTERLABORATORY COMPARISONS,
C                2005, PP. 27-28.
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2012.1
C     ORIGINAL VERSION--JANUARY   2012.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 IWRITE
      CHARACTER*4 IBUGA3
      CHARACTER*4 ISUBRO
      CHARACTER*4 IERROR
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
C
C---------------------------------------------------------------------
C
      DIMENSION X(*)
      DIMENSION ULAB(*)
      DIMENSION ENOUT(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='EN  '
      ISUBN2='    '
      IERROR='NO'
C
      IF(IBUGA3.EQ.'ON' .OR. ISUBRO.EQ.'EN  ')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,51)
   51   FORMAT('***** AT THE BEGINNING OF EN--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,52)IBUGA3,N,XREF,UREF
   52   FORMAT('IBUGA3,N = ',A4,2X,I8,2G15.7)
        CALL DPWRST('XXX','BUG ')
        DO55I=1,N
          WRITE(ICOUT,56)I,X(I),ULAB(I)
   56     FORMAT('I,X(I),ULAB(I) = ',I8,2G15.7)
          CALL DPWRST('XXX','BUG ')
   55   CONTINUE
      ENDIF
C
C               ********************
C               **  COMPUTE EN    **
C               ********************
C
C               ********************************************
C               **  STEP 1--                              **
C               **  CHECK THE INPUT ARGUMENTS FOR ERRORS  **
C               ********************************************
C
      AN=N
C
      IF(N.LT.1)THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,111)
  111   FORMAT('***** ERROR IN EN--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,112)
  112   FORMAT('      THE NUMBER OF OBSERVATIONS IN THE VARIABLE FOR')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,114)
  114   FORMAT('      WHICH THE MEAN IS TO BE COMPUTED MUST BE AT ',
     1         'LEAST 1.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,117)N
  117   FORMAT('      THE INPUT NUMBER OF OBSERVATIONS HERE = ',I8,'.')
        CALL DPWRST('XXX','BUG ')
        IERROR='YES'
        GOTO9000
      ENDIF
C
      IF(UREF.LT.0.0)THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,111)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,122)
  122   FORMAT('      THE REFERENCE EXPANDED UNCERTAINTY IS NEGATIVE.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,127)UREF
  127   FORMAT('      THE REFERENCE EXPANDED UNCERTAINTY = ',G15.7)
        CALL DPWRST('XXX','BUG ')
        IERROR='YES'
        GOTO9000
      ENDIF
C
C               *************************
C               **  STEP 2--           **
C               **  COMPUTE THE EN     **
C               *************************
C
      DO200I=1,N
        UTEMP1=ULAB(I)
        UTEMP2=UTEMP1**2 + UREF**2
C
        IF(UTEMP1.LT.0.0 .OR. UTEMP2.LE.0.0)THEN
          WRITE(ICOUT,999)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,111)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,222)
  222     FORMAT('      EITHER THE LAB EXPANDED UNCERTAINTY IS ',
     1           'NEGATIVE OR')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,224)
  224     FORMAT('      BOTH THE LAB EXPANDED UNCERTAINTY AND THE ',
     1           'EXPANDED')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,226)
  226     FORMAT('      REFERENCE UNCERTAINTY ARE ZERO.')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,127)UREF
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,227)ULAB(I)
  227     FORMAT('      THE LAB EXPANDED UNCERTAINTY = ',G15.7)
          CALL DPWRST('XXX','BUG ')
          IERROR='YES'
          GOTO9000
        ENDIF
C
        ENOUT(I)=(X(I) - XREF)/SQRT(UTEMP1**2 + UREF**2)
  200 CONTINUE
C
C               *******************************
C               **  STEP 3--                 **
C               **  WRITE OUT A LINE         **
C               **  OF SUMMARY INFORMATION.  **
C               *******************************
C
      IF(IFEEDB.EQ.'ON' .AND. IWRITE.EQ.'ON')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,811)N
  811   FORMAT('THE NUMBER OF EN VALUES GENERATED = ',I8)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT.      **
C               *****************
C
 9000 CONTINUE
      IF(IBUGA3.EQ.'ON' .OR. ISUBRO.EQ.'EN  ')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9011)
 9011   FORMAT('***** AT THE END OF EN--')
        CALL DPWRST('XXX','BUG ')
        DO9012I=1,N
          WRITE(ICOUT,9015)I,X(I),ULAB(I),ENOUT(I)
 9015     FORMAT('I,X(I),ULAB(I),ENOUT(I) = ',I8,3G15.7)
          CALL DPWRST('XXX','BUG ')
 9012   CONTINUE
      ENDIF
C
      RETURN
      END
      SUBROUTINE ENTROP(X,N,IWRITE,ICASE,XE,XMEAN,XVAR,XSD,
     1                  IBUGA3,ISUBRO,IERROR)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES SHANNON'S ENTROPY
C              STATISTIC, AND ALTERNATIVELY THE MEAN, VARIANCE
C              AND STANDARD DEVIATION.  ENTROPY HAS DIFFERENT
C              DEFINITIONS IN DIFFERENT FIELDS, SO WE REFER TO
C              THESE AS "SHANNON ENTROPY" TO DISTINGUISH
C              THAT WE ARE REFERRING TO SHANNON'S DEFINITION.
C
C                 1) SHANNON'S ENTROPY:
C
C                      E = -SUM[i=1 to k][p(i)*LOG(p(i))]
C
C                    WHERE p(i)*LOG(p(i)) = 0 FOR p(i) = 0
C
C                 2) MEAN OF SHANNON'S ENTROPY:
C
C                     U = SUM[i=1 to k][i*p(i)]
C
C                 3) VARIANCE OF SHANNON'S ENTROPY:
C
C                     SIGMA^2 = SUM[i=1 to k][(i-U)**2*p(i)]
C
C                 4) SD OF SHANNON'S ENTROPY:
C
C                     SIGMA = SQRT(SIGMA^2)
C
C              THE p(i) IS THE PROBABILITY OF THE i-THE VALUE.
C              THESE SHOULD SUM TO 1.  IF THE VALUES IN X DO NOT
C              SUM TO 1, THEN ASSUME THAT THE X DENOTE A FREQUENCY
C              TABLE.
C
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VECTOR OF
C                                (UNSORTED OR SORTED) OBSERVATIONS.
C                     --N      = THE INTEGER NUMBER OF OBSERVATIONS
C                                IN THE VECTOR X.
C     OUTPUT ARGUMENTS--XE     = THE SINGLE PRECISION VALUE OF THE
C                                COMPUTED SHANNON'S ENTROPY.
C                     --XMEAN  = THE SINGLE PRECISION VALUE OF THE
C                                COMPUTED MEAN OF SHANNON'S ENTROPY.
C                     --XVAR   = THE SINGLE PRECISION VALUE OF THE
C                                COMPUTED VARIANCE OF SHANNON'S ENTROPY.
C                     --XSD    = THE SINGLE PRECISION VALUE OF THE
C                                COMPUTED SD OF SHANNON'S ENTROPY.
C     OUTPUT--THE COMPUTED SINGLE PRECISION VALUE OF THE SAMPLE ENTROPY.
C     RESTRICTIONS--THERE IS NO RESTRICTION ON THE MAXIMUM VALUE
C                   OF N FOR THIS SUBROUTINE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--NONE.
C     MODE OF INTERNAL OPERATIONS--DOUBLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--SHANNON (1948), "A MATHEMATICAL THEORY OF
C                 COMMUNICATION", BELL SYSTEM TECHNICAL JOURNAL,
C                 Vol. 27, PP. 379-423.
C               --CRESSIE (1993), "STATISTICS FOR SPATIAL DATA: REVISED
C                 EDITION", WILEY, p. 1.
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2021.03
C     ORIGINAL VERSION--MARCH     2021.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 ICASE
      CHARACTER*4 IWRITE
      CHARACTER*4 IBUGA3
      CHARACTER*4 ISUBRO
      CHARACTER*4 IERROR
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DX
      DOUBLE PRECISION DU
      DOUBLE PRECISION DVAR
      DOUBLE PRECISION DVAL
      DOUBLE PRECISION DSUM
C
      DIMENSION X(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOST.INC'
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='ENTR'
      ISUBN2='OP  '
      IERROR='NO'
C
      XE=CPUMIN
      XMEAN=CPUMIN
      XVAR=CPUMIN
      XSD=CPUMIN
C
      IF(IBUGA3.EQ.'ON' .OR. ISUBRO.EQ.'TROP')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,51)
   51   FORMAT('***** AT THE BEGINNING OF MEAN--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,52)IBUGA3,ISUBRO,ISHALB,N
   52   FORMAT('IBUGA3,ISUBRO,ISHALB,N = ',3(A4,2X),I8)
        CALL DPWRST('XXX','BUG ')
        DO55I=1,N
          WRITE(ICOUT,56)I,X(I)
   56     FORMAT('I,X(I) = ',I8,G15.7)
          CALL DPWRST('XXX','BUG ')
   55   CONTINUE
      ENDIF
C
C               ********************************************
C               **  STEP 1--                              **
C               **  CHECK THE INPUT ARGUMENTS FOR ERRORS  **
C               ********************************************
C
      AN=N
C
      IF(N.LT.1)THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,111)
  111   FORMAT('***** ERROR IN SHANNON ENTROPY--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,112)
  112   FORMAT('      THE NUMBER OF OBSERVATIONS IN THE RESPONSE ',
     1         'VARIABLE IS LESS THAN 1.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,117)N
  117   FORMAT('      THE NUMBER OF OBSERVATIONS = ',I8,'.')
        CALL DPWRST('XXX','BUG ')
        IERROR='YES'
        GOTO9000
      ENDIF
C
      DSUM=0.0D0
      DO120I=1,N
        IF(X(I).LE.0.0)THEN
          WRITE(ICOUT,999)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,111)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,122)I,X(I)
  122     FORMAT('      THE ',I8,'-TH OBSERVATION IS NEGATIVE (',
     1           G15.7,').')
          CALL DPWRST('XXX','BUG ')
          IERROR='YES'
          GOTO9000
        ENDIF
        DSUM=DSUM + DBLE(X(I))
  120 CONTINUE
C
      IF(IBUGA3.EQ.'ON' .OR. ISUBRO.EQ.'TROP')THEN
        WRITE(ICOUT,126)DSUM
  126   FORMAT('AFTER 120: DSUM = ',G15.7)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
      DEPS=1.0D-7
      IF(DSUM.LT.1.0D0-DEPS)THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,111)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,132)
  132   FORMAT('      THE SUM OF THE OBSERVATIONS IS LESS THAN 1.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,134)N,DSUM
  134   FORMAT('      THE SUM OF THE ',I8,' OBSERVATIONS IS ',G15.7)
        CALL DPWRST('XXX','BUG ')
        IERROR='YES'
        GOTO9000
      ELSEIF(DSUM.GT.1.0D0+DEPS)THEN
C
C       SUM GREATER THAN ONE.  DIVIDE ALL OBSERVATIONS BY THE SUM
C
        DO140I=1,N
          DX=DBLE(X(I))
          DVAL=DX/DSUM
          X(I)=REAL(DVAL)
  140   CONTINUE
      ENDIF
C
C               ***************************
C               **  STEP 2--             **
C               **  COMPUTE THE ENTROPY  **
C               ***************************
C
      DSUM=0.0D0
      DU=0.0D0
      DO200I=1,N
        DX=DBLE(X(I))
        IF(DX.GT.0.0D0)THEN
          IF(ISHALB.EQ.'10  ')THEN
            DXLOG=DLOG(DX)/DLOG(10.0D0)
          ELSEIF(ISHALB.EQ.'2   ')THEN
            DXLOG=DLOG(DX)/DLOG(2.0D0)
          ELSE
            DXLOG=DLOG(DX)
          ENDIF
          DSUM=DSUM+DX*DXLOG
          DU=DU+DBLE(I)*DX
        ENDIF
  200 CONTINUE
      XE=-REAL(DSUM)
      XMEAN=REAL(XE)
C
      IF(IBUGA3.EQ.'ON' .OR. ISUBRO.EQ.'TROP')THEN
        WRITE(ICOUT,206)DSUM,DU,XE,XMEAN
  206   FORMAT('AFTER 200: DSUM,DU,XE,XMEAN = ',4G15.7)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
      DVAR=0.0D0
      DO300I=1,N
        DX=DBLE(X(I))
        IF(DX.GT.0.0D0)THEN
          DVAR=DVAR+(DBLE(I)-DU)**2*DX
        ENDIF
  300 CONTINUE
      XVAR=REAL(DVAR)
      XSD=REAL(DSQRT(DVAR))
C
      IF(IBUGA3.EQ.'ON' .OR. ISUBRO.EQ.'TROP')THEN
        WRITE(ICOUT,306)DVAR
  306   FORMAT('AFTER 300: DVAR = ',G15.7)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
C               *******************************
C               **  STEP 3--                 **
C               **  WRITE OUT A LINE         **
C               **  OF SUMMARY INFORMATION.  **
C               *******************************
C
      IF(IFEEDB.EQ.'ON' .AND. IWRITE.EQ.'ON')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        IF(ICASE.EQ.'ENTR')THEN
          WRITE(ICOUT,811)N,XE
  811     FORMAT('THE SHANNON ENTROPY OF THE ',I8,' OBSERVATIONS = ',
     1           G15.7)
          CALL DPWRST('XXX','BUG ')
        ELSEIF(ICASE.EQ.'MEAN')THEN
          WRITE(ICOUT,813)N,XMEAN
  813     FORMAT('THE MEAN OF THE SHANNON ENTROPY OF THE ',I8,
     1           ' OBSERVATIONS = ',G15.7)
          CALL DPWRST('XXX','BUG ')
        ELSEIF(ICASE.EQ.'VARI')THEN
          WRITE(ICOUT,815)N,XVAR
  815     FORMAT('THE VARIANCE OF THE SHANNON ENTROPY OF THE ',I8,
     1           ' OBSERVATIONS = ',G15.7)
          CALL DPWRST('XXX','BUG ')
        ELSEIF(ICASE.EQ.'SD')THEN
          WRITE(ICOUT,817)N,XSD
  817     FORMAT('THE STANDARD DEVIATION OF THE SHANNON ENTROPY OF ',
     1           'THE ',I8,' OBSERVATIONS = ',G15.7)
          CALL DPWRST('XXX','BUG ')
        ELSE
          WRITE(ICOUT,819)ICASE
  819     FORMAT('CASE ',A4,' IS NOT RECOGNIZED.')
          CALL DPWRST('XXX','BUG ')
        ENDIF
      ENDIF
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT.      **
C               *****************
C
 9000 CONTINUE
      IF(IBUGA3.EQ.'ON' .OR. ISUBRO.EQ.'TROP')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9011)
 9011   FORMAT('***** AT THE END       OF ENTROP--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9012)IERROR,XE,XMEAN,XVAR,XSD
 9012   FORMAT('IERROR,XE,XMEAN,XVAR,XSD = ',A4,2X,4G15.7)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
      RETURN
      END
      DOUBLE PRECISION FUNCTION ENVJ(N,X)
      DOUBLE PRECISION X
      ENVJ=0.5D0*DLOG10(6.28D0*N)-N*DLOG10(1.36D0*X/N)
      RETURN
      END
      DOUBLE PRECISION FUNCTION EPLFUN (DB)
C
C     PURPOSE--THIS ROUTINE IS USED IN FINDING THE ESTIMATE OF B
C              FOR THE EXPONENTIAL LAW (NUMBER OF FAILURES CASE).
C              THIS FUNCTION FINDS THE ROOT OF THE EQUATION:
C
C                 SUM[i=1 to n][X(i)] + N/Bhat -
C                 N*X(n)/(1 - EXP(-BHAT*X(n)) = 0
C
C              WITH
C
C                 N        = NUMBER OF FAILURE TIMES
C                 Bhat     = POINT ESTIMATE OF B
C                 X        = VECTOR OF FAILURE TIMES
C
C              NOTE THAT THE SUM[X(I)] AND X(N) ARE COMPUTED IN
C              DPMLEL AND PASSED VIA COMMON BLOCK.
C
C              CALLED BY DFZERO ROUTINE FOR FINDING THE ROOT OF A
C              FUNCTION.
C     EXAMPLE--EXPONENTIAL LAW MAXIMUM LIKELIHOOD Y CENSOR
C     REFERENCE--TOBIAS AND TRINDADE, "APPLIED RELIABILITY", SECOND
C                EDITION, PP. 363-365.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBUG, MD 20899-8980
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2007/2
C     ORIGINAL VERSION--FEBRUARY   2007.
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DB
C
      DOUBLE PRECISION DN
      DOUBLE PRECISION DTEND
      DOUBLE PRECISION DXSUM
      DOUBLE PRECISION DXN
      COMMON/EPLCOM/DXSUM,DXN,DTEND,DN
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C  COMPUTE SOME SUMS
C
      EPLFUN=DXSUM + (DN/DB) - DN*DXN/(1.0D0 - DEXP(-DB*DXN))
C
      RETURN
      END
      DOUBLE PRECISION FUNCTION EPLFU2 (DB)
C
C     PURPOSE--THIS ROUTINE IS USED IN FINDING THE ESTIMATE OF B
C              FOR THE EXPONENTIAL LAW (TIME CENSORED CASE).
C              THIS FUNCTION FINDS THE ROOT OF THE EQUATION:
C
C                 SUM[i=1 to n][X(i)] + N/Bhat -
C                 N*T/(1 - EXP(-BHAT*T)) = 0
C
C              WITH
C
C                 N        = NUMBER OF FAILURE TIMES
C                 Bhat     = POINT ESTIMATE OF B
C                 X        = VECTOR OF FAILURE TIMES
C                 T        = CENSORING TIME
C
C              NOTE THAT THE SUM[X(I)] AND T ARE COMPUTED IN
C              DPMLEL AND PASSED VIA COMMON BLOCK.
C
C              CALLED BY DFZERO ROUTINE FOR FINDING THE ROOT OF A
C              FUNCTION.
C     EXAMPLE--EXPONENTIAL LAW MAXIMUM LIKELIHOOD Y CENSOR
C     REFERENCE--TOBIAS AND TRINDADE, "APPLIED RELIABILITY", SECOND
C                EDITION, PP. 363-365.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBUG, MD 20899-8980
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2007/2
C     ORIGINAL VERSION--FEBRUARY   2007.
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DB
C
      DOUBLE PRECISION DN
      DOUBLE PRECISION DTEND
      DOUBLE PRECISION DXSUM
      DOUBLE PRECISION DXN
      COMMON/EPLCOM/DXSUM,DXN,DTEND,DN
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C  COMPUTE SOME SUMS
C
      EPLFU2=DXSUM + (DN/DB) - DN*DTEND/(1.0D0 - DEXP(-DB*DTEND))
C
      RETURN
      END
      SUBROUTINE EUCDIS(AMAT,AMAT2,MAXROM,MAXCOM,NR1,NC1,
     1                  ICASE,ICASE2,P,IWRITE,
     1                  TEMP1,TEMP2,
     1                  IBUGA3,ISUBRO,IERROR)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE EUCLIDEAN DISTANCE OF A
C              MATRIX.  THE FORMULA IS:
C
C                 D(ij)=SQRT{SUM[k=1 to p][(X(ik) - X(jk))**2)}
C
C              ALTERNATIVELY (BASED ON ICASE2), THE FOLLOWING DISTANCE
C              MATRICES CAN BE COMPUTED:
C
C              MINKOWSKY DISTANCE:
C
C                 D(ij)=SUM[k=1 to p][(ABS|(X(ik) - X(jk))|**P)**(1/P)]
C
C              BLOCK (OR MANHATTAN) DISTANCE:
C
C                 D(ij)=SUM[k=1 to p][|X(ik) - X(jk)|]
C
C              CANBERRA DISTANCE:
C
C                 D(ij)=SUM[k=1 to p][|X(ik) - X(jk)|/
C                       (|X(i)| + |Y(i)|)]
C
C              CHEBYCHEV DISTANCE:
C
C                 D(ij)=MAX[k=1 to p][|X(ik) - X(jk)|]
C
C              COSINE SIMILARITY:
C
C                 S(ij) = SUM[k=1 to p][X(ik)*Y(ik)]/
C                         {SQRT(SUM[k=1 to p][X(ik)**2])*
C                          SQRT(SUM[k=1 to p][X(ik)**2])}
C
C             COSINE DISTANCE:
C
C                D(ij) = 1 - COSINE SIMILARITY(ij)
C
C             ANGULAR COSINE DISTANCE:
C
C                D(ij) = 1 - COSINE SIMILARITY(ij)
C
C             JACCARD SIMILARITY:
C
C                J(ij) = SUM[k=1 to n][MIN(X(ik),Y(ik))/
C                        SUM[k=1 to n][MAX(X(ik),Y(ik))]
C
C             JACCARD DISTANCE:
C
C                D(ij) = 1 - JACCARD SIMILARITY(ij)
C
C             HAMMING DISTANCE:
C
C                D(ij) = NUMBER OF ELEMENTS THAT DIFFER IN X AND Y
C
C             PEARSON DISTANCE:
C
C                D(ij) = (1 - R(I,J))/2  (R = CORRELATION COEFFICIENT)
C
C             PEARSON SIMILARITY:
C
C                S(ij) = 1 - PEARSON DISTANCE
C
C     INPUT  ARGUMENTS--AMAT   = THE SINGLE PRECISION MATRIX
C                     --MAXROM = THE INTEGER ROW DIMENSION OF AMAT
C                     --MAXCOM = THE INTEGER COUMN DIMENSION OF AMAT
C                     --NR1    = THE INTEGER NUMBER OF ROWS OF AMAT
C                     --NC1    = THE INTEGER NUMBER OF COLUMNS OF AMAT
C     OUTPUT ARGUMENTS--AMAT2    = THE SINGLE PRECISION VALUE OF THE
C                                COMPUTED SAMPLE EUCLIDEAN DISTANCES.
C     OUTPUT--MATRIX OF EUCLIDEAN DISTANCES
C     NOTE--THIS ROUTINE ASSUMES THE ERROR CHECKING (FOR EQUAL
C           ROWS AND COLUMNS, MATCHING DIMENSIONS FOR X AND AMAT)
C           IS DONE BT THE CALLING SUBROUTINE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--NONE.
C     LANGUAGE--ANSI FORTRAN (1977)
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--98.6
C     ORIGINAL VERSION--JUNE      1998.
C     UPDATED         --AUGUST    2018. INCORPORATE ADDITIONAL DISTANCE
C                                       METRICS (ICASE2)
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 ICASE
      CHARACTER*4 ICASE2
      CHARACTER*4 IWRITE
      CHARACTER*4 IBUGA3
      CHARACTER*4 ISUBRO
      CHARACTER*4 IERROR
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DSUM
      DOUBLE PRECISION DSUM2
      DOUBLE PRECISION DSUM3
      DOUBLE PRECISION DYM1
      DOUBLE PRECISION DYM2
C
      DIMENSION AMAT(MAXROM,MAXCOM)
      DIMENSION AMAT2(MAXROM,MAXCOM)
      DIMENSION TEMP1(*)
      DIMENSION TEMP2(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
      DATA PI/3.1415926535898E0/
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='EUCD'
      ISUBN2='IS  '
      IERROR='NO'
C
      IF(IBUGA3.EQ.'ON' .OR. ISUBRO.EQ.'CDIS')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,51)
   51   FORMAT('***** AT THE BEGINNING OF EUCDIS--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,52)IBUGA3,ICASE,ICASE2,NR1,NC1
   52   FORMAT('IBUGA3,ICASE,ICASE2,NR1,NC1 = ',3(A4,2X),2I8)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
C               ********************************
C               **  COMPUTE DISTANCE           *
C               ********************************
C
      IF(ICASE.EQ.'ROW ')THEN
        DO5860I=1,NR1
          DO5861J=1,I
            DSUM=0.0D0
            DSUM2=0.0D0
            DSUM3=0.0D0
            IF(ICASE2.EQ.'EUCL')THEN
              IF(I.EQ.J)THEN
                AMAT2(I,J)=0.0
              ELSE
                DO5862K=1,NC1
                  DYM1=AMAT(I,K)
                  DYM2=AMAT(J,K)
                  DSUM=DSUM+(DYM1-DYM2)**2
 5862           CONTINUE
                AMAT2(I,J)=REAL(DSQRT(DSUM))
              ENDIF
            ELSEIF(ICASE2.EQ.'MINK')THEN
              IF(I.EQ.J)THEN
                AMAT2(I,J)=0.0
              ELSE
                DO5863K=1,NC1
                  DYM1=AMAT(I,K)
                  DYM2=AMAT(J,K)
                  DSUM=DSUM + DABS(DYM1-DYM2)**DBLE(P)
 5863           CONTINUE
                AMAT2(I,J)=REAL(DSUM**(1.0D0/DBLE(P)))
              ENDIF
            ELSEIF(ICASE2.EQ.'BLOC')THEN
              IF(I.EQ.J)THEN
                AMAT2(I,J)=0.0
              ELSE
                DO5864K=1,NC1
                  DYM1=AMAT(I,K)
                  DYM2=AMAT(J,K)
                  DSUM=DSUM+DABS(DYM1-DYM2)
 5864           CONTINUE
                AMAT2(I,J)=REAL(DSUM)
              ENDIF
            ELSEIF(ICASE2.EQ.'HAMM')THEN
              IF(I.EQ.J)THEN
                AMAT2(I,J)=0.0
              ELSE
                DO55869K=1,NC1
                  DYM1=AMAT(I,K)
                  DYM2=AMAT(J,K)
                  IF(DYM1.NE.DYM2)DSUM=DSUM+1.0D0
55869           CONTINUE
                AMAT2(I,J)=REAL(DSUM)
              ENDIF
            ELSEIF(ICASE2.EQ.'CHEB')THEN
              IF(I.EQ.J)THEN
                AMAT2(I,J)=0.0
              ELSE
                DSUM2=0.0D0
                DO5865K=1,NC1
                  DYM1=AMAT(I,K)
                  DYM2=AMAT(J,K)
                  DSUM=DSUM+DABS(DYM1-DYM2)
 5865           CONTINUE
                AMAT2(I,J)=REAL(DSUM)
              ENDIF
            ELSEIF(ICASE2.EQ.'COSS' .OR. ICASE2.EQ.'COSD' .OR.
     1             ICASE2.EQ.'ACSS' .OR. ICASE2.EQ.'ACSD')THEN
              IF(I.EQ.J)THEN
                IF(ICASE2.EQ.'COSD' .OR. ICASE2.EQ.'ACSD')THEN
                  AMAT2(I,J)=0.0
                ELSE
                  AMAT2(I,J)=1.0
                ENDIF
              ELSE
                IFLAG=1
                DO5866K=1,NC1
                  IF(ICASE2.EQ.'COSD')THEN
                    IF(AMAT(I,K).LT.0.0 .OR. AMAT(J,K).LT.0.0)THEN
                      WRITE(ICOUT,999)
                      CALL DPWRST('XXX','BUG ')
                      WRITE(ICOUT,8001)
 8001                 FORMAT('****** ERROR IN MATRIX DISTANCE--')
                      CALL DPWRST('XXX','BUG ')
                      WRITE(ICOUT,8003)
 8003                 FORMAT('       COSINE DISTANCE NOT SUPPORTED ',
     1                       'NEGATIVE VALUES.')
                      CALL DPWRST('XXX','BUG ')
                      WRITE(ICOUT,8005)I,K,AMAT(I,K)
 8005                 FORMAT('        ROW ',I6,' COLUMN ',I6,' HAS ',
     1                       'THE VALUE ',E15.7)
                      CALL DPWRST('XXX','BUG ')
                      WRITE(ICOUT,8005)J,K,AMAT(J,K)
                      CALL DPWRST('XXX','BUG ')
                      IERROR='YES'
                      GOTO9000
                    ENDIF
                  ENDIF
                  DYM1=AMAT(I,K)
                  DYM2=AMAT(J,K)
                  DTEMP=DYM1*DYM2
                  DSUM=DSUM + DTEMP
                  DTEMP=DYM1*DYM1
                  DSUM2=DSUM2 + DTEMP
                  DTEMP=DYM2*DYM2
                  DSUM3=DSUM3 + DTEMP
 5866           CONTINUE
C
                IF(IBUGA3.EQ.'ON' .OR. ISUBRO.EQ.'CDIS')THEN
                  WRITE(ICOUT,15861)I,J,DSUM,DSUM2,DSUM3
15861             FORMAT('I,J,DSUM,DSUM2,DSUM3 = ',2I6,3G15.7)
                  CALL DPWRST('XXX','BUG ')
                ENDIF
C
                IF(DSUM2.GT.0.0D0 .AND. DSUM3.GT.0.0D0)THEN
                  DTEMP=DSUM/(DSQRT(DSUM2)*DSQRT(DSUM3))
                  AMAT2(I,J)=REAL(DTEMP)
                  IF(ICASE2.EQ.'COSD')THEN
                    AMAT2(I,J)=1.0 - AMAT2(I,J)
                  ELSEIF(ICASE2.EQ.'ACSD')THEN
                    AFACT=1.0
                    IF(IFLAG.EQ.1)AFACT=2.0
                    AMAT2(I,J)=AFACT*ACOS(AMAT2(I,J))/PI
                  ELSEIF(ICASE2.EQ.'ACSS')THEN
                    AFACT=1.0
                    IF(IFLAG.EQ.1)AFACT=2.0
                    AMAT2(I,J)=1.0 - AFACT*ACOS(AMAT2(I,J))/PI
                  ENDIF
                ELSE
                  AMAT2(I,J)=CPUMIN
                ENDIF
              ENDIF
            ELSEIF(ICASE2.EQ.'JACS' .OR. ICASE2.EQ.'JACD')THEN
              IF(I.EQ.J)THEN
                IF(ICASE2.EQ.'JASD')THEN
                  AMAT2(I,J)=0.0
                ELSE
                  AMAT2(I,J)=1.0
                ENDIF
              ELSE
                DO5867K=1,NC1
                  DYM1=AMAT(I,K)
                  DYM2=AMAT(J,K)
                  DTEMP=MIN(DYM1,DYM2)
                  DSUM=DSUM + DTEMP
                  DTEMP=MAX(DYM1,DYM2)
                  DSUM2=DSUM2 + DTEMP
 5867           CONTINUE
                AMAT2(I,J)=REAL(DSUM/DSUM2)
                IF(ICASE2.EQ.'JACD')THEN
                  AMAT2(I,J)=1.0 - AMAT2(I,J)
                ENDIF
              ENDIF
            ELSEIF(ICASE2.EQ.'PDIS' .OR. ICASE2.EQ.'PSIM')THEN
              IF(I.EQ.J)THEN
                AMAT2(I,J)=0.0
                IF(ICASE2.EQ.'PSIM')AMAT2(I,J)=1.0
              ELSE
                DO5868K=1,NC1
                  TEMP1(K)=AMAT(I,K)
                  TEMP2(K)=AMAT(J,K)
 5868           CONTINUE
                CALL CORR(TEMP1,TEMP2,NC1,IWRITE,ACORR,IBUGA3,IERROR)
                AMAT2(I,J)=(1.0 - ACORR)/2.0
                IF(ICASE2.EQ.'PSIM')AMAT2(I,J)=1.0 - AMAT2(I,J)
              ENDIF
            ELSEIF(ICASE2.EQ.'CANB')THEN
              IF(I.EQ.J)THEN
                AMAT2(I,J)=0.0
              ELSE
                DO5869K=1,NC1
                  DYM1=AMAT(I,K)
                  DYM2=AMAT(J,K)
                  DSUM=DSUM+DABS(DYM1-DYM2)/
     1                 (DABS(DYM1)+DABS(DYM2))
 5869           CONTINUE
                AMAT2(I,J)=REAL(DSUM)
              ENDIF
            ENDIF
            AMAT2(J,I)=AMAT2(I,J)
 5861     CONTINUE
 5860   CONTINUE
      ELSEIF(ICASE.EQ.'COLU')THEN
        DO5960I=1,NC1
          DO5961J=1,I
            DSUM=0.0D0
            DSUM2=0.0D0
            DSUM3=0.0D0
            IF(ICASE2.EQ.'EUCL')THEN
              IF(I.EQ.J)THEN
                AMAT2(I,J)=0.0
              ELSE
                DO5962K=1,NR1
                  DYM1=AMAT(K,I)
                  DYM2=AMAT(K,J)
                  DSUM=DSUM+(DYM1-DYM2)**2
 5962           CONTINUE
                AMAT2(I,J)=REAL(DSQRT(DSUM))
              ENDIF
            ELSEIF(ICASE2.EQ.'MINK')THEN
              IF(I.EQ.J)THEN
                AMAT2(I,J)=0.0
              ELSE
                DO5963K=1,NR1
                  DYM1=AMAT(K,I)
                  DYM2=AMAT(K,J)
                  DSUM=DSUM + DABS(DYM1-DYM2)**DBLE(P)
 5963           CONTINUE
                AMAT2(I,J)=REAL(DSUM**(1.0D0/DBLE(P)))
              ENDIF
            ELSEIF(ICASE2.EQ.'BLOC')THEN
              IF(I.EQ.J)THEN
                AMAT2(I,J)=0.0
              ELSE
                DO5964K=1,NR1
                  DYM1=AMAT(K,I)
                  DYM2=AMAT(K,J)
                  DSUM=DSUM+DABS(DYM1-DYM2)
 5964           CONTINUE
                AMAT2(I,J)=REAL(DSUM)
              ENDIF
            ELSEIF(ICASE2.EQ.'HAMM')THEN
              IF(I.EQ.J)THEN
                AMAT2(I,J)=0.0
              ELSE
                DO55969K=1,NR1
                  DYM1=AMAT(K,I)
                  DYM2=AMAT(K,J)
                  IF(DYM1.NE.DYM2)DSUM=DSUM+1.0D0
55969           CONTINUE
                AMAT2(I,J)=REAL(DSUM)
              ENDIF
            ELSEIF(ICASE2.EQ.'CHEB')THEN
              IF(I.EQ.J)THEN
                AMAT2(I,J)=0.0
              ELSE
                DO5965K=1,NR1
                  DYM1=AMAT(K,I)
                  DYM2=AMAT(K,J)
                  DTEMP=DABS(DYM1-DYM2)
                  IF(DTEMP.GT.DSUM)DSUM=DTEMP
 5965           CONTINUE
                AMAT2(I,J)=REAL(DSUM)
              ENDIF
            ELSEIF(ICASE2.EQ.'COSS' .OR. ICASE2.EQ.'COSD' .OR.
     1             ICASE2.EQ.'ACSS' .OR. ICASE2.EQ.'ACSD')THEN
              IF(I.EQ.J)THEN
                IF(ICASE2.EQ.'COSD' .OR. ICASE2.EQ.'ACSD')THEN
                  AMAT2(I,J)=0.0
                ELSE
                  AMAT2(I,J)=1.0
                ENDIF
              ELSE
                IFLAG=1
                DO5966K=1,NR1
                  IF(ICASE2.EQ.'COSD')THEN
                    IF(AMAT(K,I).LT.0.0 .OR. AMAT(K,J).LT.0.0)THEN
                      WRITE(ICOUT,999)
                      CALL DPWRST('XXX','BUG ')
                      WRITE(ICOUT,8001)
                      CALL DPWRST('XXX','BUG ')
                      WRITE(ICOUT,8003)
                      CALL DPWRST('XXX','BUG ')
                      WRITE(ICOUT,8005)K,I,AMAT(K,I)
                      CALL DPWRST('XXX','BUG ')
                      WRITE(ICOUT,8005)K,J,AMAT(K,J)
                      CALL DPWRST('XXX','BUG ')
                      IERROR='YES'
                      GOTO9000
                    ENDIF
                  ENDIF
                  IF(AMAT(K,I).LT.0.0)IFLAG=0
                  IF(AMAT(K,J).LT.0.0)IFLAG=0
                  DYM1=AMAT(K,I)
                  DYM2=AMAT(K,J)
                  DTEMP=DYM1*DYM2
                  DSUM=DSUM + DTEMP
                  DTEMP=DYM1*DYM1
                  DSUM2=DSUM2 + DTEMP
                  DTEMP=DYM2*DYM2
                  DSUM3=DSUM3 + DTEMP
 5966           CONTINUE
C
                IF(IBUGA3.EQ.'ON' .OR. ISUBRO.EQ.'CDIS')THEN
                  WRITE(ICOUT,15861)I,J,DSUM,DSUM2,DSUM3
                  CALL DPWRST('XXX','BUG ')
                ENDIF
C
                IF(DSUM2.GT.0.0D0 .AND. DSUM3.GT.0.0D0)THEN
                  DTEMP=DSUM/(SQRT(DSUM2)*SQRT(DSUM3))
                  AMAT2(I,J)=REAL(DTEMP)
                  IF(ICASE2.EQ.'COSD')THEN
                    AMAT2(I,J)=1.0 - AMAT2(I,J)
                  ELSEIF(ICASE2.EQ.'ACSD')THEN
                    AFACT=1.0
                    IF(IFLAG.EQ.1)AFACT=2.0
                    AMAT2(I,J)=AFACT*ACOS(AMAT2(I,J))/PI
                  ELSEIF(ICASE2.EQ.'ACSS')THEN
                    AFACT=1.0
                    IF(IFLAG.EQ.1)AFACT=2.0
                    AMAT2(I,J)=1.0 - AFACT*ACOS(AMAT2(I,J))/PI
                  ENDIF
                ELSE
                  AMAT2(I,J)=CPUMIN
                ENDIF
              ENDIF
            ELSEIF(ICASE2.EQ.'JACS' .OR. ICASE2.EQ.'JACD')THEN
              IF(I.EQ.J)THEN
                IF(ICASE2.EQ.'JACD')THEN
                  AMAT2(I,J)=0.0
                ELSE
                  AMAT2(I,J)=1.0
                ENDIF
              ELSE
                DO5967K=1,NR1
                  DYM1=AMAT(K,I)
                  DYM2=AMAT(K,J)
                  DTEMP=MIN(DYM1,DYM2)
                  DSUM=DSUM + DTEMP
                  DTEMP=MAX(DYM1,DYM2)
                  DSUM2=DSUM2 + DTEMP
 5967           CONTINUE
                AMAT2(I,J)=REAL(DSUM/DSUM2)
                IF(ICASE2.EQ.'JACD')THEN
                  AMAT2(I,J)=1.0 - AMAT2(I,J)
                ENDIF
              ENDIF
            ELSEIF(ICASE2.EQ.'PDIS' .OR. ICASE2.EQ.'PSIM')THEN
              IF(I.EQ.J)THEN
                AMAT2(I,J)=0.0
                IF(ICASE2.EQ.'PSIM')AMAT2(I,J)=1.0
              ELSE
                DO5968K=1,NR1
                  TEMP1(K)=AMAT(K,I)
                  TEMP2(K)=AMAT(K,J)
 5968           CONTINUE
                CALL CORR(TEMP1,TEMP2,NR1,IWRITE,ACORR,IBUGA3,IERROR)
                AMAT2(I,J)=(1.0 - ACORR)/2.0
                IF(ICASE2.EQ.'PSIM')AMAT2(I,J)=1.0 - AMAT2(I,J)
              ENDIF
            ELSEIF(ICASE2.EQ.'CANB')THEN
              IF(I.EQ.J)THEN
                AMAT2(I,J)=0.0
              ELSE
                DO5969K=1,NR1
                  DYM1=AMAT(K,I)
                  DYM2=AMAT(K,J)
                  DSUM=DSUM+DABS(DYM1-DYM2)/
     1                 (DABS(DYM1)+DABS(DYM2))
 5969           CONTINUE
                AMAT2(I,J)=REAL(DSUM)
              ENDIF
            ENDIF
            AMAT2(J,I)=AMAT2(I,J)
 5961     CONTINUE
 5960   CONTINUE
      ENDIF
C
C               *******************************
C               **  STEP 3--                 **
C               **  WRITE OUT A LINE         **
C               **  OF SUMMARY INFORMATION.  **
C               *******************************
C
      IF(IFEEDB.EQ.'ON' .AND. IWRITE.EQ.'ON')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,811)
  811   FORMAT('THE DISTANCE/SIMILARITY MATRIX HAS BEEN CALCULATED.')
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT.      **
C               *****************
C
 9000 CONTINUE
      IF(IBUGA3.EQ.'ON' .OR. ISUBRO.EQ.'CDIS')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9011)
 9011   FORMAT('***** AT THE END       OF EUCDIS--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9012)IBUGA3,IERROR
 9012   FORMAT('IBUGA3,IERROR = ',A4,2X,A4)
        CALL DPWRST('XXX','BUG ')
        DO9020IROW=1,NR1
          DO9030ICOL=1,NC1
            WRITE(ICOUT,9022)IROW,ICOL,AMAT2(IROW,ICOL)
 9022       FORMAT('IROW,ICOL,AMAT2(IROW,ICOL) = ',2I6,G15.7)
            CALL DPWRST('XXX','BUG ')
 9030     CONTINUE
 9020   CONTINUE
      ENDIF
C
      RETURN
      END
      SUBROUTINE EULERB(N,EN)
C
C       ======================================
C       Purpose: Compute Euler number En
C       Input :  n --- Serial number
C       Output:  EN(n) --- En
C       ======================================
C
        IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C
      INCLUDE 'DPCOP2.INC'
C
        DIMENSION EN(0:N)
C
        HPI=2.0D0/3.141592653589793D0
        DO1I=0,N
          EN(I)=0.0D0
 1      CONTINUE
C
        EN(0)=1.0D0
        EN(2)=-1.0D0
        IF(N.LE.3)RETURN
        R1=-4.0D0*HPI**3
C
        IFLAG=0
C
        DO 20 M=4,N,2
           IF(IFLAG.EQ.1)THEN
             EN(M)=DBLE(CPUMAX)
             GOTO20
           ENDIF
           R1=-R1*(M-1)*M*HPI*HPI
           R2=1.0D0
CCCCC      ISGN=1.0D0
           ISGN=1
           DO 10 K=3,1000,2
              ISGN=-ISGN
              S=(1.0D0/K)**(M+1)
              R2=R2+ISGN*S
              IF (S.LT.1.0D-15) GOTO 29
10         CONTINUE
29         CONTINUE
           EN(M)=R1*R2
           IF(EN(M).GE.DBLE(CPUMAX))THEN
             IFLAG=1
             EN(M)=DBLE(CPUMAX)
             WRITE(ICOUT,90)M
             CALL DPWRST('XXX','BUG ')
90           FORMAT('***** EULER NUMBERS: OVERFLOW AT N = ',I8)
           ENDIF
20      CONTINUE
C
        RETURN
        END
      SUBROUTINE EULERP(X,N,EN)
C
C       ======================================
C       Purpose: Compute Euler polynomial of order n for X
C       Input :  n --- Order of Euler polynomial
C                x --- value at which to compute the polynomial
C       Output:  EN--- computed value
C       ======================================
C
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C
      DIMENSION DTEMP(200)
C
      INCLUDE 'DPCOP2.INC'
C
      SUM=0.0D0
      DO100I=0,N/2
        CALL EULERB(2*I,DTEMP)
        TERM2=DTEMP(2*I+1)
        TERM1=DBINOM(N,2*I)
        IF(X-0.5D0.EQ.0.0D0 .AND. N-2*I.EQ.0)THEN
          TERM3=1.0D0
        ELSE
          TERM3=(X-0.5D0)**(N-2*I)
        ENDIF
        SUM=SUM + TERM1*TERM2*TERM3/DBLE(2**(2*I))
  100 CONTINUE
      EN=SUM
C
      RETURN
      END
      SUBROUTINE EXCHNG (X, M, Y, N, SX, SY)
C
C        ALGORITHM AS 304.2 APPL.STATIST. (1996), VOL.45, NO.3
C
C        Exchanges the sample data.  Assumes both X and Y have been
C        previously dimensioned to at least max(M, N) elements
C
C        DATAPLOT NOTE: UTILITY ROUTINE USED BY THE FISHER TWO SAMPLE
C                       RANDOMIZATION TEST
C
      INTEGER M, N
      REAL X(*), Y(*), SX, SY
C
      INTEGER C, K
      REAL TEMP
C
      TEMP = SX
      SX = SY
      SY = TEMP
C
      C = MIN(M, N)
      DO 10 K = 1, C
         TEMP = X(K)
         X(K) = Y(K)
         Y(K) = TEMP
   10 CONTINUE
      IF (M .GT. N) THEN
         DO 20 K = C+1, M
            Y(K) = X(K)
   20    CONTINUE
         N = M
         M = C
      ELSE IF (M .LT. N) THEN
         DO 30 K = C+1, N
            X(K) = Y(K)
   30    CONTINUE
         M = N
         N = C
      END IF
C
      RETURN
      END
      SUBROUTINE EXINT (X, N, KODE, M, TOL, EN, NZ, IERR)
C***BEGIN PROLOGUE  EXINT
C***PURPOSE  Compute an M member sequence of exponential integrals
C            E(N+K,X), K=0,1,...,M-1 for N .GE. 1 and X .GE. 0.
C***LIBRARY   SLATEC
C***CATEGORY  C5
C***TYPE      SINGLE PRECISION (EXINT-S, DEXINT-D)
C***KEYWORDS  EXPONENTIAL INTEGRAL, SPECIAL FUNCTIONS
C***AUTHOR  Amos, D. E., (SNLA)
C***DESCRIPTION
C
C         EXINT computes M member sequences of exponential integrals
C         E(N+K,X), K=0,1,...,M-1 for N .GE. 1 and X .GE. 0.  The
C         exponential integral is defined by
C
C         E(N,X)=integral on (1,infinity) of EXP(-XT)/T**N
C
C         where X=0.0 and N=1 cannot occur simultaneously.  Formulas
C         and notation are found in the NBS Handbook of Mathematical
C         Functions (ref. 1).
C
C         The power series is implemented for X .LE. XCUT and the
C         confluent hypergeometric representation
C
C                     E(A,X) = EXP(-X)*(X**(A-1))*U(A,A,X)
C
C         is computed for X .GT. XCUT.  Since sequences are computed in
C         a stable fashion by recurring away from X, A is selected as
C         the integer closest to X within the constraint N .LE. A .LE.
C         N+M-1.  For the U computation, A is further modified to be the
C         nearest even integer.  Indices are carried forward or
C         backward by the two term recursion relation
C
C                     K*E(K+1,X) + X*E(K,X) = EXP(-X)
C
C         once E(A,X) is computed.  The U function is computed by means
C         of the backward recursive Miller algorithm applied to the
C         three term contiguous relation for U(A+K,A,X), K=0,1,...
C         This produces accurate ratios and determines U(A+K,A,X), and
C         hence E(A,X), to within a multiplicative constant C.
C         Another contiguous relation applied to C*U(A,A,X) and
C         C*U(A+1,A,X) gets C*U(A+1,A+1,X), a quantity proportional to
C         E(A+1,X).  The normalizing constant C is obtained from the
C         two term recursion relation above with K=A.
C
C     Description of Arguments
C
C         Input
C           X       X .GT. 0.0 for N=1 and  X .GE. 0.0 for N .GE. 2
C           N       order of the first member of the sequence, N .GE. 1
C                   (X=0.0 and N=1 is an error)
C           KODE    a selection parameter for scaled values
C                   KODE=1   returns        E(N+K,X), K=0,1,...,M-1.
C                       =2   returns EXP(X)*E(N+K,X), K=0,1,...,M-1.
C           M       number of exponential integrals in the sequence,
C                   M .GE. 1
C           TOL     relative accuracy wanted, ETOL .LE. TOL .LE. 0.1
C                   ETOL = single precision unit roundoff = R1MACH(4)
C
C         Output
C           EN      a vector of dimension at least M containing values
C                   EN(K) = E(N+K-1,X) or EXP(X)*E(N+K-1,X), K=1,M
C                   depending on KODE
C           NZ      underflow indicator
C                   NZ=0   a normal return
C                   NZ=M   X exceeds XLIM and an underflow occurs.
C                          EN(K)=0.0E0 , K=1,M returned on KODE=1
C           IERR    error flag
C                   IERR=0, normal return, computation completed
C                   IERR=1, input error,   no computation
C                   IERR=2, error,         no computation
C                           algorithm termination condition not met
C
C***REFERENCES  M. Abramowitz and I. A. Stegun, Handbook of
C                 Mathematical Functions, NBS AMS Series 55, U.S. Dept.
C                 of Commerce, 1955.
C               D. E. Amos, Computation of exponential integrals, ACM
C                 Transactions on Mathematical Software 6, (1980),
C                 pp. 365-377 and pp. 420-428.
C***ROUTINES CALLED  I1MACH, PSIXN, R1MACH
C***REVISION HISTORY  (YYMMDD)
C   800501  DATE WRITTEN
C   890531  Changed all specific intrinsics to generic.  (WRB)
C   890531  REVISION DATE from Version 3.2
C   891214  Prologue converted to Version 4.0 format.  (BAB)
C   900315  CALLs to XERROR changed to CALLs to XERMSG.  (THJ)
C   900326  Removed duplicate information from DESCRIPTION section.
C           (WRB)
C   910408  Updated the REFERENCES section.  (WRB)
C   920207  Updated with code with a revision date of 880811 from
C           D. Amos.  Included correction of argument list.  (WRB)
C   920501  Reformatted the REFERENCES section.  (WRB)
C***END PROLOGUE  EXINT
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOMC.INC'
      INCLUDE 'DPCOP2.INC'
C
      REAL             A,AA,AAMS,AH,AK,AT,B,BK,BT,CC,CNORM,CT,EM,EMX,EN,
     1                 ETOL,FNM,FX,PT,P1,P2,S,TOL,TX,X,XCUT,XLIM,XTOL,Y,
     2                 YT,Y1,Y2
      REAL             PSIXN
      INTEGER I,IC,ICASE,ICT,IERR,IK,IND,IX,I1M,JSET,K,KK,KN,KODE,KS,M,
     1        ML,MU,N,ND,NM,NZ
      DIMENSION EN(*), A(99), B(99), Y(2)
C***FIRST EXECUTABLE STATEMENT  EXINT
      IERR = 0
      NZ = 0
      ML = 0
      ETOL = MAX(R1MACH(4),0.5E-18)
      IF (X.LT.0.0E0) IERR = 1
      IF (N.LT.1) IERR = 1
      IF (KODE.LT.1 .OR. KODE.GT.2) IERR = 1
      IF (M.LT.1) IERR = 1
      IF (TOL.LT.ETOL .OR. TOL.GT.0.1E0) IERR = 1
      IF (X.EQ.0.0E0 .AND. N.EQ.1) IERR = 1
      IF (IERR.NE.0) RETURN
      I1M = -I1MACH(12)
      PT = 2.3026E0*R1MACH(5)*I1M
      XLIM = PT - 6.907755E0
      BT = PT + (N+M-1)
      IF (BT.GT.1000.0E0) XLIM = PT - LOG(BT)
C
      XCUT = 2.0E0
      IF (ETOL.GT.2.0E-7) XCUT = 1.0E0
      IF (X.GT.XCUT) GO TO 100
      IF (X.EQ.0.0E0 .AND. N.GT.1) GO TO 80
C-----------------------------------------------------------------------
C     SERIES FOR E(N,X) FOR X.LE.XCUT
C-----------------------------------------------------------------------
      TX = X + 0.5E0
      IX = INT(TX)
C-----------------------------------------------------------------------
C     ICASE=1 MEANS INTEGER CLOSEST TO X IS 2 AND N=1
C     ICASE=2 MEANS INTEGER CLOSEST TO X IS 0,1, OR 2 AND N.GE.2
C-----------------------------------------------------------------------
      ICASE = 2
      IF (IX.GT.N) ICASE = 1
      NM = N - ICASE + 1
      ND = NM + 1
      IND = 3 - ICASE
      MU = M - IND
      ML = 1
      KS = ND
      FNM = NM
      S = 0.0E0
      XTOL = 3.0E0*TOL
      IF (ND.EQ.1) GO TO 10
      XTOL = 0.3333E0*TOL
      S = 1.0E0/FNM
   10 CONTINUE
      AA = 1.0E0
      AK = 1.0E0
      IC = 35
      IF (X.LT.ETOL) IC = 1
      DO 50 I=1,IC
        AA = -AA*X/AK
        IF (I.EQ.NM) GO TO 30
        S = S - AA/(AK-FNM)
        IF (ABS(AA).LE.XTOL*ABS(S)) GO TO 20
        AK = AK + 1.0E0
        GO TO 50
   20   CONTINUE
        IF (I.LT.2) GO TO 40
        IF (ND-2.GT.I .OR. I.GT.ND-1) GO TO 60
        AK = AK + 1.0E0
        GO TO 50
   30   S = S + AA*(-LOG(X)+PSIXN(ND))
        XTOL = 3.0E0*TOL
   40   AK = AK + 1.0E0
   50 CONTINUE
      IF (IC.NE.1) GO TO 340
   60 IF (ND.EQ.1) S = S + (-LOG(X)+PSIXN(1))
      IF (KODE.EQ.2) S = S*EXP(X)
      EN(1) = S
      EMX = 1.0E0
      IF (M.EQ.1) GO TO 70
      EN(IND) = S
      AA = KS
      IF (KODE.EQ.1) EMX = EXP(-X)
      GO TO (220, 240), ICASE
   70 IF (ICASE.EQ.2) RETURN
      IF (KODE.EQ.1) EMX = EXP(-X)
      EN(1) = (EMX-S)/X
      RETURN
   80 CONTINUE
      DO 90 I=1,M
        EN(I) = 1.0E0/(N+I-2)
   90 CONTINUE
      RETURN
C-----------------------------------------------------------------------
C     BACKWARD RECURSIVE MILLER ALGORITHM FOR
C              E(N,X)=EXP(-X)*(X**(N-1))*U(N,N,X)
C     WITH RECURSION AWAY FROM N=INTEGER CLOSEST TO X.
C     U(A,B,X) IS THE SECOND CONFLUENT HYPERGEOMETRIC FUNCTION
C-----------------------------------------------------------------------
  100 CONTINUE
      EMX = 1.0E0
      IF (KODE.EQ.2) GO TO 130
      IF (X.LE.XLIM) GO TO 120
      NZ = M
      DO 110 I=1,M
        EN(I) = 0.0E0
  110 CONTINUE
      RETURN
  120 EMX = EXP(-X)
  130 CONTINUE
      IX = INT(X+0.5E0)
      KN = N + M - 1
      IF (KN.LE.IX) GO TO 140
      IF (N.LT.IX .AND. IX.LT.KN) GO TO 170
      IF (N.GE.IX) GO TO 160
      GO TO 340
  140 ICASE = 1
      KS = KN
      ML = M - 1
      MU = -1
      IND = M
      IF (KN.GT.1) GO TO 180
  150 KS = 2
      ICASE = 3
      GO TO 180
  160 ICASE = 2
      IND = 1
      KS = N
      MU = M - 1
      IF (N.GT.1) GO TO 180
      IF (KN.EQ.1) GO TO 150
      IX = 2
  170 ICASE = 1
      KS = IX
      ML = IX - N
      IND = ML + 1
      MU = KN - IX
  180 CONTINUE
      IK = KS/2
      AH = IK
      JSET = 1 + KS - (IK+IK)
C-----------------------------------------------------------------------
C     START COMPUTATION FOR
C              EN(IND) = C*U( A , A ,X)    JSET=1
C              EN(IND) = C*U(A+1,A+1,X)    JSET=2
C     FOR AN EVEN INTEGER A.
C-----------------------------------------------------------------------
      IC = 0
      AA = AH + AH
      AAMS = AA - 1.0E0
      AAMS = AAMS*AAMS
      TX = X + X
      FX = TX + TX
      AK = AH
      XTOL = TOL
      IF (TOL.LE.1.0E-3) XTOL = 20.0E0*TOL
      CT = AAMS + FX*AH
      EM = (AH+1.0E0)/((X+AA)*XTOL*SQRT(CT))
      BK = AA
      CC = AH*AH
C-----------------------------------------------------------------------
C     FORWARD RECURSION FOR P(IC),P(IC+1) AND INDEX IC FOR BACKWARD
C     RECURSION
C-----------------------------------------------------------------------
      P1 = 0.0E0
      P2 = 1.0E0
  190 CONTINUE
      IF (IC.EQ.99) GO TO 340
      IC = IC + 1
      AK = AK + 1.0E0
      AT = BK/(BK+AK+CC+IC)
      BK = BK + AK + AK
      A(IC) = AT
      BT = (AK+AK+X)/(AK+1.0E0)
      B(IC) = BT
      PT = P2
      P2 = BT*P2 - AT*P1
      P1 = PT
      CT = CT + FX
      EM = EM*AT*(1.0E0-TX/CT)
      IF (EM*(AK+1.0E0).GT.P1*P1) GO TO 190
      ICT = IC
      KK = IC + 1
      BT = TX/(CT+FX)
      Y2 = (BK/(BK+CC+KK))*(P1/P2)*(1.0E0-BT+0.375E0*BT*BT)
      Y1 = 1.0E0
C-----------------------------------------------------------------------
C     BACKWARD RECURRENCE FOR
C              Y1=             C*U( A ,A,X)
C              Y2= C*(A/(1+A/2))*U(A+1,A,X)
C-----------------------------------------------------------------------
      DO 200 K=1,ICT
        KK = KK - 1
        YT = Y1
        Y1 = (B(KK)*Y1-Y2)/A(KK)
        Y2 = YT
  200 CONTINUE
C-----------------------------------------------------------------------
C     THE CONTIGUOUS RELATION
C              X*U(B,C+1,X)=(C-B)*U(B,C,X)+U(B-1,C,X)
C     WITH  B=A+1 , C=A IS USED FOR
C              Y(2) = C * U(A+1,A+1,X)
C     X IS INCORPORATED INTO THE NORMALIZING RELATION
C-----------------------------------------------------------------------
      PT = Y2/Y1
      CNORM = 1.0E0 - PT*(AH+1.0E0)/AA
      Y(1) = 1.0E0/(CNORM*AA+X)
      Y(2) = CNORM*Y(1)
      IF (ICASE.EQ.3) GO TO 210
      EN(IND) = EMX*Y(JSET)
      IF (M.EQ.1) RETURN
      AA = KS
      GO TO (220, 240), ICASE
C-----------------------------------------------------------------------
C     RECURSION SECTION  N*E(N+1,X) + X*E(N,X)=EMX
C-----------------------------------------------------------------------
  210 EN(1) = EMX*(1.0E0-Y(1))/X
      RETURN
  220 K = IND - 1
      DO 230 I=1,ML
        AA = AA - 1.0E0
        EN(K) = (EMX-AA*EN(K+1))/X
        K = K - 1
  230 CONTINUE
      IF (MU.LE.0) RETURN
      AA = KS
  240 K = IND
      DO 250 I=1,MU
        EN(K+1) = (EMX-X*EN(K))/AA
        AA = AA + 1.0E0
        K = K + 1
  250 CONTINUE
      RETURN
  340 CONTINUE
      IERR = 2
      RETURN
      END
      DOUBLE PRECISION FUNCTION erfdp(x)
CCCCC RENAME TO AVOID CONFLICT WITH INTRINSIC "ERF" ROUTINE
CCCCC DOUBLE PRECISION FUNCTION erf(x)
C-----------------------------------------------------------------------
C             EVALUATION OF THE REAL ERROR FUNCTION
C-----------------------------------------------------------------------
C     .. Scalar Arguments ..
      DOUBLE PRECISION x
C     ..
C     .. Local Scalars ..
      DOUBLE PRECISION ax,bot,c,t,top,x2
C     ..
C     .. Local Arrays ..
      DOUBLE PRECISION a(5),b(3),p(8),q(8),r(5),s(4)
C     ..
C     .. Intrinsic Functions ..
      INTRINSIC abs,exp,sign
C     ..
C     .. Data statements ..
C-------------------------
C-------------------------
C-------------------------
C-------------------------
      DATA c/.564189583547756D0/
      DATA a(1)/.771058495001320D-04/,a(2)/-.133733772997339D-02/,
     +     a(3)/.323076579225834D-01/,a(4)/.479137145607681D-01/,
     +     a(5)/.128379167095513D+00/
      DATA b(1)/.301048631703895D-02/,b(2)/.538971687740286D-01/,
     +     b(3)/.375795757275549D+00/
      DATA p(1)/-1.36864857382717D-07/,p(2)/5.64195517478974D-01/,
     +     p(3)/7.21175825088309D+00/,p(4)/4.31622272220567D+01/,
     +     p(5)/1.52989285046940D+02/,p(6)/3.39320816734344D+02/,
     +     p(7)/4.51918953711873D+02/,p(8)/3.00459261020162D+02/
      DATA q(1)/1.00000000000000D+00/,q(2)/1.27827273196294D+01/,
     +     q(3)/7.70001529352295D+01/,q(4)/2.77585444743988D+02/,
     +     q(5)/6.38980264465631D+02/,q(6)/9.31354094850610D+02/,
     +     q(7)/7.90950925327898D+02/,q(8)/3.00459260956983D+02/
      DATA r(1)/2.10144126479064D+00/,r(2)/2.62370141675169D+01/,
     +     r(3)/2.13688200555087D+01/,r(4)/4.65807828718470D+00/,
     +     r(5)/2.82094791773523D-01/
      DATA s(1)/9.41537750555460D+01/,s(2)/1.87114811799590D+02/,
     +     s(3)/9.90191814623914D+01/,s(4)/1.80124575948747D+01/
C     ..
C     .. Executable Statements ..
C-------------------------
      ax = abs(x)
      IF (ax.GT.0.5D0) GO TO 10
      t = x*x
      top = ((((a(1)*t+a(2))*t+a(3))*t+a(4))*t+a(5)) + 1.0D0
      bot = ((b(1)*t+b(2))*t+b(3))*t + 1.0D0
      erfdp = x* (top/bot)
      RETURN
C
   10 IF (ax.GT.4.0D0) GO TO 20
      top = ((((((p(1)*ax+p(2))*ax+p(3))*ax+p(4))*ax+p(5))*ax+p(6))*ax+
     +      p(7))*ax + p(8)
      bot = ((((((q(1)*ax+q(2))*ax+q(3))*ax+q(4))*ax+q(5))*ax+q(6))*ax+
     +      q(7))*ax + q(8)
      erfdp = 0.5D0 + (0.5D0-exp(-x*x)*top/bot)
      IF (x.LT.0.0D0) erfdp = -erfdp
      RETURN
C
   20 IF (ax.GE.5.8D0) GO TO 30
      x2 = x*x
      t = 1.0D0/x2
      top = (((r(1)*t+r(2))*t+r(3))*t+r(4))*t + r(5)
      bot = (((s(1)*t+s(2))*t+s(3))*t+s(4))*t + 1.0D0
      erfdp = (c-top/ (x2*bot))/ax
      erfdp = 0.5D0 + (0.5D0-exp(-x2)*erfdp)
      IF (x.LT.0.0D0) erfdp = -erfdp
      RETURN
C
   30 erfdp = sign(1.0D0,x)
      RETURN
      END
      DOUBLE PRECISION FUNCTION erfc1(ind,x)
C-----------------------------------------------------------------------
C         EVALUATION OF THE COMPLEMENTARY ERROR FUNCTION
C
C          ERFC1(IND,X) = ERFC(X)            IF IND = 0
C          ERFC1(IND,X) = EXP(X*X)*ERFC(X)   OTHERWISE
C-----------------------------------------------------------------------
C     .. Scalar Arguments ..
      DOUBLE PRECISION x
      INTEGER ind
C     ..
C     .. Local Scalars ..
      DOUBLE PRECISION ax,bot,c,e,t,top,w
C     ..
C     .. Local Arrays ..
      DOUBLE PRECISION a(5),b(3),p(8),q(8),r(5),s(4)
C     ..
C     .. External Functions ..
      DOUBLE PRECISION exparg
      EXTERNAL exparg
C     ..
C     .. Intrinsic Functions ..
      INTRINSIC abs,dble,exp
C     ..
C     .. Data statements ..
C-------------------------
C-------------------------
C-------------------------
C-------------------------
      DATA c/.564189583547756D0/
      DATA a(1)/.771058495001320D-04/,a(2)/-.133733772997339D-02/,
     +     a(3)/.323076579225834D-01/,a(4)/.479137145607681D-01/,
     +     a(5)/.128379167095513D+00/
      DATA b(1)/.301048631703895D-02/,b(2)/.538971687740286D-01/,
     +     b(3)/.375795757275549D+00/
      DATA p(1)/-1.36864857382717D-07/,p(2)/5.64195517478974D-01/,
     +     p(3)/7.21175825088309D+00/,p(4)/4.31622272220567D+01/,
     +     p(5)/1.52989285046940D+02/,p(6)/3.39320816734344D+02/,
     +     p(7)/4.51918953711873D+02/,p(8)/3.00459261020162D+02/
      DATA q(1)/1.00000000000000D+00/,q(2)/1.27827273196294D+01/,
     +     q(3)/7.70001529352295D+01/,q(4)/2.77585444743988D+02/,
     +     q(5)/6.38980264465631D+02/,q(6)/9.31354094850610D+02/,
     +     q(7)/7.90950925327898D+02/,q(8)/3.00459260956983D+02/
      DATA r(1)/2.10144126479064D+00/,r(2)/2.62370141675169D+01/,
     +     r(3)/2.13688200555087D+01/,r(4)/4.65807828718470D+00/,
     +     r(5)/2.82094791773523D-01/
      DATA s(1)/9.41537750555460D+01/,s(2)/1.87114811799590D+02/,
     +     s(3)/9.90191814623914D+01/,s(4)/1.80124575948747D+01/
C     ..
C     .. Executable Statements ..
C-------------------------
C
C                     ABS(X) .LE. 0.5
C
      ax = abs(x)
      IF (ax.GT.0.5D0) GO TO 10
      t = x*x
      top = ((((a(1)*t+a(2))*t+a(3))*t+a(4))*t+a(5)) + 1.0D0
      bot = ((b(1)*t+b(2))*t+b(3))*t + 1.0D0
      erfc1 = 0.5D0 + (0.5D0-x* (top/bot))
      IF (ind.NE.0) erfc1 = exp(t)*erfc1
      RETURN
C
C                  0.5 .LT. ABS(X) .LE. 4
C
   10 IF (ax.GT.4.0D0) GO TO 20
      top = ((((((p(1)*ax+p(2))*ax+p(3))*ax+p(4))*ax+p(5))*ax+p(6))*ax+
     +      p(7))*ax + p(8)
      bot = ((((((q(1)*ax+q(2))*ax+q(3))*ax+q(4))*ax+q(5))*ax+q(6))*ax+
     +      q(7))*ax + q(8)
      erfc1 = top/bot
      GO TO 40
C
C                      ABS(X) .GT. 4
C
   20 IF (x.LE.-5.6D0) GO TO 60
      IF (ind.NE.0) GO TO 30
      IF (x.GT.100.0D0) GO TO 70
      IF (x*x.GT.-exparg(1)) GO TO 70
C
   30 t = (1.0D0/x)**2
      top = (((r(1)*t+r(2))*t+r(3))*t+r(4))*t + r(5)
      bot = (((s(1)*t+s(2))*t+s(3))*t+s(4))*t + 1.0D0
      erfc1 = (c-t*top/bot)/ax
C
C                      FINAL ASSEMBLY
C
   40 IF (ind.EQ.0) GO TO 50
      IF (x.LT.0.0D0) erfc1 = 2.0D0*exp(x*x) - erfc1
      RETURN

   50 w = dble(x)*dble(x)
      t = w
      e = w - dble(t)
      erfc1 = ((0.5D0+ (0.5D0-e))*exp(-t))*erfc1
      IF (x.LT.0.0D0) erfc1 = 2.0D0 - erfc1
      RETURN
C
C             LIMIT VALUE FOR LARGE NEGATIVE X
C
   60 erfc1 = 2.0D0
      IF (ind.NE.0) erfc1 = 2.0D0*exp(x*x)
      RETURN
C
C             LIMIT VALUE FOR LARGE POSITIVE X
C                       WHEN IND = 0
C
   70 erfc1 = 0.0D0
      RETURN

      END
      SUBROUTINE ERRCDF(X,ALPHA,CDF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE CUMULATIVE DISTRIBUTION
C              FUNCTION VALUE FOR THE ERROR (OR EXPONENTIAL POWER OR
C              GENERAL ERROR OR SUBBOTIN) DISTRIBUTION.  NOTE THAT
C              THERE ARE SEVERAL DIFFERENT PARAMETERIZATIONS OF
C              THIS DISTRIBUTION.  WE USE THE ONE FROM THE
C              TADIKAMALLA PAPER (SEE REFERENCE BELOW).  SPECIFICALLY,
C              THE PDF IS:
C              F(X,ALPHA)=EXP(-|X|**ALPHA)/[2*ALPHA(1+1/ALPHA)]
C                         -INFINITY < X < INFINITY, ALPHA >= 1
C              WITH ALPHA DENOTING THE SHAPE PARAMETER.
C              AT THE VALUE ALPHA.
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE 
C                                AT WHICH THE CUMULATIVE DISTRIBUTION 
C                                FUNCTION IS TO BE EVALUATED.
C                                X CAN BE ANY REAL NUMBER
C                     --ALPHA  = THE SINGLE PRECISION VALUE 
C                                OF THE TAIL LENGTH PARAMETER.
C                                ALPHA SHOULD BE >= 1..
C     OUTPUT ARGUMENTS--CDF    = THE SINGLE PRECISION CUMULATIVE
C                                DISTRIBUTION FUNCTION VALUE.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS. 
C     RESTRICTIONS--ALPHA SHOULD BE >= 1.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--DGAMMA, DGAMI
C     MODE OF INTERNAL OPERATIONS--DOUBLE PRECISION.
C     LANGUAGE--ANSI FORTRAN. 
C     REFERENCES--PANDU R. RADIKAMALLA, "RANDOM SAMPLING FROM THE
C                 EXPONENTIAL POWER DISTRIBUTION", JOURNAL OF THE
C                 AMERICAN STATISTICAL ASSOCIATION, SEPTEMBER, 1980,
C                 PAGES 683-686.
C               --JOHNSON, KOTZ, AND BALAKRISHNAN, "CONTINUOUS
C                 UNIVARIATE DISTRIBUTIONS--VOLUME 2, SECOND EDITION",
C                 WILEY, 1994.
C               --EVANS, HASTINGS AND PEACOCK, STATISTICAL
C                 DISTRIBUTIONS--THIRD EDITION", WILEY, 2000.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE:  301-975-2855
C     ORIGINAL VERSION--MAY       2003.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DX,DALPHA,DGAMMA,DGAMI,DCDF
      DOUBLE PRECISION DTERM1, DTERM2
      EXTERNAL DGAMI
      EXTERNAL DGAMMA
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(ALPHA.LT.1.0)THEN
        WRITE(ICOUT,15) 
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,16) 
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)ALPHA
        CALL DPWRST('XXX','BUG ')
        CDF=0.0
        GOTO9999
      ENDIF
   15 FORMAT('***** FATAL ERROR--THE SHAPE PARAMETER FOR THE ERROR')
   16 FORMAT('      CDF FUNCTION IS LESS THAN ONE.')
   46 FORMAT('      THE VALUE OF THE ARGUMENT IS ',E15.8)
C
C-----START POINT-----------------------------------------------------
C
      DX=DBLE(X)
      DALPHA=DBLE(ALPHA)
C
C  ALPHA=1 IS DOUBLE EXPONENTIAL
C  ALPHA=2 IS NORMAL
C
      IF(ALPHA.LE.1.00005)THEN
        CALL DEXCDF(X,CDF)
        GOTO9999
      ELSEIF(ALPHA.EQ.2.0)THEN
        CALL NORCDF(X,CDF)
        GOTO9999
      ENDIF
C
      IF(X.EQ.0.0)THEN
        CDF=0.5
        GOTO9999
      ELSEIF(X.GT.0.0)THEN
        DTERM1=-DX*DGAMI(1.0D0/DALPHA,DX**DALPHA)
        DTERM2=2.0D0*DALPHA*(DX**DALPHA)**(1.0D0/DALPHA)*
     1         DGAMMA(1.0D0+1.0D0/DALPHA)
        DCDF=0.5D0 - DTERM1/DTERM2
      ELSE
        DX=-DX
        DTERM1=-DX*DGAMI(1.0D0/DALPHA,DX**DALPHA)
        DTERM2=2.0D0*DALPHA*(DX**DALPHA)**(1.0D0/DALPHA)*
     1         DGAMMA(1.0D0+1.0D0/DALPHA)
        DCDF=0.5D0 + DTERM1/DTERM2
      ENDIF
C
      CDF=REAL(DCDF)
 9999 CONTINUE
      RETURN
      END 
      SUBROUTINE ERRPDF(X,ALPHA,PDF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE PROBABILITY DENSITY
C              FUNCTION VALUE FOR THE ERROR (OR EXPONENTIAL POWER OR
C              GENERAL ERROR OR SUBBOTIN) DISTRIBUTION.  NOTE THAT
C              THERE ARE SEVERAL DIFFERENT PARAMETERIZATIONS OF
C              THIS DISTRIBUTION.  WE USE THE ONE FROM THE
C              TADIKAMALLA PAPER (SEE REFERENCE BELOW).  SPECIFICALLY,
C              THE PDF IS:
C              F(X,ALPHA)=EXP(-|X|**ALPHA)/[2*ALPHA(1+1/ALPHA)]
C                         -INFINITY < X < INFINITY, ALPHA >= 1
C              WITH ALPHA DENOTING THE SHAPE PARAMETER.
C              AT THE VALUE ALPHA.
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE 
C                                AT WHICH THE CUMULATIVE DISTRIBUTION 
C                                FUNCTION IS TO BE EVALUATED.
C                                X CAN BE ANY REAL NUMBER
C                     --ALPHA  = THE SINGLE PRECISION VALUE 
C                                OF THE TAIL LENGTH PARAMETER.
C                                ALPHA SHOULD BE >= 1..
C     OUTPUT ARGUMENTS--PDF    = THE SINGLE PRECISION PROBABILITY
C                                DENSITY FUNCTION VALUE.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS. 
C     RESTRICTIONS--ALPHA SHOULD BE >= 1.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--DEXP, DLOG.
C     MODE OF INTERNAL OPERATIONS--DOUBLE PRECISION.
C     LANGUAGE--ANSI FORTRAN. 
C     REFERENCES--PANDU R. RADIKAMALLA, "RANDOM SAMPLING FROM THE
C                 EXPONENTIAL POWER DISTRIBUTION", JOURNAL OF THE
C                 AMERICAN STATISTICAL ASSOCIATION, SEPTEMBER, 1980,
C                 PAGES 683-686.
C               --JOHNSON, KOTZ, AND BALAKRISHNAN, "CONTINUOUS
C                 UNIVARIATE DISTRIBUTIONS--VOLUME 2, SECOND EDITION",
C                 WILEY, 1994.
C               --EVANS, HASTINGS AND PEACOCK, STATISTICAL
C                 DISTRIBUTIONS--THIRD EDITION", WILEY, 2000.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE:  301-975-2855
C     ORIGINAL VERSION--MAY       2003.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C---------------------------------------------------------------------
C

      DOUBLE PRECISION DX,DALPHA,DLNGAM,DPDF
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(ALPHA.LT.1.0)THEN
        WRITE(ICOUT,15) 
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,16) 
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)ALPHA
        CALL DPWRST('XXX','BUG ')
        PDF=0.0
        GOTO9999
      ENDIF
   15 FORMAT('***** FATAL ERROR--THE SHAPE PARAMETER FOR THE ERROR')
   16 FORMAT('      PDF FUNCTION IS LESS THAN ONE.')
   46 FORMAT('      THE VALUE OF THE ARGUMENT IS ',E15.8)
C
C-----START POINT-----------------------------------------------------
C
      DX=DBLE(X)
      DALPHA=DBLE(ALPHA)
C
      IF(ALPHA.EQ.1.0)THEN
        CALL DEXPDF(X,PDF)
        GOTO9999
      ELSEIF(ALPHA.EQ.2.0)THEN
        CALL NORPDF(X,PDF)
        GOTO9999
      ENDIF
C
      DPDF=-DABS(DX)**DALPHA-DLOG(2.0D0)-DLNGAM(1.0D0+1.0D0/DALPHA)
      IF(DPDF.LT.-80.D0)THEN
        PDF=0.0
      ELSEIF(DPDF.LT.LOG(CPUMAX))THEN
        PDF=REAL(DEXP(DPDF))
      ELSE
        PDF=LOG(CPUMAX)
        WRITE(ICOUT,105) 
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
  105 FORMAT('****** WARNING--OVERFLOW IN ERRPDF ROUTINE.')
C
 9999 CONTINUE
      RETURN
      END 
      SUBROUTINE ERRPPF(P,ALPHA,PPF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE PERCENT POINT
C              FUNCTION VALUE FOR THE ERROR (OR EXPONENTIAL POWER OR
C              GENERAL ERROR OR SUBBOTIN) DISTRIBUTION.  NOTE THAT
C              THERE ARE SEVERAL DIFFERENT PARAMETERIZATIONS OF
C              THIS DISTRIBUTION.  WE USE THE ONE FROM THE
C              TADIKAMALLA PAPER (SEE REFERENCE BELOW).  SPECIFICALLY,
C              THE PPF IS:
C              F(X,ALPHA)=EXP(-|X|**ALPHA)/[2*ALPHA(1+1/ALPHA)]
C                         -INFINITY < X < INFINITY, ALPHA >= 1
C              WITH ALPHA DENOTING THE SHAPE PARAMETER.
C              AT THE VALUE ALPHA.
C              THE PERCENT POINT FUNCTION IS COMPUTED NUMERICALLY
C              USING A BISECTION METHOD.
C     INPUT  ARGUMENTS--P      = THE SINGLE PRECISION VALUE 
C                                AT WHICH THE PERCENT POINT 
C                                FUNCTION IS TO BE EVALUATED.
C                                X CAN BE ANY REAL NUMBER
C                     --ALPHA  = THE SINGLE PRECISION VALUE 
C                                OF THE TAIL LENGTH PARAMETER.
C                                ALPHA SHOULD BE >= 1..
C     OUTPUT ARGUMENTS--PPF    = THE SINGLE PRECISION PERCENT POINT
C                                FUNCTION VALUE.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS. 
C     RESTRICTIONS--ALPHA SHOULD BE >= 1.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--DEXP, DLOG.
C     MODE OF INTERNAL OPERATIONS--DOUBLE PRECISION.
C     LANGUAGE--ANSI FORTRAN. 
C     REFERENCES--PANDU R. RADIKAMALLA, "RANDOM SAMPLING FROM THE
C                 EXPONENTIAL POWER DISTRIBUTION", JOURNAL OF THE
C                 AMERICAN STATISTICAL ASSOCIATION, SEPTEMBER, 1980,
C                 PAGES 683-686.
C               --JOHNSON, KOTZ, AND BALAKRISHNAN, "CONTINUOUS
C                 UNIVARIATE DISTRIBUTIONS--VOLUME 2, SECOND EDITION",
C                 WILEY, 1994.
C               --EVANS, HASTINGS AND PEACOCK, STATISTICAL
C                 DISTRIBUTIONS--THIRD EDITION", WILEY, 2000.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE:  301-975-2855
C     ORIGINAL VERSION--MAY       2003.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DALPHA,DGAMMA
      EXTERNAL DGAMMA
C
      DATA EPS /0.00001/
      DATA SIG /1.0E-6/
      DATA ZERO /0./
      DATA MAXIT /500/
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      ASGN=1.0
      PPF=0.0
      IF(P.LE.0.0 .OR. P.GE.1.0)THEN
        WRITE(ICOUT,5) 
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,6) 
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)P
        CALL DPWRST('XXX','BUG ')
        GOTO9999
      ELSEIF(ALPHA.LT.1.0)THEN
        WRITE(ICOUT,15) 
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,16) 
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)ALPHA
        CALL DPWRST('XXX','BUG ')
        GOTO9999
      ENDIF
    5 FORMAT('***** ERROR--THE INPUT ARGUMENT FOR THE ERROR')
    6 FORMAT('      PERCENT POINT FUNCTION IS OUTSIDE THE ALLOWABLE ',
     1       '[0,1] INTERVAL.')
   15 FORMAT('***** ERROR--THE SHAPE PARAMETER FOR THE ERROR')
   16 FORMAT('      PERCENT POINT FUNCTION IS LESS THAN ONE.')
   46 FORMAT('      THE VALUE OF THE ARGUMENT IS ',G15.7,'.')
C
      IF(P.EQ.0.5)THEN
        PPF=0.0
        GOTO9999
      ELSEIF(ALPHA.LE.1.000005)THEN
        CALL DEXPPF(P,PPF)
        GOTO9999
      ELSEIF(ALPHA.EQ.2.0)THEN
        CALL NORPPF(P,PPF)
        GOTO9999
      ENDIF
C
      DALPHA=DBLE(ALPHA)
C
C  P = 0.5 IS ZERO.  USE SYMMETRY TO HANDLE P < 0.5 AND P > 0.5
C  CASES WITH SAME CODE (JUST NEED TO CHANGE SIGN OF FINAL PPF
C  VALUE).
C
      ASGN=1.0
      IF(P.LT.0.5)THEN
        P=1.0 - P
        ASGN=-1.0
      ENDIF
C
C  FIND BRACKETING INTERVAL.  BRACKETED ABOVE BY ZERO.  STANDARD
C  DEVIATION = SQRT(GAMMA(3/ALPHA)/GAMMA(1/ALPHA)).
C
      SD=DSQRT(DGAMMA(3.0D0/DALPHA)/DGAMMA(1.0D0/DALPHA))
      XL=0.0D0
      XINC=SD
      ICOUNT=0
      MAXCNT=200
C
   91 CONTINUE
      XR=XL+XINC
      IF(XL.LE.0.0)XL=0.0
      IF(XR.LE.0.0)XR=XL+1.0
      CALL ERRCDF(XL,ALPHA,CDFL)
      CALL ERRCDF(XR,ALPHA,CDFR)
      IF(CDFL.LT.P .AND. CDFR.LT.P)THEN
        XL=XR
      ELSEIF(CDFL.GT.P .AND. CDFR.GT.P)THEN
        XL=XL-XINC
      ELSE
        GOTO99
      ENDIF
      ICOUNT=ICOUNT+1
      IF(ICOUNT.GT.MAXCNT)THEN
        WRITE(ICOUT,96)
        CALL DPWRST('XXX','BUG ')
        PPF=0.0
        GOTO9999
      ENDIF
   96 FORMAT('***** ERROR--ERRPPF UNABLE TO FIND BRACKETING ',
     *       'INTERVAL. *****')
      GOTO91
C
C  BISECTION METHOD
C
   99 CONTINUE
      IC = 0
      FXL = -P
      FXR = 1.0 - P
  105 CONTINUE
      X = (XL+XR)*0.5
      CALL ERRCDF(X,ALPHA,CDF)
      P1=CDF
      PPF=X
      FCS = P1 - P
      IF(FCS*FXL.GT.ZERO)GOTO110
      XR = X
      FXR = FCS 
      GOTO115
  110 CONTINUE
      XL = X
      FXL = FCS
  115 CONTINUE
      XRML = XR - XL
      IF(XRML.LE.SIG .AND. ABS(FCS).LE.EPS)GOTO9999
      IC = IC + 1
      IF(IC.LE.MAXIT)GOTO105
      WRITE(ICOUT,130)
      CALL DPWRST('XXX','BUG ')
  130 FORMAT('***** ERROR--ERRPPF ROUTINE DID NOT CONVERGE. ***')
      GOTO9999
C
C
 9999 CONTINUE
      PPF=ASGN*PPF
      RETURN
      END 
      SUBROUTINE ERRRAN(N,ALPHA,ISEED,X)
C
C     PURPOSE--THIS SUBROUTINE GENERATES A RANDOM SAMPLE OF SIZE N
C              FROM THE ERROR DISTRIBUTION WITH SINGLE PRECISION SHAPE
C              PARAMETER = ALPHA.  THIS DISTRIBUTION IS ALSO REFERRED
C              TO AS THE SUBBOTIN, EXPONENTIAL POWER, OR GENERAL
C              ERROR DISTRIBUTION.  NOTE THAT
C              THERE ARE SEVERAL DIFFERENT PARAMETERIZATIONS OF
C              THIS DISTRIBUTION.  WE USE THE ONE FROM THE
C              TADIKAMALLA PAPER (SEE REFERENCE BELOW).  SPECIFICALLY,
C              THE PDF IS:
C              F(X,ALPHA)=EXP(-|X|**ALPHA)/[2*ALPHA(1+1/ALPHA)]
C                         -INFINITY < X < INFINITY, ALPHA >= 1
C              WITH ALPHA DENOTING THE SHAPE PARAMETER.
C              AT THE VALUE ALPHA.
C     INPUT  ARGUMENTS--N      = THE DESIRED INTEGER NUMBER
C                                OF RANDOM NUMBERS TO BE
C                                GENERATED.
C                     --ALPHA  = THE SINGLE PRECISION VALUE OF THE
C                                FIRST  SHAPE PARAMETER.
C                                ALPHA SHOULD BE GREATER THAN 1.0.
C     OUTPUT ARGUMENTS--X      = A SINGLE PRECISION VECTOR
C                                (OF DIMENSION AT LEAST N)
C                                INTO WHICH THE GENERATED
C                                RANDOM SAMPLE WILL BE PLACED.
C     OUTPUT--A RANDOM SAMPLE OF SIZE N
C             FROM THE ERROR DISTRIBUTION
C             WITH SHAPE PARAMETER VALUE = ALPHA
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--THERE IS NO RESTRICTION ON THE MAXIMUM VALUE
C                   OF N FOR THIS SUBROUTINE.
C                 --ALPHA SHOULD BE GREATER THAN
C                   OR EQUAL TO 1.0.
C     OTHER DATAPAC   SUBROUTINES NEEDED--UNIRAN, GAMRAN, DEXRAN,
C                                         GAMRAN.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--NONE
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--PANDU R. RADIKAMALLA, "RANDOM SAMPLING FROM THE
C                 EXPONENTIAL POWER DISTRIBUTION", JOURNAL OF THE
C                 AMERICAN STATISTICAL ASSOCIATION, SEPTEMBER, 1980,
C                 PAGES 683-686.
C               --JOHNSON, KOTZ, AND BALAKRISHNAN, "CONTINUOUS
C                 UNIVARIATE DISTRIBUTIONS--VOLUME 2, SECOND EDITION",
C                 WILEY, 1994.
C               --EVANS, HASTINGS AND PEACOCK, STATISTICAL
C                 DISTRIBUTIONS--THIRD EDITION", WILEY, 2000.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1966)
C               EXCEPTION--HOLLARITH STRINGS IN FORMAT STATEMENTS
C                          DENOTED BY QUOTES RATHER THAN NH.
C     VERSION NUMBER--2003.5
C     ORIGINAL VERSION--MAY       2003.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C---------------------------------------------------------------------
C
      DIMENSION X(*)
      DIMENSION XTEMP(1)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(N.LT.1)THEN
        WRITE(ICOUT, 5)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,47)N
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
      IF(ALPHA.LT.1.0)THEN
        WRITE(ICOUT,16)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)ALPHA
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
    5 FORMAT('***** FATAL ERROR--THE NUMBER OF REQUESTED ERROR ',
     1'RANDOM NUMBERS IS NON-POSITIVE.')
   16 FORMAT('***** FATAL ERROR--THE SHAPE PARAMETER FOR THE ',
     1'ERROR DISTRIBUTION IS LESS THAN 1.0 *****')
   46 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',E15.8,' *****')
   47 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',I8,' *****')
C
C     GENERATE N ERROR RANDOM NUMBERS USING THE ALGORITHM OF
C     RADIKAMALLA.  THIS IS A FORTRAN IMPLEMENTATION OF THE ROUTINE
C     "gsl_ran_exppow" IN THE GNU GSL SCIENTIFIC LIBRARY.
C
      NTEMP=1
C
C  FIRST, HANDLE SPECIAL CASES (ALPHA = 1, 2 ARE DOUBLE EXPONENTIAL
C  AND NORMAL, RESPECTIVELY).
C
      IF(ALPHA.EQ.1.0)THEN
        CALL DEXRAN(N,ISEED,X)
      ELSEIF(ALPHA.EQ.2.0)THEN
        CALL NORRAN(N,ISEED,X)
C
C  CASE WHERE 1 < ALPHA < 2.  USE DOUBLE EXPONENTIAL DISTRIBUTION
C  FOR REJECTION METHOD.
C
      ELSEIF(ALPHA.GT.1.0 .AND. ALPHA.LT.2.0)THEN
        S=1.4489
        DO390I=1,N
  300     CONTINUE
            CALL DEXRAN(NTEMP,ISEED,XTEMP)
            AX=XTEMP(1)
            CALL DEXPDF(AX,AY)
            CALL ERRPDF(AX,ALPHA,AH)
            RATIO=AH/(S*AY)
            CALL UNIRAN(NTEMP,ISEED,XTEMP)
            U=XTEMP(1)
          IF(U.GT.RATIO)GOTO300
          X(I)=AX
  390   CONTINUE
C
C  CASE WHERE ALPHA > 2.  USE GAUSSIAN FOR FOR REJECTION METHOD.
C
      ELSE
        SIGMA=1.0/1.0/SQRT(2.0)
        S=2.4091
        DO490I=1,N
  400     CONTINUE
            CALL NORRAN(NTEMP,ISEED,XTEMP)
            AX=SIGMA*XTEMP(1)
            CALL NORPDF(AX/SIGMA,AY)
            AY=AY/SIGMA
            CALL ERRPDF(AX,ALPHA,AH)
            RATIO=AH/(S*AY)
            CALL UNIRAN(NTEMP,ISEED,XTEMP)
            U=XTEMP(1)
          IF(U.GT.RATIO)GOTO400
          X(I)=AX
  490   CONTINUE
      ENDIF
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE ERRORF(IANS1,IANS2,IANS3,IANS4,AMIN,AMAX,DEF,
     1ANS2,IERROR)
C
C     PURPOSE--ANALYZE FLOATING POINT INPUT TERMINAL RESPONSE DURING
C              EXECUTION OF DATAPLOT AND
C              DETERMINE IF VALID.
C              ALSO, MAKE CONVERSION TO FLOATING POINT.
C     INPUT  ARGUMENTS--IANS1
C                     --IANS2
C                     --IANS3
C                     --IANS4
C                     --AMIN
C                     --AMAX
C                     --DEF
C     OUTPUT ARGUMENTS--ANS2
C                     --IERROR
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--82/7
C     ORIGINAL VERSION--OCTOBER 18, 1976.
C     UPDATED         --OCTOBER   1976.
C     UPDATED         --JULY      1978.
C     UPDATED         --OCTOBER   1978.
C     UPDATED         --FEBRUARY  1981.
C     UPDATED         --FEBRUARY  1982.
C     UPDATED         --MAY       1982.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 IANS1
      CHARACTER*4 IANS2
      CHARACTER*4 IANS3
      CHARACTER*4 IANS4
      CHARACTER*4 IERROR
C
      CHARACTER*4 IBUG1
      CHARACTER*4 IBUG2
      CHARACTER*4 IA
C
C---------------------------------------------------------------------
C
      DIMENSION IA(20)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ANS2=0
      IERROR='NO'
      IBUG1='OFF'
      IBUG2='OFF'
C
C               ************************************************************
C               **  DEFINE NUMASC = NUMBER OF ASCII CHARACTERS PER WORD.  **
C               **  THIS IS 4 REGARDLESS OF THE COMPUTER MAKE AND         **
C               **  REGARDLESS OF THE WORD SIZE.                          **
C               ************************************************************
C
      NUMASC=4
      NUMAS2=2*NUMASC
      NUMAS3=3*NUMASC
C
C               *******************************
C               **  STEP 1--                 **
C               **  CHECK FOR BLANK ENTRIES  **
C               *******************************
C
      IF(IANS1.EQ.'    '.AND.IANS2.EQ.'    '.AND.IANS3.EQ.'    '.AND.
     1IANS4.EQ.'    ')GOTO105
      GOTO110
  105 CONTINUE
      ANS2=DEF
      IF(AMIN.LE.ANS2.AND.ANS2.LE.AMAX)GOTO9000
      GOTO1750
  110 CONTINUE
C
C               *******************************************************
C               **  STEP 2--                                         **
C               **  DECOMPOSE THE INPUT WORDS                        **
C               **  IANS1, IANS2, IANS3, AND IANS4                   **
C               **  INTO 16 NUMBPC-BIT CHUNKS                        **
C               **  WHERE NUMBPC = NUMBER OF BITS PER CHARACTER      **
C               **  FOR THIS COMPUTER.                               **
C               **  EACH NUMBPC-BIT CHUNK WILL (BY CONSTRUCTION)     **
C               **  BE STORED                                        **
C               **  IN A LEFT-JUSTIFIED FASHION IN IA(.)             **
C               **  WITH (BY CONSTRUCTION) BLANK-FILL TO THE RIGHT.  **
C               *******************************************************
C
      DO150I=1,16
      IA(I)='    '
  150 CONTINUE
      DO200I=1,4
      ISTAR3=NUMBPC*(I-1)
      ISTAR3=IABS(ISTAR3)
      I1=I
      I2=I1+NUMASC
      I3=I1+NUMAS2
      I4=I1+NUMAS3
      CALL DPCHEX(ISTAR3,NUMBPC,IANS1,0,NUMBPC,IA(I1))
      CALL DPCHEX(ISTAR3,NUMBPC,IANS2,0,NUMBPC,IA(I2))
      CALL DPCHEX(ISTAR3,NUMBPC,IANS3,0,NUMBPC,IA(I3))
      CALL DPCHEX(ISTAR3,NUMBPC,IANS4,0,NUMBPC,IA(I4))
  200 CONTINUE
      IF(IBUG1.EQ.'OFF')GOTO350
      DO300I=1,16
      WRITE(ICOUT,305)IA(I)
  305 FORMAT(A4)
      CALL DPWRST('XXX','BUG ')
  300 CONTINUE
  350 CONTINUE
C
C               **********************************************
C               **  STEP 3--                                **
C               **  CHECK FOR AN EXIT, END, STOP, OR TERM.  **
C               **********************************************
C
      DO500I=1,16
      IP1=I+1
      IP2=I+2
      IP3=I+3
      IF(IA(I).EQ.'E'.AND.IA(IP1).EQ.'X'.AND.IA(IP2).EQ.'I'
     1.AND.IA(IP3).EQ.'T')GOTO510
      IF(IA(I).EQ.'E'.AND.IA(IP1).EQ.'N'.AND.IA(IP2).EQ.'D')
     1GOTO510
      IF(IA(I).EQ.'S'.AND.IA(IP1).EQ.'T'.AND.IA(IP2).EQ.'O'
     1.AND.IA(IP3).EQ.'P')GOTO510
      IF(IA(I).EQ.'T'.AND.IA(IP1).EQ.'E'.AND.IA(IP2).EQ.'R'
     1.AND.IA(IP3).EQ.'M')GOTO510
  500 CONTINUE
      GOTO550
  510 WRITE(ICOUT,520)
  520 FORMAT('THIS IS AN EXIT FROM DATAPLOT ')
      CALL DPWRST('XXX','BUG ')
      STOP
  550 CONTINUE
C
C               *********************************
C               **  STEP 4--                   **
C               **  CONVERT TO FLOATING POINT  **
C               *********************************
C
C               ************************************************************
C               **  STEP 4.1--                                            **
C               **  FIRST OF ALL, LOCATE THE DECIMAL POINT (IF EXISTENT)  **
C               ************************************************************
C
      ILOC=0
      IDECPT=0
      DO1000I=1,16
      IF(IA(I).EQ.'.')ILOC=I
      IF(IA(I).EQ.'.')IDECPT=IDECPT+1
 1000 CONTINUE
      IF(IDECPT.GE.2)GOTO1530
      IF(IDECPT.EQ.1)GOTO1150
      DO1100I=1,16
      IREV=16-I+1
      IF(IA(IREV).EQ.' ')GOTO1100
      IF(IA(IREV).EQ.'0')GOTO1110
      IF(IA(IREV).EQ.'1')GOTO1110
      IF(IA(IREV).EQ.'2')GOTO1110
      IF(IA(IREV).EQ.'3')GOTO1110
      IF(IA(IREV).EQ.'4')GOTO1110
      IF(IA(IREV).EQ.'5')GOTO1110
      IF(IA(IREV).EQ.'6')GOTO1110
      IF(IA(IREV).EQ.'7')GOTO1110
      IF(IA(IREV).EQ.'8')GOTO1110
      IF(IA(IREV).EQ.'9')GOTO1110
      IF(IA(IREV).EQ.'+')GOTO1530
      IF(IA(IREV).EQ.'-')GOTO1530
 1100 CONTINUE
      GOTO1530
 1110 ILOC=IREV+1
 1150 CONTINUE
      IF(IBUG2.EQ.'ON')WRITE(ICOUT,1111)ILOC,IDECPT
 1111 FORMAT('ILOC = ',I8,'    IDECPT = ',I8)
      IF(IBUG2.EQ.'ON')CALL DPWRST('XXX','BUG ')
C
C               *******************************************************
C               **  STEP 4.2--                                       **
C               **  SECONDLY, COMPUTE THE INTEGER PART OF THE VALUE  **
C               *******************************************************
C
      SIGN=1.0
      IDIGI=0
      ISIGN=0
      SUMI=0
      ILOCM1=ILOC-1
      IF(ILOCM1.LT.1)GOTO1250
      DO1200I=1,ILOCM1
      IREV=ILOCM1-I+1
      IF(IA(IREV).EQ.' ')GOTO1200
      IF(IA(IREV).EQ.'0')GOTO1210
      IF(IA(IREV).EQ.'1')GOTO1211
      IF(IA(IREV).EQ.'2')GOTO1212
      IF(IA(IREV).EQ.'3')GOTO1213
      IF(IA(IREV).EQ.'4')GOTO1214
      IF(IA(IREV).EQ.'5')GOTO1215
      IF(IA(IREV).EQ.'6')GOTO1216
      IF(IA(IREV).EQ.'7')GOTO1217
      IF(IA(IREV).EQ.'8')GOTO1218
      IF(IA(IREV).EQ.'9')GOTO1219
      IF(IA(IREV).EQ.'+')GOTO1220
      IF(IA(IREV).EQ.'-')GOTO1221
      GOTO1530
 1210 ITERM=0
      GOTO1225
 1211 ITERM=1
      GOTO1225
 1212 ITERM=2
      GOTO1225
 1213 ITERM=3
      GOTO1225
 1214 ITERM=4
      GOTO1225
 1215 ITERM=5
      GOTO1225
 1216 ITERM=6
      GOTO1225
 1217 ITERM=7
      GOTO1225
 1218 ITERM=8
      GOTO1225
 1219 ITERM=9
      GOTO1225
 1220 ISIGN=ISIGN+1
      GOTO1200
 1221 ISIGN=ISIGN+1
      SIGN=-SIGN
      GOTO1200
 1225 IDIGI=IDIGI+1
      TERM=ITERM
      IEXP=IDIGI-1
      SUMI=SUMI+TERM*(10.0**IEXP)
 1200 CONTINUE
 1250 CONTINUE
      IF(ISIGN.GE.2)GOTO1530
      IF(IBUG2.EQ.'ON')WRITE(ICOUT,1255)IDIGI,SUMI
 1255 FORMAT('IDIGI = ',I8,'    SUMI = ',F20.10)
      IF(IBUG2.EQ.'ON')CALL DPWRST('XXX','BUG ')
C
C               ******************************************************
C               **  STEP 4.3--                                      **
C               **  THIRDLY, COMPUTE THE DECIMAL PART OF THE VALUE  **
C               ******************************************************
C
      IDIGD=0
      SUMD=0.0
      ILOCP1=ILOC+1
      IF(ILOCP1.GT.16)GOTO1350
      DO1300I=ILOCP1,16
      IF(IA(I).EQ.' ')GOTO1300
      IF(IA(I).EQ.'0')GOTO1310
      IF(IA(I).EQ.'1')GOTO1311
      IF(IA(I).EQ.'2')GOTO1312
      IF(IA(I).EQ.'3')GOTO1313
      IF(IA(I).EQ.'4')GOTO1314
      IF(IA(I).EQ.'5')GOTO1315
      IF(IA(I).EQ.'6')GOTO1316
      IF(IA(I).EQ.'7')GOTO1317
      IF(IA(I).EQ.'8')GOTO1318
      IF(IA(I).EQ.'9')GOTO1319
      GOTO1530
 1310 ITERM=0
      GOTO1325
 1311 ITERM=1
      GOTO1325
 1312 ITERM=2
      GOTO1325
 1313 ITERM=3
      GOTO1325
 1314 ITERM=4
      GOTO1325
 1315 ITERM=5
      GOTO1325
 1316 ITERM=6
      GOTO1325
 1317 ITERM=7
      GOTO1325
 1318 ITERM=8
      GOTO1325
 1319 ITERM=9
      GOTO1325
 1325 IDIGD=IDIGD+1
      TERM=ITERM
      SUMD=SUMD+TERM/(10.0**IDIGD)
 1300 CONTINUE
 1350 CONTINUE
      IF(IBUG2.EQ.'ON')WRITE(ICOUT,1355)IDIGD,SUMD
 1355 FORMAT('IDIGD = ',I8,'    SUMD = ',F20.10)
      IF(IBUG2.EQ.'ON')CALL DPWRST('XXX','BUG ')
      IDIGT=IDIGI+IDIGD
      IF(IDIGT.LE.0)GOTO1530
      ANS2=SUMI+SUMD
      IF(SIGN.LT.0.0)ANS2=-ANS2
      IF(AMIN.LE.ANS2.AND.ANS2.LE.AMAX)GOTO9000
      GOTO1750
C
 1530 CONTINUE
      WRITE(ICOUT,1531)
 1531 FORMAT('***** ERROR IN ERRORF--LAST ENTRY WAS ',
     1'INVALID ***')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1532)
 1532 FORMAT('      IT SHOULD HAVE BEEN SOME INTEGER OR ')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1533)
 1533 FORMAT('      FLOATING POINT NUMBER, BUT WAS NOT.')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1534)IANS1,IANS2,IANS3,IANS4
 1534 FORMAT('      THE ENTRY WAS ',4A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1535)
 1535 FORMAT('      REENTER PROPER VALUE NOW--')
      CALL DPWRST('XXX','BUG ')
      IERROR='YES'
      GOTO9000
C
 1750 CONTINUE
      WRITE(ICOUT,1531)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1752)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1753)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1754)AMIN,AMAX
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1755)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1734)IANS1,IANS2,IANS3,IANS4
 1734 FORMAT('      THE ENTRY WAS ',4A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1735)
 1735 FORMAT('      REENTER PROPER VALUE NOW--')
      CALL DPWRST('XXX','BUG ')
 1752 FORMAT('      IT SHOULD HAVE BEEN SOME INTEGER OR ')
 1753 FORMAT('      FLOATING POINT NUMBER ')
 1754 FORMAT('      BETWEEN ',E15.7,' AND ',E15.7,' (INCLUSIVE),')
 1755 FORMAT('      BUT WAS NOT.')
      IERROR='YES'
      GOTO9000
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT       **
C               *****************
C
 9000 CONTINUE
      RETURN
      END
      subroutine ess(y,n,len,ideg,njump,userw,rw,ys,res)
c
c  This routine is part of the Bill Cleveland seasonal loess
c  program.
c
      integer n, len, ideg, njump, newnj, nleft, nright, nsh, k, i, j
      real y(n), rw(n), ys(n), res(n), delta
      logical ok, userw
      if(.not.(n .lt. 2))goto 23019
      ys(1) = y(1)
      return
23019 continue
      newnj = min0(njump, n-1)
      if(.not.(len .ge. n))goto 23021
      nleft = 1
      nright = n
      do 23023 i = 1,n,newnj 
      call est(y,n,len,ideg,float(i),ys(i),nleft,nright,res,userw,rw,ok)
      if(.not.( .not. ok))goto 23025
      ys(i) = y(i)
23025 continue
23023 continue
      goto 23022
23021 continue
      if(.not.(newnj .eq. 1))goto 23027
      nsh = (len+1)/2
      nleft = 1
      nright = len
      do 23029 i = 1,n 
      if(.not.(i .gt. nsh  .and.  nright .ne. n))goto 23031
      nleft = nleft+1
      nright = nright+1
23031 continue
      call est(y,n,len,ideg,float(i),ys(i),nleft,nright,res,userw,rw,ok)
      if(.not.( .not. ok))goto 23033
      ys(i) = y(i)
23033 continue
23029 continue
      goto 23028
23027 continue
      nsh = (len+1)/2
      do 23035 i = 1,n,newnj 
      if(.not.(i .lt. nsh))goto 23037
      nleft = 1
      nright = len
      goto 23038
23037 continue
      if(.not.(i .ge. n-nsh+1))goto 23039
      nleft = n-len+1
      nright = n
      goto 23040
23039 continue
      nleft = i-nsh+1
      nright = len+i-nsh
23040 continue
23038 continue
      call est(y,n,len,ideg,float(i),ys(i),nleft,nright,res,userw,rw,ok)
      if(.not.( .not. ok))goto 23041
      ys(i) = y(i)
23041 continue
23035 continue
23028 continue
23022 continue
      if(.not.(newnj .ne. 1))goto 23043
      do 23045 i = 1,n-newnj,newnj 
      delta = (ys(i+newnj)-ys(i))/float(newnj)
      do 23047 j = i+1,i+newnj-1
      ys(j) = ys(i)+delta*float(j-i)
23047 continue
23045 continue
      k = ((n-1)/newnj)*newnj+1
      if(.not.(k .ne. n))goto 23049
      call est(y,n,len,ideg,float(n),ys(n),nleft,nright,res,userw,rw,ok)
      if(.not.( .not. ok))goto 23051
      ys(n) = y(n)
23051 continue
      if(.not.(k .ne. n-1))goto 23053
      delta = (ys(n)-ys(k))/float(n-k)
      do 23055 j = k+1,n-1
      ys(j) = ys(k)+delta*float(j-k)
23055 continue
23053 continue
23049 continue
23043 continue
      return
      end
      DOUBLE PRECISION FUNCTION esum(mu,x)
C-----------------------------------------------------------------------
C                    EVALUATION OF EXP(MU + X)
C-----------------------------------------------------------------------
C     .. Scalar Arguments ..
      DOUBLE PRECISION x
      INTEGER mu
C     ..
C     .. Local Scalars ..
      DOUBLE PRECISION w
C     ..
C     .. Intrinsic Functions ..
      INTRINSIC exp
C     ..
C     .. Executable Statements ..

      IF (x.GT.0.0D0) GO TO 10
C
      IF (mu.LT.0) GO TO 20
      w = mu + x
      IF (w.GT.0.0D0) GO TO 20
      esum = exp(w)
      RETURN
C
   10 IF (mu.GT.0) GO TO 20
      w = mu + x
      IF (w.LT.0.0D0) GO TO 20
      esum = exp(w)
      RETURN
C
   20 w = mu
      esum = exp(w)*exp(x)
      RETURN

      END
      subroutine est(y,n,len,ideg,xs,ys,nleft,nright,w,userw,rw,ok)
c
c  This routine is part of the Bill Cleveland seasonal loess
c  program.
c
      integer n, len, ideg, nleft, nright, j
      real y(n), w(n), rw(n), xs, ys, range, h, h1, h9, a, b, c, r
      logical userw,ok
      range = float(n)-float(1)
      h = amax1(xs-float(nleft),float(nright)-xs)
      if(.not.(len .gt. n))goto 23057
      h = h+float((len-n)/2)
23057 continue
      h9 = .999*h
      h1 = .001*h
      a = 0.0
      do 23059 j = nleft,nright 
      w(j) = 0.
      r = abs(float(j)-xs)
      if(.not.(r .le. h9))goto 23061
      if(.not.(r .le. h1))goto 23063
      w(j) = 1.
      goto 23064
23063 continue
      w(j) = (1.0-(r/h)**3)**3
23064 continue
      if(.not.(userw))goto 23065
      w(j) = rw(j)*w(j)
23065 continue
      a = a+w(j)
23061 continue
23059 continue
      if(.not.(a .le. 0.0))goto 23067
      ok = .false.
      goto 23068
23067 continue
      ok = .true.
      do 23069 j = nleft,nright
      w(j) = w(j)/a
23069 continue
      if(.not.((h .gt. 0.) .and. (ideg .gt. 0)))goto 23071
      a = 0.0
      do 23073 j = nleft,nright
      a = a+w(j)*float(j)
23073 continue
      b = xs-a
      c = 0.0
      do 23075 j = nleft,nright
      c = c+w(j)*(float(j)-a)**2
23075 continue
      if(.not.(sqrt(c) .gt. .001*range))goto 23077
      b = b/c
      do 23079 j = nleft,nright
      w(j) = w(j)*(b*(float(j)-a)+1.0)
23079 continue
23077 continue
23071 continue
      ys = 0.0
      do 23081 j = nleft,nright
      ys = ys+w(j)*y(j)
23081 continue
23068 continue
      return
      end
      SUBROUTINE EV1CDF(X,MINMAX,CDF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE CUMULATIVE DISTRIBUTION
C              FUNCTION VALUE FOR THE EXTREME VALUE TYPE 1
C              DISTRIBUTION.
C              THE EXTREME VALUE TYPE 1 DISTRIBUTION USED
C              HEREIN HAS MEAN = EULER'S NUMBER = 0.57721566
C              AND STANDARD DEVIATION = PI/SQRT(6) = 1.28254983.
C              THIS DISTRIBUTION IS DEFINED FOR ALL X
C              AND HAS THE PROBABILITY DENSITY FUNCTION
C              FOR THE MAXIMUM ORDER STATISTIC
C              F(X) = (EXP(-X)) * (EXP(-(EXP(-X))))
C              WHICH SIMPLIFIES TO:
C              F(X) = EXP(-X - EXP(-X))
C              FOR THE MINIMUIM ORDER STATISTIC
C              F(X) = (EXP(X)) * (EXP(-(EXP(X))))
C              WHICH SIMPLIFIES TO:
C              F(X) = EXP(X-EXP(X))
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE 
C                                AT WHICH THE CUMULATIVE DISTRIBUTION 
C                                FUNCTION IS TO BE EVALUATED.
C     OUTPUT ARGUMENTS--CDF    = THE SINGLE PRECISION CUMULATIVE
C                                DISTRIBUTION FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION CUMULATIVE DISTRIBUTION
C             FUNCTION VALUE CDF FOR THE EXTREME VALUE TYPE 1
C             DISTRIBUTION WITH MEAN = EULER'S NUMBER = 0.57721566
C             AND STANDARD DEVIATION = PI/SQRT(6) = 1.28254983.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS. 
C     RESTRICTIONS--NONE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--EXP.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN. 
C     REFERENCES--JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--1, 1970, PAGES 272-295.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING LABORATORY (205.03)
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE:  301-921-2315
C     ORIGINAL VERSION--APRIL     1994. 
C     UPDATED         --JULY      2005. CODE IN DOUBLE PRECIONS FOR
C                                       BETTER ACCURACY
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DX
      DOUBLE PRECISION DCDF
C
      INCLUDE 'DPCOP2.INC'
C
C---------------------------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS.
C     NO INPUT ARGUMENT ERRORS POSSIBLE 
C     FOR THIS DISTRIBUTION.
C
C-----START POINT-----------------------------------------------------
C
      DX=DBLE(X)
      DCDF=0.0D0
      IF(MINMAX.EQ.1)THEN
        DCDF=1.0D0-DEXP(-(DEXP(DX))) 
      ELSEIF(MINMAX.EQ.2 .OR. MINMAX.EQ.0)THEN
        DCDF=DEXP(-(DEXP(-DX))) 
      ELSE
         WRITE(ICOUT,1800)
 1800    FORMAT('*****ERROR IN EV1CDF--MINMAX NOT 1 OR 2')
         CALL DPWRST('XXX','BUG ')
      END IF
      CDF=REAL(DCDF)
C
      RETURN
      END 
      SUBROUTINE EV1CDD(X,MINMAX,CDF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE CUMULATIVE DISTRIBUTION
C              FUNCTION VALUE FOR THE EXTREME VALUE TYPE 1
C              DISTRIBUTION.
C              THE EXTREME VALUE TYPE 1 DISTRIBUTION USED
C              HEREIN HAS MEAN = EULER'S NUMBER = 0.57721566
C              AND STANDARD DEVIATION = PI/SQRT(6) = 1.28254983.
C              THIS DISTRIBUTION IS DEFINED FOR ALL X
C              AND HAS THE PROBABILITY DENSITY FUNCTION
C              FOR THE MAXIMUM ORDER STATISTIC
C              F(X) = (EXP(-X)) * (EXP(-(EXP(-X))))
C              WHICH SIMPLIFIES TO:
C              F(X) = EXP(-X - EXP(-X))
C              FOR THE MINIMUIM ORDER STATISTIC
C              F(X) = (EXP(X)) * (EXP(-(EXP(X))))
C              WHICH SIMPLIFIES TO:
C              F(X) = EXP(X-EXP(X))
C     NOTE  --THIS IS A DOUBLE PRECISION VERSION OF EV1CDF USED
C             IN CALCULATING HAZARD FUNCTIONS.
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE 
C                                AT WHICH THE CUMULATIVE DISTRIBUTION 
C                                FUNCTION IS TO BE EVALUATED.
C     OUTPUT ARGUMENTS--CDF    = THE SINGLE PRECISION CUMULATIVE
C                                DISTRIBUTION FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION CUMULATIVE DISTRIBUTION
C             FUNCTION VALUE CDF FOR THE EXTREME VALUE TYPE 1
C             DISTRIBUTION WITH MEAN = EULER'S NUMBER = 0.57721566
C             AND STANDARD DEVIATION = PI/SQRT(6) = 1.28254983.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS. 
C     RESTRICTIONS--NONE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--EXP.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN. 
C     REFERENCES--JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--1, 1970, PAGES 272-295.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING LABORATORY (205.03)
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE:  301-921-2315
C     ORIGINAL VERSION--APRIL     1994. 
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      DOUBLE PRECISION X
      DOUBLE PRECISION CDF
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C---------------------------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS.
C     NO INPUT ARGUMENT ERRORS POSSIBLE 
C     FOR THIS DISTRIBUTION.
C
C-----START POINT-----------------------------------------------------
C
      IF(MINMAX.EQ.1)THEN
        CDF=1.0D0-DEXP(-(DEXP(X))) 
      ELSEIF(MINMAX.EQ.2 .OR. MINMAX.EQ.0)THEN
        CDF=DEXP(-(DEXP(-X))) 
      ELSE
         WRITE(ICOUT,1800)
 1800    FORMAT('*****ERROR IN EV1CDF--MINMAX NOT 1 OR 2')
         CALL DPWRST('XXX','BUG ')
      END IF
C
      RETURN
      END 
      SUBROUTINE EV1CHA(X,MINMAX,HAZ)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE CUMULATIVE HAZARD
C              FUNCTION VALUE FOR THE EXTREME VALUE TYPE 1
C              DISTRIBUTION.
C              THE EXTREME VALUE TYPE 1 DISTRIBUTION USED
C              HEREIN HAS MEAN = EULER'S NUMBER = 0.57721566
C              AND STANDARD DEVIATION = PI/SQRT(6) = 1.28254983.
C              THIS DISTRIBUTION IS DEFINED FOR ALL X
C              AND HAS THE PROBABILITY DENSITY FUNCTION
C              FOR THE MAXIMUM ORDER STATISTIC
C              F(X) = (EXP(-X)) * (EXP(-(EXP(-X))))
C              WHICH SIMPLIFIES TO:
C              F(X) = EXP(-X - EXP(-X))
C              FOR THE MINIMUIM ORDER STATISTIC
C              F(X) = (EXP(X)) * (EXP(-(EXP(X))))
C              WHICH SIMPLIFIES TO:
C              F(X) = EXP(-X - EXP(-X))
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE 
C                                AT WHICH THE CUMULATIVE DISTRIBUTION 
C                                FUNCTION IS TO BE EVALUATED.
C     OUTPUT ARGUMENTS--HAZ    = THE SINGLE PRECISION CUMULATIVE HAZARD
C                                FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION CUMULATIVE HAZARD
C             FUNCTION VALUE FOR THE EXTREME VALUE TYPE 1
C             DISTRIBUTION WITH MEAN = EULER'S NUMBER = 0.57721566
C             AND STANDARD DEVIATION = PI/SQRT(6) = 1.28254983.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS. 
C     RESTRICTIONS--NONE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--EXP.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN. 
C     REFERENCES--JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--1, 1970, PAGES 272-295.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING LABORATORY (205.03)
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE:  301-975-2899
C     ORIGINAL VERSION--APRIL     1998. 
C     UPDATED         --JUNE      1999. SIMPLIFY FORMULAS
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
CCCCC DOUBLE PRECISION CDF
      DOUBLE PRECISION DX
      DOUBLE PRECISION DTERM1
      DOUBLE PRECISION DTERM2
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C---------------------------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS.
C     NO INPUT ARGUMENT ERRORS POSSIBLE 
C     FOR THIS DISTRIBUTION.
C
C-----START POINT-----------------------------------------------------
C
      IF(MINMAX.EQ.1)THEN
        HAZ=EXP(X)
CCCCC   CALL EV1CDD(DBLE(X),MINMAX,CDF)
CCCCC   IF(1.0D0-CDF.LE.0.0D0)THEN
CCCCC     WRITE(ICOUT,1100)
C1100     FORMAT('*****ERROR IN EV1CHA--CDF ESSENTIALLY 1.')
CCCCC     CALL DPWRST('XXX','BUG ')
CCCCC   ELSE
CCCCC     HAZ=REAL(-DLOG(1.0D0-CDF))
CCCCC   ENDIF
      ELSEIF(MINMAX.EQ.2 .OR. MINMAX.EQ.0)THEN
        DX=DBLE(X)
        DTERM1=DEXP(-DEXP(-DX))
        DTERM2=1.0D0-DTERM1
        IF(DTERM2.GT.0.0D0)THEN
          HAZ=REAL(-DLOG(DTERM2))
        ELSE
          WRITE(ICOUT,1100)
          CALL DPWRST('XXX','BUG ')
          HAZ=0.0
        ENDIF
 1100   FORMAT('*****ERROR IN EV1CHA--UNABLE TO COMPUTE CUMULATIVE',
     1         'HAZARD FUNCTION.')
CCCCC   CALL EV1CDD(DBLE(X),MINMAX,CDF)
CCCCC   IF(1.0D0-CDF.LE.0.0D0)THEN
CCCCC     WRITE(ICOUT,1100)
CCCCC     CALL DPWRST('XXX','BUG ')
CCCCC   ELSE
CCCCC     HAZ=REAL(-DLOG(1.0D0-CDF))
CCCCC   ENDIF
      ELSE
        HAZ=0.0
        WRITE(ICOUT,1800)
 1800   FORMAT('*****ERROR IN EV1CHA--MINMAX NOT 1 OR 2')
        CALL DPWRST('XXX','BUG ')
      END IF
C
      RETURN
      END 
      SUBROUTINE EV1EST(X,NOBS,ALOC,SCALE,ALOC2,SCALE2,MINMAX,IERROR)
C
C  COMPUTE MLES FOR SCALE PARAMETER (SCALE) AND LOCATION
C  PARAMETER (ALOC) BY SOLVING THE EQUATION
C     G(SCALE)=0, WHERE G IS
C  A MONOTONICALLY INCREASING FUNCTION OF SCALE.
C  THE INITIAL ESTIMATE IS THE METHOD OF MOMENTS ESTIMATOR
C  AND THE TOLERANCE IS   :   2*RI/(10**6).
C
      DIMENSION X(*)
C
      REAL GFM, GFM2
      REAL SCALEL, SCALEH, SCALEM
      REAL TOL
C
      CHARACTER*4 IBUGA3
      CHARACTER*4 IWRITE
      CHARACTER*4 IERROR
C
      IERROR='NO'
      RN=REAL(NOBS)
      SCALEL=0.0
      SCALEH=0.0
C
C  USE METHOD OF MOMENTS TO GET INITAL ESTIMATES OF LOCATION AND SCALE
C
      IBUGA3='OFF'
      IWRITE='OFF'
      CALL MEAN(X,NOBS,IWRITE,XMEAN,IBUGA3,IERROR)
      CALL SD(X,NOBS,IWRITE,XSD,IBUGA3,IERROR)
      SCALEM=SQRT(1.645)*XSD
      IF(MINMAX.EQ.2 .OR. MINMAX.EQ.0)THEN
        ALOCM=XMEAN-0.5772*XSD
      ELSE
        ALOCM=XMEAN+0.5772*XSD
      ENDIF
      ALOC2=ALOCM
      SCALE2=SCALEM
C
      TOL=2.0*.000001*SCALEM
      CALL EV1FUN(X,NOBS,XMEAN,ALOCM,SCALEM,GFM,MINMAX)
C
C  IF G(SCALEM) .GE. 0, DIVIDE THE INITIAL ESTIMATE BY 2 UNTIL
C  THE ROOT IS BRACKETED BY SCALEL AND SCALEH.
C
      IF(GFM.GE.0.0D0)THEN
           SCALEH=SCALEM/2.0
           CALL EV1FUN(X,NOBS,XMEAN,ALOCM,SCALEM,GFM2,MINMAX)
           DCONST=2.0
           IF(GFM2.GT.GFM)DCONST=0.5
           DO 3 J=1,200
                SCALEH=SCALEM
                SCALEM=SCALEM/DCONST
                CALL EV1FUN(X,NOBS,XMEAN,ALOCM,SCALEM,GFM,MINMAX)
                IF(GFM.LE.0.0)GO TO 4
    3      CONTINUE
           IERROR='YES'
           GOTO9999
    4      CONTINUE
           SCALEL=SCALEM
C
C  IF G(SCALEM) .LT. 0, MULTIPLY THE INITIAL ESTIMATE BY 2 UNTIL
C  THE ROOT IS BRACKETED BY SCALEL AND SCALEH.
      ELSEIF(GFM.LT.0.0)THEN
           SCALEH=SCALEM/2.0
           CALL EV1FUN(X,NOBS,XMEAN,ALOCM,SCALEM,GFM2,MINMAX)
           DCONST=2.0
           IF(GFM2.LT.GFM)DCONST=0.5
           DO 7 J=1,2000
                SCALEL=SCALEM
                SCALEM=SCALEM*DCONST
                CALL EV1FUN(X,NOBS,XMEAN,ALOCM,SCALEM,GFM,MINMAX)
                IF(GFM.GE.0.0D0)GO TO 8
    7      CONTINUE
           IERROR='YES'
           GOTO9999
    8      CONTINUE
           SCALEH=SCALEM
      ENDIF
C
C SOLVE THE EQUATION G(SCALE)=0 FOR SCALE BY BISECTING THE
C   INTERVAL (SCALEL,SCALEH) UNTIL THE TOLERANCE IS MET
      MAXIT=20000
      NIT=0
   10 CONTINUE
      SCALEM=(SCALEL+SCALEH)/2.0
      CALL EV1FUN(X,NOBS,XMEAN,ALOCM,SCALEM,GFM,MINMAX)
      IF(GFM.GE.0.0)THEN
           SCALEH=SCALEM
      ENDIF
      IF(GFM.LT.0.0)THEN
           SCALEL=SCALEM
      ENDIF
      NIT=NIT+1
C
      IF(NIT.GT.MAXIT)THEN
        IERROR='YES'
        SCALE=(SCALEL+SCALEH)/2.0
        ALOC=ALOCM
        GOTO9999
      ENDIF
C
      IF(SCALEH-SCALEL.GT.TOL)GO TO 10
C
      SCALE=(SCALEL+SCALEH)/2.0
      ALOC=ALOCM
C
 9999 CONTINUE
      RETURN
      END
      SUBROUTINE EV1FUN(X,N,XMEAN,ALOC,SCALE,EV1VAL,MINMAX)
C
C   COMPUTE G FUNCTION USED IN ESTIMATING THE SHAPE AND SCALE
C   PARAMETERS FOR EV1 DISTRIBUTION.
C
      DOUBLE PRECISION DN, DSUM1, DSUM2, DTERM1, DX, DSCALE
      DIMENSION X(*)
C
C  CALCULATE SOME INTERMEDIATE VALUES
C
      IF(MINMAX.EQ.2 .OR. MINMAX.EQ.0)THEN
        DN=DBLE(N)
        DSCALE=DBLE(SCALE)
        DSUM1=0.0
        DSUM2=0.0
        DO100I=1,N
          DX=DBLE(X(I))
          DSUM1=DSUM1 + DEXP(-DX/DSCALE)
          DSUM2=DSUM2 + DX*DEXP(-DX/DSCALE)
  100   CONTINUE
C
        ALOC=-SCALE*DLOG(DSUM1/DN)
C
        DTERM1=DBLE(XMEAN) - DSUM2/DSUM1
        EV1VAL=SCALE - REAL(DTERM1)
C
      ELSE
        DN=DBLE(N)
        DSCALE=DBLE(SCALE)
        DSUM1=0.0
        DSUM2=0.0
        DO200I=1,N
          DX=DBLE(X(I))
          DSUM1=DSUM1 + DEXP(DX/DSCALE)
          DSUM2=DSUM2 + DX*DEXP(DX/DSCALE)
  200   CONTINUE
C
        ALOC=SCALE*DLOG(DSUM1/DN)
C
        DTERM1=-DBLE(XMEAN) + DSUM2/DSUM1
        EV1VAL=SCALE - REAL(DTERM1)
C
      ENDIF
      RETURN
      END
      DOUBLE PRECISION FUNCTION EV1FU2 (SHAT,X)
C
C     PURPOSE--THIS ROUTINE IS USED IN FINDING THE MAXIMUM LIKELIHOOD
C              ESTIMATE OF THE SCALE PARAMETER FOR THE GUMBEL
C              MODEL FOR FULL SAMPLE DATA (NO CENSORING).  THIS
C              FUNCTION FINDS THE ROOT OF THE EQUATION:
C
C              FOR THE MAXIMUM CASE:
C
C                 SHAT - XBAR + SUM[i=1 to N][X(I)*EXP(-X(I)/SHAT)]/
C                        SUM[i=1 to N][EXP(-X(I)/SHAT)] = 0
C
C              FOR THE MINIMUM CASE:
C
C                 SHAT + XBAR + SUM[i=1 to N][X(I)*EXP(X(I)/SHAT)]/
C                        SUM[i=1 to N][EXP(X(I)/SHAT)] = 0
C
C              WITH
C
C                 SHAT     = CURRENT ESTIMATE OF SCALE PARAMETER
C                 XBAR     = SAMPLE MEAN
C                 N        = SAMPLE SIZE
C                 MINMAX   = SPECIFY WHETHER MAXIMUM OR MINIMUM
C                            CASE IS BEING ESTIMATED
C
C              CALLED BY DFZER2 ROUTINE FOR FINDING THE ROOT OF A
C              FUNCTION.
C     EXAMPLE--GUMBEL MAXIMUM LIKELIHOOD Y
C     REFERENCE--KARL BURY, "STATISTICAL DISTRIBUTIONS IN
C                ENGINEERING", CAMBRIDGE UNIVERSITY PRESS,
C                1999, CHAPTER 15.
C              --JOHNSON, KOTZ, AND BALAKRISNAN, "CONTINUOUS
C                UNIVARIATE DISTRIBUTIONS--VOLUME 1", SECOND EDITION,
C                WILEY, 1994, CHAPTER xx.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBUG, MD 20899-8980
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2004/12
C     ORIGINAL VERSION--DECEMBER   2004.
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION SHAT
      DOUBLE PRECISION X(*)
C
      INTEGER N 
      DOUBLE PRECISION XBAR
      COMMON/EV1CO2/XBAR,MINMAX,N
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DSUM1
      DOUBLE PRECISION DSUM2
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C  COMPUTE SOME SUMS
C
      DSUM1=0.0D0
      DSUM2=0.0D0
C
      IF(MINMAX.EQ.2)THEN
        DO100I=1,N
          DSUM1=DSUM1 + X(I)*DEXP(-X(I)/SHAT)
          DSUM2=DSUM2 + DEXP(-X(I)/SHAT)
  100   CONTINUE
        EV1FU2=SHAT - XBAR + DSUM1/DSUM2
      ELSE
        DO200I=1,N
          DSUM1=DSUM1 + X(I)*DEXP(X(I)/SHAT)
          DSUM2=DSUM2 + DEXP(X(I)/SHAT)
  200   CONTINUE
        EV1FU2=SHAT + XBAR - DSUM1/DSUM2
      ENDIF
C
C
      RETURN
      END
      DOUBLE PRECISION FUNCTION EV1FU3 (SHAT,X)
C
C     PURPOSE--THIS ROUTINE IS USED IN FINDING THE LIKELIHOOD RATIO
C              BASED CONFIDECE INTERVALS FOR THE LOCATION AND SCALE
C              PARAMETERS OF A GUMBEL DISTRIBUTION.
C              THIS FUNCTION FINDS THE ROOT OF THE EQUATION:
C
C                 2*LL(MU,SIGMA) - 2*LL(M(sigma),sigma)
C                                - CHSPPF(alpha,1)
C
C              WITH
C
C                 LL(MU,SIGMA) = -N*LOG(SIGMA) - N*XBAR/SIGMA +
C                                N*MU/SIGMA -
C                                SUM[i=1 to N][EXP(-(X(I)-MU)/SIGMA)]
C
C              GIVEN CURRENT VALUE OF SIGMA (= SHAT),
C
C                 MU(SIGMA) = -SIGMA*LOG(SUM[i=1 to N][EXP(-X(I)/SIGMA)]/N]
C
C              CALLED BY DFZER2 ROUTINE FOR FINDING THE ROOT OF A
C              FUNCTION.
C     EXAMPLE--GUMBEL MAXIMUM LIKELIHOOD Y
C     REFERENCE--KARL BURY, "STATISTICAL DISTRIBUTIONS IN
C                ENGINEERING", CAMBRIDGE UNIVERSITY PRESS,
C                1999, CHAPTER 15.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBUG, MD 20899-8980
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2004/12
C     ORIGINAL VERSION--DECEMBER   2004.
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION SHAT
      DOUBLE PRECISION X(*)
C
      INTEGER N 
      DOUBLE PRECISION XBAR
      COMMON/EV1CO2/XBAR,MINMAX,N
      DOUBLE PRECISION DK, DLLUS
      COMMON/EV1CO3/DK, DLLUS
C
      DOUBLE PRECISION DN
      DOUBLE PRECISION DMU
      DOUBLE PRECISION DTERM1
      DOUBLE PRECISION DSUM1
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C
C  GIVEN SIGMA, COMPUTE ESTIMATE OF MU
C
      DSUM1=0.0D0
      DN=DBLE(N)
C
      IF(MINMAX.EQ.2 .OR. MINMAX.EQ.0)THEN
        DO100I=1,N
          DSUM1=DSUM1 + DEXP(-X(I)/SHAT)
  100   CONTINUE
        DMU=-SHAT*DLOG(DSUM1/DN)
      ELSE
        DO200I=1,N
          DSUM1=DSUM1 + DEXP(X(I)/SHAT)
  200   CONTINUE
        DMU=SHAT*DLOG(DSUM1/DN)
      ENDIF
C
C  COMPUTE SOME SUMS
C
      DSUM1=0.0D0
C
      IF(MINMAX.EQ.2 .OR. MINMAX.EQ.0)THEN
        DO300I=1,N
          DSUM1=DSUM1 + DEXP(-(X(I) - DMU)/SHAT)
  300   CONTINUE
        DTERM1=-DN*DLOG(SHAT) - DN*XBAR/SHAT + DN*DMU/SHAT - DSUM1
      ELSE
        DO400I=1,N
          DSUM1=DSUM1 + DEXP((X(I) + DMU)/SHAT)
  400   CONTINUE
        DTERM1=-DN*DLOG(SHAT) - DN*XBAR/SHAT + DN*DMU/SHAT - DSUM1
      ENDIF
C
      EV1FU3=2.0D0*DLLUS - 2.0D0*DTERM1 - DK
C
      RETURN
      END
      DOUBLE PRECISION FUNCTION EV1FU4 (DMU,X)
C
C     PURPOSE--THIS ROUTINE IS USED IN FINDING THE LIKELIHOOD RATIO
C              BASED CONFIDECE INTERVALS FOR THE LOCATION AND SCALE
C              PARAMETERS OF A GUMBEL DISTRIBUTION.
C              THIS FUNCTION FINDS THE ROOT OF THE EQUATION:
C
C                 2*LL(MU,SIGMA) - 2*LL(mu,sigma(mu))
C                                - CHSPPF(alpha,1)
C
C              WITH
C
C                 LL(MU,SIGMA) = -N*LOG(SIGMA) - N*XBAR/SIGMA +
C                                N*MU/SIGMA -
C                                SUM[i=1 to N][EXP(-(X(I)-MU)/SIGMA)]
C
C              GIVEN CURRENT VALUE OF MU (= DMU), SIGMA IS ROOT OF:
C
C                 SIGMA + MU +
C                 SUM[i=1 to n][X(I)*EXP(-(X(I)-MU)/SIGMA]/N - 
C                 MU*SUM[i=1 to n][EXP(-(X(I)-MU)/SIGMA]/N -  XBAR
C
C              CALLED BY DFZER2 ROUTINE FOR FINDING THE ROOT OF A
C              FUNCTION.
C     EXAMPLE--GUMBEL MAXIMUM LIKELIHOOD Y
C     REFERENCE--KARL BURY, "STATISTICAL DISTRIBUTIONS IN
C                ENGINEERING", CAMBRIDGE UNIVERSITY PRESS,
C                1999, CHAPTER 15.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBUG, MD 20899-8980
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2004/12
C     ORIGINAL VERSION--DECEMBER   2004.
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DMU
      DOUBLE PRECISION X(*)
C
      INTEGER N 
      DOUBLE PRECISION XBAR
      COMMON/EV1CO2/XBAR,MINMAX,N
      DOUBLE PRECISION DLLUS
      DOUBLE PRECISION DK
      COMMON/EV1CO3/DK, DLLUS
      DOUBLE PRECISION SHAT
      COMMON/EV1CO4/SHAT
      DOUBLE PRECISION DMU2
      COMMON/EV1CO5/DMU2
      DOUBLE PRECISION EV1FU5
      EXTERNAL EV1FU5
C
      DOUBLE PRECISION DN
      DOUBLE PRECISION DTERM1
      DOUBLE PRECISION DSUM1
      DOUBLE PRECISION AE
      DOUBLE PRECISION RE
      DOUBLE PRECISION XLOW
      DOUBLE PRECISION XUP
      DOUBLE PRECISION XSTRT
      DOUBLE PRECISION SHAT2
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C  STEP 1: GIVEN VALUE OF LOCATION PARAMETER (MU), NEED TO COMPUTE
C          THE SCALE PARAMETER (WHICH IN TURN INVOLVES FINDING A
C          ROOT).
C
      DMU2=DMU
C
      AE=1.D-7
      RE=1.D-7
      XSTRT=SHAT
      XLOW=XSTRT/2.0D0
      XUP=XSTRT*2.0D0
      CALL DFZER3(EV1FU5,XLOW,XUP,XSTRT,RE,AE,IFLAG,X)
      SHAT2=XLOW
C
      DSUM1=0.0D0
      DN=DBLE(N)
C
C  COMPUTE SOME SUMS
C
      DSUM1=0.0D0
C
      IF(MINMAX.EQ.2 .OR. MINMAX.EQ.2)THEN
        DO300I=1,N
          DSUM1=DSUM1 + DEXP(-(X(I) - DMU)/SHAT2)
  300   CONTINUE
        DTERM1=-DN*DLOG(SHAT2) - DN*XBAR/SHAT2 + DN*DMU/SHAT2 - DSUM1
      ELSE
        DO400I=1,N
          DSUM1=DSUM1 + DEXP((X(I) + DMU)/SHAT2)
  400   CONTINUE
        DTERM1=-DN*DLOG(SHAT2) - DN*XBAR/SHAT2 + DN*DMU/SHAT2 - DSUM1
      ENDIF
C
      EV1FU4=2.0D0*DLLUS - 2.0D0*DTERM1 - DK
C
      RETURN
      END
      DOUBLE PRECISION FUNCTION EV1FU5 (SHAT,X)
C
C     PURPOSE--THIS ROUTINE IS USED IN FINDING THE LIKELIHOOD RATIO
C              BASED CONFIDECE INTERVALS FOR THE LOCATION AND SCALE
C              PARAMETERS OF A GUMBEL DISTRIBUTION.
C              THIS CONFIDENCE INTERVAL IS THE ROOT OF THE EQUATION
C
C                 2*LL(MU,SIGMA) - 2*LL(mu,sigma(mu))
C                                - CHSPPF(alpha,1)
C
C              WITH
C
C                 LL(MU,SIGMA) = -N*LOG(SIGMA) - N*XBAR/SIGMA +
C                                N*MU/SIGMA -
C                                SUM[i=1 to N][EXP(-(X(I)-MU)/SIGMA)]
C
C              GIVEN CURRENT VALUE OF MU (= DMU), SIGMA IS ROOT OF:
C
C                 SIGMA + MU +
C                 SUM[i=1 to n][X(I)*EXP(-(X(I)-MU)/SIGMA]/N - 
C                 MU*SUM[i=1 to n][EXP(-(X(I)-MU)/SIGMA]/N -  XBAR
C
C              EV1FU5 IS USED IN SOLVING FOR THE VALUE OF SIGMA
C              GIVEN MU.
C
C              CALLED BY DFZER3 ROUTINE FOR FINDING THE ROOT OF A
C              FUNCTION.
C     EXAMPLE--GUMBEL MAXIMUM LIKELIHOOD Y
C     REFERENCE--KARL BURY, "STATISTICAL DISTRIBUTIONS IN
C                ENGINEERING", CAMBRIDGE UNIVERSITY PRESS,
C                1999, CHAPTER 15.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBUG, MD 20899-8980
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2004/12
C     ORIGINAL VERSION--DECEMBER   2004.
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION SHAT
      DOUBLE PRECISION X(*)
C
      INTEGER N 
      DOUBLE PRECISION XBAR
      COMMON/EV1CO2/XBAR,MINMAX,N
      DOUBLE PRECISION DMU
      COMMON/EV1CO5/DMU
C
      DOUBLE PRECISION DN
      DOUBLE PRECISION DSUM1
      DOUBLE PRECISION DSUM2
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C
C  GIVEN MU, FIND ROOT FOR SIGMA
C
      DSUM1=0.0D0
      DSUM2=0.0D0
      DN=DBLE(N)
C
      IF(MINMAX.EQ.2 .OR. MINMAX.EQ.0)THEN
        DO100I=1,N
          DSUM1=DSUM1 + X(I)*DEXP(-(X(I)-DMU)/SHAT)
          DSUM2=DSUM2 + DEXP(-(X(I)-DMU)/SHAT)
  100   CONTINUE
        EV1FU5=SHAT + DMU + DSUM1/DN - DMU*DSUM2/DN - XBAR
      ELSE
        DO200I=1,N
          DSUM1=DSUM1 + X(I)*DEXP((X(I)+DMU)/SHAT)
          DSUM2=DSUM2 + DEXP((X(I)+DMU)/SHAT)
  200   CONTINUE
        EV1FU5=SHAT + DMU + DSUM1/DN - DMU*DSUM2/DN - XBAR
      ENDIF
C
C  COMPUTE SOME SUMS
C
C
C
      RETURN
      END
      DOUBLE PRECISION FUNCTION EV1FU6 (DPPF,X)
C
C     PURPOSE--THIS ROUTINE IS USED IN FINDING THE LIKELIHOOD RATIO
C              BASED CONFIDECE INTERVALS FOR THE LOCATION AND SCALE
C              PARAMETERS OF A GUMBEL DISTRIBUTION.
C              THIS FUNCTION FINDS THE ROOT OF THE EQUATION:
C
C                 2*LL(MU,SIGMA) - 2*LL(mu(Q),S1(Q)
C                                - CHSPPF(alpha,1)
C
C              WITH
C
C                 LL(MU,SIGMA) = -N*LOG(SIGMA) - N*XBAR/SIGMA +
C                                N*MU/SIGMA -
C                                SUM[i=1 to N][EXP(-(X(I)-MU)/SIGMA)]
C
C              GIVEN A VALUE OF Q, EV1FU6 IS CALLED TO DETERMINE A
C              VALUE OF SIGMA.  THEN THE FOLLOWING IS USED TO
C              FIND THE VALUE OF M.
C
C                 MU = Q + LN(LN(1/q))*SHAT
C
C              CALLED BY DFZER2 ROUTINE FOR FINDING THE ROOT OF A
C              FUNCTION.
C     EXAMPLE--GUMBEL MAXIMUM LIKELIHOOD Y
C     REFERENCE--KARL BURY, "STATISTICAL DISTRIBUTIONS IN
C                ENGINEERING", CAMBRIDGE UNIVERSITY PRESS,
C                1999, CHAPTER 15.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBUG, MD 20899-8980
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2004/12
C     ORIGINAL VERSION--DECEMBER   2004.
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DPPF
      DOUBLE PRECISION X(*)
C
      DOUBLE PRECISION EV1FU7
      EXTERNAL EV1FU7
C
      INTEGER N 
      DOUBLE PRECISION XBAR
      COMMON/EV1CO2/XBAR,MINMAX,N
      DOUBLE PRECISION DLLUS
      DOUBLE PRECISION DK
      COMMON/EV1CO3/DK, DLLUS
      DOUBLE PRECISION DQ
      DOUBLE PRECISION SHATML
      COMMON/EV1CO6/DQ,SHATML
      DOUBLE PRECISION DQ2
      DOUBLE PRECISION DPPF2
      COMMON/EV1CO7/DQ2,DPPF2
C
      DOUBLE PRECISION DN
      DOUBLE PRECISION DMU
      DOUBLE PRECISION SHAT2
      DOUBLE PRECISION DSUM1
      DOUBLE PRECISION DTERM1
      DOUBLE PRECISION AE
      DOUBLE PRECISION RE
      DOUBLE PRECISION XLOW
      DOUBLE PRECISION XUP
      DOUBLE PRECISION XSTRT
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C  STEP 1: GIVEN VALUE OF Q, NEED TO COMPUTE
C          THE SCALE PARAMETER (WHICH IN TURN INVOLVES FINDING A
C          ROOT).
C
      DQ2=DQ
      DPPF2=DPPF
C
      AE=1.D-7
      RE=1.D-7
      XSTRT=SHATML
      XLOW=XSTRT/5.0D0
      XUP=XSTRT*5.0D0
      CALL DFZER3(EV1FU7,XLOW,XUP,XSTRT,RE,AE,IFLAG,X)
      SHAT2=XLOW
C
C  STEP 2: NOW COMPUTE VALUE OF MU
C
      DMU=DPPF + DLOG(DLOG(1.0D0/DQ))*SHAT2
C
C  COMPUTE SOME SUMS
C
      DN=DBLE(N)
      DSUM1=0.0D0
C
      IF(MINMAX.EQ.2 .OR. MINMAX.EQ.0)THEN
        DO300I=1,N
          DSUM1=DSUM1 + DEXP(-(X(I) - DMU)/SHAT2)
  300   CONTINUE
        DTERM1=-DN*DLOG(SHAT2) - DN*XBAR/SHAT2 + DN*DMU/SHAT2 - DSUM1
      ELSE
        DO400I=1,N
          DSUM1=DSUM1 + DEXP((X(I) + DMU)/SHAT2)
  400   CONTINUE
        DTERM1=-DN*DLOG(SHAT2) - DN*XBAR/SHAT2 + DN*DMU/SHAT2 - DSUM1
      ENDIF
C
      EV1FU6=2.0D0*DLLUS - 2.0D0*DTERM1 - DK
C
      RETURN
      END
      DOUBLE PRECISION FUNCTION EV1FU7 (SHAT,X)
C
C     PURPOSE--THIS ROUTINE IS USED IN FINDING THE LIKELIHOOD RATIO
C              BASED CONFIDECE INTERVALS FOR A PERCENTILE OF THE
C              GUMBEL DISTRIBUTION.  THIS FUNCTION FINDS THE ROOT
C              OF THE EQUATION:
C
C              (N/SIGMA)*{(XBAR - Q)/SIGMA + (LOG(q)/N)*
C              SUM[i=1 to N][EXP(-(X(I)-Q)/SIGMA)*(X(I)-Q)/SIGMA)] - 1
C
C              WITH
C
C                 q       = DESIRED PERCENTILE (E.G., 0.95) (DQ IN CODE)
C                 Q       = POINT ESTIMATE OF PERCENTILE (EV1PPF(q) =
C                           DPPF IN CODE)
C
C              EV1FU7 IS USED IN SOLVING FOR THE VALUE OF SIGMA
C              GIVEN q AND Q.
C
C              CALLED BY DFZER3 ROUTINE FOR FINDING THE ROOT OF A
C              FUNCTION.
C     EXAMPLE--GUMBEL MAXIMUM LIKELIHOOD Y
C     REFERENCE--KARL BURY, "STATISTICAL DISTRIBUTIONS IN
C                ENGINEERING", CAMBRIDGE UNIVERSITY PRESS,
C                1999, CHAPTER 15.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBUG, MD 20899-8980
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2004/12
C     ORIGINAL VERSION--DECEMBER   2004.
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION SHAT
      DOUBLE PRECISION X(*)
C
      INTEGER N 
      DOUBLE PRECISION XBAR
      COMMON/EV1CO2/XBAR,MINMAX,N
      DOUBLE PRECISION DQ
      DOUBLE PRECISION DPPF
      COMMON/EV1CO7/DQ,DPPF
C
      DOUBLE PRECISION DN
      DOUBLE PRECISION DSUM1
      DOUBLE PRECISION DTERM1
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C
C  GIVEN MU, FIND ROOT FOR SIGMA
C
      DSUM1=0.0D0
      DN=DBLE(N)
      DTERM1=(XBAR-DPPF)/SHAT
C
      IF(MINMAX.EQ.2 .OR. MINMAX.EQ.0)THEN
        DO100I=1,N
          DSUM1=DSUM1 + ((X(I)-DPPF)/SHAT)*DEXP(-(X(I)-DPPF)/SHAT)
  100   CONTINUE
      ELSE
        DO200I=1,N
          DSUM1=DSUM1 + ((X(I)-DPPF)/SHAT)*DEXP((X(I)-DPPF)/SHAT)
  200   CONTINUE
      ENDIF
C
      EV1FU7=(DN/SHAT)*(DTERM1 + (DLOG(DQ)/DN)*DSUM1 - 1.0D0)
C
      RETURN
      END
      SUBROUTINE EV1HAZ(X,MINMAX,HAZ)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE HAZARD
C              FUNCTION VALUE FOR THE EXTREME VALUE TYPE 1
C              DISTRIBUTION.
C              THE EXTREME VALUE TYPE 1 DISTRIBUTION USED
C              HEREIN HAS MEAN = EULER'S NUMBER = 0.57721566
C              AND STANDARD DEVIATION = PI/SQRT(6) = 1.28254983.
C              THIS DISTRIBUTION IS DEFINED FOR ALL X
C              AND HAS THE PROBABILITY DENSITY FUNCTION
C              FOR THE MAXIMUM ORDER STATISTIC
C              F(X) = (EXP(-X)) * (EXP(-(EXP(-X))))
C              WHICH SIMPLIFIES TO:
C              F(X) = EXP(-X - EXP(-X))
C              FOR THE MINIMUIM ORDER STATISTIC
C              F(X) = (EXP(X)) * (EXP(-(EXP(X))))
C              WHICH SIMPLIFIES TO:
C              F(X) = EXP(-X - EXP(-X))
C              THE HAZARD FUNCTION IS:
C              EXP(-X)/(EXP(EXP(-X)-1))
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE 
C                                AT WHICH THE CUMULATIVE DISTRIBUTION 
C                                FUNCTION IS TO BE EVALUATED.
C     OUTPUT ARGUMENTS--HAZ    = THE SINGLE PRECISION HAZARD
C                                FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION HAZARD
C             FUNCTION VALUE FOR THE EXTREME VALUE TYPE 1
C             DISTRIBUTION WITH MEAN = EULER'S NUMBER = 0.57721566
C             AND STANDARD DEVIATION = PI/SQRT(6) = 1.28254983.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS. 
C     RESTRICTIONS--NONE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--EXP.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN. 
C     REFERENCES--JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--1, 1970, PAGES 272-295.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING LABORATORY (205.03)
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE:  301-975-2899
C     ORIGINAL VERSION--APRIL     1998. 
C     UPDATED         --JUNE      1999. USE SIMPLIFIED FORMULA FOR
C                                       MINIMUM CASE.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      DOUBLE PRECISION DX
CCCCC DOUBLE PRECISION DCDF
CCCCC DOUBLE PRECISION DPDF
      DOUBLE PRECISION DHAZ
      DOUBLE PRECISION DTERM1
      DOUBLE PRECISION DTERM2
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOMC.INC'
      INCLUDE 'DPCOP2.INC'
C
C---------------------------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS.
C     NO INPUT ARGUMENT ERRORS POSSIBLE 
C     FOR THIS DISTRIBUTION.
C
C-----START POINT-----------------------------------------------------
C
      IF(MINMAX.EQ.1)THEN
        IF(X.LE.REAL(I1MACH(15)))THEN
          HAZ=0.0
        ELSEIF(X.LE.REAL(I1MACH(16)))THEN
          HAZ=EXP(X)
        ELSE
          HAZ=0.0
          WRITE(ICOUT,1700)
          CALL DPWRST('XXX','BUG ')
        ENDIF
CCCCC   DX=DBLE(X)
CCCCC   CALL EV1CDD(DX,MINMAX,DCDF)
CCCCC   DCDF=1.0D0-DCDF
CCCCC   IF(DCDF.NE.0.0D0)THEN
CCCCC     DPDF=DEXP(DX-DEXP(DX))
CCCCC     DHAZ=DPDF/DCDF
CCCCC     HAZ=REAL(DHAZ)
CCCCC   ELSE
CCCCC     WRITE(ICOUT,1600)
C1600     FORMAT('*****ERROR IN EV1HAZ--CDF ESSENTIALLY 1.')
CCCCC     CALL DPWRST('XXX','BUG ')
CCCCC   ENDIF
      ELSEIF(MINMAX.EQ.2 .OR. MINMAX.EQ.0)THEN
        DX=DBLE(-X)
CCCCC   DTERM1=DEXP(DX)-1.0D0
CCCCC   DHAZ=DEXP(DX-DTERM1)
        DTERM1=DEXP(DX)
        DTERM2=DEXP(DEXP(DX))-1.0D0
        IF(DTERM2.NE.0.0D0)THEN
          DHAZ=DTERM1/DTERM2
          HAZ=REAL(DHAZ)
        ELSE
          HAZ=0.0
          WRITE(ICOUT,1700)
 1700     FORMAT('*****ERROR IN EV1HAZ--UNABLE TO COMPUTE THE ',
     1          'HAZARD FUNCTION.')
          CALL DPWRST('XXX','BUG ')
        ENDIF
      ELSE
         HAZ=0.0
         WRITE(ICOUT,1800)
 1800    FORMAT('*****ERROR IN EV1HAZ--MINMAX NOT 1 OR 2')
         CALL DPWRST('XXX','BUG ')
      END IF
C
      RETURN
      END 
      SUBROUTINE EV1LI1(Y,N,MINMAX,
     1                  ALOC,SCALE,
     1                  ALIK,AIC,AICC,BIC,
     1                  ISUBRO,IBUGA3,IERROR)
C
C     PURPOSE--THIS ROUTINE COMPUTES THE LIKELIHOOD FUNCTION FOR
C              THE GUMBEL (EXTREME VALUE TYPE 1) DISTRIBUTION.  THIS IS
C              FOR THE RAW DATA CASE (I.E., NO GROUPING AND NO CENSORING).
C
C              IT IS ASSUMED THAT BASIC ERROR CHECKING HAS ALREADY BEEN
C              PERFORMED.
C
C     REFERENCE--KARL BURY, "STATISTICAL DISTRIBUTIONS IN ENGINEERING",
C                CAMBRIDGE UNIVERSITY PRESS, 1999, P. 272.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2010/6
C     ORIGINAL VERSION--JUNE      2010.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 ISUBRO
      CHARACTER*4 IBUGA3
      CHARACTER*4 IERROR
C
      CHARACTER*4 IWRITE
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
      CHARACTER*4 ISTEPN
C
      DOUBLE PRECISION DX
      DOUBLE PRECISION DS
      DOUBLE PRECISION DU
      DOUBLE PRECISION DN
      DOUBLE PRECISION DNP
      DOUBLE PRECISION DLIK
      DOUBLE PRECISION DSUM1
      DOUBLE PRECISION DSUM2
      DOUBLE PRECISION DTERM1
      DOUBLE PRECISION DTERM3
C
C---------------------------------------------------------------------
C
      DIMENSION Y(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='EV1L'
      ISUBN2='I1  '
      IERROR='NO'
C
      ALIK=-99.0
      AIC=-99.0
      AICC=-99.0
      BIC=-99.0
C
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'1LI1')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,51)
   51   FORMAT('**** AT THE BEGINNING OF EV1LI1--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,52)IBUGA3,ISUBRO
   52   FORMAT('IBUGA3,ISUBRO = ',A4,2X,A4)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,55)N,ALOC,SCALE
   55   FORMAT('N,ALOC,SCALE = ',I8,2G15.7)
        CALL DPWRST('XXX','WRIT')
        DO56I=1,MIN(N,100)
          WRITE(ICOUT,57)I,Y(I)
   57     FORMAT('I,Y(I) = ',I8,G15.7)
          CALL DPWRST('XXX','WRIT')
   56   CONTINUE
      ENDIF
C
C               ******************************************
C               **  STEP 1--                            **
C               **  COMPUTE LIKELIHOOD FUNCTION         **
C               ******************************************
C
      ISTEPN='1'
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'1LI1')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      IERFLG=0
      IERROR='NO'
      IWRITE='OFF'
C
      DN=DBLE(N)
      DS=DBLE(SCALE)
      DU=DBLE(ALOC)
      DTERM1=DN*DLOG(DS)
      DSUM1=0.0D0
      DSUM2=0.0D0
      IF(MINMAX.EQ.2 .OR. MINMAX.EQ.0)THEN
        DO1000I=1,N
          DX=-(DBLE(Y(I)) - DU)/DS
          DTERM1=DEXP(DX - DEXP(DX))
          DSUM1=DSUM1 + DLOG(DTERM1/DS)
 1000   CONTINUE
      ELSE
        DO2000I=1,N
          DX=(DBLE(Y(I)) - DU)/DS
          DTERM1=DEXP(DX - DEXP(DX))
          DSUM1=DSUM1 + DLOG(DTERM1/DS)
 2000   CONTINUE
      ENDIF
      DLIK=DSUM1
C
      ALIK=REAL(DLIK)
      DNP=2.0D0
      AIC=REAL(-2.0D0*DLIK + 2.0D0*DNP)
      DTERM3=(2.0D0*DNP*(DNP+1.0D0))/(DN-DNP-1.0D0)
      AICC=REAL(-2.0D0*DLIK + 2.0D0*DNP + DTERM3)
      BIC=REAL(-2.0D0*DLIK + DNP*LOG(DN))
C
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'1LI1')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9011)
 9011   FORMAT('**** AT THE END OF EV1LI1--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9013)DSUM1,DSUM2,DTERM1,DTERM3
 9013   FORMAT('DSUM1,DSUM2,DTERM1,DTERM3 = ',3G15.7)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9014)ALIK,AIC,AICC,BIC
 9014   FORMAT('ALIK,AIC,AICC,BIC = ',4G15.7)
        CALL DPWRST('XXX','WRIT')
      ENDIF
C
      RETURN
      END
      SUBROUTINE EXPAND(XLAB,N1,XVAL,N2,IWRITE,Y,XLABC,TEMP1,
     1                  MAXOBV,ISUBRO,IBUGA3,IERROR)
C
C     PURPOSE--GIVEN A VECTOR OF LAB-ID'S AND A SET OF VALUES, XVAL,
C              CORRESPONDING TO UNIQUE VALUES OF THE LAB-ID'S, CREATE
C              A VECTOR OF THE SAME LENGTH AS LAB-ID WHERE THE
C              APPROPRIATE VALUE FROM XVAL IS INSERTED.
C
C              FOR EXAMPLE, SUPPOSE WE HAVE 100 LAB-ID'S WHERE THERE ARE
C              10 DISTINCT LAB-ID'S.  THEN XVAL SHOULD HAVE 10 VALUES.
C              THE FIRST VALUE IN XVAL WILL BE INSERTED INTO THE ROWS
C              WITH THE SMALLEST LAB-ID, THE SECOND VALUE IN XVAL WILL
C              BE INSERTED INTO THE ROWS WITH THE SECOND SMALLEST LAB-ID,
C              AND SO ON.
C
C     INPUT  ARGUMENTS--XLAB   = THE SINGLE PRECISION VECTOR CONTAINING
C                                THE LAB-ID'S.
C                     --XVAL   = THE SINGLE PRECISION VECTOR CONTAINING
C                                THE VALUES TO BE INSERTED INTO THE
C                                OUTPUT VECTOR.
C                     --N1     = THE INTEGER NUMBER OF OBSERVATIONS
C                                IN THE VECTOR XLAB.
C                     --N2     = THE INTEGER NUMBER OF OBSERVATIONS
C                                IN THE VECTOR XVAL.
C     OUTPUT ARGUMENTS--Y      = THE SINGLE PRECISION VECTOR INTO WHICH
C                                THE CODED VALUES WILL BE PLACED.
C     OUTPUT--THE SINGLE PRECISION VECTOR Y
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     OTHER DATAPAC   SUBROUTINES NEEDED--CODE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--NONE.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--NONE.
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2012/1
C     ORIGINAL VERSION--JANUARY   2012.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 IWRITE
      CHARACTER*4 ISUBRO
      CHARACTER*4 IBUGA3
      CHARACTER*4 IERROR
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
C
C---------------------------------------------------------------------
C
      DIMENSION XLAB(*)
      DIMENSION XVAL(*)
      DIMENSION Y(*)
      DIMENSION XLABC(*)
      DIMENSION TEMP1(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='EXPA'
      ISUBN2='ND  '
      IERROR='NO'
C
      IF(IBUGA3.EQ.'ON' .OR. ISUBRO.EQ.'PAND')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,51)
   51   FORMAT('***** AT THE BEGINNING OF EXPAND--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,52)IBUGA3,ISUBRO,N1,N2
   52   FORMAT('IBUGA3,ISUBRO,N1,N2 = ',2(A4,2X),2I8)
        CALL DPWRST('XXX','BUG ')
        DO55I=1,N1
          WRITE(ICOUT,56)I,XLAB(I)
   56     FORMAT('I,XLAB(I) = ',I8,G15.7)
          CALL DPWRST('XXX','BUG ')
   55   CONTINUE
        DO65I=1,N2
          WRITE(ICOUT,66)I,XVAL(I)
   66     FORMAT('I,XVAL(I) = ',I8,G15.7)
          CALL DPWRST('XXX','BUG ')
   65   CONTINUE
      ENDIF
C
      DO91I=1,N1
        XLABC(I)=0.0
   91 CONTINUE
C
C               ********************************************
C               **  STEP 1--                              **
C               **  CHECK THE INPUT ARGUMENTS FOR ERRORS  **
C               ********************************************
C
      IF(N1.LT.2)THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,111)
  111   FORMAT('***** ERROR IN EXPAND--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,113)
  113   FORMAT('      THE NUMBER OF OBSERVATIONS FOR THE LAB-IDs IS ',
     1         'LESS THAN 2.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,118)N1
  118   FORMAT('      THE NUMBER OF LAB-IDs IS ',I8)
        CALL DPWRST('XXX','BUG ')
        IERROR='YES'
        GOTO9000
      ELSEIF(N2.LT.1)THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,111)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,123)
  123   FORMAT('      THE NUMBER OF OBSERVATIONS FOR THE GROUP ',
     1         'VALUES IS LESS THAN 1.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,128)N2
  128   FORMAT('      THE NUMBER OF GROUP VALUES IS ',I8)
        CALL DPWRST('XXX','BUG ')
        IERROR='YES'
        GOTO9000
      ENDIF
C
C               **********************************************************
C               **  STEP 2--                                            **
C               **  PERFORM THE CODING--                                **
C               **  CALL CODE ROUTINE AND THEN LOOP THROUGH VALUES IN   **
C               **  THE XVAL VECTOR.                                    **
C               **  THEN APPLY THE RANKS TO ALL THE VALUES.             **
C               **********************************************************
C
      CALL CODE(XLAB,N1,IWRITE,XLABC,TEMP1,MAXOBV,IBUGA3,IERROR)
      IF(IERROR.EQ.'YES')GOTO9000
      CALL MAXIM(XLABC,N1,IWRITE,XMAX,IBUGA3,IERROR)
      IMAX=INT(XMAX+0.1)
      IF(IMAX.GT.N2)THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,111)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,201)
  201   FORMAT('      THE NUMBER OF UNIQUE VALUES FOR THE LAB-IDs IS ')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,203)
  203   FORMAT('      GREATER THAN THE NUMBER OF GROUP VALUES.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,205)IMAX
  205   FORMAT('      THE NUMBER OF UNIQUE LAB-IDs IS ',I8)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,208)N2
  208   FORMAT('      THE NUMBER OF GROUP VALUES IS ',I8)
        CALL DPWRST('XXX','BUG ')
        IERROR='YES'
        GOTO9000
      ENDIF
C
      DO310I=1,IMAX
        HOLD=XVAL(I)
        DO320J=1,N1
          IINDX=INT(XLABC(J)+0.1)
          IF(IINDX.EQ.I)Y(J)=HOLD
  320   CONTINUE
  310 CONTINUE
C
C               ******************************
C               **  STEP 3--                **
C               **  WRITE OUT A FEW LINES   **
C               **  OF SUMMARY INFORMATION  **
C               **  ABOUT THE CODING.       **
C               ******************************
C
      IF(IFEEDB.EQ.'ON' .AND. IWRITE.EQ.'ON')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,811)IMAX
  811   FORMAT('NUMBER OF DISTINCT CODE VALUES = ',I8)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,812)XVAL(1)
  812   FORMAT('THE MINIMUM LAB-ID HAS CODED VALUE ',G15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,813)XVAL(IMAX)
  813   FORMAT('THE MAXIMUM LAB-ID HAS CODED VALUE ',G15.7)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT.      **
C               *****************
C
 9000 CONTINUE
C
      IF(IBUGA3.EQ.'ON' .OR. ISUBRO.EQ.'PAND')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9011)
 9011   FORMAT('***** AT THE END OF EXPAND--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9012)IERROR,IMAX
 9012   FORMAT('IERROR,IMAX = ',A4,2X,I8)
        CALL DPWRST('XXX','BUG ')
        DO9015I=1,N1
          WRITE(ICOUT,9016)I,XLAB(I),XLABC(I),Y(I)
 9016     FORMAT('I,XLAB(I),XLABC(I),Y(I) = ',I8,3G15.7)
          CALL DPWRST('XXX','BUG ')
 9015   CONTINUE
      ENDIF
C
      RETURN
      END
      DOUBLE PRECISION FUNCTION exparg(l)
C--------------------------------------------------------------------
C     IF L = 0 THEN  EXPARG(L) = THE LARGEST POSITIVE W FOR WHICH
C     EXP(W) CAN BE COMPUTED.
C
C     IF L IS NONZERO THEN  EXPARG(L) = THE LARGEST NEGATIVE W FOR
C     WHICH THE COMPUTED VALUE OF EXP(W) IS NONZERO.
C
C     NOTE... ONLY AN APPROXIMATE VALUE FOR EXPARG(L) IS NEEDED.
C--------------------------------------------------------------------
C     .. Scalar Arguments ..
      INTEGER l
C     ..
C     .. Local Scalars ..
      DOUBLE PRECISION lnb
      INTEGER b,m
C     ..
C     .. External Functions ..
CCCCC INTEGER ipmpar
CCCCC EXTERNAL ipmpar
C     ..
C     .. Intrinsic Functions ..
      INTRINSIC dble,dlog
C
      INCLUDE 'DPCOMC.INC'
C
C     ..
C     .. Executable Statements ..
C
CCCCC b = ipmpar(4)
      b = I1MACH(10)
      IF (b.NE.2) GO TO 10
      lnb = .69314718055995D0
      GO TO 40

   10 IF (b.NE.8) GO TO 20
      lnb = 2.0794415416798D0
      GO TO 40

   20 IF (b.NE.16) GO TO 30
      lnb = 2.7725887222398D0
      GO TO 40

   30 lnb = dlog(dble(b))
C
   40 IF (l.EQ.0) GO TO 50
CCCCC m = ipmpar(9) - 1
      ival = i1mach(12)
      m = ival - 1
      exparg = 0.99999D0* (m*lnb)
      RETURN

CCC50 m = ipmpar(10)
   50 m = i1mach(13)
      exparg = 0.99999D0* (m*lnb)
      RETURN

      END
      SUBROUTINE EXPLI1(Y,N,ICASPL,
     1                  ALOC,SCALE,
     1                  ALIK,AIC,AICC,BIC,
     1                  ISUBRO,IBUGA3,IERROR)
C
C     PURPOSE--THIS ROUTINE COMPUTES THE LIKELIHOOD FUNCTION FOR
C              THE EXPONENTIAL DISTRIBUTION.  THIS IS FOR THE RAW DATA
C              CASE (I.E., NO GROUPING AND NO CENSORING).
C
C              NOTE THAT FOR THE 1-PARAMETER MODEL, JUST SET ALOC TO
C              ZERO BEFORE CALLING THIS ROUTINE.
C
C              IT IS ASSUMED THAT BASIC ERROR CHECKING HAS ALREADY BEEN
C              PERFORMED.
C
C     REFERENCE--KARL BURY, "STATISTICAL DISTRIBUTIONS IN ENGINEERING",
C                CAMBRIDGE UNIVERSITY PRESS, 1999, P. 187.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2010/6
C     ORIGINAL VERSION--JUNE      2010.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 ICASPL
      CHARACTER*4 ISUBRO
      CHARACTER*4 IBUGA3
      CHARACTER*4 IERROR
C
      CHARACTER*4 IWRITE
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
      CHARACTER*4 ISTEPN
C
      DOUBLE PRECISION DX
      DOUBLE PRECISION DS
      DOUBLE PRECISION DU
      DOUBLE PRECISION DN
      DOUBLE PRECISION DNP
      DOUBLE PRECISION DLIK
      DOUBLE PRECISION DSUM1
      DOUBLE PRECISION DTERM1
      DOUBLE PRECISION DTERM3
C
C---------------------------------------------------------------------
C
      DIMENSION Y(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='EXPL'
      ISUBN2='I1  '
      IERROR='NO'
C
      ALIK=-99.0
      AIC=-99.0
      AICC=-99.0
      BIC=-99.0
C
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'PLI1')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,51)
   51   FORMAT('**** AT THE BEGINNING OF EXPLI1--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,52)IBUGA3,ISUBRO
   52   FORMAT('IBUGA3,ISUBRO = ',A4,2X,A4)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,55)N,ALOC,SCALE
   55   FORMAT('N,ALOC,SCALE = ',I8,2G15.7)
        CALL DPWRST('XXX','WRIT')
        DO56I=1,MIN(N,100)
          WRITE(ICOUT,57)I,Y(I)
   57     FORMAT('I,Y(I) = ',I8,G15.7)
          CALL DPWRST('XXX','WRIT')
   56   CONTINUE
      ENDIF
C
C               ******************************************
C               **  STEP 1--                            **
C               **  COMPUTE LIKELIHOOD FUNCTION         **
C               ******************************************
C
      ISTEPN='1'
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'PLI1')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      IERFLG=0
      IERROR='NO'
      IWRITE='OFF'
      IF(ICASPL.EQ.'1EXP')ALOC=0.0
C
C     THE LOG-LIKELIHOOD FUNCTION IS
C
C     SUM[i=1 to N][-(X(i)-U)/S] - N*LOG(S)
C
      DN=DBLE(N)
      DS=DBLE(SCALE)
      DU=DBLE(ALOC)
      DTERM1=DN*DLOG(DS)
      DSUM1=0.0D0
      DO1000I=1,N
        DX=DBLE(Y(I))
        DSUM1=DSUM1 - (DX-DU)/DS
 1000 CONTINUE
      DLIK=DSUM1 - DTERM1
C
      ALIK=REAL(DLIK)
      DNP=2.0D0
      IF(ICASPL.EQ.'1EXP')DNP=1.0D0
      AIC=REAL(-2.0D0*DLIK + 2.0D0*DNP)
      DTERM3=(2.0D0*DNP*(DNP+1.0D0))/(DN-DNP-1.0D0)
      AICC=REAL(-2.0D0*DLIK + 2.0D0*DNP + DTERM3)
      BIC=REAL(-2.0D0*DLIK + DNP*LOG(DN))
C
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'PLI1')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9011)
 9011   FORMAT('**** AT THE END OF EXPLI1--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9013)DSUM1,DSUM2,DTERM1,DTERM3
 9013   FORMAT('DSUM1,DSUM2,DTERM1,DTERM3 = ',3G15.7)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9014)ALIK,AIC,AICC,BIC
 9014   FORMAT('ALIK,AIC,AICC,BIC = ',4G15.7)
        CALL DPWRST('XXX','WRIT')
      ENDIF
C
      RETURN
      END
      SUBROUTINE EXPLI2(Y,X,N,IR,ICASPL,
     1                  ALOC,SCALE,
     1                  ALIK,AIC,AICC,BIC,
     1                  ISUBRO,IBUGA3,IERROR)
C
C     PURPOSE--THIS ROUTINE COMPUTES THE LIKELIHOOD FUNCTION FOR
C              THE CENSORED EXPONENTIAL DISTRIBUTION.  THIS IS FOR THE
C              RAW DATA CASE (I.E., NO GROUPING).
C
C              NOTE THAT FOR THE 1-PARAMETER MODEL, JUST SET ALOC TO
C              ZERO BEFORE CALLING THIS ROUTINE.
C
C              IT IS ASSUMED THAT BASIC ERROR CHECKING HAS ALREADY BEEN
C              PERFORMED.
C
C     REFERENCE--KARL BURY, "STATISTICAL DISTRIBUTIONS IN ENGINEERING",
C                CAMBRIDGE UNIVERSITY PRESS, 1999, P. 187.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2010/6
C     ORIGINAL VERSION--JUNE      2010.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 ICASPL
      CHARACTER*4 ISUBRO
      CHARACTER*4 IBUGA3
      CHARACTER*4 IERROR
C
      CHARACTER*4 IWRITE
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
      CHARACTER*4 ISTEPN
C
      DOUBLE PRECISION DX
      DOUBLE PRECISION DS
      DOUBLE PRECISION DU
      DOUBLE PRECISION DN
      DOUBLE PRECISION DR
      DOUBLE PRECISION DNP
      DOUBLE PRECISION DLIK
      DOUBLE PRECISION DSUM1
      DOUBLE PRECISION DTERM1
      DOUBLE PRECISION DTERM3
C
C---------------------------------------------------------------------
C
      DIMENSION Y(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='EXPL'
      ISUBN2='I2  '
      IERROR='NO'
C
      ALIK=-99.0
      AIC=-99.0
      AICC=-99.0
      BIC=-99.0
C
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'PLI2')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,51)
   51   FORMAT('**** AT THE BEGINNING OF EXPLI2--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,52)IBUGA3,ISUBRO
   52   FORMAT('IBUGA3,ISUBRO = ',A4,2X,A4)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,55)N,ALOC,SCALE
   55   FORMAT('N,ALOC,SCALE = ',I8,2G15.7)
        CALL DPWRST('XXX','WRIT')
        DO56I=1,MIN(N,100)
          WRITE(ICOUT,57)I,Y(I),X(I)
   57     FORMAT('I,Y(I),X(I) = ',I8,2G15.7)
          CALL DPWRST('XXX','WRIT')
   56   CONTINUE
      ENDIF
C
C               ******************************************
C               **  STEP 1--                            **
C               **  COMPUTE LIKELIHOOD FUNCTION         **
C               ******************************************
C
      ISTEPN='1'
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'PLI2')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      IERFLG=0
      IERROR='NO'
      IWRITE='OFF'
      IF(ICASPL.EQ.'1EXP')ALOC=0.0
C
C     THE LOG-LIKELIHOOD FUNCTION IS
C
C     SUM[i=1 to N][-(X(i)-U)/S] - R*LOG(S)   X(i) > U
C
      DN=DBLE(N)
      DS=DBLE(SCALE)
      DU=DBLE(ALOC)
      DR=DBLE(IR)
      DTERM1=DN*DLOG(DR)
      DSUM1=0.0D0
      DO1000I=1,N
        IF(X(I).GT.0.5 .AND. Y(I).GT.ALOC)THEN
          DX=DBLE(Y(I))
          DSUM1=DSUM1 - (DX-DU)/DS
        ENDIF
 1000 CONTINUE
      DLIK=DSUM1 - DTERM1
C
      ALIK=REAL(DLIK)
      DNP=2.0D0
      IF(ICASPL.EQ.'1EXP')DNP=1.0D0
      AIC=REAL(-2.0D0*DLIK + 2.0D0*DNP)
      DTERM3=(2.0D0*DNP*(DNP+1.0D0))/(DN-DNP-1.0D0)
      AICC=REAL(-2.0D0*DLIK + 2.0D0*DNP + DTERM3)
      BIC=REAL(-2.0D0*DLIK + DNP*LOG(DN))
C
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'PLI2')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9011)
 9011   FORMAT('**** AT THE END OF EXPLI2--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9013)DSUM1,DSUM2,DTERM1,DTERM3
 9013   FORMAT('DSUM1,DSUM2,DTERM1,DTERM3 = ',3G15.7)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9014)ALIK,AIC,AICC,BIC
 9014   FORMAT('ALIK,AIC,AICC,BIC = ',4G15.7)
        CALL DPWRST('XXX','WRIT')
      ENDIF
C
      RETURN
      END
      SUBROUTINE EV1ML1(Y,N,MINMAX,IGUMBC,ICASE,
     1                  DTEMP,
     1                  ALOWLO,AUPPLO,ALOWSC,AUPPSC,
     1                  ALOWL2,AUPPL2,ALOWS2,AUPPS2,
     1                  ALPHA,NUMALP,NUMOUT,
     1                  XMEAN,XSD,XMIN,XMAX,
     1                  ALOCMO,ASCAMO,ALMOSE,ASMOSE,
     1                  ALOCML,ASCAML,ASC2ML,ALMLSE,ASMLSE,COVSE,
     1                  ISUBRO,IBUGA3,IERROR)
C
C     PURPOSE--THIS ROUTINE COMPUTES THE MAXIMUM LIKELIHOOD ESTIMATES
C              FOR THE EXTREME VALUE TYPE 1 (GUMBEL) DISTRIBUTION FOR
C              THE RAW DATA CASE (I.E., NO CENSORING AND NO GROUPING).
C              IT WILL OPTIONALLY RETURN THE CONFIDENCE INTERVALS FOR
C              THE LOCATION AND SCALE PARAMETERS.
C
C              IT IS ASSUMED THAT BASIC ERROR CHECKING HAS ALREADY BEEN
C              PERFORMED.
C
C              PUT THIS IN A SEPARATE ROUTINE AS IT MAY BE CALLED
C              FROM MULTIPLE PLACES (DPMGU1 WILL GENERATE THE OUTPUT
C              FOR THE EXTREME VALUE TYPE 1 MLE COMMAND).
C
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2009/10
C     ORIGINAL VERSION--OCTOBER   2009. EXTRACTED AS A SEPARATE
C                                       SUBROUTINE (FROM DPMGU1)
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      DIMENSION ALOWLO(*)
      DIMENSION AUPPLO(*)
      DIMENSION ALOWSC(*)
      DIMENSION AUPPSC(*)
      DIMENSION ALPHA(*)
      DIMENSION ALOWL2(*)
      DIMENSION AUPPL2(*)
      DIMENSION ALOWS2(*)
      DIMENSION AUPPS2(*)
C
      CHARACTER*4 IGUMBC
      CHARACTER*4 ISUBRO
      CHARACTER*4 IBUGA3
      CHARACTER*4 IERROR
C
      CHARACTER*4 IWRITE
      CHARACTER*40 IDIST
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
      CHARACTER*4 ISTEPN
C
      INTEGER IFLAG
      INTEGER ICASE
C
      DIMENSION Y(*)
      DOUBLE PRECISION DTEMP(*)
C
      DOUBLE PRECISION EV1FU2
      DOUBLE PRECISION EV1FU3
      DOUBLE PRECISION EV1FU4
      EXTERNAL EV1FU2
      EXTERNAL EV1FU3
      EXTERNAL EV1FU4
C
      INTEGER IN 
      DOUBLE PRECISION XBAR
      COMMON/EV1CO2/XBAR,MINMX2,IN
      DOUBLE PRECISION DK
      DOUBLE PRECISION DLLUS
      COMMON/EV1CO3/DK, DLLUS
      DOUBLE PRECISION SHAT
      COMMON/EV1CO4/SHAT
      DOUBLE PRECISION DQ
      DOUBLE PRECISION SHATML
      COMMON/EV1CO6/DQ,SHATML
C
      DOUBLE PRECISION DN
      DOUBLE PRECISION DTERM1
      DOUBLE PRECISION DAE
      DOUBLE PRECISION DRE
      DOUBLE PRECISION DSUM1
      DOUBLE PRECISION DXSTRT
      DOUBLE PRECISION DXLOW
      DOUBLE PRECISION DXUP
      DOUBLE PRECISION XLOWSV
      DOUBLE PRECISION XUPSV
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='EV1M'
      ISUBN2='L1  '
      IWRITE='OFF'
      IERROR='NO'
C
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'1ML1')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,51)
   51   FORMAT('**** AT THE BEGINNING OF EV1ML1--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,52)IBUGA3,ISUBRO,N,MAXNXT,MINMAX,ICASE
   52   FORMAT('IBUGA3,ISUBRO,N,MAXNXT,MINMAX,ICASE = ',2(A4,2X),4I8)
        CALL DPWRST('XXX','WRIT')
        DO56I=1,MIN(N,100)
          WRITE(ICOUT,57)I,Y(I)
   57     FORMAT('I,Y(I) = ',I8,G15.7)
          CALL DPWRST('XXX','WRIT')
   56   CONTINUE
      ENDIF
C
C               ********************************************
C               **  STEP 1--                              **
C               **  CARRY OUT CALCULATIONS                **
C               **  FOR EXTREME VALUE TYPE 1 MLE ESTIMATE **
C               ********************************************
C
      ISTEPN='1'
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'1ML1')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      IDIST='EXTREME VALUE TYPE 1'
      IFLAG=0
      CALL SUMRAW(Y,N,IDIST,IFLAG,
     1            XMEAN,XVAR,XSD,XMIN,XMAX,
     1            ISUBRO,IBUGA3,IERROR)
C
C     MOMENT ESTIMATES ARE:
C
C        MUHAT = XBAR - 0.45006*SD
C        SHAT  = 0.77970*SD
C
C     THE ML ESTIMATE OF THE SCALE PARAMETER IS THE SOLUTION TO
C     THE FOLLOWING EQUATION:
C
C         FOR THE MAXIMUM CASE:
C
C             SHAT - XBAR + SUM[i=1 to N][X(I)*EXP(-X(I)/SHAT)]/
C                    SUM[i=1 to N][EXP(-X(I)/SHAT)] = 0
C
C         FOR THE MINIMUM CASE:
C
C             SHAT - XBAR + SUM[i=1 to N][X(I)*EXP(X(I)/SHAT)]/
C                    SUM[i=1 to N][EXP(X(I)/SHAT)] = 0
C
C         WITH
C
C             SHAT     = CURRENT ESTIMATE OF SCALE PARAMETER
C             XBAR     = SAMPLE MEAN
C             N        = SAMPLE SIZE
C             MINMAX   = SPECIFY WHETHER MAXIMUM OR MINIMUM
C                        CASE IS BEING ESTIMATED
C
C     THE ML ESTIMATE OF LOCATION FOR THE MAXIMUM CASE IS
C
C         MUHAT = -SHAT*LOG(SUM[i=1 to N][EXP(-X(I)/SHAT)]/N)
C
C     THE ML ESTIMATE OF LOCATION FOR THE MINIMUM CASE IS
C
C         MUHAT = -SHAT*LOG(SUM[i=1 to N][EXP(X(I)/SHAT)]/N)
C
      AN=REAL(N)
      DN=DBLE(N)
      IF(MINMAX.EQ.0 .OR. MINMAX.EQ.2)THEN
        ALOCMO=XMEAN - 0.45006*XSD
      ELSE
        ALOCMO=XMEAN + 0.45006*XSD
      ENDIF
      ASCAMO=0.77970*XSD
      ALMOSE=SQRT(1.16781*ASCAMO**2/AN)
      ASMOSE=1.10001*XSD**2/AN
C
      XBAR=DBLE(XMEAN)
      MINMX2=MINMAX
      IN=N
C
      DXSTRT=DBLE(ASCAMO)
      DAE=2.0*0.000001D0*DXSTRT
      DRE=DAE
      IFLAG=0
      DXLOW=DXSTRT/2.0D0
      DXUP=2.0D0*DXSTRT
      ITBRAC=0
      DO3104I=1,N
        DTEMP(I)=DBLE(Y(I))
 3104 CONTINUE
C
 3105 CONTINUE
      XLOWSV=DXLOW
      XUPSV=DXUP
      CALL DFZER2(EV1FU2,DXLOW,DXUP,DXSTRT,DRE,DAE,IFLAG,DTEMP)
C
      IF(IFLAG.EQ.4 .AND. ITBRAC.LE.100)THEN
        DXLOW=XLOWSV/2.0D0
        DXUP=2.0D0*XUPSV
        ITBRAC=ITBRAC+1
        GOTO3105
      ENDIF
C
      IF(IFLAG.EQ.2)THEN
C
C  NOTE: SUPPRESS THIS MESSAGE FOR NOW.
CCCCC   WRITE(ICOUT,999)
CCCCC   CALL DPWRST('XXX','BUG ')
CCCCC   WRITE(ICOUT,111)
CC111   FORMAT('***** WARNING FROM GUMBEL MAXIMUM ',
CCCCC1         'LIKELIHOOD--')
CCCCC   CALL DPWRST('XXX','BUG ')
CCCCC   WRITE(ICOUT,113)
CC113   FORMAT('      ESTIMATE OF SIGMA MAY NOT BE COMPUTED TO ',
CCCCC1         'DESIRED TOLERANCE.')
CCCCC   CALL DPWRST('XXX','BUG ')
      ELSEIF(IFLAG.EQ.3)THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,121)
  121   FORMAT('***** WARNING FROM GUMBEL MAXIMUM LIKELIHOOD--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,123)
  123   FORMAT('      ESTIMATE OF SCALE MAY BE NEAR A SINGULAR POINT.')
        CALL DPWRST('XXX','BUG ')
      ELSEIF(IFLAG.EQ.4)THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,131)
  131   FORMAT('***** ERROR FROM GUMBEL MAXIMUM LIKELIHOOD--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,133)
  133   FORMAT('      APPROPRIATE BRACKETING INTERVAL NOT FOUND.')
        CALL DPWRST('XXX','BUG ')
      ELSEIF(IFLAG.EQ.5)THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,121)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,143)
  143   FORMAT('      MAXIMUM ITERATIONS EXCEEDED.')
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
      ASCAML=REAL(DXLOW)
      BN=(1.0 + 2.2/AN**1.13)
      ASC2ML=BN*ASCAML
C
      DSUM1=0.0D0
      IF(MINMAX.EQ.2 .OR. MINMAX.EQ.0)THEN
        DO3108I=1,N
          DX=-DBLE(Y(I))
          DSUM1=DSUM1 + DEXP(DX/DBLE(ASCAML))
 3108   CONTINUE
        DTERM1=-DBLE(ASCAML)*DLOG(DSUM1/DN)
      ELSE
        DO3109I=1,N
          DX=DBLE(Y(I))
          DSUM1=DSUM1 + DEXP(DX/DBLE(ASCAML))
 3109   CONTINUE
        DTERM1=DBLE(ASCAML)*DLOG(DSUM1/DN)
      ENDIF
      ALOCML=REAL(DTERM1)
C
      ASMLSE=0.77970*ASCAML/SQRT(AN)
      ALMLSE=1.05293*ASCAML/SQRT(AN)
      COVSE=0.50697*ASCAML/SQRT(AN)
      IF(IGUMBC.EQ.'ON')THEN
        ASMLSE=ASMLSE*BN
        COVSE=COVSE*SQRT(BN)
      ENDIF
C
      IF(ICASE.EQ.0)GOTO9000
C
      IF(IGUMBC.EQ.'ON')THEN
        SCTEMP=ASC2ML
      ELSE
        SCTEMP=ASCAML
      ENDIF
C
      DSUM1=0.0D0
      IF(MINMAX.EQ.2 .OR. MINMAX.EQ.0)THEN
        DO3110I=1,N
          DSUM1=DSUM1 + DEXP(-(Y(I) - DBLE(ALOCML))/DBLE(ASCAML))
 3110   CONTINUE
        DLLUS=-DN*DLOG(DBLE(ASCAML)) - DN*XBAR/DBLE(ASCAML) +
     1         DN*DBLE(ALOCML)/DBLE(ASCAML) - DSUM1
      ELSE
        DO3115I=1,N
          DSUM1=DSUM1 + DEXP((Y(I) + DBLE(ALOCML))/DBLE(ASCAML))
 3115   CONTINUE
        DLLUS=-DN*DLOG(DBLE(ASCAML)) - DN*XBAR/DBLE(ASCAML) +
     1         DN*DBLE(ALOCML)/DBLE(ASCAML) - DSUM1
      ENDIF
      SHAT=DBLE(SCTEMP)
C
      DAE=1.D-7
      DRE=1.D-7
      NUTEMP=1
C
      DO3120I=1,NUMALP
C
        ALP=ALPHA(I)
        P=1.0-(ALP/2.0)
        CALL NORPPF(P,APPF)
        ALOWSC(I)=SCTEMP - APPF*ASMLSE
        AUPPSC(I)=SCTEMP + APPF*ASMLSE
        ALOWLO(I)=ALOCML - APPF*ALMLSE
        AUPPLO(I)=ALOCML + APPF*ALMLSE
C
        CALL CHSPPF(1.0-ALP,NUTEMP,APPF)
        DK=DBLE(APPF)
C
        DXSTRT=DBLE(ALOWSC(I))
        DXLOW=DXSTRT/5.0D0
        DXUP=DBLE(SCTEMP)
        CALL DFZER2(EV1FU3,DXLOW,DXUP,DXSTRT,DRE,DAE,IFLAG,DTEMP)
        ALOWS2(I)=REAL(DXLOW)
C
        DXSTRT=DBLE(AUPPSC(I))
        DXUP=DXSTRT*5.0D0
        DXLOW=DBLE(SCTEMP)
        CALL DFZER2(EV1FU3,DXLOW,DXUP,DXSTRT,DRE,DAE,IFLAG,DTEMP)
        AUPPS2(I)=REAL(DXLOW)
C
        DXSTRT=DBLE(ALOWLO(I))
        DXLOW=DXSTRT/2.0D0
        DXUP=DBLE(ALOCML)
        CALL DFZER2(EV1FU4,DXLOW,DXUP,DXSTRT,DRE,DAE,IFLAG,DTEMP)
        ALOWL2(I)=REAL(DXLOW)
C
        DXSTRT=DBLE(AUPPLO(I))
        DXUP=DXSTRT*2.0D0
        DXLOW=DBLE(ALOCML)
        CALL DFZER2(EV1FU4,DXLOW,DXUP,DXSTRT,DRE,DAE,IFLAG,DTEMP)
        AUPPL2(I)=REAL(DXLOW)
C
 3120 CONTINUE
C
      NUMOUT=NUMALP
C
 9000 CONTINUE
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'1ML1')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9011)
 9011   FORMAT('**** AT THE END OF EV1ML1--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9055)N,XMEAN,XSD,XMIN,XMAX
 9055   FORMAT('N,XMEAN,XSD,XMIN,XMAX = ',I8,4G15.7)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9056)ALOCMO,ASCAMO,ALMOSE,ASMOSE
 9056   FORMAT('ALOCMO,ASCAMO,ALMOSE,ASMOSE = ',4G15.7)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9057)ALOCML,ASCAML,ALMLSE,ASMLSE
 9057   FORMAT('ALOCML,ASCAML,ALMLSE,ASMLSE = ',4G15.7)
        CALL DPWRST('XXX','WRIT')
        DO9060I=1,NUMALP
          WRITE(ICOUT,9065)I,ALPHA(I),ALOWLO(I),AUPPLO(I),ALOWSC(I),
     1                     AUPPSC(I)
 9065     FORMAT('I,ALPHA(I),ALOWLO(I),AUPPLO(I),ALOWSC(I),AUPPSC(I)=',
     1           I8,5G15.7)
          CALL DPWRST('XXX','WRIT')
          WRITE(ICOUT,9066)I,ALPHA(I),ALOWL2(I),AUPPL2(I),ALOWS2(I),
     1                     AUPPSC(I)
 9066     FORMAT('I,ALPHA(I),ALOWL2(I),AUPPL2(I),ALOWS2(I),AUPPS2(I)=',
     1           I8,5G15.7)
          CALL DPWRST('XXX','WRIT')
 9060   CONTINUE
      ENDIF
C
      RETURN
      END
      SUBROUTINE EV1PDF(X,MINMAX,PDF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE PROBABILITY DENSITY
C              FUNCTION VALUE FOR THE EXTREME VALUE TYPE 1
C              DISTRIBUTION.
C              THE EXTREME VALUE TYPE 1 DISTRIBUTION USED
C              HEREIN HAS MEAN = EULER'S NUMBER = 0.57721566
C              AND STANDARD DEVIATION = PI/SQRT(6) = 1.28254983.
C              THIS DISTRIBUTION IS DEFINED FOR ALL X
C              AND HAS THE PROBABILITY DENSITY FUNCTION
C              FOR THE MAXIMUM ORDER STATISTIC
C              F(X) = (EXP(-X)) * (EXP(-(EXP(-X))))
C              WHICH SIMPLIFIES TO:
C              F(X) = EXP(-X - EXP(-X))
C              FOR THE MINIMUIM ORDER STATISTIC
C              F(X) = (EXP(X)) * (EXP(-(EXP(X))))
C              WHICH SIMPLIFIES TO:
C              F(X) = EXP(-X - EXP(-X))
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE 
C                                AT WHICH THE CUMULATIVE DISTRIBUTION 
C                                FUNCTION IS TO BE EVALUATED.
C     OUTPUT ARGUMENTS--CDF    = THE SINGLE PRECISION CUMULATIVE
C                                DISTRIBUTION FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION PROBABILITY DENSITY
C             FUNCTION VALUE CDF FOR THE EXTREME VALUE TYPE 1
C             DISTRIBUTION WITH MEAN = EULER'S NUMBER = 0.57721566
C             AND STANDARD DEVIATION = PI/SQRT(6) = 1.28254983.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS. 
C     RESTRICTIONS--NONE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--EXP.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN. 
C     REFERENCES--JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--1, 1970, PAGES 272-295.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING LABORATORY (205.03)
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE:  301-921-2315
C     ORIGINAL VERSION--APRIL     1994. 
C     UPDATED         --JULY      2004. CODE IN DOUBLE PRECISION FOR
C                                       BETTER ACCURACY
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DX
      DOUBLE PRECISION DPDF
C
      INCLUDE 'DPCOP2.INC'
C
C---------------------------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS.
C     NO INPUT ARGUMENT ERRORS POSSIBLE 
C     FOR THIS DISTRIBUTION.
C
C-----START POINT-----------------------------------------------------
C
      DX=DBLE(X)
      DPDF=0.0D0
      IF(MINMAX.EQ.1)THEN
        DPDF=DEXP(DX-DEXP(DX)) 
      ELSEIF(MINMAX.EQ.2 .OR. MINMAX.EQ.0)THEN
        DPDF=DEXP(-DX-DEXP(-DX)) 
      ELSE
         WRITE(ICOUT,1800)
 1800    FORMAT('*****ERROR IN EV1PDF--MINMAX NOT 1 OR 2')
         CALL DPWRST('XXX','BUG ')
      END IF
      PDF=REAL(DPDF)
C
      RETURN
      END 
      SUBROUTINE EV1PPF(P,MINMAX,PPF)
CCCCC MINMAX ADDED TO ABOVE ARGUMENT LIST   MAY 1993
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE PERCENT POINT
C              FUNCTION VALUE FOR THE EXTREME VALUE TYPE 1
C              (= GUMBEL)
C              DISTRIBUTION.
C              THERE ARE 2 SUCH EV1 FAMILIES--
C                 ONE FOR THE MIN ORDER STAT AND
C                 ONE FOR THE MAX ORDER STAT (THE USUAL).
C              (SEE SARHAN & GREENBERG, PAGE 69)
C              THE EV1 TYPE IS SPECIFIED VIA   MINMAX
C              FOR MINMAX = 1  (FOR THE MINIMUM)
C                 THE WEIBULL DISTRIBUTION USED
C                 HEREIN IS DEFINED FOR ALL X,
C                 AND HAS THE PROBABILITY DENSITY FUNCTION
C                 F(X) = ...
C              FOR MINMAX = 2 (FOR THE DEFAULT MAXIMUM),
C                 THE EV1 DISTRIBUTION USED
C                 HEREIN IS DEFINED FOR ALL X,
C                 HAS MEAN = EULER'S NUMBER = 0.57721566
C                 HAS STANDARD DEVIATION = PI/SQRT(6) = 1.28254983.
C                 AND HAS THE PROBABILITY DENSITY FUNCTION
C                 F(X) = (EXP(-X)) * (EXP(-(EXP(-X))))
C              NOTE THAT THE PERCENT POINT FUNCTION OF A DISTRIBUTION
C              IS IDENTICALLY THE SAME AS THE INVERSE CUMULATIVE
C              DISTRIBUTION FUNCTION OF THE DISTRIBUTION.
C     INPUT  ARGUMENTS--P      = THE SINGLE PRECISION VALUE
C                                (BETWEEN 0.0 (EXCLUSIVELY)
C                                AND 1.0 (EXCLUSIVELY))
C                                AT WHICH THE PERCENT POINT
C                                FUNCTION IS TO BE EVALUATED.
C                     --MINMAX = THE INTEGER VALUE
C                                IDENTIFYING THE
C                                CHOSEN WEIBULL DISTRIBUTION.
C                                1 = MIN, 2 = MAX.
C     OUTPUT ARGUMENTS--PPF    = THE SINGLE PRECISION PERCENT
C                                POINT FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION PERCENT POINT FUNCTION .
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--P SHOULD BE BETWEEN 0.0 (EXCLUSIVELY)
C                   AND 1.0 (EXCLUSIVELY).
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--LOG.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--SARHAN & GREENBERG,
C                 CONTRIBUTIONS TO ORDER STATISTICS,
C                 1962, WILEY, PAGE 69.
C               --JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--1, 1970, PAGES 272-295.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1966)
C     VERSION NUMBER--82/7
C     ORIGINAL VERSION--NOVEMBER  1975.
C     UPDATED         --DECEMBER  1981.
C     UPDATED         --MAY       1982.
C     UPDATED         --MAY       1993. REWRITTEN--ADD EV1/MIN DIST.
C     UPDATED         --JANUARY   1994. ADD MINMAX ERROR MESSAGE
C     UPDATED         --JULY      2004. CODE IN DOUBLE PRECISION
C                                       FOR BETTER ACCURACY.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DP
      DOUBLE PRECISION DPPF
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(P.LE.0.0.OR.P.GE.1.0)THEN
        WRITE(ICOUT,1)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)P
        CALL DPWRST('XXX','BUG ')
        PPF=0.0
        GOTO9000
      ENDIF
    1 FORMAT('***** ERROR--THE FIRST  ARGUMENT TO EV1PPF ',
     1       'IS OUTSIDE THE ALLOWABLE (0,1) INTERVAL')
   46 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7,'.')
C
CCCCC THE FOLLOWING LINE WAS REWRITTEN   MAY 1993
CCCCC PPF=(-(LOG(-LOG(P))))
C
CCCCC THE FOLLOWING SECTION WAS REWRITTEN      JANUARY 1994
      DPPF=0.0D0
      DP=DBLE(P)
      IF(MINMAX.EQ.1)THEN
         DPPF=DLOG(DLOG(1.0D0/(1.0D0-DP)))
      ELSE IF(MINMAX.EQ.2 .OR. MINMAX.EQ.0)THEN
         DPPF=(-(DLOG(DLOG(1.0D0/DP))))
      ELSE
         WRITE(ICOUT,1800)
 1800    FORMAT('*****ERROR IN EV1PPF--MINMAX NOT 1 OR 2')
         CALL DPWRST('XXX','BUG ')
      ENDIF
      PPF=REAL(DPPF)
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE EV1RAN(N,MINMAX,ISEED,X)
CCCCC MINMAX WAS ADDED TO THE ABOVE ARGUMENT LIST   MAY 1993
C
C     PURPOSE--THIS SUBROUTINE GENERATES A RANDOM SAMPLE OF SIZE N
C              FROM THE EXTREME VALUE TYPE 1 DISTRIBUTION.
C              THE PROTOTYPE EXTREME VALUE TYPE 1 DISTRIBUTION USED
C              HEREIN HAS MEAN = EULER'S NUMBER = 0.57721566
C              AND STANDARD DEVIATION = PI/SQRT(6) = 1.28254983.
C              THIS DISTRIBUTION IS DEFINED FOR ALL X
C              AND HAS THE PROBABILITY DENSITY FUNCTION
C              F(X) = (EXP(-X)) * (EXP(-(EXP(-X))))
C     INPUT  ARGUMENTS--N      = THE DESIRED INTEGER NUMBER
C                                OF RANDOM NUMBERS TO BE
C                                GENERATED.
C     OUTPUT ARGUMENTS--X      = A SINGLE PRECISION VECTOR
C                                (OF DIMENSION AT LEAST N)
C                                INTO WHICH THE GENERATED
C                                RANDOM SAMPLE WILL BE PLACED.
C                     --MINMAX = THE INTEGER VALUE
C                                IDENTIFYING THE
C                                CHOSEN WEIBULL DISTRIBUTION.
C                                1 = MIN, 2 = MAX.
C     OUTPUT--A RANDOM SAMPLE OF SIZE N
C             FROM THE EXTREME VALUE TYPE 1 DISTRIBUTION
C             WITH MEAN = EULER'S NUMBER = 0.57721566
C             AND STANDARD DEVIATION = PI/SQRT(6) = 1.28254983.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--THERE IS NO RESTRICTION ON THE MAXIMUM VALUE
C                   OF N FOR THIS SUBROUTINE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--UNIRAN.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--LOG.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--SARHAN & GREENBERG,
C                 CONTRIBUTIONS TO ORDER STATISTICS,
C                 1962, WILEY, PAGE 69.
C               --TOCHER, THE ART OF SIMULATION,
C                 1963, PAGES 14-15.
C               --HAMMERSLEY AND HANDSCOMB, MONTE CARLO METHODS,
C                 1964, PAGE 36.
C               --JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--1, 1970, PAGES 272-295.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1966)
C     VERSION NUMBER--82/7
C     ORIGINAL VERSION--NOVEMBER  1975.
C     UPDATED         --DECEMBER  1981.
C     UPDATED         --MAY       1982.
C     UPDATED         --MAY       1993. REWRITTEN--ADD EV1/MIN DIST.
C     UPDATED         --JANUARY   1994. ADD MINMAX ERROR MESSAGE
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C---------------------------------------------------------------------
C
      DIMENSION X(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(N.LT.1)GOTO50
      GOTO90
   50 WRITE(ICOUT, 5)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,47)N
      CALL DPWRST('XXX','BUG ')
      RETURN
   90 CONTINUE
    5 FORMAT('***** FATAL ERROR--THE 1ST INPUT ARGUMENT TO THE ',
     1'EV1RAN SUBROUTINE IS NON-POSITIVE *****')
   47 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',I8,' *****')
C
C     GENERATE N UNIFORM (0,1) RANDOM NUMBERS;
C
      CALL UNIRAN(N,ISEED,X)
C
C     GENERATE N EXTREME VALUE TYPE 1 RANDOM NUMBERS
C     USING THE PERCENT POINT FUNCTION TRANSFORMATION METHOD.
C
CCCCC THE FOLLOWING SECTION WAS REWRITTEN   MAY 1993
CCCCC DO100I=1,N
CCCCC X(I)=-LOG(LOG(1.0/X(I)))
CC100 CONTINUE
C
CCCCC THE FOLLOWING SECTION WAS REWRITTEN      JANUARY 1994
      IF(MINMAX.EQ.1)THEN
         DO100I=1,N
         X(I)=LOG(LOG(1.0/(1.0-X(I))))
  100    CONTINUE
      ELSE IF(MINMAX.EQ.2 .OR. MINMAX.EQ.0)THEN
         DO200I=1,N
         X(I)=(-(LOG(LOG(1.0/X(I)))))
  200    CONTINUE
      ELSE
         WRITE(ICOUT,1800)
 1800    FORMAT('*****ERROR IN EV1RAN--MINMAX NOT 1 OR 2')
         CALL DPWRST('XXX','BUG ')
      ENDIF
C
      RETURN
      END
      SUBROUTINE EV2CDF(X,GAMMA,MINMAX,CDF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE CUMULATIVE DISTRIBUTION
C              FUNCTION VALUE FOR THE EXTREME VALUE TYPE 2
C              DISTRIBUTION WITH SINGLE PRECISION 
C              TAIL LENGTH PARAMETER = GAMMA.
C              THE EXTREME VALUE TYPE 2 DISTRIBUTION USED
C              HEREIN IS DEFINED FOR ALL NON-NEGATIVE X,
C              AND HAS THE PROBABILITY DENSITY FUNCTION
C              FOR THE MAXIMUM ORDER STATISTIC
C              F(X) = GAMMA * (X**(-GAMMA-1)) * EXP(-(X**(-GAMMA))).
C              FOR THE MINIMUM ORDER STATISTIC
C              F(X) = GAMMA * ((-X)**(-GAMMA-1)) * EXP(-((-X)**(-GAMMA))).
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE 
C                                AT WHICH THE CUMULATIVE DISTRIBUTION 
C                                FUNCTION IS TO BE EVALUATED.
C                                X SHOULD BE NON-NEGATIVE.
C                     --GAMMA  = THE SINGLE PRECISION VALUE 
C                                OF THE TAIL LENGTH PARAMETER.
C                                GAMMA SHOULD BE POSITIVE.
C     OUTPUT ARGUMENTS--CDF    = THE SINGLE PRECISION CUMULATIVE
C                                DISTRIBUTION FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION CUMULATIVE DISTRIBUTION
C             FUNCTION VALUE CDF FOR THE EXTREME VALUE TYPE 2
C             DISTRIBUTION WITH TAIL LENGTH PARAMETER VALUE = GAMMA.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS. 
C     RESTRICTIONS--GAMMA SHOULD BE POSITIVE.
C                 --X SHOULD BE NON-NEGATIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--EXP.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN. 
C     REFERENCES--JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--1, 1970, PAGES 272-295.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING LABORATORY (205.03)
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE:  301-921-2315
C     ORIGINAL VERSION--APRIL     1994. 
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C---------------------------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      CDF=0.0
      IF(X.LT.0.0.AND.(MINMAX.EQ.2 .OR. MINMAX.EQ.0))THEN
        WRITE(ICOUT,4)
    4   FORMAT('***** WARNING--THE FIRST ARGUMENT TO EV2CDF IS ',
     1         'NEGATIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)X
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,47)MINMAX
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(X.GT.0.0.AND.MINMAX.EQ.1)THEN
        WRITE(ICOUT,5)
    5   FORMAT('***** WARNING--THE FIRST ARGUMENT TO EV2CDF IS ',
     1         'POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)X
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,47)MINMAX
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(GAMMA.LE.0.0)THEN
        WRITE(ICOUT,15) 
   15   FORMAT('***** ERROR--THE SECOND ARGUMENT TO EV2CDF ',
     1         'IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)GAMMA
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
   46 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7)
   47 FORMAT('***** THE VALUE OF MINMAX IS ',I5)
C
C-----START POINT-----------------------------------------------------
C
      IF(MINMAX.EQ.1)THEN
        CDF=1.0
        IF(X.GE.0.0)GOTO9000
        CDF=1.0-EXP(-(-X)**(-GAMMA)) 
      ELSEIF(MINMAX.EQ.2 .OR. MINMAX.EQ.0)THEN
        CDF=0.0
        IF(X.LE.0.0)GOTO9000
        CDF=EXP(-(X**(-GAMMA))) 
      ELSE
         WRITE(ICOUT,1800)
 1800    FORMAT('*****ERROR IN EV2CDF--MINMAX NOT 1 OR 2')
         CALL DPWRST('XXX','BUG ')
      END IF
C
 9000 CONTINUE
      RETURN
      END 
      SUBROUTINE EV2CDD(X,GAMMA,MINMAX,CDF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE CUMULATIVE DISTRIBUTION
C              FUNCTION VALUE FOR THE EXTREME VALUE TYPE 2
C              DISTRIBUTION WITH SINGLE PRECISION 
C              TAIL LENGTH PARAMETER = GAMMA.
C              THE EXTREME VALUE TYPE 2 DISTRIBUTION USED
C              HEREIN IS DEFINED FOR ALL NON-NEGATIVE X,
C              AND HAS THE PROBABILITY DENSITY FUNCTION
C              FOR THE MAXIMUM ORDER STATISTIC
C              F(X) = GAMMA * (X**(-GAMMA-1)) * EXP(-(X**(-GAMMA))).
C              FOR THE MINIMUM ORDER STATISTIC
C              F(X) = GAMMA * ((-X)**(-GAMMA-1)) * EXP(-((-X)**(-GAMMA))).
C     NOTE--THIS IS A DOUBLE PRECISION VERSION OF EV2CDF USED IN
C           CALCULATING HAZARD FUNCTIONS
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE 
C                                AT WHICH THE CUMULATIVE DISTRIBUTION 
C                                FUNCTION IS TO BE EVALUATED.
C                                X SHOULD BE NON-NEGATIVE.
C                     --GAMMA  = THE SINGLE PRECISION VALUE 
C                                OF THE TAIL LENGTH PARAMETER.
C                                GAMMA SHOULD BE POSITIVE.
C     OUTPUT ARGUMENTS--CDF    = THE SINGLE PRECISION CUMULATIVE
C                                DISTRIBUTION FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION CUMULATIVE DISTRIBUTION
C             FUNCTION VALUE CDF FOR THE EXTREME VALUE TYPE 2
C             DISTRIBUTION WITH TAIL LENGTH PARAMETER VALUE = GAMMA.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS. 
C     RESTRICTIONS--GAMMA SHOULD BE POSITIVE.
C                 --X SHOULD BE NON-NEGATIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--EXP.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN. 
C     REFERENCES--JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--1, 1970, PAGES 272-295.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING LABORATORY (205.03)
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE:  301-921-2315
C     ORIGINAL VERSION--APRIL     1994. 
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      DOUBLE PRECISION X
      DOUBLE PRECISION GAMMA
      DOUBLE PRECISION CDF
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C---------------------------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      CDF=0.0D0
      IF(X.LT.0.0D0.AND.(MINMAX.EQ.2 .OR. MINMAX.EQ.0))THEN
        WRITE(ICOUT,4)
    4   FORMAT('***** WARNING--THE FIRST ARGUMENT TO EV2CDF IS ',
     1         'NEGATIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)X
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,47)MINMAX
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(X.GT.0.0D0.AND.MINMAX.EQ.1)THEN
        WRITE(ICOUT,5)
    5   FORMAT('***** WARNING--THE FIRST ARGUMENT TO EV2CDF IS ',
     1         'POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)X
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,47)MINMAX
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(GAMMA.LE.0.0D0)THEN
        WRITE(ICOUT,15) 
   15   FORMAT('***** ERROR--THE SECOND ARGUMENT TO EV2CDF ',
     1         'IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)GAMMA
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
   46 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7)
   47 FORMAT('***** THE VALUE OF MINMAX IS ',I5)
C
C-----START POINT-----------------------------------------------------
C
      IF(MINMAX.EQ.1)THEN
        CDF=1.0D0
        IF(X.GE.0.0D0)GOTO9000
        CDF=1.0D0-DEXP(-(-X)**(-GAMMA)) 
      ELSEIF(MINMAX.EQ.2 .OR. MINMAX.EQ.0)THEN
        CDF=0.0D0
        IF(X.LE.0.0D0)RETURN
        CDF=DEXP(-(X**(-GAMMA))) 
      ELSE
         WRITE(ICOUT,1800)
 1800    FORMAT('*****ERROR IN EV2CDF--MINMAX NOT 1 OR 2')
         CALL DPWRST('XXX','BUG ')
      END IF
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE EV2CHA(X,GAMMA,MINMAX,HAZ)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE CUMULATIVE HAZARD
C              FUNCTION VALUE FOR THE EXTREME VALUE TYPE 2
C              DISTRIBUTION WITH SINGLE PRECISION 
C              TAIL LENGTH PARAMETER = GAMMA.
C              THE EXTREME VALUE TYPE 2 DISTRIBUTION USED
C              HEREIN IS DEFINED FOR ALL NON-NEGATIVE X,
C              AND HAS THE PROBABILITY DENSITY FUNCTION
C              FOR THE MAXIMUM ORDER STATISTIC
C              F(X) = GAMMA * (X**(-GAMMA-1)) * EXP(-(X**(-GAMMA))).
C              FOR THE MINIMUM ORDER STATISTIC
C              F(X) = GAMMA * ((-X)**(-GAMMA-1)) * EXP(-((-X)**(-GAMMA))).
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE 
C                                AT WHICH THE PROBABILITY DENSITY
C                                FUNCTION IS TO BE EVALUATED.
C                                X SHOULD BE NON-NEGATIVE.
C                     --GAMMA  = THE SINGLE PRECISION VALUE 
C                                OF THE TAIL LENGTH PARAMETER.
C                                GAMMA SHOULD BE POSITIVE.
C     OUTPUT ARGUMENTS--HAZ    = THE SINGLE PRECISION CUMULATIVE HAZARD
C                                FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION CUMULATIVE HAZARD
C             FUNCTION VALUE HAZ FOR THE EXTREME VALUE TYPE 2
C             DISTRIBUTION WITH TAIL LENGTH PARAMETER VALUE = GAMMA.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS. 
C     RESTRICTIONS--GAMMA SHOULD BE POSITIVE.
C                 --X SHOULD BE NON-NEGATIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--EXP.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN. 
C     REFERENCES--JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--1, 1970, PAGES 272-295.
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING LABORATORY (205.03)
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE:  301-975-2899
C     ORIGINAL VERSION--APRIL     1998. 
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      DOUBLE PRECISION CDF
      DOUBLE PRECISION DHAZ
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C---------------------------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      HAZ=0.0
      IF(X.LT.0.0.AND.(MINMAX.EQ.2 .OR. MINMAX.EQ.0))THEN
        WRITE(ICOUT,4)
    4   FORMAT('***** WARNING--THE FIRST ARGUMENT TO EV2CHA IS ',
     1         'NEGATIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)X
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,47)MINMAX
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(X.GT.0.0.AND.MINMAX.EQ.1)THEN
        WRITE(ICOUT,5)
    5   FORMAT('***** WARNING--THE FIRST ARGUMENT TO EV2CHA IS ',
     1         'POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)X
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,47)MINMAX
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(GAMMA.LE.0.0)THEN
        WRITE(ICOUT,15) 
   15   FORMAT('***** ERROR--THE SECOND ARGUMENT TO EV2CHA ',
     1         'IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)GAMMA
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
   46 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7)
   47 FORMAT('***** THE VALUE OF MINMAX IS ',I5)
C
C-----START POINT-----------------------------------------------------
C
      IF(MINMAX.EQ.1)THEN
        DGAMMA=DBLE(GAMMA)
        DX=DBLE(X)
        DHAZ=(-DX)**(-DGAMMA)
        HAZ=REAL(DHAZ)
      ELSEIF(MINMAX.EQ.2 .OR. MINMAX.EQ.0)THEN
        CALL EV2CDD(DBLE(X),DBLE(GAMMA),MINMAX,CDF)
        CDF=1.0D0-CDF
        IF(CDF.LE.0.0D0)THEN
          WRITE(ICOUT,1100)
          CALL DPWRST('XXX','BUG ')
 1100     FORMAT('*****ERROR IN EV2CHA--CDF ESSENTIALLY 1.')
        ELSE
          DHAZ=-DLOG(CDF)
          HAZ=REAL(DHAZ)
        ENDIF
      ELSE
         WRITE(ICOUT,1800)
 1800    FORMAT('*****ERROR IN EV2CHA--MINMAX NOT 1 OR 2')
         CALL DPWRST('XXX','BUG ')
      END IF
C
 9000 CONTINUE
      RETURN
      END 
      DOUBLE PRECISION FUNCTION EV2FUN (GHAT,X)
C
C     PURPOSE--THIS ROUTINE IS USED IN FINDING THE MAXIMUM LIKELIHOOD
C              ESTIMATE OF GAMMA FOR THE 2-PARAMETER FRECHET
C              (EXTREME VALUE TYPE 2)
C              MODEL FOR FULL SAMPLE DATA (NO CENSORING).  THIS
C              FUNCTION FINDS THE ROOT OF THE EQUATION:
C
C                 (1/GHAT) +
C                 SUM[i=1 to n][Y(I)**(-GHAT)*LN(Y(I))]/
C                 SUM[i=1 to n][[Y(I)**(-GHAT)] -
C                 (1/N)*SUM[i=1 to n][LN(Y(I))] = 0
C
C              WITH
C
C                 GHAT     = POINT ESTIMATE OF GAMMA (THIS IS THE
C                            PARAMETER WE ARE ITERATING OVER)
C
C              NOTE THAT THE THIRD TERM DOES NOT DEPEND ON GHAT,
C              SO THIS IS A CONSTANT.  FOR EFFICIENCY, SAVE THIS AS
C              A CONSTANT IN A COMMON BLOCK.
C
C              CALLED BY DFZER2 ROUTINE FOR FINDING THE ROOT OF A
C              FUNCTION.
C     EXAMPLE--FRECHET MAXIMUM LIKELIHOOD Y
C     REFERENCE--KARL BURY, "STATISTICAL DISTRIBUTIONS IN
C                ENGINEERING", CAMBRIDGE UNIVERSITY PRESS,
C                1999, CHAPTER 16.
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBUG, MD 20899-8980
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2005/5
C     ORIGINAL VERSION--MAY        2005.
C     UPDATED         --JUNE       2013. CHECK FOR DIVISION BY ZERO
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION GHAT
      DOUBLE PRECISION X(*)
C
      INTEGER IN 
      DOUBLE PRECISION DEV2SM
      COMMON/EV2COM/DEV2SM,IN
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DSUM1
      DOUBLE PRECISION DSUM2
      DOUBLE PRECISION DTERM1
      DOUBLE PRECISION DTERM2
      DOUBLE PRECISION DX1
      DOUBLE PRECISION DG
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C  COMPUTE SOME SUMS
C
      DSUM1=0.0D0
      DSUM2=0.0D0
      DG=GHAT
C
      DTERM1=1.0D0/DG
      DO100I=1,IN
        DX1=X(I)
        DSUM1=DSUM1 + (DX1**(-DG))*DLOG(DX1)
        DSUM2=DSUM2 + DX1**(-DG)
  100 CONTINUE
C
C     2013/06/20: IF DSUM2 IS ZERO, THEN SET DTERM2 TO A LARGE NUMBER
      IF(DSUM2.NE.0.0D0)THEN
        DTERM2=DSUM1/DSUM2
      ELSE
        DTERM2=CPUMAX/2.0D0
      ENDIF
C
      EV2FUN=DTERM1 + DTERM2 - DEV2SM
C
      RETURN
      END
      DOUBLE PRECISION FUNCTION EV2FU2 (DA,DX)
C
C     PURPOSE--THIS ROUTINE IS USED IN FINDING THE LIKELIHOOD RATIO
C              BASED CONFIDECE INTERVAL FOR THE 2-PARAMETER FRECHET
C              MODEL (FULL SAMPLE).  THIS FUNCTION FINDS THE ROOT
C              OF THE EQUATION:
C
C                 2*LL(ALPHA,GAMMA) - 2*LL(S(a),,a) - CHSPPF(alpha,1)
C
C              WITH
C
C                 LL(ALPHA,GAMMA) = N*LN(GAMMA) + N*GAMMA*LN(ALPHA) -
C                          (GAMMA+1)*SUM[i=1 to n][LN(X(i))] -
C                          ALPHA**GAMMA*SUM[i=1 to n][(X(i)**(-GAMA)]
C                 ALPHA    = POINT ESTIMATE OF SCALE PARAMETER
C                 GAMMA    = POINT ESTIMATE OF SHAPE PARAMETER
C                 A        = PARAMETER WE ARE FINDING ROOT FOR
C                 K        = CHSPPF(ALPHA,1) (HERE, ALPHA IS THE
C                            SIGNIFICANCE LEVEL, NOT THE SCALE PARAMETER)
C
C              NOTE THAT QUANTITIES THAT DO NOT DEPEND ON A ARE
C              COMPUTED ONCE IN DPMLFR AND PASSED VIA COMMON BLOCK.
C
C              CALLED BY DFZER2 ROUTINE FOR FINDING THE ROOT OF A
C              FUNCTION.  DFZER2 IS MODIFIED VERSION OF DFZERO THAT
C              PASSES ALONG THE DATA ARRAY.
C
C     EXAMPLE--FRECHET MAXIMUM LIKELIHOOD Y
C     REFERENCE--KARL BURY, "STATISTICAL DISTRIBUTIONS IN ENGINEERING",
C                CAMBRIDGE UNIVERSITY PRESS, 1999, CHAPTER 16 (SEE
C                EXAMPLE 16.4).
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBUG, MD 20899-8980
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2005/5
C     ORIGINAL VERSION--MAY        2005.
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DA
      DOUBLE PRECISION DX(*)
C
      DOUBLE PRECISION DK
      DOUBLE PRECISION DTERM1
      DOUBLE PRECISION DTERM2
      COMMON/EV2CO2/DK,DTERM1,DTERM2,N
C
      DOUBLE PRECISION DN
      DOUBLE PRECISION DG
      DOUBLE PRECISION DSCALE
      DOUBLE PRECISION DSUM1
      DOUBLE PRECISION DTERM3
      DOUBLE PRECISION DTERM4
      DOUBLE PRECISION DTERM5
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C  COMPUTE SOME SUMS
C
      DN=DBLE(N)
      DG=DA
C
      DSUM1=0.0D0
      DO100I=1,N
        DSUM1=DSUM1 + DX(I)**(-DG)
  100 CONTINUE
      DSCALE=(DSUM1/DN)**(-1.0D0/DG)
C
      DTERM3=DN*DLOG(DG) + DN*DG*DLOG(DSCALE)
      DTERM4=(DG+1.0D0)*DTERM2
      DTERM5=DSCALE**DG*DSUM1
C
      EV2FU2=DTERM1 - 2.0D0*(DTERM3 - DTERM4 - DTERM5) - DK
C
      RETURN
      END
      DOUBLE PRECISION FUNCTION EV2FU3 (DB,DX)
C
C     PURPOSE--THIS ROUTINE IS USED IN FINDING THE LIKELIHOOD RATIO
C              BASED CONFIDENCE INTERVAL FOR THE SCALE PARAMETER OF A
C              2-PARAMETER FRECHET MODEL (FULL SAMPLE).  THIS
C              FUNCTION FINDS THE ROOT OF THE EQUATION:
C
C                 2*LL(ALPHA,GAMMA) - 2*LL(b,I(b)) - CHSPPF(alpha,1)
C
C              WITH
C
C                 LL(ALPHA,GAMMA) = N*LN(GAMMA) + N*GAMMA*LN(ALPHA) -
C                          (GAMMA+1)*SUM[i=1 to n][LN(X(i))] -
C                          ALPHA**GAMMA*SUM[i=1 to n][(X(i)**(-GAMMA)]
C                 ALPHA    = POINT ESTIMATE OF SCALE PARAMETER
C                 GAMMA    = POINT ESTIMATE OF SHAPE PARAMETER
C                 B        = PARAMETER (SCALE) WE ARE FINDING ROOT FOR
C                 K        = CHSPPF(ALPHA,1) (HERE, ALPHA IS THE
C                            SIGNIFICANCE LEVEL, NOT THE SCALE
C                            PARAMETER)
C
C              NOTE THAT QUANTITIES THAT DO NOT DEPEND ON B ARE
C              COMPUTED ONCE IN DPMLFR AND PASSED VIA COMMON BLOCK.
C
C              GIVEN A VALUE FOR THE SCALE PARAMETER (DB), WE NEED
C              TO CALL A ROOT FINDING ROUTINE TO DETERMINE THE VALUE
C              OF THE SHAPE PARAMETER (A).
C
C              CALLED BY DFZER2 ROUTINE FOR FINDING THE ROOT OF A
C              FUNCTION.  DFZER2 IS MODIFIED VERSION OF DFZERO THAT
C              PASSES ALONG THE DATA ARRAY.
C
C     EXAMPLE--FRECHET MAXIMUM LIKELIHOOD Y
C     REFERENCE--KARL BURY, "STATISTICAL DISTRIBUTIONS IN ENGINEERING",
C                CAMBRIDGE UNIVERSITY PRESS, 1999, CHAPTER 16 (SEE
C                EXAMPLE 16.4).
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBUG, MD 20899-8980
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2005/5
C     ORIGINAL VERSION--MAY        2005.
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DB
      DOUBLE PRECISION DX(*)
C
      DOUBLE PRECISION DK
      DOUBLE PRECISION DTERM6
      DOUBLE PRECISION DTERM7
      DOUBLE PRECISION DGAMMA
      COMMON/EV2CO3/DK,DTERM6,DTERM7,DGAMMA,N
C
      DOUBLE PRECISION DBTEMP
      COMMON/EV2CO4/DBTEMP,N2
C
      DOUBLE PRECISION AE
      DOUBLE PRECISION RE
      DOUBLE PRECISION XLOW
      DOUBLE PRECISION XUP
      DOUBLE PRECISION XSTRT
      DOUBLE PRECISION DA
      DOUBLE PRECISION DG
      DOUBLE PRECISION DN
      DOUBLE PRECISION DSCALE
      DOUBLE PRECISION DSUM1
      DOUBLE PRECISION DTERM3
      DOUBLE PRECISION DTERM4
      DOUBLE PRECISION DTERM5
C
      DOUBLE PRECISION EV2FU4
      EXTERNAL EV2FU4
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C  STEP 1: GIVEN VALUE OF SCALE PARAMETER (DB), NEED TO COMPUTE
C          THE SHAPE PARAMETER (WHICH IN TURN INVOLVES FINDING A
C          ROOT).

      N2=N
      DBTEMP=DB
      AE=1.D-7
      RE=1.D-7
      XSTRT=DGAMMA
      XLOW=XSTRT/5.0D0
      XUP=XSTRT*5.0D0
      CALL DFZER3(EV2FU4,XLOW,XUP,XSTRT,RE,AE,IFLAG,DX)
      DA=XLOW
C
C  COMPUTE SOME SUMS
C
      DN=DBLE(N)
      DG=DA
      DSCALE=DB
C
      DSUM1=0.0D0
      DO100I=1,N
        DSUM1=DSUM1 + DX(I)**(-DG)
  100 CONTINUE
C
      DTERM3=DN*DLOG(DG) + DN*DG*DLOG(DSCALE)
      DTERM4=(DG+1.0D0)*DTERM7
      DTERM5=DSCALE**DG*DSUM1
C
      EV2FU3=DTERM6 - 2.0D0*(DTERM3 - DTERM4 - DTERM5) - DK
C
      RETURN
      END
      DOUBLE PRECISION FUNCTION EV2FU4 (DA,DX)
C
C     PURPOSE--THIS ROUTINE IS USED IN FINDING THE LIKELIHOOD RATIO
C              BASED CONFIDENCE INTERVAL FOR THE SCALE PARAMETER OF
C              THE 2-PARAMETER FRECHET MODEL (FULL SAMPLE).
C              SPECIFICALLY, IT IS USED TO DETERMINE AN ESTIMATE
C              OF THE SHAPE PARAMETER GIVEN A VALUE OF THE SCALE
C              PARAMETER.  IT FINDS THE ROOT OF THE FOLLOWING
C              EQUATION:
C
C                 (N/A) + N*LOG(B) - SUM[LOG(X)] -
C                       SUM[(B/X)**A*LOG(B/X)]
C
C              WITH A DENOTING THE SHAPE PARAMETER, B THE SCALE
C              PARAMETER, AND THE ROOT IS WITH RESPECT TO A.
C
C              CALLED BY DFZER3 ROUTINE FOR FINDING THE ROOT OF A
C              FUNCTION.  DFZER3 IS MODIFIED VERSION OF DFZERO THAT
C              PASSES ALONG THE DATA ARRAY.
C
C     EXAMPLE--FRECHET MAXIMUM LIKELIHOOD Y
C     REFERENCE--KARL BURY, "STATISTICAL DISTRIBUTIONS IN ENGINEERING",
C                CAMBRIDGE UNIVERSITY PRESS, 1999, CHAPTER 16 (SEE
C                EXAMPLE 16.4).
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBUG, MD 20899-8980
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2005/5
C     ORIGINAL VERSION--MAY        2005.
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DA
      DOUBLE PRECISION DX(*)
C
      DOUBLE PRECISION DB
      COMMON/EV2CO4/DB,N
C
      DOUBLE PRECISION DN
      DOUBLE PRECISION DSUM1
      DOUBLE PRECISION DSUM2
      DOUBLE PRECISION DTERM1
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C  COMPUTE SOME SUMS
C
      DN=DBLE(N)
      DTERM1=(DN/DA) + DN*DLOG(DB)
C
      DSUM1=0.0D0
      DSUM2=0.0D0
      DO100I=1,N
        DSUM1=DSUM1 + DLOG(DX(I))
        DSUM2=DSUM2 + ((DB/DX(I))**DA)*DLOG(DB/DX(I))
  100 CONTINUE
C
      EV2FU4=DTERM1 - DSUM1 - DSUM2
C
      RETURN
      END
      SUBROUTINE EV2HAZ(X,GAMMA,MINMAX,HAZ)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE HAZARD
C              FUNCTION VALUE FOR THE EXTREME VALUE TYPE 2
C              DISTRIBUTION WITH SINGLE PRECISION 
C              TAIL LENGTH PARAMETER = GAMMA.
C              THE EXTREME VALUE TYPE 2 DISTRIBUTION USED
C              HEREIN IS DEFINED FOR ALL NON-NEGATIVE X,
C              AND HAS THE PROBABILITY DENSITY FUNCTION
C              FOR THE MAXIMUM ORDER STATISTIC
C              F(X) = GAMMA * (X**(-GAMMA-1)) * EXP(-(X**(-GAMMA))).
C              FOR THE MINIMUM ORDER STATISTIC
C              F(X) = GAMMA * ((-X)**(-GAMMA-1)) * EXP(-((-X)**(-GAMMA))).
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE 
C                                AT WHICH THE PROBABILITY DENSITY
C                                FUNCTION IS TO BE EVALUATED.
C                                X SHOULD BE NON-NEGATIVE.
C                     --GAMMA  = THE SINGLE PRECISION VALUE 
C                                OF THE TAIL LENGTH PARAMETER.
C                                GAMMA SHOULD BE POSITIVE.
C     OUTPUT ARGUMENTS--HAZ    = THE SINGLE PRECISION HAZARD
C                                FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION HAZARD
C             FUNCTION VALUE HAZ FOR THE EXTREME VALUE TYPE 2
C             DISTRIBUTION WITH TAIL LENGTH PARAMETER VALUE = GAMMA.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS. 
C     RESTRICTIONS--GAMMA SHOULD BE POSITIVE.
C                 --X SHOULD BE NON-NEGATIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--EXP.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN. 
C     REFERENCES--JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--1, 1970, PAGES 272-295.
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING LABORATORY (205.03)
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE:  301-975-2899
C     ORIGINAL VERSION--APRIL     1998. 
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      DOUBLE PRECISION CDF
      DOUBLE PRECISION DPDF
      DOUBLE PRECISION DX
      DOUBLE PRECISION DGAMMA
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C---------------------------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      HAZ=0.0
      IF(X.LT.0.0.AND.(MINMAX.EQ.2 .OR. MINMAX.EQ.0))THEN
        WRITE(ICOUT,4)
    4   FORMAT('***** WARNING--THE FIRST ARGUMENT TO EV2HAZ IS ',
     1         'NEGATIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)X
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,47)MINMAX
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(X.GT.0.0.AND.MINMAX.EQ.1)THEN
        WRITE(ICOUT,5)
    5   FORMAT('***** WARNING--THE FIRST ARGUMENT TO EV2HAZ IS ',
     1         'POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)X
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,47)MINMAX
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(GAMMA.LE.0.0)THEN
        WRITE(ICOUT,15) 
   15   FORMAT('***** ERROR--THE SECOND ARGUMENT TO EV2HAZ ',
     1         'IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)GAMMA
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
   46 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7)
   47 FORMAT('***** THE VALUE OF MINMAX IS ',I5)
C
C-----START POINT-----------------------------------------------------
C
      DGAMMA=DBLE(GAMMA)
      DX=DBLE(X)
      IF(MINMAX.EQ.1)THEN
        DHAZ=DGAMMA*(-DX)**(-DGAMMA-1.0D0)
        HAZ=REAL(DHAZ)
      ELSEIF(MINMAX.EQ.2 .OR. MINMAX.EQ.0)THEN
        DPDF=DGAMMA*(DX**(-DGAMMA-1.0))*DEXP(-(DX**(-DGAMMA))) 
        CALL EV2CDD(DBLE(X),DBLE(GAMMA),MINMAX,CDF)
        IF(1.0D0-CDF.LE.0.0D0)THEN
          WRITE(ICOUT,1100)
          CALL DPWRST('XXX','BUG ')
 1100     FORMAT('*****ERROR IN EV2HAZ--CDF ESSENTIALLY 1, ',
     1           'HAZARD SET TO 0.')
        ELSE
          HAZ=REAL(DPDF/(1.0D0-CDF))
        ENDIF
      ELSE
         WRITE(ICOUT,1800)
 1800    FORMAT('*****ERROR IN EV2HAZ--MINMAX NOT 1 OR 2')
         CALL DPWRST('XXX','BUG ')
      END IF
C
 9000 CONTINUE
      RETURN
      END 
      SUBROUTINE EV2LI1(Y,N,ICASPL,MINMAX,ALOC,SCALE,SHAPE,
     1                  ALIK,AIC,AICC,BIC,
     1                  ISUBRO,IBUGA3,IERROR)
C
C     PURPOSE--THIS ROUTINE COMPUTES THE LIKELIHOOD FUNCTION FOR
C              THE FRECHET DISTRIBUTION.  THIS IS FOR THE RAW DATA
C              CASE (I.E., NO GROUPING AND NO CENSORING).
C
C              IT IS ASSUMED THAT BASIC ERROR CHECKING HAS ALREADY BEEN
C              PERFORMED.
C
C     REFERENCE--KARL BURY, "STATISTICAL DISTRIBUTIONS IN ENGINEERING",
C                CAMBRIDGE UNIVERSITY PRESS, 1999, CHAPTER 16.
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2014/9
C     ORIGINAL VERSION--SEPTEMBER 2014.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 ICASPL
      CHARACTER*4 ISUBRO
      CHARACTER*4 IBUGA3
      CHARACTER*4 IERROR
C
      CHARACTER*4 IWRITE
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
      CHARACTER*4 ISTEPN
C
      DOUBLE PRECISION DX
      DOUBLE PRECISION DG
      DOUBLE PRECISION DLOC
      DOUBLE PRECISION DSCALE
      DOUBLE PRECISION DPDF
      DOUBLE PRECISION DN
      DOUBLE PRECISION DNP
      DOUBLE PRECISION DLIK
      DOUBLE PRECISION DTERM1
      DOUBLE PRECISION DTERM3
C
C---------------------------------------------------------------------
C
      DIMENSION Y(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='EV2L'
      ISUBN2='I1  '
      IERROR='NO'
C
      DPDF=0.0D0
      ALIK=-99.0
      AIC=-99.0
      AICC=-99.0
      BIC=-99.0
C
      IF(ALOC.EQ.CPUMIN)THEN
        ALOCT=0.0
      ELSE
        ALOCT=ALOC
      ENDIF
C
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'2LI1')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,51)
   51   FORMAT('**** AT THE BEGINNING OF EV2LI1--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,52)IBUGA3,ISUBRO
   52   FORMAT('IBUGA3,ISUBRO = ',A4,2X,A4)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,55)N,ALOC,SCALE
   55   FORMAT('N,ALOC,SCALE = ',I8,2G15.7)
        CALL DPWRST('XXX','WRIT')
        DO56I=1,MIN(N,100)
          WRITE(ICOUT,57)I,Y(I)
   57     FORMAT('I,Y(I) = ',I8,G15.7)
          CALL DPWRST('XXX','WRIT')
   56   CONTINUE
      ENDIF
C
C               ******************************************
C               **  STEP 1--                            **
C               **  COMPUTE LIKELIHOOD FUNCTION         **
C               ******************************************
C
      ISTEPN='1'
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'2LI1')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      IERFLG=0
      IERROR='NO'
      IWRITE='OFF'
      IF(ICASPL.EQ.'FREC')ALOC=0.0
C
C     LOG-LIKELIHOOD FUNCTION IS:
C
C     N*(LOG(SHAPE) - SHAPE*LOG(SCALE)) +
C     (SHAPE-1)*SUM[i=1 to n][LOG(X(i) - LOC] -
C     SUM[i=1 to n][((X(i) - LOC)/SCALE)**SHAPE]
C
CCCCC DN=DBLE(N)
CCCCC DS=DBLE(SCALE)
CCCCC DU=DBLE(ALOC)
CCCCC DG=DBLE(SHAPE)
CCCCC DTERM1=DN*(DLOG(DG) - DG*DLOG(DS))
CCCCC DSUM1=0.0D0
CCCCC DSUM2=0.0D0
C
CCCCC IF(MINMAX.EQ.2)THEN
CCCCC   DO1010I=1,N
CCCCC     DX=DBLE(Y(I))
CCCCC     DSUM1=DSUM1 + DLOG(DU - DX)
CCCCC     DSUM2=DSUM2 + ((DU-DX)/DS)**DG
CC010   CONTINUE
CCCCC ELSE
CCCCC   DO1020I=1,N
CCCCC     DX=DBLE(Y(I))
CCCCC     DSUM1=DSUM1 + DLOG(DX - DU)
CCCCC     DSUM2=DSUM2 + ((DX-DU)/DS)**DG
CC020   CONTINUE
CCCCC ENDIF
C
      DG=DBLE(SHAPE)
      DLOC=DBLE(ALOC)
      DSCALE=DBLE(SCALE)
      DLIK=0.0D0
C
      DO1000I=1,N
        DX=DBLE(Y(I))
        DX=(DX-DLOC)/DSCALE
C
        IF(MINMAX.EQ.1)THEN
          DPDF=DG*((-DX)**(-DG-1.0D0))*DEXP(-((-DX)**(-DG))) 
          DPDF=DPDF/DSCALE
        ELSEIF(MINMAX.EQ.2 .OR. MINMAX.EQ.0)THEN
          DPDF=DG*(DX**(-DG-1.0D0))*DEXP(-(DX**(-DG))) 
        ENDIF
        IF(DPDF.LE.0.0D0)THEN
          IERROR='YES'
CCCCC     GOTO9000
          DTERM1=0.0D0
        ELSE
          DTERM1=DLOG(DPDF)
        ENDIF
        DLIK=DLIK + DTERM1
 1000 CONTINUE
C
      ALIK=REAL(DLIK)
      DN=DBLE(N)
      DNP=2.0D0
      IF(ICASPL.EQ.'3EV2' .OR. ICASPL.EQ.'3FRE')DNP=3.0
      AIC=REAL(-2.0D0*DLIK + 2.0D0*DNP)
      DTERM3=(2.0D0*DNP*(DNP+1.0D0))/(DN-DNP-1.0D0)
      AICC=REAL(-2.0D0*DLIK + 2.0D0*DNP + DTERM3)
      BIC=REAL(-2.0D0*DLIK + DNP*DLOG(DN))
C
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'2LI1')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9011)
 9011   FORMAT('**** AT THE END OF EV2LI1--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9013)DSUM1,DSUM2,DTERM1,DTERM3
 9013   FORMAT('DSUM1,DSUM2,DTERM1,DTERM3 = ',4G15.7)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9014)ALIK,AIC,AICC,BIC
 9014   FORMAT('ALIK,AIC,AICC,BIC = ',4G15.7)
        CALL DPWRST('XXX','WRIT')
      ENDIF
C
      RETURN
      END
      SUBROUTINE EV2ML1(Y,N,MINMAX,
     1                  TEMP1,DTEMP1,
     1                  XMEAN,XSD,XVAR,XMIN,XMAX,XLOGSD,XLOGSM,
     1                  SCALML,SCALSE,SHAPML,SHAPSE,
     1                  SHAPBC,SHABSE,COVSE,COVBSE,
     1                  ISUBRO,IBUGA3,IERROR)
C
C     PURPOSE--THIS ROUTINE COMPUTES THE MAXIMUM LIKELIHOOD ESTIMATES
C              FOR THE 2-PARAMETER EXTREME VALUE TYPE 2 (FRECHET)
C              DISTRIBUTION FOR THE RAW DATA CASE (I.E., NO CENSORING
C              AND NO GROUPING).  THIS ROUTINE RETURNS ONLY THE POINT
C              ESTIMATES (CONFIDENCE INTERVALS WILL BE COMPUTED IN A
C              SEPARATE ROUTINE).
C
C              IT IS ASSUMED THAT BASIC ERROR CHECKING HAS ALREADY BEEN
C              PERFORMED.
C
C              PUT THIS IN A SEPARATE ROUTINE AS IT MAY BE CALLED
C              FROM MULTIPLE PLACES (DPMLW1 WILL GENERATE THE OUTPUT
C              FOR THE FRECHET MLE COMMAND).
C
C     REFERENCE--KARL BURY, "STATISTICAL DISTRIBUTIONS IN ENGINEERING",
C                CAMBRIDGE UNIVERSITY PRESS, 1999, CHAPTER 16.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2010/2
C     ORIGINAL VERSION--FEBRUARY  2010. EXTRACTED AS A SEPARATE
C                                       SUBROUTINE (FROM DPMLFR)
C     UPDATED         --JUNE      2013. IMPROVED STARTING VALUES
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      DIMENSION Y(*)
      DIMENSION TEMP1(*)
      DOUBLE PRECISION DTEMP1(*)
C
      CHARACTER*8 ICASE
      CHARACTER*4 ISUBRO
      CHARACTER*4 IBUGA3
      CHARACTER*4 IERROR
C
      DOUBLE PRECISION DN
      DOUBLE PRECISION DAE
      DOUBLE PRECISION DRE
      DOUBLE PRECISION DYT
      DOUBLE PRECISION DYBAR
      DOUBLE PRECISION DXBAR
      DOUBLE PRECISION DSUM1
      DOUBLE PRECISION DSUM2
      DOUBLE PRECISION DXSTRT
      DOUBLE PRECISION DXLOW
      DOUBLE PRECISION DXUP
      DOUBLE PRECISION XLOWSV
      DOUBLE PRECISION XUPSV
C
      DOUBLE PRECISION EV2FUN
      EXTERNAL EV2FUN
      INTEGER IN
      DOUBLE PRECISION DEV2SM
      COMMON/EV2COM/DEV2SM,IN
C
      CHARACTER*4 IWRITE
      CHARACTER*40 IDIST
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
      CHARACTER*4 ISTEPN
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='EV2M'
      ISUBN2='L1  '
      IERROR='NO'
      IWRITE='OFF'
C
      AN=REAL(N)
C
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'2ML1')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,51)
   51   FORMAT('**** AT THE BEGINNING OF EV2ML1--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,52)IBUGA3,ISUBRO,MINMAX
   52   FORMAT('IBUGA3,ISUBRO,MINMAX = ',2(A4,2X),I5)
        CALL DPWRST('XXX','WRIT')
        DO56I=1,MIN(N,100)
          WRITE(ICOUT,57)I,Y(I)
   57     FORMAT('I,Y(I) = ',I8,G15.7)
          CALL DPWRST('XXX','WRIT')
   56   CONTINUE
      ENDIF
C
C               ********************************************
C               **  STEP 1--                              **
C               **  CHECK THE INPUT ARGUMENTS FOR ERRORS  **
C               ********************************************
C
      ISTEPN='1'
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'2ML1')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      IF(MINMAX.NE.1)THEN
        DO1125I=1,N
          IF(Y(I).LE.0.0)THEN
            WRITE(ICOUT,999)
            CALL DPWRST('XXX','WRIT')
            WRITE(ICOUT,1111)
            CALL DPWRST('XXX','WRIT')
            WRITE(ICOUT,1122)
 1122       FORMAT('      A NON-POSITIVE VALUE WAS ENCOUNTERED IN ',
     1             'THE RESPONSE VARIABLE.')
            CALL DPWRST('XXX','WRIT')
            WRITE(ICOUT,1123)I,Y(I)
 1123       FORMAT('      ROW ',I8,' HAS THE VALUE = ',E15.7)
            CALL DPWRST('XXX','WRIT')
            IERROR='YES'
            GOTO9000
          ELSE
            TEMP1(I)=LOG(Y(I))
          ENDIF
 1125   CONTINUE
      ELSE
        DO1135I=1,N
          IF(Y(I).GE.0.0)THEN
            WRITE(ICOUT,999)
            CALL DPWRST('XXX','WRIT')
            WRITE(ICOUT,1111)
            CALL DPWRST('XXX','WRIT')
            WRITE(ICOUT,1132)
 1132       FORMAT('      A NON-NEGATIVE VALUE WAS ENCOUNTERED IN ',
     1             'THE RESPONSE VARIABLE.')
            WRITE(ICOUT,1133)I,Y(I)
 1133       FORMAT('      ROW ',I8,' HAS THE VALUE = ',E15.7)
            CALL DPWRST('XXX','WRIT')
            IERROR='YES'
            GOTO9000
          ELSE
            TEMP1(I)=LOG(-Y(I))
          ENDIF
 1135   CONTINUE
      ENDIF
C
      HOLD=Y(1)
      DO1145I=2,N
        IF(Y(I).NE.HOLD)GOTO1149
 1145 CONTINUE
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','WRIT')
      WRITE(ICOUT,1111)
      CALL DPWRST('XXX','WRIT')
      WRITE(ICOUT,1142)HOLD
 1142 FORMAT('      THE RESPONSE VARIABLE HAS ALL ELEMENTS = ',G15.7)
      CALL DPWRST('XXX','WRIT')
      IERROR='YES'
      GOTO9000
 1149 CONTINUE
C
C               ******************************************
C               **  STEP 2--                            **
C               **  CARRY OUT CALCULATIONS              **
C               **  FOR FRECHET MLE ESTIMATE            **
C               ******************************************
C
      ISTEPN='2'
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'2ML1')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      IDIST='FRECHET'
CCCCC IFLAG=2
      IFLAG=0
      CALL SUMRAW(Y,N,IDIST,IFLAG,
     1            XMEAN,XVAR,XSD,XMIN,XMAX,
     1            ISUBRO,IBUGA3,IERROR)
      CALL SD(TEMP1,N,IWRITE,XLOGSD,IBUGA3,IERROR)
      CALL SUMDP(TEMP1,N,IWRITE,XLOGSM,IBUGA3,IERROR)
C
      SHAPML=CPUMIN
      SHAPBC=CPUMIN
      SHAPSE=CPUMIN
      SHABSE=CPUMIN
      SCALML=CPUMIN
      SCALSE=CPUMIN
      COVSE=CPUMIN
      COVBSE=CPUMIN
C
C     FOR THE SHAPE PARAMETER, SOLVE THE EQUATION:
C
C         (1/GHAT) +
C         SUM[i=1 to n][Y(I)**(-GHAT)*LN(Y(I))]/
C         SUM[i=1 to n][[Y(I)**(-GHAT)] -
C         (1/N)*SUM[i=1 to n][LN(Y(I))] = 0
C
C     THEN
C
C         SCALE = {((1/N)*SUM[i=1 to n][Y(I)**(-GHAT)])}**(-1/GHAT)
C
C     FOR STARTING VALUE, USE FACT THAT FRECHET = EXPONENTIAL OF
C     GUMBEL DISTRIBUTION.  THEN GHAT = 1/SCALE WITH SCALE DENOTING
C     THE SCALE ESTIMATE OF THE GUMBEL DISTRIBUTION.
C
C     2013/06: BASE STARTING VALUE FOR SHAPE ON "FRECHET" PLOT (SEE
C     PAGE 299 OF BURY).  THE FRECHET PLOT IS
C
C          -LN[LN[p(i)]] versus LN OF ORDERED DATA
C
C     WHERE p(i) = (i - 0.3)/(n + 0.4)
C
C     THEN
C
C           A0 = -GAMMA*LOG(SCALE)
C           A1 = GAMMA
C
C     FOR SIMPLE LINEAR REGRESSION,
C
C           A1 = SUM[X(i) - XBAR]*SUM[Y(i) - YBAR]/SUM[(X(i) - XBAR)**2]
C
C     IN ORDER TO AVOID HAVING TO PASS IN ADDITIONAL SCRATCH ARRAYS, DO
C     IN TWO PASSES.
C
      ISTEPN='21'
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'2EV2')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      ICASE='MAXIMUM'
      IF(MINMAX.EQ.1)THEN
        ICASE='MINIMUM'
        DO4103I=1,N
          Y(I)=-Y(I)
 4103   CONTINUE
      ENDIF
C
C     ESTIMATES FOR 2-PARAMETER MODEL.  USE DFZER2 TO FIND ROOT OF
C     THE EQUATION GIVEN ABOVE.
C
      DO4101I=1,N
        DTEMP1(I)=DBLE(Y(I))
 4101 CONTINUE
      KFLAG=1
      CALL DSORT(DTEMP1,DTEMP1,N,KFLAG,IERROR)
C
      DEV2SM=DBLE(XLOGSM/AN)
CCCCC DXSTRT=DBLE(SQRT(1.645)*XSD)
C
      DSUM1=0.0D0
      DSUM2=0.0D0
      DN=DBLE(N)
      DO3901I=1,N
        DYT=(DBLE(I) - 0.3D0)/(DN + 0.4D0)
        DYT=-LOG(-LOG(DYT))
        DSUM1=DSUM1 + DYT
        DSUM2=DSUM2 + DLOG(DTEMP1(I))
 3901 CONTINUE
      DYBAR=DSUM1/DN
      DXBAR=DSUM2/DN
C
      DSUM1=0.0D0
      DSUM2=0.0D0
      DO3903I=1,N
        DYT=(DBLE(I) - 0.3D0)/(DN + 0.4D0)
        DYT=-LOG(-LOG(DYT))
        DSUM1=DSUM1 + (DLOG(DTEMP1(I)) - DXBAR)*(DYT - DYBAR)
        DSUM2=DSUM2 + (DLOG(DTEMP1(I)) - DXBAR)**2
 3903 CONTINUE
      DXSTRT=DSUM1/DSUM2
C
      DAE=2.0*0.000001D0*DXSTRT
      DRE=DAE
      IN=N
      IFLAG=0
      DXLOW=DXSTRT/3.0D0
      DXUP=3.0D0*DXSTRT
      ITBRAC=0
 4105 CONTINUE
      XLOWSV=DXLOW
      XUPSV=DXUP
      CALL DFZER2(EV2FUN,DXLOW,DXUP,DXSTRT,DRE,DAE,IFLAG,DTEMP1)
C
      IF(IFLAG.EQ.4 .AND. ITBRAC.LE.100)THEN
        DXLOW=XLOWSV/2.0D0
        DXUP=2.0D0*XUPSV
        ITBRAC=ITBRAC+1
        GOTO4105
      ENDIF
C
      IF(IFLAG.EQ.2)THEN
C
CCCCC   NOTE: SUPPRESS THIS MESSAGE FOR NOW.
CCCCC   WRITE(ICOUT,999)
CCCCC   CALL DPWRST('XXX','BUG ')
CCCCC   WRITE(ICOUT,111)
CC111   FORMAT('***** WARNING FROM FRECHET MAXIMUM ',
CCCCC1         'LIKELIHOOD--')
CCCCC   CALL DPWRST('XXX','BUG ')
CCCCC   WRITE(ICOUT,113)
CC113   FORMAT('      ESTIMATE OF SIGMA MAY NOT BE COMPUTED TO ',
CCCCC1         'DESIRED TOLERANCE.')
CCCCC   CALL DPWRST('XXX','BUG ')
      ELSEIF(IFLAG.EQ.3)THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,121)
  121   FORMAT('***** WARNING FROM FRECHET MAXIMUM LIKELIHOOD--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,123)
  123   FORMAT('      ESTIMATE OF GAMMA MAY BE NEAR A SINGULAR POINT.')
        CALL DPWRST('XXX','BUG ')
      ELSEIF(IFLAG.EQ.4)THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1111)
 1111   FORMAT('****** ERROR IN FRECHERT MAXIMUM LIKELIHOOD--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,133)
  133   FORMAT('      APPROPRIATE BRACKETING INTERVAL NOT FOUND.')
        CALL DPWRST('XXX','BUG ')
      ELSEIF(IFLAG.EQ.5)THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,121)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,143)
  143   FORMAT('      MAXIMUM ITERATIONS EXCEEDED.')
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
      SHAPML=REAL(DXLOW)
      DSUM=0.0D0
      DO4108I=1,N
        DSUM=DSUM + DBLE(Y(I)**(-SHAPML))
 4108 CONTINUE
      DSUM=(DSUM/DBLE(N))**(1.0D0/DBLE(-SHAPML))
      SCALML=REAL(DSUM)
      BN=1.0 + 2.2/AN**1.13
      SHAPBC=SHAPML/BN
C
C     COMPUTE STANDARD ERRORS (CAN BASE ON EITHER THE NORMAL BIASED
C     ESTIMATORS OR THE BIAS CORRECTED ESTIMATORS)
C
      SCALSE=1.05293*SCALML/(SHAPML*SQRT(AN))
      SHAPSE=0.77970*SHAPML/SQRT(AN)
      SHABSE=0.77970*SHAPML/(BN*SQRT(AN))
      COVSE=0.50697*SQRT(SCALML/AN)
      COVBSE=0.50697*SQRT(SCALML/(AN*BN))
C
 9000 CONTINUE
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'2ML1')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9011)
 9011   FORMAT('**** AT THE END OF EV2ML1--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9013)N,XMEAN,XSD,XMIN,XMAX
 9013   FORMAT('N,XMEAN,XSD,XMIN,XMAX = ',I8,4G15.7)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9015)XLOGSD,XLOGSM
 9015   FORMAT('XLOGSD,XLOGSM = ',2G15.7)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9017)SHAPML,SCALML,SHAPSE,SCALSE
 9017   FORMAT('SHAPML,SCALML,SHAPSE,SCALSE =  ',4G15.7)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9019)SHAPBC,SHABSE,COVSE,COVBSE
 9019   FORMAT('SHAPBC,SHABSE,COVSE,COVBSE =  ',4G15.7)
        CALL DPWRST('XXX','WRIT')
      ENDIF
C
      RETURN
      END
      SUBROUTINE EV2ML3(Y,N,MINMAX,MAXNXT,ISEED,IDFTTY,IGEVML,
     1                  TEMP1,TEMP2,TEMP3,TEMP4,TEMP5,DTEMP1,
     1                  XMOM,NMOM,VARCOV,
     1                  XMEAN,XSD,XVAR,XMIN,XMAX,XSKEW,
     1                  ALOCML,SCALML,SHAPML,
     1                  ALOCLM,SCALLM,SHAPLM,
     1                  ALOCEP,SCALEP,SHAPEP,
     1                  ISUBRO,IBUGA3,IERROR)
C
C     PURPOSE--THIS ROUTINE COMPUTES THE MAXIMUM LIKELIHOOD ESTIMATES
C              FOR THE 3-PARAMETER FRECHET DISTRIBUTION FOR THE RAW DATA
C              CASE (I.E., NO CENSORING AND NO GROUPING).
C
C              THE DEFAULT IS FOR THE "MAXIMUM" FRECHET.  NOTE
C              THAT THE FOLLOWING ADDITIONAL CASES CAN BE HANDLED:
C
C                 1. THE REVERSE ("MINIMUM") FRECHET.  FOR THIS CASE, WE
C                    TAKE THE NEGATIVE OF THE ORIGINAL DATA AND THEN FIT
C                    THE MAXIMUM FRECHET CASE.  AFTER OBTAINING THE
C                    PARAMETER ESTIMATES, TAKE THE NEGATIVE OF THE
C                    LOCATION PARAMETER.
C
C                 2. NOTE THAT THE "INVERTED WEIBULL" IS REALLY JUST THE
C                    "MAXIMUM" FRECHET.  TREAT INVERTED WEIBULL AND
C                    FRECHET AS SYNONYMS.
C
C              GENERATE ESTIMATES BASED ON:
C
C                 1. MAXIMUM LIKELIHOOD (UNDER DEVELOPMENT)
C                 2. L-MOMENTS
C                 3. ELEMENTAL PERCENTILES
C
C              PUT THIS IN A SEPARATE ROUTINE AS IT MAY BE CALLED
C              FROM MULTIPLE PLACES (DPMLF3 WILL GENERATE THE OUTPUT
C              FOR THE 3-PARAMETER FRECHET MLE COMMAND).
C
C              NOTE THAT THE FRECHET CAN BE ESTIMATED IN TERMS OF THE
C              GENERALIZED EXTREME VALUE DISTRIBUTION AS FOLLOWS:
C
C              1. FOR MAXIMUM CASE:
C
C                    LOC    = LOC' + SCALE'/SHAPE'
C                    SCALE  = -SCALE'/SHAPE'
C                    SHAPE  = -1/SHAPE'
C
C              2. FOR MINIMUM CASE:
C
C                    LOC    = LOC' - SCALE'/SHAPE'
C                    SCALE  = -SCALE'/SHAPE'
C                    SHAPE  = -1/SHAPE'
C
C               WHERE LOC', SCALE', AND SHAPE' ARE THE PARAMETERS OF THE
C               3-PARAMETER GENERALIZED EXTREME VALUE DISTRIBUTION.
C
C     REFERENCES--CASTILLO, HADI, BALAKRISHNAN, AND SARABIA (2005),
C                 "EXTREME VALUE AND RELATED MODELS WITH APPLICATIONS
C                 IN ENGINEERING AND SCIENCE", WILEY.
C               --FORTRAN CODE WRITTEN FOR INCLUSION IN IBM
C                 RESEARCH REPORT RC20525, 'FORTRAN ROUTINES FOR
C                 USE WITH THE METHOD OF L-MOMENTS, VERSION 3',
C                 J. R. M. HOSKING, IBM RESEARCH DIVISION,
C                 T. J. WATSON RESEARCH CENTER, YORKTOWN HEIGHTS
C                 NEW YORK 10598, U.S.A., VERSION 3     AUGUST 1996
C               --HOSKING, ALGORITHM AS215   APPL. STATIST. (1985)
C                 VOL. 34, NO. 3, Modifications in AS R76 (1989)
C                 have been incorporated.
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2010/5
C     ORIGINAL VERSION--OCTOBER   2014
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      DIMENSION Y(*)
      DIMENSION TEMP1(*)
      DIMENSION TEMP2(*)
      DIMENSION TEMP3(*)
      DIMENSION TEMP4(*)
      DIMENSION TEMP5(*)
      DOUBLE PRECISION DTEMP1(*)
C
      DOUBLE PRECISION VARCOV(*)
      DOUBLE PRECISION XMOM(*)
C
      CHARACTER*4 IDFTTY
      CHARACTER*4 IGEVML
      CHARACTER*4 ISUBRO
      CHARACTER*4 IBUGA3
      CHARACTER*4 IERROR
C
      CHARACTER*4 IWRITE
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
      CHARACTER*4 ISTEPN
      CHARACTER*4 IGEPDF
      CHARACTER*4 ICASPL
C
      LOGICAL MLFLAG
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='EV2M'
      ISUBN2='L3  '
C
      ALOCML=CPUMIN
      SCALML=CPUMIN
      SHAPML=CPUMIN
C
      ALOCEP=CPUMIN
      SCALEP=CPUMIN
      SHAPEP=CPUMIN
C
      ALOCLM=CPUMIN
      SCALLM=CPUMIN
      SHAPLM=CPUMIN
C
      IWRITE='OFF'
      IERROR='NO'
C
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'2ML3')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,51)
   51   FORMAT('**** AT THE BEGINNING OF EV2ML3--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,52)IBUGA3,ISUBRO,IGEVML,MINMAX
   52   FORMAT('IBUGA3,ISUBRO,IGEVML,MINMAX = ',3(A4,2X),I5)
        CALL DPWRST('XXX','WRIT')
        DO56I=1,MIN(N,100)
          WRITE(ICOUT,57)I,Y(I)
   57     FORMAT('I,Y(I) = ',I8,G15.7)
          CALL DPWRST('XXX','WRIT')
   56   CONTINUE
      ENDIF
C
      IF(N.LE.4)THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,111)
  111   FORMAT('***** ERROR IN 3-PARAMETER FRECHET MAXIMUM ',
     1         'LIKELIHOOD--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,112)
  112   FORMAT('      THE NUMBER OF OBSERVATIONS FOR THE RESPONSE ',
     1         'VARIABLE IS LESS THAN 5.')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,113)N
  113   FORMAT('      SAMPLE SIZE = ',I8)
        CALL DPWRST('XXX','WRIT')
        IERROR='YES'
        GOTO9000
      ENDIF
C
C               ******************************************
C               **  STEP 1--                            **
C               **  CALL GEVML1 TO OBTAIN GEV PARAMETER **
C               **  ESTIMATES.                          **
C               ******************************************
C
      ISTEPN='1'
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'2ML3')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      CALL STMOM3(Y,N,IWRITE,XSKEW,IBUGA3,IERROR)
C
      MLFLAG=.TRUE.
CCCCC MLFLAG=.FALSE.
      IGEPDF='NULL'
      ICASPL='GEV'
      CALL GEVML1(Y,N,MAXNXT,MINMAX,ICASPL,MLFLAG,IGEPDF,
     1            ISEED,IDFTTY,IGEVML,
     1            TEMP1,TEMP2,TEMP3,TEMP4,TEMP5,
     1            DTEMP1,XMOM,NMOM,VARCOV,
     1            XMEAN,XSD,XVAR,XMIN,XMAX,
     1            ALOCLZ,SCALLZ,SHAPLZ,
     1            ALOCEZ,SCALEZ,SHAPEZ,
     1            ALOCMZ,SCALMZ,SHAPMZ,
     1            ISUBRO,IBUGA3,IERROR)
C
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'2ML3')THEN
        WRITE(ICOUT,1011)
 1011   FORMAT('**** AFTER CALL GEVML1')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,1013)ALOCLZ,SCALLZ,SHAPLZ
 1013   FORMAT('L-MOMENTS: ALOCLZ,SCALLZ,SHAPLZ = ',3G15.7)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,1015)ALOCEZ,SCALEZ,SHAPEZ
 1015   FORMAT('ELEMENTAL PERCENTILES: ALOCEZ,SCALEZ,SHAPEZ = ',3G15.7)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,1021)ALOCMZ,SCALMZ,SHAPMZ
 1021   FORMAT('MLE: ALOCMZ,SCALMZ,SHAPMZ = ',3G15.7)
        CALL DPWRST('XXX','WRIT')
      ENDIF
C
C               ******************************************
C               **  STEP 2--                            **
C               **  TRANSFORM ESTIMATES TO FRECHET      **
C               **  PARAMETERS                          **
C               ******************************************
C
      ISTEPN='2'
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'2ML3')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      IF(MINMAX.EQ.0 .OR. MINMAX.EQ.2)THEN
        IF(SHAPMZ.NE.CPUMIN)THEN
          SHAPML=-1.0/SHAPMZ
          SCALML=-SCALMZ/SHAPMZ
          ALOCML=ALOCMZ + SCALMZ/SHAPMZ
        ENDIF
        IF(SHAPLZ.NE.CPUMIN)THEN
          SHAPLM=-1.0/SHAPLZ
          SCALLM=-SCALLZ/SHAPLZ
          ALOCLM=ALOCLZ + SCALLZ/SHAPLZ
        ENDIF
        IF(SHAPEZ.NE.CPUMIN)THEN
          SHAPEP=-1.0/SHAPEZ
          SCALEP=-SCALEZ/SHAPEZ
          ALOCEP=ALOCEZ + SCALEZ/SHAPEZ
        ENDIF
      ELSE
        IF(SHAPMZ.NE.CPUMIN)THEN
          SHAPML=-1.0/SHAPMZ
          SCALML=-SCALMZ/SHAPMZ
          ALOCML=ALOCMZ - SCALMZ/SHAPMZ
        ENDIF
        IF(SHAPLZ.NE.CPUMIN)THEN
          SHAPLM=-1.0/SHAPLZ
          SCALLM=-SCALLZ/SHAPLZ
          ALOCLM=ALOCLZ - SCALLZ/SHAPLZ
        ENDIF
        IF(SHAPEZ.NE.CPUMIN)THEN
          SHAPEP=-1.0/SHAPEZ
          SCALEP=-SCALEZ/SHAPEZ
          ALOCEP=ALOCEZ - SCALEZ/SHAPEZ
        ENDIF
      ENDIF
C
 9000 CONTINUE
C
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'2ML3')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9011)
 9011   FORMAT('**** AT THE END OF EV2ML3--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9013)ALOCLM,SCALLM,SHAPLM
 9013   FORMAT('L-MOMENTS: ALOCLM,SCALLM,SHAPLM = ',3G15.7)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9015)ALOCEP,SCALEP,SHAPEP
 9015   FORMAT('ELEMENTAL PERCENTILES: ALOCEP,SCALEP,SHAPEP = ',3G15.7)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9021)ALOCML,SCALML,SHAPML
 9021   FORMAT('MLE: ALOCML,SCALML,SHAPML = ',3G15.7)
        CALL DPWRST('XXX','WRIT')
      ENDIF
C
      RETURN
      END
      SUBROUTINE EV2PDF(X,GAMMA,MINMAX,PDF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE PROBABILITY DENSITY
C              FUNCTION VALUE FOR THE EXTREME VALUE TYPE 2
C              DISTRIBUTION WITH SINGLE PRECISION 
C              TAIL LENGTH PARAMETER = GAMMA.
C              THE EXTREME VALUE TYPE 2 DISTRIBUTION USED
C              HEREIN IS DEFINED FOR ALL NON-NEGATIVE X,
C              AND HAS THE PROBABILITY DENSITY FUNCTION
C              FOR THE MAXIMUM ORDER STATISTIC
C              F(X) = GAMMA * (X**(-GAMMA-1)) * EXP(-(X**(-GAMMA))).
C              FOR THE MINIMUM ORDER STATISTIC
C              F(X) = GAMMA * ((-X)**(-GAMMA-1)) * EXP(-((-X)**(-GAMMA))).
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE 
C                                AT WHICH THE PROBABILITY DENSITY
C                                FUNCTION IS TO BE EVALUATED.
C                                X SHOULD BE NON-NEGATIVE.
C                     --GAMMA  = THE SINGLE PRECISION VALUE 
C                                OF THE TAIL LENGTH PARAMETER.
C                                GAMMA SHOULD BE POSITIVE.
C     OUTPUT ARGUMENTS--PDF    = THE SINGLE PRECISION PROBABILITY
C                                DENSITY FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION PROBABILITY DENSITY
C             FUNCTION VALUE PDF FOR THE EXTREME VALUE TYPE 2
C             DISTRIBUTION WITH TAIL LENGTH PARAMETER VALUE = GAMMA.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS. 
C     RESTRICTIONS--GAMMA SHOULD BE POSITIVE.
C                 --X SHOULD BE NON-NEGATIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--EXP.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN. 
C     REFERENCES--JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--1, 1970, PAGES 272-295.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING LABORATORY (205.03)
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE:  301-975-2855
C     ORIGINAL VERSION--APRIL     1994. 
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C-----COMMOMN---------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C---------------------------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      PDF=0.0
      IF(X.LT.0.0.AND.(MINMAX.EQ.2 .OR. MINMAX.EQ.0))THEN
        WRITE(ICOUT,4)
    4   FORMAT('***** WARNING--THE FIRST ARGUMENT TO EV2PDF IS ',
     1         'NEGATIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)X
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,47)MINMAX
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(X.GT.0.0.AND.MINMAX.EQ.1)THEN
        WRITE(ICOUT,5)
    5   FORMAT('***** WARNING--THE FIRST ARGUMENT TO EV2PDF IS ',
     1         'POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)X
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,47)MINMAX
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(GAMMA.LE.0.0)THEN
        WRITE(ICOUT,15) 
   15   FORMAT('***** ERROR--THE SECOND ARGUMENT TO EV2PDF ',
     1         'IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)GAMMA
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
   46 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7)
   47 FORMAT('***** THE VALUE OF MINMAX IS ',I5)
C
C-----START POINT-----------------------------------------------------
C
      IF(MINMAX.EQ.1)THEN
        PDF=GAMMA*((-X)**(-GAMMA-1.0))*EXP(-((-X)**(-GAMMA))) 
      ELSEIF(MINMAX.EQ.2 .OR. MINMAX.EQ.0)THEN
        PDF=GAMMA*(X**(-GAMMA-1.0))*EXP(-(X**(-GAMMA))) 
      ELSE
         WRITE(ICOUT,1800)
 1800    FORMAT('*****ERROR IN EV2PDF--MINMAX NOT 1 OR 2')
         CALL DPWRST('XXX','BUG ')
      END IF
C
 9000 CONTINUE
      RETURN
      END 
      SUBROUTINE EV2PPF(P,GAMMA,MINMAX,PPF)
CCCCC MINMAX ADDED TO ABOVE ARGUMENT LIST   MAY 1993
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE PERCENT POINT
C              FUNCTION VALUE FOR THE EXTREME VALUE TYPE 2
C              (= FRECHET)
C              DISTRIBUTION WITH SINGLE PRECISION
C              TAIL LENGTH PARAMETER = GAMMA.
C              THERE ARE 2 SUCH EV2 FAMILIES--
C                 ONE FOR THE MIN ORDER STAT (THE USUAL) AND
C                 ONE FOR THE MAX ORDER STAT.
C              (SEE SARHAN & GREENBERG, PAGE 69)
C              THE EV2 TYPE IS SPECIFIED VIA   MINMAX
C              FOR MINMAX = 1  (FOR THE MINIMUM)
C                 THE EV2 DISTRIBUTION USED
C                 HEREIN IS DEFINED FOR ALL NEGATIVE X,
C                 AND HAS THE PROBABILITY DENSITY FUNCTION
C                 F(X) = ...
C              FOR MINMAX = 2 (FOR THE DEFAULT MAXIMUM),
C                 THE EV2 DISTRIBUTION USED
C                 HEREIN IS DEFINED FOR ALL POSITIVE X,
C                 AND HAS THE PROBABILITY DENSITY FUNCTION
C               F(X) = GAMMA * (X**(-GAMMA-1)) * EXP(-(X**(-GAMMA))).
C              NOTE THAT THE PERCENT POINT FUNCTION OF A DISTRIBUTION
C              IS IDENTICALLY THE SAME AS THE INVERSE CUMULATIVE
C              DISTRIBUTION FUNCTION OF THE DISTRIBUTION.
C     INPUT  ARGUMENTS--P      = THE SINGLE PRECISION VALUE
C                                (BETWEEN 0.0 (EXCLUSIVELY)
C                                AND 1.0 (EXCLUSIVELY))
C                                AT WHICH THE PERCENT POINT
C                                FUNCTION IS TO BE EVALUATED.
C                     --GAMMA  = THE SINGLE PRECISION VALUE
C                                OF THE TAIL LENGTH PARAMETER.
C                                GAMMA SHOULD BE POSITIVE.
C                     --MINMAX = THE INTEGER VALUE
C                                IDENTIFYING THE
C                                CHOSEN WEIBULL DISTRIBUTION.
C                                1 = MIN, 2 = MAX.
C     OUTPUT ARGUMENTS--PPF    = THE SINGLE PRECISION PERCENT
C                                POINT FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION PERCENT POINT FUNCTION .
C             VALUE PPF FOR THE EXTREME VALUE TYPE 2 DISTRIBUTION
C             WITH TAIL LENGTH PARAMETER VALUE = GAMMA.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--GAMMA SHOULD BE POSITIVE.
C                 --P SHOULD BE BETWEEN 0.0 (EXCLUSIVELY)
C                   AND 1.0 (EXCLUSIVELY).
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--LOG.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--SARHAN & GREENBERG,
C                 CONTRIBUTIONS TO ORDER STATISTICS,
C                 1962, WILEY, PAGE 69.
C               --JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--1, 1970, PAGES 272-295.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1966)
C               EXCEPTION--HOLLERITH STRINGS IN FORMAT STATEMENTS
C                          DENOTED BY QUOTES RATHER THAN NH.
C     VERSION NUMBER--82/7
C     ORIGINAL VERSION--NOVEMBER  1975.
C     UPDATED         --DECEMBER  1981.
C     UPDATED         --MAY       1982.
C     UPDATED         --MAY       1993. REWRITTEN--ADD EV2/MAX DIST.
C     UPDATED         --JANUARY   1994. ADD MINMAX ERROR MESSAGE
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      PPF=0.0
      IF(P.LE.0.0.OR.P.GE.1.0)THEN
        WRITE(ICOUT,1)
    1   FORMAT('***** ERROR--THE FIRST ARGUMENT TO EV2PPF ',
     1         'IS OUTSIDE THE ALLOWABLE (0,1) INTERVAL')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)P
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(GAMMA.LE.0.0)THEN
        WRITE(ICOUT,15)
   15   FORMAT('***** ERROR--THE SECOND ARGUMENT TO EV2PPF IS ',
     1         'NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)GAMMA
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
   46 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7)
C
CCCCC THE FOLLOWING LINE WAS REWRITTEN    MAY 1993
CCCCC PPF=(-LOG(P))**(-1.0/GAMMA)
C
CCCCC THE FOLLOWING SECTION WAS REWRITTEN      JANUARY 1994
      IF(MINMAX.EQ.1)THEN
         PPF= (-(LOG(1.0/(1.0-P)))**(-1.0/GAMMA))
      ELSE IF(MINMAX.EQ.2 .OR. MINMAX.EQ.0)THEN
         PPF= (LOG(1.0/P))**(-1.0/GAMMA)
      ELSE
         WRITE(ICOUT,1800)
 1800    FORMAT('*****ERROR IN EV2PPF--MINMAX NOT 1 OR 2')
         CALL DPWRST('XXX','BUG ')
      ENDIF
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE EV2RAN(N,GAMMA,MINMAX,ISEED,X)
CCCCC MINMAX WAS ADDED TO THE ABOVE ARGUMENT LIST   MAY 1993
C
C     PURPOSE--THIS SUBROUTINE GENERATES A RANDOM SAMPLE OF SIZE N
C              FROM THE EXTREME VALUE TYPE 2 DISTRIBUTION
C              WITH TAIL LENGTH PARAMETER VALUE = GAMMA.
C              THE PROTOTYPE EXTREME VALUE TYPE 2 DISTRIBUTION USED
C              HEREIN IS DEFINED FOR ALL NON-NEGATIVE X,
C              AND HAS THE PROBABILITY DENSITY FUNCTION
C              F(X) = GAMMA * (X**(-GAMMA-1)) * EXP(-(X**(-GAMMA))).
C     INPUT  ARGUMENTS--N      = THE DESIRED INTEGER NUMBER
C                                OF RANDOM NUMBERS TO BE
C                                GENERATED.
C                     --GAMMA  = THE SINGLE PRECISION VALUE OF THE
C                                TAIL LENGTH PARAMETER.
C                                GAMMA SHOULD BE POSITIVE.
C                     --MINMAX = THE INTEGER VALUE
C                                IDENTIFYING THE
C                                CHOSEN WEIBULL DISTRIBUTION.
C                                1 = MIN, 2 = MAX.
C     OUTPUT ARGUMENTS--X      = A SINGLE PRECISION VECTOR
C                                (OF DIMENSION AT LEAST N)
C                                INTO WHICH THE GENERATED
C                                RANDOM SAMPLE WILL BE PLACED.
C     OUTPUT--A RANDOM SAMPLE OF SIZE N
C             FROM THE EXTREME VALUE TYPE 2 DISTRIBUTION
C             WITH TAIL LENGTH PARAMETER VALUE = GAMMA.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--THERE IS NO RESTRICTION ON THE MAXIMUM VALUE
C                   OF N FOR THIS SUBROUTINE.
C                 --GAMMA SHOULD BE POSITIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--UNIRAN.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--LOG.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--SARHAN & GREENBERG,
C                 CONTRIBUTIONS TO ORDER STATISTICS,
C                 1962, WILEY, PAGE 69.
C               --TOCHER, THE ART OF SIMULATION,
C                 1963, PAGES 14-15.
C               --HAMMERSLEY AND HANDSCOMB, MONTE CARLO METHODS,
C                 1964, PAGE 36.
C               --JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--1, 1970, PAGES 272-295.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1966)
C     VERSION NUMBER--82/7
C     ORIGINAL VERSION--NOVEMBER  1975.
C     UPDATED         --DECEMBER  1981.
C     UPDATED         --MAY       1982.
C     UPDATED         --MAY       1993. MINMAX
C     UPDATED         --JANUARY   1994. ADD MINMAX ERROR MESSAGE
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C---------------------------------------------------------------------
C
      DIMENSION X(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(N.LT.1)THEN
        WRITE(ICOUT, 5)
    5   FORMAT('***** ERROR--THE REQUESTED NUMBER OF RANDON ',
     1         'NUMBERS IN EV2RAN IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,47)N
   47   FORMAT('***** THE VALUE OF THE ARGUMENT IS ',I8)
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(GAMMA.LE.0.0)THEN
        WRITE(ICOUT,15)
   15   FORMAT('***** ERROR--THE SECOND ARGUMENT TO EV2RAN IS ',
     1         'NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)GAMMA
   46   FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7)
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
C
C     GENERATE N UNIFORM (0,1) RANDOM NUMBERS;
C
      CALL UNIRAN(N,ISEED,X)
C
C     GENERATE N EXTREME VALUE TYPE 2 DISTRIBUTION RANDOM NUMBERS
C     USING THE PERCENT POINT FUNCTION TRANSFORMATION METHOD.
C
CCCCC THE FOLLOWING SECTION WAS REWRITTEN    MAY 1993
CCCCC DO100I=1,N
CCCCC X(I)=(-LOG(X(I)))**(-1.0/GAMMA)
CC100 CONTINUE
C
CCCCC THE FOLLOWING SECTION WAS REWRITTEN      JANUARY 1994
      IF(MINMAX.EQ.1)THEN
         DO100I=1,N
         X(I)= (-(LOG(1.0/(1.0-X(I))))**(-1.0/GAMMA))
  100    CONTINUE
      ELSE IF(MINMAX.EQ.2 .OR. MINMAX.EQ.0)THEN
         DO200I=1,N
         X(I)= (LOG(1.0/X(I)))**(-1.0/GAMMA)
  200    CONTINUE
      ELSE
         WRITE(ICOUT,1800)
 1800    FORMAT('*****ERROR IN EV2RAN--MINMAX NOT 1 OR 2')
         CALL DPWRST('XXX','BUG ')
      ENDIF
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE EVALM(IW2,IW22,W2,ITYPE,ISTART,ISTOP,IANGLU,ANS,
     1                 SAVE1,SAVE2,SAVE3,SAVE4,SAVE5,SAVE6,SAVE7,SAVE8,
     1                 ILIBC1,ILIBC2,IBUGEV,IERROR)
C
C     PURPOSE--EVALUATE A STRING OF CODE THAT CONTAINS ONLY
C              VALUES, OPERATIONS, AND LIBRARY FUNCTIONS.
C     NOTE--THE DECEMBER UPDATE AUGMENTED THE USUAL MATH LIBRARY WITH
C           ARCSIN, ARCCOS, ARCTAN, OCTAL
C     NOTE--THE UPDATE WHICH ALLOWS 2 ARGUMENTS AND 3 ARGUMENTS
C           AS IN TCDF, CHSCDF, FCDF, ETC. HAS THE FOLLOWING RESTRICTIONS--
C           1) NO EXPRESSIONS FOR ARGUMENTS (MAYBE FOR FIRST)
C           2) NO NEGATIVE ARGUMENTS FOR SECOND AND THIRD ARGUMENTS
C              (FORTUNATELY THIS LAST RESTRICTION IS NO RESTRICTION
C              AT ALL FOR THE T, CHI-SQUARED, AND F DISTRIBUTIONS
C             BECAUSE THEY REQUIRE POSITIVE DEGREES OF FREEDOM ANYWAY.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--82/7
C     ORIGINAL VERSION--NOVEMBER 1, 1976.
C     UPDATED--DECEMBER 21, 1977.
C     UPDATED--DECEMBER 28, 1977.
C     UPDATED         --JULY      1978.
C     UPDATED         --JULY      1978.
C     UPDATED         --OCTOBER   1978.
C     UPDATED         --JANUARY   1979.
C     UPDATED         --FEBRUARY  1979.
C     UPDATED         --JUNE      1979.
C     UPDATED         --JULY      1979.
C     UPDATED         --FEBRUARY  1981.
C     UPDATED         --JUNE      1981.
C     UPDATED         --JULY      1981.
C     UPDATED         --SEPTEMBER 1981.
C     UPDATED         --DECEMBER  1981.
C     UPDATED         --MAY       1982.
C     UPDATED         --MARCH     1989.  SAVE3 ARGUMENT (FOR JULIA SETS)
C     UPDATED         --JUNE      1989.  UNDERFLOW SET TO 0 FOR * AND /
C     UPDATED         --MAY       1994.  SET SAVE2 AND SAVE3 TO -99.9
C                                        TO AVOID FCDF ERROR WITH
C                                        TOO FEW ARGUMENTS.
C     UPDATED         --SEPTEMBER 1994.  ADD SAVE4 ARGUMENT FOR DNFCDF
C     UPDATED         --APRIL     1995.  INITIALIZE SAVE1 ... SAVE4
C                                        (BUG IN HEAVE FUNCTION, WHERE
C                                        ARGUMENTS OPTIONAL)
C                                        ALSO, BUG IN FOLLOWING
C                                        LET A = TPDF(X,2) - TPDF(X,3)
C                                        BOTH USE 2 FOR SECOND ARG.
C     UPDATED         --SEPTEMBER 1997.  WORKAROUND FOR "**" OPERATION
C                                        (BUG IN OLD LAHEY COMPILER)
C     UPDATED         --MAY       1998.  ADD SAVE5
C     UPDATED         --NOVEMBER  1998.  FIX FOR 0**(POSITIVE NUMB)
C     UPDATED         --JUNE      2003.  ADD SAVE6, SAVE7, SAVE8
C     UPDATED         --AUGUST    2020.  FIX BUG FOR (-2)**2
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 IW2(*)
      CHARACTER*4 IW22(*)
      CHARACTER*4 ITYPE(*)
      CHARACTER*4 IANGLU
      CHARACTER*4 IBUGEV
      CHARACTER*4 IERROR
C
C
C---------------------------------------------------------------------
C
      DIMENSION W2(*)
C
CCCCC FOLLOWING SECTION ADDED APRIL 1995.
      DIMENSION SAVE1(*)
      DIMENSION SAVE2(*)
      DIMENSION SAVE3(*)
      DIMENSION SAVE4(*)
      DIMENSION SAVE5(*)
      DIMENSION SAVE6(*)
      DIMENSION SAVE7(*)
      DIMENSION SAVE8(*)
C
      DIMENSION TERM(80)
      DIMENSION IOP(80)
      CHARACTER*4 IOP
C
CCCCC FOLLOWING LINE FOR LAHEY BUG.  SEPTEMBER 1997.
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOHO.INC'
      INCLUDE 'DPCOP2.INC'
C
C-----DATA STATEMENTS-------------------------------------------------
C
C     DEFINE THE UPPER LIMIT OF THE NUMBER OF 'TERMS' THAT THIS
C     SUBROUTINE CAN PROCESS.  THIS IS USUALLY THE SAME AS THE MAX
C     NUMBER OF CHARACTERS THAT MAY BE PROCESSED BY THE COMPIM SUBROUTINE
C     IF RESTRICT THE FUNCTIONAL EXPRESSION TO 1 LINE IMAGE, THEN A
C     REASONABLE UPPER BOUND IS 80.  WHATEVER UPPER BOUND IS SET, THE
C     DIMENSIONS OF THE VECTORS TERM(.) AND IOP(.),  USED HEREIN
C     MUST BE EQUAL OR LARGER TO THIS NUMBER.
C
      DATA MAXTER/80/
C
C-----START POINT-----------------------------------------------------
C
      ANS=0.0
      IERROR='NO'
C
      CUTOFF=0.00001
      AIABS2=(-999.0)
      ALCPUM=LOG(CPUMAX)
C
C     CHECK THAT THE INPUT PARAMETERS ISTART AND ISTOP)
C     ARE BOTH AT LEAST 1 AND BOTH AT MOST MAXTER
C     (WHERE MAXTER IS THE INTERNALLY DEFINED VARIABLE
C     WHICH CONTROLS DIMENSION SIZES AND WHICH
C     TYPICALLY HAS THE VALUE 80).
C     ALSO CHECK THAT ISTART DOES NOT EXCEED ISTOP.
C
      IF(ISTART.LT.1.OR.MAXTER.LT.ISTART)GOTO20
      IF(ISTOP.LT.1.OR.MAXTER.LT.ISTOP)GOTO20
      IF(ISTOP.LT.ISTART)GOTO20
      GOTO39
   20 CONTINUE
      WRITE(ICOUT,21)
   21 FORMAT('***** ERROR IN EVALM--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,22)
   22 FORMAT('      ILLEGAL VALUES FOR THE INPUT PARAMETERS ISTART ',
     1       'AND/OR ISTOP.')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,24)MAXTER
   24 FORMAT('      BOTH ISTART AND ISTOP MUST BE AT LEAST 1 AND AT ',
     1       'MOST ',I5,'.')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,28)
   28 FORMAT('      ALSO, ISTART MUST BE LESS THAN OR EQUAL TO ',
     1       'ISTOP.')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,30)ISTART
   30 FORMAT('      ISTART = ',I8)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,31)ISTOP
   31 FORMAT('      ISTOP  = ',I8)
      CALL DPWRST('XXX','BUG ')
      IERROR='YES'
      GOTO9000
   39 CONTINUE
C
      IF(IBUGEV.EQ.'ON')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,51)
   51   FORMAT('***** AT THE BEGINNING OF EVALM--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,52)ISTART,ISTOP,IBUGEV,IANGLU
   52   FORMAT('ISTART,ISTOP,IBUGEV,IANGLU = ',2I6,2(2X,A4))
        CALL DPWRST('XXX','BUG ')
        DO53I=ISTART,ISTOP
          WRITE(ICOUT,54)I,IW2(I),IW22(I),W2(I),ITYPE(I)
   54     FORMAT('I,IW2(I),IW22(I),W2(I),ITYPE(I) = ',I8,2(2X,A4),
     1           F15.7,2X,A4)
          CALL DPWRST('XXX','BUG ')
   53   CONTINUE
        WRITE(ICOUT,58)SAVE1(1),SAVE2(1),SAVE3(1),SAVE4(1)
   58   FORMAT('I=1,SAVE1,SAVE2,SAVE3,SAVE4 = ',4E15.7)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
C     BLANK-OUT THE IOP(.) VECTOR AND ZERO-OUT THE TERM(.) VECTOR.
C
      DO110I=1,MAXTER
        TERM(I)=0.0
        IOP(I)='    '
  110 CONTINUE
C
C               *********************************************************
C               **  STEP 1--                                           **
C               **  OPERATE ON THE VECTORS IW2(.) AND IW22(.).         **
C               **  THEY SHOULD CONTAIN NO PARENTHESES.                **
C               **  THEY SHOULD CONTAIN ONLY--                         **
C               **       NUMBERS                                       **
C               **       X VALUES                                      **
C               **       PARAMETER VALUES                              **
C               **       PREVIOUSLY COMPUTED VALUES                    **
C               **       OPERATIONS (5--+ - * / **)                    **
C               **       LIBRARY FUNCTIONS.                            **
C               **  COPY THE NUMBERS, X VALUES, PARAMETER VALUES, AND  **
C               **  PREVIOUSLY COMPUTED VALUES OVER TO THE TERM VECTOR.**
C               **  COPY THE OPERATIONS OVER TO THE OPERATIONS VECTOR. **
C               **  ELIMINATE THE LIBRARY FUNCTIONS BY EVALUATING THEM **
C               **  WITH THE NEXT POTENTIAL TERM AND PUTTING           **
C               **  THE EVALUATED RESULT INTO THAT NEXT TERM.          **
C               **  OUTPUT THE VECTOR TERMS(.) AND THE VECTOR IOP(.)   **
C               **  WHICH CONTAIN TERMS AND OPERATIONS RESPECTIVELY.   **
C               *********************************************************
C
      IF(ITYPE(ISTOP).EQ.'OP')THEN
        WRITE(ICOUT,21)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,121)ITYPE(ISTOP)
  121   FORMAT('      LAST TERM IN AN INTERMEDIATE EXPRESSION = AN ',
     1         'OPERATION = ',A4)
        CALL DPWRST('XXX','BUG ')
        IERROR='YES'
        GOTO9000
      ELSEIF(ITYPE(ISTOP).EQ.'LF')THEN
        WRITE(ICOUT,21)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,123)ITYPE(ISTOP)
  123   FORMAT('      LAST TERM IN AN INTERMEDIATE EXPRESSION = A ',
     1         'LIBRARY FUNCTION = ',A4)
        CALL DPWRST('XXX','BUG ')
        IERROR='YES'
        GOTO9000
      ENDIF
C
      NOP=0
      NTERM=0
      NUMSAV=0
      I=ISTART
C
  150 CONTINUE
      IDEL=1
      IP1=I+1
      IP2=I+2
      IP3=I+3
      IP4=I+4
      IP5=I+5
      IF(ITYPE(I).EQ.'N'   .OR. ITYPE(I).EQ.'X' .OR.
     1   ITYPE(I).EQ.'PAR' .OR. ITYPE(I).EQ.'V')THEN
        IF(NUMSAV.LT.1)THEN
          NTERM=NTERM+1
          TERM(NTERM)=W2(I)
          IOP(NTERM)='V'
        ELSEIF(NUMSAV.EQ.1)THEN
          SAVE1(ILIBC1)=W2(I)
        ELSEIF(NUMSAV.EQ.2)THEN
         SAVE2(ILIBC1)=W2(I)
        ELSEIF(NUMSAV.EQ.3)THEN
         SAVE3(ILIBC1)=W2(I)
        ELSEIF(NUMSAV.EQ.4)THEN
          SAVE4(ILIBC1)=W2(I)
        ELSEIF(NUMSAV.EQ.5)THEN
          SAVE5(ILIBC1)=W2(I)
        ELSEIF(NUMSAV.EQ.6)THEN
          SAVE6(ILIBC1)=W2(I)
        ELSEIF(NUMSAV.EQ.7)THEN
          SAVE7(ILIBC1)=W2(I)
        ELSEIF(NUMSAV.EQ.8)THEN
          SAVE8(ILIBC1)=W2(I)
        ENDIF
        GOTO100
      ELSEIF(ITYPE(I).EQ.'OP')THEN
        IF(IW2(I).EQ.'+' .OR. IW2(I).EQ.'-')THEN
          NOP=NOP+1
          IOP(NOP)=IW2(I)
          IF(NTERM.EQ.0)TERM(1)=0.0
          IF(NTERM.EQ.0)NTERM=1
          GOTO100
        ELSEIF(IW2(I).EQ.'*' .OR. IW2(I).EQ.'/' .OR.
     1         IW2(I).EQ.'**')THEN
          NOP=NOP+1
          IOP(NOP)=IW2(I)
          IF(NTERM.EQ.0)THEN
            WRITE(ICOUT,322)
  322       FORMAT('      *, /, OR ** STARTS AN EXPRESSION')
            CALL DPWRST('XXX','BUG ')
            IERROR='YES'
            GOTO9000
          ENDIF
          GOTO100
        ELSE
          WRITE(ICOUT,21)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,305)
  305     FORMAT('      NOT ONE OF THE 5 OPERATIONS:  + - * / **')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,306)I,IW2(I),IW22(I)
  306     FORMAT('      I,IW2(I),IW22(I) = ',I8,2(2X,A4))
          CALL DPWRST('XXX','BUG ')
          IERROR='YES'
          GOTO9000
        ENDIF
      ELSEIF(
     1  (ITYPE(I).EQ.'LF'.AND.ITYPE(IP1).EQ.'V') .OR.
     1  (ITYPE(I).EQ.'LF'.AND.ITYPE(IP1).EQ.'N') .OR.
     1  (ITYPE(I).EQ.'LF'.AND.ITYPE(IP1).EQ.'X') .OR.
     1  (ITYPE(I).EQ.'LF'.AND.ITYPE(IP1).EQ.'PAR'))THEN
        GOTO400
      ELSEIF(ITYPE(I).EQ.'COM')THEN
        NUMSAV=NUMSAV+1
        GOTO100
      ELSE
        WRITE(ICOUT,21)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,105)
  105   FORMAT('      UNKNOWN ARGUMENT/OPERATION TYPE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,106)I,ITYPE(I)
  106   FORMAT('      I,ITYPE(I) = ',I8,2X,A4)
        CALL DPWRST('XXX','BUG ')
        IERROR='YES'
        GOTO9000
      ENDIF
C
  400 CONTINUE
C
C     PERFORM A LIBRARY FUNCTION EVALUATION.
C
      IF(IBUGEV.EQ.'ON')THEN
        WRITE(ICOUT,331)
  331   FORMAT('IN EVALM, BEFORE ENTERING DPLIBF--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,332)IW2(I),IW22(I),W2(IP1),IBUGEV
  332   FORMAT('IW2(I),IW22(I),W2(IP1),IBUGEV = ',2(A4,2X),F10.5,2X,A4)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
      ILIBC2=ILIBC2+1
      IF(ILIBC2.GT.0)THEN
        ASAV1=SAVE1(ILIBC2)
        ASAV2=SAVE2(ILIBC2)
        ASAV3=SAVE3(ILIBC2)
        ASAV4=SAVE4(ILIBC2)
        ASAV5=SAVE5(ILIBC2)
        ASAV6=SAVE6(ILIBC2)
        ASAV7=SAVE7(ILIBC2)
        ASAV8=SAVE8(ILIBC2)
      ELSE
        ASAV1=0.0
        ASAV2=0.0
        ASAV3=0.0
        ASAV4=0.0
        ASAV5=0.0
        ASAV6=0.0
        ASAV7=0.0
        ASAV8=0.0
      ENDIF
      CALL DPLIBF(IW2(I),IW22(I),W2(IP1),ASAV1,ASAV2,ASAV3,ASAV4,
     1            ASAV5,ASAV6,ASAV7,ASAV8,
     1            I,
     1            IANGLU,RESULT,IBUGEV,IERROR)
C
      IF(IBUGEV.EQ.'ON')THEN
        WRITE(ICOUT,333)
  333   FORMAT('IN EVALM, AFTER RETURNING FROM DPLIBF--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,334)RESULT,IERROR
  334   FORMAT('RESULT, IERROR = ',F20.10,2X,A4)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
      IF(IERROR.EQ.'YES')GOTO9000
      NTERM=NTERM+1
      TERM(NTERM)=RESULT
C
      IOP(NTERM)='V'
C
C     CHECK THAT NTERM HAS NOT EXCEEDED MAXTER (USUALLY 80)
C
      IF(NTERM.GT.MAXTER)THEN
        WRITE(ICOUT,21)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1902)
 1902   FORMAT('      THE VARIABLE NTERM HAS JUST EXCEEDED THE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1903)MAXTER
 1903   FORMAT('      THE MAXIMUM ALLOWABLE LIMIT OF ',I5)
        CALL DPWRST('XXX','BUG ')
        IERROR='YES'
        GOTO9000
      ENDIF
C
      IDEL=2
  100 CONTINUE
      I=I+IDEL
      IF(I.LE.ISTOP)GOTO150
C
      IF(IBUGEV.EQ.'ON')THEN
        WRITE(ICOUT,491)
  491   FORMAT('AFTER THE LIBRARY FUNCTIONS HAVE BEEN ',
     1         'EVALUATED AND ELIMINATED--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,492)NTERM,NOP
  492   FORMAT('NTERM,NOP = ',2I6)
        CALL DPWRST('XXX','BUG ')
        DO493I=1,NTERM
          WRITE(ICOUT,494)I,TERM(I),IOP(I)
  494     FORMAT('I,TERM(I),IOP(I) = ',I6,E15.7,2X,A4)
          CALL DPWRST('XXX','BUG ')
  493   CONTINUE
      ENDIF
C
C               *******************************************************
C               **  STEP 2--                                         **
C               **  CHECK TO SEE THAT THE NUMBER OF TERMS =          **
C               **  ONE MORE THAN THE NUMBER OF OPERATIONS.          **
C               **  ALSO CHECK TO SEE IF THE SPECIAL CASE            **
C               **  EXISTS WHERE THERE IS ONLY 1 TERM--              **
C               **  IF SO, SET ANS = TO THIS FIRST TERM AND EXIT.    **
C               *******************************************************
C
      NOPP1=NOP+1
      IF(NTERM.EQ.NOPP1)THEN
        IF(NTERM.EQ.1)THEN
          ANS=TERM(1)
          GOTO9000
        ELSEIF(NTERM.EQ.0)THEN
          WRITE(ICOUT,21)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,571)
  571     FORMAT('      NUMBER OF TERMS = 0 AT END OF STEP 2 ',
     1           '(LIBRARY FUNCTIONS ELIMINATED)')
          CALL DPWRST('XXX','BUG ')
          IERROR='YES'
          GOTO9000
        ENDIF
      ELSE
        WRITE(ICOUT,21)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,560)
  560   FORMAT('      NUMBER OF TERMS NOT EQUAL TO NUMBER OF ',
     1         'OPERATIONS + 1')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,566)NTERM,NOPP1
  566   FORMAT('      NTERM,NOPP1 = ',I8,2X,I8)
        CALL DPWRST('XXX','BUG ')
        IERROR='YES'
        GOTO9000
      ENDIF
C
C               ********************************************************
C               **  STEP 3--                                          **
C               **  OPERATE ON THE TERM(.) AND IOP(.) VECTORS.  AT    **
C               **  THIS POINT WE HAVE ONLY ALTERNATING TERMS AND     **
C               **  OPERATIONS WHERE AN OPERATION IS ANY ONE OF THE   **
C               **  5-- +   -   *   /   **.  EVALUATE AND ELIMINATE   **
C               **  ALL SQUEEZE THE TERM(.) AND IOP(.) VECTORS UNTIL  **
C               **  UNTIL ALL ** ARE GONE.                            **
C               ********************************************************
C
      I=1
 1100 CONTINUE
      IF(IOP(I).NE.'**')THEN
        I=I+1
        IF(I.LE.NOP)GOTO1100
        GOTO1500
      ENDIF
C
      IP1=I+1
      T1=TERM(I)
      T2=TERM(IP1)
      T3=ABS(T1)
      T4=ABS(T2)
      T34=0.0
      IF(T3.GT.0.0.AND.T4.GT.0.0)T34=T4*LOG(T3)
C
      IF(IBUGEV.EQ.'ON')THEN
        WRITE(ICOUT,601)I,IP1
  601   FORMAT('AT 1100: I,IP1 = ',2I8)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,603)T1,T2,T3,T4,T34,ALCPUM
  603   FORMAT('T1,T2,T3,T4,T34,ALCPUM = ',6G15.7)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
      IF(T34.GT.ALCPUM)GOTO8011
      IF(T1.NE.CPUMIN.AND.T1.NE.CPUMAX.AND.
     1   T2.NE.CPUMIN.AND.T2.NE.CPUMAX)GOTO1219
      IF(T1.EQ.CPUMIN.AND.T4.LE.1.0)GOTO1219
      IF(T2.EQ.CPUMIN.AND.T3.LE.1.0)GOTO1219
      IF(T1.EQ.CPUMAX.AND.T4.LE.1.0)GOTO1219
      IF(T2.EQ.CPUMAX.AND.T3.LE.1.0)GOTO1219
      GOTO8011
C
 1219 CONTINUE
C
      IF(IBUGEV.EQ.'ON')THEN
        WRITE(ICOUT,611)
  611   FORMAT('AT 1219')
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
      IF(T1.EQ.0.0)THEN
        IF(T2.GT.0.0)THEN
          TERM(I)=0.0
          GOTO1239
        ENDIF
C
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,21)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1222)
 1222   FORMAT('      ATTEMPT TO RAISE A ZERO NUMBER ')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1223)
 1223   FORMAT('      TO A ZERO OR NEGATIVE POWER.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1226)T2
 1226   FORMAT('      THE POWER           = ',E15.7)
        CALL DPWRST('XXX','BUG ')
        IERROR='YES'
        GOTO9000
      ELSEIF(T1.LT.0.0)THEN
C
        IF(IBUGEV.EQ.'ON')THEN
          WRITE(ICOUT,631)CUTOFF
  631     FORMAT('AT T1 LESS THAN ZERO CASE: CUTOFF = ',G15.7)
          CALL DPWRST('XXX','BUG ')
        ENDIF
C
        ABST2=ABS(T2)
        ISIGN=(-1)
        IF(T2.GE.0.0)ISIGN=1
        IABST2=INT(ABST2)
        IABS2=IABST2
CCCCC   2020/08: FIX FOLLOWING LINE
CCCCC   REM=ABST2-AIABS2
        REM=ABST2-REAL(IABS2)
        ABSREM=ABS(REM)
C
        IF(IBUGEV.EQ.'ON')THEN
          WRITE(ICOUT,633)ISIGN,IABST2,IABS2,ABST2,REM,ABSREM
  633     FORMAT('ISIGN,IABST2,IABS2,ABST2,REM,ABSREM = ',3I8,3G15.7)
          CALL DPWRST('XXX','BUG ')
        ENDIF
C
        IF(ABSREM.GE.CUTOFF)THEN
          WRITE(ICOUT,999)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,21)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,1232)
 1232     FORMAT('      ATTEMPT TO RAISE A NEGATIVE NUMBER ')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,1233)
 1233     FORMAT('      TO A FRACTIONAL POWER.')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,1235)T1
 1235     FORMAT('      THE NEGATIVE NUMBER = ',E15.7)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,1236)T2
 1236     FORMAT('      THE POWER           = ',E15.7)
          CALL DPWRST('XXX','BUG ')
          IERROR='YES'
          GOTO9000
        ENDIF
C
        IF(IBUGEV.EQ.'ON')THEN
          WRITE(ICOUT,7777)T1,T2,ABST2,ISIGN,IABST2
 7777     FORMAT('T1,T2,ABST2,ISIGN,IABST2 = ',3E15.7,2I8)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,7778)AIABS2,REM,ABSREM,TERM(I)
 7778     FORMAT('AIABS2,REM,ABSREM,TERM(I) = ',4E15.7)
          CALL DPWRST('XXX','BUG ')
        ENDIF
C
        TERM(I)=TERM(I)**(ISIGN*IABST2)
        GOTO1239
      ENDIF
C
      IF(IBUGEV.EQ.'ON')THEN
        WRITE(ICOUT,1238)I,TERM(I),TERM(IP1),T1,T2,AIABS2,REM
 1238   FORMAT('I,TERM(I),TERM(IP1),T1,T2,AIABS2,REM = ',I4,6E15.7)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
CCCCC FOLLOWING LINE SEEMS TO SHOW A COMPILER BUG FOR THE OLDER LAHEY
CCCCC COMPILER.  WORKAROUND FOR THIS COMPILER.   SEPTEMBER 1997.
CCCCC TERM(I)=TERM(I)**TERM(IP1)
      IF(ICOMPI.NE.'LAHE')THEN
        TERM(I)=TERM(I)**TERM(IP1)
      ELSE
        ATEMP1=TERM(IP1)*LOG(TERM(I))
        TERM(I)=EXP(ATEMP1)
      ENDIF
C
 1239 CONTINUE
      NOPM1=NOP-1
      IF(I.LT.NOP)THEN
        DO1400J=I,NOPM1
          JP1=J+1
          JP2=J+2
          IOP(J)=IOP(JP1)
          TERM(JP1)=TERM(JP2)
 1400   CONTINUE
      ENDIF
      NOP=NOPM1
      IF(I.LE.NOP)GOTO1100
C
 1500 CONTINUE
      NTERM=NOP+1
C
      IF(IBUGEV.EQ.'ON')THEN
        WRITE(ICOUT,1991)
 1991   FORMAT('AFTER THE ** HAVE BEEN EVALUATED AND ELIMINATED--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1992)NTERM,NOP
 1992   FORMAT('NTERM,NOP = ',2I6)
        CALL DPWRST('XXX','BUG ')
        DO1993I=1,NTERM
          WRITE(ICOUT,1994)I,TERM(I),IOP(I)
 1994     FORMAT('I,TERM(I),IOP(I) = ',I6,E15.7,2X,A4)
          CALL DPWRST('XXX','BUG ')
 1993   CONTINUE
      ENDIF
C
C               ********************************************************
C               **  STEP 4--                                          **
C               **  OPERATE ON THE TERM(.) AND IOP(.) VECTORS. AT     **
C               **  THIS POINT WE HAVE ONLY ALTERNATING TERMS AND     **
C               **  OPERATIONS WHERE AN OPERATION IS ANY ONE OF THE   **
C               **  4-- +   -   *   /   .                             **
C               **  EVALUATE AND ELIMINATE ALL * AND / IN SEQUENCE.   **
C               **  SQUEEZE THE TERM(.) AND IOP(.) VECTORS UNTIL      **
C               **  UNTIL ALL * AND / ARE GONE.                       **
C               ********************************************************
C
      I=1
 2100 CONTINUE
      IF(IOP(I).EQ.'*')THEN
        IP1=I+1
        T1=TERM(I)
        T2=TERM(IP1)
        T3=ABS(T1)
        T4=ABS(T2)
        T34=0.0
        IF(T3.GT.0.0.AND.T4.GT.0.0)T34=LOG(T3)+LOG(T4)
        IF(T34.GT.ALCPUM)GOTO8011
        IF(T34.LT.-ALCPUM)TERM(I)=0.0
        IF(T34.LT.-ALCPUM)GOTO2250
        IF(T1.NE.CPUMIN.AND.T1.NE.CPUMAX.AND.
     1     T2.NE.CPUMIN.AND.T2.NE.CPUMAX)GOTO2219
        IF(T1.EQ.CPUMIN.AND.T4.LE.1.0)GOTO2219
        IF(T2.EQ.CPUMIN.AND.T3.LE.1.0)GOTO2219
        IF(T1.EQ.CPUMAX.AND.T4.LE.1.0)GOTO2219
        IF(T2.EQ.CPUMAX.AND.T3.LE.1.0)GOTO2219
        GOTO8011
C
 2219   CONTINUE
        TERM(I)=TERM(I)*TERM(IP1)
        GOTO2250
      ELSEIF(IOP(I).EQ.'/')THEN
        IP1=I+1
        T1=TERM(I)
        T2=TERM(IP1)
        T3=ABS(T1)
        T4=ABS(T2)
        T34=0.0
        IF(T3.GT.0.0.AND.T4.GT.0.0)T34=LOG(T3)-LOG(T4)
        IF(T34.GT.ALCPUM)GOTO8011
        IF(T34.LT.-ALCPUM)TERM(I)=0.0
        IF(T34.LT.-ALCPUM)GOTO2250
        IF(T1.NE.CPUMIN.AND.T1.NE.CPUMAX.AND.
     1     T2.NE.CPUMIN.AND.T2.NE.CPUMAX)GOTO2229
        IF(T1.EQ.CPUMIN.AND.T4.GE.1.0)GOTO2229
        IF(T1.EQ.CPUMAX.AND.T4.GE.1.0)GOTO2229
        GOTO8011
C
 2229  CONTINUE
        IF(T2.EQ.0.0)THEN
          WRITE(ICOUT,999)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,21)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,2232)
 2232     FORMAT('      ATTEMPT TO DIVIDE A NUMBER BY ZERO.')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,2235)T1
 2235     FORMAT('      THE NUMERATOR   = ',E15.7)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,2236)T2
 2236     FORMAT('      THE DENOMINATOR = ',E15.7)
          CALL DPWRST('XXX','BUG ')
          IERROR='YES'
          GOTO9000
        ENDIF
C
        TERM(I)=TERM(I)/TERM(IP1)
        GOTO2250
      ELSE
        I=I+1
        GOTO2350
      ENDIF
C
 2250 CONTINUE
      NOPM1=NOP-1
      IF(I.LT.NOP)THEN
        DO2400J=I,NOPM1
          JP1=J+1
          JP2=J+2
          IOP(J)=IOP(JP1)
          TERM(JP1)=TERM(JP2)
 2400   CONTINUE
      ENDIF
      NOP=NOPM1
C
 2350 CONTINUE
      IF(I.LE.NOP)GOTO2100
      NTERM=NOP+1
C
      IF(IBUGEV.EQ.'ON')THEN
        WRITE(ICOUT,2991)
 2991   FORMAT('AFTER THE * AND / HAVE BEEN EVALUATED AND ELIMINATED--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,2992)NTERM,NOP
 2992   FORMAT('NTERM,NOP = ',2I6)
        CALL DPWRST('XXX','BUG ')
        DO2993I=1,NTERM
          WRITE(ICOUT,2994)I,TERM(I),IOP(I)
 2994     FORMAT('I,TERM(I),IOP(I) = ',I6,E15.7,2X,A4)
          CALL DPWRST('XXX','BUG ')
 2993   CONTINUE
      ENDIF
C
C               ********************************************************
C               **  STEP 5--                                          **
C               **  OPERATE ON THE TERM(.) AND IOP(.) VECTORS.  AT    **
C               **  THIS POINT WE HAVE ONLY ALTERNATING TERMS AND     **
C               **  OPERATIONS WHERE AN OPERATION IS ANY ONE OF THE   **
C               **  2-- + OR - .  EVALUATE ALL + OR - OPERATIONS IN   **
C               **  SEQUENCE.  SQUEEZE THE TERM(.) AND IOP(.) VECTORS **
C               **  UNTIL ALL + AND - OPERATIONS ARE GONE.            **
C               ********************************************************
C
      IF(NOP.LT.1)THEN
        ANS=TERM(1)
        GOTO9000
      ENDIF
      ANS=TERM(1)
      DO3200I=1,NOP
        IP1=I+1
        IF(IOP(I).EQ.'-')THEN
          T1=TERM(I)
          T2=TERM(IP1)
          IF(T1.NE.CPUMIN.AND.T1.NE.CPUMAX.AND.
     1       T2.NE.CPUMIN.AND.T2.NE.CPUMAX)GOTO3229
          IF(T1.EQ.CPUMIN.AND.T2.LE.0.0)GOTO3229
          IF(T2.EQ.CPUMIN.AND.T1.LE.0.0)GOTO3229
          IF(T1.EQ.CPUMAX.AND.T2.GE.0.0)GOTO3229
          IF(T2.EQ.CPUMAX.AND.T1.GE.0.0)GOTO3229
          GOTO8011
 3229     CONTINUE
          ANS=ANS-TERM(IP1)
        ELSE
          T1=TERM(I)
          T2=TERM(IP1)
          IF(T1.NE.CPUMIN.AND.T1.NE.CPUMAX.AND.
     1       T2.NE.CPUMIN.AND.T2.NE.CPUMAX)GOTO3219
          IF(T1.EQ.CPUMIN.AND.T2.GE.0.0)GOTO3219
          IF(T2.EQ.CPUMIN.AND.T1.GE.0.0)GOTO3219
          IF(T1.EQ.CPUMAX.AND.T2.LE.0.0)GOTO3219
          IF(T2.EQ.CPUMAX.AND.T1.LE.0.0)GOTO3219
          GOTO8011
 3219     CONTINUE
          ANS=ANS+TERM(IP1)
        ENDIF
C
 3200 CONTINUE
      GOTO9000
C
 8011 CONTINUE
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,21)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,8013)
 8013 FORMAT('      ATTEMPT TO CARRY OUT AN OPERATION WHICH RESULTS')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,8014)
 8014 FORMAT('      IN AN OUT-OF-RANGE NUMBER.')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,8015)
 8015 FORMAT('      THE OPERATION      = **')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,8016)T1
 8016 FORMAT('      THE FIRST  OPERAND = ',E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,8017)T2
 8017 FORMAT('      THE SECOND OPERAND = ',E15.7)
      CALL DPWRST('XXX','BUG ')
      IERROR='YES'
      GOTO9000
C               *****************
C               **  STEP 90--  **
C               **  EXIT.      **
C               *****************
C
 9000 CONTINUE
      IF(IBUGEV.EQ.'ON')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9011)
 9011   FORMAT('***** AT THE END       OF EVALM--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9012)ANS,IERROR
 9012   FORMAT('ANS,IERROR = ',E15.7,2X,A4)
        CALL DPWRST('XXX','BUG ')
        DO9113I=1,5
          WRITE(ICOUT,9013)I,SAVE1(I),SAVE2(I),SAVE3(I),SAVE4(I)
 9013     FORMAT('I,SAVE1,SAVE2,SAVE3,SAVE4 = ',I3,5E15.7)
          CALL DPWRST('XXX','BUG ')
 9113   CONTINUE
      ENDIF
C
      RETURN
      END
      SUBROUTINE EWECDF(X,GAMMA,THETA,MINMAX,CDF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE CUMULATIVE DISTRIBUTION
C              FUNCTION VALUE FOR THE EXPONENTIATED WEIBULL
C              DISTRIBUTION WITH SINGLE PRECISION
C              TAIL LENGTH PARAMETER = GAMMA, SHAPE PARAMETER THETA.
C              THERE ARE 2 SUCH EXPONETIATED WEIBULL FAMILIES--
C                 ONE FOR THE MIN ORDER STAT (THE USUAL) AND
C                 ONE FOR THE MAX ORDER STAT.
C              (SEE SARHAN & GREENBERG, PAGE 69)
C              THE EXPONETIATED WEIBULL TYPE IS SPECIFIED VIA   MINMAX
C              FOR MINMAX = 1  (FOR THE DEFAULT MINIMUM)
C                 THE EXPONETIATED EXPONENTIATED WEIBULL DISTRIBUTION USED
C                 HEREIN IS DEFINED FOR ALL POSITIVE X,
C                 AND HAS THE PROBABILITY DENSITY FUNCTION
C                 F(X) = (THETA*GAMMA)*(X**(GAMMA-1)) * EXP(-(X**GAMMA))
C                        *(1-EXP(-(X**GAMMA))**(THETA-1)
C              FOR MINMAX = 2 (FOR THE MAXIMUM),
C                 THE EXPONETIATED EXPONENTIATED WEIBULL DISTRIBUTION USED
C                 HEREIN IS DEFINED FOR ALL NEGATIVE X,
C                 AND HAS THE PROBABILITY DENSITY FUNCTION
C                 F(X) = ...
C                 F(X) = GAMMA * (X**(GAMMA-1)) * EXP(-(X**GAMMA)).
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE AT
C                                WHICH THE CUMULATIVE DISTRIBUTION
C                                FUNCTION IS TO BE EVALUATED.
C                                X SHOULD BE NON-NEGATIVE.
C                     --GAMMA  = THE SHAPE PARAMETER
C                                GAMMA SHOULD BE POSITIVE.
C                     --THETA  = THE SINGLE PRECISION VALUE
C                                OF THE SECOND SHAPE PARAMETER.
C                                THETA SHOULD BE POSITIVE.
C                     --MINMAX = THE INTEGER VALUE
C                                IDENTIFYING THE
C                                CHOSEN EXPONENTIATED WEIBULL DISTRIBUTION.
C                                1 = MIN, 2 = MAX.
C     OUTPUT ARGUMENTS--CDF    = THE SINGLE PRECISION CUMULATIVE
C                                DISTRIBUTION FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION CUMULATIVE DISTRIBUTION
C             FUNCTION VALUE CDF FOR THE EXPONENTIATED WEIBULL DISTRIBUTION
C             WITH TAIL LENGHT PARAMETER = GAMMA.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--X SHOULD BE NON-NEGATIVE.
C                 --GAMMA SHOULD BE POSITIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--EXP.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--SARHAN & GREENBERG,
C                 CONTRIBUTIONS TO ORDER STATISTICS,
C                 1962, WILEY, PAGE 69.
C               --MUDHOLKAR AND SRIVASTAVE, "THE EXPONENTIATED WEIBULL
C                 FAMILY: A REANALYSIS OF THE BUS-MOTOR-FAILURE DATA",
C                 TECHNOMETRICS, NOVEMBER, 1995, PP436-437.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1966)
C     VERSION NUMBER--95/10
C     ORIGINAL VERSION--OCTOBER   1995.
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DCDF
      DOUBLE PRECISION DX
      DOUBLE PRECISION DG
      DOUBLE PRECISION DT
      DOUBLE PRECISION DTERM1, DTERM2
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      MINMSV=MINMAX
      MINMAX=1
      CDF=0.0
      IF(GAMMA.LE.0.0)THEN
        WRITE(ICOUT,15)
   15   FORMAT('***** ERROR--THE SECOND ARGUMENT TO ',
     1         'EWECDF IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)GAMMA
   46   FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7)
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(THETA.LE.0.0)THEN
        WRITE(ICOUT,25)
   25   FORMAT('***** ERROR--THE THIRD ARGUMENT TO ',
     1         'EWECDF IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)THETA
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
C
       IF(X.LE.0.0)THEN
         CDF=0.0
       ELSE 
         DX=DBLE(X)
         DG=DBLE(GAMMA)
         DT=DBLE(THETA)
         DTERM1=DLOG(1.0D0-DEXP(-(DX**DG)))
         DTERM2=DT*DTERM1
         DCDF=DEXP(DTERM2)
         CDF=REAL(DCDF)
      ENDIF
C
 9000 CONTINUE
      MINMAX=MINMSV
      RETURN
      END
      SUBROUTINE EWECHA(X,GAMMA,THETA,MINMAX,HAZ)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE CUMULATIVE HAZARD
C              FUNCTION VALUE FOR THE EXPONENTIATED WEIBULL
C              DISTRIBUTION WITH SINGLE PRECISION
C              TAIL LENGTH PARAMETER = GAMMA, SHAPE PARAMETER THETA.
C              FOR MINMAX = 1  (FOR THE DEFAULT MINIMUM)
C                 THE EXPONETIATED EXPONENTIATED WEIBULL DISTRIBUTION USED
C                 HEREIN IS DEFINED FOR ALL POSITIVE X,
C                 AND HAS THE PROBABILITY DENSITY FUNCTION
C                 F(X) = (THETA*GAMMA)*(X**(GAMMA-1)) * EXP(-(X**GAMMA))
C                        *(1-EXP(-(X**GAMMA))**(THETA-1)
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE AT
C                                WHICH THE CUMULATIVE HAZARD
C                                FUNCTION IS TO BE EVALUATED.
C                                X SHOULD BE NON-NEGATIVE.
C                     --GAMMA  = THE SHAPE PARAMETER
C                                GAMMA SHOULD BE POSITIVE.
C                     --THETA  = THE SINGLE PRECISION VALUE
C                                OF THE SECOND SHAPE PARAMETER.
C                                THETA SHOULD BE POSITIVE.
C                     --MINMAX = THE INTEGER VALUE
C                                IDENTIFYING THE
C                                CHOSEN EXPONENTIATED WEIBULL DISTRIBUTION.
C                                1 = MIN, 2 = MAX.
C     OUTPUT ARGUMENTS--HAZ    = THE SINGLE PRECISION CUMULATIVE HAZARD
C                                FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION CUMULATIVE HAZARD
C             FUNCTION VALUE FOR THE EXPONENTIATED WEIBULL DISTRIBUTION
C             WITH TAIL LENGTH PARAMETER GAMMA, SHAPE PARAMETER THETA.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--X SHOULD BE POSITIVE
C                 --GAMMA, THETA SHOULD BE POSITIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--EXP.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--MUDHOLKAR AND SRIVASTAVE, "THE EXPONENTIATED WEIBULL
C                 FAMILY: A REANALYSIS OF THE BUS-MOTOR-FAILURE DATA",
C                 TECHNOMETRICS, NOVEMBER, 1995, PP436-437.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1966)
C     VERSION NUMBER--98/5
C     ORIGINAL VERSION--MAY       1998.
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DHAZ
      DOUBLE PRECISION DCDF
      DOUBLE PRECISION DX
      DOUBLE PRECISION DG
      DOUBLE PRECISION DT
      DOUBLE PRECISION DTERM1, DTERM2
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      HAZ=0.0
      MINMSV=MINMAX
      MINMAX=1
      IF(GAMMA.LE.0.0)THEN
        WRITE(ICOUT,15)
   15   FORMAT('***** ERROR--THE SECOND ARGUMENT TO ',
     1         'EWECHA IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)GAMMA
   46   FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7)
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(THETA.LE.0.0)THEN
        WRITE(ICOUT,25)
   25   FORMAT('***** ERROR--THE THIRD ARGUMENT TO ',
     1         'EWECHA IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)THETA
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
C
C
      IF(X.LE.0.0)THEN
        HAZ=0.0
      ELSE
C
        DX=DBLE(X)
        DT=DBLE(THETA)
        DG=DBLE(GAMMA)
        DTERM1=DLOG(1.0D0-DEXP(-(DX**DG)))
        DTERM2=DT*DTERM1
        DCDF=DEXP(DTERM2)
C
        DHAZ=-DLOG(1.0D0-DCDF)
        HAZ=SNGL(DHAZ)
C
      ENDIF
C
 9000 CONTINUE
      MINMAX=MINMSV
      RETURN
      END
      SUBROUTINE EWEHAZ(X,GAMMA,THETA,MINMAX,HAZ)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE HAZARD
C              FUNCTION VALUE FOR THE EXPONENTIATED WEIBULL
C              DISTRIBUTION WITH SINGLE PRECISION
C              TAIL LENGTH PARAMETER = GAMMA, SHAPE PARAMETER THETA.
C              FOR MINMAX = 1  (FOR THE DEFAULT MINIMUM)
C                 THE EXPONETIATED EXPONENTIATED WEIBULL DISTRIBUTION USED
C                 HEREIN IS DEFINED FOR ALL POSITIVE X,
C                 AND HAS THE PROBABILITY DENSITY FUNCTION
C                 F(X) = (THETA*GAMMA)*(X**(GAMMA-1)) * EXP(-(X**GAMMA))
C                        *(1-EXP(-(X**GAMMA))**(THETA-1)
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE AT
C                                WHICH THE CUMULATIVE DISTRIBUTION
C                                FUNCTION IS TO BE EVALUATED.
C                                X SHOULD BE NON-NEGATIVE.
C                     --GAMMA  = THE SHAPE PARAMETER
C                                GAMMA SHOULD BE POSITIVE.
C                     --THETA  = THE SINGLE PRECISION VALUE
C                                OF THE SECOND SHAPE PARAMETER.
C                                THETA SHOULD BE POSITIVE.
C                     --MINMAX = THE INTEGER VALUE
C                                IDENTIFYING THE
C                                CHOSEN EXPONENTIATED WEIBULL DISTRIBUTION.
C                                1 = MIN, 2 = MAX.
C     OUTPUT ARGUMENTS--HAZ    = THE SINGLE PRECISION HAZARD FUNCTION
C                                VALUE.
C     OUTPUT--THE SINGLE PRECISION HAZARD
C             FUNCTION VALUE FOR THE EXPONENTIATED WEIBULL DISTRIBUTION
C             WITH TAIL LENGTH PARAMETER GAMMA, SHAPE PARAMETER THETA.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--X SHOULD BE POSITIVE
C                 --GAMMA, THETA SHOULD BE POSITIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--EXP.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--MUDHOLKAR AND SRIVASTAVE, "THE EXPONENTIATED WEIBULL
C                 FAMILY: A REANALYSIS OF THE BUS-MOTOR-FAILURE DATA",
C                 TECHNOMETRICS, NOVEMBER, 1995, PP436-437.
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1966)
C               EXCEPTION--HOLLERITH STRINGS IN FORMAT STATEMENTS
C                          DENOTED BY QUOTES RATHER THAN NH.
C     VERSION NUMBER--98/5
C     ORIGINAL VERSION--MAY       1998.
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DHAZ
      DOUBLE PRECISION DX
      DOUBLE PRECISION DG
      DOUBLE PRECISION DT
      DOUBLE PRECISION DTERM1, DTERM2, DTERM3, DTERM4, DTERM5
      DOUBLE PRECISION DTERM6, DTERM7
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      MINMSV=MINMAX
      MINMAX=1
      IF(GAMMA.LE.0.0)THEN
        WRITE(ICOUT,15)
   15   FORMAT('***** ERROR--THE SECOND ARGUMENT TO ',
     1         'EWEHAZ IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)GAMMA
   46   FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7)
        CALL DPWRST('XXX','BUG ')
        HAZ=0.0
        GOTO9000
      ENDIF
      IF(THETA.LE.0.0)THEN
        WRITE(ICOUT,25)
   25   FORMAT('***** ERROR--THE THIRD ARGUMENT TO ',
     1         'EWEHAZ IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)THETA
        CALL DPWRST('XXX','BUG ')
        HAZ=0.0
        GOTO9000
      ENDIF
C
      IF(X.LE.0.0)THEN
        HAZ=0.0
      ELSE
        DX=DBLE(X)
        DT=DBLE(THETA)
        DG=DBLE(GAMMA)
C
        DTERM7=DEXP(-(DX**DG))
        DTERM1=DLOG(DG) + DLOG(DT)
        DTERM2=(DT-1.0D0)*DLOG(1.0D0-DTERM7)
        DTERM3=-(DX**DG)
        DTERM4=(DG-1.0D0)*DLOG(DX)
        DTERM5=DLOG(1.0D0 - (1.0D0 - DTERM7)**DT)
        DTERM6=DTERM1+DTERM2+DTERM3+DTERM4-DTERM5
        DHAZ=DEXP(DTERM6)
        HAZ=REAL(DHAZ)
C
      ENDIF
C
 9000 CONTINUE
      MINMAX=MINMSV
      RETURN
      END
      SUBROUTINE EWEPDF(X,GAMMA,THETA,MINMAX,PDF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE CUMULATIVE DISTRIBUTION
C              FUNCTION VALUE FOR THE EXPONENTIATED WEIBULL
C              DISTRIBUTION WITH SINGLE PRECISION
C              TAIL LENGTH PARAMETER = GAMMA, SHAPE PARAMETER THETA.
C              THERE ARE 2 SUCH EXPONETIATED WEIBULL FAMILIES--
C                 ONE FOR THE MIN ORDER STAT (THE USUAL) AND
C                 ONE FOR THE MAX ORDER STAT.
C              (SEE SARHAN & GREENBERG, PAGE 69)
C              THE EXPONETIATED WEIBULL TYPE IS SPECIFIED VIA   MINMAX
C              FOR MINMAX = 1  (FOR THE DEFAULT MINIMUM)
C                 THE EXPONETIATED EXPONENTIATED WEIBULL DISTRIBUTION USED
C                 HEREIN IS DEFINED FOR ALL POSITIVE X,
C                 AND HAS THE PROBABILITY DENSITY FUNCTION
C                 F(X) = (THETA*GAMMA)*(X**(GAMMA-1)) * EXP(-(X**GAMMA))
C                        *(1-EXP(-(X**GAMMA))**(THETA-1)
C              FOR MINMAX = 2 (FOR THE MAXIMUM),
C                 THE EXPONETIATED EXPONENTIATED WEIBULL DISTRIBUTION USED
C                 HEREIN IS DEFINED FOR ALL NEGATIVE X,
C                 AND HAS THE PROBABILITY DENSITY FUNCTION
C                 F(X) = ...
C                 F(X) = GAMMA * (X**(GAMMA-1)) * EXP(-(X**GAMMA)).
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE AT
C                                WHICH THE CUMULATIVE DISTRIBUTION
C                                FUNCTION IS TO BE EVALUATED.
C                                X SHOULD BE NON-NEGATIVE.
C                     --GAMMA  = THE SHAPE PARAMETER
C                                GAMMA SHOULD BE POSITIVE.
C                     --THETA  = THE SINGLE PRECISION VALUE
C                                OF THE SECOND SHAPE PARAMETER.
C                                THETA SHOULD BE POSITIVE.
C                     --MINMAX = THE INTEGER VALUE
C                                IDENTIFYING THE
C                                CHOSEN EXPONENTIATED WEIBULL DISTRIBUTION.
C                                1 = MIN, 2 = MAX.
C     OUTPUT ARGUMENTS--PDF    = THE SINGLE PRECISION PROBABILITY
C                                DENSITY FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION PROBABILITY DENSITY
C             FUNCTION VALUE FOR THE EXPONENTIATED WEIBULL DISTRIBUTION
C             WITH TAIL LENGHT PARAMETER = GAMMA.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--X SHOULD BE POSITIVE.
C                 --GAMMA SHOULD BE POSITIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--EXP.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--SARHAN & GREENBERG,
C                 CONTRIBUTIONS TO ORDER STATISTICS,
C                 1962, WILEY, PAGE 69.
C               --MUDHOLKAR AND SRIVASTAVE, "THE EXPONENTIATED WEIBULL
C                 FAMILY: A REANALYSIS OF THE BUS-MOTOR-FAILURE DATA",
C                 TECHNOMETRICS, NOVEMBER, 1995, PP436-437.
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1966)
C     VERSION NUMBER--95/10
C     ORIGINAL VERSION--OCTOBER   1995.
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DPDF
      DOUBLE PRECISION DX
      DOUBLE PRECISION DG
      DOUBLE PRECISION DT
      DOUBLE PRECISION DTERM1, DTERM2, DTERM3, DTERM4, DTERM5
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      MINMSV=MINMAX
      MINMAX=1
      PDF=0.0
      IF(GAMMA.LE.0.0)THEN
        WRITE(ICOUT,15)
   15   FORMAT('***** ERROR--THE SECOND ARGUMENT TO ',
     1         'EWEPDF IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)GAMMA
   46   FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7)
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(THETA.LE.0.0)THEN
        WRITE(ICOUT,25)
   25   FORMAT('***** ERROR--THE THIRD ARGUMENT TO ',
     1         'EWEPDF IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)THETA
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
C
       IF(X.LE.0.0)THEN
         PDF=0.0
       ELSE
         DX=DBLE(X)
         IF(DX.LT.0.0000001D0)DX=0.0000001D0
         DG=DBLE(GAMMA)
         DT=DBLE(THETA)
         DTERM1=DLOG(DG) + DLOG(DT)
         DTERM2=(DT-1.0D0)*DLOG(1.0D0-DEXP(-(DX**DG)))
         DTERM3=-(DX**DG)
         DTERM4=(DG-1.0D0)*DLOG(DX)
         DTERM5=DTERM1+DTERM2+DTERM3+DTERM4
         DPDF=DEXP(DTERM5)
         PDF=REAL(DPDF)
      ENDIF
C
 9000 CONTINUE
      MINMAX=MINMSV
      RETURN
      END
      SUBROUTINE EWEPPF(P,GAMMA,THETA,MINMAX,PPF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE PERCENT POINT
C              FUNCTION VALUE FOR THE EXPONETIATED WEIBULL
C              DISTRIBUTION WITH SINGLE PRECISION
C              TAIL LENGTH PARAMETER = GAMMA, SHAPE PARAMETER THETA.
C              THERE ARE 2 SUCH EXPONETIATED WEIBULL FAMILIES--
C                 ONE FOR THE MIN ORDER STAT (THE USUAL) AND
C                 ONE FOR THE MAX ORDER STAT.
C              (SEE SARHAN & GREENBERG, PAGE 69)
C              THE EXPONETIATED WEIBULL TYPE IS SPECIFIED VIA   MINMAX
C              FOR MINMAX = 1  (FOR THE DEFAULT MINIMUM)
C                 THE EXPONETIATED WEIBULL DISTRIBUTION USED
C                 HEREIN IS DEFINED FOR ALL POSITIVE X,
C                 AND HAS THE PROBABILITY DENSITY FUNCTION
C                 F(X) = (THETA*GAMMA)*(X**(GAMMA-1)) * EXP(-(X**GAMMA))
C                        *(1-EXP(-(X**GAMMA))**(THETA-1)
C              FOR MINMAX = 2 (FOR THE MAXIMUM),
C                 THE EXPONETIATED WEIBULL DISTRIBUTION USED
C                 HEREIN IS DEFINED FOR ALL NEGATIVE X,
C                 AND HAS THE PROBABILITY DENSITY FUNCTION
C                 F(X) = ...
C              NOTE THAT THE PERCENT POINT FUNCTION OF A DISTRIBUTION
C              IS IDENTICALLY THE SAME AS THE INVERSE CUMULATIVE
C              DISTRIBUTION FUNCTION OF THE DISTRIBUTION.
C     INPUT  ARGUMENTS--P      = THE SINGLE PRECISION VALUE
C                                (BETWEEN 0.0 (INCLUSIVELY)
C                                AND 1.0 (EXCLUSIVELY))
C                                AT WHICH THE PERCENT POINT
C                                FUNCTION IS TO BE EVALUATED.
C                     --GAMMA  = THE SINGLE PRECISION VALUE
C                                OF THE TAIL LENGTH PARAMETER.
C                                GAMMA SHOULD BE POSITIVE.
C                     --THETA  = THE SINGLE PRECISION VALUE
C                                OF THE SECOND SHAPE PARAMETER.
C                                THETA SHOULD BE POSITIVE.
C                     --MINMAX = THE INTEGER VALUE
C                                IDENTIFYING THE
C                                CHOSEN EXPONETIATED WEIBULL DISTRIBUTION.
C                                1 = MIN, 2 = MAX.
C     OUTPUT ARGUMENTS--PPF    = THE SINGLE PRECISION PERCENT
C                                POINT FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION PERCENT POINT FUNCTION .
C             VALUE PPF FOR THE EXPONETIATED WEIBULL DISTRIBUTION
C             WITH TAIL LENGTH PARAMETER VALUE = GAMMA.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--GAMMA SHOULD BE POSITIVE.
C                 --P SHOULD BE BETWEEN 0.0 (INCLUSIVELY)
C                   AND 1.0 (EXCLUSIVELY).
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--LOG.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--SARHAN & GREENBERG,
C                 CONTRIBUTIONS TO ORDER STATISTICS,
C               --MUDHOLKAR AND SRIVASTAVE, "THE EXPONENTIATED WEIBULL
C                 FAMILY: A REANALYSIS OF THE BUS-MOTOR-FAILURE DATA",
C                 TECHNOMETRICS, NOVEMBER, 1995, PP436-437.
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1966)
C     VERSION NUMBER--95/10
C     ORIGINAL VERSION--OCTOBER   1995.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DP
      DOUBLE PRECISION DG
      DOUBLE PRECISION DT
      DOUBLE PRECISION DPPF
      DOUBLE PRECISION DTERM1
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      MINMSV=MINMAX
      MINMAX=1
      PPF=0.0
      IF(P.LT.0.0.OR.P.GE.1.0)THEN
        WRITE(ICOUT,1)
    1   FORMAT('***** ERROR--THE FIRST ARGUMENT TO ',
     1         'EWEPPF IS OUTSIDE THE ALLOWABLE (0,1) INTERVAL')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)P
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(GAMMA.LE.0.0)THEN
        WRITE(ICOUT,15)
   15   FORMAT('***** ERROR--THE SECOND ARGUMENT TO ',
     1         'EWEPPF IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)GAMMA
   46   FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7)
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(THETA.LE.0.0)THEN
        WRITE(ICOUT,25)
   25   FORMAT('***** ERROR--THE THIRD ARGUMENT TO ',
     1         'EWEPPF IS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)THETA
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
C
C
       IF(P.EQ.0.0)THEN
         PPF=0.0
       ELSE
         DP=DBLE(P)
         DG=DBLE(1.0/GAMMA)
         DT=DBLE(1.0/THETA)
         DTERM1=DG*DLOG(-DLOG(1.0D0-DP**DT))
         DPPF=DEXP(DTERM1)
         PPF=REAL(DPPF)
      ENDIF
C
 9000 CONTINUE
      MINMAX=MINMSV
      RETURN
      END
      SUBROUTINE EEWRAN(N,AL,GAMMA1,SCALE1,GAMMA2,SCALE2,ISEED,X)
C
C     PURPOSE--THIS SUBROUTINE GENERATES A RANDOM SAMPLE OF SIZE N
C              FROM THE END EFFECTS WEIBULL DISTRIBUTION.
C     INPUT  ARGUMENTS--N      = THE DESIRED INTEGER NUMBER
C                                OF RANDOM NUMBERS TO BE
C                                GENERATED.
C                     --AL     = THE SINGLE PRECISION VALUE OF THE
C                                FIBER LENGTH PARAMETER
C                     --GAMMA1 = THE SINGLE PRECISION VALUE OF THE
C                                SHAPE (1) PARAMETER.
C                     --SCALE1 = THE SINGLE PRECISION VALUE OF THE
C                                SCALE (1) PARAMETER.
C                     --GAMMA2 = THE SINGLE PRECISION VALUE OF THE
C                                SHAPE (2) PARAMETER.
C                     --SCALE2 = THE SINGLE PRECISION VALUE OF THE
C                                SCALE (2) PARAMETER.
C     OUTPUT ARGUMENTS--X      = A SINGLE PRECISION VECTOR
C                                (OF DIMENSION AT LEAST N)
C                                INTO WHICH THE GENERATED
C                                RANDOM SAMPLE WILL BE PLACED.
C     OUTPUT--A RANDOM SAMPLE OF SIZE N
C             FROM THE END EFFECTS WEIBULL DISTRIBUTION.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--THERE IS NO RESTRICTION ON THE MAXIMUM VALUE
C                   OF N FOR THIS SUBROUTINE.
C                 --SHAPE PARAMETERS SHOULD BE POSITIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--UNIRAN.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--NONE.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2010.7
C     ORIGINAL VERSION--JULY      2010.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C---------------------------------------------------------------------
C
      DIMENSION X(*)
      DOUBLE PRECISION DTEMP
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(N.LT.1)THEN
        WRITE(ICOUT,55)
   55   FORMAT('***** ERROR--THE REQUESTED NUMBER OF END EFFECTS ',
     1         'WEIBULL RANDOM NUMBERS IS NON-POSITIVE.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,47)N
   47   FORMAT('***** THE VALUE OF THE ARGUMENT IS ',I8)
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(SCALE1.LE.0.0D0)THEN
        WRITE(ICOUT,5)
    5   FORMAT('***** ERROR--THE SCALE1 PARAMETER FOR THE END ',
     1         'EFFECTS WEIBULL RANDOM NUMBERSIS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)SCALE1
   46   FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7)
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(GAMMA1.LE.0.0D0)THEN
        WRITE(ICOUT,15)
   15   FORMAT('***** ERROR--THE GAMMA1 PARAMETER FOR THE END ',
     1         'EFFECTS WEIBULL RANDOM NUMBERSIS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)GAMMA1
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(SCALE2.LE.0.0D0)THEN
        WRITE(ICOUT,25)
   25   FORMAT('***** ERROR--THE SCALE2 PARAMETER FOR THE END ',
     1         'EFFECTS WEIBULL RANDOM NUMBERSIS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)SCALE2
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(GAMMA2.LE.0.0D0)THEN
        WRITE(ICOUT,35)
   35   FORMAT('***** ERROR--THE GAMMA2 PARAMETER FOR THE END ',
     1         'EFFECTS WEIBULL RANDOM NUMBERSIS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)GAMMA2
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(AL.LE.0.0D0)THEN
        WRITE(ICOUT,45)
   45   FORMAT('***** ERROR--THE L PARAMETER FOR THE END ',
     1         'EFFECTS WEIBULL RANDOM NUMBERSIS NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)AL
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
C
C     GENERATE N UNIFORM (0,1) RANDOM NUMBERS;
C
      CALL UNIRAN(N,ISEED,X)
C
C     GENERATE N END EFFECTS WEIBULL DISTRIBUTION RANDOM
C     NUMBERS USING THE PERCENT POINT FUNCTION TRANSFORMATION METHOD.
C
      DO100I=1,N
        CALL EEWPPF(DBLE(X(I)),DBLE(AL),DBLE(GAMMA1),DBLE(SCALE1),
     1              DBLE(GAMMA2),DBLE(SCALE2),DTEMP)
        X(I)=REAL(DTEMP)
  100 CONTINUE
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE EWERAN(N,GAMMA,THETA,ISEED,X)
C
C     PURPOSE--THIS SUBROUTINE GENERATES A RANDOM SAMPLE OF SIZE N
C              FROM THE EXPONENTIATED WEIBULL DISTRIBUTION
C              WITH SHAPE PARAMETER VALUES = GAMMA, THETA.
C     INPUT  ARGUMENTS--N      = THE DESIRED INTEGER NUMBER
C                                OF RANDOM NUMBERS TO BE
C                                GENERATED.
C                     --GAMMA  = THE SINGLE PRECISION VALUE OF THE
C                                FIRST SHAPE PARAMETER.
C                                GAMMA SHOULD BE POSITIVE.
C                     --THETA  = THE SINGLE PRECISION VALUE OF THE
C                                SECOND SHAPE PARAMETER.
C                                THETA SHOULD BE POSITIVE.
C     OUTPUT ARGUMENTS--X      = A SINGLE PRECISION VECTOR
C                                (OF DIMENSION AT LEAST N)
C                                INTO WHICH THE GENERATED
C                                RANDOM SAMPLE WILL BE PLACED.
C     OUTPUT--A RANDOM SAMPLE OF SIZE N
C             FROM THE EXPONENTIATED WEIBULL DISTRIBUTION
C             WITH SHAPE PARAMETER VALUES = GAMMA AND THETA.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--THERE IS NO RESTRICTION ON THE MAXIMUM VALUE
C                   OF N FOR THIS SUBROUTINE.
C                 --GAMMA SHOULD BE POSITIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--UNIRAN.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--NON E.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1966)
C     VERSION NUMBER--2001.9
C     ORIGINAL VERSION--SEPTEMBER 2001.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C---------------------------------------------------------------------
C
      DIMENSION X(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(N.LT.1)THEN
        WRITE(ICOUT, 5)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,47)N
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
    5 FORMAT('***** FATAL ERROR--THE 1ST INPUT ARGUMENT TO THE ',
     1'EWERAN SUBROUTINE IS NON-POSITIVE *****')
   47 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',I8,' *****')
C
C     GENERATE N UNIFORM (0,1) RANDOM NUMBERS;
C
      CALL UNIRAN(N,ISEED,X)
C
C     GENERATE N EXPONENTIATED WEIBULL DISTRIBUTION RANDOM NUMBERS
C     USING THE PERCENT POINT FUNCTION TRANSFORMATION METHOD.
C
      MINMAX=1
      DO100I=1,N
        CALL EWEPPF(X(I),GAMMA,THETA,MINMAX,XTEMP)
        X(I)=XTEMP
  100 CONTINUE
C
 9000 CONTINUE
      RETURN
      END
      DOUBLE PRECISION FUNCTION EXP3(XVALUE)
C
C   DESCRIPTION
C
C      This function calculates 
C          
C           EXP3(X) = integral 0 to X  (exp(-t*t*t)) dt
C
C      The code uses Chebyshev expansions, whose coefficients are
C      given to 20 decimal places.
C
C
C   ERROR RETURNS
C     
C      If XVALUE < 0, an error message is printed and the function 
C      returns the value 0.
C
C
C   MACHINE-DEPENDENT CONSTANTS
C
C      NTERM1 - INTEGER - The no. of terms of the array AEXP3,
C                         The recommended value is such that
C                               AEXP3(NTERM1) < EPS/100. 
C
C      NTERM2 - INTEGER - The no. of terms of the array AEXP3A.
C                         The recommended value is such that
C                               AEXP3A(NTERM2) < EPS/100.
C
C      XLOW - DOUBLE PRECISION - The value below which EXP3(X) = X to machine
C                    precision. The recommended value is
C                          cube root(4*EPSNEG)
C
C      XUPPER - DOUBLE PRECISION - The value above which EXP3(X) = 0.89297...
C                      to machine precision. The recommended value is
C                           cube root(-ln(EPSNEG))
C
C      For values of EPS and EPSNEG for various machine/compiler
C      combinations refer to the file MACHCON.TXT.
C
C      The machine-dependent constants are computed internally by
C      using the D1MACH subroutine.
C
C
C   INTRINSIC FUNCTIONS USED
C
C      EXP, LOG
C
C
C   OTHER MISCFUN SUBROUTINES USED:
C
C          CHEVAL , ERRPRN, D1MACH
C
C
C   AUTHOR
C
C      DR. ALLAN J. MACLEOD,
C      DEPARTMENT OF MATHEMATICS AND STATISTICS,
C      UNIVERSITY OF PAISLEY,
C      HIGH ST.,
C      PAISLEY
C      SCOTLAND.
C
C      (e-mail  macl_ms0@paisley.ac.uk )
C
C
C   LATEST MODIFICATION:  23 January, 1996
C
C
      INTEGER NTERM1,NTERM2
      DOUBLE PRECISION AEXP3(0:24),AEXP3A(0:24),CHEVAL,
     1      FOUR,FUNINF,HALF,ONE,ONEHUN,SIXTEN,T,THREE,
     2      TWO,X,XLOW,XUPPER,XVALUE,ZERO
CCCCC CHARACTER FNNAME*6,ERRMSG*14
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOMC.INC'
      INCLUDE 'DPCOP2.INC'
C
CCCCC DATA FNNAME/'EXP3  '/
CCCCC DATA ERRMSG/'ARGUMENT < 0.0'/
      DATA ZERO,HALF,ONE/0.0 D 0 , 0.5 D 0 , 1.0 D 0/
      DATA TWO,THREE,FOUR/2.0 D 0 , 3.0 D 0 , 4.0 D 0 /
      DATA SIXTEN,ONEHUN/16.0 D 0 , 100.0 D 0/
      DATA FUNINF/0.89297 95115 69249 21122 D 0/
      DATA AEXP3(0)/  1.26919 84142 21126 01434  D    0/
      DATA AEXP3(1)/ -0.24884 64463 84140 98226  D    0/
      DATA AEXP3(2)/  0.80526 22071 72310 4125   D   -1/
      DATA AEXP3(3)/ -0.25772 73325 19683 2934   D   -1/
      DATA AEXP3(4)/  0.75998 78873 07377 429    D   -2/
      DATA AEXP3(5)/ -0.20306 95581 94040 510    D   -2/
      DATA AEXP3(6)/  0.49083 45866 99329 17     D   -3/
      DATA AEXP3(7)/ -0.10768 22391 42020 77     D   -3/
      DATA AEXP3(8)/  0.21551 72626 42898 4      D   -4/
      DATA AEXP3(9)/ -0.39567 05137 38429        D   -5/
      DATA AEXP3(10)/ 0.66992 40933 8956         D   -6/
      DATA AEXP3(11)/-0.10513 21808 0703         D   -6/
      DATA AEXP3(12)/ 0.15362 58019 825          D   -7/
      DATA AEXP3(13)/-0.20990 96036 36           D   -8/
      DATA AEXP3(14)/ 0.26921 09538 1            D   -9/
      DATA AEXP3(15)/-0.32519 52422              D  -10/
      DATA AEXP3(16)/ 0.37114 8157               D  -11/
      DATA AEXP3(17)/-0.40136 518                D  -12/
      DATA AEXP3(18)/ 0.41233 46                 D  -13/
      DATA AEXP3(19)/-0.40337 5                  D  -14/
      DATA AEXP3(20)/ 0.37658                    D  -15/
      DATA AEXP3(21)/-0.3362                     D  -16/
      DATA AEXP3(22)/ 0.288                      D  -17/
      DATA AEXP3(23)/-0.24                       D  -18/
      DATA AEXP3(24)/ 0.2                        D  -19/
      DATA AEXP3A(0)/  1.92704 64955 06827 37293  D    0/
      DATA AEXP3A(1)/ -0.34929 35652 04813 8054   D   -1/
      DATA AEXP3A(2)/  0.14503 38371 89830 093    D   -2/
      DATA AEXP3A(3)/ -0.89253 36718 32790 3      D   -4/
      DATA AEXP3A(4)/  0.70542 39219 11838        D   -5/
      DATA AEXP3A(5)/ -0.66717 27454 7611         D   -6/
      DATA AEXP3A(6)/  0.72426 75899 824          D   -7/
      DATA AEXP3A(7)/ -0.87825 82560 56           D   -8/
      DATA AEXP3A(8)/  0.11672 23442 78           D   -8/
      DATA AEXP3A(9)/ -0.16766 31281 2            D   -9/
      DATA AEXP3A(10)/ 0.25755 01577              D  -10/
      DATA AEXP3A(11)/-0.41957 8881               D  -11/
      DATA AEXP3A(12)/ 0.72010 412                D  -12/
      DATA AEXP3A(13)/-0.12949 055                D  -12/
      DATA AEXP3A(14)/ 0.24287 03                 D  -13/
      DATA AEXP3A(15)/-0.47331 1                  D  -14/
      DATA AEXP3A(16)/ 0.95531                    D  -15/
      DATA AEXP3A(17)/-0.19914                    D  -15/
      DATA AEXP3A(18)/ 0.4277                     D  -16/
      DATA AEXP3A(19)/-0.944                      D  -17/
      DATA AEXP3A(20)/ 0.214                      D  -17/
      DATA AEXP3A(21)/-0.50                       D  -18/
      DATA AEXP3A(22)/ 0.12                       D  -18/
      DATA AEXP3A(23)/-0.3                        D  -19/
      DATA AEXP3A(24)/ 0.1                        D  -19/
C
C   Start calculation
C
      X = XVALUE
C
C   Error test
C
      IF ( X .LT. ZERO ) THEN
CCCCC    CALL ERRPRN(FNNAME,ERRMSG)
         WRITE(ICOUT,999)
         CALL DPWRST('XXX','BUG ')
         WRITE(ICOUT,101)X
         CALL DPWRST('XXX','BUG ')
         EXP3 = ZERO
         RETURN
      ENDIF
  999 FORMAT(1X)
  101 FORMAT('***** ERROR FROM EXP3--ARGUMENT MUST BE ',
     1       'NON-NEGATIVE, ARGUMENT = ',G15.7)
C
C   Compute the machine-dependent constants.
C
      T = D1MACH(3)
      XLOW = ( FOUR * T ) ** (ONE/THREE)
      XUPPER = ( -LOG ( T ) ) ** (ONE/THREE)
      T = T / ONEHUN
      IF ( X .LE. TWO ) THEN
         DO 10 NTERM1 = 24 , 0 , -1
            IF ( ABS(AEXP3(NTERM1)) .GT. T ) GOTO 19
 10      CONTINUE
 19      CONTINUE
      ELSE
         DO 40 NTERM2 = 24 , 0 , -1
            IF ( ABS(AEXP3A(NTERM2)) .GT. T ) GOTO 49
 40      CONTINUE
 49      CONTINUE
      ENDIF
C
C   Code for XVALUE < =  2
C
      IF ( X .LE. TWO ) THEN
         IF ( X .LT. XLOW ) THEN
            EXP3 = X
         ELSE
            T =  (  ( X * X * X / FOUR ) - HALF ) - HALF
            EXP3 = X * CHEVAL ( NTERM1,AEXP3,T ) 
         ENDIF
      ELSE
C
C   Code for XVALUE > 2
C
         IF ( X .GT. XUPPER ) THEN
            EXP3 = FUNINF
         ELSE
            T = ( ( SIXTEN/ ( X * X * X ) ) - HALF ) - HALF
            T = CHEVAL ( NTERM2,AEXP3A,T ) 
            T = T * EXP ( -X * X * X ) / ( THREE * X * X ) 
            EXP3 = FUNINF - T
         ENDIF
      ENDIF
      RETURN
      END            
      SUBROUTINE EXPLOS(X,N,ENGLSL,ENGUSL,COSUSL,IWRITE,XEL,
     1IBUGA3,IERROR)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE
C              SAMPLE EXPECTED LOSS FROM THE DATA IN THE INPUT VECTOR X.
C              THIS CALCULATION ASSUMES--
C                 1) A QUADRATIC LOSS FUNCTION
C                 2) A NORMAL DISTRIBUTION
C                 3) WITH MEAN XBAR AND STANDARD DEVIATION S
C                 4) A DOLLAR COST    COSUSL   AT THE UPPER SPEC LIMIT
C                 5) THE TARGET IS MIDWAY BETWEEN ENGUSL AND ENGLSL
C              XEL = INTEGRAL K*(X-TARGET)**2 * NORMALPDF(XBAR,S)
C              WHERE K IS DERIVED FROM THE LOSS FUNCTION
C                 L(X) = K*(X-TARGET)**2
C              EVALUATED AT X = USL
C                 SOLVING     L(USL) = COSUSL
C                             K*(USL-TARGET)**2 = COSUSL
C                             K = COSUSL / (USL-TARGET)**2
C     THE FINAL FORM FOR XEL IS QUITE SIMPLE--
C        XEL = COSUSL * (KSIGMA**2 + KMU**2)
C     WHERE KSIGMA IS DEFINED VIA   SIGMA = KSIGMA * H
C     AND   KMU    IS DEFINED VIA   MU    = TARGET + KMU*H
C     YIELDING KSIGMA = SIGMA / H
C     AND      KMU    = (MU - TARGET) / H
C     IN PRACTICE, WE USE XBAR FOR MU AND S FOR SIGMA.
C     NOTE--XEL IS A MEASURE OF PROCESS COST AND IS
C           SENSITIVE TO LOSS FROM BOTH BIAS AND FROM VARIATION.
C     NOTE--XEL IS A MEASURE WHICH TAKES ON
C           THE VALUES 0 TO INFINITY.
C           A GOOD PROCESS YIELDS VALUES OF
C           EXPECTED LOSS NEAR 0.
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VECTOR OF
C                                (UNSORTED OR SORTED) OBSERVATIONS.
C                     --N      = THE INTEGER NUMBER OF OBSERVATIONS
C                                IN THE VECTOR X.
C                     --ENGLSL = LOWER (ENGINEERING) SPEC LIMIT
C                     --ENGUSL = UPPER (ENGINEERING) SPEC LIMIT
C                     --COSUSL = COST AT UPPER SPEC LIMIT
C     OUTPUT ARGUMENTS--EXPLOS = THE SINGLE PRECISION VALUE OF THE
C                                COMPUTED SAMPLE EXPECTED LOSS
C     OUTPUT--THE COMPUTED SINGLE PRECISION VALUE OF THE
C             SAMPLE EXPECTED LOSS (IN XEL)
C     RESTRICTIONS--THERE IS NO RESTRICTION ON THE MAXIMUM VALUE
C                   OF N FOR THIS SUBROUTINE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--DSQRT.
C     MODE OF INTERNAL OPERATIONS--DOUBLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--R&M 2000 AIR FORCE MANUAL
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--89.5
C     ORIGINAL VERSION--MAY       1989.
C     UPDATED         --SEPTEMBER 1990. REVERSE INPUT ARGS
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 IWRITE
      CHARACTER*4 IBUGA3
      CHARACTER*4 IERROR
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DN
      DOUBLE PRECISION DX
      DOUBLE PRECISION DSUM
      DOUBLE PRECISION DMEAN
      DOUBLE PRECISION DVAR
      DOUBLE PRECISION DSD
C
      DOUBLE PRECISION DUSL
      DOUBLE PRECISION DLSL
C
      DOUBLE PRECISION DTARG
      DOUBLE PRECISION DH
      DOUBLE PRECISION DKMU
      DOUBLE PRECISION DKSIGM
      DOUBLE PRECISION DEL
C
      DIMENSION X(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='EXPL'
      ISUBN2='OS  '
      IERROR='NO'
C
      DMEAN=0.0D0
C
      IF(IBUGA3.EQ.'OFF')GOTO90
      WRITE(ICOUT,999)
  999 FORMAT(1X)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,51)
   51 FORMAT('***** AT THE BEGINNING OF EXPLOS--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,52)IBUGA3
   52 FORMAT('IBUGA3 = ',A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,53)N
   53 FORMAT('N = ',I8)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,54)ENGUSL,ENGLSL,COSUSL
   54 FORMAT('ENGUSL,ENGLSL,COSUSL = ',3E15.7)
      CALL DPWRST('XXX','BUG ')
      DO55I=1,N
      WRITE(ICOUT,56)I,X(I)
   56 FORMAT('I,X(I) = ',I8,E15.7)
      CALL DPWRST('XXX','BUG ')
   55 CONTINUE
   90 CONTINUE
C
C               ********************************************
C               **  COMPUTE PROCESS CAPABILITY INDEX EXPLOS  **
C               ********************************************
C
C               ********************************************
C               **  STEP 1--                              **
C               **  CHECK THE INPUT ARGUMENTS FOR ERRORS  **
C               ********************************************
C
      AN=N
C
      IF(N.GE.1)GOTO119
      IERROR='YES'
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,111)
  111 FORMAT('***** ERROR IN EXPLOS--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,112)
  112 FORMAT('      THE INPUT NUMBER OF OBSERVATIONS')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,113)
  113 FORMAT('      IN THE VARIABLE FOR WHICH')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,114)
  114 FORMAT('      THE EXPECTED LOSS IS TO BE COMPUTED')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,115)
  115 FORMAT('      MUST BE 1 OR LARGER.')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,116)
  116 FORMAT('      SUCH WAS NOT THE CASE HERE.')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,117)N
  117 FORMAT('      THE INPUT NUMBER OF OBSERVATIONS HERE = ',I8,
     1'.')
      CALL DPWRST('XXX','BUG ')
      GOTO9000
  119 CONTINUE
C
      IF(N.EQ.1)GOTO120
      GOTO129
  120 CONTINUE
CCCCC WRITE(ICOUT,999)
CCCCC CALL DPWRST('XXX','BUG ')
CCCCC WRITE(ICOUT,121)
CC121 FORMAT('***** NON-FATAL DIAGNOSTIC IN EXPLOS--',
CCCCC CALL DPWRST('XXX','BUG ')
CCCCC1'THE SECOND INPUT ARGUMENT (N) HAS THE VALUE 1')
      XSD=0.0
      GOTO9000
  129 CONTINUE
C
      HOLD=X(1)
      DO135I=2,N
      IF(X(I).NE.HOLD)GOTO139
  135 CONTINUE
CCCCC WRITE(ICOUT,999)
CCCCC CALL DPWRST('XXX','BUG ')
CCCCC WRITE(ICOUT,136)HOLD
CC136 FORMAT('***** NON-FATAL DIAGNOSTIC IN EXPLOS--',
CCCCC CALL DPWRST('XXX','BUG ')
CCCCC1'THE FIRST INPUT ARGUMENT (A VECTOR) HAS ALL ELEMENTS = ',E15.7)
      XSD=0.0
      GOTO9000
  139 CONTINUE
C
C               ***************************************
C               **  STEP 2--                         **
C               **  COMPUTE THE STANDARD DEVIATION.  **
C               ***************************************
C
      DN=N
      DSUM=0.0D0
      DO200I=1,N
      DX=X(I)
      DSUM=DSUM+DX
  200 CONTINUE
      DMEAN=DSUM/DN
C
      DSUM=0.0D0
      DO300I=1,N
      DX=X(I)
      DSUM=DSUM+(DX-DMEAN)**2
  300 CONTINUE
      DVAR=DSUM/(DN-1.0D0)
      DSD=0.0D0
      IF(DVAR.GT.0.0D0)DSD=DSQRT(DVAR)
      XSD=DSD
C
C               **************************************************
C               **  STEP 3--                                    **
C               **  COMPUTE THE EXPECTED LOSS                   **
C               **************************************************
C
      DUSL=ENGUSL
      DLSL=ENGLSL
C
      DTARG=(DUSL+DLSL)/2.0D0
      DH=(DUSL-DLSL)/2.0D0
C
      IF(DH.EQ.0.0D0)XEL=CPUMAX
      IF(DH.EQ.0.0D0)GOTO490
C
      DKSIGM=DSD/DH
      DKMU=(DMEAN-DTARG)/DH
C
      DCOSUS=COSUSL
      DEL=DCOSUS*(DKSIGM**2+DKMU**2)
      XEL=DEL
C
  490 CONTINUE
C
C               *******************************
C               **  STEP 3--                 **
C               **  WRITE OUT A LINE         **
C               **  OF SUMMARY INFORMATION.  **
C               *******************************
C
      IF(IFEEDB.EQ.'OFF')GOTO890
      IF(IWRITE.EQ.'OFF')GOTO890
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,811)N,XEL
  811 FORMAT('THE EXPECTED LOSS ($) OF THE ',I8,' OBSERVATIONS = ',
     1E15.7)
      CALL DPWRST('XXX','BUG ')
  890 CONTINUE
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT.      **
C               *****************
C
 9000 CONTINUE
      IF(IBUGA3.EQ.'OFF')GOTO9090
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9011)
 9011 FORMAT('***** AT THE END       OF EXPLOS--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9012)IBUGA3,IERROR
 9012 FORMAT('IBUGA3,IERROR = ',A4,2X,A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9013)N
 9013 FORMAT('N = ',I8)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9014)DMEAN
 9014 FORMAT('DMEAN = ',D15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9015)DSD
 9015 FORMAT('DSD = ',E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9016)DUSL,DLSL,DTARG,DH
 9016 FORMAT('DUSL,DLSL,DTARG,DH = ',4D15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9017)DKMU,DKSIGM,DEL,XEL
 9017 FORMAT('DKMU,DKSIGM,DEL,XEL = ',3D15.7,E15.7)
      CALL DPWRST('XXX','BUG ')
 9090 CONTINUE
C
      RETURN
      END
      SUBROUTINE EXPAFR(X1,X2,SCALE,AFR)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE AVERAGE FAILURE
C              RATE (AFR) FUNCTION VALUE FOR THE EXPONENTIAL DISTRIBUTION.
C              THE AFR IS DEFINED AS:
C
C              AFR(X1,X2,LOC,SCALE) = (H(X2,LOC,SCALE) - H(X1,LOC,SCALE))/(X2-X1)
C
C              WHERE
C
C              H(X,LOC,SCALE) = (X-LOC)/SCALE
C
C              SO
C
C              AFR(X1,X2) = ((X2-LOC)/SCALE) - (X1-LOC)/SCALE)/(X2-X1)
C                         = 1/SCALE
C
C              NOTE THAT THE LOCATION PARAMETER CANCELS OUT, SO
C              WE OMIT THE ARGUMENT.
C     INPUT  ARGUMENTS--X1     = THE SINGLE PRECISION VALUE AT
C                                WHICH THE AFR FUNCTION IS TO BE
C                                EVALUATED.
C     INPUT  ARGUMENTS--X2     = THE SINGLE PRECISION VALUE AT
C                                WHICH THE AFR FUNCTION IS TO BE
C                                EVALUATED.
C     OUTPUT ARGUMENTS--AFR    = THE SINGLE PRECISION AVERAGE
C                                FAILURE RATE FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION AVERAGE FAILURE RATE
C             FUNCTION VALUE PDF.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS. 
C     RESTRICTIONS--X2 AND X1  SHOULD BE NON-NEGATIVE AND NOT EQUAL.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--NONE.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN. 
C     REFERENCES--TOBIAS AND TRINDALE, "APPLIED RELIABILITY", SECOND
C                 EDITION, CHAPMAN AND HALL/CRC, 1995.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 INFORMATION TECHNOLOGY LABORATORY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE:  301-975-2855
C     ORIGINAL VERSION--MARCH     2005. 
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C---------------------------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      X1MN=MIN(X1,X2)
      X1MX=MAX(X1,X2)
      IF(X1MN.EQ.X1MX)THEN
        WRITE(ICOUT,5)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,47)X1MN
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,48)X1MX
        CALL DPWRST('XXX','BUG ')
        AFR=0.0
        GOTO9000
      ELSEIF(X1MN.LT.0.0)THEN
        WRITE(ICOUT,4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)X1MN
        CALL DPWRST('XXX','BUG ')
        AFR=0.0
        GOTO9000
      ELSEIF(SCALE.LE.0.0)THEN
        WRITE(ICOUT,6)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)SCALE
        CALL DPWRST('XXX','BUG ')
        AFR=0.0
        GOTO9000
      ENDIF
    4 FORMAT('***** ERROR--THE FIRST ARGUMENT TO EXPAFR IS NEGATIVE.')
    5 FORMAT('***** ERROR--THE FIRST AND SECOND ARGUMENTS ',
     1       'TO EXPAFR ARE EQUAL')
    6 FORMAT('***** ERROR--THE FOURTH ARGUMENT TO EXPAFR ',
     1       '(THE SCALE) IS NON-POSITIVE')
   46 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7)
   47 FORMAT('***** THE VALUE OF THE FIRST ARGUMENT IS ',G15.7)
   48 FORMAT('***** THE VALUE OF THE SECOND ARGUMENT IS ',G15.7)
C
C-----START POINT-----------------------------------------------------
C
      AFR=1.0/SCALE
C
 9000 CONTINUE
      RETURN
      END 
      SUBROUTINE EXPCDF(X,CDF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE CUMULATIVE DISTRIBUTION
C              FUNCTION VALUE FOR THE EXPONENTIAL DISTRIBUTION
C              WITH MEAN = 1 AND STANDARD DEVIATION = 1.
C              THIS DISTRIBUTION IS DEFINED FOR ALL NON-NEGATIVE X,
C              AND HAS THE PROBABILITY DENSITY FUNCTION
C              F(X) = EXP(-X).
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE AT
C                                WHICH THE CUMULATIVE DISTRIBUTION
C                                FUNCTION IS TO BE EVALUATED.
C     OUTPUT ARGUMENTS--CDF    = THE SINGLE PRECISION CUMULATIVE
C                                DISTRIBUTION FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION CUMULATIVE DISTRIBUTION
C             FUNCTION VALUE CDF.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS. 
C     RESTRICTIONS--X SHOULD BE NON-NEGATIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--EXP.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN. 
C     REFERENCES--JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--1, 1970, PAGES 207-232.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING LABORATORY (205.03)
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE:  301-921-2315
C     ORIGINAL VERSION--APRIL     1994. 
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C---------------------------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(X.LT.0.0)THEN
CCCCC   WRITE(ICOUT,4)
CCCCC   CALL DPWRST('XXX','BUG ')
CCCCC   WRITE(ICOUT,46)X
CCCCC   CALL DPWRST('XXX','BUG ')
        CDF=0.0
      ELSE
        CDF=1.0-EXP(-X)
      ENDIF
C
CCCC4 FORMAT('***** WARNING--THE FIRST ARGUMENT TO EXPCDF IS NEGATIVE.')
CCC46 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7)
C
      RETURN
      END 
      SUBROUTINE EXPCHA(X,HAZ)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE CUMULATIVE HAZARD
C              FUNCTION VALUE FOR THE EXPONENTIAL DISTRIBUTION
C              WITH MEAN = 1 AND STANDARD DEVIATION = 1.
C              THIS DISTRIBUTION IS DEFINED FOR ALL NON-NEGATIVE X,
C              AND HAS THE PROBABILITY DENSITY FUNCTION
C              F(X) = EXP(-X) AND
C              CUMULATIVE HAZARD FUNCTION
C              H(X)=X.
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE AT
C                                WHICH THE PROBABILITY DENSITY
C                                FUNCTION IS TO BE EVALUATED.
C     OUTPUT ARGUMENTS--HAZ    = THE SINGLE PRECISION
C                                CUMULATIVE HAZARD FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION CUMULATIVE HAZARD
C             FUNCTION VALUE PDF.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS. 
C     RESTRICTIONS--X SHOULD BE NON-NEGATIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--EXP.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN. 
C     REFERENCES--JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--1, 1970, CHAPTER 19.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING LABORATORY (205.03)
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE:  301-975-2855
C     ORIGINAL VERSION--APRIL     1998. 
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C---------------------------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(X.LT.0.0)THEN
        WRITE(ICOUT,4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)X
        CALL DPWRST('XXX','BUG ')
        HAZ=0.0
      ELSE
        HAZ=X
      ENDIF
    4 FORMAT('***** WARNING--THE FIRST ARGUMENT TO EXPHAZ IS NEGATIVE.')
   46 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7)
C
      RETURN
      END 
      DOUBLE PRECISION FUNCTION EXPFUN (DA)
C
C     PURPOSE--THIS ROUTINE IS USED IN FINDING THE LIKELIHOOD RATIO
C              BASED CONFIDECE INTERVAL FOR THE 1-SAMPLE EXPONENTIAL
C              MODEL WITH TIME CENSORING.  THIS FUNCTION FINDS THE ROOT
C              OF THE EQUATION:
C
C                 2*IR*LN(SIGMAHAT) - (2/SIGMAHAT)*2*SUM[i=1 to N][X(i)]
C                 + 2*IR*LN(A) + (2/A)*SUM[i=1 to N][X(i)] - K
C
C              WITH
C
C                 IR       = NUMBER OF FAILURE TIMES
C                 SIGMAHAT = POINT ESTIMATE OF SIGMA
C                 A        = PARAMETER OF INTEREST
C                 K        = CHSPPF(ALPHA,1)
C
C              NOTE THAT THE SUM[X(I)], K, IR ARE COMPUTED IN
C              DPMLE2 AND PASSED VIA COMMON BLOCK.
C
C              CALLED BY DFZERO ROUTINE FOR FINDING THE ROOT OF A
C              FUNCTION.
C     EXAMPLE--EXPONENTIAL MAXIMUM LIKELIHOOD Y CENSOR
C     REFERENCE--KARL BURY, "STATISTICAL DISTRIBUTIONS IN ENGINEERING",
C                CAMBRIDGE UNIVERSITY PRESS, 1999, CHAPTER 12 (SEE
C                EXAMPLE 12.3).
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBUG, MD 20899-8980
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2004/10
C     ORIGINAL VERSION--OCTOBER    2004.
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DA
C
      DOUBLE PRECISION DC
      DOUBLE PRECISION DK
      DOUBLE PRECISION DR
      DOUBLE PRECISION SHAT
      DOUBLE PRECISION XSUM
      COMMON/EXPCOM/DK,DR,SHAT,XSUM,DC
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C  COMPUTE SOME SUMS
C
      EXPFUN=DC - 2.0D0*(-DR*DLOG(DA) - XSUM/DA) - DK
C
      RETURN
      END
      REAL FUNCTION EXPFU2 (SIGHAT,X,N)
C
C     PURPOSE--THIS ROUTINE IS USED IN FINDING THE MAXIMUM LIKELIHOOD
C              ESTIMATE OF SIGMA FOR THE 1-PARAMETER EXPONENTIAL
C              MODEL FOR GROUPED DATA (NO CENSORING).  THIS FUNCTION
C              FINDS THE ROOT OF THE EQUATION:
C
C                 SUM[i=1 to k-1][N(i)*(X(i)-X(i-1))/
C                     (EXP(X(i)-X(I-1))/SIGMAHAT) - 1) -
C                 SUM[I=2 to k][N(i)*X(i-1)] = 0
C
C              WITH
C
C                 X(i)     = UPPER BOUNDARY OF iTH BIN
C                 N(i)     = COUNT FOR iTH INTERVAL
C                 SIGMAHAT = POINT ESTIMATE OF SIGMA (THIS IS THE
C                            PARAMETER WE ARE ITERATING OVER)
C                 K        = NUMBER OF INTERVALS
C
C              FORMULAS GO FROM 0 TO K.  FOR CONVENIENCE WITH
C              FORTRAN, WE WILL GO FROM 1 TO K+1.
C
C              CALLED BY FZEROY ROUTINE FOR FINDING THE ROOT OF A
C              FUNCTION.
C     EXAMPLE--EXPONENTIAL GROUPED MAXIMUM LIKELIHOOD Y X
C     REFERENCE--JOHNSON, KOTZ, AND BALAKRISHNAN, "CONTINUOUS
C                UNIVARIATE DISTRIBUTIONS--Volume 1", SECOND EDITION,
C                WILEY, 1994, PP. 509-510.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBUG, MD 20899-8980
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2004/10
C     ORIGINAL VERSION--OCTOBER    2004.
C
C---------------------------------------------------------------------
C
      REAL SIGHAT
      REAL X(*)
      REAL N(*)
C
      INTEGER IK
      COMMON/EX2COM/IK
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DSUM1
      DOUBLE PRECISION DSUM2
      DOUBLE PRECISION DTERM1
      DOUBLE PRECISION DNI
      DOUBLE PRECISION DX1
      DOUBLE PRECISION DX2
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C  COMPUTE SOME SUMS
C
      DSUM1=0.0D0
      DSUM2=0.0D0
C
C  COMPUTE SUM FOR FIRST TERM
C
      DO100I=2,IK
        DNI=DBLE(N(I))
        DX1=DBLE(X(I))
        DX2=DBLE(X(I-1))
        DTERM1=DNI*(DX1-DX2)/(DEXP((DX1-DX2)/DBLE(SIGHAT))-1.0D0)
        DSUM1=DSUM1 + DTERM1
  100 CONTINUE
C
C  COMPUTE SUM FOR SECOND TERM
C
      DO200I=3,IK+1
        DNI=DBLE(N(I))
        DX2=DBLE(X(I-1))
        DSUM2=DSUM2 + DNI*DX2
  200 CONTINUE
C
      EXPFU2=REAL(DSUM1-DSUM2)
C
      RETURN
      END
      SUBROUTINE EXPHAZ(X,HAZ)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE HAZARD
C              FUNCTION VALUE FOR THE EXPONENTIAL DISTRIBUTION
C              WITH MEAN = 1 AND STANDARD DEVIATION = 1.
C              THIS DISTRIBUTION IS DEFINED FOR ALL NON-NEGATIVE X,
C              AND HAS THE PROBABILITY DENSITY FUNCTION
C              F(X) = EXP(-X) AND
C              HAZARD FUNCTION
C              H(X)=1.
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE AT
C                                WHICH THE PROBABILITY DENSITY
C                                FUNCTION IS TO BE EVALUATED.
C     OUTPUT ARGUMENTS--HAZ    = THE SINGLE PRECISION
C                                HAZARD FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION HAZARD
C             FUNCTION VALUE PDF.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS. 
C     RESTRICTIONS--X SHOULD BE NON-NEGATIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--EXP.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN. 
C     REFERENCES--JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--1, 1970, CHAPTER 19.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING LABORATORY (205.03)
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE:  301-975-2855
C     ORIGINAL VERSION--APRIL     1998. 
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C---------------------------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(X.LT.0.0)THEN
        WRITE(ICOUT,4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)X
        CALL DPWRST('XXX','BUG ')
        HAZ=0.0
      ELSE
        HAZ=1.0
      ENDIF
    4 FORMAT('***** WARNING--THE FIRST ARGUMENT TO EXPHAZ IS NEGATIVE.')
   46 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',E15.8,' *****')
C
      RETURN
      END 
      DOUBLE PRECISION FUNCTION EXPM1(DX)
C***BEGIN PROLOGUE  EXPM1
C***PURPOSE  Evaluate EXP(X)- 1
C
      IMPLICIT DOUBLE PRECISION (A-H, O-Z)
C
C-----COMMON----------------------------------------------------------
C
      REAL R1MACH
      INCLUDE 'DPCOMC.INC'
      INCLUDE 'DPCOP2.INC'
C
      A=ABS(DX)
      IF(A.LT.D1MACH(4))THEN
        EXPM1=DX
        GOTO9000
      ELSEIF(A.GT.0.697)THEN
        EXPM1=EXP(DX) - 1.0D0
        GOTO9000
      ENDIF
C
      IF(A.GT.1.0D-8)THEN
        Y=EXP(DX) - 1.0D0
      ELSE
        Y=((DX/2.0D0) + 1.0D0)*DX
      ENDIF
      DTERM1=DLNREL(Y)
      EXPM1=Y - (1.0D0 + Y)*(DTERM1 - DX)
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE EXPML1(Y,N,ICASE,IEXPBC,
     1                  ALOWLO,AUPPLO,ALOWSC,AUPPSC,ALPHA,
     1                  NUMALP,NUMOUT,
     1                  XMEAN,XSD,XVAR,XMIN,XMAX,
     1                  ALOCML,ALOCSE,SCALML,SCALSE,
     1                  ALOCBC,ALOBSE,SCABML,SCABSE,
     1                  ISUBRO,IBUGA3,IERROR)
C
C     PURPOSE--THIS ROUTINE COMPUTES THE MAXIMUM LIKELIHOOD ESTIMATES
C              FOR THE EXPONENTIAL DISTRIBUTION FOR THE RAW DATA CASE
C              (I.E., NO CENSORING AND NO GROUPING).  IT WILL ALSO
C              RETURN THE CONFIDENCE INTERVALS FOR THE LOCATION
C              AND SCALE PARAMETERS.  THIS ROUTINE WILL ESTIMATE EITHER
C              THE 2-PARAMETER CASE (I.E., BOTH LOCATION AND SCALE ARE
C              ESTIMATED) OR THE 1-PARAMETER CASE (ONLY SCALE IS
C              ESTIMATED) BASED ON VALUE OF ICASE.
C
C              IT IS ASSUMED THAT BASIC ERROR CHECKING HAS ALREADY BEEN
C              PERFORMED.
C
C              PUT THIS IN A SEPARATE ROUTINE AS IT MAY BE CALLED
C              FROM MULTIPLE PLACES (DPMLE1 WILL GENERATE THE OUTPUT
C              FOR THE EXPONENTIAL MLE COMMAND).
C
C     REFERENCE--KARL BURY, "STATISTICAL DISTRIBUTIONS IN ENGINEERING",
C                CAMBRIDGE UNIVERSITY PRESS, 1999, CHAPTER 12.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2010/1
C     ORIGINAL VERSION--JANUARY   2010. EXTRACTED AS A SEPARATE
C                                       SUBROUTINE (FROM DPMLE1)
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      DIMENSION Y(*)
      DIMENSION ALOWLO(*)
      DIMENSION AUPPLO(*)
      DIMENSION ALOWSC(*)
      DIMENSION AUPPSC(*)
      DIMENSION ALPHA(*)
C
      CHARACTER*4 ICASE
      CHARACTER*4 IEXPBC
      CHARACTER*4 ISUBRO
      CHARACTER*4 IBUGA3
      CHARACTER*4 IERROR
C
      CHARACTER*40 IDIST
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
      CHARACTER*4 ISTEPN
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='EXPM'
      ISUBN2='L1  '
      IERROR='NO'
C
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'PML1')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,51)
   51   FORMAT('**** AT THE BEGINNING OF EXPML1--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,52)IBUGA3,ISUBRO,ICASE,IEXPBC
   52   FORMAT('IBUGA3,ISUBRO,ICASE,IEXPBC = ',3(A4,2X),A4)
        CALL DPWRST('XXX','WRIT')
        DO56I=1,MIN(N,100)
          WRITE(ICOUT,57)I,Y(I)
   57     FORMAT('I,Y(I) = ',I8,G15.7)
          CALL DPWRST('XXX','WRIT')
   56   CONTINUE
      ENDIF
C
C               ******************************************
C               **  STEP 1--                            **
C               **  CARRY OUT CALCULATIONS              **
C               **  FOR NORMAL MLE ESTIMATE             **
C               ******************************************
C
      ISTEPN='1'
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'PML1')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      IDIST='EXPONENTIAL'
      IFLAG=0
      CALL SUMRAW(Y,N,IDIST,IFLAG,
     1            XMEAN,XVAR,XSD,XMIN,XMAX,
     1            ISUBRO,IBUGA3,IERROR)
C
      ALOCML=CPUMIN
      ALOCBC=CPUMIN
      ALOCSE=CPUMIN
      ALOBSE=CPUMIN
      SCALML=CPUMIN
      SCALSE=CPUMIN
      SCABML=CPUMIN
      SCABSE=CPUMIN
      AN=REAL(N)
C
      IF(ICASE.EQ.'1')THEN
C
C       ONE-PARAMETER CASE
C
        SCALML=XMEAN
        SCALSE=SCALML/SQRT(AN)
C
        NU=2*N
        DO1110I=1,NUMALP
          ALP=ALPHA(I)
          P=1.0-(ALP/2.0)
          CALL CHSPPF(P,NU,PPF1)
          P=ALP/2.0
          CALL CHSPPF(P,NU,PPF2)
          ALOWSC(I)=2.0*AN*SCALML/PPF1
          AUPPSC(I)=2.0*AN*SCALML/PPF2
 1110   CONTINUE
C
      ELSEIF(ICASE.EQ.'2')THEN
C
C       TWO-PARAMETER CASE
C
        ALOCML=XMIN
        ALOCBC=(AN*XMIN - XMEAN)/(AN - 1.0)
        SCALML=XMEAN-XMIN
        SCALSE=SCALML/SQRT(AN - 1.0)
        SCABML=AN*(XMEAN - XMIN)/(AN - 1.0)
        SCABSE=SCABML/SQRT(AN - 1.0)
        ALOCSE=SCALML/SQRT(AN*(AN-1.0))
        ALOBSE=SCABML/SQRT(AN*(AN-1.0))
C
        IF(IEXPBC.EQ.'ON')THEN
          UTEMP=ALOCBC
          SCTEMP=SCABML
        ELSE
          UTEMP=ALOCML
          SCTEMP=SCALML
        ENDIF
C
        NU2=2*(N-1)
        DO2120I=1,NUMALP
          ALP=ALPHA(I)
          P=1.0-(ALP/2.0)
          CALL CHSPPF(P,NU2,PPF3)
          P=ALP/2.0
          CALL CHSPPF(P,NU2,PPF4)
          ALOWSC(I)=2.0*AN*SCTEMP/PPF3
          AUPPSC(I)=2.0*AN*SCTEMP/PPF4
          P=1.0-ALP
          ACONS1=(ALP/2.0)**(1.0/(1.0-AN)) - 1.0
          ACONS2=(1.0 - ALP/2.0)**(1.0/(1.0-AN)) - 1.0
          ATEMP1=XMIN - SCTEMP*ACONS1
          ATEMP2=XMIN - SCTEMP*ACONS2
          ALOWLO(I)=MIN(ATEMP1,ATEMP2)
          AUPPLO(I)=MAX(ATEMP1,ATEMP2)
 2120   CONTINUE
      ENDIF
C 
      NUMOUT=NUMALP
C
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'PML1')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9011)
 9011   FORMAT('**** AT THE END OF EXPML1--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9013)N,XMEAN,XSD,XMIN,XMAX
 9013   FORMAT('N,XMEAN,XSD,XMIN,XMAX = ',I8,4G15.7)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9017)ALOCML,SCALML,ALOCSE,SCALSE
 9017   FORMAT('ALOCML,SCALML,ALOCSE,SCALSE = ',4G15.7)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9019)ALOCBC,SCALBC,ALOBSE,SCABSE
 9019   FORMAT('ALOCBC,SCALBC,ALOBSE,SCABSE = ',4G15.7)
        CALL DPWRST('XXX','WRIT')
      ENDIF
C
      RETURN
      END
      SUBROUTINE EXPML2(Y,TAG,N,ICASPL,ICASE,TEND,TEMP1,MAXNXT,
     1                  XMEAN,XSD,XVAR,XMIN,XMAX,XSUM,
     1                  ALOCML,ALOCSE,SCALML,SCALSE,
     1                  IR,IM,AN,AR,AM,
     1                  ISUBRO,IBUGA3,IERROR)
C
C     PURPOSE--THIS ROUTINE COMPUTES THE MAXIMUM LIKELIHOOD ESTIMATES
C              FOR THE EXPONENTIAL DISTRIBUTION FOR THE RAW DATA CASE
C              WITH TIME CENSORING.  THIS ROUTINE GENERATES ONLY THE
C              POINT ESTIMATES FOR THE LOCATION AND SCALE PARAMETERS.
C              IT WILL ESTIMATE EITHER THE 2-PARAMETER CASE (I.E.,
C              BOTH LOCATION AND SCALE ARE ESTIMATED) OR THE 1-PARAMETER
C              CASE (ONLY SCALE IS ESTIMATED) BASED ON VALUE OF ICASE.
C
C              IT IS ASSUMED THAT BASIC ERROR CHECKING HAS ALREADY BEEN
C              PERFORMED.
C
C              PUT THIS IN A SEPARATE ROUTINE AS IT MAY BE CALLED
C              FROM MULTIPLE PLACES (DPMLE2 WILL GENERATE THE OUTPUT
C              FOR THE EXPONENTIAL MLE COMMAND).
C
C     REFERENCE--KARL BURY, "STATISTICAL DISTRIBUTIONS IN ENGINEERING",
C                CAMBRIDGE UNIVERSITY PRESS, 1999, CHAPTER 12.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2010/6
C     ORIGINAL VERSION--JUNE      2010. EXTRACTED AS A SEPARATE
C                                       SUBROUTINE (FROM DPMLE2)
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      DIMENSION Y(*)
      DIMENSION TAG(*)
      DIMENSION TEMP1(*)
C
      CHARACTER*4 ICASPL
      CHARACTER*4 ICASE
      CHARACTER*4 ISUBRO
      CHARACTER*4 IBUGA3
      CHARACTER*4 IERROR
C
      CHARACTER*4 IWRITE
      CHARACTER*40 IDIST
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
      CHARACTER*4 ISTEPN
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='EXPM'
      ISUBN2='L2  '
      IERROR='NO'
C
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'PML2')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,51)
   51   FORMAT('**** AT THE BEGINNING OF EXPML2--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,52)IBUGA3,ISUBRO,ICASPL,TEND,MAXNXT
   52   FORMAT('IBUGA3,ISUBRO,ICASE,TEND,MAXNST = ',
     1         2(A4,2X),A4,G15.7,I8)
        CALL DPWRST('XXX','WRIT')
        DO56I=1,MIN(N,100)
          WRITE(ICOUT,57)I,Y(I),TAG(I)
   57     FORMAT('I,Y(I),TAG(I) = ',I8,2G15.7)
          CALL DPWRST('XXX','WRIT')
   56   CONTINUE
      ENDIF
C
C               ******************************************
C               **  STEP 1--                            **
C               **  CARRY OUT CALCULATIONS              **
C               **  FOR EXPONENTIAL MLE ESTIMATE        **
C               ******************************************
C
      ISTEPN='1'
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'PML2')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      IDIST='EXPONENTIAL'
      CALL CKCENS(TAG,TEMP1,N,IDIST,
     1            ISUBRO,IBUGA3,IERROR)
      IF(IERROR.EQ.'YES')GOTO9000
C
      IWRITE='OFF'
      IFLAG=0
      CALL SUMRAW(Y,N,IDIST,IFLAG,
     1            XMEAN,XVAR,XSD,XMIN,XMAX,
     1            ISUBRO,IBUGA3,IERROR)
C
      CALL SUMDP(Y,N,IWRITE,XSUM,IBUGA3,IERROR)
C
      ALOCML=CPUMIN
      ALOCSE=CPUMIN
      SCALML=CPUMIN
      SCALSE=CPUMIN
C
      CALL SORTC(Y,TAG,N,Y,TAG)
      IR=0
      DO2120I=1,N
        IF(TAG(I).EQ.1.0)IR=IR+1
 2120 CONTINUE
      IM=N-IR
C
      DR=DBLE(IR)
C
      IF(IM.EQ.0)THEN
        ICASE='NONE'
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,2131)
 2131   FORMAT('***** WARNING FROM EXPONENTIAL MAXIMUM LIKELIHOOD--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,2133)
 2133   FORMAT('      NO CENSORING TIMES DETECTED.  IT IS RECOMMENDED')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,2135)
 2135   FORMAT('      THAT THE FULL SAMPLE SYNTAX BE USED:')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,2137)
 2137   FORMAT('      EXPONENTIAL MAXIMUM LIKELIHOOD  Y')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','WRIT')
      ELSE
        ICASE='SING'
        AHOLD=Y(IR+1)
        DO2140I=IR+1,N
          IF(Y(I).NE.AHOLD)THEN
            ICASE='MULT'
            GOTO2149
          ENDIF
 2140   CONTINUE
 2149   CONTINUE
      ENDIF
C
C               ************************************
C               **  STEP 41--                     **
C               **  CARRY OUT CALCULATIONS        **
C               **  FOR EXPONENTIAL MLE           **
C               **  ESTIMATE (TIME CENSORED CASE) **
C               ************************************
C
      ISTEPN='41'
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'MLE2')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      IERROR='NO'
      IWRITE='OFF'
      AN=REAL(N)
      AR=REAL(IR)
      AM=REAL(IM)
C
C     ESTIMATES FOR 1-PARAMETER MODEL
C
      IF(ICASPL.EQ.'1EXP')THEN
        ALOCML=0.0
        SCALML=XSUM/AR
        SCALSE=SCALML/SQRT(AR)
      ELSE
C
C     ESTIMATES FOR 2-PARAMETER MODEL
C
C     NOTE THAT THERE IS NO SIMPLE FORMULA FOR THE STANDARD ERROR
C     OF LOCATION PARAMETER.
C
        ALOCML=XMIN
        ALOCSE=CPUMIN
        DSUM1=0.0D0
        DO4120I=1,N
          DSUM1=DSUM1 + DBLE(Y(I) - XMIN)
 4120   CONTINUE
        SCALML=REAL(DSUM1/DBLE(IR))
        SCALSE=SCALML/SQRT(AR)
      ENDIF
C
C
 9000 CONTINUE
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'PML2')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9011)
 9011   FORMAT('**** AT THE END OF EXPML2--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9013)N,XMEAN,XSD,XMIN,XMAX
 9013   FORMAT('N,XMEAN,XSD,XMIN,XMAX = ',I8,4G15.7)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9017)ALOCML,SCALML,ALOCSE,SCALSE
 9017   FORMAT('ALOCML,SCALML,ALOCSE,SCALSE = ',4G15.7)
        CALL DPWRST('XXX','WRIT')
      ENDIF
C
      RETURN
      END
      SUBROUTINE EXPML3(Y,TAG,XTEMP,N,ICASPL,ICASE,TEND,MAXNXT,
     1                  XMEAN,XSD,XVAR,XMIN,XMAX,XSUM,
     1                  ALOCML,ALOCSE,SCALML,SCALSE,
     1                  IR,IM,AN,AR,AM,
     1                  ISUBRO,IBUGA3,IERROR)
C
C     PURPOSE--THIS ROUTINE COMPUTES THE MAXIMUM LIKELIHOOD ESTIMATES
C              FOR THE EXPONENTIAL DISTRIBUTION FOR THE RAW DATA CASE
C              WITH FAILURE CENSORING.  THIS ROUTINE GENERATES ONLY THE
C              POINT ESTIMATES FOR THE LOCATION AND SCALE PARAMETERS.
C              IT WILL ESTIMATE EITHER THE 2-PARAMETER CASE (I.E.,
C              BOTH LOCATION AND SCALE ARE ESTIMATED) OR THE 1-PARAMETER
C              CASE (ONLY SCALE IS ESTIMATED) BASED ON VALUE OF ICASE.
C
C              IT IS ASSUMED THAT BASIC ERROR CHECKING HAS ALREADY BEEN
C              PERFORMED.
C
C              PUT THIS IN A SEPARATE ROUTINE AS IT MAY BE CALLED
C              FROM MULTIPLE PLACES (DPMLE3 WILL GENERATE THE OUTPUT
C              FOR THE EXPONENTIAL MLE COMMAND).
C
C     REFERENCE--KARL BURY, "STATISTICAL DISTRIBUTIONS IN ENGINEERING",
C                CAMBRIDGE UNIVERSITY PRESS, 1999, CHAPTER 12.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2010/6
C     ORIGINAL VERSION--JUNE      2010. EXTRACTED AS A SEPARATE
C                                       SUBROUTINE (FROM DPMLE3)
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      DIMENSION Y(*)
      DIMENSION TAG(*)
      DIMENSION XTEMP(*)
C
      CHARACTER*4 ICASPL
      CHARACTER*4 ICASE
      CHARACTER*4 ISUBRO
      CHARACTER*4 IBUGA3
      CHARACTER*4 IERROR
C
      CHARACTER*4 IWRITE
      CHARACTER*40 IDIST
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
      CHARACTER*4 ISTEPN
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='EXPM'
      ISUBN2='L3  '
      IERROR='NO'
C
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'PML3')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,51)
   51   FORMAT('**** AT THE BEGINNING OF EXPML3--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,52)IBUGA3,ISUBRO,ICASPL,TEND,MAXNXT
   52   FORMAT('IBUGA3,ISUBRO,ICASE,TEND,MAXNXT = ',
     1         2(A4,2X),A4,G15.7,I8)
        CALL DPWRST('XXX','WRIT')
        DO56I=1,MIN(N,100)
          WRITE(ICOUT,57)I,Y(I),TAG(I)
   57     FORMAT('I,Y(I),TAG(I) = ',I8,2G15.7)
          CALL DPWRST('XXX','WRIT')
   56   CONTINUE
      ENDIF
C
C               ******************************************
C               **  STEP 1--                            **
C               **  CARRY OUT CALCULATIONS              **
C               **  FOR EXPONENTIAL MLE ESTIMATE        **
C               ******************************************
C
      ISTEPN='1'
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'PML3')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      IDIST='EXPONENTIAL'
      CALL CKCENS(TAG,XTEMP,N,IDIST,
     1            ISUBRO,IBUGA3,IERROR)
      IF(IERROR.EQ.'YES')GOTO9000
C
      IWRITE='OFF'
      IFLAG=0
      CALL SUMRAW(Y,N,IDIST,IFLAG,
     1            XMEAN,XVAR,XSD,XMIN,XMAX,
     1            ISUBRO,IBUGA3,IERROR)
C
      CALL SUMDP(Y,N,IWRITE,XSUM,IBUGA3,IERROR)
C
      ALOCML=CPUMIN
      ALOCSE=CPUMIN
      SCALML=CPUMIN
      SCALSE=CPUMIN
C
      CALL SORTC(Y,TAG,N,Y,TAG)
      IR=0
      DO2120I=1,N
        IF(TAG(I).EQ.1.0)IR=IR+1
 2120 CONTINUE
      IM=N-IR
C
      DR=DBLE(IR)
C
      IF(IM.EQ.0)THEN
        ICASE='NONE'
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,2131)
 2131   FORMAT('***** WARNING FROM EXPONENTIAL MAXIMUM LIKELIHOOD--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,2133)
 2133   FORMAT('      NO CENSORING TIMES DETECTED.  IT IS RECOMMENDED')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,2135)
 2135   FORMAT('      THAT THE FULL SAMPLE SYNTAX BE USED:')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,2137)
 2137   FORMAT('      EXPONENTIAL MAXIMUM LIKELIHOOD  Y')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','WRIT')
      ELSE
        ICASE='SING'
        AHOLD=Y(IR+1)
        DO2140I=IR+1,N
          IF(Y(I).NE.AHOLD)THEN
            ICASE='MULT'
            GOTO2149
          ENDIF
 2140   CONTINUE
 2149   CONTINUE
      ENDIF
C
C               ************************************
C               **  STEP 41--                     **
C               **  CARRY OUT CALCULATIONS        **
C               **  FOR EXPONENTIAL MLE           **
C               **  ESTIMATE (TIME CENSORED CASE) **
C               ************************************
C
      ISTEPN='41'
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'MLE2')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      IERROR='NO'
      IWRITE='OFF'
      AN=REAL(N)
      AR=REAL(IR)
      AM=REAL(IM)
C
C     ESTIMATES FOR 1-PARAMETER MODEL
C
C     SIGMAHAT = (1/R)*SUM[i=1 to r][(1 + b(i)X(i)]
C
C     WHERE b(i) = NUMBER OF ITEMS CENSORED AT TIME i.
C
      IF(ICASPL.EQ.'1EXP')THEN
        ALOCML=0.0
        DO4103I=1,N
          IF(TAG(I).EQ.1.0)THEN
            AHOLD=Y(I)
            NCEN=0
            DO4105J=1,N
              IF(J.NE.I .AND. TAG(J).EQ.0.0 .AND. Y(J).EQ.AHOLD)THEN
                NCEN=NCEN+1
              ENDIF
 4105       CONTINUE
            XTEMP(I)=REAL(NCEN)
          ELSE
            XTEMP(I)=0.0
          ENDIF
 4103   CONTINUE
C
        DSUM1=0.0D0
        DO4107I=1,N
          IF(TAG(I).EQ.1.0)THEN
            DSUM1=DSUM1 + DBLE(1.0 + XTEMP(I))*DBLE(Y(I))
          ENDIF
 4107   CONTINUE
        SCALML=REAL(DSUM1/DR)
        SCALSE=SCALML/SQRT(AR)
C
      ELSE
C
C     ESTIMATES FOR 2-PARAMETER MODEL
C
        IF(ICASE.EQ.'SING')THEN
          DSUM1=0.0D0
          DO4145I=1,IR
            DSUM1=DSUM1 + DBLE(Y(I))
 4145     CONTINUE
          YSUMR=REAL(DSUM1)
C
          ALOCML=(1.0/(AN*(AR-1.0)))*(AN*AR*XMIN - YSUMR + AM*Y(IR))
          SCALML=(1.0/(AR-1.0))*(YSUMR - AN*Y(1) + AM*Y(IR))
          ALOCSE=(SCALML/AN)*SQRT(AR/(AR-1.0))
          SCALSE=SCALML/SQRT(AR-1.0)
        ENDIF
      ENDIF
C
 9000 CONTINUE
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'PML3')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9011)
 9011   FORMAT('**** AT THE END OF EXPML3--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9013)N,XMEAN,XSD,XMIN,XMAX
 9013   FORMAT('N,XMEAN,XSD,XMIN,XMAX = ',I8,4G15.7)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9017)ALOCML,SCALML,ALOCSE,SCALSE
 9017   FORMAT('ALOCML,SCALML,ALOCSE,SCALSE = ',4G15.7)
        CALL DPWRST('XXX','WRIT')
      ENDIF
C
      RETURN
      END
      SUBROUTINE EXPML4(Y,X1,X2,N,NUMV,MAXNXT,
     1                  XTEMP,TEMP2,TEMP3,
     1                  XMEAN,XVAR,XSD,XMIN,XMAX,NTOT,
     1                  SCALML,SCALSE,
     1                  ISUBRO,IBUGA3,IERROR)
C
C     PURPOSE--THIS ROUTINE COMPUTES THE MAXIMUM LIKELIHOOD ESTIMATES
C              FOR THE 1-PARAMETER EXPONENTIAL DISTRIBUTION FOR THE
C              UNCENSORED CASE WITH GROUPED DATA.
C
C              IT IS ASSUMED THAT BASIC ERROR CHECKING HAS ALREADY BEEN
C              PERFORMED.  SPECIFICALLY, THE SAMPLE SIZE AND THE
C              PRESENCE OF NON-NEGATIVE VALUES.
C
C     REFERENCE--JOHNSON, KOTZ, AND BALAKRISHNAN, "CONTINUOUS
C                UNIVARIATE DISTRIBUTIONS--Volume 1", SECOND EDITION,
C                WILEY, 1994, PP. 509-510.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2010/7
C     ORIGINAL VERSION--JULY      2010. EXTRACT FROM DPMLE4
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 ISUBRO
      CHARACTER*4 IBUGA3
      CHARACTER*4 IERROR
C
      CHARACTER*4 IWRITE
      CHARACTER*40 IDIST
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
      CHARACTER*4 ISTEPN
C
      INTEGER IFLAG
      INTEGER IFLAG1
      INTEGER IFLAG2
C
      COMMON/EX2COM/NK
      REAL     EXPFU2
      EXTERNAL EXPFU2
C
      DOUBLE PRECISION DSUM1
      DOUBLE PRECISION DTERM1
      DOUBLE PRECISION DSIGMA
      DOUBLE PRECISION DX1
      DOUBLE PRECISION DX2
C
C---------------------------------------------------------------------
C
      DIMENSION Y(*)
      DIMENSION X1(*)
      DIMENSION X2(*)
      DIMENSION XTEMP(*)
      DIMENSION TEMP2(*)
      DIMENSION TEMP3(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='EXPM'
      ISUBN2='L4  '
      IERROR='NO'
C
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'PML4')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,51)
   51   FORMAT('**** AT THE BEGINNING OF EXPML4--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,52)IBUGA3,ISUBRO
   52   FORMAT('IBUGA3,ISUBRO = ',A4,2X,A4)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,55)N,NUMV
   55   FORMAT('N,NUMV = ',2I8)
        CALL DPWRST('XXX','WRIT')
        DO56I=1,N
          WRITE(ICOUT,57)I,X1(I),X2(I),Y(I)
   57     FORMAT('I,X1(I),X2(I),Y(I) = ',I8,3G15.7)
          CALL DPWRST('XXX','WRIT')
   56   CONTINUE
      ENDIF
C
C               ******************************************
C               **  STEP 1--                            **
C               **  COMPUTE SUMMARY STATISTICS          **
C               ******************************************
C
      ISTEPN='1'
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'PML4')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      IF(NUMV.EQ.2)THEN
        IFLAG1=1
        IFLAG2=0
        CALL SUMGRP(Y,X1,N,IDIST,IFLAG1,IFLAG2,
     1              XTEMP,TEMP2,TEMP3,MAXNXT,
     1              XMEAN,XVAR,XSD,XMIN,XMAX,NTOT,
     1              ISUBRO,IBUGA3,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
      ELSEIF(NUMV.EQ.3)THEN
        IFLAG1=1
        IFLAG2=0
        CALL SUMGR2(Y,X1,X2,N,IDIST,IFLAG1,IFLAG2,
     1              XTEMP,TEMP2,TEMP3,MAXNXT,
     1              XMEAN,XVAR,XSD,XMIN,XMAX,NTOT,
     1              ISUBRO,IBUGA3,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
      ELSE
        IERROR='YES'
        GOTO9000
      ENDIF
C
C               ******************************************
C               **  STEP 2--                            **
C               **  CARRY OUT CALCULATIONS              **
C               **  FOR EXPONENTIAL MLE ESTIMATE        **
C               ******************************************
C
      ISTEPN='2'
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'PML4')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      IERFLG=0
      IERROR='NO'
      IWRITE='OFF'
C
      IF(NUMV.EQ.2)THEN
C
C       DEFINE INTERVALS
C
        DELTA=(X1(2)-X1(1))/2.0
        ICNT=1
        X2(ICNT)=0.0
        ICNT=2
        X2(ICNT)=X1(1)+DELTA
        DO2110I=2,N
          DELTA=(X1(I)-X1(I-1))/2.0
          ICNT=ICNT+1
          X2(ICNT)=X1(I)+DELTA
 2110   CONTINUE
        NK=ICNT
        ICNT=ICNT+1
        X2(ICNT)=CPUMAX
        Y(NK)=0.0
        DO2120I=1,NK
          X1(I)=X2(I)
 2120   CONTINUE
C
      ELSE
C
C       DEFINE INTERVALS
C
        ICNT=0
        DO2130I=1,N
          ICNT=ICNT+1
          X1(ICNT)=X2(ICNT)
 2130   CONTINUE
        ICNT=ICNT+1
        X1(ICNT)=CPUMAX
        X2(ICNT)=CPUMAX
        NK=ICNT
        Y(N+1)=0.0
C
      ENDIF
C
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'MLE4')THEN
        WRITE(ICOUT,2155)NUMV,NK
 2155   FORMAT('NUMV,NK = ',2I8)
        CALL DPWRST('XXX','WRIT')
        DO2157I=1,NK+1
          WRITE(ICOUT,2156)I,X1(I),Y(I)
 2156     FORMAT('I,X1(I),Y(I) =',I8,2G15.7)
          CALL DPWRST('XXX','WRIT')
 2157   CONTINUE
      ENDIF
C
C     ESTIMATES FOR 1-PARAMETER MODEL.  USE FZEROY TO FIND ROOT OF
C     EQUATION GIVEN IN EXPFU2 (COMMENTS IN THAT ROUTINE GIVE
C     ACTUAL EQUATION).  USE OVERALL MEAN AS STARTING VALUE.
C
      AE=1.E-6
      RE=1.E-6
      IFLAG=0
      XLOW=X1(1)
      XUP=X1(NK-1)
      CALL FZEROY(EXPFU2,XLOW,XUP,XMEAN,RE,AE,IFLAG,X1,Y)
      SCALML=XLOW
C
      IF(IFLAG.EQ.2)THEN
C
C  NOTE: SUPPRESS THIS MESSAGE FOR NOW.
CCCCC   WRITE(ICOUT,999)
CCCCC   CALL DPWRST('XXX','BUG ')
CCCCC   WRITE(ICOUT,111)
CC111   FORMAT('***** WARNING FROM GROUPED EXPONENTIAL MAXIMUM ',
CCCCC1         'LIKELIHOOD--')
CCCCC   CALL DPWRST('XXX','BUG ')
CCCCC   WRITE(ICOUT,113)
CC113   FORMAT('      ESTIMATE OF SIGMA MAY NOT BE COMPUTED TO ',
CCCCC1         'DESIRED TOLERANCE.')
CCCCC   CALL DPWRST('XXX','BUG ')
      ELSEIF(IFLAG.EQ.3)THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,121)
  121   FORMAT('***** WARNING FROM GROUPED EXPONENTIAL MAXIMUM ',
     1         'LIKELIHOOD--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,123)
  123   FORMAT('      ESTIMATE OF SIGMA MAY BE NEAR A SINGULAR POINT.')
        CALL DPWRST('XXX','BUG ')
      ELSEIF(IFLAG.EQ.4)THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,131)
  131   FORMAT('***** ERROR FROM GROUPED EXPONENTIAL MAXIMUM ',
     1         'LIKELIHOOD--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,133)
  133   FORMAT('      APPROPRIATE BRACKETING INTERVAL NOT FOUND.')
        CALL DPWRST('XXX','BUG ')
      ELSEIF(IFLAG.EQ.5)THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,141)
  141   FORMAT('***** WARNING FROM GROUPED EXPONENTIAL MAXIMUM ',
     1         'LIKELIHOOD--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,143)
  143   FORMAT('      MAXIMUM ITERATIONS EXCEEDED.')
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
      AN=REAL(NTOT)
      DSIGMA=DBLE(SCALML)
      DSUM1=0.0D0
      DO150I=2,NK
        DX1=DBLE(X1(I))
        DX2=DBLE(X1(I-1))
        DTERM1=(DX1-DX2)**2/(DEXP(DX1/DSIGMA) - DEXP(DX2/DSIGMA))
        DSUM1=DSUM1 + DTERM1
  150 CONTINUE
      SCALSE=SQRT(AN*REAL(DSUM1))
C
 9000 CONTINUE
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'PML4')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9011)
 9011   FORMAT('**** AT THE END OF EXPML4--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9012)XMEAN,XSD,XMIN,XMAX
 9012   FORMAT('XMEAN,XSD,XMIN,XMAX = ',4G15.7)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9013)SCALML,SCALSE
 9013   FORMAT('SCALML,SCALSE = ',2G15.7)
        CALL DPWRST('XXX','WRIT')
      ENDIF
C
      RETURN
      END
      SUBROUTINE EXPPDF(X,PDF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE PROBABILITY DENSITY
C              FUNCTION VALUE FOR THE EXPONENTIAL DISTRIBUTION
C              WITH MEAN = 1 AND STANDARD DEVIATION = 1.
C              THIS DISTRIBUTION IS DEFINED FOR ALL NON-NEGATIVE X,
C              AND HAS THE PROBABILITY DENSITY FUNCTION
C              F(X) = EXP(-X).
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE AT
C                                WHICH THE PROBABILITY DENSITY
C                                FUNCTION IS TO BE EVALUATED.
C     OUTPUT ARGUMENTS--PDF    = THE SINGLE PRECISION PROBABILITY
C                                DENSITY FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION PROBABILITY DENSITY
C             FUNCTION VALUE PDF.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS. 
C     RESTRICTIONS--X SHOULD BE NON-NEGATIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--EXP.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN. 
C     REFERENCES--JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--1, 1970, PAGES 207-232.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING LABORATORY (205.03)
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE:  301-921-2315
C     ORIGINAL VERSION--APRIL     1994. 
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C---------------------------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(X.LT.0.0)THEN
        WRITE(ICOUT,4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)X
        CALL DPWRST('XXX','BUG ')
        PDF=0.0
      ELSE
        PDF=EXP(-X)
      ENDIF
    4 FORMAT('***** WARNING--THE FIRST ARGUMENT TO EXPPDF IS NEGATIVE.')
   46 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7)
C
      RETURN
      END 
      SUBROUTINE EXPPPF(P,PPF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE PERCENT POINT
C              FUNCTION VALUE FOR THE EXPONENTIAL DISTRIBUTION
C              WITH MEAN = 1 AND STANDARD DEVIATION = 1.
C              THIS DISTRIBUTION IS DEFINED FOR ALL NON-NEGATIVE X,
C              AND HAS THE PROBABILITY DENSITY FUNCTION
C              F(X) = EXP(-X).
C              NOTE THAT THE PERCENT POINT FUNCTION OF A DISTRIBUTION
C              IS IDENTICALLY THE SAME AS THE INVERSE CUMULATIVE
C              DISTRIBUTION FUNCTION OF THE DISTRIBUTION.
C     INPUT  ARGUMENTS--P      = THE SINGLE PRECISION VALUE
C                                (BETWEEN 0.0 AND 1.0)
C                                AT WHICH THE PERCENT POINT
C                                FUNCTION IS TO BE EVALUATED.
C     OUTPUT ARGUMENTS--PPF    = THE SINGLE PRECISION PERCENT
C                                POINT FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION PERCENT POINT
C             FUNCTION VALUE PPF.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--P SHOULD BE BETWEEN 0.0 (INCLUSIVELY)
C                   AND 1.0 (EXCLUSIVELY).
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--LOG.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--FILLIBEN, SIMPLE AND ROBUST LINEAR ESTIMATION
C                 OF THE LOCATION PARAMETER OF A SYMMETRIC
C                 DISTRIBUTION (UNPUBLISHED PH.D. DISSERTATION,
C                 PRINCETON UNIVERSITY), 1969, PAGES 21-44, 229-231.
C               --FILLIBEN, 'THE PERCENT POINT FUNCTION',
C                 (UNPUBLISHED MANUSCRIPT), 1970, PAGES 28-31.
C               --JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--1, 1970, PAGES 207-232.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1966)
C     VERSION NUMBER--82/7
C     ORIGINAL VERSION--JUNE      1972.
C     UPDATED         --SEPTEMBER 1975.
C     UPDATED         --NOVEMBER  1975.
C     UPDATED         --DECEMBER  1981.
C     UPDATED         --MAY       1982.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(P.LT.0.0.OR.P.GE.1.0)THEN
        WRITE(ICOUT,1)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)P
        CALL DPWRST('XXX','BUG ')
      ELSE
        PPF=-LOG(1.0-P)
      ENDIF
    1 FORMAT('***** ERROR--THE FIRST ARGUMENT TO EXPPPF IS OUTSIDE ',
     1       'THE ALLOWABLE (0,1) INTERVAL.')
   46 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7)
C
      RETURN
      END
      SUBROUTINE EXPRAN(N,ISEED,X)
C
C     PURPOSE--THIS SUBROUTINE GENERATES A RANDOM SAMPLE OF SIZE N
C              FROM THE EXPONENTIAL DISTRIBUTION
C              WITH MEAN = 1 AND STANDARD DEVIATION = 1.
C              THIS DISTRIBUTION IS DEFINED FOR ALL NON-NEGATIVE X,
C              AND HAS THE PROBABILITY DENSITY FUNCTION
C              F(X) = EXP(-X).
C     INPUT  ARGUMENTS--N      = THE DESIRED INTEGER NUMBER
C                                OF RANDOM NUMBERS TO BE
C                                GENERATED.
C     OUTPUT ARGUMENTS--X      = A SINGLE PRECISION VECTOR
C                                (OF DIMENSION AT LEAST N)
C                                INTO WHICH THE GENERATED
C                                RANDOM SAMPLE WILL BE PLACED.
C     OUTPUT--A RANDOM SAMPLE OF SIZE N
C             FROM THE EXPONENTIAL DISTRIBUTION
C             WITH MEAN = 1 AND STANDARD DEVIATION = 1.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--THERE IS NO RESTRICTION ON THE MAXIMUM VALUE
C                   OF N FOR THIS SUBROUTINE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--UNIRAN.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--LOG.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--TOCHER, THE ART OF SIMULATION,
C                 1963, PAGES 14, 35-36.
C               --HAMMERSLEY AND HANDSCOMB, MONTE CARLO METHODS,
C                 1964, PAGE 36.
C               --FILLIBEN, 'THE PERCENT POINT FUNCTION',
C                 (UNPUBLISHED MANUSCRIPT), 1970, PAGES 28-31.
C               --JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--1, 1970, PAGES 207-232.
C               --HASTINGS AND PEACOCK, STATISTICAL
C                 DISTRIBUTIONS--A HANDBOOK FOR
C                 STUDENTS AND PRACTITIONERS, 1975,
C                 PAGE 58.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1966)
C     VERSION NUMBER--82/7
C     ORIGINAL VERSION--JUNE      1972.
C     UPDATED         --SEPTEMBER 1975.
C     UPDATED         --NOVEMBER  1975.
C     UPDATED         --JULY      1976.
C     UPDATED         --DECEMBER  1981.
C     UPDATED         --MAY       1982.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C---------------------------------------------------------------------
C
      DIMENSION X(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(N.LT.1)THEN
        WRITE(ICOUT, 5)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,47)N
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
    5 FORMAT('***** ERROR--THE FIRST ARGUMENT TO THE ',
     1       'EXPRAN SUBROUTINE IS NON-POSITIVE.')
   47 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',I8,'.')
C
C     GENERATE N UNIFORM (0,1) RANDOM NUMBERS;
C
      CALL UNIRAN(N,ISEED,X)
C
C     GENERATE N EXPONENTIAL RANDOM NUMBERS
C     USING THE PERCENT POINT FUNCTION TRANSFORMATION METHOD.
C
      DO100I=1,N
        X(I)=-LOG(X(I))
  100 CONTINUE
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE EXPSF(P,SF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE SPARSITY
C              FUNCTION VALUE FOR THE EXPONENTIAL DISTRIBUTION
C              WITH MEAN = 1 AND STANDARD DEVIATION = 1.
C              THIS DISTRIBUTION IS DEFINED FOR ALL NON-NEGATIVE X,
C              AND HAS THE PROBABILITY DENSITY FUNCTION
C              F(X) = EXP(-X).
C              NOTE THAT THE SPARSITY FUNCTION OF A DISTRIBUTION
C              IS THE DERIVATIVE OF THE PERCENT POINT FUNCTION,
C              AND ALSO IS THE RECICOUTOCAL OF THE PROBABILITY
C              DENSITY FUNCTION (BUT IN UNITS OF P RATHER THAN X).
C     INPUT  ARGUMENTS--P      = THE SINGLE PRECISION VALUE 
C                                (BETWEEN 0.0 AND 1.0)
C                                AT WHICH THE SPARSITY
C                                FUNCTION IS TO BE EVALUATED.
C     OUTPUT ARGUMENTS--SF     = THE SINGLE PRECISION
C                                SPARSITY FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION SPARSITY
C             FUNCTION VALUE SF.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS. 
C     RESTRICTIONS--P SHOULD BE BETWEEN 0.0 (INCLUSIVELY)
C                   AND 1.0 (EXCLUSIVELY).
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--NONE.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN. 
C     REFERENCES--FILLIBEN, SIMPLE AND ROBUST LINEAR ESTIMATION
C                 OF THE LOCATION PARAMETER OF A SYMMETRIC
C                 DISTRIBUTION (UNPUBLISHED PH.D. DISSERTATION,
C                 PRINCETON UNIVERSITY), 1969, PAGES 21-44, 229-231.
C               --FILLIBEN, 'THE PERCENT POINT FUNCTION',
C                 (UNPUBLISHED MANUSCRIPT), 1970, PAGES 28-31.
C               --JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--1, 1970, PAGES 207-232.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING LABORATORY (205.03)
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE:  301-921-2315
C     ORIGINAL VERSION--APRIL     1994. 
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C---------------------------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(P.LT.0.0.OR.P.GE.1.0)THEN
        WRITE(ICOUT,1)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)P
        CALL DPWRST('XXX','BUG ')
      ELSE
        SF=1.0/(1.0-P)
      ENDIF
    1 FORMAT('***** ERROR--THE FIRST ARGUMENT TO EXPSF IS OUTSIDE ',
     1       'THE ALLOWABLE (0,1) INTERVAL.')
   46 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7,'.')
C
      RETURN
      END 
      SUBROUTINE EXPSMO(X,TEMP,ALPHA,AMSE,NX,IWRITE,Y,IBUGA3,IERROR)
C
C     PURPOSE--COMPUTE EXPONETIAL SMOOTH OF AN ARRAY
C              THE ALPHA PARANETER IDENTIFIES THE SMOOTHING PARAMETER
C     NOTE--IT IS PERMISSIBLE TO HAVE THE OUTPUT VECTOR Y(.)
C           BEING IDENTICAL TO THE INPUT VECTOR X(.).
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--98/5
C     ORIGINAL VERSION--MAY       1998.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 IWRITE
      CHARACTER*4 IBUGA3
      CHARACTER*4 IERROR
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
C
      DOUBLE PRECISION DSUM
C
C---------------------------------------------------------------------
C
      DIMENSION X(*)
      DIMENSION Y(*)
      DIMENSION TEMP(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='EXPS'
      ISUBN2='MO  '
      IERROR='NO'
C
      IF(IBUGA3.EQ.'ON')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,51)
   51   FORMAT('***** AT THE BEGINNING OF EXPSMO--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,52)IBUGA3,IWRITE,N,ALPHA
   52   FORMAT('IBUGA3,IWRITE,N,ALPHA = ',2(A4,2X),I8,G15.7)
        CALL DPWRST('XXX','BUG ')
        DO55I=1,NX
          WRITE(ICOUT,56)I,X(I)
   56     FORMAT('I,X(I) = ',I8,G15.7)
          CALL DPWRST('XXX','BUG ')
   55   CONTINUE
      ENDIF
C
C               **************************************
C               **  COMPUTE EXPONENTIAL SMOOTH      **
C               **************************************
C
      IF(ALPHA.LE.0.0 .OR. ALPHA.GE.1.0)THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,101)
  101   FORMAT('***** ERROR FROM EXPSMO.  SMOOTHING PARAMETER MUST')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,103)
  103   FORMAT('      BE > 0 AND < 1.  THE ENTERED VALUE WAS ',E15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        IERROR='YES'
        GOTO9000
      ENDIF
C
      DSUM=0.0D0
      TEMP(1)=X(1)
      DO200I=2,NX
        ATEMP=X(I)-TEMP(I-1)
        TEMP(I)=ALPHA*ATEMP + TEMP(I-1)
        DSUM=DSUM + DBLE(ATEMP)**2
  200 CONTINUE
      AMSE=REAL(DSUM)/REAL(NX-1)
C
      DO300I=1,NX
        Y(I)=TEMP(I)
  300 CONTINUE
C
      NY=NX
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT.      **
C               *****************
C
 9000 CONTINUE
C
      IF(IBUGA3.EQ.'OFF')GOTO9090
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9011)
 9011 FORMAT('***** AT THE END       OF EXPSMO--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9012)IBUGA3,IERROR
 9012 FORMAT('IBUGA3,IERROR = ',A4,2X,A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9013)NX,NY
 9013 FORMAT('NX,NY = ',2I8)
      CALL DPWRST('XXX','BUG ')
      DO9015I=1,NX
      WRITE(ICOUT,9016)I,X(I),Y(I)
 9016 FORMAT('I,X(I),Y(I) = ',I8,2E15.7)
      CALL DPWRST('XXX','BUG ')
 9015 CONTINUE
 9090 CONTINUE
C
      RETURN
      END
      SUBROUTINE EXPSM2(X,TEMP,ALPHA,AMSE,NX,IWRITE,Y,IBUGA3,IERROR)
C
C     PURPOSE--COMPUTE EXPONETIAL SMOOTH OF AN ARRAY
C              THE ALPHA PARANETER IDENTIFIES THE SMOOTHING PARAMETER
C              NOTE: USE THIS VERSION IF ALPHA NOT SPECIFIED.
C                    USE AN ITERATIVE SEARCH TO FIND THE OPTIMAL
C                    VALUE FOR ALPHA.
C     NOTE--IT IS PERMISSIBLE TO HAVE THE OUTPUT VECTOR Y(.)
C           BEING IDENTICAL TO THE INPUT VECTOR X(.).
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--99/2
C     ORIGINAL VERSION--FEBRUARY  1999.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 IWRITE
      CHARACTER*4 IBUGA3
      CHARACTER*4 IERROR
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
C
C---------------------------------------------------------------------
C
      DIMENSION X(*)
      DIMENSION Y(*)
      DIMENSION TEMP(*)
C
      REAL AMSEV(20)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='EXPS'
      ISUBN2='MO  '
      IERROR='NO'
C
      AX=CPUMIN
C
      IF(IBUGA3.EQ.'OFF')GOTO90
      WRITE(ICOUT,999)
  999 FORMAT(1X)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,51)
   51 FORMAT('***** AT THE BEGINNING OF EXPSM2--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,52)IBUGA3
   52 FORMAT('IBUGA3 = ',A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,53)NX,ALPHA
   53 FORMAT('NX,ALPHA = ',I8,1X,F10.5)
      CALL DPWRST('XXX','BUG ')
      DO55I=1,NX
      WRITE(ICOUT,56)I,X(I)
   56 FORMAT('I,X(I) = ',I8,E15.7)
      CALL DPWRST('XXX','BUG ')
   55 CONTINUE
   90 CONTINUE
C
C               **************************************
C               **  COMPUTE EXPONENTIAL SMOOTH      **
C               **************************************
C
CCCCC FIND BEST ALPHA TO FIRST DECIMAL PLACE.
C
      AMNVAL=CPUMAX
      DO100I=1,9
        ALPHA=REAL(I)/10.
        CALL EXPSMO(X,TEMP,ALPHA,AMSE,NX,IWRITE,Y,IBUGA3,IERROR)
        AMSEV(I)=AMSE
        IF(AMSEV(I).LT.AMNVAL)THEN
          AX=ALPHA
          AMNVAL=AMSEV(I)
        ENDIF
  100 CONTINUE
      ALPHA=AX
C
CCCCC FIND BEST ALPHA TO FIRST DECIMAL PLACE.
C
      AMNVAL=CPUMAX
      D=0.09
      DINC=0.01
      ASTRT=ALPHA-D
      DO200I=1,19
        ALPHA=ASTRT+REAL(I-1)*DINC
        CALL EXPSMO(X,TEMP,ALPHA,AMSE,NX,IWRITE,Y,IBUGA3,IERROR)
        AMSEV(I)=AMSE
        IF(AMSEV(I).LT.AMNVAL)THEN
          AX=ALPHA
          AMNVAL=AMSEV(I)
        ENDIF
  200 CONTINUE 
      ALPHA=AX
C
CCCCC FIND BEST ALPHA TO THIRD DECIMAL PLACE.
C
      AMNVAL=CPUMAX
      D=0.009
      DINC=0.001
      ASTRT=ALPHA-D
      DO300I=1,19
        ALPHA=ASTRT+REAL(I-1)*DINC
        CALL EXPSMO(X,TEMP,ALPHA,AMSE,NX,IWRITE,Y,IBUGA3,IERROR)
        AMSEV(I)=AMSE
        IF(AMSEV(I).LT.AMNVAL)THEN
          AX=ALPHA
          AMNVAL=AMSEV(I)
        ENDIF
  300 CONTINUE 
      ALPHA=AX
C
      IF(IWRITE.EQ.'ON')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,510)ALPHA
  510   FORMAT('FOR EXPONENTIAL SMOOTHING, OPTIMAL VALUE OF ALPHA',
     1         '(TO 3 DECIMAL PLACES) = ',F6.3)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT.      **
C               *****************
C
      IF(IBUGA3.EQ.'OFF')GOTO9090
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9011)
 9011 FORMAT('***** AT THE END       OF EXPSM2--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9012)IBUGA3,IERROR
 9012 FORMAT('IBUGA3,IERROR = ',A4,2X,A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9013)NX
 9013 FORMAT('NX = ',I8)
      CALL DPWRST('XXX','BUG ')
      DO9015I=1,NX
      WRITE(ICOUT,9016)I,X(I),Y(I)
 9016 FORMAT('I,X(I),Y(I) = ',I8,2E15.7)
      CALL DPWRST('XXX','BUG ')
 9015 CONTINUE
 9090 CONTINUE
C
      RETURN
      END
      SUBROUTINE EXTBOU(ICASPL,IBOUND)
C
C     PURPOSE--CERTAIN OF THE PROBABILITY ROUTINES USE LOWER AND
C              UPPER LIMIT PARAMETERS RATHER THAN LOCATION AND
C              SCALE PARAMETERS.  SET THE VALUE OF IBOUND TO 0
C              IF LOCATION AND SCALE PARAMETERS WILL BE USED AND
C              TO 1 IF LOWER AND UPPER LIMIT PARAMETERS WILL BE USED.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORAOTRY
C                 NATIONAL INSTITUTE OF STANDARDS OF TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS OF TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2009/9
C     ORIGINAL VERSION--SEPTEMBER 2009.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 ICASPL
C
C---------------------------------------------------------------------
C
C-----COMMON VARIABLES (GENERAL)--------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
      IBOUND=0
      IF(ICASPL.EQ.'UNIF')IBOUND=1
      IF(ICASPL.EQ.'BETA')IBOUND=1
      IF(ICASPL.EQ.'NCBE')IBOUND=1
      IF(ICASPL.EQ.'TRIA')IBOUND=1
      IF(ICASPL.EQ.'POWF')IBOUND=1
      IF(ICASPL.EQ.'RPOW')IBOUND=1
      IF(ICASPL.EQ.'JOSB')IBOUND=1
      IF(ICASPL.EQ.'TSPO')IBOUND=1
      IF(ICASPL.EQ.'GTOL')IBOUND=1
      IF(ICASPL.EQ.'RGTL')IBOUND=1
      IF(ICASPL.EQ.'SLOP')IBOUND=1
      IF(ICASPL.EQ.'OGIV')IBOUND=1
      IF(ICASPL.EQ.'TSSL')IBOUND=1
      IF(ICASPL.EQ.'TSOG')IBOUND=1
      IF(ICASPL.EQ.'KUMA')IBOUND=1
C
      RETURN
      END
      SUBROUTINE EXTDIG(IINPUT,IDIGIT,NDIGIT,IBUGA3,IERROR)
C
C     PURPOSE--EXTRACT THE DIGITS FROM AN INTEGER.
C              PROCEED LEFT TO RIGHT.
C     INPUT  ARGUMENTS--  IINPUT = AN INTEGER
C     OUTPUT ARGUMENTS--  IDIGIT   = VECTOR OF DIGITS
C                         NDIGIT   = NUMBER OF ELEMENTS IN IDIGIT
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1966)
C               EXCEPTION--HOLLERITH STRINGS IN FORMAT STATEMENTS
C                          DENOTED BY QUOTES RATHER THAN NH.
C     VERSION NUMBER--89.1
C     ORIGINAL VERSION--JANUARY   1989.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 IBUGA3
      CHARACTER*4 IERROR
C
C---------------------------------------------------------------------
C
      DIMENSION IDIGIT(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      IERROR='NO'
      NDIGIT=0
C
      IF(IBUGA3.EQ.'OFF')GOTO90
      WRITE(ICOUT,999)
  999 FORMAT(1X)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,51)
   51 FORMAT('***** AT THE BEGINNING OF EXTDIG--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,52)IINPUT
   52 FORMAT('IINPUT = ',I8)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,53)IBUGA3
   53 FORMAT('IBUGA3 = ',A4)
      CALL DPWRST('XXX','BUG ')
   90 CONTINUE
C
C               **************************************************
C               **  STEP 11--                                   **
C               **  CHECK THE INPUT NUMBER FOR ERRORS           **
C               **************************************************
C
      IF(IINPUT.GE.0)GOTO1190
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1111)
 1111 FORMAT('***** ERROR IN EXTDIG--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1112)
 1112 FORMAT('      THE INPUT NUMBER WAS NEGATIVE.')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1113)IINPUT
 1113 FORMAT('      THE INPUT NUMBER = ',I8)
      CALL DPWRST('XXX','BUG ')
      IERROR='YES'
      GOTO9000
 1190 CONTINUE
C
C               **************************************************
C               **  STEP 12--                                   **
C               **  DETERMINE THE NUMBER OF DIGITS              **
C               **  IN THE NUMBER                               **
C               **************************************************
C
      MAXDIG=9
      IREM=IINPUT
      DO1200I=1,MAXDIG
        IREV=MAXDIG-I+1
        IPOWER=INT(10.0**IREV + 0.0001)
        IRATIO=IREM/IPOWER
        IF(IRATIO.EQ.0)GOTO1200
        GOTO1290
 1200 CONTINUE
      IREV=0
 1290 CONTINUE
      NDIGIT=IREV+1
C
C               **************************************************
C               **  STEP 13--                                   **
C               **  EXTRACT THE INDIVIDUAL DIGITS               **
C               **************************************************
C
      IREM=IINPUT
      J=0
      DO1300I=1,NDIGIT
      J=J+1
      IREV=NDIGIT-I+1
      IPOWER=INT(10**(IREV-1) + 0.01)
      IDIGIT(I)=IREM/IPOWER
      IREM=IREM-IDIGIT(I)*IPOWER
 1300 CONTINUE
C
C               *******************
C               **   STEP 90--   **
C               **   EXIT        **
C               *******************
C
 9000 CONTINUE
      IF(IBUGA3.EQ.'OFF')GOTO9090
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9011)
 9011 FORMAT('***** AT THE END       OF EXTDIG--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9012)IINPUT
 9012 FORMAT('IINPUT = ',I8)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9013)IBUGA3,IERROR
 9013 FORMAT('IBUGA3,IERROR = ',A4,2X,A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9021)NDIGIT
 9021 FORMAT('NDIGIT = ',I8)
      CALL DPWRST('XXX','BUG ')
      IF(NDIGIT.LE.0)GOTO9024
      DO9022I=1,NDIGIT
      WRITE(ICOUT,9023)I,IDIGIT(I)
 9023 FORMAT('I,IDIGIT(I) = ',2I8)
      CALL DPWRST('XXX','BUG ')
 9022 CONTINUE
 9024 CONTINUE
 9090 CONTINUE
C
      RETURN
      END
      SUBROUTINE EXTDIS(ICOM,ICOM2,IHARG,IHARG2,NUMARG,JMIN,JMAX,
     1                  IDISCS,IDISNM,IDISPR,IFOUND,ILOCV,
     1                  ISUBRO,IBUGG3,IERROR)
C
C     PURPOSE--EXTRACT THE NAME OF ONE OF 150+ DISTRIBUTIONS.  THIS
C              IS A COMMON ROUTINE CALLED BY:
C                1) DPPP    = <DIST> PROBABILITY PLOT
C                2) DP1KST  = <DIST> KOLMOGOROV SMIRNOV GOODNESS OF FIT
C                3) DPCHSQ  = <DIST> CHI-SQUARE SMIRNOV GOODNESS OF FIT
C                4) DPPPCC  = <DIST> PPCC PLOT
C                5) DPMLWE  = <DIST> MAXIMUM LIKELIHOOD
C                6) DPLRDI  = <DIST1> <DIST2> DISTRIBUTIONAL LIKELIHOOD
C                                             RATIO
C
C              NOTE THAT NOT ALL COMMANDS MAY SUPPORT ALL DISTRIBUTIONS.
C
C              THE FOLLOWING DISTRIBUTIONS ARE SUPPORTED:
C
C              1 ) UNIFORM
C              2 ) NORMAL
C              3 ) LOGISTIC
C              4 ) DOUBLE EXPONENTIAL
C              5 ) CAUCHY
C              6 ) TUKEY LAMBDA
C              7 ) LOGNORMAL
C              8 ) HALFNORMAL
C              9 ) T
C              10) CHI-SQUARED
C              11) F
C              12) EXPONENTIAL
C              13) GAMMA
C              14) BETA
C              15) WEIBULL---MIN & MAX
C              16) EXTREME VALUE TYPE 1 (GUMBEL)--MIN & MAX
C              17) EXTREME VALUE TYPE 2 (FRECHET)--MIN & MAX
C              18) PARETO
C              19) BINOMIAL
C              20) GEOMETRIC
C              21) POISSON
C              22) NEGATIVE BINOMIAL
C              23) SEMI-CIRCULAR
C              24) TRIANGULAR
C              25) INVERSE GAUUSIAN
C              26) WALD
C              27) RECIPROCAL INVERSE GAUUSIAN
C              28) FAILURE TIME
C              29) GENERALIZED PARETO
C              30) DISCRETE UNIFORM
C              31) NON-CENTRAL T
C              32) NON-CENTRAL F
C              33) NON-CENTRAL CHI-SQUARE
C              34) NON-CENTRAL BETA
C              35) DOUBLY NON-CENTRAL T
C              36) DOUBLY NON-CENTRAL F
C              36) HYPER-GEOMETRIC
C              37) VON-MISES
C              38) POWER NORMAL
C              39) POWER LOGNORMAL
C              40) COSINE
C              41) ALPHA
C              42) POWER FUNCTION
C              43) CHI
C              44) LOGARITMIC SERIES
C              45) LOG LOGISTIC
C              46) GENERALIZED GAMMA
C              47) WARING
C              48) ANGLIT
C              49) ARCSIN
C              50) FOLDED NORMAL
C              51) TRUNCATED NORMAL
C              52) LOG GAMMA
C              53) HYPERBOLIC SECANT
C              54) GOMPERTZ
C              55) PARETO SECOND KIND
C              56) DOUBLE WEIBULL
C              57) WRAPPED-UP CAUCHY
C              58) EXPONENTIAL WEIBULL
C              59) TRUNCATED EXPONENTIAL
C              60) GENERALIZED LOGISTIC
C              61) EXPONENTIAL POWER
C              62) DOUBLE GAMMA
C              63) MIELKE'S BETA-KAPPA
C              64) FOLDED CAUCHY
C              65) BETA BINOMIAL
C              66) BETA PASCAL
C              67) GENERALIZED EXPONENTIAL
C              68) RECIPROCAL PROB
C              69) NORMAL MIXTURE
C              70) INVERTED GAMMA
C              71) GENERALIZED TUKEY LAMBDA
C              72) JOHNSON SB
C              73) JOHNSON SU
C              74) INVERTED WEIBULL
C              75) LOG DOUBLE EXPONENTIAL
C              76) GEOMETRIC EXTREME EXPONENTIAL
C              77) TWO-SIDED POWER
C              78) BIWEIBULL
C              79) G-AND-H
C              80) LANDAU
C              81) ERROR
C              82) TRAPEZOID
C              83) GENERALIZED TRAPEZOID
C              84) FOLDED T
C              85) SLASH
C              86) SKEWED NORMAL
C              87) SKEWED T
C              88) INVERTED BETA
C              89) GOMPERTZ-MAKEHAM
C              90) LOG-SKEW-NORMAL
C              91) LOG-SKEW-T
C              92) GENERALIZED HALF-LOGISTIC
C              93) POLYA
C              94) HERMITE
C              95) YULE
C              96) SKEW DOUBLE EXPONENTIAL
C              97) ASYMMETRIC DOUBLE EXPONENTIAL
C              98) MAXWELL
C              99) RAYLEIGH
C             100) GENERALIZED ASYMMETRIC DOUBLE EXPONENTIAL
C             101) GENERALIZED INVERSE GAUSSIAN
C             102) MCLEISH
C             103) BESSEL I FUNCTION
C             104) BESSEL K FUNCTION
C             105) GENERALIZED MCLEISH
C             106) HYPERBOLIC
C             107) GENERALIZED LOGISTIC TYPE 5
C             108) GENERALIZED LOGISTIC TYPE 2
C             109) WAKEB
C             110) BETA NORMAL
C             111) GENERALIZED LOGISTIC TYPE 3
C             114) GENERALIZED LOGISTIC TYPE 4
C             115) ASYMMETRIC LOG DOUBLE EXPONENTIAL
C             116) BETA GEOMETRIC
C             117) ZETA
C             118) ZIPF
C             118) BOREL-TANNER
C             119) BETA NEGATIVE BINOMIAL
C             120) LAGRANGE POISON
C             121) LEADS IN COIN TOSSING (DISCRETE ARCSINE)
C             122) MATCHING
C             123) LOST GAMES
C             124) LOG BETA
C             125) POLYA AEPPLI
C             126) CLASSICAL OCCUPANCY (NOT ACTIVE)
C             127) GENERALIZED LOGARITHMIC SERIES
C             128) GENERALIZED NEGATIVE BINOMIAL
C             129) GEETA
C             130) QUASI BINOMIAL TYPE I
C             131) CONSUL (GENERALIZED GEOMETRIC)
C             132) LAGRANGE KATZ (NOT ACTIVE)
C             133) KATZ
C             134) DISCRETE WEIBULL
C             135) GENERALIZED LOST GAMES
C             136) TRUNCATED GENERALIZED NEGATIVE BINOMIAL
C             137) TOPP AND LEONE
C             138) GENERALIZED TOPP AND LEONE
C             139) REFLECTED GENERALIZED TOPP AND LEONE
C             140) SLOPE
C             141) TWO-SIDED SLOPE
C             142) OGIVE
C             143) TWO-SIDED OGIVE
C             144) UNEVEN TWO-SIDED POWER
C             145) DOUBLY UNIFORM PARETO
C             146) BURR TYPE 1 (= UNIFORM)
C             147) BURR TYPE 2
C             148) BURR TYPE 3
C             149) BURR TYPE 4
C             150) BURR TYPE 5
C             151) BURR TYPE 6
C             152) BURR TYPE 7
C             153) BURR TYPE 8
C             154) BURR TYPE 9
C             155) BURR TYPE 10
C             156) BURR TYPE 11
C             157) BURR TYPE 12
C             158) KUMARASWAMY
C             159) REFLECTED POWER
C             160) MUTH
C             161) LOGISTIC-EXPONENTIAL
C             162) TRUNCATED PARETO
C             163) BRITTLE FRACTURE
C             164) 3-PARAMETER LOGISTIC-EXPONENTIAL
C             165) KAPPA
C             166) PEARSON TYPE 3
C             167) POWER LAW
C             168) END EFFECTS WEIBULL
C             169) BRITTLE FIBER WEIBULL
C             170) ARCTANGENT
C             171) SINE
C             172) G
C             173) H
C
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2009/8
C     ORIGINAL VERSION--AUGUST    2009.
C     UPDATED         --JUNE      2010. DISTINGUISH 2-PARAMETER AND
C                                       3-PARAMETER CASES FOR:
C                                       WEIBULL, LOGNORMAL, GAMMA,
C                                       INVERSE GAUSSIAN, INVERTED WEIBULL
C     UPDATED         --JULY      2010. DISTINGUISH 2-PARAMETER AND 1-PARAMETER
C                                       FOR EXPONENTIAL, RAYLEIGH, MAXWELL
C     UPDATED         --JULY      2010. END EFFECTS WEIBULL
C     UPDATED         --AUGUST    2010. BRITTLE FIBER WEIBULL
C     UPDATED         --JANUARY   2011. ARCTANGENT
C     UPDATED         --MARCH     2013. SINE
C     UPDATED         --APRIL     2014. ADD "G" AND "H" AS DISTINCT
C                                       FROM "G AND H"
C     UPDATED         --SEPTEMBER 2014. DISTINGUISH 2-PARAMETER AND
C                                       3-PARAMETER CASES FOR FRECHET
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 ICOM
      CHARACTER*4 ICOM2
      CHARACTER*4 IHARG(*)
      CHARACTER*4 IHARG2(*)
      CHARACTER*4 ISUBRO
      CHARACTER*4 IBUGG3
      CHARACTER*4 IERROR
C
      CHARACTER*4  IDISCS
      CHARACTER*60 IDISNM
      CHARACTER*4  IFOUND
C
      CHARACTER*4 IWRITE
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
C
C---------------------------------------------------------------------
C
      PARAMETER (MAXDIS=329)
      PARAMETER (MAXSCL=4)
      CHARACTER*4 INAME(MAXDIS,MAXSCL)
      CHARACTER*4 INCASE(MAXDIS)
      CHARACTER*4 INTEMP(MAXDIS)
      CHARACTER*60 INLONG(MAXDIS)
      INTEGER INSHAP(MAXDIS)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C     CREATE TABLE OF STATISTIC NAMES.
C
C       1) INCASE      = 4-CHARACTER CODE FOR DISTRIBUTION
C       2) INAME       = MATCHING ENTRIES FOR DISTRIBUTION.
C       3) INSHAP      = NUMBER OF SHAPE PARAMETERS
C       4) INLONG      = DESCRIPTIVE NAME FOR STATISTIC.
C                
C     UNIFORM
      DATA INCASE(1)/'UNIF'/
      DATA (INAME(1,J),J=1,4)/'UNIF','    ','    ','    '/
      DATA INSHAP(1)/0/
      DATA INLONG(1)/'UNIFORM'/
      DATA INCASE(2)/'UNIF'/
      DATA (INAME(2,J),J=1,4)/'RECT','    ','    ','    '/
      DATA INSHAP(2)/0/
      DATA INLONG(2)/'UNIFORM'/
C     NORMAL MIXTURE
      DATA INCASE(3)/'NORX'/
      DATA (INAME(3,J),J=1,4)/'NORM','MIXT','    ','    '/
      DATA INSHAP(3)/5/
      DATA INLONG(3)/'NORMAL MIXTURE'/
      DATA INCASE(4)/'NORX'/
      DATA (INAME(4,J),J=1,4)/'GAUS','MIXT','    ','    '/
      DATA INSHAP(4)/5/
      DATA INLONG(4)/'NORMAL MIXTURE'/
C     NORMAL
      DATA INCASE(5)/'NORM'/
      DATA (INAME(5,J),J=1,4)/'NORM','    ','    ','    '/
      DATA INSHAP(5)/0/
      DATA INLONG(5)/'NORMAL'/
      DATA INCASE(6)/'NORM'/
      DATA (INAME(6,J),J=1,4)/'GAUS','    ','    ','    '/
      DATA INSHAP(6)/0/
      DATA INLONG(6)/'NORMAL'/
C     LOGISTIC EXPONENTIAL
      DATA INCASE(7)/'LEXP'/
      DATA (INAME(7,J),J=1,4)/'LOGI','EXPO','    ','    '/
      DATA INSHAP(7)/1/
      DATA INLONG(7)/'LOGISTIC EXPONENTIAL'/
C     DOUBLE EXPONENTIAL
      DATA INCASE(8)/'DEXP'/
      DATA (INAME(8,J),J=1,4)/'DOUB','EXPO','    ','    '/
      DATA INSHAP(8)/0/
      DATA INLONG(8)/'DOUBLE EXPONENTIAL'/
      DATA INCASE(9)/'DEXP'/
      DATA (INAME(9,J),J=1,4)/'LAPL','    ','    ','    '/
      DATA INSHAP(9)/0/
      DATA INLONG(9)/'DOUBLE EXPONENTIAL'/
C     CAUCHY
      DATA INCASE(10)/'CAUC'/
      DATA (INAME(10,J),J=1,4)/'CAUC','    ','    ','    '/
      DATA INSHAP(10)/0/
      DATA INLONG(10)/'CAUCHY'/
C     TUKEY-LAMBDA
      DATA INCASE(11)/'TULA'/
      DATA (INAME(11,J),J=1,4)/'TUKE','LAMB','    ','    '/
      DATA INSHAP(11)/1/
      DATA INLONG(11)/'TUKEY-LAMBDA'/
      DATA INCASE(12)/'TULA'/
      DATA (INAME(12,J),J=1,4)/'TUKE','    ','    ','    '/
      DATA INSHAP(12)/1/
      DATA INLONG(12)/'TUKEY-LAMBDA'/
      DATA INCASE(13)/'TULA'/
      DATA (INAME(13,J),J=1,4)/'LAMB','    ','    ','    '/
      DATA INSHAP(13)/1/
      DATA INLONG(13)/'TUKEY-LAMBDA'/
C     LOGNORMAL
      DATA INCASE(14)/'LOGN'/
      DATA (INAME(14,J),J=1,4)/'LOG ','NORM','    ','    '/
      DATA INSHAP(14)/1/
      DATA INLONG(14)/'LOG-NORMAL'/
      DATA INCASE(15)/'LOGN'/
      DATA (INAME(15,J),J=1,4)/'LOGN','    ','    ','    '/
      DATA INSHAP(15)/1/
      DATA INLONG(15)/'LOG-NORMAL'/
C     HALF-NORMAL
      DATA INCASE(16)/'HNOR'/
      DATA (INAME(16,J),J=1,4)/'HALF','NORM','    ','    '/
      DATA INSHAP(16)/0/
      DATA INLONG(16)/'HALF-NORMAL'/
C
      DATA INCASE(17)/'HALO'/
      DATA (INAME(17,J),J=1,4)/'HALF','LOGI','    ','    '/
      DATA INSHAP(17)/0/
      DATA INLONG(17)/'HALF-LOGISITC'/
C     T
      DATA INCASE(18)/'TPP'/
      DATA (INAME(18,J),J=1,4)/'T   ','    ','    ','    '/
      DATA INSHAP(18)/1/
      DATA INLONG(18)/'T'/
      DATA INCASE(19)/'TPP'/
      DATA (INAME(19,J),J=1,4)/'STUD','T   ','    ','    '/
      DATA INSHAP(19)/1/
      DATA INLONG(19)/'T'/
C     CHI-SQUARE
      DATA INCASE(20)/'CHIS'/
      DATA (INAME(20,J),J=1,4)/'CHIS','    ','    ','    '/
      DATA INSHAP(20)/1/
      DATA INLONG(20)/'CHI-SQUARE'/
      DATA INCASE(21)/'CHIS'/
      DATA (INAME(21,J),J=1,4)/'CHI ','SQUA','    ','    '/
      DATA INSHAP(21)/1/
      DATA INLONG(21)/'CHI-SQUARE'/
C     F
      DATA INCASE(22)/'FPP'/
      DATA (INAME(22,J),J=1,4)/'F   ','    ','    ','    '/
      DATA INSHAP(22)/1/
      DATA INLONG(22)/'F'/
      DATA INCASE(23)/'FPP'/
      DATA (INAME(23,J),J=1,4)/'SNED','F   ','    ','    '/
      DATA INSHAP(24)/1/
      DATA INLONG(24)/'F'/
C     EXPONENTIAL POWER
      DATA INCASE(24)/'PEXP'/
      DATA (INAME(24,J),J=1,4)/'EXPO','POWE','    ','    '/
      DATA INSHAP(24)/1/
      DATA INLONG(24)/'POWER EXPONENTIAL'/
C     NEGATIVE EXPONENTIAL (= EXPONENTIAL)
      DATA INCASE(25)/'NEXP'/
      DATA (INAME(25,J),J=1,4)/'NEGA','EXPO','    ','    '/
      DATA INSHAP(25)/0/
      DATA INLONG(25)/'NEGATIVE EXPONENTIAL'/
C     GAMMA
      DATA INCASE(26)/'GAMM'/
      DATA (INAME(26,J),J=1,4)/'GAMM','    ','    ','    '/
      DATA INSHAP(26)/1/
      DATA INLONG(26)/'GAMMA'/
C
      DATA INCASE(27)/'BNOR'/
      DATA (INAME(27,J),J=1,4)/'BETA','NORM','    ','    '/
      DATA INSHAP(27)/4/
      DATA INLONG(27)/'BETA NORMAL'/
C     WEIBULL
      DATA INCASE(28)/'WEIB'/
      DATA (INAME(28,J),J=1,4)/'WEIB','    ','    ','    '/
      DATA INSHAP(28)/1/
      DATA INLONG(28)/'WEIBULL'/
C     EXTREME VALUE TYPE I (GUMBEL)
      DATA INCASE(29)/'EV1'/
      DATA (INAME(29,J),J=1,4)/'EXTR','VALU','TYPE','1   '/
      DATA INSHAP(29)/0/
      DATA INLONG(29)/'GUMBEL'/
      DATA INCASE(30)/'EV1'/
      DATA (INAME(30,J),J=1,4)/'EXTR','VALU','TYPE','I   '/
      DATA INSHAP(30)/0/
      DATA INLONG(30)/'GUMBEL'/
      DATA INCASE(31)/'EV1'/
      DATA (INAME(31,J),J=1,4)/'EV1 ','    ','    ','    '/
      DATA INSHAP(31)/0/
      DATA INLONG(31)/'GUMBEL'/
      DATA INCASE(32)/'EV1'/
      DATA (INAME(32,J),J=1,4)/'EVI ','    ','    ','    '/
      DATA INSHAP(32)/0/
      DATA INLONG(32)/'GUMBEL'/
      DATA INCASE(33)/'EV1'/
      DATA (INAME(33,J),J=1,4)/'GUMB','    ','    ','    '/
      DATA INSHAP(33)/0/
      DATA INLONG(33)/'GUMBEL'/
C     EXTREME VALUE TYPE II (FRECHET)
      DATA INCASE(34)/'EV2'/
      DATA (INAME(34,J),J=1,4)/'EXTR','VALU','TYPE','2   '/
      DATA INSHAP(34)/1/
      DATA INLONG(34)/'FRECHET'/
      DATA INCASE(35)/'EV2'/
      DATA (INAME(35,J),J=1,4)/'EXTR','VALU','TYPE','II  '/
      DATA INSHAP(35)/1/
      DATA INLONG(35)/'FRECHET'/
      DATA INCASE(36)/'EV2'/
      DATA (INAME(36,J),J=1,4)/'EVII','    ','    ','    '/
      DATA INSHAP(36)/1/
      DATA INLONG(36)/'FRECHET'/
      DATA INCASE(37)/'EV2'/
      DATA (INAME(37,J),J=1,4)/'EV2 ','    ','    ','    '/
      DATA INSHAP(37)/1/
      DATA INLONG(37)/'FRECHET'/
      DATA INCASE(38)/'EV2'/
      DATA (INAME(38,J),J=1,4)/'FREC','    ','    ','    '/
      DATA INSHAP(38)/1/
      DATA INLONG(38)/'FRECHET'/
C     PARETO
      DATA INCASE(39)/'PARE'/
      DATA (INAME(39,J),J=1,4)/'PARE','    ','    ','    '/
      DATA INSHAP(39)/1/
      DATA INLONG(39)/'PARETO'/
C     BINOMIAL
      DATA INCASE(40)/'BINO'/
      DATA (INAME(40,J),J=1,4)/'BINO','    ','    ','    '/
      DATA INSHAP(40)/2/
      DATA INLONG(40)/'BINOMIAL'/
C     GEOMETRIC EXTREME EXPONENTIAL
      DATA INCASE(41)/'GEEX'/
      DATA (INAME(41,J),J=1,4)/'GEOM','EXTR','EXPO','    '/
      DATA INSHAP(41)/1/
      DATA INLONG(41)/'GEOMETRIC EXTREME EXPONENTIAL'/
C
      DATA INCASE(42)/'POIS'/
      DATA (INAME(42,J),J=1,4)/'POIS','    ','    ','    '/
      DATA INSHAP(42)/1/
      DATA INLONG(42)/'POISSON'/
C     NEGATIVE BINOMIAL
      DATA INCASE(43)/'NEBI'/
      DATA (INAME(43,J),J=1,4)/'NEGA','BINO','    ','    '/
      DATA INSHAP(43)/2/
      DATA INLONG(43)/'NEGATIVE BINOMIAL'/
C     SEMI-CIRCULAR
      DATA INCASE(44)/'SEMC'/
      DATA (INAME(44,J),J=1,4)/'SEMI','CIRC','    ','    '/
      DATA INSHAP(44)/1/
      DATA INLONG(44)/'SEMI-CIRCULAR'/
      DATA INCASE(45)/'SEMC'/
      DATA (INAME(45,J),J=1,4)/'SEMI','    ','    ','    '/
      DATA INSHAP(45)/1/
      DATA INLONG(45)/'SEMI-CIRCULAR'/
C     TRIANGULAR
      DATA INCASE(46)/'TRIA'/
      DATA (INAME(46,J),J=1,4)/'TRIA','    ','    ','    '/
      DATA INSHAP(46)/1/
      DATA INLONG(46)/'TRIANGULAR'/
C     IVERSE GAUSSIAN
      DATA INCASE(47)/'INGA'/
      DATA (INAME(47,J),J=1,4)/'INVE','GAUS','    ','    '/
      DATA INSHAP(47)/2/
      DATA INLONG(47)/'INVERSE GAUSSIAN'/
      DATA INCASE(48)/'INGA'/
      DATA (INAME(48,J),J=1,4)/'IG  ','    ','    ','    '/
      DATA INSHAP(48)/2/
      DATA INLONG(48)/'INVERSE GAUSSIAN'/
C     WALD
      DATA INCASE(49)/'WALD'/
      DATA (INAME(49,J),J=1,4)/'WALD','    ','    ','    '/
      DATA INSHAP(49)/1/
      DATA INLONG(49)/'WALD'/
C     RECIPROCAL INVERSE GAUSSIAN
      DATA INCASE(50)/'RIGA'/
      DATA (INAME(50,J),J=1,4)/'RIG ','    ','    ','    '/
      DATA INSHAP(50)/2/
      DATA INLONG(50)/'RECIPROCAL INVERSE GAUSSIAN'/
      DATA INCASE(51)/'RIGA'/
      DATA (INAME(51,J),J=1,4)/'TWEE','    ','    ','    '/
      DATA INSHAP(51)/2/
      DATA INLONG(51)/'RECIPROCAL INVERSE GAUSSIAN'/
      DATA INCASE(52)/'RIGA'/
      DATA (INAME(52,J),J=1,4)/'RECI','INVE','GAUS','    '/
      DATA INSHAP(52)/2/
      DATA INLONG(52)/'RECIPROCAL INVERSE GAUSSIAN'/
C     FATIGUE LIFE
      DATA INCASE(53)/'FATL'/
      DATA (INAME(53,J),J=1,4)/'FATI','LIFE','    ','    '/
      DATA INSHAP(53)/1/
      DATA INLONG(53)/'FATIGUE LIFE'/
      DATA INCASE(54)/'FATL'/
      DATA (INAME(54,J),J=1,4)/'FL  ','    ','    ','    '/
      DATA INSHAP(54)/1/
      DATA INLONG(54)/'FATIGUE LIFE'/
      DATA INCASE(55)/'FATL'/
      DATA (INAME(55,J),J=1,4)/'BIRN','SAUN','    ','    '/
      DATA INSHAP(55)/1/
      DATA INLONG(55)/'FATIGUE LIFE'/
      DATA INCASE(56)/'FATL'/
      DATA (INAME(56,J),J=1,4)/'SAUN','BIRN','    ','    '/
      DATA INSHAP(56)/1/
      DATA INLONG(56)/'FATIGUE LIFE'/
C     GENERALIZED PARETO
      DATA INCASE(57)/'GPAR'/
      DATA (INAME(57,J),J=1,4)/'GENE','PARE','    ','    '/
      DATA INSHAP(57)/1/
      DATA INLONG(57)/'GENERALIZED PARETO'/
      DATA INCASE(58)/'GPAR'/
      DATA (INAME(58,J),J=1,4)/'GEP ','    ','    ','    '/
      DATA INSHAP(58)/1/
      DATA INLONG(58)/'GENERALIZED PARETO'/
      DATA INCASE(59)/'GPAR'/
      DATA (INAME(59,J),J=1,4)/'GP  ','    ','    ','    '/
      DATA INSHAP(59)/1/
      DATA INLONG(59)/'GENERALIZED PARETO'/
C     DISCRETE UNIFORM
      DATA INCASE(60)/'DUNI'/
      DATA (INAME(60,J),J=1,4)/'DISC','UNIF','    ','    '/
      DATA INSHAP(60)/1/
      DATA INLONG(60)/'DISCRETE UNIFORM'/
C     NON-CENTRAL T
      DATA INCASE(61)/'NCT'/
      DATA (INAME(61,J),J=1,4)/'NONC','T   ','    ','    '/
      DATA INSHAP(61)/2/
      DATA INLONG(61)/'NON-CENTRAL T'/
      DATA INCASE(62)/'NCT'/
      DATA (INAME(62,J),J=1,4)/'NON-','T   ','    ','    '/
      DATA INSHAP(62)/2/
      DATA INLONG(62)/'NON-CENTRAL T'/
      DATA INCASE(63)/'NCT'/
      DATA (INAME(63,J),J=1,4)/'NON ','CENT','T   ','    '/
      DATA INSHAP(63)/2/
      DATA INLONG(63)/'NON-CENTRAL T'/
C     NON-CENTRAL F
      DATA INCASE(64)/'NCF'/
      DATA (INAME(64,J),J=1,4)/'NONC','F   ','    ','    '/
      DATA INSHAP(64)/3/
      DATA INLONG(64)/'NON-CENTRAL F'/
      DATA INCASE(65)/'NCF'/
      DATA (INAME(65,J),J=1,4)/'NON-','F   ','    ','    '/
      DATA INSHAP(65)/3/
      DATA INLONG(65)/'NON-CENTRAL F'/
      DATA INCASE(66)/'NCF'/
      DATA (INAME(66,J),J=1,4)/'NON ','CENT','F   ','    '/
      DATA INSHAP(66)/3/
      DATA INLONG(66)/'NON-CENTRAL F'/
C
      DATA INCASE(67)/'NCBE'/
      DATA (INAME(67,J),J=1,4)/'NONC','BETA','    ','    '/
      DATA INSHAP(67)/3/
      DATA INLONG(67)/'NON-CENTRAL BETA'/
      DATA INCASE(68)/'NCBE'/
      DATA (INAME(68,J),J=1,4)/'NON-','BETA','    ','    '/
      DATA INSHAP(68)/3/
      DATA INLONG(68)/'NON-CENTRAL BETA'/
      DATA INCASE(69)/'NCBE'/
      DATA (INAME(69,J),J=1,4)/'NON ','CENT','BETA','    '/
      DATA INSHAP(69)/3/
      DATA INLONG(69)/'NON-CENTRAL BETA'/
C     NON-CENTRAL CHI-SQUARE
      DATA INCASE(70)/'NCCS'/
      DATA (INAME(70,J),J=1,4)/'NON ','CENT','CHIS','    '/
      DATA INSHAP(70)/2/
      DATA INLONG(70)/'NON-CENTRAL CHI-SQUARE'/
      DATA INCASE(71)/'NCCS'/
      DATA (INAME(71,J),J=1,4)/'NON ','CENT','CHI ','SQUA'/
      DATA INSHAP(71)/2/
      DATA INLONG(71)/'NON-CENTRAL CHI-SQUARE'/
      DATA INCASE(72)/'NCCS'/
      DATA (INAME(72,J),J=1,4)/'NONC','CHI ','SQUA','    '/
      DATA INSHAP(72)/2/
      DATA INLONG(72)/'NON-CENTRAL CHI-SQUARE'/
      DATA INCASE(73)/'NCCS'/
      DATA (INAME(73,J),J=1,4)/'NON-','CHI ','SQUA','    '/
      DATA INSHAP(73)/2/
      DATA INLONG(73)/'NON-CENTRAL CHI-SQUARE'/
      DATA INCASE(74)/'NCCS'/
      DATA (INAME(74,J),J=1,4)/'NONC','CHI-','    ','    '/
      DATA INSHAP(74)/2/
      DATA INLONG(74)/'NON-CENTRAL CHI-SQUARE'/
      DATA INCASE(75)/'NCCS'/
      DATA (INAME(75,J),J=1,4)/'NON-','CHI-','    ','    '/
      DATA INSHAP(75)/2/
      DATA INLONG(75)/'NON-CENTRAL CHI-SQUARE'/
      DATA INCASE(76)/'NCCS'/
      DATA (INAME(76,J),J=1,4)/'NONC','CHIS','    ','    '/
      DATA INSHAP(76)/2/
      DATA INLONG(76)/'NON-CENTRAL CHI-SQUARE'/
      DATA INCASE(77)/'NCCS'/
      DATA (INAME(77,J),J=1,4)/'NON-','CHIS','CHIS','    '/
      DATA INSHAP(77)/2/
      DATA INLONG(77)/'NON-CENTRAL CHI-SQUARE'/
C     DOUBLY NON-CENTRAL F
      DATA INCASE(78)/'DNCF'/
      DATA (INAME(78,J),J=1,4)/'DOUB','NONC','F   ','    '/
      DATA INSHAP(78)/4/
      DATA INLONG(78)/'DOUBLY NON-CENTRAL F'/
      DATA INCASE(79)/'DNCF'/
      DATA (INAME(79,J),J=1,4)/'DOUB','NON-','F   ','    '/
      DATA INSHAP(79)/4/
      DATA INLONG(79)/'DOUBLY NON-CENTRAL F'/
C     DOUBLY NON-CENTRAL T
      DATA INCASE(80)/'DNCT'/
      DATA (INAME(80,J),J=1,4)/'DOUB','NONC','T   ','    '/
      DATA INSHAP(80)/3/
      DATA INLONG(80)/'DOUBLY NON-CENTRAL T'/
      DATA INCASE(81)/'DNCT'/
      DATA (INAME(81,J),J=1,4)/'DOUB','NON ','CENT','T   '/
      DATA INSHAP(81)/3/
      DATA INLONG(81)/'DOUBLY NON-CENTRAL T'/
C     HYPERBOLIC SECANT
      DATA INCASE(82)/'HSEC'/
      DATA (INAME(82,J),J=1,4)/'HYPE','SECA','    ','    '/
      DATA INSHAP(82)/0/
      DATA INLONG(82)/'HYPERBOLIC SECANT'/
C     HYPERGEOMETRIC
      DATA INCASE(83)/'HYPG'/
      DATA (INAME(83,J),J=1,4)/'HYPE','GEO ','    ','    '/
      DATA INSHAP(83)/3/
      DATA INLONG(83)/'HYPERGEOMETRIC'/
C     VON MISES
      DATA INCASE(84)/'VONM'/
      DATA (INAME(84,J),J=1,4)/'VON ','MISE','    ','    '/
      DATA INSHAP(84)/1/
      DATA INLONG(84)/'VON MISES'/
      DATA INCASE(85)/'VONM'/
      DATA (INAME(85,J),J=1,4)/'VONM','    ','    ','    '/
      DATA INSHAP(85)/1/
      DATA INLONG(85)/'VON MISES'/
      DATA INCASE(86)/'VONM'/
      DATA (INAME(86,J),J=1,4)/'VON-','    ','    ','    '/
      DATA INSHAP(86)/1/
      DATA INLONG(86)/'VON MISES'/
C     POWER NORMAL
      DATA INCASE(87)/'POWN'/
      DATA (INAME(87,J),J=1,4)/'POWE','NORM','    ','    '/
      DATA INSHAP(87)/1/
      DATA INLONG(87)/'POWER NORMAL'/
C     POWER LOGNORMAL
      DATA INCASE(88)/'PLGN'/
      DATA (INAME(88,J),J=1,4)/'POWE','LOGN','    ','    '/
      DATA INSHAP(88)/2/
      DATA INLONG(88)/'POWER LOGNORMAL'/
      DATA INCASE(89)/'PLGN'/
      DATA (INAME(89,J),J=1,4)/'POWE','LGNO','    ','    '/
      DATA INSHAP(89)/2/
      DATA INLONG(89)/'POWER LOGNORMAL'/
      DATA INCASE(90)/'PLGN'/
      DATA (INAME(90,J),J=1,4)/'POWE','LOG-','    ','    '/
      DATA INSHAP(90)/2/
      DATA INLONG(90)/'POWER LOGNORMAL'/
C     COSINE
      DATA INCASE(91)/'COSI'/
      DATA (INAME(91,J),J=1,4)/'COSI','    ','    ','    '/
      DATA INSHAP(91)/0/
      DATA INLONG(91)/'COSINE'/
C     ALPHA
      DATA INCASE(92)/'ALPH'/
      DATA (INAME(92,J),J=1,4)/'ALPH','    ','    ','    '/
      DATA INSHAP(92)/1/
      DATA INLONG(92)/'ALPHA'/
C     POWER EXPONENTIAL
      DATA INCASE(93)/'PEXP'/
      DATA (INAME(93,J),J=1,4)/'POWE','EXPO','    ','    '/
      DATA INSHAP(93)/1/
      DATA INLONG(93)/'POWER EXPONENTIAL'/
C     POWER
      DATA INCASE(94)/'POWF'/
      DATA (INAME(94,J),J=1,4)/'POWE','FUNC','    ','    '/
      DATA INSHAP(94)/1/
      DATA INLONG(94)/'POWER FUNCTION'/
C     CHI
      DATA INCASE(95)/'CHI '/
      DATA (INAME(95,J),J=1,4)/'CHI ','    ','    ','    '/
      DATA INSHAP(95)/1/
      DATA INLONG(95)/'CHI'/
C     LOGARITHMIC SERIES
      DATA INCASE(96)/'LOGS'/
      DATA (INAME(96,J),J=1,4)/'LOGA','SERI','    ','    '/
      DATA INSHAP(96)/1/
      DATA INLONG(96)/'LOGARITHMIC SERIES'/
C     LOG LOGISTIC
      DATA INCASE(97)/'LOGL'/
      DATA (INAME(97,J),J=1,4)/'LOG ','LOGI','    ','    '/
      DATA INSHAP(97)/1/
      DATA INLONG(97)/'LOG-LOGISTIC'/
      DATA INCASE(98)/'LOGL'/
      DATA (INAME(98,J),J=1,4)/'LOG-','LOGI','    ','    '/
      DATA INSHAP(98)/1/
      DATA INLONG(98)/'LOG-LOGISTIC'/
      DATA INCASE(99)/'LOGL'/
      DATA (INAME(99,J),J=1,4)/'LOGL','    ','    ','    '/
      DATA INSHAP(99)/1/
      DATA INLONG(99)/'LOG-LOGISTIC'/
C     GENERALIZED GAMMA
      DATA INCASE(100)/'GGAM'/
      DATA (INAME(100,J),J=1,4)/'GENE','GAMM','    ','    '/
      DATA INSHAP(100)/2/
      DATA INLONG(100)/'GENERALIZED GAMMA'/
C     INVERTED GAMMA
      DATA INCASE(101)/'IGAM'/
      DATA (INAME(101,J),J=1,4)/'INVE','GAMM','    ','    '/
      DATA INSHAP(101)/1/
      DATA INLONG(101)/'INVERSE GAMMA'/
C     WARING
      DATA INCASE(102)/'WARI'/
      DATA (INAME(102,J),J=1,4)/'WARI','    ','    ','    '/
      DATA INSHAP(102)/2/
      DATA INLONG(102)/'WARING'/
C     YULE
      DATA INCASE(103)/'YULE'/
      DATA (INAME(103,J),J=1,4)/'YULE','    ','    ','    '/
      DATA INSHAP(103)/1/
      DATA INLONG(103)/'YULE'/
C     ANGLIT
      DATA INCASE(104)/'ANGL'/
      DATA (INAME(104,J),J=1,4)/'ANGL','    ','    ','    '/
      DATA INSHAP(104)/0/
      DATA INLONG(104)/'ANGLIT'/
C     ARCSINE
      DATA INCASE(105)/'ARSI'/
      DATA (INAME(105,J),J=1,4)/'ARCS','    ','    ','    '/
      DATA INSHAP(105)/0/
      DATA INLONG(105)/'ARCSINE'/
C     FOLDED NORMAL
      DATA INCASE(106)/'FNOR'/
      DATA (INAME(106,J),J=1,4)/'FOLD','NORM','    ','    '/
      DATA INSHAP(106)/2/
      DATA INLONG(106)/'FOLDED NORMAL'/
C     TRUNCATED NORMAL
      DATA INCASE(107)/'TNOR'/
      DATA (INAME(107,J),J=1,4)/'TRUN','NORM','    ','    '/
      DATA INSHAP(107)/4/
      DATA INLONG(107)/'TRUNCATED NORMAL'/
C     LOG GAMMA
      DATA INCASE(108)/'LGAM'/
      DATA (INAME(108,J),J=1,4)/'LOG ','GAMM','    ','    '/
      DATA INSHAP(108)/1/
      DATA INLONG(108)/'LOG-GAMMA'/
C     HYPERGEOMETRIC
      DATA INCASE(109)/'HYPG'/
      DATA (INAME(109,J),J=1,4)/'HYPE','    ','    ','    '/
      DATA INSHAP(109)/3/
      DATA INLONG(109)/'HYPERGEOMETRIC'/
C     GOMPERTZ MAKEHAM
      DATA INCASE(110)/'GOMM'/
      DATA (INAME(110,J),J=1,4)/'GOMP','MAKE','    ','    '/
      DATA INSHAP(110)/2/
      DATA INLONG(110)/'GOMPERTZ MAKEHAM'/
C     HALF CAUCHY
      DATA INCASE(111)/'HCAU'/
      DATA (INAME(111,J),J=1,4)/'HALF','CAUC','    ','    '/
      DATA INSHAP(111)/0/
      DATA INLONG(111)/'HALF-CAUCHY'/
C     GENERALIZED EXTREME VALUE
      DATA INCASE(112)/'GEV'/
      DATA (INAME(112,J),J=1,4)/'GENE','EXTR','VALU','    '/
      DATA INSHAP(112)/1/
      DATA INLONG(112)/'GENERALIZED EXTREME VALUE'/
      DATA INCASE(113)/'GEV'/
      DATA (INAME(113,J),J=1,4)/'GEV ','    ','    ','    '/
      DATA INSHAP(113)/1/
      DATA INLONG(113)/'GENERALIZED EXTREME VALUE'/
C     HALF-NORMAL
      DATA INCASE(114)/'HLOG'/
      DATA (INAME(114,J),J=1,4)/'HALF','LOGI','    ','    '/
      DATA INSHAP(114)/0/
      DATA INLONG(114)/'HALF-LOGISTIC'/
C
      DATA INCASE(115)/'PAR2'/
      DATA (INAME(115,J),J=1,4)/'PARE','SECO','KIND','    '/
      DATA INSHAP(115)/1/
      DATA INLONG(115)/'PARETO SECOND KIND'/
      DATA INCASE(116)/'PAR2'/
      DATA (INAME(116,J),J=1,4)/'PARE','TYPE','2   ','    '/
      DATA INSHAP(116)/1/
      DATA INLONG(116)/'PARETO SECOND KIND'/
      DATA INCASE(117)/'PAR2'/
      DATA (INAME(117,J),J=1,4)/'PARE','TYPE','II  ','    '/
      DATA INSHAP(117)/1/
      DATA INLONG(117)/'PARETO SECOND KIND'/
C     DOUBLE WEIBULL
      DATA INCASE(118)/'DWEI'/
      DATA (INAME(118,J),J=1,4)/'DOUB','WEIB','    ','    '/
      DATA INSHAP(118)/1/
      DATA INLONG(118)/'DOUBLE WEIBULL'/
C     EXPONENTIATED WEIBULL
      DATA INCASE(119)/'EWEI'/
      DATA (INAME(119,J),J=1,4)/'EXPO','WEIB','    ','    '/
      DATA INSHAP(119)/2/
      DATA INLONG(119)/'EXPONENTIATED WEIBULL'/
C     TRUNCATED EXPONENTIAL
      DATA INCASE(120)/'TEXP'/
      DATA (INAME(120,J),J=1,4)/'TRUN','EXPO','    ','    '/
      DATA INSHAP(120)/3/
      DATA INLONG(120)/'TRUNCATED EXPONENTIAL'/
C     WRAPPED CAUCHY
      DATA INCASE(121)/'WCAU'/
      DATA (INAME(121,J),J=1,4)/'WRAP','CAUC','    ','    '/
      DATA INSHAP(121)/1/
      DATA INLONG(121)/'WRAPPED CAUCHY'/
C     WAKEBY
      DATA INCASE(122)/'WAKE'/
      DATA (INAME(122,J),J=1,4)/'WAKE','    ','    ','    '/
      DATA INSHAP(122)/3/
      DATA INLONG(122)/'WAKEBY'/
C     EXPONENTIAL
      DATA INCASE(123)/'EXPO'/
      DATA (INAME(123,J),J=1,4)/'EXPO','    ','    ','    '/
      DATA INSHAP(123)/0/
      DATA INLONG(123)/'EXPONENTIAL'/
C     DOUBLE GAMMA
      DATA INCASE(124)/'DGAM'/
      DATA (INAME(124,J),J=1,4)/'DOUB','GAMM','    ','    '/
      DATA INSHAP(124)/1/
      DATA INLONG(124)/'DOUBLE GAMMA'/
C     MIELKE BETA KAPPA
      DATA INCASE(125)/'MBKA'/
      DATA (INAME(125,J),J=1,4)/'BETA','KAPP','    ','    '/
      DATA INSHAP(125)/2/
      DATA INLONG(125)/'MIELKE BETA KAPPA'/
      DATA INCASE(126)/'MBKA'/
      DATA (INAME(126,J),J=1,4)/'MIEL','BETA','KAPP','    '/
      DATA INSHAP(126)/2/
      DATA INLONG(126)/'MIELKE BETA KAPPA'/
C     FOLDED CAUCHY
      DATA INCASE(127)/'FCAU'/
      DATA (INAME(127,J),J=1,4)/'FOLD','CAUC','    ','    '/
      DATA INSHAP(127)/2/
      DATA INLONG(127)/'FOLDED CAUCHY'/
C     BETA BINOMIAL
      DATA INCASE(128)/'BBIN'/
      DATA (INAME(128,J),J=1,4)/'BETA','BINO','    ','    '/
      DATA INSHAP(128)/3/
      DATA INLONG(128)/'BETA BINOMIAL'/
C     BRADFORD
      DATA INCASE(129)/'BRAD'/
      DATA (INAME(129,J),J=1,4)/'BRAD','    ','    ','    '/
      DATA INSHAP(129)/1/
      DATA INLONG(129)/'BRADFORD'/
C     GENERALIZED EXPONENTIAL
      DATA INCASE(130)/'GEXP'/
      DATA (INAME(130,J),J=1,4)/'GENE','EXPO','    ','    '/
      DATA INSHAP(130)/3/
      DATA INLONG(130)/'GENERALIZED EXPONENTIAL'/
C     RECIPROCAL
      DATA INCASE(131)/'RECI'/
      DATA (INAME(131,J),J=1,4)/'RECI','    ','    ','    '/
      DATA INSHAP(131)/1/
      DATA INLONG(131)/'RECIPROCAL'/
C     INVERTED WEIBULL
      DATA INCASE(132)/'IWEI'/
      DATA (INAME(132,J),J=1,4)/'INVE','WEIB','    ','    '/
      DATA INSHAP(132)/1/
      DATA INLONG(132)/'INVERTED WEIBULL'/
C     LOG DOUBLE EXPONENTIAL
      DATA INCASE(133)/'LDEX'/
      DATA (INAME(133,J),J=1,4)/'LOG ','DOUB','EXPO','    '/
      DATA INSHAP(133)/1/
      DATA INLONG(133)/'LOG DOUBLE EXPONENTIAL'/
C     GENERALIZED TUKEY-LAMBDA
      DATA INCASE(134)/'GTLA'/
      DATA (INAME(134,J),J=1,4)/'GENE','TUKE','LAMB','    '/
      DATA INSHAP(134)/2/
      DATA INLONG(134)/'GENERALZIED TUKEY LAMBDA'/
C     JOHNSON SB
      DATA INCASE(135)/'JOSB'/
      DATA (INAME(135,J),J=1,4)/'JOHN','SB  ','    ','    '/
      DATA INSHAP(135)/2/
      DATA INLONG(135)/'JOHNSON SB'/
C     JOHNSON SU
      DATA INCASE(136)/'JOSU'/
      DATA (INAME(136,J),J=1,4)/'JOHN','SU  ','    ','    '/
      DATA INSHAP(136)/2/
      DATA INLONG(136)/'JOHNSON SU'/
C     GEOMETRIC
      DATA INCASE(137)/'GEOM'/
      DATA (INAME(137,J),J=1,4)/'GEOM','    ','    ','    '/
      DATA INSHAP(137)/1/
      DATA INLONG(137)/'GEOMETRIC'/
C     TWO-SIDED POWER
      DATA INCASE(138)/'TSPO'/
      DATA (INAME(138,J),J=1,4)/'TWO ','SIDE','POWE','    '/
      DATA INSHAP(138)/2/
      DATA INLONG(138)/'TWO-SIDED POWER'/
C     BI-WEIBULL
      DATA INCASE(139)/'BWEI'/
      DATA (INAME(139,J),J=1,4)/'BI  ','WEIB','    ','    '/
      DATA INSHAP(139)/5/
      DATA INLONG(139)/'BIWEIBULL'/
      DATA INCASE(140)/'BWEI'/
      DATA (INAME(140,J),J=1,4)/'BIWE','    ','    ','    '/
      DATA INSHAP(140)/5/
      DATA INLONG(140)/'BIWEIBULL'/
C     LANDAU
      DATA INCASE(141)/'LAND'/
      DATA (INAME(141,J),J=1,4)/'LAND','    ','    ','    '/
      DATA INSHAP(141)/0/
      DATA INLONG(141)/'LANDAU'/
C     ERROR (SUBOTTIN)
      DATA INCASE(142)/'ERRO'/
      DATA (INAME(142,J),J=1,4)/'ERRO','    ','    ','    '/
      DATA INSHAP(142)/1/
      DATA INLONG(142)/'ERROR'/
      DATA INCASE(143)/'ERRO'/
      DATA (INAME(143,J),J=1,4)/'SUBB','    ','    ','    '/
      DATA INSHAP(143)/1/
      DATA INLONG(143)/'ERROR'/
C     POWER LAW
      DATA INCASE(144)/'POWL'/
      DATA (INAME(144,J),J=1,4)/'POWE','LAW ','    ','    '/
      DATA INSHAP(144)/2/
      DATA INLONG(144)/'POWER LAW'/
C     TRAPEZOID
      DATA INCASE(145)/'TRAP'/
      DATA (INAME(145,J),J=1,4)/'TRAP','    ','    ','    '/
      DATA INSHAP(145)/4/
      DATA INLONG(145)/'TRAPEZOID'/
C     GENERALIZED TRAPEZOID
      DATA INCASE(146)/'GTRA'/
      DATA (INAME(146,J),J=1,4)/'GENE','TRAP','    ','    '/
      DATA INSHAP(146)/7/
      DATA INLONG(146)/'GENERALIZED TRAPEZOID'/
C     FOLDED T
      DATA INCASE(147)/'FT'/
      DATA (INAME(147,J),J=1,4)/'FOLD','T   ','    ','    '/
      DATA INSHAP(147)/3/
      DATA INLONG(147)/'FOLDED T'/
C     SKEW NORMAL
      DATA INCASE(148)/'SNOR'/
      DATA (INAME(148,J),J=1,4)/'SKEW','NORM','    ','    '/
      DATA INSHAP(148)/1/
      DATA INLONG(148)/'SKEWED NORMAL'/
C     SKEW T
      DATA INCASE(149)/'TSKE'/
      DATA (INAME(149,J),J=1,4)/'SKEW','T   ','    ','    '/
      DATA INSHAP(149)/2/
      DATA INLONG(149)/'SKEWED T'/
C     SLASH
      DATA INCASE(150)/'SLAS'/
      DATA (INAME(150,J),J=1,4)/'SLAS','    ','    ','    '/
      DATA INSHAP(150)/0/
      DATA INLONG(150)/'SLASH'/
C     INVERTED BETA
      DATA INCASE(151)/'IBET'/
      DATA (INAME(151,J),J=1,4)/'INVE','BETA','    ','    '/
      DATA INSHAP(151)/2/
      DATA INLONG(151)/'INVERTED BETA'/
C     GOMPERTZ
      DATA INCASE(152)/'GOMP'/
      DATA (INAME(152,J),J=1,4)/'GOMP','    ','    ','    '/
      DATA INSHAP(152)/2/
      DATA INLONG(152)/'GOMPERTZ'/
C     GENERALIZED INVERSE GAUSSIAN
      DATA INCASE(153)/'GIGA'/
      DATA (INAME(153,J),J=1,4)/'GENE','INVE','GAUS','    '/
      DATA INSHAP(153)/2/
      DATA INLONG(153)/'GENERALIZED INVERSE GAUSSIAN'/
C     GENERALIZED F
      DATA INCASE(154)/'GFPP'/
      DATA (INAME(154,J),J=1,4)/'GENE','F   ','    ','    '/
      DATA INSHAP(154)/3/
      DATA INLONG(154)/'GENERALIZED F'/
C     G AND H
      DATA INCASE(155)/'GHPP'/
      DATA (INAME(155,J),J=1,4)/'G-H ','    ','    ','    '/
      DATA INSHAP(155)/2/
      DATA INLONG(155)/'G AND H'/
      DATA INCASE(156)/'GHPP'/
      DATA (INAME(156,J),J=1,4)/'GH  ','    ','    ','    '/
      DATA INSHAP(156)/2/
      DATA INLONG(156)/'G AND H'/
      DATA INCASE(157)/'GHPP'/
      DATA (INAME(157,J),J=1,4)/'G   ','H   ','    ','    '/
      DATA INSHAP(157)/2/
      DATA INLONG(157)/'G AND H'/
      DATA INCASE(158)/'GHPP'/
      DATA (INAME(158,J),J=1,4)/'G   ','AND ','H   ','    '/
      DATA INSHAP(158)/2/
      DATA INLONG(158)/'G AND H'/
C     LOG SKEWED NORMAL
      DATA INCASE(159)/'LSNO'/
      DATA (INAME(159,J),J=1,4)/'LOG ','SKEW','NORM','    '/
      DATA INSHAP(159)/2/
      DATA INLONG(159)/'LOG SKEWED NORMAL'/
C     LOG SKEWED T
      DATA INCASE(160)/'LSKT'/
      DATA (INAME(160,J),J=1,4)/'LOG ','SKEW','T   ','    '/
      DATA INSHAP(160)/3/
      DATA INLONG(160)/'LOG SKEWED T'/
C     GENERALIZED HALF-LOGISTIC
      DATA INCASE(161)/'GHLO'/
      DATA (INAME(161,J),J=1,4)/'GENE','HALF','LOGI','    '/
      DATA INSHAP(161)/1/
      DATA INLONG(161)/'GENERALIZED HALF-LOGISITC'/
C     ARCSINE
      DATA INCASE(162)/'ARSI'/
      DATA (INAME(162,J),J=1,4)/'ARCS','    ','    ','    '/
      DATA INSHAP(162)/0/
      DATA INLONG(162)/'ARCSINE'/
C     POLY AEPPLI
      DATA INCASE(163)/'AEPP'/
      DATA (INAME(163,J),J=1,4)/'POLY','AEPP','    ','    '/
      DATA INSHAP(163)/2/
      DATA INLONG(163)/'POLYA AEPPLI'/
C     HERMITE
      DATA INCASE(164)/'HERM'/
      DATA (INAME(164,J),J=1,4)/'HERM','    ','    ','    '/
      DATA INSHAP(164)/2/
      DATA INLONG(164)/'HERMITE'/
C     SKEW DOUBLE EXPONENTIAL
      DATA INCASE(165)/'SDEX'/
      DATA (INAME(165,J),J=1,4)/'SKEW','DOUB','EXPO','    '/
      DATA INSHAP(165)/1/
      DATA INLONG(165)/'SKEW DOUBLE EXPONENTIAL'/
      DATA INCASE(166)/'SDEX'/
      DATA (INAME(166,J),J=1,4)/'SKEW','LAPL','    ','    '/
      DATA INSHAP(166)/1/
      DATA INLONG(166)/'SKEW DOUBLE EXPONENTIAL'/
C     ASYMMETRIC DOUBLE EXPONENTIAL
      DATA INCASE(167)/'ADEX'/
      DATA (INAME(167,J),J=1,4)/'ASYM','DOUB','EXPO','    '/
      DATA INSHAP(167)/1/
      DATA INLONG(167)/'ASYMMETRIC DOUBLE EXPONENTIAL'/
      DATA INCASE(168)/'ADEX'/
      DATA (INAME(168,J),J=1,4)/'ASYM','LAPL','    ','    '/
      DATA INSHAP(168)/1/
      DATA INLONG(168)/'ASYMMETRIC DOUBLE EXPONENTIAL'/
C     MAXWELL
      DATA INCASE(169)/'MAXW'/
      DATA (INAME(169,J),J=1,4)/'MAXW','    ','    ','    '/
      DATA INSHAP(169)/0/
      DATA INLONG(169)/'MAXWELL'/
C     RAYLEIGH
      DATA INCASE(170)/'RAYL'/
      DATA (INAME(170,J),J=1,4)/'RAYL','    ','    ','    '/
      DATA INSHAP(170)/0/
      DATA INLONG(170)/'RAYLEIGH'/
C     GENERALIZED ASYMETRIC DOUBLE EXPONENTIAL
      DATA INCASE(171)/'GALP'/
      DATA (INAME(171,J),J=1,4)/'GENE','ASYM','DOUB','EXPO'/
      DATA INSHAP(171)/2/
      DATA INLONG(171)/'GENERALIZED ASYMMETRIC LAPLACE'/
      DATA INCASE(172)/'GALP'/
      DATA (INAME(172,J),J=1,4)/'GENE','ASYM','LAPL','    '/
      DATA INSHAP(172)/2/
      DATA INLONG(172)/'GENERALIZED ASYMMETRIC LAPLACE'/
C     MCLEISH
      DATA (INAME(173,J),J=1,4)/'MCLE','    ','    ','    '/
      DATA INCASE(173)/'MCLE'/
      DATA INSHAP(173)/1/
      DATA INLONG(173)/'MCLEISH'/
C     BESSEL I FUNCTION
      DATA (INAME(174,J),J=1,4)/'BESS','I   ','FUNC','    '/
      DATA INCASE(174)/'BEIP'/
      DATA INSHAP(174)/3/
      DATA INLONG(174)/'BESSEL I FUNCTION'/
      DATA (INAME(175,J),J=1,4)/'BESS','I   ','    ','    '/
      DATA INCASE(175)/'BEIP'/
      DATA INSHAP(175)/3/
      DATA INLONG(175)/'BESSEL I FUNCTION'/
C     BESSEL K FUNCTION
      DATA (INAME(176,J),J=1,4)/'BESS','K   ','FUNC','    '/
      DATA INCASE(176)/'BEKP'/
      DATA INSHAP(176)/3/
      DATA INLONG(176)/'BESSEL K FUNCTION'/
      DATA (INAME(177,J),J=1,4)/'BESS','K   ','    ','    '/
      DATA INCASE(177)/'BEKP'/
      DATA INSHAP(177)/3/
      DATA INLONG(177)/'BESSEL K FUNCTION'/
C     GENERALIZED MCLEISH
      DATA (INAME(178,J),J=1,4)/'GENE','MCLE','    ','    '/
      DATA INCASE(178)/'GMCL'/
      DATA INSHAP(178)/2/
      DATA INLONG(178)/'GENERALIZED MCLEISH'/
C     LOG DOUBLE EXPONENTIAL (LOG LAPLACE)
      DATA INCASE(179)/'LLAP'/
      DATA (INAME(179,J),J=1,4)/'LOG ','LAPL','    ','    '/
      DATA INSHAP(179)/1/
      DATA INLONG(179)/'LOG LAPLACE'/
C     GENERALIZED LOGISTIC TYPE 5
      DATA INCASE(180)/'G5LO'/
      DATA (INAME(180,J),J=1,4)/'GENE','LOGI','TYPE','5   '/
      DATA INSHAP(180)/1/
      DATA INLONG(180)/'GENERALIZED LOGISTIC TYPE 5'/
      DATA INCASE(181)/'G5LO'/
      DATA (INAME(181,J),J=1,4)/'GENE','LOGI','TYPE','V   '/
      DATA INSHAP(181)/1/
      DATA INLONG(181)/'GENERALIZED LOGISTIC TYPE 5'/
      DATA INCASE(182)/'G5LO'/
      DATA (INAME(182,J),J=1,4)/'GENE','LOGI','HOSK','    '/
      DATA INSHAP(182)/1/
      DATA INLONG(182)/'GENERALIZED LOGISTIC TYPE 5'/
      DATA INCASE(183)/'G5LO'/
      DATA (INAME(183,J),J=1,4)/'HOSK','GENE','LOGI','    '/
      DATA INSHAP(183)/1/
      DATA INLONG(183)/'GENERALIZED LOGISTIC TYPE 5'/
      DATA INCASE(184)/'G5LO'/
      DATA (INAME(184,J),J=1,4)/'TYPE','5   ','GENE','LOGI'/
      DATA INSHAP(184)/1/
      DATA INLONG(184)/'GENERALIZED LOGISTIC TYPE 5'/
      DATA INCASE(185)/'G5LO'/
      DATA (INAME(185,J),J=1,4)/'TYPE','V   ','GENE','LOGI'/
      DATA INSHAP(185)/1/
      DATA INLONG(185)/'GENERALIZED LOGISTIC TYPE 5'/
C     GENERALIZED LOGISTIC TYPE 2
      DATA INCASE(186)/'G2LO'/
      DATA (INAME(186,J),J=1,4)/'GENE','LOGI','TYPE','2   '/
      DATA INSHAP(186)/1/
      DATA INLONG(186)/'GENERALIZED LOGISTIC TYPE 2'/
      DATA INCASE(187)/'G2LO'/
      DATA (INAME(187,J),J=1,4)/'GENE','LOGI','TYPE','II  '/
      DATA INSHAP(187)/1/
      DATA INLONG(187)/'GENERALIZED LOGISTIC TYPE 2'/
      DATA INCASE(188)/'G2LO'/
      DATA (INAME(188,J),J=1,4)/'TYPE','2   ','GENE','LOGI'/
      DATA INSHAP(188)/1/
      DATA INLONG(188)/'GENERALIZED LOGISTIC TYPE 2'/
      DATA INCASE(189)/'G2LO'/
      DATA (INAME(189,J),J=1,4)/'TYPE','II  ','GENE','LOGI'/
      DATA INSHAP(189)/1/
      DATA INLONG(189)/'GENERALIZED LOGISTIC TYPE 2'/
C     GENERALIZED LOGISTIC TYPE 3
      DATA INCASE(190)/'G3LO'/
      DATA (INAME(190,J),J=1,4)/'GENE','LOGI','TYPE','3   '/
      DATA INSHAP(190)/1/
      DATA INLONG(190)/'GENERALIZED LOGISTIC TYPE 3'/
      DATA INCASE(191)/'G3LO'/
      DATA (INAME(191,J),J=1,4)/'GENE','LOGI','TYPE','III '/
      DATA INSHAP(191)/1/
      DATA INLONG(191)/'GENERALIZED LOGISTIC TYPE 3'/
      DATA INCASE(192)/'G3LO'/
      DATA (INAME(192,J),J=1,4)/'TYPE','3   ','GENE','LOGI'/
      DATA INSHAP(192)/1/
      DATA INLONG(192)/'GENERALIZED LOGISTIC TYPE 3'/
      DATA INCASE(193)/'G3LO'/
      DATA (INAME(193,J),J=1,4)/'TYPE','III ','GENE','LOGI'/
      DATA INSHAP(193)/1/
      DATA INLONG(193)/'GENERALIZED LOGISTIC TYPE 3'/
C     GENERALIZED LOGISTIC TYPE 4
      DATA INCASE(194)/'G4LO'/
      DATA (INAME(194,J),J=1,4)/'GENE','LOGI','TYPE','4   '/
      DATA INSHAP(194)/2/
      DATA INLONG(194)/'GENERALIZED LOGISTIC TYPE 3'/
      DATA INCASE(195)/'G4LO'/
      DATA (INAME(195,J),J=1,4)/'GENE','LOGI','TYPE','IV  '/
      DATA INSHAP(195)/2/
      DATA INLONG(195)/'GENERALIZED LOGISTIC TYPE 4'/
      DATA INCASE(196)/'G4LO'/
      DATA (INAME(196,J),J=1,4)/'TYPE','4   ','GENE','LOGI'/
      DATA INSHAP(196)/2/
      DATA INLONG(196)/'GENERALIZED LOGISTIC TYPE 4'/
      DATA INCASE(197)/'G4LO'/
      DATA (INAME(197,J),J=1,4)/'TYPE','IV  ','GENE','LOGI'/
      DATA INSHAP(197)/2/
      DATA INLONG(197)/'GENERALIZED LOGISTIC TYPE 4'/
C     GENERALIZED LOGISTIC
      DATA INCASE(198)/'GLOG'/
      DATA (INAME(198,J),J=1,4)/'GENE','LOGI','    ','    '/
      DATA INSHAP(198)/1/
      DATA INLONG(198)/'GENERALIZED LOGISTIC'/
C     GENERALIZED TUKEY LAMBDA
      DATA INCASE(199)/'GTLA'/
      DATA (INAME(199,J),J=1,4)/'GENE','LAMB','    ','    '/
      DATA INSHAP(199)/2/
      DATA INLONG(199)/'GENERALIZED TUKEY-LAMBDA'/
C     BETA GEOMETRIC
      DATA INCASE(200)/'BGEO'/
      DATA (INAME(200,J),J=1,4)/'BETA','GEOM','    ','    '/
      DATA INSHAP(200)/2/
      DATA INLONG(200)/'BETA GEOMETRIC'/
C     LOG LAPLACE (DOUBLE EXPONENTIAL)
      DATA INCASE(201)/'LLAP'/
      DATA (INAME(201,J),J=1,4)/'LOG ','DOUB','EXPO','    '/
      DATA INSHAP(201)/1/
      DATA INLONG(201)/'LOG LAPLACE'/
C     ASYMETRIC LOG DOUBLE EXPONENTIAL (LAPLACE)
      DATA INCASE(202)/'ALDE'/
      DATA (INAME(202,J),J=1,4)/'ASYM','LOG ','DOUB','EXPO'/
      DATA INSHAP(202)/2/
      DATA INLONG(202)/'ASYMMETRIC LOG DOUBLE EXPONENTIAL'/
      DATA INCASE(203)/'ALDE'/
      DATA (INAME(203,J),J=1,4)/'ASYM','LOG ','LAPL','    '/
      DATA INSHAP(203)/2/
      DATA INLONG(203)/'ASYMMETRIC LOG DOUBLE EXPONENTIAL'/
C     ZETA
      DATA INCASE(204)/'ZETA'/
      DATA (INAME(204,J),J=1,4)/'ZETA','    ','    ','    '/
      DATA INSHAP(204)/1/
      DATA INLONG(204)/'ZETA'/
C     ZIPF
      DATA INCASE(205)/'ZIPF'/
      DATA (INAME(205,J),J=1,4)/'ZIPF','    ','    ','    '/
      DATA INSHAP(205)/2/
      DATA INLONG(205)/'ZIPF'/
C     BETA NEGATIVE BINOMIAL
      DATA INCASE(206)/'BNBI'/
      DATA (INAME(206,J),J=1,4)/'BETA','NEGA','BINO','    '/
      DATA INSHAP(206)/3/
      DATA INLONG(206)/'BETA NEGATIVE BINOMIAL'/
C     GENERALIZED WARING
      DATA INCASE(207)/'GWAR'/
      DATA (INAME(207,J),J=1,4)/'GENE','WARI','    ','    '/
      DATA INSHAP(207)/3/
      DATA INLONG(207)/'GENERALIZED WARING'/
C     BOREL TANNER
      DATA INCASE(208)/'BTAN'/
      DATA (INAME(208,J),J=1,4)/'BORE','TANN','    ','    '/
      DATA INSHAP(208)/2/
      DATA INLONG(208)/'BOREL TANNER'/
C     LOG BETA
      DATA INCASE(209)/'LBET'/
      DATA (INAME(209,J),J=1,4)/'LOG ','BETA','    ','    '/
      DATA INSHAP(209)/4/
      DATA INLONG(209)/'LOG BETA'/
C     4-PARAMETER BETA
      DATA INCASE(210)/'4BET'/
      DATA (INAME(210,J),J=1,4)/'4   ','PARA','BETA','    '/
      DATA INSHAP(210)/4/
      DATA INLONG(210)/'4-PARAMETER BETA'/
C     LAGRANGE POISSON
      DATA INCASE(211)/'LPOI'/
      DATA (INAME(211,J),J=1,4)/'LAGR','POIS','    ','    '/
      DATA INSHAP(211)/2/
      DATA INLONG(211)/'LAGRANGE POISSON'/
C     CONSUL GENERALIZED POISSON
      DATA INCASE(212)/'GPOI'/
      DATA (INAME(212,J),J=1,4)/'CONS','GENE','POIS','    '/
      DATA INSHAP(212)/2/
      DATA INLONG(212)/'CONSUL GENERALIZED POISSON'/
C     LEADS IN COIN TOSSING
      DATA INCASE(213)/'LICT'/
      DATA (INAME(213,J),J=1,4)/'LEAD','IN  ','COIN','TOSS'/
      DATA INSHAP(213)/1/
      DATA INLONG(213)/'LEADS IN COIN TOSSING'/
      DATA INCASE(214)/'LICT'/
      DATA (INAME(214,J),J=1,4)/'DISC','ARCS','    ','    '/
      DATA INSHAP(214)/1/
      DATA INLONG(214)/'DISCRETE ARCSINE'/
C     MATCHING
      DATA INCASE(215)/'MATC'/
      DATA (INAME(215,J),J=1,4)/'MATC','    ','    ','    '/
      DATA INSHAP(215)/1/
      DATA INLONG(215)/'MATCHING'/
C     CLASSICAL OCCUPANCY
      DATA INCASE(216)/'OCCU'/
      DATA (INAME(216,J),J=1,4)/'CLAS','OCCU','    ','    '/
      DATA INSHAP(216)/2/
      DATA INLONG(216)/'CLASSICAL OCCUPANCY'/
C     POLYA
      DATA INCASE(217)/'POLY'/
      DATA (INAME(217,J),J=1,4)/'POLY','    ','    ','    '/
      DATA INSHAP(217)/4/
      DATA INLONG(217)/'POLYA'/
C     LOST GAMES
      DATA INCASE(218)/'LOST'/
      DATA (INAME(218,J),J=1,4)/'LOST','GAME','    ','    '/
      DATA INSHAP(218)/2/
      DATA INLONG(218)/'LOST GAMES'/
C     GENERALIZED LOGARITHMIC SERIES
      DATA INCASE(219)/'GLOS'/
      DATA (INAME(219,J),J=1,4)/'GENE','LOGA','SERI','    '/
      DATA INSHAP(219)/2/
      DATA INLONG(219)/'GENERALIZED LOGARITHMIC SERIES'/
C     GENERALIZED NEGATIVE BINOMIAL
      DATA INCASE(220)/'GNBI'/
      DATA (INAME(220,J),J=1,4)/'GENE','NEGA','BINO','    '/
      DATA INSHAP(220)/2/
      DATA INLONG(220)/'GENERALZIED NEGATIVE BINOMIAL'/
C     GEETA
      DATA INCASE(221)/'GEET'/
      DATA (INAME(221,J),J=1,4)/'GEET','    ','    ','    '/
      DATA INSHAP(221)/2/
      DATA INLONG(221)/'GEETA'/
C     QUASI BINOMIAL TYPE I
      DATA INCASE(222)/'QBIN'/
      DATA (INAME(222,J),J=1,4)/'QUAS','BINO','TYPE','I   '/
      DATA INSHAP(222)/3/
      DATA INLONG(222)/'QUASI-BINOMIAL TYPE 1'/
      DATA INCASE(223)/'QBIN'/
      DATA (INAME(223,J),J=1,4)/'QUAS','BINO','TYPE','1   '/
      DATA INSHAP(223)/3/
      DATA INLONG(223)/'QUASI-BINOMIAL TYPE 1'/
      DATA INCASE(224)/'QBIN'/
      DATA (INAME(224,J),J=1,4)/'QUAS','BINO','I   ','    '/
      DATA INSHAP(224)/3/
      DATA INLONG(224)/'QUASI-BINOMIAL TYPE 1'/
      DATA INCASE(225)/'QBIN'/
      DATA (INAME(225,J),J=1,4)/'QUAS','BINO','1   ','    '/
      DATA INSHAP(225)/3/
      DATA INLONG(225)/'QUASI-BINOMIAL TYPE 1'/
C     CONSUL
      DATA INCASE(226)/'CONS'/
      DATA (INAME(226,J),J=1,4)/'CONS','    ','    ','    '/
      DATA INSHAP(226)/2/
      DATA INLONG(226)/'CONSUL'/
C     LAGRANZE KATZ
      DATA INCASE(227)/'LKAT'/
      DATA (INAME(227,J),J=1,4)/'LAGR','KATZ','    ','    '/
      DATA INSHAP(227)/3/
      DATA INLONG(227)/'LAGRANGE KATZ'/
C     KATZ
      DATA INCASE(228)/'KATZ'/
      DATA (INAME(228,J),J=1,4)/'KATZ','    ','    ','    '/
      DATA INSHAP(228)/2/
      DATA INLONG(228)/'KATZ'/
C     DISCRETE WEIBULL
      DATA INCASE(229)/'DISW'/
      DATA (INAME(229,J),J=1,4)/'DISC','WEIB','    ','    '/
      DATA INSHAP(229)/2/
      DATA INLONG(229)/'DISCRETE WEIBULL'/
C     GENERALIZED LOST GAMES
      DATA INCASE(230)/'GLGP'/
      DATA (INAME(230,J),J=1,4)/'GENE','LOST','GAME','    '/
      DATA INSHAP(230)/3/
      DATA INLONG(230)/'GENERALIZED LOST GAMES'/
C     TRUNCATED GENERALIZED NEGATIVE BINOMIAL
      DATA INCASE(231)/'TGNB'/
      DATA (INAME(231,J),J=1,4)/'TRUN','GENE','NEGA','BINO'/
      DATA INSHAP(231)/4/
      DATA INLONG(231)/'TRUNCATED GENERALIZED NEGATIVE BINOMIAL'/
C     TOPP AND LEONE
      DATA INCASE(232)/'TOPL'/
      DATA (INAME(232,J),J=1,4)/'TOPP','LEON','    ','    '/
      DATA INSHAP(232)/1/
      DATA INLONG(232)/'TOPP AND LEONE'/
      DATA INCASE(233)/'TOPL'/
      DATA (INAME(233,J),J=1,4)/'TOPP','AND ','LEON','    '/
      DATA INSHAP(233)/1/
      DATA INLONG(233)/'TOPP AND LEONE'/
C     GENERALIZED TOPP AND LEONE
      DATA INCASE(234)/'GTOL'/
      DATA (INAME(234,J),J=1,4)/'GENE','TOPP','AND ','LEON'/
      DATA INSHAP(234)/2/
      DATA INLONG(234)/'GENERALIZED TOPP AND LEONE'/
      DATA INCASE(235)/'GTOL'/
      DATA (INAME(235,J),J=1,4)/'GENE','TOPP','LEON','    '/
      DATA INSHAP(235)/2/
      DATA INLONG(235)/'GENERALIZED TOPP AND LEONE'/
C     REFLECTED GENERALIZED TOPP AND LEONE
      DATA INCASE(236)/'RGTL'/
      DATA (INAME(236,J),J=1,4)/'REFL','GENE','TOPP','LEON'/
      DATA INSHAP(236)/2/
      DATA INLONG(236)/'REFLECTED GENERALIZED TOPP AND LEONE'/
C     SLOPE
      DATA INCASE(237)/'SLOP'/
      DATA (INAME(237,J),J=1,4)/'SLOP','    ','    ','    '/
      DATA INSHAP(237)/1/
      DATA INLONG(237)/'SLOPE'/
C     TWO-SIDED SLOPE
      DATA INCASE(238)/'TSSL'/
      DATA (INAME(238,J),J=1,4)/'TWO ','SIDE','SLOP','    '/
      DATA INSHAP(238)/2/
      DATA INLONG(238)/'TWO-SIDED SLOPE'/
C     OGIVE
      DATA INCASE(239)/'OGIV'/
      DATA (INAME(239,J),J=1,4)/'OGIV','    ','    ','    '/
      DATA INSHAP(239)/1/
      DATA INLONG(239)/'OGIVE'/
C     TWO-SIDED OGIVE
      DATA INCASE(240)/'TSOG'/
      DATA (INAME(240,J),J=1,4)/'TWO ','SIDE','OGIV','    '/
      DATA INSHAP(240)/2/
      DATA INLONG(240)/'TWO-SIDED OGIVE'/
C     BURR TYPE 1
      DATA INCASE(241)/'UNIF'/
      DATA (INAME(241,J),J=1,4)/'BURR','TYPE','1   ','    '/
      DATA INSHAP(241)/0/
      DATA INLONG(241)/'BURR TYPE 1'/
      DATA INCASE(242)/'UNIF'/
      DATA (INAME(242,J),J=1,4)/'BURR','TYPE','I   ','    '/
      DATA INSHAP(242)/0/
      DATA INLONG(242)/'BURR TYPE 1'/
C     BURR TYPE 2
      DATA INCASE(243)/'BUR2'/
      DATA (INAME(243,J),J=1,4)/'BURR','TYPE','2   ','    '/
      DATA INSHAP(243)/1/
      DATA INLONG(243)/'BURR TYPE 2'/
      DATA INCASE(244)/'BUR2'/
      DATA (INAME(244,J),J=1,4)/'BURR','TYPE','II  ','    '/
      DATA INSHAP(244)/1/
      DATA INLONG(244)/'BURR TYPE 2'/
C     BURR TYPE 3
      DATA INCASE(245)/'BUR3'/
      DATA (INAME(245,J),J=1,4)/'BURR','TYPE','3   ','    '/
      DATA INSHAP(245)/2/
      DATA INLONG(245)/'BURR TYPE 3'/
      DATA INCASE(246)/'BUR3'/
      DATA (INAME(246,J),J=1,4)/'BURR','TYPE','3   ','    '/
      DATA INSHAP(246)/2/
      DATA INLONG(246)/'BURR TYPE 3'/
C     BURR TYPE 4
      DATA INCASE(247)/'BUR4'/
      DATA (INAME(247,J),J=1,4)/'BURR','TYPE','4   ','    '/
      DATA INSHAP(247)/2/
      DATA INLONG(247)/'BURR TYPE 4'/
      DATA INCASE(248)/'BUR4'/
      DATA (INAME(248,J),J=1,4)/'BURR','TYPE','IV  ','    '/
      DATA INSHAP(248)/2/
      DATA INLONG(248)/'BURR TYPE 4'/
C     BURR TYPE 5
      DATA INCASE(249)/'BUR5'/
      DATA (INAME(249,J),J=1,4)/'BURR','TYPE','5   ','    '/
      DATA INSHAP(249)/2/
      DATA INLONG(249)/'BURR TYPE 5'/
      DATA INCASE(250)/'BUR5'/
      DATA (INAME(250,J),J=1,4)/'BURR','TYPE','V   ','    '/
      DATA INSHAP(250)/2/
      DATA INLONG(250)/'BURR TYPE 5'/
C     BURR TYPE 6
      DATA INCASE(251)/'BUR6'/
      DATA (INAME(251,J),J=1,4)/'BURR','TYPE','6   ','    '/
      DATA INSHAP(251)/2/
      DATA INLONG(251)/'BURR TYPE 6'/
      DATA INCASE(252)/'BUR6'/
      DATA (INAME(252,J),J=1,4)/'BURR','TYPE','VI  ','    '/
      DATA INSHAP(252)/2/
      DATA INLONG(252)/'BURR TYPE 6'/
C     BURR TYPE 7
      DATA INCASE(253)/'BUR7'/
      DATA (INAME(253,J),J=1,4)/'BURR','TYPE','7   ','    '/
      DATA INSHAP(253)/1/
      DATA INLONG(253)/'BURR TYPE 7'/
      DATA INCASE(254)/'BUR7'/
      DATA (INAME(254,J),J=1,4)/'BURR','TYPE','VII ','    '/
      DATA INSHAP(254)/1/
      DATA INLONG(254)/'BURR TYPE 7'/
C     BURR TYPE 8
      DATA INCASE(255)/'BUR8'/
      DATA (INAME(255,J),J=1,4)/'BURR','TYPE','8   ','    '/
      DATA INSHAP(255)/1/
      DATA INLONG(255)/'BURR TYPE 8'/
      DATA INCASE(256)/'BUR8'/
      DATA (INAME(256,J),J=1,4)/'BURR','TYPE','VIII','    '/
      DATA INSHAP(256)/1/
      DATA INLONG(256)/'BURR TYPE 8'/
C     BURR TYPE 9
      DATA INCASE(257)/'BUR9'/
      DATA (INAME(257,J),J=1,4)/'BURR','TYPE','9   ','    '/
      DATA INSHAP(257)/2/
      DATA INLONG(257)/'BURR TYPE 9'/
      DATA INCASE(258)/'BUR9'/
      DATA (INAME(258,J),J=1,4)/'BURR','TYPE','IX  ','    '/
      DATA INSHAP(258)/2/
      DATA INLONG(258)/'BURR TYPE 9'/
C     BURR TYPE 10
      DATA INCASE(259)/'BU10'/
      DATA (INAME(259,J),J=1,4)/'BURR','TYPE','10  ','    '/
      DATA INSHAP(259)/1/
      DATA INLONG(259)/'BURR TYPE 10'/
      DATA INCASE(260)/'BU10'/
      DATA (INAME(260,J),J=1,4)/'BURR','TYPE','X   ','    '/
      DATA INSHAP(260)/1/
      DATA INLONG(260)/'BURR TYPE 10'/
C     BURR TYPE 11
      DATA INCASE(261)/'BU11'/
      DATA (INAME(261,J),J=1,4)/'BURR','TYPE','11  ','    '/
      DATA INSHAP(261)/1/
      DATA INLONG(261)/'BURR TYPE 11'/
      DATA INCASE(262)/'BU11'/
      DATA (INAME(262,J),J=1,4)/'BURR','TYPE','XI  ','    '/
      DATA INSHAP(262)/1/
      DATA INLONG(262)/'BURR TYPE 11'/
C     BURR TYPE 12
      DATA INCASE(263)/'BU12'/
      DATA (INAME(263,J),J=1,4)/'BURR','TYPE','12  ','    '/
      DATA INSHAP(263)/2/
      DATA INLONG(263)/'BURR TYPE 12'/
      DATA INCASE(264)/'BU12'/
      DATA (INAME(264,J),J=1,4)/'BURR','TYPE','XII ','    '/
      DATA INSHAP(264)/2/
      DATA INLONG(264)/'BURR TYPE 12'/
C     UNEVEN TWO-SIDED POWER
      DATA INCASE(265)/'UTSP'/
      DATA (INAME(265,J),J=1,4)/'UNEV','TWO ','SIDE','POWE'/
      DATA INSHAP(265)/6/
      DATA INLONG(265)/'UNEVEN TWO-SIDED POWER'/
C     DOUBLY PARETO UNIFORM
      DATA INCASE(266)/'DPUN'/
      DATA (INAME(266,J),J=1,4)/'DOUB','PARE','UNIF','    '/
      DATA INSHAP(266)/2/
      DATA INLONG(266)/'DOUBLY PARETO UNIFORM'/
C     KUMAR
      DATA INCASE(267)/'KUMA'/
      DATA (INAME(267,J),J=1,4)/'KUMA','    ','    ','    '/
      DATA INSHAP(267)/2/
      DATA INLONG(267)/'KUMARASWAMY'/
C     REFLECTED POWER
      DATA INCASE(268)/'RPOW'/
      DATA (INAME(268,J),J=1,4)/'REFL','POWE','    ','    '/
      DATA INSHAP(268)/1/
      DATA INLONG(268)/'REFLECTED POWER'/
C     MUTH
      DATA INCASE(269)/'MUTH'/
      DATA (INAME(269,J),J=1,4)/'MUTH','    ','    ','    '/
      DATA INSHAP(269)/1/
      DATA INLONG(269)/'MUTH'/
C     LOGISTIC
      DATA INCASE(270)/'LOGI'/
      DATA (INAME(270,J),J=1,4)/'LOGI','    ','    ','    '/
      DATA INSHAP(270)/0/
      DATA INLONG(270)/'LOGISTIC'/
C     TRUNCATED PARETO
      DATA INCASE(271)/'TPAR'/
      DATA (INAME(271,J),J=1,4)/'TRUN','PARE','    ','    '/
      DATA INSHAP(271)/3/
      DATA INLONG(271)/'TRUNCATED PARETO'/
C     BRITTLE FRACTURE
      DATA INCASE(272)/'BFRA'/
      DATA (INAME(272,J),J=1,4)/'BRIT','FRAC','    ','    '/
      DATA INSHAP(272)/3/
      DATA INLONG(272)/'BRITTLE FRACTURE'/
C     3-PARAMETER LOGISTIC EXPONENTIAL
      DATA INCASE(273)/'L3EX'/
      DATA (INAME(273,J),J=1,4)/'3   ','PARA','LOGI','EXPO'/
      DATA INSHAP(273)/3/
      DATA INLONG(273)/'3-PARAMETER LOGISTIC EXPONENTIAL'/
C     KAPPA
      DATA INCASE(274)/'KAPP'/
      DATA (INAME(274,J),J=1,4)/'KAPP','    ','    ','    '/
      DATA INSHAP(274)/2/
      DATA INLONG(274)/'KAPPA'/
C     PEARSON TYPE 3
      DATA INCASE(275)/'PEA3'/
      DATA (INAME(275,J),J=1,4)/'PEAR','TYPE','III ','    '/
      DATA INSHAP(275)/1/
      DATA INLONG(275)/'PEARSON TYPE 3'/
      DATA INCASE(276)/'PEA3'/
      DATA (INAME(276,J),J=1,4)/'PEAR','TYPE','3   ','    '/
      DATA INSHAP(276)/1/
      DATA INLONG(276)/'PEARSON TYPE 3'/
C     DOUBLY NONCENTRAL BETA
      DATA INCASE(277)/'DNCB'/
      DATA (INAME(277,J),J=1,4)/'DOUB','NONC','BETA','    '/
      DATA INSHAP(277)/4/
      DATA INLONG(277)/'DOUBLY NON-CENTRAL BETA'/
C     POWER
      DATA INCASE(278)/'POWF'/
      DATA (INAME(278,J),J=1,4)/'POWE','    ','    ','    '/
      DATA INSHAP(278)/1/
      DATA INLONG(278)/'POWER'/
C     3-PARAMETER WEIBULL
      DATA INCASE(279)/'3WEI'/
      DATA (INAME(279,J),J=1,4)/'3   ','PARA','WEIB','    '/
      DATA INSHAP(279)/1/
      DATA INLONG(279)/'3-PARAMETER WEIBULL'/
C     3-PARAMETER INVERTED WEIBULL
      DATA INCASE(280)/'3IWE'/
      DATA (INAME(280,J),J=1,4)/'3   ','PARA','INVE','WEIB'/
      DATA INSHAP(280)/1/
      DATA INLONG(280)/'3-PARAMETER INVERTED WEIBULL'/
C     3-PARAMETER GAMMA
      DATA INCASE(281)/'3GAM'/
      DATA (INAME(281,J),J=1,4)/'3   ','PARA','GAMM','    '/
      DATA INSHAP(281)/1/
      DATA INLONG(281)/'3-PARAMETER GAMMA'/
C     3-PARAMETER INVERSE GAUSSIAN
      DATA INCASE(282)/'3IGA'/
      DATA (INAME(282,J),J=1,4)/'3   ','PARA','INVE','GAUS'/
      DATA INSHAP(282)/2/
      DATA INLONG(282)/'3-PARAMETER INVERSE GAUSSIAN'/
C     3-PARAMETER LOGNORMAL
      DATA INCASE(283)/'3LGN'/
      DATA (INAME(283,J),J=1,4)/'3   ','PARA','LOGN','    '/
      DATA INSHAP(283)/1/
      DATA INLONG(283)/'3-PARAMETER LOGNORMAL'/
C     1-PARAMETER EXPONENTIAL
      DATA INCASE(284)/'1EXP'/
      DATA (INAME(284,J),J=1,4)/'1   ','PARA','EXPO','    '/
      DATA INSHAP(284)/0/
      DATA INLONG(284)/'1-PARAMETER EXPONENTIAL'/
C     1-PARAMETER EXPONENTIAL
      DATA INCASE(285)/'1EXP'/
      DATA (INAME(285,J),J=1,4)/'ONE ','PARA','EXPO','    '/
      DATA INSHAP(285)/0/
      DATA INLONG(285)/'1-PARAMETER EXPONENTIAL'/
C     2-PARAMETER EXPONENTIAL
      DATA INCASE(286)/'EXPO'/
      DATA (INAME(286,J),J=1,4)/'2   ','PARA','EXPO','    '/
      DATA INSHAP(286)/0/
      DATA INLONG(286)/'EXPONENTIAL'/
C     2-PARAMETER EXPONENTIAL
      DATA INCASE(287)/'EXPO'/
      DATA (INAME(287,J),J=1,4)/'TWO ','PARA','EXPO','    '/
      DATA INSHAP(287)/0/
      DATA INLONG(287)/'EXPONENTIAL'/
C     1-PARAMETER RAYLEIGH
      DATA INCASE(288)/'1RAY'/
      DATA (INAME(288,J),J=1,4)/'1   ','PARA','RAYL','    '/
      DATA INSHAP(288)/0/
      DATA INLONG(288)/'1-PARAMETER RAYLEIGH'/
C     1-PARAMETER RAYLEIGH
      DATA INCASE(289)/'1RAY'/
      DATA (INAME(289,J),J=1,4)/'ONE ','PARA','RAYL','    '/
      DATA INSHAP(289)/0/
      DATA INLONG(289)/'1-PARAMETER RAYLEIGH'/
C     2-PARAMETER RAYLEIGH
      DATA INCASE(290)/'RAYL'/
      DATA (INAME(290,J),J=1,4)/'2   ','PARA','RAYL','    '/
      DATA INSHAP(290)/0/
      DATA INLONG(290)/'RAYLEIGH'/
C     2-PARAMETER RAYLEIGH
      DATA INCASE(291)/'RAYL'/
      DATA (INAME(291,J),J=1,4)/'TWO ','PARA','RAYL','    '/
      DATA INSHAP(291)/0/
      DATA INLONG(291)/'RAYLEIGH'/
C     1-PARAMETER MAXWELL
      DATA INCASE(292)/'1MAX'/
      DATA (INAME(292,J),J=1,4)/'1   ','PARA','MAXW','    '/
      DATA INSHAP(292)/0/
      DATA INLONG(292)/'1-PARAMETER MAXWELL'/
C     1-PARAMETER MAXWELL
      DATA INCASE(293)/'1MAX'/
      DATA (INAME(293,J),J=1,4)/'ONE ','PARA','MAXW','    '/
      DATA INSHAP(293)/0/
      DATA INLONG(293)/'1-PARAMETER MAXWELL'/
C     2-PARAMETER MAXWELL
      DATA INCASE(294)/'MAXW'/
      DATA (INAME(294,J),J=1,4)/'2   ','PARA','MAXW','    '/
      DATA INSHAP(294)/0/
      DATA INLONG(294)/'MAXWELL'/
C     2-PARAMETER MAXWELL
      DATA INCASE(295)/'MAXW'/
      DATA (INAME(295,J),J=1,4)/'TWO ','PARA','MAXW','    '/
      DATA INSHAP(295)/0/
      DATA INLONG(295)/'MAXWELL'/
C     HALF WILL BE INTERPRETED AS HALF-NORMAL (TO SUPPORT
C     HALFNORMAL PROB PLOT Y SYNTAX)
      DATA INCASE(296)/'HNOR'/
      DATA (INAME(296,J),J=1,4)/'HALF','    ','    ','    '/
      DATA INSHAP(296)/0/
      DATA INLONG(296)/'HALF-NORMAL'/
C     END EFFECTS WEIBULL
      DATA INCASE(297)/'EEWE'/
      DATA (INAME(297,J),J=1,4)/'END ','EFFE','WEIB','    '/
      DATA INSHAP(297)/5/
      DATA INLONG(297)/'END-EFFECTS WEIBULL'/
C     BRITTLE FIBER WEIBULL
      DATA INCASE(298)/'BFWE'/
      DATA (INAME(298,J),J=1,4)/'BRIT','FIBE','WEIB','    '/
      DATA INSHAP(298)/1/
      DATA INLONG(298)/'BRITTLE FIBER WEIBULL'/
C     ARCTANGENT
      DATA INCASE(299)/'ARCT'/
      DATA (INAME(299,J),J=1,4)/'ARCT','    ','    ','    '/
      DATA INSHAP(299)/2/
      DATA INLONG(299)/'ARCTANGENT'/
C     SINE
      DATA INCASE(300)/'SINE'/
      DATA (INAME(300,J),J=1,4)/'SINE','    ','    ','    '/
      DATA INSHAP(300)/0/
      DATA INLONG(300)/'SINE'/
C     3-PARAMETER LOGNORMAL
      DATA INCASE(301)/'3LGN'/
      DATA (INAME(301,J),J=1,4)/'3   ','PARA','LOG ','NORM'/
      DATA INSHAP(301)/1/
      DATA INLONG(301)/'3-PARAMETER LOGNORMAL'/
C     G
      DATA INCASE(302)/'GPP '/
      DATA (INAME(302,J),J=1,4)/'G   ','    ','    ','    '/
      DATA INSHAP(302)/1/
      DATA INLONG(302)/'G'/
C     H
      DATA INCASE(303)/'HPP '/
      DATA (INAME(303,J),J=1,4)/'H   ','    ','    ','    '/
      DATA INSHAP(303)/1/
      DATA INLONG(303)/'H'/
C     4-PARAMETER BETA
      DATA INCASE(304)/'4BET'/
      DATA (INAME(304,J),J=1,4)/'FOUR','PARA','BETA','    '/
      DATA INSHAP(304)/4/
      DATA INLONG(304)/'4-PARAMETER BETA'/
C     BETA
      DATA INCASE(305)/'BETA'/
      DATA (INAME(305,J),J=1,4)/'BETA','    ','    ','    '/
      DATA INSHAP(305)/4/
      DATA INLONG(305)/'BETA'/
C     REFLECTED POWER
      DATA INCASE(306)/'RPOW'/
      DATA (INAME(306,J),J=1,4)/'REVE','POWE','    ','    '/
      DATA INSHAP(306)/1/
      DATA INLONG(306)/'REFLECTED POWER'/
C     REFLECTED POWER
      DATA INCASE(307)/'RPOW'/
      DATA (INAME(307,J),J=1,4)/'REFL','POWE','    ','    '/
      DATA INSHAP(307)/1/
      DATA INLONG(307)/'REFLECTED POWER'/
C     DEHAAN (GENERALIZED PARETO)
      DATA INCASE(308)/'GPDE'/
      DATA (INAME(308,J),J=1,4)/'DEHA','    ','    ','    '/
      DATA INSHAP(308)/1/
      DATA INLONG(308)/'DEHAAN (GENERALIZED PARETO)'/
C     CONDITIONAL MEAN EXCEEDANCE (GENERALIZED PARETO)
      DATA INCASE(309)/'GPCM'/
      DATA (INAME(309,J),J=1,4)/'CME ','    ','    ','    '/
      DATA INSHAP(309)/1/
      DATA INLONG(309)/'CME (GENERALIZED PARETO)'/
C     CONDITIONAL MEAN EXCEEDANCE (GENERALIZED PARETO)
      DATA INCASE(310)/'GPCM'/
      DATA (INAME(310,J),J=1,4)/'COND','MEAN','EXCE','    '/
      DATA INSHAP(310)/1/
      DATA INLONG(310)/'CME (GENERALIZED PARETO)'/
C     EXPONENTIAL LAW
      DATA INCASE(311)/'ELML'/
      DATA (INAME(311,J),J=1,4)/'EXPO','LAW ','    ','    '/
      DATA INSHAP(311)/2/
      DATA INLONG(311)/'EXPONENTIAL LAW'/
C     3-PARAMETER WEIBULL
      DATA INCASE(312)/'3WEI'/
      DATA (INAME(312,J),J=1,4)/'3   ','PAR ','WEIB','    '/
      DATA INSHAP(312)/1/
      DATA INLONG(312)/'3-PARAMETER WEIBULL'/
C     3-PARAMETER INVERTED WEIBULL
      DATA INCASE(313)/'3IWE'/
      DATA (INAME(313,J),J=1,4)/'3   ','PAR ','INVE','WEIB'/
      DATA INSHAP(313)/1/
      DATA INLONG(313)/'3-PARAMETER INVERTED WEIBULL'/
C     3-PARAMETER GAMMA
      DATA INCASE(314)/'3GAM'/
      DATA (INAME(314,J),J=1,4)/'3   ','PAR ','GAMM','    '/
      DATA INSHAP(314)/1/
      DATA INLONG(314)/'3-PARAMETER GAMMA'/
C     3-PARAMETER INVERSE GAUSSIAN
      DATA INCASE(315)/'3IGA'/
      DATA (INAME(315,J),J=1,4)/'3   ','PAR ','INVE','GAUS'/
      DATA INSHAP(315)/2/
      DATA INLONG(315)/'3-PARAMETER INVERSE GAUSSIAN'/
C     3-PARAMETER LOGNORMAL
      DATA INCASE(316)/'3LGN'/
      DATA (INAME(316,J),J=1,4)/'3   ','PAR ','LOGN','    '/
      DATA INSHAP(316)/1/
      DATA INLONG(316)/'3-PARAMETER LOGNORMAL'/
C     3-PARAMETER INVERSE GAUSSIAN
      DATA INCASE(317)/'3IGA'/
      DATA (INAME(317,J),J=1,4)/'3   ','PAR ','INVE','GAUS'/
      DATA INSHAP(317)/2/
      DATA INLONG(317)/'3-PARAMETER INVERSE GAUSSIAN'/
C     JOHNSON
      DATA INCASE(318)/'JOHN'/
      DATA (INAME(318,J),J=1,4)/'JOHN','    ','    ','    '/
      DATA INSHAP(318)/2/
      DATA INLONG(318)/'JOHNSON SB/SU'/
C     3-PARAMETER FRECHET
      DATA INCASE(319)/'3EV2'/
      DATA (INAME(319,J),J=1,4)/'3   ','PARA','FREC','    '/
      DATA INSHAP(319)/1/
      DATA INLONG(319)/'3-PARAMETER FRECHET'/
C     3-PARAMETER FRECHET
      DATA INCASE(320)/'3EV2'/
      DATA (INAME(320,J),J=1,4)/'3   ','PAR ','FREC','    '/
      DATA INSHAP(320)/1/
      DATA INLONG(320)/'3-PARAMETER FRECHET'/
C     3-PARAMETER FRECHET
      DATA INCASE(321)/'3EV2'/
      DATA (INAME(321,J),J=1,4)/'3PAR','FREC','    ','    '/
      DATA INSHAP(321)/1/
      DATA INLONG(321)/'3-PARAMETER FRECHET'/
C     3-PARAMETER FRECHET
      DATA INCASE(322)/'3EV2'/
      DATA (INAME(322,J),J=1,4)/'3PAR','EXTR','VALU','TWO '/
      DATA INSHAP(322)/1/
      DATA INLONG(322)/'3-PARAMETER FRECHET'/
C     3-PARAMETER FRECHET
      DATA INCASE(323)/'3EV2'/
      DATA (INAME(323,J),J=1,4)/'3PAR','EXTR','VALU','2   '/
      DATA INSHAP(323)/1/
      DATA INLONG(323)/'3-PARAMETER FRECHET'/
C     3-PARAMETER FRECHET
      DATA INCASE(323)/'3EV2'/
      DATA (INAME(323,J),J=1,4)/'3   ','PARA','EV2 ','    '/
      DATA INSHAP(323)/1/
      DATA INLONG(323)/'3-PARAMETER FRECHET'/
C     3-PARAMETER FRECHET
      DATA INCASE(324)/'3EV2'/
      DATA (INAME(324,J),J=1,4)/'3   ','PAR ','EV2 ','    '/
      DATA INSHAP(324)/1/
      DATA INLONG(324)/'3-PARAMETER FRECHET'/
C     3-PARAMETER FRECHET
      DATA INCASE(325)/'3EV2'/
      DATA (INAME(325,J),J=1,4)/'3PAR','EV2 ','    ','    '/
      DATA INSHAP(325)/1/
      DATA INLONG(325)/'3-PARAMETER FRECHET'/
C     1-PARAMETER HALF-NORMAL
      DATA INCASE(326)/'1HNO'/
      DATA (INAME(326,J),J=1,4)/'1   ','PARA','HALF','NORM'/
      DATA INSHAP(326)/0/
      DATA INLONG(326)/'1-PARAMETER HALF-NORMAL'/
C     1-PARAMETER HALF-NORMAL
      DATA INCASE(327)/'1HNO'/
      DATA (INAME(327,J),J=1,4)/'ONE ','PARA','HALF','NORM'/
      DATA INSHAP(327)/0/
      DATA INLONG(327)/'1-PARAMETER HALF-NORMAL'/
C     1-PARAMETER HALF-LOGISTIC
      DATA INCASE(328)/'1HAL'/
      DATA (INAME(328,J),J=1,4)/'1   ','PARA','HALF','LOGI'/
      DATA INSHAP(328)/0/
      DATA INLONG(328)/'1-PARAMETER HALF-LOGISITC'/
C     1-PARAMETER HALF-LOGISTIC
      DATA INCASE(329)/'1HAL'/
      DATA (INAME(329,J),J=1,4)/'ONE ','PARA','HALF','LOGI'/
      DATA INSHAP(329)/0/
      DATA INLONG(329)/'1-PARAMETER HALF-LOGISITC'/
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='EXTD'
      ISUBN2='IS  '
      IWRITE='OFF'
      IFOUND='NO'
      IERROR='NO'
C
      IF(IBUGG3.EQ.'ON'.OR.ISUBRO.EQ.'TDIS')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,51)
   51   FORMAT('***** AT THE BEGINNING OF EXTDIS--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,52)IBUGG3,ISUBRO,NUMARG,JMIN,JMAX
   52   FORMAT('IBUGG3,ISUBRO,NUMARG,JMIN,JMAX = ',A4,2X,A4,3I8)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,53)ICOM,ICOM2
   53   FORMAT('ICOM,ICOM2 = ',A4,2X,A4)
        CALL DPWRST('XXX','BUG ')
        IF(NUMARG.GE.1)THEN
          DO60I=1,NUMARG
            WRITE(ICOUT,61)I,IHARG(I),IHARG2(I)
   61       FORMAT('I,IHARG(I),IHARG2(I) = ',I8,2X,A4,2X,A4)
            CALL DPWRST('XXX','BUG ')
   60     CONTINUE
        ENDIF
        WRITE(ICOUT,63)MAXDIS
   63   FORMAT('MAXDIS = ',I8)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
C     STEP 1: INITIALIZE THE MATCHING VARIABLE
C
      DO1010I=1,MAXDIS
        INTEMP(I)='    '
 1010 CONTINUE
      IF(JMIN.EQ.0)THEN
        INTEMP(1)=ICOM
        ICNT=1
        IF(JMIN.LT.JMAX)THEN
          DO1020I=JMIN+1,JMAX
            ICNT=ICNT+1
            INTEMP(ICNT)=IHARG(I)
 1020     CONTINUE
        ENDIF
C
        IF(IBUGG3.EQ.'ON'.OR.ISUBRO.EQ.'TDIS')THEN
           WRITE(ICOUT,999)
           CALL DPWRST('XXX','BUG ')
           WRITE(ICOUT,1021)ICNT
 1021      FORMAT('JMIN = 0 CASE, ICNT = ',I8)
           CALL DPWRST('XXX','BUG ')
           DO1022II=1,ICNT
             WRITE(ICOUT,1023)II,INTEMP(II)
 1023        FORMAT('II,INTEMP(II) = ',I8,A4)
             CALL DPWRST('XXX','BUG ')
 1022      CONTINUE
        ENDIF
C
      ELSE
        INTEMP(1)=IHARG(JMIN)
        ICNT=1
        IF(JMAX.GT.JMIN)THEN
          DO1030I=JMIN+1,JMAX
            ICNT=ICNT+1
            INTEMP(ICNT)=IHARG(I)
 1030     CONTINUE
        ENDIF
C
        IF(IBUGG3.EQ.'ON'.OR.ISUBRO.EQ.'TDIS')THEN
           WRITE(ICOUT,999)
           CALL DPWRST('XXX','BUG ')
           WRITE(ICOUT,1031)ICNT
 1031      FORMAT('JMIN > 0 CASE, ICNT = ',I8)
           CALL DPWRST('XXX','BUG ')
           DO1032II=1,ICNT
             WRITE(ICOUT,1033)II,INTEMP(II)
 1033        FORMAT('II,INTEMP(II) = ',I8,A4)
             CALL DPWRST('XXX','BUG ')
 1032      CONTINUE
        ENDIF
C
      ENDIF
C
C     STEP 2: NOW CHECK IF MATCHING VARIABLE MATCHES AN ENTRY
C             IN THE TABLE.  NOTE THAT WE NEED TO CHECK FOR
C             NAME CONFLICTS IN FIRST 4 CHARACTERS OF FIRST
C             ARGUMENT.
C
      DO2000I=1,MAXDIS
        IROW=I
        IF(INAME(I,1).NE.INTEMP(1))GOTO2000
C
        IF(IBUGG3.EQ.'ON'.OR.ISUBRO.EQ.'TDIS')THEN
           WRITE(ICOUT,999)
           CALL DPWRST('XXX','BUG ')
           WRITE(ICOUT,2001)I,INAME(I,1),INTEMP(1)
 2001      FORMAT('I,INAME(I,1),INTEMP(1) = ',I8,2X,A4,2X,A4)
           CALL DPWRST('XXX','BUG ')
        ENDIF
C
C       NOW CHECK IF REMAINING ARGUMENTS MATCH
C
        ITEMP=1
        DO2022J=2,MAXSCL
          IF(INAME(IROW,J).NE.'    ')GOTO2022
            ITEMP=J-1
            GOTO2024
 2022   CONTINUE
        ITEMP=MAXSCL
 2024   CONTINUE
C
        IF(IBUGG3.EQ.'ON'.OR.ISUBRO.EQ.'TDIS')THEN
           WRITE(ICOUT,2027)IROW,ITEMP
 2027      FORMAT('IROW,ITEMP = ',2I8)
           CALL DPWRST('XXX','BUG ')
        ENDIF
C
        IF(ITEMP.GT.1)THEN
          DO2028J=2,ITEMP
            IF(INAME(IROW,J).NE.INTEMP(J))GOTO2000
 2028     CONTINUE
        ENDIF
C
        IFOUND='YES'
        IF(ITEMP.EQ.1)THEN
          ILOCV=JMIN+1
        ELSE
          ILOCV=JMIN+(ITEMP-2)+1
        ENDIF
        IDISCS=INCASE(IROW)
        IDISPR=INSHAP(IROW)
        IDISNM=INLONG(IROW)
        GOTO2099
C
 2000 CONTINUE
 2099 CONTINUE
C
C
C               ******************
C               **   STEP 90--  **
C               **   EXIT       **
C               ******************
C
      IF(IBUGG3.EQ.'ON'.OR.ISUBRO.EQ.'TDIS')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9011)
 9011   FORMAT('***** AT THE END       OF EXTDIS--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9012)IBUGG3,ISUBRO,IFOUND
 9012   FORMAT('IBUGG3,ISUBRO,IFOUND = ',A4,2X,A4,2X,A4)
        CALL DPWRST('XXX','BUG ')
        IF(IFOUND.EQ.'YES')THEN
          WRITE(ICOUT,9013)IDISCS,IDISPR,ILOCV
 9013     FORMAT('IDISCS,IDISPR,ILOCV = ',A4,2X,I5,2X,2I8)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,9014)IDISNM
 9014     FORMAT('IDISNM = ',A60)
          CALL DPWRST('XXX','BUG ')
        ENDIF
      ENDIF
C
      RETURN
      END
      SUBROUTINE EXTDST(ICASPL,IDISFL,ILOWLM,
     1                  SHAPE1,SHAPE2,SHAPE3,SHAPE4,
     1                  SHAPE5,SHAPE6,SHAPE7,
     1                  IADEDF,IGEPDF,IMAKDF,IBEIDF,
     1                  ILGADF,ISKNDF,IGLDDF,IBGEDF,
     1                  IGETDF,ICONDF,IGOMDF,IKATDF,
     1                  IGIGDF,IGEODF)
C
C     PURPOSE--SET VALUE OF IDISFL TO "CONT" OR "DISC" DEPENDING
C              ON WHETHER WE HAVE A CONTINOUS OR A DISCRETE
C              DISTRIBUTION.  ALSO RETURN THE VALUE OF THE LOWER LIMIT
C              (TYPICALLY EITHER 0 OR 1) IN ILOWLM.
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORAOTRY
C                 NATIONAL INSTITUTE OF STANDARDS OF TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS OF TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2010/1
C     ORIGINAL VERSION--JANUARY   2010.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 ICASPL
      CHARACTER*4 IDISFL
      CHARACTER*4 IADEDF
      CHARACTER*4 IGEPDF
      CHARACTER*4 IMAKDF
      CHARACTER*4 IBEIDF
      CHARACTER*4 ILGADF
      CHARACTER*4 ISKNDF
      CHARACTER*4 IGLDDF
      CHARACTER*4 IBGEDF
      CHARACTER*4 IGETDF
      CHARACTER*4 ICONDF
      CHARACTER*4 IGOMDF
      CHARACTER*4 IKATDF
      CHARACTER*4 IGIGDF
      CHARACTER*4 IGEODF
      CHARACTER*4 IBUGG2
C
      DOUBLE PRECISION DZETA
C
C---------------------------------------------------------------------
C
C-----COMMON VARIABLES (GENERAL)--------------------------------------
C
      INCLUDE 'DPCOMC.INC'
      INCLUDE 'DPCOP2.INC'
C
      IBUGG2='OFF'
      IF(IBUGG2.EQ.'ON')THEN
        WRITE(ICOUT,55)SHAPE1,SHAPE2,SHAPE3,SHAPE4
   55   FORMAT('SHAPE1,SHAPE2,SHAPE3,SHAPE4 = ',4G15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,56)SHAPE5,SHAPE6,SHAPE7
   56   FORMAT('SHAPE5,SHAPE6,SHAPE7 = ',4G15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,57)ISKNDF,IBEIDF,IBGEDF,IGEODF,IGEPDF
   57   FORMAT('ISKNDF,IBEIDF,IBGEDF,IGEODF,IGEPDF = ',4(A4,2X),A4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,58)IGIGDF,IGLDDF,IKATDF,ILGADF,IADEDF
   58   FORMAT('IGIGDF,IGLDDF,IKATDF,ILGADF,IADEDF = ',4(A4,2X),A4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,59)ICONDF,IGETDF,IGOMDF,IMAKDF
   59   FORMAT('ICONDF,IGETDF,IGOMDF,IMAKDF = ',3(A4,2X),A4)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
      IDISFL='CONT'
      ILOWLM=0
C
      IF(ICASPL.EQ.'BINO')IDISFL='DISC'
      IF(ICASPL.EQ.'GEOM')IDISFL='DISC'
      IF(ICASPL.EQ.'POIS')IDISFL='DISC'
      IF(ICASPL.EQ.'NEBI')IDISFL='DISC'
      IF(ICASPL.EQ.'BBIN')IDISFL='DISC'
      IF(ICASPL.EQ.'BNBI')IDISFL='DISC'
      IF(ICASPL.EQ.'DUNI')IDISFL='DISC'
      IF(ICASPL.EQ.'HYPG')IDISFL='DISC'
      IF(ICASPL.EQ.'POLY')IDISFL='DISC'
      IF(ICASPL.EQ.'HERM')IDISFL='DISC'
      IF(ICASPL.EQ.'YULE')IDISFL='DISC'
      IF(ICASPL.EQ.'BGEO')THEN
        IDISFL='DISC'
        ILOWLM=1
        IF(IBGEDF.EQ.'SHIF')ILOWLM=0
      ENDIF
      IF(ICASPL.EQ.'ZETA')THEN
        IDISFL='DISC'
        ILOWLM=1
        CALL ZETA2(DBLE(SHAPE1),DZETA)
        DZETA=DZETA+1.0D0
      ENDIF
      IF(ICASPL.EQ.'ZIPF')THEN
        IDISFL='DISC'
        ILOWLM=1
CCCCC   IMAX=INT(AMAX+0.00001)
        IMAX=I1MACH(9)
        IF(INT(SHAPE2+0.1).LT.IMAX)SHAPE2=REAL(IMAX)
        CALL HNM(INT(SHAPE2+0.1),DBLE(SHAPE1),DZETA)
      ENDIF
      IF(ICASPL.EQ.'BTAN')THEN
        IDISFL='DISC'
        ILOWLM=INT(SHAPE2+0.1)
      ENDIF
      IF(ICASPL.EQ.'LPOI')IDISFL='DISC'
      IF(ICASPL.EQ.'OCCU')IDISFL='DISC'
      IF(ICASPL.EQ.'LICT')IDISFL='DISC'
      IF(ICASPL.EQ.'MATC')IDISFL='DISC'
      IF(ICASPL.EQ.'AEPP')IDISFL='DISC'
      IF(ICASPL.EQ.'LOST')THEN
        IDISFL='DISC'
        ILOWLM=INT(SHAPE2+0.1)
      ENDIF
      IF(ICASPL.EQ.'GLOS')THEN
        IDISFL='DISC'
CCCCC   ILOWLM=INT(SHAPE3+0.1)
        ILOWLM=1
      ENDIF
      IF(ICASPL.EQ.'GNBI')IDISFL='DISC'
      IF(ICASPL.EQ.'GEET')THEN
        IDISFL='DISC'
        ILOWLM=1
      ENDIF
      IF(ICASPL.EQ.'QBIN')IDISFL='DISC'
      IF(ICASPL.EQ.'CONS')THEN
        IDISFL='DISC'
        ILOWLM=1
      ENDIF
      IF(ICASPL.EQ.'LKAT')IDISFL='DISC'
      IF(ICASPL.EQ.'KATZ')IDISFL='DISC'
      IF(ICASPL.EQ.'DISW')IDISFL='DISC'
      IF(ICASPL.EQ.'GLGP')IDISFL='DISC'
      IF(ICASPL.EQ.'TGNB')IDISFL='DISC'
      IF(ICASPL.EQ.'WARI')IDISFL='DISC'
      IF(ICASPL.EQ.'GWAR')IDISFL='DISC'
      IF(ICASPL.EQ.'LOGS')THEN
        IDISFL='DISC'
        ILOWLM=1
      ENDIF
C
      RETURN
      END
      SUBROUTINE EXTIND(X,N,IWRITE,PSTAMV,XIND,ISUBRO,IBUGA3,IERROR)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE INDEX WHERE THE
C              SAMPLE EXTREME OF THE DATA IN THE INPUT VECTOR X
C              OCCURS.
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VECTOR OF
C                                (UNSORTED OR SORTED) OBSERVATIONS.
C                     --N      = THE INTEGER NUMBER OF OBSERVATIONS
C                                IN THE VECTOR X.
C     OUTPUT ARGUMENTS--XIND   = THE SINGLE PRECISION VALUE OF THE
C                                COMPUTED INDEX OF THE SAMPLE EXTREME.
C     OUTPUT--THE COMPUTED SINGLE PRECISION VALUE OF THE
C             SAMPLE INDEX OF THE EXTREME.
C     RESTRICTIONS--THERE IS NO RESTRICTION ON THE MAXIMUM VALUE
C                   OF N FOR THIS SUBROUTINE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--NONE.
C     MODE OF INTERNAL OPERATIONS--DOUBLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2009.2
C     ORIGINAL VERSION--FEBRUARY  2009.
C     UPDATED  VERSION--APRIL     2010. SKIP "MISSING VALUES"
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 IWRITE
      CHARACTER*4 ISUBRO
      CHARACTER*4 IBUGA3
      CHARACTER*4 IERROR
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
C
C---------------------------------------------------------------------
C
      DIMENSION X(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='EXTI'
      ISUBN2='ND  '
      IERROR='NO'
C
      IF(IBUGA3.EQ.'ON' .OR. ISUBRO.EQ.'TIND')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,51)
   51   FORMAT('***** AT THE BEGINNING OF EXTIND--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,52)IBUGA3
   52   FORMAT('IBUGA3 = ',A4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,53)N
   53   FORMAT('N = ',I8)
        CALL DPWRST('XXX','BUG ')
        DO55I=1,N
          WRITE(ICOUT,56)I,X(I)
   56     FORMAT('I,X(I) = ',I8,G15.7)
          CALL DPWRST('XXX','BUG ')
   55   CONTINUE
      ENDIF
C
C               ***********************
C               **  COMPUTE EXTREME  **
C               ***********************
C
C               ********************************************
C               **  STEP 1--                              **
C               **  CHECK THE INPUT ARGUMENTS FOR ERRORS  **
C               ********************************************
C
      AN=N
C
      IF(N.LT.1)THEN
        IERROR='YES'
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,111)
  111   FORMAT('***** ERROR IN INDEX EXTREME--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,112)
  112   FORMAT('      THE INPUT NUMBER OF OBSERVATIONS FOR THE ',
     1         'RESPONSE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,113)
  113   FORMAT('      VARIABLE MUST BE 1 OR LARGER.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,116)
  116   FORMAT('      SUCH WAS NOT THE CASE HERE.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,117)N
  117   FORMAT('      THE INPUT NUMBER OF OBSERVATIONS HERE = ',I8,
     1         '.')
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
C
      IF(N.EQ.1)THEN
        XIND=1.0
        GOTO800
      ENDIF
C
C               *****************************************
C               **  STEP 2--                           **
C               **  COMPUTE THE INDEX OF THE EXTREME.  **
C               *****************************************
C
      XEXT=CPUMIN
      XIND=1.0
      DO200I=1,N
        XTEMP=ABS(X(I))
        IF(XEXT.EQ.CPUMIN)THEN
          IF(XTEMP.EQ.PSTAMV)GOTO200
          XEXT=XTEMP
          XIND=REAL(I)
        ELSE
          IF(XTEMP.NE.PSTAMV .AND. XTEMP.GT.XEXT)THEN
            XEXT=XTEMP
            XIND=REAL(I)
          ENDIF
        ENDIF
  200 CONTINUE
C
C               *******************************
C               **  STEP 3--                 **
C               **  WRITE OUT A LINE         **
C               **  OF SUMMARY INFORMATION.  **
C               *******************************
C
  800 CONTINUE
      IF(IFEEDB.EQ.'ON' .AND. IWRITE.EQ.'ON')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,811)N,XIND
  811   FORMAT('THE INDEX FOR THE EXTREME VALUE OF THE ',I8,
     1         ' OBSERVATIONS = ',F12.0)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT.      **
C               *****************
C
 9000 CONTINUE
      IF(IBUGA3.EQ.'ON' .OR. ISUBRO.EQ.'TIND')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9011)
 9011   FORMAT('***** AT THE END       OF EXTIND--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9012)IBUGA3,IERROR
 9012   FORMAT('IBUGA3,IERROR = ',A4,2X,A4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9013)N
 9013   FORMAT('N = ',I8)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9015)XEXT,XEXT2,XIND
 9015   FORMAT('XEXT,XEXT2,XIND = ',3G15.7)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
      RETURN
      END
      SUBROUTINE EXTINT(IATEMP,NCHAR,IVALUE,IBUGS2,ISUBRO,IERROR)
C
C     PURPOSE--THIS SUBROUTINE EXTRACTS AN INTEGER VALUE FROM
C              A CHARACTER STRING.  LOOK FOR FIRST AND LAST
C              NON-BLANK CHARACTERS (IF ENTIRE FIELD IS BLANK,
C              RETURN A 0).  IF A NON-INTEGER VALUE ENCOUNTERED,
C              PRINT AN ERROR MESSAGE.
C
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C               HOST DEPENDENT
C     VERSION NUMBER--2014.10
C     ORIGINAL VERSION--OCTOBER    2014.
C     UPDATED         --NOVEMBER   2015. CHECK FOR "+" SIGN
C
C-----NON-COMMON VARIABLES (GRAPHICS)---------------------------------
C
      CHARACTER*(*) IATEMP
      CHARACTER*4   IBUGS2
      CHARACTER*4   ISUBRO
      CHARACTER*4   IERROR
      CHARACTER*10  IFORMT
C
C-----COMMON VARIABLES (GENERAL)--------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      IERROR='NO'
C
      IF(IBUGS2.EQ.'ON' .OR. ISUBRO.EQ.'TINT')THEN
        WRITE(ICOUT,51)NCHAR
   51   FORMAT('START  OF EXTINT, NCHAR = ',I8)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
C     FIND FIRST NON-BLANK CHARACTER
C
      ISIGN=1
      ISTRT=0
      DO 100 I=1,NCHAR
         IF (IATEMP(I:I).EQ.' ')GOTO100
            ISTRT=I
            GOTO199
  100 CONTINUE
      IVALUE=0
      GOTO9090
  199 CONTINUE
C
C     FIND LAST NON-BLANK CHARACTER
C
      ILAST=NCHAR
      DO 200 I=NCHAR,ISTRT,-1
         IF (IATEMP(I:I).EQ.' ')GOTO200
            ILAST=I
            GOTO299
  200 CONTINUE
      IVALUE=0
      GOTO9090
  299 CONTINUE
C
C     TRUNCATED IF A DECIMAL POINT FOUND
C
      DO 2200 I=ISTRT,ILAST
         IF (IATEMP(I:I).EQ.'.')THEN
            ILAST=I-1
            GOTO2299
         ENDIF
 2200 CONTINUE
 2299 CONTINUE
C
      IF (ISTRT+3.LE.NCHAR) THEN
         IF (IATEMP(ISTRT:ISTRT+3).EQ.'NULL')THEN
            IVALUE=-999999
            GOTO9090
         ENDIF
      ENDIF
C
C     CONVERT TEXT TO INTEGER
C
      IF (IATEMP(ISTRT:ISTRT).EQ.'-') THEN
         ISIGN=-1
         ISTRT=ISTRT+1
C
C     2015/11: CHECK FOR "+" AS WELL
C
      ELSEIF (IATEMP(ISTRT:ISTRT).EQ.'+') THEN
         ISIGN=+1
         ISTRT=ISTRT+1
      ENDIF
      DO 300 I=ISTRT,ILAST
         IF (IATEMP(I:I).EQ.' ')THEN
            IATEMP(I:I)='0'
         ELSE
            ITEMP=ICHAR(IATEMP(I:I))
            IF(ITEMP.LT.48 .OR. ITEMP.GT.57)THEN
              WRITE(ICOUT,2301)
 2301         FORMAT('****** ERROR FROM READ CLIPBOAR (EXTINT)')
              CALL DPWRST('XXX','BUG ')
              WRITE(ICOUT,2303)
 2303         FORMAT('       NON-INTEGER VALUE ENCOUNTERED WHEN ',
     1               'EXTRACTING AN INTEGER FROM STRING.')
              CALL DPWRST('XXX','BUG ')
              WRITE(ICOUT,2305)CHAR(ITEMP)
 2305         FORMAT('       CHARACTER IS: ',A1)
              IVALUE=-999999
              IERROR='YES'
              GOTO9090
            END IF
         END IF
  300 CONTINUE
      NTEMP=ILAST-ISTRT+1
      IFORMT='(I      )'
      IF (NTEMP.LE.9)THEN
          WRITE(IFORMT(3:3),'(I1)')NTEMP
      ELSE IF (NTEMP.LE.99)THEN
          WRITE(IFORMT(3:4),'(I2)')NTEMP
      ELSE IF (NTEMP.LE.999)THEN
          WRITE(IFORMT(3:5),'(I3)')NTEMP
      ELSE IF (NTEMP.LE.9999)THEN
          WRITE(IFORMT(3:6),'(I4)')NTEMP
      ELSE IF (NTEMP.LE.99999)THEN
          WRITE(IFORMT(3:7),'(I5)')NTEMP
      ELSE IF (NTEMP.LE.999999)THEN
          WRITE(IFORMT(3:8),'(I6)')NTEMP
      END IF
      READ(IATEMP(ISTRT:ILAST),IFORMT,ERR=9010)IVALUE
      GOTO9090
C
 9010 CONTINUE
      WRITE(ICOUT,2301)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9015)
 9015 FORMAT('       UNABLE TO CONVERT STRING TO INTEGER')
      CALL DPWRST('XXX','BUG ')
      IERROR='YES'
      GOTO9090
C
 9090 CONTINUE
      IVALUE=ISIGN*IVALUE
      RETURN
      END
      SUBROUTINE EXTPA1(ICASPL,IDIST,A,B,
     1                  SHAPE1,SHAPE2,SHAPE3,SHAPE4,
     1                  SHAPE5,SHAPE6,SHAPE7,
     1                  IADEDF,IGEPDF,IMAKDF,IBEIDF,
     1                  ILGADF,ISKNDF,IGLDDF,IBGEDF,
     1                  IGETDF,ICONDF,IGOMDF,IKATDF,
     1                  IGIGDF,IGEODF,
     1                  IBFWLI,IEEWLI,
     1                  ISUBRO,IBUGG2,IERROR)
C
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORAOTRY
C                 NATIONAL INSTITUTE OF STANDARDS OF TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS OF TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2009/8
C     ORIGINAL VERSION--AUGUST    2009.
C     UPDATED         --JULY      2010. END EFFECTS WEIBULL
C     UPDATED         --AUGUST    2010. BRITTLE FIBER WEIBULL
C     UPDATED         --OCTOBER   2010. IBFWLI, IEEWLI
C     UPDATED         --JANUARY   2011. ARCTANGENT
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*30 IDIST
C
      CHARACTER*4 IADEDF
      CHARACTER*4 IGEPDF
      CHARACTER*4 IMAKDF
      CHARACTER*4 IBEIDF
      CHARACTER*4 ILGADF
      CHARACTER*4 ISKNDF
      CHARACTER*4 IGLDDF
      CHARACTER*4 IBGEDF
      CHARACTER*4 IGETDF
      CHARACTER*4 ICONDF
      CHARACTER*4 IGOMDF
      CHARACTER*4 IKATDF
      CHARACTER*4 IGIGDF
      CHARACTER*4 IGEODF
      CHARACTER*4 IBFWLI
      CHARACTER*4 IEEWLI
C
      CHARACTER*4 ICASPL
      CHARACTER*4 IBUGG2
      CHARACTER*4 ISUBRO
      CHARACTER*4 IERROR
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
      CHARACTER*4 ISTEPN
C
      CHARACTER*4 IH
      CHARACTER*4 IH2
      CHARACTER*4 IH21
      CHARACTER*4 IH22
      CHARACTER*4 IH31
      CHARACTER*4 IH32
      CHARACTER*4 IH41
      CHARACTER*4 IH42
      CHARACTER*4 IH51
      CHARACTER*4 IH52
      CHARACTER*4 LOWLTY
      CHARACTER*4 UPPLTY
      CHARACTER*4 LOWLT2
      CHARACTER*4 UPPLT2
      CHARACTER*4 LOWLT3
      CHARACTER*4 UPPLT3
      CHARACTER*4 LOWLT4
      CHARACTER*4 UPPLT4
      CHARACTER*4 LOWLT5
      CHARACTER*4 UPPLT5
C
      CHARACTER*4 IHWUSE
      CHARACTER*4 MESSAG
C
      INCLUDE 'DPCOMC.INC'
      INCLUDE 'DPCOPA.INC'
      INCLUDE 'DPCOHK.INC'
C
C---------------------------------------------------------------------
C
C-----COMMON VARIABLES (GENERAL)--------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C               ***********************************************
C               **  STEP 1--                                 **
C               **  FOR THOSE DISTRIBUTIONS REQUIRING THEM,  **
C               **  DETERMINE IF THE ANALYST                 **
C               **  HAS SPECIFIED PARAMETER VALUES           **
C               ***********************************************
C
      SHAPE1=CPUMIN
      SHAPE2=CPUMIN
      SHAPE3=CPUMIN
      SHAPE4=CPUMIN
      SHAPE5=CPUMIN
      SHAPE6=CPUMIN
      SHAPE7=CPUMIN
C
      ISUBN1='EXTP'
      ISUBN2='A1  '
      ISTEPN='1'
      IF(IBUGG2.EQ.'ON'.OR.ISUBRO.EQ.'TPA1')THEN
        CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
        WRITE(ICOUT,55)IDIST
   55   FORMAT('AT BEGINNING OF EXTPA1: IDIST = ',A30)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,57)ISKNDF,IBEIDF,IBGEDF,IGEODF,IGEPDF
   57   FORMAT('ISKNDF,IBEIDF,IBGEDF,IGEODF,IGEPDF = ',4(A4,2X),A4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,58)IGIGDF,IGLDDF,IKATDF,ILGADF
   58   FORMAT('IGIGDF,IGLDDF,IKATDF,ILGADF = ',3(A4,2X),A4)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
      IF(ICASPL.EQ.'TULA' .OR. ICASPL.EQ.'SNOR')THEN
        IH='LAMB'
        IH2='DA  '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<=  '
        GOTO4100
      ELSEIF(ICASPL.EQ.'POIS')THEN
        IH='LAMB'
        IH2='DA  '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        GOTO4100
      ELSEIF(ICASPL.EQ.'TPP')THEN
        IH='NU  '
        IH2='    '
        ALOWLM=1.0
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<=  '
        GOTO4100
      ELSEIF(
     1       ICASPL.EQ.'CHIS' .OR. ICASPL.EQ.'CHI' .OR.
     1       ICASPL.EQ.'FT  '
     1      )THEN
        IH='NU  '
        IH2='    '
        ILOWLM=1
        IUPPLM=I1MACH(9)
        LOWLTY='>=  '
        UPPLTY='<=  '
        GOTO5100
      ELSEIF(ICASPL.EQ.'FPP')THEN
        IH='NU1 '
        IH2='    '
        IDIST='F     '
        ILOWLM=1
        IUPPLM=I1MACH(9)
        LOWLTY='>=  '
        UPPLTY='<=  '
        IH21='NU2 '
        IH22='    '
        ILOWL2=1
        IUPPL2=I1MACH(9)
        LOWLT2='>=  '
        UPPLT2='<=  '
        GOTO5200
      ELSEIF(
     1   ICASPL.EQ.'GAMM' .OR. ICASPL.EQ.'WEIB' .OR.
     1   ICASPL.EQ.'EV2 ' .OR. ICASPL.EQ.'WALD' .OR.
     1   ICASPL.EQ.'FATL' .OR. ICASPL.EQ.'DWEI' .OR.
     1   ICASPL.EQ.'DGAM' .OR. ICASPL.EQ.'IGAM' .OR.
     1   ICASPL.EQ.'IWEI' .OR. ICASPL.EQ.'GEEX' .OR.
     1   ICASPL.EQ.'LGAM' .OR.
     1   ICASPL.EQ.'3GAM' .OR. ICASPL.EQ.'3WEI' .OR.
     1   ICASPL.EQ.'3IGA' .OR.
     1   ICASPL.EQ.'3IWE'
     1  )THEN
        IH='GAMM'
        IH2='A   '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        GOTO4100
      ELSEIF(ICASPL.EQ.'PARE' .OR. ICASPL.EQ.'PAR2')THEN
        IH='GAMM'
        IH2='A   '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='A   '
        IH22='    '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(ICASPL.EQ.'BFWE')THEN
        IH='GAMM'
        IH2='A   '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IF(IBFWLI.EQ.'VARI')THEN
          GOTO4100
        ELSE
          IH21='L   '
          IH22='    '
          ALOWL2=0.
          AUPPL2=CPUMAX
          LOWLT2='>   '
          UPPLT2='<=  '
          GOTO4200
         ENDIF
      ELSEIF(
     1   ICASPL.EQ.'PEA3' .OR. ICASPL.EQ.'GPAR' .OR.
     1   ICASPL.EQ.'GEV'
     1  )THEN
        IH='GAMM'
        IH2='A   '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        GOTO4100
      ELSEIF(
     1   ICASPL.EQ.'BETA' .OR. ICASPL.EQ.'HERM' .OR.
     1   ICASPL.EQ.'BGEO' .OR. ICASPL.EQ.'IBET' .OR.
     1   ICASPL.EQ.'BNOR' .OR. ICASPL.EQ.'POWL'
     1  )THEN
        IH='ALPH'
        IH2='A   '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='BETA'
        IH22='    '
        ALOWL2=0.0
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(ICASPL.EQ.'TPAR')THEN
        IH='GAMM'
        IH2='A   '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='A   '
        IH22='    '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLT2='>=  '
        UPPLT2='<=  '
        IH31='NU  '
        IH32='    '
        ALOWL3=0.0
        AUPPL3=CPUMAX
        LOWLT3='>   '
        UPPLT3='<=  '
        GOTO4300
      ELSEIF(ICASPL.EQ.'BFRA')THEN
        IH='ALPH'
        IH2='A   '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='BETA'
        IH22='    '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>=  '
        UPPLT2='<=  '
        IH31='R   '
        IH32='    '
        ALOWL3=0.
        AUPPL3=CPUMAX
        LOWLT3='>   '
        UPPLT3='<=  '
        GOTO4300
      ELSEIF(ICASPL.EQ.'BINO')THEN
        IH='P   '
        IH2='    '
        ALOWLM=0.0
        AUPPLM=1.0
        LOWLTY='>=  '
        UPPLTY='<=  '
        IH21='N   '
        IH22='    '
        ILOWL2=1
        IUPPL2=I1MACH(9)
        LOWLT2='>=  '
        UPPLT2='<=  '
        GOTO4900
      ELSEIF(ICASPL.EQ.'GEOM')THEN
        IH='P   '
        IH2='    '
        ALOWLM=0.0
        AUPPLM=1.0
        LOWLTY='>   '
        UPPLTY='<   '
        GOTO4100
      ELSEIF(ICASPL.EQ.'NEBI')THEN
        IH='P   '
        IH2='    '
        ALOWLM=0.0
        AUPPLM=1.0
        LOWLTY='>   '
        UPPLTY='<   '
        IH21='K   '
        IH22='    '
        ALOWL2=0.0
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(ICASPL.EQ.'INGA' .OR. ICASPL.EQ.'RIGA')THEN
        IH='GAMM'
        IH2='A   '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='MU  '
        IH22='    '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(ICASPL.EQ.'TRIA')THEN
C
C       NOTE: FOR TRIANGULAR DISTRIBUTION, THE SHAPE PARAMETER
C             IS BOUNDED BY THE MIN AND MAX OF THE DATA.
C
C             THERE ARE TWO WAYS TO DEAL WITH THIS:
C
C             1) ALLOW THE USER TO SPECIFY LOWER AND UPPER LIMITS
C                (AND SET C BASED ON THESE).
C
C                THE ADVANTAGE OF THIS APPROACH IS THAT C IS
C                GIVEN IN UNITS OF THE DATA.  THE DISADVANTAGE
C                IS THAT WE LOSE THE INVARIANCE OF LOCATION/SCALE
C                OF THE PPCC PLOT. 
C
C             2) USE DEFAULT OF A = -1, B = 1 AND THEN RESTRICT
C                VALUE OF C TO (0,1) INTERVAL.  THE ADVANTAGE
C                OF THIS APPROACH IS THAT WE MAINTAIN THE
C                INVARIANCE OF LOCATION/SCALE (I.E., INDEPENDENT
C                ESTIMATES OF A AND B).  THE DISADVANTAGE IS THAT
C                THE OPTIMAL ESTIMATE OF C HAS TO BE SCALED IF THE
C                DATA IS OUTSIDE THE (0,1) INTERVAL.
C
C                USER CAN SPECIFY LOWER/UPPER LIMITS BY ENTERING
C                LET A = <LOWLIM>  AND  LET B = <UPPLIM>.  THESE
C                PARAMETERS WILL BE CHECKED BEFORE THIS ROUTINE
C                IS CALLED.
C
        IH='C   '
        IH2='    '
        ALOWLM=A
        AUPPLM=B
        LOWLTY='>=  '
        UPPLTY='<=  '
        GOTO4100
      ELSEIF(ICASPL.EQ.'DUNI' .OR. ICASPL.EQ.'LICT')THEN
        IH='N   '
        IH2='    '
        ILOWLM=1
        IUPPLM=I1MACH(9)
        LOWLTY='>=  '
        UPPLTY='<=  '
        GOTO5100
      ELSEIF(ICASPL.EQ.'MATC')THEN
        IH='K   '
        IH2='    '
        ILOWLM=0
        IUPPLM=I1MACH(9)
        LOWLTY='>=  '
        UPPLTY='<=  '
        GOTO5100
      ELSEIF(ICASPL.EQ.'OCCU')THEN
        IH='B   '
        IH2='    '
        ILOWLM=1
        IUPPLM=I1MACH(9)
        LOWLTY='>=  '
        UPPLTY='<=  '
        IH21='C   '
        IH22='    '
        ILOWL2=1
        IUPPL2=I1MACH(9)
        LOWLT2='>=  '
        UPPLT2='<=  '
        GOTO5200
      ELSEIF(ICASPL.EQ.'NCBE')THEN
        IH='ALPH'
        IH2='A   '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='BETA'
        IH22='    '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        IH31='LAMB'
        IH32='DA  '
        ALOWL3=0.
        AUPPL3=CPUMAX
        LOWLT3='>=  '
        UPPLT3='<=  '
        GOTO4300
      ELSEIF(ICASPL.EQ.'DNCB')THEN
        IH='ALPH'
        IH2='A   '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='BETA'
        IH22='    '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        IH31='LAMB'
        IH32='DA1 '
        ALOWL3=0.
        AUPPL3=CPUMAX
        LOWLT3='>=  '
        UPPLT3='<=  '
        IH41='LAMB'
        IH42='DA2 '
        ALOWL4=0.
        AUPPL4=CPUMAX
        LOWLT4='>=  '
        UPPLT4='<=  '
        GOTO4400
      ELSEIF(ICASPL.EQ.'NCCS' .OR. ICASPL.EQ.'NCT')THEN
        IH='NU  '
        IH2='    '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='LAMB'
        IH22='DA  '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>=  '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(ICASPL.EQ.'NCF')THEN
        IH='NU1 '
        IH2='    '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='NU2 '
        IH22='    '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        IH31='LAMB'
        IH32='DA  '
        ALOWL3=0.
        AUPPL3=CPUMAX
        LOWLT3='>=  '
        UPPLT3='<=  '
        GOTO4300
      ELSEIF(ICASPL.EQ.'DNCF')THEN
        IH='NU1 '
        IH2='    '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='NU2 '
        IH22='    '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        IH31='LAMB'
        IH32='DA1 '
        ALOWL3=0.
        AUPPL3=CPUMAX
        LOWLT3='>=  '
        UPPLT3='<=  '
        IH41='LAMB'
        IH42='DA2 '
        ALOWL4=0.
        AUPPL4=CPUMAX
        LOWLT4='>=  '
        UPPLT4='<=  '
        GOTO4400
      ELSEIF(ICASPL.EQ.'DNCT')THEN
        IH='NU  '
        IH2='    '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='LAMB'
        IH22='DA1 '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>=  '
        UPPLT2='<=  '
        IH31='LAMB'
        IH32='DA2 '
        ALOWL3=0.
        AUPPL3=CPUMAX
        LOWLT3='>=  '
        UPPLT3='<=  '
        GOTO4300
      ELSEIF(ICASPL.EQ.'HYPB')THEN
        IH='ALPH'
        IH2='A   '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='XI  '
        IH22='A   '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(ICASPL.EQ.'HYPG')THEN
        IH='M   '
        IH2='    '
        ILOWLM=1
        IUPPLM=I1MACH(9)
        LOWLTY='>=  '
        UPPLTY='<=  '
        CALL PARCHI(IH,IH2,IDIST,ISHAPE,ILOWLM,IUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        SHAPE3=REAL(ISHAPE)
        IH='N   '
        IH2='    '
        ILOWLM=1
        IUPPLM=INT(SHAPE3+0.1)
        LOWLTY='>=  '
        UPPLTY='<=  '
        CALL PARCHI(IH,IH2,IDIST,ISHAPE,ILOWLM,IUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        SHAPE2=REAL(ISHAPE)
        IH='K   '
        IH2='    '
        ILOWLM=1
        IUPPLM=INT(SHAPE3+0.1)
        LOWLTY='>=  '
        UPPLTY='<=  '
        CALL PARCHI(IH,IH2,IDIST,ISHAPE,ILOWLM,IUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        SHAPE1=REAL(ISHAPE)
      ELSEIF(ICASPL.EQ.'VONM')THEN
        IH='B   '
        IH2='    '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<=  '
        GOTO4100
      ELSEIF(ICASPL.EQ.'POWN')THEN
        IH='P   '
        IH2='    '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        GOTO4100
      ELSEIF(ICASPL.EQ.'PLGN')THEN
        IH='P   '
        IH2='    '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='SD  '
        IH22='    '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(
     1       ICASPL.EQ.'ALPH' .OR. ICASPL.EQ.'LDEX' .OR.
     1       ICASPL.EQ.'GLOG' .OR. ICASPL.EQ.'G2LO' .OR.
     1       ICASPL.EQ.'G3LO'
     1      )THEN
        IH='ALPH'
        IH2='A   '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        GOTO4100
      ELSEIF(
     1       ICASPL.EQ.'TOPL' .OR. ICASPL.EQ.'BRAD'.OR.
     1       ICASPL.EQ.'LEXP' .OR. ICASPL.EQ.'PEXP'
     1      )THEN
        IH='BETA'
        IH2='    '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        GOTO4100
      ELSEIF(ICASPL.EQ.'GTOL' .OR. ICASPL.EQ.'RGTL')THEN
        IH='ALPH'
        IH2='A   '
        ALOWLM=0.
        AUPPLM=2.0
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='BETA'
        IH22='    '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(ICASPL.EQ.'KUMA')THEN
        IH='BETA'
        IH2='    '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='ALPH'
        IH22='A   '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(ICASPL.EQ.'LOGN' .OR. ICASPL.EQ.'3LGN')THEN
        IH='SIGM'
        IH2='A   '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        GOTO4100
      ELSEIF(ICASPL.EQ.'POWF' .OR. ICASPL.EQ.'RPOW')THEN
        IH='C   '
        IH2='    '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        GOTO4100
      ELSEIF(ICASPL.EQ.'LOGS')THEN
        IH='THET'
        IH2='A   '
        ALOWLM=0.
        AUPPLM=1.0
        LOWLTY='>   '
        UPPLTY='<   '
        GOTO4100
      ELSEIF(ICASPL.EQ.'GLOS')THEN
        IH='THET'
        IH2='A   '
        ALOWLM=0.
        AUPPLM=1.0
        LOWLTY='>   '
        UPPLTY='<   '
        CALL PARCHR(IH,IH2,IDIST,THETA,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        IH21='BETA'
        IH22='    '
        ALOWL2=1.0
        AUPPL2=1.0/THETA
        LOWLT2='>=  '
        UPPLT2='<   '
        GOTO4200
      ELSEIF(ICASPL.EQ.'GNBI')THEN
        IH='THET'
        IH2='A   '
        ALOWLM=0.
        AUPPLM=1.0
        LOWLTY='>   '
        UPPLTY='<   '
        CALL PARCHR(IH,IH2,IDIST,SHAPE1,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        IH='BETA'
        IH2='    '
        ALOWLM=1.0
        AUPPLM=1.0/THETA
        LOWLTY='>   '
        UPPLTY='<   '
        CALL PARCHR(IH,IH2,IDIST,SHAPE2,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')THEN
          IF(SHAPE2.NE.0.0)THEN
            GOTO9000
          ELSE
            IERROR='NO'
          ENDIF
        ENDIF
        IH='M   '
        IH2='    '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<   '
        CALL PARCHR(IH,IH2,IDIST,SHAPE3,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
      ELSEIF(ICASPL.EQ.'TGNB')THEN
        IH='THET'
        IH2='A   '
        ALOWLM=0.
        AUPPLM=1.0
        LOWLTY='>   '
        UPPLTY='<   '
        CALL PARCHR(IH,IH2,IDIST,SHAPE1,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        IH='BETA'
        IH2='    '
        ALOWLM=1.0
        AUPPLM=1.0/THETA
        LOWLTY='>   '
        UPPLTY='<   '
        CALL PARCHR(IH,IH2,IDIST,SHAPE2,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')THEN
          IF(SHAPE2.NE.0.0)THEN
            GOTO9000
          ELSE
            IERROR='NO'
          ENDIF
        ENDIF
        IH='M   '
        IH2='    '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<   '
        CALL PARCHR(IH,IH2,IDIST,SHAPE3,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        IH='N   '
        IH2='    '
        ILOWLM=1
        IUPPLM=I1MACH(9)
        LOWLTY='>=  '
        UPPLTY='<=  '
        CALL PARCHI(IH,IH2,IDIST,ISHAPE,ILOWLM,IUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        SHAPE4=REAL(ISHAPE)
      ELSEIF(ICASPL.EQ.'LKAT')THEN
        IH='A   '
        IH2='    '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<   '
        IH21='BETA'
        IH22='    '
        ALOWL2=CPUMIN
        AUPPL2=1.0
        LOWLT2='>   '
        UPPLT2='<   '
        IH31='B   '
        IH32='    '
        ALOWL3=0.0
        AUPPL3=CPUMAX
        LOWLT3='>   '
        UPPLT3='<   '
        GOTO4300
      ELSEIF(ICASPL.EQ.'KATZ')THEN
        IH='ALPH'
        IH2='A   '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<   '
        IH21='BETA'
        IH22='    '
        ALOWL2=CPUMIN
        AUPPL2=1.0
        LOWLT2='>   '
        UPPLT2='<   '
        GOTO4200
      ELSEIF(ICASPL.EQ.'QBIN')THEN
        IH='P   '
        IH2='    '
        ALOWLM=0.
        AUPPLM=1.0
        LOWLTY='>=  '
        UPPLTY='<=  '
        CALL PARCHR(IH,IH2,IDIST,SHAPE1,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        IH='M   '
        IH2='    '
        ILOWLM=0
        IUPPLM=I1MACH(9)
        LOWLTY='>=  '
        UPPLTY='<=  '
        CALL PARCHI(IH,IH2,IDIST,ISHAPE,ILOWLM,IUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        SHAPE3=REAL(ISHAPE)
        IF(IERROR.EQ.'YES')GOTO9000
        IH='PHI '
        IH2='    '
        ALOWLM=-SHAPE1/SHAPE3
        AUPPLM=(1.0-SHAPE1)/SHAPE3
        LOWLTY='>   '
        UPPLTY='<   '
        CALL PARCHR(IH,IH2,IDIST,SHAPE2,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
      ELSEIF(ICASPL.EQ.'GEET')THEN
        IF(IGETDF.EQ.'THET')THEN
          IH='THET'
          IH2='A   '
          ALOWLM=0.
          AUPPLM=1.0
          LOWLTY='>   '
          UPPLTY='<   '
          CALL PARCHR(IH,IH2,IDIST,SHAPE1,ALOWLM,AUPPLM,
     1              LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
          IF(IERROR.EQ.'YES')GOTO9000
          IH='BETA'
          IH2='    '
          ALOWLM=1.0
          AUPPLM=1.0/SHAPE1
          LOWLTY='>   '
          UPPLTY='<   '
          CALL PARCHR(IH,IH2,IDIST,SHAPE2,ALOWLM,AUPPLM,
     1                LOWLTY,UPPLTY,
     1                ISUBN1,ISUBN2,IERROR)
          IF(IERROR.EQ.'YES')THEN
            IF(SHAPE2.NE.0.0)THEN
              GOTO9000
            ELSE
              IERROR='NO'
            ENDIF
          ENDIF
        ELSE
          IH='MU  '
          IH2='    '
          ALOWLM=1.0
          AUPPLM=CPUMAX
          LOWLTY='>   '
          UPPLTY='<   '
          IH21='BETA'
          IH22='    '
          ALOWL2=1.0
          AUPPL2=CPUMAX
          LOWLT2='>   '
          UPPLT2='<   '
          GOTO4200
        ENDIF
      ELSEIF(ICASPL.EQ.'CONS')THEN
        IF(ICONDF.EQ.'THET')THEN
          IH='THET'
          IH2='A   '
          ALOWLM=0.
          AUPPLM=1.0
          LOWLTY='>   '
          UPPLTY='<   '
          IH21='M   '
          IH22='    '
          ALOWL2=1.0
          AUPPL2=CPUMAX
          LOWLT2='>=  '
          UPPLT2='<=  '
          GOTO4200
        ELSE
          IH='MU  '
          IH2='    '
          ALOWLM=1.0
          AUPPLM=CPUMAX
          LOWLTY='>   '
          UPPLTY='<   '
          IH21='M   '
          IH22='    '
          ALOWL2=1.0
          AUPPL2=CPUMAX
          LOWLT2='>=  '
          UPPLT2='<   '
          GOTO4200
        ENDIF
      ELSEIF(ICASPL.EQ.'AEPP')THEN
        IH='THET'
        IH2='A   '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<   '
        IH21='P   '
        IH22='    '
        ALOWL2=0.
        AUPPL2=1.0
        LOWLT2='>   '
        UPPLT2='<   '
        GOTO4200
      ELSEIF(ICASPL.EQ.'LOST')THEN
        IH='P   '
        IH2='    '
        ALOWLM=0.5
        AUPPLM=1.0
        LOWLTY='>   '
        UPPLTY='<   '
        IH21='R   '
        IH22='    '
        ILOWL2=0
        IUPPL2=I1MACH(9)
        LOWLT2='>=  '
        UPPLT2='<=  '
        GOTO4900
      ELSEIF(ICASPL.EQ.'GLGP')THEN
        IH='P   '
        IH2='    '
        ALOWLM=0.5
        AUPPLM=1.0
        LOWLTY='>   '
        UPPLTY='<   '
        CALL PARCHR(IH,IH2,IDIST,SHAPE1,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        IH='A   '
        IH2='    '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<   '
        CALL PARCHR(IH,IH2,IDIST,SHAPE3,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        IH='J   '
        IH2='    '
        ILOWLM=0
        IUPPLM=I1MACH(9)
        LOWLTY='>=  '
        UPPLTY='<=  '
        CALL PARCHI(IH,IH2,IDIST,ISHAPE,ILOWLM,IUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        SHAPE2=REAL(ISHAPE)
      ELSEIF(ICASPL.EQ.'DISW')THEN
        IH='Q   '
        IH2='    '
        ALOWLM=0.
        AUPPLM=1.0
        LOWLTY='>   '
        UPPLTY='<   '
        IH21='BETA'
        IH22='    '
        ALOWL2=0.0
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<   '
        GOTO4200
      ELSEIF(ICASPL.EQ.'LOGL')THEN
        IH='DELT'
        IH2='A   '
        IDIST='LOG-LOGISTIC'
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        GOTO4100
      ELSEIF(ICASPL.EQ.'GGAM')THEN
        IH='ALPH'
        IH2='A   '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='C   '
        IH22='    '
        ALOWL2=CPUMIN
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(ICASPL.EQ.'YULE')THEN
        IH='P   '
        IH2='    '
        ALOWLM=0.1
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<   '
        GOTO4100
      ELSEIF(ICASPL.EQ.'WARI')THEN
        IH='C   '
        IH2='    '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='A   '
        IH22='    '
        ALOWL2=0.0
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(ICASPL.EQ.'FNOR')THEN
        IH='MU  '
        IH2='    '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='SD  '
        IH22='    '
        ALOWL2=0.0
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(ICASPL.EQ.'TNOR')THEN
        IH='MU  '
        IH2='    '
        ALOWLM=A
        AUPPLM=B
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='SD  '
        IH22='    '
        ALOWL2=0.0
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(ICASPL.EQ.'GOMP')THEN
        IF(IGOMDF.EQ.'JOHN' .OR. IGOMDF.EQ.'DEFA')THEN
          IH='C   '
          IH2='    '
          ALOWLM=1.
          AUPPLM=CPUMAX
          LOWLTY='>   '
          UPPLTY='<=  '
          IH21='B   '
          IH22='    '
          ALOWL2=0.
          AUPPL2=CPUMAX
          LOWLT2='>   '
          UPPLT2='<=  '
          GOTO4200
        ELSE
          IH='ALPH'
          IH2='A   '
          ALOWLM=0.
          AUPPLM=CPUMAX
          LOWLTY='>   '
          UPPLTY='<=  '
          IH21='K   '
          IH22='    '
          ALOWL2=0.
          AUPPL2=CPUMAX
          LOWLT2='>   '
          UPPLT2='<=  '
          GOTO4200
        ENDIF
      ELSEIF(ICASPL.EQ.'GHLO')THEN
        IH='GAMM'
        IH2='A   '
        ALOWLM=0.0
        AUPPLM=5.0
        LOWLTY='>=  '
        UPPLTY='<=  '
        GOTO4100
      ELSEIF(ICASPL.EQ.'WCAU')THEN
        IH='P   '
        IH2='    '
        ALOWLM=0.
        AUPPLM=1.
        LOWLTY='>=  '
        UPPLTY='<=  '
        GOTO4100
      ELSEIF(ICASPL.EQ.'ARCT')THEN
        IH='PHI '
        IH2='    '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<   '
        IH21='ALPH'
        IH22='A   '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(ICASPL.EQ.'EWEI')THEN
        IH='GAMM'
        IH2='A   '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='THET'
        IH22='A   '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(ICASPL.EQ.'TEXP')THEN
        IH='X0  '
        IH2='    '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='M   '
        IH22='    '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>=  '
        UPPLT2='<=  '
        IH31='SD  '
        IH32='    '
        ALOWL3=0.
        AUPPL3=CPUMAX
        LOWLT3='>   '
        UPPLT3='<=  '
        GOTO4300
      ELSEIF(ICASPL.EQ.'G5LO')THEN
        IH='ALPH'
        IH2='A   '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        GOTO4100
      ELSEIF(ICASPL.EQ.'G4LO')THEN
        IH='P   '
        IH2='    '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='Q   '
        IH22='    '
        ALOWL2=0.0
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(ICASPL.EQ.'WAKE')THEN
C
        IH='GAMM'
        IH2='A   '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        CALL PARCHR(IH,IH2,IDIST,SHAPE1,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
C
        IH='BETA'
        IH2='    '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        CALL PARCHR(IH,IH2,IDIST,SHAPE2,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
C
        IH='DELT'
        IH2='A   '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        CALL PARCHR(IH,IH2,IDIST,SHAPE3,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        IH='ALPH'
        IH2='A   '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        CALL PARCHR(IH,IH2,IDIST,SHAPE4,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        IH='CHI '
        IH2='    '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        CALL PARCHR(IH,IH2,IDIST,SHAPE5,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
      ELSEIF(ICASPL.EQ.'MBKA')THEN
        IH='THET'
        IH2='A   '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='K   '
        IH22='    '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(ICASPL.EQ.'KAPP')THEN
        IH='K   '
        IH2='    '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='H   '
        IH22='    '
        ALOWL2=CPUMIN
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(ICASPL.EQ.'FCAU')THEN
        IH='LOC '
        IH2='    '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='SCAL'
        IH22='E   '
        ALOWL2=0.0
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(ICASPL.EQ.'BBIN' .OR. ICASPL.EQ.'POLY')THEN
        IH='ALPH'
        IH2='A   '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        CALL PARCHR(IH,IH2,IDIST,SHAPE1,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        IH='BETA'
        IH2='    '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        CALL PARCHR(IH,IH2,IDIST,SHAPE2,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        IH='N   '
        IH2='    '
        ILOWLM=0
        IUPPLM=I1MACH(9)
        LOWLTY='>   '
        UPPLTY='<=  '
        CALL PARCHI(IH,IH2,IDIST,ISHAPE,ILOWLM,IUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        SHAPE3=REAL(ISHAPE)
      ELSEIF(ICASPL.EQ.'BNBI' .OR. ICASPL.EQ.'GWAR')THEN
        IH='ALPH'
        IH2='A   '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='BETA'
        IH22='    '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        IH31='K   '
        IH32='    '
        ALOWL3=0.
        AUPPL3=CPUMAX
        LOWLT3='>   '
        UPPLT3='<=  '
        GOTO4300
      ELSEIF(ICASPL.EQ.'ZETA')THEN
        IH='ALPH'
        IH2='A   '
        ALOWLM=1.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        GOTO4100
      ELSEIF(ICASPL.EQ.'ZIPF')THEN
        IH='ALPH'
        IH2='A   '
        ALOWLM=1.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='N   '
        IH22='    '
        ILOWL2=1
        IUPPL2=I1MACH(9)
        LOWLT2='>   '
        UPPLT2='<=  '
        GOTO4900
      ELSEIF(ICASPL.EQ.'MUTH')THEN
        IH='BETA'
        IH2='    '
        ALOWLM=0.
        AUPPLM=1.0
        LOWLTY='>=  '
        UPPLTY='<=  '
        GOTO4100
      ELSEIF(ICASPL.EQ.'L3EX')THEN
        IH='BETA'
        IH2='    '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='ALPH'
        IH22='A   '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        IH31='THET'
        IH32='A   '
        ALOWL3=0.
        AUPPL3=CPUMAX
        LOWLT3='>=  '
        UPPLT3='<=  '
        GOTO4300
      ELSEIF(ICASPL.EQ.'GEXP')THEN
        IH='LAMB'
        IH2='DA1 '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='LAMB'
        IH22='DA12'
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        IH31='S   '
        IH32='    '
        ALOWL3=0.
        AUPPL3=CPUMAX
        LOWLT3='>   '
        UPPLT3='<=  '
        GOTO4300
      ELSEIF(ICASPL.EQ.'RECI')THEN
        IH='B   '
        IH2='    '
        ALOWLM=1.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        GOTO4100
      ELSEIF(ICASPL.EQ.'NORX')THEN
        IH='U1  '
        IH2='    '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<=  '
        CALL PARCHR(IH,IH2,IDIST,SHAPE1,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        IH='SD1 '
        IH2='    '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<=  '
        CALL PARCHR(IH,IH2,IDIST,SHAPE2,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        IH='U2  '
        IH2='    '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        CALL PARCHR(IH,IH2,IDIST,SHAPE3,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        IH='SD2 '
        IH2='    '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        CALL PARCHR(IH,IH2,IDIST,SHAPE4,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        IH='P   '
        IH2='    '
        ALOWLM=0.0
        AUPPLM=1.0
        LOWLTY='>   '
        UPPLTY='<   '
        CALL PARCHR(IH,IH2,IDIST,SHAPE5,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
      ELSEIF(ICASPL.EQ.'ALDE')THEN
        IH='ALPH'
        IH2='A   '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<   '
        IH21='BETA'
        IH22='    '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<   '
        GOTO4200
      ELSEIF(ICASPL.EQ.'JOSU' .OR. ICASPL.EQ.'JOSB')THEN
        IH='ALPH'
        IH2='A1  '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<=  '
        IH21='ALPH'
        IH22='A2  '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(ICASPL.EQ.'GTLA')THEN
        IH='LAMB'
        IH2='DA3 '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<=  '
        IH21='LAMB'
        IH22='DA4 '
        ALOWL2=CPUMIN
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(ICASPL.EQ.'ERRO')THEN
        IH='ALPH'
        IH2='A   '
        ALOWLM=1.0
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<=  '
        GOTO4100
      ELSEIF(ICASPL.EQ.'TSPO')THEN
        IH='THET'
        IH2='A   '
        ALOWLM=A
        AUPPLM=B
        LOWLTY='>=  '
        UPPLTY='<=  '
        IH21='N   '
        IH22='    '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(ICASPL.EQ.'BWEI')THEN
        IH='SCAL'
        IH2='E1  '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        CALL PARCHR(IH,IH2,IDIST,SHAPE1,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        IH='SCAL'
        IH2='E2  '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        CALL PARCHR(IH,IH2,IDIST,SHAPE2,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        IH='GAMM'
        IH2='A1  '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        CALL PARCHR(IH,IH2,IDIST,SHAPE3,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        IH='GAMM'
        IH2='A2  '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        CALL PARCHR(IH,IH2,IDIST,SHAPE4,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        IH='LOC2'
        IH2='    '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        CALL PARCHR(IH,IH2,IDIST,SHAPE5,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
      ELSEIF(ICASPL.EQ.'TRAP')THEN
        IH='A   '
        IH2='    '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<=  '
        IH21='B   '
        IH22='    '
        ALOWL2=CPUMIN
        AUPPL2=CPUMAX
        LOWLT2='>=  '
        UPPLT2='<=  '
        IH31='C   '
        IH32='    '
        ALOWL3=CPUMIN
        AUPPL3=CPUMAX
        LOWLT3='>=  '
        UPPLT3='<=  '
        IH41='D   '
        IH42='    '
        ALOWL4=CPUMIN
        AUPPL4=CPUMAX
        LOWLT4='>=  '
        UPPLT4='<=  '
        GOTO4400
      ELSEIF(ICASPL.EQ.'GTRA')THEN
        IH='A   '
        IH2='    '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<=  '
        CALL PARCHR(IH,IH2,IDIST,SHAPE1,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        IH='B   '
        IH2='    '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<=  '
        CALL PARCHR(IH,IH2,IDIST,SHAPE2,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        IH='C   '
        IH2='    '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<=  '
        CALL PARCHR(IH,IH2,IDIST,SHAPE3,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        IH='D   '
        IH2='    '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<=  '
        CALL PARCHR(IH,IH2,IDIST,SHAPE4,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        IH='ALPH'
        IH2='A   '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        CALL PARCHR(IH,IH2,IDIST,SHAPE5,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        IH='NU1 '
        IH2='    '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        CALL PARCHR(IH,IH2,IDIST,SHAPE6,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        IH='NU3 '
        IH2='    '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        CALL PARCHR(IH,IH2,IDIST,SHAPE7,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
C
        IF(SHAPE1.GE.SHAPE2 .OR. SHAPE2.GE.SHAPE3 .OR.
     1     SHAPE3.GE.SHAPE4)THEN
          WRITE(ICOUT,7322)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,7323)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,7324)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,7326)SHAPE1,SHAPE2,SHAPE3,SHAPE4
          CALL DPWRST('XXX','BUG ')
          IERROR='YES'
          GOTO9000
        ENDIF
 7322   FORMAT(
     1'***** ERROR--FOR THE GENERALZIED TRAPEZOID DISTRIBUTION,')
 7323   FORMAT(
     1'      THE FOUR SHAPE PARAMETERS (A, B, C, D) MUST SATISFY')
 7324   FORMAT(
     1'         A < B < C < D')
 7326   FORMAT(
     1'      A, B, C, D = ',4G15.7)
C
      ELSEIF(ICASPL.EQ.'TSKE')THEN
        IH='NU  '
        IH2='    '
        ALOWLM=1.0
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<=  '
        IH21='LAMB'
        IH22='DA  '
        ALOWL2=CPUMIN
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<   '
        GOTO4200
      ELSEIF(ICASPL.EQ.'GOMM')THEN
        IF(IMAKDF.EQ.'DLMF')THEN
          IH='XI  '
          IH2='    '
          ALOWLM=0.0
          AUPPLM=CPUMAX
          LOWLTY='>   '
          UPPLTY='<=  '
          IH21='LAMB'
          IH22='DA  '
          ALOWL2=0.0
          AUPPL2=CPUMAX
          LOWLT2='>=  '
          UPPLT2='<=  '
          IH31='THET'
          IH32='A   '
          ALOWL3=0.0
          AUPPL3=CPUMAX
          LOWLT3='>=  '
          UPPLT3='<=  '
          GOTO4300
        ELSEIF(IMAKDF.EQ.'MEEK')THEN
          IH='GAMM'
          IH2='A   '
          ALOWLM=0.0
          AUPPLM=CPUMAX
          LOWLTY='>   '
          UPPLTY='<=  '
          IH21='LAMB'
          IH22='DA  '
          ALOWL2=0.0
          AUPPL2=CPUMAX
          LOWLT2='>=  '
          UPPLT2='<=  '
          IH31='K   '
          IH32='    '
          ALOWL3=0.0
          AUPPL3=CPUMAX
          LOWLT3='>   '
          UPPLT3='<=  '
          GOTO4300
        ELSE
          IH='ETA '
          IH2='    '
          ALOWLM=CPUMIN
          AUPPLM=CPUMAX
          LOWLTY='>=  '
          UPPLTY='<=  '
          IH21='ZETA'
          IH22='    '
          ALOWL2=0.0
          AUPPL2=CPUMAX
          LOWLT2='>=  '
          UPPLT2='<=  '
          GOTO4200
        ENDIF
      ELSEIF(ICASPL.EQ.'GIGA')THEN
        IH='LAMB'
        IH2='DA  '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<=  '
        CALL PARCHR(IH,IH2,IDIST,ALAMBA,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        IF(IGIGDF.EQ.'3PAR')THEN
          IH21='CHI '
          IH22='    '
          ALOWL2=0.0
          AUPPL2=CPUMAX
          LOWLT2='>   '
          IF(ALAMBA.GT.0.0)LOWLTY='>=  '
          UPPLTY='<=  '
          CALL PARCHR(IH,IH2,IDIST,CHI,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
          IF(IERROR.EQ.'YES')GOTO9000
          IH31='PSI '
          IH32='    '
          ALOWL3=0.0
          AUPPL3=CPUMAX
          LOWLT3='>   '
          IF(ALAMBA.LT.0.0)LOWLT3='>=  '
          UPPLT3='<=  '
          CALL PARCHR(IH,IH2,IDIST,PSI,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
          IF(IERROR.EQ.'YES')GOTO9000
C
          IF(CHI.EQ.0.0 .AND. PSI.EQ.0.0)THEN
            WRITE(ICOUT,999)
  999       FORMAT(1X)
            CALL DPWRST('XXX','BUG ')
            WRITE(ICOUT,1301)
 1301     FORMAT('***** ERROR-FOR THE GENERALIZED INVERSE GAUSSIAN ',
     1           'PROBABILITY PLOT')
            CALL DPWRST('XXX','BUG ')
            WRITE(ICOUT,1303)
 1303     FORMAT('      THE CHI AND PSI SHAPE PARAMETERS CANNOT BOTH ',
     1           'BE ZERO.')
            CALL DPWRST('XXX','BUG ')
            IERROR='YES'
            GOTO9000
          ENDIF
        ELSE
          IH='OMEG'
          IH2='A   '
          ALOWLM=0.0
          AUPPLM=CPUMAX
          LOWLTY='>=  '
          UPPLTY='<=  '
          GOTO4200
        ENDIF
      ELSEIF(ICASPL.EQ.'GHPP')THEN
        IH='G   '
        IH2='    '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<=  '
        IH21='H   '
        IH22='    '
        ALOWL2=0.0
        AUPPL2=CPUMAX
        LOWLT2='>=  '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(ICASPL.EQ.'GPP')THEN
        IH='G   '
        IH2='    '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<=  '
        GOTO4100
      ELSEIF(ICASPL.EQ.'HPP')THEN
        IH='H   '
        IH2='    '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<=  '
        GOTO4100
      ELSEIF(ICASPL.EQ.'LSNO')THEN
        IH='LAMB'
        IH2='DA  '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<=  '
        IH21='SD  '
        IH22='    '
        ALOWL2=0.0
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(ICASPL.EQ.'LSKT')THEN
        IH='NU  '
        IH2='    '
        ALOWLM=1.0
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<=  '
        IH21='LAMB'
        IH22='DA  '
        ALOWL2=CPUMIN
        AUPPL2=CPUMAX
        LOWLT2='>=  '
        UPPLT2='<=  '
        IH31='SD  '
        IH32='    '
        ALOWL3=0.0
        AUPPL3=CPUMAX
        LOWLT3='>   '
        UPPLT3='<=  '
        GOTO4300
      ELSEIF(ICASPL.EQ.'SDEX')THEN
        IH='LAMB'
        IH2='DA  '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<   '
        GOTO4100
      ELSEIF(ICASPL.EQ.'ADEX')THEN
        IF(IADEDF.EQ.'K')THEN
          IH='K   '
          IH2='    '
          ALOWLM=0.0
          AUPPLM=CPUMAX
          LOWLTY='>   '
          UPPLTY='<   '
          GOTO4100
        ELSE
          IH='MU  '
          IH2='    '
          ALOWLM=0.0
          AUPPLM=CPUMAX
          LOWLTY='>   '
          UPPLTY='<   '
          GOTO4100
        ENDIF
      ELSEIF(ICASPL.EQ.'GALP')THEN
        IF(IADEDF.EQ.'K')THEN
          IH='K   '
          IH2='    '
          ALOWLM=0.0
          AUPPLM=CPUMAX
          LOWLTY='>   '
          UPPLTY='<   '
          IH21='TAU '
          IH22='    '
          ALOWL2=0.0
          AUPPL2=CPUMAX
          LOWLT2='>   '
          UPPLT2='<   '
          GOTO4200
        ELSE
          IH='MU  '
          IH2='    '
          ALOWLM=0.0
          AUPPLM=CPUMAX
          LOWLTY='>   '
          UPPLTY='<   '
          IH21='TAU '
          IH22='    '
          ALOWL2=0.0
          AUPPL2=CPUMAX
          LOWLT2='>   '
          UPPLT2='<   '
          GOTO4200
        ENDIF
      ELSEIF(ICASPL.EQ.'MCLE')THEN
        IH='ALPH'
        IH2='A   '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        GOTO4100
      ELSEIF(ICASPL.EQ.'GMCL')THEN
        IH='ALPH'
        IH2='A   '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='A   '
        IH22='    '
        ALOWL2=-1.0
        AUPPL2=1.0
        LOWLT2='>   '
        UPPLT2='<   '
        GOTO4200
      ELSEIF(ICASPL.EQ.'BEIP' .OR. IDIST.EQ.'BEKP')THEN
        IF(IBEIDF.EQ.'1')THEN
          IH='SIGM'
          IH2='A1SQ'
          ALOWLM=0.0
          AUPPLM=CPUMAX
          LOWLTY='>   '
          UPPLTY='<=  '
          IH21='SIGM'
          IH22='A2SQ'
          ALOWL2=0.0
          AUPPL2=CPUMAX
          LOWLT2='>   '
          UPPLT2='<=  '
          IH31='NU  '
          IH32='    '
          ALOWL3=0.0
          AUPPL3=CPUMAX
          LOWLT3='>   '
          UPPLT3='<=  '
          GOTO4300
        ELSE
          IH='B   '
          IH2='    '
          ALOWLM=0.0
          AUPPLM=CPUMAX
          LOWLTY='>   '
          UPPLTY='<=  '
          IH21='C   '
          IH22='    '
          ALOWL2=1.0
          AUPPL2=CPUMAX
          LOWLT2='>   '
          UPPLT2='<=  '
          IH31='M   '
          IH32='    '
          ALOWL3=0.5
          AUPPL3=CPUMAX
          LOWLT3='>   '
          UPPLT3='<=  '
          GOTO4300
        ENDIF
      ELSEIF(ICASPL.EQ.'BTAN')THEN
        IH='LAMB'
        IH2='DA  '
        ALOWLM=0.0
        AUPPLM=1.0
        LOWLTY='>   '
        UPPLTY='<   '
        IH21='K   '
        IH22='    '
        ILOWL2=1
        IUPPL2=I1MACH(9)
        LOWLT2='>=  '
        UPPLT2='<=  '
        GOTO4900
      ELSEIF(ICASPL.EQ.'LPOI')THEN
        IH='LAMB'
        IH2='DA  '
        ALOWLM=0.0
        AUPPLM=1.0
        LOWLTY='>   '
        UPPLTY='<   '
        IH21='THET'
        IH22='A   '
        ALOWL2=0.0
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(ICASPL.EQ.'LBET')THEN
        IH='ALPH'
        IH2='A   '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='BETA'
        IH22='    '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        IH31='C   '
        IH32='    '
        ALOWL3=0.
        AUPPL3=CPUMAX
        LOWLT3='>   '
        UPPLT3='<=  '
        IH41='D   '
        IH42='    '
        ALOWL4=0.
        AUPPL4=CPUMAX
        LOWLT4='>   '
        UPPLT4='<=  '
        GOTO4400
      ELSEIF(ICASPL.EQ.'SLOP')THEN
        IH='ALPH'
        IH2='A   '
        ALOWLM=0.
        AUPPLM=2.0
        LOWLTY='>   '
        UPPLTY='<=  '
        GOTO4100
      ELSEIF(ICASPL.EQ.'OGIV')THEN
        IH='N   '
        IH2='    '
        ALOWLM=0.5
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<   '
        GOTO4100
      ELSEIF(ICASPL.EQ.'TSSL')THEN
        IH='THET'
        IH2='A   '
        ALOWLM=A
        AUPPLM=B
        LOWLTY='>=  '
        UPPLTY='<=  '
        IH21='ALPH'
        IH22='A   '
        ALOWL2=0.
        AUPPL2=2.0
        LOWLT2='>   '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(ICASPL.EQ.'TSOG')THEN
        IH='THET'
        IH2='A   '
        ALOWLM=A
        AUPPLM=B
        LOWLTY='>=  '
        UPPLTY='<=  '
        IH21='N   '
        IH22='    '
        ALOWL2=0.5
        AUPPL2=CPUMAX
        LOWLT2='>=  '
        UPPLT2='<   '
        GOTO4200
      ELSEIF(ICASPL.EQ.'BUR2' .OR. ICASPL.EQ.'BUR7' .OR.
     1       ICASPL.EQ.'BUR8' .OR. ICASPL.EQ.'BU10' .OR.
     1       ICASPL.EQ.'BU11' .OR. ICASPL.EQ.'SEMC')THEN
        IH='R   '
        IH2='    '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        GOTO4100
      ELSEIF(ICASPL.EQ.'BUR3' .OR. ICASPL.EQ.'BUR5' .OR.
     1       ICASPL.EQ.'BUR6')THEN
        IH='R   '
        IH2='    '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='K   '
        IH22='    '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(ICASPL.EQ.'BUR4')THEN
        IH='R   '
        IH2='    '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='C   '
        IH22='    '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(ICASPL.EQ.'BUR9')THEN
        IH='K   '
        IH2='    '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='R   '
        IH22='    '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(ICASPL.EQ.'BU12')THEN
        IH='C   '
        IH2='    '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='K   '
        IH22='    '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(ICASPL.EQ.'DPUN')THEN
        IH='M   '
        IH2='    '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='N   '
        IH22='    '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        IH31='ALPH'
        IH32='A   '
        ALOWL3=0.
        AUPPL3=CPUMAX
        LOWLT3='>   '
        UPPLT3='<=  '
        IH41='BETA'
        IH42='    '
        ALOWL4=0.
        AUPPL4=CPUMAX
        LOWLT4='>   '
        UPPLT4='<=  '
        GOTO4400
      ELSEIF(ICASPL.EQ.'NCCS' .OR. ICASPL.EQ.'NCT')THEN
        IH='NU  '
        IH2='    '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='LAMB'
        IH22='DA  '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>=  '
        UPPLT2='<=  '
        GOTO4200
      ELSEIF(ICASPL.EQ.'EEWE')THEN
        IH='GAMM'
        IH2='A1  '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IH21='SCAL'
        IH22='E1  '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        IH31='GAMM'
        IH32='A2  '
        ALOWL3=0.
        AUPPL3=CPUMAX
        LOWLT3='>   '
        UPPLT3='<=  '
        IH41='SCAL'
        IH42='E2  '
        ALOWL4=0.
        AUPPL4=CPUMAX
        LOWLT4='>   '
        UPPLT4='<=  '
        IF(IEEWLI.EQ.'VARI')THEN
          GOTO4400
        ELSE
          IH51='L   '
          IH52='    '
          ALOWL5=0.
          AUPPL5=CPUMAX
          LOWLT5='>   '
          UPPLT5='<=  '
          GOTO4500
        ENDIF
      ELSEIF(ICASPL.EQ.'UTSP')THEN
        IDIST='UNEVEN TWO-SIDED POWER'
        IH='A   '
        IH2='    '
        IHWUSE='P'
        MESSAG='YES'
        CALL CHECKN(IH,IH2,IHWUSE,
     1  IHNAME,IHNAM2,IUSE,IN,IVALUE,VALUE,NUMNAM,MAXNAM,
     1  ISUBN1,ISUBN2,MESSAG,IANS,IWIDTH,ILOCP,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        A=VALUE(ILOCP)
C
        IH='B   '
        IH2='    '
        IHWUSE='P'
        MESSAG='YES'
        CALL CHECKN(IH,IH2,IHWUSE,
     1  IHNAME,IHNAM2,IUSE,IN,IVALUE,VALUE,NUMNAM,MAXNAM,
     1  ISUBN1,ISUBN2,MESSAG,IANS,IWIDTH,ILOCP,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        B=VALUE(ILOCP)
C
        IH='D   '
        IH2='    '
        IHWUSE='P'
        MESSAG='YES'
        CALL CHECKN(IH,IH2,IHWUSE,
     1  IHNAME,IHNAM2,IUSE,IN,IVALUE,VALUE,NUMNAM,MAXNAM,
     1  ISUBN1,ISUBN2,MESSAG,IANS,IWIDTH,ILOCP,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        DZ=VALUE(ILOCP)
C
        IH='ALPH'
        IH2='A   '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        CALL PARCHR(IH,IH2,IDIST,ALPHA,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
C
        IH='NU1 '
        IH2='    '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        CALL PARCHR(IH,IH2,IDIST,ANU1,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
C
        IH='NU3 '
        IH2='    '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        CALL PARCHR(IH,IH2,IDIST,ANU3,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
C
        IF(A.GE.B .OR. B.GE.DZ)THEN
          WRITE(ICOUT,7332)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,7333)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,7334)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,7336)A,B,DZ
          CALL DPWRST('XXX','BUG ')
          GOTO9000
        ENDIF
 7332   FORMAT(
     1'***** ERROR--FOR THE UNEVEN TWO-SIDED POWER DISTRIBUTION,')
 7333   FORMAT(
     1'      THE THREE SHAPE PARAMETERS (A, B, D) MUST SATISFY')
 7334   FORMAT(
     1'         A < B < D')
 7336   FORMAT(
     1'      A, B, D = ',3G15.7)
C
      ENDIF
C
      GOTO9000
C
C     THE ONE AND TWO SHAPE PARAMETER CASES ARE THE MOST
C     COMMON.  HANDLE THOSE HERE.
C
C     ONE SHAPE PARAMETER CASE
C
 4100 CONTINUE
      CALL PARCHR(IH,IH2,IDIST,
     1            SHAPE1,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1            ISUBN1,ISUBN2,IERROR)
      IF(ICASPL.EQ.'LOGN' .AND. IERROR.EQ.'YES')THEN
        SHAPE1=1.0
      ELSEIF(ICASPL.EQ.'SEMC' .AND. IERROR.EQ.'YES')THEN
        SHAPE2=1.0
      ENDIF
      GOTO9000
C
C     TWO SHAPE PARAMETER CASE
C
 4200 CONTINUE
      CALL PARCHR(IH,IH2,IDIST,
     1            SHAPE1,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1            ISUBN1,ISUBN2,IERROR)
      IF(ICASPL.EQ.'CONS' .AND. ICONDF.EQ.'THET')AUPPL2=1.0/SHAPE1
      IF(ICASPL.EQ.'FNOR' .AND. IERROR.EQ.'YES')THEN
        SHAPE1=0.0
      ELSEIF(ICASPL.EQ.'TNOR' .AND. IERROR.EQ.'YES')THEN
        SHAPE1=0.0
      ELSEIF(ICASPL.EQ.'FCAU' .AND. IERROR.EQ.'YES')THEN
        SHAPE1=0.0
      ENDIF
      CALL PARCHR(IH21,IH22,IDIST,
     1            SHAPE2,ALOWL2,AUPPL2,LOWLT2,UPPLT2,
     1            ISUBN1,ISUBN2,IERROR)
      IF(ICASPL.EQ.'INGA' .AND. IERROR.EQ.'YES')THEN
        SHAPE2=1.0
      ELSEIF(ICASPL.EQ.'PLGN' .AND. IERROR.EQ.'YES')THEN
        SHAPE2=1.0
      ELSEIF(ICASPL.EQ.'PARE' .AND. IERROR.EQ.'YES')THEN
        SHAPE2=1.0
      ELSEIF(ICASPL.EQ.'PAR2' .AND. IERROR.EQ.'YES')THEN
        SHAPE2=1.0
      ELSEIF(ICASPL.EQ.'FNOR' .AND. IERROR.EQ.'YES')THEN
        SHAPE2=1.0
      ELSEIF(ICASPL.EQ.'TNOR' .AND. IERROR.EQ.'YES')THEN
        SHAPE2=1.0
      ELSEIF(ICASPL.EQ.'FCAU' .AND. IERROR.EQ.'YES')THEN
        SHAPE2=1.0
      ELSEIF(ICASPL.EQ.'GGAM' .AND. SHAPE2.EQ.0.0)THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,4221)
 4221   FORMAT('***** ERROR IN EXTPA1--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,4222)
 4222   FORMAT('      THE SPECIFIED SHAPE PARAMETER C FOR THE ',
     1         'GENERALIZED GAMMA')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,4223)
 4223   FORMAT('      DISTRIBUTION CANNOT BE EQUAL TO 0;')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,4225)
 4225   FORMAT('      SUCH WAS NOT THE CASE HERE.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,4226)C
 4226   FORMAT('      THE SPECIFIED VALUE OF C = ',G15.7)
        CALL DPWRST('XXX','BUG ')
        IERROR='YES'
        GOTO9000
      ELSEIF(ICASPL.EQ.'WARI')THEN
        IF(SHAPE1.LE.SHAPE2)THEN
          WRITE(ICOUT,999)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,4231)
 4231     FORMAT('***** ERROR IN WARING DISTRIBUTION--')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,4232)
 4232     FORMAT('      THE VALUE FOR THE SHAPE PARAMETER C IS ',
     1           'LESS THAN OR EQUAL TO')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,4233)
 4233     FORMAT('      THE VALUE FOR THE SHAPE PARAMETER A.')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,4235)SHAPE1
 4235     FORMAT('      THE SPECIFIED VALUE OF C = ',G15.7)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,4236)SHAPE2
 4236     FORMAT('      THE SPECIFIED VALUE OF A = ',G15.7)
          CALL DPWRST('XXX','BUG ')
          IERROR='YES'
          GOTO9000
        ENDIF
      ENDIF
      GOTO9000
C
C     THREE SHAPE PARAMETER CASE
C
 4300 CONTINUE
      CALL PARCHR(IH,IH2,IDIST,
     1            SHAPE1,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1            ISUBN1,ISUBN2,IERROR)
      CALL PARCHR(IH21,IH22,IDIST,
     1            SHAPE2,ALOWL2,AUPPL2,LOWLT2,UPPLT2,
     1            ISUBN1,ISUBN2,IERROR)
      IF(ICASPL.EQ.'TPAR' .AND. IERROR.EQ.'YES')THEN
        SHAPE2=1.0
      ELSEIF(ICASPL.EQ.'TEXP' .AND. IERROR.EQ.'YES')THEN
        SHAPE2=0.0
      ENDIF
      IF(ICASPL.EQ.'TPAR')ALOWL3=SHAPE2
      IF(ICASPL.EQ.'LKAT')ALOWL3=-SHAPE2
      CALL PARCHR(IH31,IH32,IDIST,
     1            SHAPE3,ALOWL3,AUPPL3,LOWLT3,UPPLT3,
     1            ISUBN1,ISUBN2,IERROR)
      IF(ICASPL.EQ.'TEXP' .AND. IERROR.EQ.'YES')THEN
        SHAPE3=1.0
      ENDIF
      GOTO9000
C
C     FOUR SHAPE PARAMETER CASE
C
 4400 CONTINUE
      CALL PARCHR(IH,IH2,IDIST,
     1            SHAPE1,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1            ISUBN1,ISUBN2,IERROR)
      CALL PARCHR(IH21,IH22,IDIST,
     1            SHAPE2,ALOWL2,AUPPL2,LOWLT2,UPPLT2,
     1            ISUBN1,ISUBN2,IERROR)
      CALL PARCHR(IH31,IH32,IDIST,
     1            SHAPE3,ALOWL3,AUPPL3,LOWLT3,UPPLT3,
     1            ISUBN1,ISUBN2,IERROR)
      CALL PARCHR(IH41,IH42,IDIST,
     1            SHAPE4,ALOWL4,AUPPL4,LOWLT4,UPPLT4,
     1            ISUBN1,ISUBN2,IERROR)
C
      IF(ICASPL.EQ.'TRAP')THEN
        IF(SHAPE1.GE.SHAPE2 .OR. SHAPE2.GE.SHAPE3 .OR.
     1     SHAPE3.GE.SHAPE4)THEN
          WRITE(ICOUT,4412)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,4413)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,4414)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,4416)SHAPE1,SHAPE2,SHAPE3,SHAPE4
          CALL DPWRST('XXX','BUG ')
          IERROR='YES'
          GOTO9000
        ENDIF
 4412   FORMAT(
     1'***** ERROR--FOR THE TRAPEZOID DISTRIBUTION, THE FOUR')
 4413   FORMAT(
     1'      SHAPE PARAMETERS (A, B, C, D) MUST SATISFY')
 4414   FORMAT(
     1'         A < B < C < D')
 4416   FORMAT(
     1'      A, B, C, D = ',4G15.7)
      ENDIF
C
      GOTO9000
C
C     FIVE SHAPE PARAMETER CASE
C
 4500 CONTINUE
      CALL PARCHR(IH,IH2,IDIST,
     1            SHAPE1,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1            ISUBN1,ISUBN2,IERROR)
      CALL PARCHR(IH21,IH22,IDIST,
     1            SHAPE2,ALOWL2,AUPPL2,LOWLT2,UPPLT2,
     1            ISUBN1,ISUBN2,IERROR)
      CALL PARCHR(IH31,IH32,IDIST,
     1            SHAPE3,ALOWL3,AUPPL3,LOWLT3,UPPLT3,
     1            ISUBN1,ISUBN2,IERROR)
      CALL PARCHR(IH41,IH42,IDIST,
     1            SHAPE4,ALOWL4,AUPPL4,LOWLT4,UPPLT4,
     1            ISUBN1,ISUBN2,IERROR)
      CALL PARCHR(IH51,IH52,IDIST,
     1            SHAPE5,ALOWL5,AUPPL5,LOWLT5,UPPLT5,
     1            ISUBN1,ISUBN2,IERROR)
C
      GOTO9000
C
 4900 CONTINUE
      CALL PARCHR(IH,IH2,IDIST,
     1            SHAPE1,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1            ISUBN1,ISUBN2,IERROR)
      CALL PARCHI(IH21,IH22,IDIST,ISHAPE,ILOWL2,IUPPL2,LOWLT2,UPPLT2,
     1            ISUBN1,ISUBN2,IERROR)
      SHAPE2=REAL(ISHAPE)
      GOTO9000
C
 5100 CONTINUE
      CALL PARCHI(IH,IH2,IDIST,ISHAPE,ILOWLM,IUPPLM,LOWLTY,UPPLTY,
     1            ISUBN1,ISUBN2,IERROR)
      SHAPE1=REAL(ISHAPE)
      GOTO9000
C
 5200 CONTINUE
      CALL PARCHI(IH,IH2,IDIST,ISHAPE,ILOWLM,IUPPLM,LOWLTY,UPPLTY,
     1            ISUBN1,ISUBN2,IERROR)
      SHAPE1=REAL(ISHAPE)
      CALL PARCHI(IH21,IH22,IDIST,ISHAPE,ILOWL2,IUPPL2,LOWLT2,UPPLT2,
     1            ISUBN1,ISUBN2,IERROR)
      SHAPE2=REAL(ISHAPE)
      GOTO9000
C
C6999 CONTINUE
CCCCC CALL PARCHR(IH,IH2,IDIST,
CCCCC1            SHAPE1,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
CCCCC1            ISUBN1,ISUBN2,IERROR)
      GOTO9000
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE EXTPA2(ICASPL,IDIST,A,B,
     1                  SHAP11,SHAP12,SHAP21,SHAP22,
     1                  SHAPE1,SHAPE2,SHAPE3,SHAPE4,SHAPE5,
     1                  IADEDF,IGEPDF,IMAKDF,IBEIDF,
     1                  ILGADF,ISKNDF,IGLDDF,IBGEDF,
     1                  IGETDF,ICONDF,IGOMDF,IKATDF,
     1                  IGIGDF,IGEODF,
     1                  ISUBRO,IBUGG2,IERROR)
C
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORAOTRY
C                 NATIONAL INSTITUTE OF STANDARDS OF TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS OF TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2009/10
C     ORIGINAL VERSION--OCTOBER   2009.
C     UPDATED         --AUGUST    2010. BRITTLE FIBER WEIBULL
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*30 IDIST
C
      CHARACTER*4 IADEDF
      CHARACTER*4 IGEPDF
      CHARACTER*4 IMAKDF
      CHARACTER*4 IBEIDF
      CHARACTER*4 ILGADF
      CHARACTER*4 ISKNDF
      CHARACTER*4 IGLDDF
      CHARACTER*4 IBGEDF
      CHARACTER*4 IGETDF
      CHARACTER*4 ICONDF
      CHARACTER*4 IGOMDF
      CHARACTER*4 IKATDF
      CHARACTER*4 IGIGDF
      CHARACTER*4 IGEODF
C
      CHARACTER*4 ICASPL
      CHARACTER*4 IBUGG2
      CHARACTER*4 ISUBRO
      CHARACTER*4 IERROR
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
      CHARACTER*4 ISTEPN
C
      CHARACTER*4 IHP11
      CHARACTER*4 IHP12
      CHARACTER*4 IHP21
      CHARACTER*4 IHP22
      CHARACTER*4 IHP31
      CHARACTER*4 IHP32
      CHARACTER*4 IHP41
      CHARACTER*4 IHP42
      CHARACTER*4 LOWLTY
      CHARACTER*4 UPPLTY
      CHARACTER*4 LOWLT2
      CHARACTER*4 UPPLT2
      CHARACTER*4 LOWLT4
      CHARACTER*4 UPPLT4
C
      INCLUDE 'DPCOMC.INC'
      INCLUDE 'DPCOPA.INC'
      INCLUDE 'DPCOHK.INC'
C
C---------------------------------------------------------------------
C
C-----COMMON VARIABLES (GENERAL)--------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C               ***********************************************
C               **  STEP 1--                                 **
C               **  FOR THOSE DISTRIBUTIONS REQUIRING THEM,  **
C               **  DETERMINE IF THE ANALYST                 **
C               **  HAS SPECIFIED PARAMETER VALUES           **
C               ***********************************************
C
      ISUBN1='EXTP'
      ISUBN2='A2  '
C
      IF(IBUGG2.EQ.'ON'.OR.ISUBRO.EQ.'TPA2')THEN
        ISTEPN='1'
        CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
        WRITE(ICOUT,55)IDIST
   55   FORMAT('AT BEGINNING OF EXTPA2: IDIST = ',A30)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,56)SHAPE1,SHAPE2,SHAPE3,SHAPE4,SHAPE5
   56   FORMAT('SHAPE1,SHAPE2,SHAPE3,SHAPE4,SHAPE5 = ',5G15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,57)ISKNDF,IBEIDF,IBGEDF,IGEODF,IGEPDF
   57   FORMAT('ISKNDF,IBEIDF,IBGEDF,IGEODF,IGEPDF = ',4(A4,2X),A4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,58)IGIGDF,IGLDDF,IKATDF,ILGADF
   58   FORMAT('IGIGDF,IGLDDF,IKATDF,ILGADF = ',3(A4,2X),A4)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
C     DISTRIBUTIONS WITH SINGLE SHAPE PARAMETER GAMMA
C
      IF(ICASPL.EQ.'WEIB' .OR. ICASPL.EQ.'IWEI' .OR.
     1   ICASPL.EQ.'3WEI' .OR. ICASPL.EQ.'3IWE' .OR.
     1   ICASPL.EQ.'GAMM' .OR. ICASPL.EQ.'IGAM' .OR.
     1   ICASPL.EQ.'3GAM' .OR. ICASPL.EQ.'3IGA' .OR.
     1   ICASPL.EQ.'LGAM' .OR. ICASPL.EQ.'GPAR' .OR.
     1   ICASPL.EQ.'GEEX' .OR. ICASPL.EQ.'FATL' .OR.
     1   ICASPL.EQ.'WALD' .OR. ICASPL.EQ.'EV2 ' .OR.
     1   ICASPL.EQ.'3EV2' .OR. 
     1   ICASPL.EQ.'DWEI' .OR. ICASPL.EQ.'GEV ' .OR.
     1   ICASPL.EQ.'GHLO' .OR. ICASPL.EQ.'DGAM' .OR.
     1   ICASPL.EQ.'PEA3' .OR. ICASPL.EQ.'BFWE' .OR.
     1   ICASPL.EQ.'PARE' .OR. ICASPL.EQ.'PAR2'
     1 )THEN
C
        IHP11='GAMM'
        IHP12='A1  '
        IHP21='GAMM'
        IHP22='A2  '
        LOWLTY='>   '
        UPPLTY='<=  '
        ALOWLM=0.
        AUPPLM=CPUMAX
        ADEF1=1.0
        ADEF2=50.0
C
        IF(ICASPL.EQ.'WEIB')THEN
          IDIST='WEIBULL'
        ELSEIF(ICASPL.EQ.'3WEI')THEN
          IDIST='3-PARAMETER WEIBULL'
        ELSEIF(ICASPL.EQ.'GAMM')THEN
          IDIST='GAMMA'
          ADEF1=0.5
          ADEF2=25.0
        ELSEIF(ICASPL.EQ.'3GAM')THEN
          IDIST='3-PARAMETER GAMMA'
          ADEF1=0.5
          ADEF2=25.0
        ELSEIF(ICASPL.EQ.'IGAM')THEN
          IDIST='INVERTED GAMMA'
          ADEF1=0.5
          ADEF2=25.0
        ELSEIF(ICASPL.EQ.'3IGA')THEN
          IDIST='3-PARAMETER INVERTED GAMMA'
          ADEF1=0.5
          ADEF2=25.0
        ELSEIF(ICASPL.EQ.'LGAM')THEN
          IDIST='LOG GAMMA'
          ADEF1=0.5
          ADEF2=25.0
        ELSEIF(ICASPL.EQ.'IWEI')THEN
          IDIST='INVERTED WEIBULL'
          ADEF1=0.5
          ADEF2=10.0
        ELSEIF(ICASPL.EQ.'3IWE')THEN
          IDIST='3-PARAMETER INVERTED WEIBULL'
          ADEF1=0.5
          ADEF2=10.0
        ELSEIF(ICASPL.EQ.'GPAR')THEN
          IDIST='GENERALIZED PARETO'
          ALOWLM=CPUMIN
          ADEF1=-3.0
          ADEF2=3.0
        ELSEIF(ICASPL.EQ.'GEEX')THEN
          IDIST='GEOMETRIC EXTREME EXPONENTIAL'
          ADEF1=0.1
          ADEF2=10.0
        ELSEIF(ICASPL.EQ.'FATL')THEN
          IDIST='FATIGUE LIFE'
        ELSEIF(ICASPL.EQ.'WALD')THEN
          IDIST='WALD'
          ADEF1=0.5
          ADEF2=25.0
        ELSEIF(ICASPL.EQ.'EV2 ')THEN
          IDIST='FRECHET'
          ADEF1=-25.0
          ADEF2=25.0
        ELSEIF(ICASPL.EQ.'3EV2')THEN
          IDIST='3-PARAMETER FRECHET'
          ADEF1=0.1
          ADEF2=25.0
        ELSEIF(ICASPL.EQ.'PARE' .OR. ICASPL.EQ.'PAR2')THEN
          ADEF1=0.2
          ADEF2=5.0
          IDIST='PARETO'
          IF(ICASPL.EQ.'PAR2')IDIST='PARETO SECOND KIND'
C
C         FOR PARETO, SET VALUE FOR A
C
          IHP31='A   '
          IHP32='    '
          ALOWLM=0.0
          AUPPLM=CPUMAX
          LOWLTY='>   '
          UPPLTY='<=  '
          ADEF3=1.0
          CALL PARCH2(IHP31,IHP32,IDIST,SHAPE2,ADEF3,ALOWLM,AUPPLM,
     1              LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
          IF(SHAPE2.LE.0.0)SHAPE2=1.0
C
        ELSEIF(ICASPL.EQ.'BFWE')THEN
          IDIST='BRITTLE FIBER WEIBULL'
C
C         FOR BRITTLE FIBER WEIBULL, SET VALUE FOR L
C
          IHP31='L   '
          IHP32='    '
          ALOWLM=0.0
          AUPPLM=CPUMAX
          LOWLTY='>   '
          UPPLTY='<=  '
          ADEF3=1.0
          CALL PARCH2(IHP31,IHP32,IDIST,SHAPE2,ADEF3,ALOWLM,AUPPLM,
     1              LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
          IF(SHAPE2.LE.0.0)SHAPE2=ADEF3
        ELSEIF(ICASPL.EQ.'DWEI')THEN
          IDIST='DOUBLE WEIBULL'
          ADEF1=0.5
          ADEF2=10.0
        ELSEIF(ICASPL.EQ.'DGAM')THEN
          IDIST='DOUBLE GAMMA'
          ADEF1=0.5
          ADEF2=10.0
        ELSEIF(ICASPL.EQ.'GEV ')THEN
          IDIST='GENERALIZED EXTREME VALUE'
          ALOWLM=CPUMIN
          ADEF1=-5.0
          ADEF2=5.0
        ELSEIF(ICASPL.EQ.'GHLO')THEN
          IDIST='GENERALIZED HALF LOGISTIC'
          AUPPLM=5.0
          ADEF1=0.1
          ADEF2=2.5
        ELSEIF(ICASPL.EQ.'PEA3')THEN
          IDIST='PEARSON TYPE 3'
          ALOWLM=CPUMIN
          AUPPLM=CPUMAX
          ADEF1=-10.0
          ADEF2=10.0
        ENDIF
        GOTO4100
C
C     DISTRIBUTIONS WITH SINGLE SHAPE PARAMETER SIGMA
C
      ELSEIF(ICASPL.EQ.'LOGN' .OR. ICASPL.EQ.'3LGN')THEN
        IDIST='LOGNORMAL'
        IHP11='SIGM'
        IHP12='A1  '
        IHP21='SIGM'
        IHP22='A2  '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        ADEF1=0.5
        ADEF2=25.0
        GOTO4100
C
C     DISTRIBUTIONS WITH SINGLE SHAPE PARAMETER LAMBDA
C
      ELSEIF(ICASPL.EQ.'TULA' .OR. ICASPL.EQ.'SDEX' .OR.
     1       ICASPL.EQ.'SNOR' .OR. ICASPL.EQ.'POIS' .OR.
     1       ICASPL.EQ.'BTAN')THEN
C
        IHP11='LAMB'
        IHP12='DA1 '
        IHP21='LAMB'
        IHP22='DA2 '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<=  '
        IF(ICASPL.EQ.'TULA')THEN
          IDIST='TUKEY-LAMBDA'
          ADEF1=-2.0
          ADEF2=2.0
        ELSEIF(ICASPL.EQ.'SDEX')THEN
          IDIST='SKEW DOUBLE EXPONENTIAL'
          ADEF1=0.0
          ADEF2=10.0
        ELSEIF(ICASPL.EQ.'SNOR')THEN
          IDIST='SKEW NORMAL'
          ADEF1=-5.0
          ADEF2=5.0
        ELSEIF(ICASPL.EQ.'POIS')THEN
          IDIST='POISSON'
          ADEF1=1.0
          ADEF2=50.0
        ELSEIF(ICASPL.EQ.'BTAN')THEN
          IDIST='BOREL-TANNER'
          IHP21='K   '
          IHP22='    '
          ILOWL2=1
          IUPPL2=I1MACH(9)
          LOWLT2='>=  '
          UPPLT2='<=  '
          CALL PARCHI(IHP21,IHP22,IDIST,K,ILOWL2,IUPPL2,
     1                LOWLT2,UPPLT2,
     1                ISUBN1,ISUBN2,IERROR)
          IF(IERROR.EQ.'YES')GOTO9000
          SHAPE2=REAL(K)
          ALOWLM=0.0
          AUPPLM=1.0
          LOWLTY='>   '
          UPPLTY='<   '
          ADEF1=0.2
          ADEF2=0.95
        ENDIF
        GOTO4100
C
C     DISTRIBUTIONS WITH SINGLE SHAPE PARAMETER NU
C
      ELSEIF(ICASPL.EQ.'TPP' .OR. ICASPL.EQ.'CHIS' .OR.
     1       ICASPL.EQ.'CHI ' .OR. ICASPL.EQ.'FT  ')THEN
C
        IHP11='NU1 '
        IHP12='    '
        IHP21='NU2 '
        IHP22='    '
        ALOWLM=1.
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<=  '
        ADEF1=1.0
        ADEF2=50.0
        IF(ICASPL.EQ.'TPP')IDIST='T'
        IF(ICASPL.EQ.'CHIS')IDIST='CHI-SQUARE'
        IF(ICASPL.EQ.'CHI ')IDIST='CHI'
        IF(ICASPL.EQ.'FT  ')IDIST='FOLDED T'
        GOTO4100
C
C     DISTRIBUTIONS WITH SINGLE SHAPE PARAMETER BETA
C
      ELSEIF(ICASPL.EQ.'BRAD' .OR. ICASPL.EQ.'TOPL' .OR.
     1       ICASPL.EQ.'PEXP' .OR. ICASPL.EQ.'MUTH' .OR.
     1       ICASPL.EQ.'LEXP')THEN
        IHP11='BETA'
        IHP12='1   '
        IHP21='BETA'
        IHP22='2   '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        ADEF1=0.1
        ADEF2=10.0
        IF(ICASPL.EQ.'BRAD')THEN
          IDIST='BRADFORD'
          ADEF1=0.5
          ADEF2=25.0
        ELSEIF(ICASPL.EQ.'TOPL')THEN
          IDIST='TOPP AND LEONE'
        ELSEIF(ICASPL.EQ.'PEXP')THEN
          IDIST='EXPONENTIAL POWER'
          ADEF1=0.5
          ADEF2=10.0
        ELSEIF(ICASPL.EQ.'MUTH')THEN
          IDIST='MUTH'
          ADEF1=0.0
          ADEF2=1.0
          AUPPLM=1.0
          LOWLTY='>=  '
        ELSEIF(ICASPL.EQ.'LEXP')THEN
          IDIST='LOGISTIC-EXPONENTIAL'
        ENDIF
        GOTO4100
C
C     DISTRIBUTIONS WITH SINGLE SHAPE PARAMETER B
C
      ELSEIF(ICASPL.EQ.'RECI' .OR. ICASPL.EQ.'VONM')THEN
        IHP11='B1  '
        IHP12='    '
        IHP21='B2  '
        IHP22='    '
        ALOWLM=1.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        ADEF1=1.5
        ADEF2=20.0
        IF(ICASPL.EQ.'RECI')THEN
          IDIST='RECIPROCAL'
        ELSEIF(ICASPL.EQ.'VONM')THEN
          IDIST='VON MISES'
          ALOWLM=0.0
          LOWLTY='>=  '
          ADEF1=0.5
          ADEF2=25.0
        ENDIF
        GOTO4100
C
C     DISTRIBUTIONS WITH SINGLE SHAPE PARAMETER ALPHA
C
      ELSEIF(ICASPL.EQ.'ERRO' .OR. ICASPL.EQ.'LLAP' .OR.
     1       ICASPL.EQ.'GLOG' .OR. ICASPL.EQ.'G2LO' .OR.
     1       ICASPL.EQ.'G3LO' .OR. ICASPL.EQ.'G5LO' .OR.
     1       ICASPL.EQ.'SLOP' .OR. ICASPL.EQ.'ALPH' .OR.
     1       ICASPL.EQ.'MCLE' .OR. ICASPL.EQ.'LDEX' .OR.
     1       ICASPL.EQ.'ZETA' .OR. ICASPL.EQ.'ZIPF')THEN
        IHP11='ALPH'
        IHP12='A1  '
        IHP21='ALPH'
        IHP22='A2  '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        ADEF1=0.1
        ADEF2=10.0
        IF(ICASPL.EQ.'ERRO')THEN
          IDIST='ERROR'
          ALOWLM=1.
          ADEF1=1.1
          ADEF2=5.0
        ELSEIF(ICASPL.EQ.'LLAP' .OR. ICASPL.EQ.'LDEX')THEN
          IDIST='LOG LAPLACE'
          ADEF1=0.5
          ADEF2=10.0
        ELSEIF(ICASPL.EQ.'GLOG')THEN
          IDIST='GENERALIZED LOGISTIC'
          ALOWLM=0.1
          ADEF1=0.2
          ADEF2=5.0
        ELSEIF(ICASPL.EQ.'G2LO')THEN
          IDIST='GENERALIZED LOGISTIC TYPE 2'
        ELSEIF(ICASPL.EQ.'G3LO')THEN
          IDIST='GENERALIZED LOGISTIC TYPE 3'
        ELSEIF(ICASPL.EQ.'G5LO')THEN
          IDIST='GENERALIZED LOGISTIC TYPE 5'
          ALOWLM=CPUMIN
          ADEF1=-2.0
          ADEF2=2.0
        ELSEIF(ICASPL.EQ.'SLOP')THEN
          IDIST='SLOPE'
          LOWLTY='>=  '
          AUPPLM=2.0
          ADEF1=0.1
          ADEF2=1.99
        ELSEIF(ICASPL.EQ.'ALPH')THEN
          IDIST='ALPHA'
          ADEF1=0.5
          ADEF2=10.0
        ELSEIF(ICASPL.EQ.'MCLE')THEN
          IDIST='MCLEISH'
          ADEF1=1.0
          ADEF2=15.5
        ELSEIF(ICASPL.EQ.'ZETA')THEN
          IDIST='ZETA'
          ALOWLM=1.0
          AUPPLM=CPUMAX
          ADEF1=1.5
          ADEF2=5.0
        ELSEIF(ICASPL.EQ.'ZIPF')THEN
          IDIST='ZIPF'
          IHP21='N   '
          IHP22='    '
          ILOWL2=1
          IUPPL2=I1MACH(9)
          LOWLT2='>=  '
          UPPLT2='<=  '
          CALL PARCHI(IHP21,IHP22,IDIST,NU,ILOWL2,IUPPL2,LOWLT2,UPPLT2,
     1                ISUBN1,ISUBN2,IERROR)
          SHAPE2=REAL(NU)
          IF(IERROR.EQ.'YES')GOTO9000
        ENDIF
        GOTO4100
C
C     DISTRIBUTIONS WITH SINGLE SHAPE PARAMETER C
C
      ELSEIF(ICASPL.EQ.'TRIA' .OR. ICASPL.EQ.'POWF'.OR.
     1       ICASPL.EQ.'RFPP')THEN
        IHP11='C1  '
        IHP12='    '
        IHP21='C2  '
        IHP22='    '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        ADEF1=0.5
        ADEF2=25.0
        IF(ICASPL.EQ.'TRIA')THEN
          IDIST='TRIANGULAR'
          ALOWLM=CPUMIN
          AUPPLM=CPUMAX
          LOWLTY='>=  '
          UPPLTY='<=  '
          ADEF1=A
          ADEF2=B
        ELSEIF(ICASPL.EQ.'POWF')THEN
          IDIST='POWER'
        ELSEIF(ICASPL.EQ.'RPOW')THEN
          IDIST='REFLECTED POWER'
        ENDIF
        GOTO4100
C
C     DISTRIBUTIONS WITH SINGLE SHAPE PARAMETER P
C
      ELSEIF(ICASPL.EQ.'POWN' .OR. ICASPL.EQ.'WCAU' .OR.
     1       ICASPL.EQ.'GEOM' .OR. ICASPL.EQ.'BINO' .OR.
     1       ICASPL.EQ.'YULE' .OR. ICASPL.EQ.'LOST')THEN
        IHP11='P1  '
        IHP12='    '
        IHP21='P2  '
        IHP22='    '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        IF(ICASPL.EQ.'POWN')THEN
          IDIST='POWER NORMAL'
          ADEF1=1.0
          ADEF2=50.0
        ELSEIF(ICASPL.EQ.'WCAU')THEN
          IDIST='WRAPPED CAUCHY'
          AUPPLM=1.0
          ADEF1=0.0
          ADEF2=0.99
          LOWLTY='>=  '
          UPPLTY='<   '
        ELSEIF(ICASPL.EQ.'GEOM')THEN
          IDIST='GEOMETRIC'
          ALOWLM=0.0
          AUPPLM=1.0
          LOWLTY='>   '
          UPPLTY='<   '
          ADEF1=0.01
          ADEF2=0.99
        ELSEIF(ICASPL.EQ.'YULE')THEN
          IDIST='YULE'
          ALOWLM=0.3
          AUPPLM=CPUMAX
          LOWLTY='>   '
          UPPLTY='<   '
          ADEF1=0.5
          ADEF2=5.0
        ELSEIF(ICASPL.EQ.'BINO')THEN
          IDIST='BINOMIAL'
          ALOWLM=0.0
          AUPPLM=1.0
          LOWLTY='>   '
          UPPLTY='<   '
          ADEF1=0.01
          ADEF2=0.99
          IHP21='N   '
          IHP22='    '
          ILOWLM=1
          IUPPLM=I1MACH(9)
          LOWLT2='>=  '
          UPPLT2='<=  '
          CALL PARCHI(IHP21,IHP22,IDIST,NBINOM,ILOWLM,IUPPLM,
     1                LOWLT2,UPPLT2,
     1                ISUBN1,ISUBN2,IERROR)
          SHAPE2=REAL(NBINOM)
          IF(IERROR.EQ.'YES')GOTO9000
        ELSEIF(ICASPL.EQ.'LOST')THEN
          IDIST='LOST GAMES'
          ALOWLM=0.5
          AUPPLM=1.0
          LOWLTY='>   '
          UPPLTY='<   '
          ADEF1=0.51
          ADEF2=0.95
          IHP21='R   '
          IHP22='    '
          ILOWLM=1
          IUPPLM=I1MACH(9)
          LOWLT2='>=  '
          UPPLT2='<=  '
          CALL PARCHI(IHP21,IHP22,IDIST,IR,ILOWLM,IUPPLM,
     1                LOWLT2,UPPLT2,
     1                ISUBN1,ISUBN2,IERROR)
          SHAPE2=REAL(IR)
          IF(IERROR.EQ.'YES')GOTO9000
        ENDIF
        GOTO4100
C
C     DISTRIBUTIONS WITH SINGLE SHAPE PARAMETER DELTA
C
      ELSEIF(ICASPL.EQ.'LOGL')THEN
        IDIST='LOG-LOGISTIC'
        IHP11='DELT'
        IHP12='A1  '
        IHP21='DELT'
        IHP22='A2  '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        ADEF1=0.2
        ADEF2=25.0
        GOTO4100
C
C     DISTRIBUTIONS WITH SINGLE SHAPE PARAMETER K
C
      ELSEIF(ICASPL.EQ.'ADEX' .AND. IADEDF.EQ.'K')THEN
        IDIST='ASYMMETRIC LAPLACE'
        IHP11='K1  '
        IHP12='    '
        IHP21='K2  '
        IHP22='    '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<   '
        ADEF1=0.2
        ADEF2=10.0
        GOTO4100
C
C     DISTRIBUTIONS WITH SINGLE SHAPE PARAMETER MU
C
      ELSEIF(ICASPL.EQ.'ADEX' .AND. IADEDF.EQ.'MU')THEN
        IHP11='MU1 '
        IHP12='    '
        IHP21='MU2 '
        IHP22='    '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<   '
        ADEF1=-5.0
        ADEF2=5.0
        GOTO4100
C
C     DISTRIBUTIONS WITH SINGLE SHAPE PARAMETER N
C
      ELSEIF(ICASPL.EQ.'OGIV')THEN
        IDIST='OGIVE'
        IHP11='N1  '
        IHP12='    '
        IHP21='N2  '
        IHP22='    '
        ALOWLM=0.5
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        ADEF1=0.51
        ADEF2=10.0
        GOTO4100
C
C     DISTRIBUTIONS WITH SINGLE SHAPE PARAMETER R
C
      ELSEIF(ICASPL.EQ.'BUR2' .OR. ICASPL.EQ.'BUR7' .OR.
     1       ICASPL.EQ.'BUR8' .OR. ICASPL.EQ.'BU10' .OR.
     1       ICASPL.EQ.'BU11')THEN
        IHP11='R1  '
        IHP12='    '
        IHP21='R2  '
        IHP22='    '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        ADEF1=0.5
        ADEF2=10.0
        IDIST='BURR TYPE 2'
        IF(ICASPL.EQ.'BUR7')IDIST='BURR TYPE 7'
        IF(ICASPL.EQ.'BUR8')IDIST='BURR TYPE 8'
        IF(ICASPL.EQ.'BU10')IDIST='BURR TYPE 10'
        IF(ICASPL.EQ.'BU11')IDIST='BURR TYPE 11'
        GOTO4100
C
C     DISTRIBUTIONS WITH SINGLE SHAPE PARAMETER THETA
C
      ELSEIF(ICASPL.EQ.'LOGS')THEN
        IHP11='THET'
        IHP12='A1  '
        IHP21='THET'
        IHP22='A2  '
        ALOWLM=0.
        AUPPLM=1.0
        LOWLTY='>   '
        UPPLTY='<   '
        ADEF1=0.05
        ADEF2=0.95
        IDIST='LOGARITHMIC SERIES'
        GOTO4100
C
C     DISTRIBUTIONS WITH SINGLE SHAPE PARAMETER G
C
      ELSEIF(ICASPL.EQ.'GPP')THEN
        IHP11='G1  '
        IHP12='    '
        IHP21='G2  '
        IHP22='    '
        ALOWLM=-1.0
        AUPPLM=1.0
        LOWLTY='>=  '
        UPPLTY='<=  '
        ADEF1=-1.0
        ADEF2=1.0
        IDIST='G'
        GOTO4100
C
C     DISTRIBUTIONS WITH SINGLE SHAPE PARAMETER H
C
      ELSEIF(ICASPL.EQ.'HPP')THEN
        IHP11='H1  '
        IHP12='    '
        IHP21='H2  '
        IHP22='    '
        ALOWLM=0.0
        AUPPLM=1.0
        LOWLTY='>   '
        UPPLTY='<   '
        ADEF1=0.0
        ADEF2=1.0
        IDIST='H'
        GOTO4100
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS G AND H
C
      ELSEIF(ICASPL.EQ.'GHPP')THEN
        IHP11='G1  '
        IHP12='    '
        IHP21='G2  '
        IHP22='    '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<=  '
        ADEF1=-1.0
        ADEF2=1.0
        IHP31='H1  '
        IHP32='    '
        IHP41='H2  '
        IHP42='    '
        ALOWL2=0.0
        AUPPL2=CPUMAX
        LOWLT2='>=  '
        UPPLT2='<=  '
        ADEF3=0.0
        ADEF4=1.0
        IDIST='G-H'
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS LAMBDA3 AND LAMBDA4
C
      ELSEIF(ICASPL.EQ.'GTLA')THEN
        IHP11='LAMB'
        IHP12='DA31'
        IHP21='LAMB'
        IHP22='DA32'
        IHP31='LAMB'
        IHP32='DA41'
        IHP41='LAMB'
        IHP42='DA42'
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<=  '
        ADEF1=-5.0
        ADEF2=5.0
        ALOWL2=CPUMIN
        AUPPL2=CPUMAX
        LOWLT2='>=  '
        UPPLT2='<=  '
        ADEF3=-5.0
        ADEF4=5.0
        IDIST='GENERALIZED TUKEY-LAMBDA'
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS NU1 AND NU2
C
      ELSEIF(ICASPL.EQ.'FPP')THEN
        IHP11='NU11'
        IHP12='    '
        IHP21='NU12'
        IHP22='    '
        IHP31='NU21'
        IHP32='    '
        IHP41='NU22'
        IHP42='    '
        ALOWLM=1.0
        AUPPLM=REAL(I1MACH(9))
        LOWLTY='>=  '
        UPPLTY='<=  '
        ADEF1=1.0
        ADEF2=25.0
        ALOWL2=1.0
        AUPPL2=REAL(I1MACH(9))
        LOWLT2='>=  '
        UPPLT2='<=  '
        ADEF3=1.0
        ADEF4=25.0
        IDIST='F '
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS GAMMA AND MU
C
      ELSEIF(ICASPL.EQ.'INGA' .OR. ICASPL.EQ.'RIGA')THEN
        IHP11='GAMM'
        IHP12='A1  '
        IHP21='GAMM'
        IHP22='A2  '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        ADEF1=0.5
        ADEF2=25.0
        IHP31='MU1 '
        IHP32='    '
        IHP41='MU2 '
        IHP42='    '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        ADEF3=0.5
        ADEF4=25.0
        IDIST='INVERSE GAUSSIAN'
        IF(ICASPL.EQ.'RIGA')IDIST='RECIPROCAL INVERSE GAUSSIAN'
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS GAMMA AND THETA
C
      ELSEIF(ICASPL.EQ.'EWEI')THEN
        IHP11='GAMM'
        IHP12='A1  '
        IHP21='GAMM'
        IHP22='A2  '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        ADEF1=0.5
        ADEF2=5.0
        IHP31='THET'
        IHP32='A1  '
        IHP41='THET'
        IHP42='A2  '
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        ADEF3=0.5
        ADEF4=5.0
        IDIST='EXPONENTIATED WEIBULL'
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS ALPHA AND BETA
C
      ELSEIF(ICASPL.EQ.'BETA' .OR. ICASPL.EQ.'IBET' .OR.
     1       ICASPL.EQ.'BNOR' .OR. ICASPL.EQ.'KUMA' .OR.
     1       ICASPL.EQ.'KATZ' .OR.
     1       ICASPL.EQ.'RGTL' .OR. ICASPL.EQ.'GTOL' .OR.
     1       ICASPL.EQ.'BBIN' .OR. ICASPL.EQ.'BGEO')THEN
C
        IHP11='ALPH'
        IHP12='A1  '
        IHP21='ALPH'
        IHP22='A2  '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        ADEF1=0.5
        ADEF2=5.0
        IHP31='BETA'
        IHP32='1   '
        IHP41='BETA'
        IHP42='2   '
        ALOWL2=0.0
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        ADEF3=0.5
        ADEF4=5.0
        IDIST='BETA'
        IF(ICASPL.EQ.'IBET')IDIST='INVERTED BETA'
        IF(ICASPL.EQ.'BNOR')IDIST='BETA NORMAL'
        IF(ICASPL.EQ.'KUMA')IDIST='KUMARASWAMY'
        IF(ICASPL.EQ.'RGTL')THEN
          IDIST='REFLECTED GENE TOPP LEONE'
          ALOWLM=0.0
          AUPPLM=2.0
          ADEF1=0.1
          ADEF2=2.0
          ADEF3=0.5
          ADEF4=10.0
        ELSEIF(ICASPL.EQ.'GTOL')THEN
          IDIST='GENERALIZED TOPP LEONE'
          ALOWLM=0.0
          AUPPLM=2.0
          ADEF1=0.1
          ADEF2=2.0
          ADEF3=0.5
          ADEF4=10.0
        ELSEIF(ICASPL.EQ.'KATZ')THEN
          IDIST='KATZ'
          ADEF1=0.1
          ADEF2=10.0
          ALOWL2=CPUMIN
          AUPPL2=1.0
          LOWLT2='>   '
          UPPLT2='<   '
          ADEF3=-3.0
          ADEF4=0.95
        ELSEIF(ICASPL.EQ.'BBIN')THEN
          IDIST='BETA-BINOMIAL'
          IHP31='N   '
          IHP32='    '
          ILOWLM=1
          IUPPLM=I1MACH(9)
          LOWLTY='>=  '
          UPPLTY='<=  '
          CALL PARCHI(IHP31,IHP32,IDIST,NU,ILOWLM,IUPPLM,LOWLTY,UPPLTY,
     1                ISUBN1,ISUBN2,IERROR)
          SHAPE3=REAL(NU)
          IF(IERROR.EQ.'YES')GOTO9000
C
        ELSEIF(ICASPL.EQ.'BGEOM')THEN
          IDIST='BETA-GEOMETRIC'
        ENDIF
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS ALPHA AND C
C
      ELSEIF(ICASPL.EQ.'GGAM')THEN
        IHP11='ALPH'
        IHP12='A1  '
        IHP21='ALPH'
        IHP22='A2  '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        ADEF1=0.5
        ADEF2=5.0
        IHP31='C1  '
        IHP32='    '
        IHP41='C2  '
        IHP42='    '
        ALOWL2=CPUMIN
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        ADEF3=0.1
        ADEF4=3.0
        IDIST='GENERALIZED GAMMA'
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS MU AND SD
C
      ELSEIF(ICASPL.EQ.'FNOR' .OR. ICASPL.EQ.'FCAU' .OR.
     1       ICASPL.EQ.'TNOR')THEN
        IHP11='MU1 '
        IHP12='    '
        IHP21='MU2 '
        IHP22='    '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<=  '
        ADEF1=-25.0
        ADEF2=25.0
        IHP31='SD1 '
        IHP32='    '
        IHP41='SD2 '
        IHP42='    '
        ALOWL2=0.0
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        ADEF3=0.5
        ADEF4=25.0
        IDIST='FOLDED NORMAL'
        IF(ICASPL.EQ.'FCAU')IDIST='FOLDED CAUCHY'
        IF(ICASPL.EQ.'TNOR')IDIST='TRUNCATED NORMAL'
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS THETA AND N
C
      ELSEIF(ICASPL.EQ.'TSPO' .OR. ICASPL.EQ.'TSOG')THEN
        IHP11='THET'
        IHP12='A1  '
        IHP21='THET'
        IHP22='A2  '
        IHP31='N1  '
        IHP32='    '
        IHP41='N2  '
        IHP42='    '
        ALOWLM=A
        AUPPLM=B
        LOWLTY='>=  '
        UPPLTY='<=  '
        ADEF1=ALOWLM
        ADEF2=AUPPLM
        ALOWL2=0.0
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<   '
        ADEF3=0.1
        ADEF4=10.0
        IDIST='TWO-SIDED POWER'
        IF(ICASPL.EQ.'TSOG')THEN
          IDIST='TWO-SIDED OGIVE'
          ALOWL2=0.5
          ADEF3=0.51
        ENDIF
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS P AND SD
C
      ELSEIF(ICASPL.EQ.'PLGN')THEN
        IHP11='P1  '
        IHP12='    '
        IHP21='P2  '
        IHP22='    '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        ADEF1=0.5
        ADEF2=20.0
        IHP31='SD1 '
        IHP32='    '
        IHP41='SD2 '
        IHP42='    '
        ALOWL2=0.0
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        ADEF3=0.5
        ADEF4=25.0
        IDIST='POWER-LOGNORMAL'
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS ALPHA1 AND ALPHA2
C
      ELSEIF(ICASPL.EQ.'JOSU' .OR. ICASPL.EQ.'JOSB')THEN
        IHP11='ALPH'
        IHP12='A11 '
        IHP21='ALPH'
        IHP22='A12 '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<   '
        ADEF1=-1.0
        ADEF2=5.0
        IF(ICASPL.EQ.'JOSB')THEN
          IDIST='JOHNSON SB'
          ADEF1=-3.0
        ELSEIF(ICASPL.EQ.'JOSB')THEN
          IDIST='JOHNSON SU'
        ENDIF
        IHP31='ALPH'
        IHP32='A21 '
        IHP41='ALPH'
        IHP42='A22 '
        ALOWL2=CPUMIN
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<   '
        ADEF3=0.5
        ADEF4=5.0
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS C AND B
C
      ELSEIF(ICASPL.EQ.'GOMP' .AND. IGOMDF.EQ.'DEFA')THEN
        IHP11='C1  '
        IHP12='    '
        IHP21='C2  '
        IHP22='    '
        IHP31='B1  '
        IHP32='    '
        IHP41='B2  '
        IHP42='    '
        ALOWLM=1.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        ADEF1=1.1
        ADEF2=10.0
        ALOWL2=0.0
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        ADEF3=0.1
        ADEF4=5.0
        IDIST='COMPERTZ'
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS ALPHA AND K
C
      ELSEIF(ICASPL.EQ.'GOMP' .AND. IGOMDF.EQ.'JOHN')THEN
        IHP11='ALPH'
        IHP12='A1  '
        IHP21='ALPH'
        IHP22='A2  '
        IHP31='K1  '
        IHP32='    '
        IHP41='K2  '
        IHP42='    '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        ADEF1=0.1
        ADEF2=10.0
        ALOWL2=0.0
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        ADEF3=0.1
        ADEF4=5.0
        IDIST='COMPERTZ'
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS ALPHA AND K
C
      ELSEIF(ICASPL.EQ.'GOMP' .AND. IGOMDF.EQ.'JOHN')THEN
        IHP11='C1  '
        IHP12='    '
        IHP21='C2  '
        IHP22='    '
        IHP31='ALPH'
        IHP32='A1  '
        IHP41='ALPH'
        IHP42='A2  '
        ALOWLM=1.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        ADEF1=1.1
        ADEF2=10.0
        ALOWL2=0.0
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        ADEF3=0.1
        ADEF4=5.0
        IDIST='COMPERTZ'
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS R AND K
C
      ELSEIF(ICASPL.EQ.'BUR3' .OR. ICASPL.EQ.'BUR5' .OR.
     1       ICASPL.EQ.'BUR6' .OR. ICASPL.EQ.'BUR9')THEN
        IHP11='R1  '
        IHP12='    '
        IHP21='R2  '
        IHP22='    '
        IHP31='K1  '
        IHP32='    '
        IHP41='K2  '
        IHP42='    '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        ADEF1=0.5
        ADEF2=10.0
        ALOWL2=0.0
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        ADEF3=0.5
        ADEF4=10.0
        IDIST='BURR TYPE 3'
        IF(ICASPL.EQ.'BUR5')IDIST='BURR TYPE 5'
        IF(ICASPL.EQ.'BUR6')IDIST='BURR TYPE 6'
        IF(ICASPL.EQ.'BUR9')IDIST='BURR TYPE 9'
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS C AND K
C
      ELSEIF(ICASPL.EQ.'BU12')THEN
        IHP11='C1  '
        IHP12='    '
        IHP21='C2  '
        IHP22='    '
        IHP31='K1  '
        IHP32='    '
        IHP41='K2  '
        IHP42='    '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        ADEF1=0.5
        ADEF2=10.0
        ALOWL2=0.0
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        ADEF3=0.5
        ADEF4=10.0
        IDIST='BURR TYPE 12'
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS THETA AND ALPHA
C
      ELSEIF(ICASPL.EQ.'TSSL')THEN
        IHP11='THET'
        IHP12='A1  '
        IHP21='THET'
        IHP22='A2  '
        IHP31='ALPH'
        IHP32='A1  '
        IHP41='ALPH'
        IHP42='A2  '
        ALOWLM=A
        AUPPLM=B
        LOWLTY='>   '
        UPPLTY='<=  '
        ADEF1=ALOWLM
        ADEF2=AUPPLM
        ALOWL2=0.0
        AUPPL2=2.0
        LOWLT2='>=  '
        UPPLT2='<=  '
        ADEF3=0.01
        ADEF4=1.99
        IDIST='TWO-SIDED SLOPE'
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS M AND N
C
      ELSEIF(ICASPL.EQ.'DPUN')THEN
        IHP11='M1  '
        IHP12='    '
        IHP21='M2  '
        IHP22='    '
        IHP31='N1  '
        IHP32='    '
        IHP41='N2  '
        IHP42='    '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        ADEF1=0.5
        ADEF2=10.0
        ALOWL2=0.0
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        ADEF3=0.5
        ADEF4=10.0
        IDIST='DOUBLY PARETO UNIFORM'
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS K AND THETA
C
      ELSEIF(ICASPL.EQ.'MBKA')THEN
        IHP11='K1  '
        IHP12='    '
        IHP21='K2  '
        IHP22='    '
        IHP31='THET'
        IHP32='A1  '
        IHP41='THET'
        IHP42='A2  '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        ADEF1=0.5
        ADEF2=10.0
        ALOWL2=0.0
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        ADEF3=0.5
        ADEF4=10.0
        IDIST='MIELKE BETA-KAPPA'
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS K AND H
C
      ELSEIF(ICASPL.EQ.'KAPP')THEN
        IHP11='K1  '
        IHP12='    '
        IHP21='K2  '
        IHP22='    '
        IHP31='H1  '
        IHP32='    '
        IHP41='H2  '
        IHP42='    '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        ADEF1=-5.0
        ADEF2=5.0
        ALOWL2=CPUMIN
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        ADEF3=-2.0
        ADEF4=5.0
        IDIST='KAPPA'
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS K AND P
C
      ELSEIF(ICASPL.EQ.'NEBI')THEN
        IHP11='K1  '
        IHP12='    '
        IHP21='K2  '
        IHP22='    '
        IHP31='P1  '
        IHP32='    '
        IHP41='P2  '
        IHP42='    '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        ADEF1=1.0
        ADEF2=25.0
        ALOWL2=0.0
        AUPPL2=1.0
        LOWLT2='>   '
        UPPLT2='<   '
        ADEF3=0.05
        ADEF4=0.95
        IDIST='NEGATIVE BINOMIAL'
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS NU AND LAMBDA
C
      ELSEIF(ICASPL.EQ.'NCT ' .OR. ICASPL.EQ.'NCCS')THEN
        IHP11='NU1 '
        IHP12='    '
        IHP21='NU2 '
        IHP22='    '
        IHP31='LAMB'
        IHP32='DA1 '
        IHP41='LAMB'
        IHP42='DA2 '
        ALOWLM=1.0
        AUPPLM=REAL(I1MACH(9))
        LOWLTY='>=  '
        UPPLTY='<=  '
        ADEF1=5.0
        ADEF2=20.0
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>=  '
        UPPLT2='<=  '
        ADEF3=0.0
        ADEF4=10.0
        IF(ICASPL.EQ.'NCT ')THEN
          IDIST='NON-CENTRAL T'
        ELSEIF(ICASPL.EQ.'NCCS')THEN
          IDIST='NON-CENTRAL CHI-SQUARE'
        ELSEIF(ICASPL.EQ.'TSKE')THEN
          IDIST='SKEWED T'
          ADEF1=1.0
          ADEF2=25.0
          ALOWL2=CPUMIN
          ADEF3=-3.0
          ADEF4=3.0
        ENDIF
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS THETA AND BETA
C
      ELSEIF(ICASPL.EQ.'GLOS' .OR.
     1      (ICASPL.EQ.'GEET' .AND. IGETDF.EQ.'THET'))THEN
        IHP11='THET'
        IHP12='A1  '
        IHP21='THET'
        IHP22='A2  '
        IHP31='BETA'
        IHP32='1   '
        IHP41='BETA'
        IHP42='2   '
        ALOWLM=0.
        AUPPLM=1.0
        LOWLTY='>   '
        UPPLTY='<   '
        ADEF1=0.05
        ADEF2=0.95
        ALOWL2=1.0
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<   '
        ADEF3=1.05
        ADEF4=5.0
        IDIST='GENERALIZED LOGARITHMIC SERIES'
        IF(ICASPL.EQ.'GEET' .AND. IGETDF.EQ.'THET')THEN
          IDIST='GEETA'
        ENDIF
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS MU AND BETA
C
      ELSEIF(ICASPL.EQ.'GEET' .AND. IGETDF.EQ.'MU')THEN
        IHP11='MU1 '
        IHP12='    '
        IHP21='MU2 '
        IHP22='    '
        IHP31='BETA'
        IHP32='1   '
        IHP41='BETA'
        IHP42='2   '
        ALOWLM=1.0
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<   '
        ADEF1=1.05
        ADEF2=5.0
        ALOWL2=1.0
        AUPPL2=CPUMAX
        LOWLT2='>=  '
        UPPLT2='<   '
        ADEF3=1.05
        ADEF4=5.0
        IDIST='GEETA'
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS THETA AND M
C
      ELSEIF(ICASPL.EQ.'CONS' .AND. ICONDF.EQ.'THET')THEN
        IHP11='THET'
        IHP12='A1  '
        IHP21='THET'
        IHP22='A2  '
        IHP31='M1  '
        IHP32='    '
        IHP41='M2  '
        IHP42='    '
        ALOWLM=0.
        AUPPLM=1.0
        LOWLTY='>   '
        UPPLTY='<   '
        ADEF1=0.05
        ADEF2=0.95
        ALOWL2=1.0
        AUPPL2=CPUMAX
        LOWLT2='>=  '
        UPPLT2='<   '
        ADEF3=1.05
        ADEF4=5.0
        IDIST='CONSUL (GENERALIZED GEOMETRIC)'
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS MU AND M
C
      ELSEIF(ICASPL.EQ.'CONS' .AND. ICONDF.EQ.'MU')THEN
        IHP11='MU1 '
        IHP12='    '
        IHP21='MU2 '
        IHP22='    '
        IHP31='M1  '
        IHP32='    '
        IHP41='M2  '
        IHP42='    '
        ALOWLM=1.0
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<   '
        ADEF1=1.05
        ADEF2=5.0
        ALOWL2=1.0
        AUPPL2=CPUMAX
        LOWLT2='>=  '
        UPPLT2='<   '
        ADEF3=1.05
        ADEF4=5.0
        IDIST='CONSUL (GENERALIZED GEOMETRIC)'
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS P AND PHI
C
      ELSEIF(ICASPL.EQ.'QBIN')THEN
        IDIST='QUASI BINOMIAL TYPE I'
        IHP31='M   '
        IHP32='    '
        ILOWLM=1
        IUPPLM=I1MACH(9)
        LOWLTY='>=  '
        UPPLTY='<=  '
        CALL PARCHI(IHP31,IHP32,IDIST,IM,ILOWLM,IUPPLM,
     1              LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        SHAPE3=REAL(IM)
C
        IHP11='P1  '
        IHP12='    '
        IHP21='P2  '
        IHP22='    '
        ALOWLM=0.
        AUPPLM=1.0
        LOWLTY='>   '
        UPPLTY='<   '
        ADEF1=0.05
        ADEF2=0.95
C
        CALL PARCH2(IHP11,IHP12,IDIST,SHAP11,ADEF1,ALOWLM,AUPPLM,
     1              LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        CALL PARCH2(IHP21,IHP22,IDIST,SHAP12,ADEF2,ALOWLM,AUPPLM,
     1              LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
C
        IHP31='PHI1'
        IHP32='    '
        IHP41='PHI2'
        IHP42='    '
        ALOWL2=-SHAP11/SHAPE3
        AUPPL2=(1.0-SHAP11)/SHAPE3
        AINC=(AUPPL2-ALOWL2)/50.0
        LOWLT2='>=  '
        UPPLT2='<=  '
        ADEF3=ALOWL2+AINC
        ADEF4=AUPPL2-AINC
        CALL PARCH2(IHP31,IHP32,IDIST,SHAP21,ADEF3,ALOWL2,AUPPL2,
     1              LOWLT2,UPPLT2,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        CALL PARCH2(IHP41,IHP42,IDIST,SHAP22,ADEF4,ALOWL2,AUPPL2,
     1              LOWLT2,UPPLT2,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        GOTO9000
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS C AND A
C
      ELSEIF(ICASPL.EQ.'WARI')THEN
        IHP11='C1  '
        IHP12='    '
        IHP21='C2  '
        IHP22='    '
        IHP31='A1  '
        IHP32='    '
        IHP41='A2  '
        IHP42='    '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<   '
        ADEF1=0.5
        ADEF2=5.0
        ALOWL2=0.0
        AUPPL2=CPUMAX
        LOWLT2='>=  '
        UPPLT2='<   '
        ADEF3=0.5
        ADEF4=5.0
        IDIST='WARING'
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS Q AND BETA
C
      ELSEIF(ICASPL.EQ.'DISW')THEN
        IHP11='Q1  '
        IHP12='    '
        IHP21='Q2  '
        IHP22='    '
        IHP31='BETA'
        IHP32='1   '
        IHP41='BETA'
        IHP42='1   '
        ALOWLM=0.
        AUPPLM=1.0
        LOWLTY='>   '
        UPPLTY='<   '
        ADEF1=0.05
        ADEF2=0.95
        ALOWL2=0.01
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<   '
        ADEF3=0.1
        ADEF4=3.0
        IDIST='DISCRETE WEIBULL'
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS THETA AND P
C
      ELSEIF(ICASPL.EQ.'AEPP')THEN
        IHP11='THET'
        IHP12='A1  '
        IHP21='THET'
        IHP22='A2  '
        IHP31='P1  '
        IHP32='    '
        IHP41='P2  '
        IHP42='    '
        ALOWLM=0.0
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<   '
        ADEF1=1.0
        ADEF2=25.0
        ALOWL2=0.0
        AUPPL2=1.0
        LOWLT2='>   '
        UPPLT2='<   '
        ADEF3=0.05
        ADEF4=0.95
        IDIST='POLYA-AEPPLI'
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS P AND A
C
      ELSEIF(ICASPL.EQ.'GLGP')THEN
        IDIST='GENERALIZED LOST GAMES'
        IHP31='J   '
        IHP32='    '
        ILOWLM=0
        IUPPLM=I1MACH(9)
        LOWLTY='>=  '
        UPPLTY='<=  '
        CALL PARCHI(IHP31,IHP32,IDIST,NU1,ILOWLM,IUPPLM,
     1              LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        SHAPE3=REAL(NU1)
        IF(IERROR.EQ.'YES')GOTO9000
C
        IHP11='P1  '
        IHP12='    '
        IHP21='P2  '
        IHP22='    '
        IHP31='A1  '
        IHP32='    '
        IHP41='A2  '
        IHP42='    '
        ALOWLM=0.5
        AUPPLM=1.0
        LOWLTY='>   '
        UPPLTY='<   '
        ADEF1=0.55
        ADEF2=0.95
        ALOWL2=0.0
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<   '
        ADEF3=0.5
        ADEF4=10.0
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS LAMBDA AND THETA
C
      ELSEIF(ICASPL.EQ.'LPOI')THEN
        IHP11='LAMB'
        IHP12='DA1 '
        IHP21='LAMB'
        IHP22='DA2 '
        IHP31='THET'
        IHP32='A1  '
        IHP41='THET'
        IHP42='A2  '
        ALOWLM=0.0
        AUPPLM=1.0
        LOWLTY='>   '
        UPPLTY='<   '
        ADEF1=0.2
        ADEF2=0.95
        ALOWL2=0.0
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<   '
        ADEF3=0.5
        ADEF4=10.0
        IDIST='LAGRANGE-POISSON'
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS M AND SD
C
      ELSEIF(ICASPL.EQ.'TEXP')THEN
        IDIST='TRUNCATED EXPONENTIAL'
        IHP31='X0  '
        IHP32='    '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        CALL PARCHR(IHP31,IHP32,IDIST,SHAPE3,ALOWLM,AUPPLM,
     1              LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
C
        IHP11='M1  '
        IHP12='    '
        IHP21='M2  '
        IHP22='    '
        IHP31='SD1 '
        IHP32='    '
        IHP41='SD2 '
        IHP42='    '
        ALOWLM=0.
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<=  '
        ADEF1=0.0
        ADEF2=10.0
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        ADEF3=0.1
        ADEF4=10.0
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS PHI AND ALPHA
C
      ELSEIF(ICASPL.EQ.'ARCT')THEN
        IHP11='PHI1'
        IHP12='    '
        IHP21='PHI2'
        IHP22='    '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<=  '
        ADEF1=-50.0
        ADEF2=50.0
        IHP31='ALPH'
        IHP32='A1  '
        IHP41='ALPH'
        IHP42='A2  '
        ALOWL2=0.0
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        ADEF3=0.1
        ADEF4=10.0
        IDIST='ARCTANGENT'
        GOTO4200
C
C       HANDLE TRAPEZOID DISTRIBUTION SEPARATELY.  ASSUME END POINTS
C       A AND D ARE KNOWN AND WANT TO ESTIMATE B AND C.  VALUES FOR
C       B AND C SHOULD BE IN THE INTERVAL DEFINED BY END_POINTS
C
      ELSEIF(ICASPL.EQ.'TRAP')THEN
        IDIST='TRAPEZOID'
        IHP11='A   '
        IHP12='    '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<=  '
        CALL PARCHR(IHP11,IHP12,IDIST,SHAPE1,ALOWLM,AUPPLM,
     1              LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        IHP41='D   '
        IHP42='    '
        ALOWL4=ALOWLM
        AUPPL4=CPUMAX
        LOWLT4='>   '
        UPPLT4='<=  '
        CALL PARCHR(IHP41,IHP42,IDIST,SHAPE4,ALOWL4,AUPPL4,
     1              LOWLT4,UPPLT4,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
C
        IHP11='B1  '
        IHP12='    '
        IHP21='B2  '
        IHP22='    '
        ALOWLM=SHAPE1
        AUPPLM=SHAPE4
        LOWLTY='>   '
        UPPLTY='<   '
        ADEF1=SHAPE1+0.1
        ADEF2=SHAPE4-0.1
        CALL PARCH2(IHP11,IHP12,IDIST,SHAP11,ADEF1,ALOWLM,AUPPLM,
     1              LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        CALL PARCH2(IHP21,IHP22,IDIST,SHAP12,ADEF2,ALOWLM,AUPPLM,
     1              LOWLTY,UPPLTY,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
C
        IHP31='C1  '
        IHP32='    '
        IHP41='C2  '
        IHP42='    '
        ALOWL2=SHAPE1
        AUPPL2=SHAPE4
        LOWLT2='>   '
        UPPLT2='<   '
        ADEF3=SHAPE1+0.1
        ADEF4=SHAPE4-0.1
        CALL PARCH2(IHP31,IHP32,IDIST,SHAP21,ADEF3,ALOWL2,AUPPL2,
     1              LOWLT2,UPPLT2,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
        CALL PARCH2(IHP41,IHP42,IDIST,SHAP22,ADEF4,ALOWL2,AUPPL2,
     1              LOWLT2,UPPLT2,
     1              ISUBN1,ISUBN2,IERROR)
        IF(IERROR.EQ.'YES')GOTO9000
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS ETA AND ZETA
C
      ELSEIF(ICASPL.EQ.'GOMM' .AND. IMAKDF.EQ.'REPA')THEN
        IHP11='ETA1'
        IHP12='    '
        IHP21='ETA2'
        IHP22='    '
        IHP31='ZETA'
        IHP32='1   '
        IHP41='ZETA'
        IHP42='2   '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<=  '
        ADEF1=0.1
        ADEF2=5.0
        ALOWL2=0.
        AUPPL2=CPUMAX
        LOWLT2='>=  '
        UPPLT2='<=  '
        ADEF3=0.1
        ADEF4=5.0
        IDIST='GOMPERTZ-MAKEHAM'
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS LAMBDA AND OMEGA
C
      ELSEIF(ICASPL.EQ.'GIGA')THEN
        IHP11='LAMB'
        IHP12='DA1 '
        IHP21='LAMB'
        IHP22='DA2 '
        IHP31='OMEG'
        IHP32='A1  '
        IHP41='OMEG'
        IHP42='A2  '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<=  '
        ADEF1=-10.0
        ADEF2=10.0
        ALOWL2=0.0
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        ADEF3=0.2
        ADEF4=10.0
        IDIST='GENERALIZED INVERSE GAUSSIAN'
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS LAMBDA AND SD
C
      ELSEIF(ICASPL.EQ.'LSNO')THEN
        IHP11='LAMB'
        IHP12='DA1 '
        IHP21='LAMB'
        IHP22='DA2 '
        IHP31='SD1 '
        IHP32='    '
        IHP41='SD2 '
        IHP42='    '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<   '
        ADEF1=0.0
        ADEF2=5.0
        ALOWL2=0.0
        AUPPL2=CPUMAX
        LOWLT2='>   '
        UPPLT2='<=  '
        ADEF3=0.5
        ADEF4=10.0
        IDIST='LOG-SKEW-NORMAL'
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS K AND TAU
C
      ELSEIF(ICASPL.EQ.'GALP' .AND. IADEDF.EQ.'K')THEN
        IHP11='K1  '
        IHP12='    '
        IHP21='K2  '
        IHP22='    '
        IHP31='TAU1'
        IHP32='    '
        IHP41='TAU2'
        IHP42='    '
        ALOWLM=0.2
        AUPPLM=CPUMAX
        LOWLTY='>=  '
        UPPLTY='<   '
        ADEF1=0.2
        ADEF2=5.0
        ALOWL2=0.2
        AUPPL2=CPUMAX
        LOWLT2='>=  '
        UPPLT2='<   '
        ADEF3=0.2
        ADEF4=5.0
        IDIST='GENE ASYMM DOUBLE EXPONENTIAL'
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS K AND MU
C
      ELSEIF(ICASPL.EQ.'GALP' .AND. IADEDF.EQ.'MU')THEN
        IHP11='MU1 '
        IHP12='    '
        IHP21='MU2 '
        IHP22='    '
        IHP31='TAU1'
        IHP32='    '
        IHP41='TAU2'
        IHP42='    '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<   '
        ADEF1=-5.0
        ADEF2=5.0
        ALOWL2=0.2
        AUPPL2=CPUMAX
        LOWLT2='>=  '
        UPPLT2='<   '
        ADEF3=0.2
        ADEF4=5.0
        IDIST='GENE ASYMM DOUBLE EXPONENTIAL'
        GOTO4200
C
C     DISTRIBUTIONS WITH TWO SHAPE PARAMETERS ALPHA AND A
C
      ELSEIF(ICASPL.EQ.'GMCL')THEN
        IHP11='ALPH'
        IHP12='A1  '
        IHP21='ALPH'
        IHP22='A2  '
        IHP31='A1  '
        IHP32='    '
        IHP41='A2  '
        IHP42='    '
        ALOWLM=CPUMIN
        AUPPLM=CPUMAX
        LOWLTY='>   '
        UPPLTY='<=  '
        ADEF1=0.5
        ADEF2=10.0
        ALOWL2=-1.0
        AUPPL2=1.0
        LOWLT2='>   '
        UPPLT2='<   '
        ADEF3=-0.8
        ADEF4=0.8
        IDIST='GENERALIZED MCLEISH'
        GOTO4200
      ELSE
        IERRFL=1
      ENDIF
C
      GOTO9000
C
C     THE ONE AND TWO SHAPE PARAMETER CASES ARE THE MOST
C     COMMON.  HANDLE THOSE HERE.
C
 4100 CONTINUE
      CALL PARCH2(IHP11,IHP12,IDIST,
     1            SHAP11,ADEF1,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1            ISUBN1,ISUBN2,IERROR)
      CALL PARCH2(IHP21,IHP22,IDIST,
     1            SHAP12,ADEF2,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1            ISUBN1,ISUBN2,IERROR)
      GOTO9000
C
 4200 CONTINUE
      CALL PARCH2(IHP11,IHP12,IDIST,
     1            SHAP11,ADEF1,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1            ISUBN1,ISUBN2,IERROR)
      CALL PARCH2(IHP21,IHP22,IDIST,
     1            SHAP12,ADEF2,ALOWLM,AUPPLM,LOWLTY,UPPLTY,
     1            ISUBN1,ISUBN2,IERROR)
      CALL PARCH2(IHP31,IHP32,IDIST,
     1            SHAP21,ADEF3,ALOWL2,AUPPL2,LOWLT2,UPPLT2,
     1            ISUBN1,ISUBN2,IERROR)
      CALL PARCH2(IHP41,IHP42,IDIST,
     1            SHAP22,ADEF4,ALOWL2,AUPPL2,LOWLT2,UPPLT2,
     1            ISUBN1,ISUBN2,IERROR)
      GOTO9000
C
 9000 CONTINUE
C
      IF(IBUGG2.EQ.'ON'.OR.ISUBRO.EQ.'TPA2')THEN
        WRITE(ICOUT,9011)
 9011   FORMAT('AT END OF EXTPA2:')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9013)IHP11,IHP12,IHP21,IHP22,SHAP11,SHAP12
 9013   FORMAT('IHP11,IHP12,IHP21,IHP22,SHAP11,SHAP12 = ',
     1         2(A4,A4,2X),2G15.7)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9015)IHP31,IHP32,IHP41,IHP42,SHAP21,SHAP22
 9015   FORMAT('IHP31,IHP32,IHP41,IHP42,SHAP21,SHAP22 = ',
     1         2(A4,A4,2X),2G15.7)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
      RETURN
      END
      SUBROUTINE EXTREA(IATEMP,NCHAR,AVALUE,IBUGS2,ISUBRO,IERROR)
C
C     PURPOSE--THIS SUBROUTINE EXTRACTS A REAL VALUE FROM
C              A CHARACTER STRING.  LOOK FOR FIRST AND LAST
C              NON-BLANK CHARACTERS (IF ENTIRE FIELD IS BLANK,
C              RETURN A 0.).  THE INPUT STRING SHOULD CONTAIN ONLY
C              "+", "-", ".", OR A NUMBER.  IF ANY OTHER CHARACTER
C              ENCOUNTERED, THE REST OF THE STRING WILL BE
C              IGNORED.
C
C              NOTE THAT SOME REAL VALUES MAY CONTAIN A UNIT IDENTIFIER.
C              SO ONLY PROCESS THE CHARACTERS FROM THE FIRST NON-BLANK
C              CHARACTER TO THE FIRST SPACE AFTER THE FIRST NON-BLANK
C              CHARACTER.  ASSUME ANYTHING AFTER THIS IS SIMPLY A
C              UNIT SPECIFICATION.
C
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C               HOST DEPENDENT
C     VERSION NUMBER--2014.10
C     ORIGINAL VERSION--OCTOBER    2014.
C     UPDATED         --JANUARY    2016. IF ENTIRE FIELD IS BLANK, THEN
C                                        RETURN CPUMIN RATHER THAN 0
C
C-----NON-COMMON VARIABLES (GRAPHICS)---------------------------------
C
      CHARACTER*(*) IATEMP
      CHARACTER*4   IBUGS2
      CHARACTER*4   ISUBRO
      CHARACTER*4   IERROR
      CHARACTER*10  IFORMT
C
C-----COMMON VARIABLES (GENERAL)--------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      AVALUE=CPUMIN
      NTOT=0
      NLEFT=0
      NRIGHT=0
C
      IF(IBUGS2.EQ.'ON' .OR. ISUBRO.EQ.'TREA')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,51)NUMREC,NCHAR
  51    FORMAT('EXTREA: NUMREC,NCHAR = ',2I8)
        CALL DPWRST('XXX','BUG ')
        IF (NCHAR.GT.0) THEN
            WRITE(ICOUT,53)IATEMP(1:MIN(80,NCHAR))
  53        FORMAT('IATEMP(1:NCHAR) = ',A80)
            CALL DPWRST('XXX','BUG ')
         ENDIF
      ENDIF
C
C     FIND FIRST NON-BLANK CHARACTER
C
      IF (NCHAR.LE.0) GOTO9090
      IF (IATEMP(1:NCHAR).EQ.' ') GOTO9090
      IF (NCHAR.EQ.1) THEN
         IVAL=ICHAR(IATEMP(1:1))
         IF (IVAL.LE.47 .OR. IVAL.GT.127) GOTO9090
      ENDIF
C
      ISTRT=0
      DO 100 I=1,NCHAR
         IF (IATEMP(I:I).EQ.' ')GOTO100
            ISTRT=I
            GOTO109
  100 CONTINUE
      GOTO9090
  109 CONTINUE
C
C     FIND FIRST "BLANK" AFTER FIRST NON-BLANK CHARACTER
C
      ILAST=NCHAR
      DO 110 I=ISTRT,NCHAR
         IF (IATEMP(I:I).EQ.' ')THEN
            ILAST=I-1
            GOTO199
         ENDIF
  110 CONTINUE
  199 CONTINUE
C
C     FIND LAST NON-BLANK CHARACTER
C
C     CHECK FOR "NULL" OR "NAN" TO INDICATE MISSING DATA
C
      IF (ISTRT+3.LE.NCHAR) THEN
         IF (IATEMP(ISTRT:ISTRT+3).EQ.'NULL')THEN
            AVALUE=CPUMIN
            GOTO9090
         ENDIF
      ELSEIF (ISTRT+2.LE.NCHAR) THEN
         IF (IATEMP(ISTRT:ISTRT+2).EQ.'NAN')THEN
            AVALUE=CPUMIN
            GOTO9090
         ENDIF
      ELSEIF (ISTRT+2.LE.NCHAR) THEN
         IF (IATEMP(ISTRT:ISTRT+2).EQ.'NaN')THEN
            AVALUE=CPUMIN
            GOTO9090
         ENDIF
      ELSEIF (ISTRT+2.LE.NCHAR) THEN
         IF (IATEMP(ISTRT:ISTRT+2).EQ.'nan')THEN
            AVALUE=CPUMIN
            GOTO9090
         ENDIF
      ENDIF
C
C     CHECK FOR AN INTEGER VALUE 
C
      IINT=1
      DO 310 I=ISTRT,ILAST
         IF (IATEMP(I:I).EQ.'.') THEN
            IINT=0
            GOTO319
         ENDIF
  310 CONTINUE
  319 CONTINUE
C
      IF (IINT.EQ.1) THEN
         CALL EXTINT(IATEMP,ILAST,IVALUE,IBUGS2,ISUBRO,IERROR)
         AVALUE=REAL(IVALUE)
         GOTO9090
      ENDIF
C
C     CHECK FOR "E" FORMAT.  HANDLE THIS BY EXTRACTING
C     THE REAL NUMBER BEFORE "E" AND THEN EXTRACTING
C     THE POWER AFTER THE "E".
C
      IPOSE=0
      IPOWER=0
      DO 400 I=ISTRT,ILAST
         IF (IATEMP(I:I).EQ.'E' .OR. IATEMP(I:I).EQ.'E')THEN
            ICURR=I+1
            ILAST=I-1
            IPOSE=I
            IF (IATEMP(ICURR:ICURR).EQ.'+') THEN
              READ(IATEMP(I+2:I+3),'(I2)')IPOWER
              GOTO409
            ELSE IF (IATEMP(ICURR:ICURR).EQ.'-') THEN
              READ(IATEMP(I+2:I+3),'(I2)')IPOWER
              IPOWER=-IPOWER
              GOTO409
            ELSE
              READ(IATEMP(I+1:I+2),'(I2)')IPOWER
              GOTO409
            ENDIF
         ENDIF
  400 CONTINUE
  409 CONTINUE
C
C     CONVERT TEXT TO REAL NUMBER
C
C     LOOK FOR "+", "-", ".", OR NUMBER.  FIRST CHARACTER THAT
C     IS NOT ONE OF THESE WILL CAUSE THE REST OF THE FIELD TO
C     BE IGNORED (THIS BASICALLY SHOULD STRIP OFF UNITS).
C     ALSO, "+" AND "-" ONLY VALID IF THE FIRST ELEMENT OF THE
C     FIELD.  ONLY ONE "." WILL BE RECOGNIZED.
C
      IFLAG=0
      DO 300 I=ISTRT,ILAST
         IF (IATEMP(I:I).EQ.' ')THEN
            ILAST=I-1
            GOTO399
         ELSEIF (IATEMP(I:I).EQ.'.')THEN
            IF (IFLAG.EQ.0)THEN
               IFLAG=1
               NTOT=NTOT+1
            ELSE
               ILAST=I-1
               GOTO399
            ENDIF
         ELSEIF (IATEMP(I:I).EQ.'+')THEN
            IF (NTOT.EQ.0)THEN
               AFACT=1.0
               NTOT=NTOT+1
            ELSE
               ILAST=I-1
               GOTO399
            ENDIF
         ELSEIF (IATEMP(I:I).EQ.'-')THEN
            IF (NTOT.EQ.0)THEN
               AFACT=-1.0
               NTOT=NTOT+1
            ELSE
               ILAST=I-1
               GOTO399
            ENDIF
         ELSE
            ITEMP=ICHAR(IATEMP(I:I))
            IF (ITEMP.LT.48 .OR. ITEMP.GT.57)THEN
               ILAST=I-1
               GOTO399
            ELSE
               IF (IFLAG.EQ.0)THEN
                  NTOT=NTOT+1
                  NLEFT=NLEFT+1
               ELSE
                  NTOT=NTOT+1
                  NRIGHT=NRIGHT+1
               ENDIF
            END IF
         END IF
  300 CONTINUE
  399 CONTINUE
      IFORMT='(F  .  )'
      IF (NRIGHT.GT.12)THEN
         NSUBT=NRIGHT-12
         ILAST=ILAST-NSUBT
         NTOT=NTOT-NSUBT
         NRIGHT=NRIGHT
      ENDIF
      WRITE(IFORMT(3:4),'(I2)')NTOT
      WRITE(IFORMT(6:7),'(I2)')NRIGHT
C
      IF(IBUGS2.EQ.'ON' .OR. ISUBRO.EQ.'TREA')THEN
        WRITE(ICOUT,1011)IATEMP(ISTRT:ILAST)
 1011   FORMAT('EXTREA: IATEMP(ISTRT:ILAST) = ',A80)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1013)NTOT,NLEFT,NRIGHT,IFORMT
 1013   FORMAT('NTOT,LEFT,NRIGHT,IFORMT = ',3G15.7,2X,A10)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
      READ(IATEMP(ISTRT:ILAST),IFORMT,ERR=9010)AVALUE
C
C     NOW CHECK FOR EXPONENTIAL POWER
C
      IF (IPOSE.GT.0 .AND. IPOWER.NE.0) THEN
         IF(IPOWER.GT.0)THEN
           AVALUE=AVALUE*10**IPOWER
         ELSEIF(IPOWER.LT.0)THEN
           IPOW2=-IPOWER
           AVALUE=AVALUE/(10**IPOW2)
         ENDIF
      ENDIF
C
      IF(IBUGS2.EQ.'ON' .OR. ISUBRO.EQ.'TREA')THEN
        WRITE(ICOUT,1091)IPOSE,IPOWER,AVALUE
 1091   FORMAT('EXTREA: IPOSE,IPOWER,AVALUE = ',3G15.7)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
      GOTO9090
C
 9010 CONTINUE
      WRITE(ICOUT,9013)
 9013 FORMAT('****** ERROR FROM READ CLIPBOARD (EXTREA)')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9015)
 9015 FORMAT('       UNABLE TO CONVERT STRING TO REAL NUMBER')
      CALL DPWRST('XXX','BUG ')
      IERROR='YES'
      GOTO9090
C
 9090 CONTINUE
      RETURN
      END
      SUBROUTINE EXTSTA(ICOM,ICOM2,IHARG,IHARG2,IARGT,ARG,NUMARG,
     1                  JMIN,JMAX,
     1                  ISTACS,ISTANM,ISTANR,ISTADF,
     1                  IFOUND,ILOCV,ISUBRO,IBUGG3,IERROR)
C
C     PURPOSE--EXTRACT THE NAME OF ONE OF 90+ STATISTICS.  THIS
C              IS A COMMON ROUTINE CALLED BY:
C                1) CKSTAT  = LET A = <STAT>
C                2) DPSP    = <STAT> STATISTIC PLOT
C                3) DPCRPL  = CROSS TABULATE <STAT> PLOT
C                4) DPFLUC  = FLUCTUATION PLOT <STAT>
C                5) DPBLOC  = <STAT> BLOCK PLOT
C                6) DPJBSP  = BOOTSTRAP <STAT> PLOT
C                           = JACKNIFE <STAT> PLOT
C                7) DPDEXP  = DEX <STAT> PLOT
C                8) DPINCU  = <STAT> INFLUENCE CURVE
C                9) DPTABU  = TABULATE <MEAN>
C               10) DPCRTA  = CROSS TABULATE <STAT>
C               11) DPPOTA  = POSITIONAL TABULATION <STAT>
C               12) CKMATH  = MATRIX COLUMN <STAT>
C               13) CKMATH  = MATRIX ROW <STAT>
C               14) CKMATH  = MATRIX GRAND <STAT>
C               15) CKMATH  = MATRIX PARTITION <STAT>
C               16) CKMATH  = LET V = CROSS TABULATE <STAT>
C               17) CKMATH  = LET V = CROSS TABULATE CUMULATIVE <STAT>
C               18) CKMATH  = LET V = SORT BY <STAT>
C               19) CKMATH  = LET V = MOVING <STAT>
C               20) CKMATH  = LET V = CUMULATIVE <STAT>
C               21) DPISP   = <STAT> INTERACTION PLOT
C
C              NOTE THAT THE DEX ... PLOT, ... BLOCK PLOT, AND
C              ... INFLUENCE CURVE, MATRIX <COLUMN/ROW> ONLY SUPPORT
C              STATISTICS COMPUTED FROM A SINGLE RESPONSE VARIABLE.
C              ALSO, SOME COMMANDS MAY NOT SUPPORT ALL STATISTICS IN
C              THIS LIST (OR, LESS FREQUENTLY, A COMMAND MAY SUPPORT
C              SOME ADDITIONAL STATISTICS NOT COMPUTED HERE).
C
C              USING A COMMON ROUTINE MAKES IT EASIER TO ADD
C              A STATISTIC AND INCORPORATE IT INTO ALL THE
C              RELEVANT PLOTS/TABULATIONS.  SHOULD ALSO REDUCE
C              THE LIKELIHOOD OF BUGS, ETC.
C
C              FOLLOWING STATISTICS ARE SUPPORTED:
C
C              CASE 1: ONE RESPONSE VARIABLE
C
C              LOCATION STATISTICS:
C                 BIWEIGHT LOCATION
C                 GEOMETRIC MEAN
C                 H10 LOCATION
C                 H12 LOCATION
C                 H15 LOCATION
C                 H17 LOCATION
C                 H20 LOCATION
C                 HARMONIC MEAN
C                 HODGES-LEHMAN
C                 JSCORE
C                 LP LOCATION
C                 MEAN (OR AVERAGE)
C                 MEDIAN
C                 MIDHINGE
C                 MIDMEAN
C                 MIDRANGE
C                 SHANNON ENTROPY
C                 SHANNON ENTROPY MEAN
C                 SHORTEST HALF MIDMEAN
C                 SHORTEST HALF MIDRANGE
C                 STANDARD DEVIATION OF LP LOCATION
C                 STANDARD DEVIATION OF THE MEAN
C                 TRIMEAN
C                 TRIMMED MEAN
C                 TRIMMED MEAN STANDARD ERROR
C                 VARIANCE OF THE MEAN
C                 VARIANCE OF LP LOCATION
C                 WINSORIZED MEAN
C
C              SCALE STATISTICS:
C                 AVERAGE ABSOLUTE DEVIATION (AAD)
C                 AVERAGE ABSOLUTE DEVIATION FROM THE MEDIAN
C                 BIWEIGHT MIDVARIANCE
C                 BIWEIGHT SCALE
C                 COEFFICIENT OF DISPERSION
C                 COEFFICIENT OF VARIATION
C                 GEOMETRIC STANDARD DEVIATION
C                 GINI MEAN DIFFERENCE
C                 H10 SCALE
C                 H12 SCALE
C                 H15 SCALE
C                 H17 SCALE
C                 H20 SCALE
C                 INDEX OF DISPERSION
C                 INTERQUARTILE RANGE
C                 LOGNORMAL COEFFICIENT OF VARIATION
C                 LOWER SEMI-INTERQUARTILE RANGE
C                 MAD TO MEDIAN
C                 MEDIAN ABSOLUTE DEVIATION (MAD)
C                 PERCENTAGE BEND MIDVARIANCE
C                 PRECISION
C                 QN
C                 Q QUANTILE RANGE
C                 QUARTILE COEFFICIENT OF DISPERSION
C                 RANGE
C                 RELATIVE LABORATORY PERFORMANCE (RLP)
C                 RELATIVE SD
C                 RELATIVE VARIANCE
C                 RESCALED SUM
C                 ROBUST POOLED RANGE
C                 ROBUST POOLED STANDARD DEVIATION
C                 ROOT MEAN SQUARE ERROR (OR RMS)
C                 SCALED MEDIAN ABSOLUTE DEVIATION (MADe)
C                 SHANNON ENTROPY STANDARD DEVIATION
C                 SHANNON ENTROPY VARIANCE
C                 SIGNAL TO NOISE RATIO
C                 SN
C                 STANDARD DEVIATION (OR SD)
C                 SUM OF SQUARES
C                 SUM OF SQUARES FROM MEAN
C                 TRIMMED SD
C                 UNBIASED COEFFICIENT OF VARIATION
C                 UPPER SEMI-INTERQUARTILE RANGE
C                 VARIANCE
C                 WINSORIZED STANDARD DEVIATION
C                 WINSORIZED VARIANCE
C
C              PERCENTILE STATISTICS
C                 FIRST/SECOND/THIRD/FOURTH/FIFTH/SIXTH/SEVENTH/
C                       EIGHTH/NINTH DECILE
C                 DECILE RATIO
C                 EXTREME
C                 INDEX MINIMUM
C                 INDEX MAXIMUM
C                 INDEX EXTREME
C                 LOWER HINGE
C                 LOWER QUARTILE
C                 MINIMUM (MIN)
C                 MAXIMUM (MAX)
C                 <VALUE> PERCENTILE
C                 QUANTILE STANDARD ERROR
C                 UPPER HINGE
C                 UPPER QUARTILE
C
C              HIGHER MOMENTS
C                 GALTON SKEWNESS
C                 KURTOSIS
C                 PEARSON TWO SKEWNESS
C                 SKEWNESS
C
C              TIME SERIES STATISTICS
C                 AUTOCORRELATION
C                 AUTOCOVARIANCE
C                 SINE FREQUENCY
C                 SINE AMPLITUDE
C
C              QUALITY CONTROL STATISTICS
C                 CC
C                 CNP
C                 CNPK
C                 CNPM
C                 CNPMK
C                 CP
C                 CPK
C                 CPL
C                 CPM
C                 CPMK
C                 CPU
C                 EXPECTED LOSS
C                 (ACTUAL) PERCENT DEFECTIVE
C                 (THEORETICAL) PERCENT DEFECTIVE
C                 TAGUCHI SIGNAL-TO-NOISE (SN+, SN-, SN0, SN00)
C
C              STATISTICAL TESTS:
C                 A BASIS NORMAL
C                 A BASIS LOGNORMAL
C                 A BASIS WEIBULL
C                 A BASIS NONPARAMETRIC
C                 B BASIS NORMAL
C                 B BASIS LOGNORMAL
C                 B BASIS WEIBULL
C                 B BASIS NONPARAMETRIC
C                 ADJANCENCY RANDOMNESS TEST
C                 ADJANCENCY RANDOMNESS TEST CDF
C                 ADJANCENCY RANDOMNESS TEST PVALUE
C                 BINOMIAL PROPORTIONS
C                 BINOMIAL PROPORTIONS LOWER CONFIDENCE LIMIT
C                 BINOMIAL PROPORTIONS UPPER CONFIDENCE LIMIT
C                 CHI-SQUARE SD TEST
C                 CHI-SQUARE SD TEST CDF
C                 CHI-SQUARE SD TEST PVALUE
C                 CHI-SQUARE SD TEST LOWER TAIL PVALUE
C                 CHI-SQUARE SD TEST UPPER TAIL PVALUE
C                 CUMULATIVE SUM FORWARD TEST
C                 CUMULATIVE SUM FORWARD TEST PVALUE
C                 CUMULATIVE SUM BACKWARD TEST
C                 CUMULATIVE SUM BACKWARD TEST PVALUE
C                 DAVID
C                 DAVID CDF
C                 DAVID CRITICAL VALUE
C                 DAVID MINIMUM INDEX
C                 DAVID MAXIMUM INDEX
C                 DAVID PVALUE
C                 DIXON TEST
C                 DIXON MINIMUM TEST
C                 DIXON MAXIMUM TEST
C                 EXTREME STUDENTIZED DEVIATE
C                 FREQUENCY TEST
C                 FREQUENCY TEST CDF
C                 FREQUENCY WITHIN A BLOCK TEST
C                 FREQUENCY WITHIN A BLOCK TEST CDF
C                 GRUBB
C                 GRUBB CDF
C                 GRUBB DIRECTION
C                 GRUBB INDEX
C                 JARQUE BERA
C                 JARQUE BERA PVALUE
C                 JARQUE BERA CDF
C                 KURTOSIS OUTLIER
C                 KURTOSIS OUTLIER CDF
C                 KURTOSIS OUTLIER CRITICAL VALUE
C                 KURTOSIS OUTLIER INDEX
C                 KURTOSIS OUTLIER PVALUE
C                 LOWER COEFFICIENT OF DISPERSION CONFIDENCE LIMIT
C                 LOWER COEFFICIENT OF QUARTILE DISPERSION CONFIDENCE LIMIT
C                 LOWER COEFFICIENT OF VARIATION CONFIDENCE LIMIT
C                 LOWER CONFIDENCE LIMIT
C                 LOWER LOGNORMAL COEFFICIENT OF VARIATION CONFIDENCE LIMIT
C                 LOWER BONETT STANDARD DEVIATION CONFIDENCE LIMIT
C                 LOWER PREDICTION BOUND
C                 LOWER PREDICTION LIMIT
C                 LOWER STANDARD DEVIATION CONFIDENCE LIMIT
C                 LOWER STANDARD DEVIATION PREDICTION LIMIT
C                 LJUNG BOX TEST
C                 MCCOOL WEIBULL LOCATION TEST
C                 MCCOOL WEIBULL LOCATION TEST PVALUE
C                 MCCOOL WEIBULL LOCATION TEST CDF
C                 MCCOOL WEIBULL LOCATION TEST CV50
C                 MCCOOL WEIBULL LOCATION TEST CV90
C                 MCCOOL WEIBULL LOCATION TEST CV95
C                 MEAN SUCCESSIVE DIFFERENCE
C                 MEAN SUCCESSIVE DIFFERENCE NORMALIZED
C                 MEAN SUCCESSIVE DIFFERENCE CDF
C                 MEAN SUCCESSIVE DIFFERENCE PVALUE
C                 NORMAL TOLERANCE K FACTOR
C                 NORMAL TOLERANCE LOWER LIMIT
C                 NORMAL TOLERANCE UPPER LIMIT
C                 NORMAL TOLERANCE ONE SIDED K FACTOR
C                 NORMAL TOLERANCE ONE SIDED LOWER LIMIT
C                 NORMAL TOLERANCE ONE SIDED UPPER LIMIT
C                 ONE SAMPLE COEFFICIENT OF VARIATION TEST
C                 ONE SAMPLE COEFFICIENT OF VARIATION TEST CDF
C                 ONE SAMPLE COEFFICIENT OF VARIATION TEST PVALUE
C                 ONE SAMPLE COEFFICIENT OF VARIATION LOWER PVALUE
C                 ONE SAMPLE COEFFICIENT OF VARIATION UPPER PVALUE
C                 ONE SAMPLE SIGN TEST
C                 ONE SAMPLE SIGN TEST CDF
C                 ONE SAMPLE SIGN TEST PVALUE
C                 ONE SAMPLE SIGN TEST LOWER TAIL PVALUE
C                 ONE SAMPLE SIGN TEST UPPER TAIL PVALUE
C                 ONE SAMPLE T-TEST
C                 ONE SAMPLE T-TEST CDF
C                 ONE SAMPLE T-TEST PVALUE
C                 ONE SAMPLE T-TEST LOWER TAIL PVALUE
C                 ONE SAMPLE T-TEST UPPER TAIL PVALUE
C                 ONE SAMPLE WILCOXON SIGNED RANK TEST
C                 ONE SAMPLE WILCOXON SIGNED RANK TEST CDF
C                 ONE SAMPLE WILCOXON SIGNED RANK TEST PVALUE
C                 ONE SAMPLE WILCOXON SIGNED RANK TEST LOWER TAIL PVALUE
C                 ONE SAMPLE WILCOXON SIGNED RANK TEST UPPER TAIL PVALUE
C                 ONE-SIDED LOWER AGRESTI-COUL
C                 ONE-SIDED UPPER AGRESTI-COUL
C                 ONE-SIDED LOWER COEFFICIENT OF DISPERSION CONFIDENCE LIMIT
C                 ONE-SIDED LOWER COEFFICIENT OF DISPERSION CONFIDENCE LIMIT
C                 ONE-SIDED UPPER COEFFICIENT OF DISPERSION CONFIDENCE LIMIT
C                 ONE-SIDED LOWER COEFFICIENT OF VARIATION CONFIDENCE LIMIT
C                 ONE-SIDED UPPER COEFFICIENT OF VARIATION CONFIDENCE LIMIT
C                 ONE-SIDED LOWER CONFIDENCE LIMIT
C                 ONE-SIDED UPPER CONFIDENCE LIMIT
C                 ONE-SIDED LOWER EXACT BINOMIAL
C                 ONE-SIDED UPPER EXACT BINOMIAL
C                 ONE-SIDED LOWER PREDICTION BOUND
C                 ONE-SIDED LOWER STANDARD DEVIATION CONFIDENCE LIMIT
C                 ONE-SIDED LOWER STANDARD DEVIATION PREDICTION LIMIT
C                 ONE-SIDED UPPER PREDICTION BOUND
C                 ONE-SIDED LOWER PREDICTION LIMIT
C                 ONE-SIDED UPPER PREDICTION LIMIT
C                 ONE-SIDED UPPER STANDARD DEVIATION CONFIDENCE LIMIT
C                 ONE-SIDED UPPER STANDARD DEVIATION PREDICTION LIMIT
C                 POISSON DISPERSION TEST
C                 POISSON DISPERSION TEST CDF
C                 POISSON DISPERSION TEST CDF PVALUE
C                 SKEW OUTLIER
C                 SKEW OUTLIER CDF
C                 SKEW OUTLIER CRITICAL VALUE
C                 SKEW OUTLIER INDEX
C                 SKEW OUTLIER PVALUE
C                 TWO-SIDED LOWER AGRESTI-COUL
C                 TWO-SIDED UPPER AGRESTI-COUL
C                 TWO-SIDED LOWER EXACT BINOMIAL
C                 TWO-SIDED UPPER EXACT BINOMIAL
C                 UPPER COEFFICIENT OF DISPERSION CONFIDENCE LIMIT
C                 UPPER COEFFICIENT OF QUARTILE DISPERSION CONFIDENCE LIMIT
C                 UPPER COEFFICIENT OF VARIATION CONFIDENCE LIMIT
C                 UPPER CONFIDENCE LIMIT
C                 UPPER LOGNORMAL COEFFICIENT OF VARIATION CONFIDENCE LIMIT
C                 UPPER BONETT STANDARD DEVIATION CONFIDENCE LIMIT
C                 UPPER PREDICTION BOUND
C                 UPPER PREDICTION LIMIT
C                 UPPER STANDARD DEVIATION CONFIDENCE LIMIT
C                 UPPER STANDARD DEVIATION PREDICTION LIMIT
C                 WILK SHAPIRO TEST
C                 WILK SHAPIRO TEST PVALUE
C
C              SPATIAL DATA:
C                 RELATIVE DISPERSION INDEX
C                 UNIFORM CHI-SQUARE
C                 VARIATIONAL DISTANCE
C
C              DISTRIBUTION:
C                 BOX COX NORMALITY  PPCC
C                 BOX COX NORMALITY  LAMBDA
C                 KAPPENMAN R
C                 KAPPENMAN R CUTOFF
C
C                 ANGLIT             PPCC
C                 ANGLIT             PPCC LOCATION
C                 ANGLIT             PPCC SCALE
C                 ARCSINE            PPCC
C                 ARCSINE            PPCC LOCATION
C                 ARCSINE            PPCC SCALE
C                 CAUCHY             PPCC
C                 CAUCHY             PPCC LOCATION
C                 CAUCHY             PPCC SCALE
C                 COSINE             PPCC
C                 COSINE             PPCC LOCATION
C                 COSINE             PPCC SCALE
C                 DOUBLE EXPONENTIAL PPCC
C                 DOUBLE EXPONENTIAL PPCC LOCATION
C                 DOUBLE EXPONENTIAL PPCC SCALE
C                 EXPONENTIAL        PPCC
C                 EXPONENTIAL        PPCC LOCATION
C                 EXPONENTIAL        PPCC SCALE
C                 FATIGUE LIFE       PPCC LOCATION
C                 FATIGUE LIFE       PPCC SCALE
C                 FATIGUE LIFE       PPCC SHAPE
C                 FATIGUE LIFE       PPCC STATISITC
C                 GAMMA              PPCC LOCATION
C                 GAMMA              PPCC SCALE
C                 GAMMA              PPCC SHAPE
C                 GAMMA              PPCC STATISTIC
C                 GENERALIZED PARETO PPCC LOCATION
C                 GENERALIZED PARETO PPCC SCALE
C                 GENERALIZED PARETO PPCC SHAPE
C                 GENERALIZED PARETO PPCC STATISITC
C                 GH                 PPCC LOCATION
C                 GH                 PPCC SCALE
C                 GH                 PPCC SHAPE ONE
C                 GH                 PPCC SHAPE TWO
C                 GH                 PPCC STATISTIC
C                 HALF-NORMAL        PPCC
C                 HALF-NORMAL        PPCC LOCATION
C                 HALF-NORMAL        PPCC SCALE
C                 HALF-CAUCHY        PPCC
C                 HALF-CAUCHY        PPCC LOCATION
C                 HALF-CAUCHY        PPCC SCALE
C                 HYPERBOLIC SECANT  PPCC
C                 HYPERBOLIC SECANT  PPCC LOCATION
C                 HYPERBOLIC SECANT  PPCC SCALE
C                 INVERTED WEIBULL   PPCC LOCATION
C                 INVERTED WEIBULL   PPCC SCALE
C                 INVERTED WEIBULL   PPCC SHAPE
C                 INVERTED WEIBULL   PPCC STATISTIC
C                 LOGISITC           PPCC
C                 LOGISITC           PPCC LOCATION
C                 LOGISITC           PPCC SCALE
C                 LOGNORMAL          PPCC LOCATION
C                 LOGNORMAL          PPCC SCALE
C                 LOGNORMAL          PPCC SHAPE
C                 LOGNORMAL          PPCC STATISTIC
C                 MAXWELL            PPCC
C                 MAXWELL            PPCC LOCATION
C                 MAXWELL            PPCC SCALE
C                 MINIMUM GUMBEL     PPCC
C                 MINIMUM GUMBEL     PPCC LOCATION
C                 MINIMUM GUMBEL     PPCC SCALE
C                 MAXIMUM GUMBEL     PPCC
C                 MAXIMUM GUMBEL     PPCC LOCATION
C                 MAXIMUM GUMBEL     PPCC SCALE
C                 NORMAL             PPCC
C                 NORMAL             PPCC LOCATION
C                 NORMAL             PPCC SCALE
C                 RAYLEIGH           PPCC
C                 RAYLEIGH           PPCC LOCATION
C                 RAYLEIGH           PPCC SCALE
C                 SEMI-CIRCULAR      PPCC
C                 SEMI-CIRCULAR      PPCC LOCATION
C                 SEMI-CIRCULAR      PPCC SCALE
C                 SINE               PPCC
C                 SINE               PPCC LOCATION
C                 SINE               PPCC SCALE
C                 SLASH              PPCC
C                 SLASH              PPCC LOCATION
C                 SLASH              PPCC SCALE
C                 TUKEY-LAMBDA       PPCC LOCATION
C                 TUKEY-LAMBDA       PPCC SCALE
C                 TUKEY-LAMBDA       PPCC SHAPE
C                 TUKEY-LAMBDA       PPCC STATISTIC
C                 UNIFORM            PPCC
C                 UNIFORM            PPCC LOCATION
C                 UNIFORM            PPCC SCALE
C                 WALD               PPCC LOCATION
C                 WALD               PPCC SCALE
C                 WALD               PPCC SHAPE
C                 WALD               PPCC STATISTIC
C                 WEIBULL            PPCC LOCATION
C                 WEIBULL            PPCC SCALE
C                 WEIBULL            PPCC SHAPE
C                 WEIBULL            PPCC STATISTIC
C                 2PAR WEIBULL       PPCC SCALE
C                 2PAR WEIBULL       PPCC SHAPE
C                 2PAR WEIBULL       PPCC STATISTIC
C
C                 DOUBLE EXPONENTIAL ANDERSON DARLING
C                 DOUBLE EXPONENTIAL ANDERSON DARLING LOCATION
C                 DOUBLE EXPONENTIAL ANDERSON DARLING SCALE
C                 EXPONENTIAL        ANDERSON DARLING
C                 EXPONENTIAL        ANDERSON DARLING LOCATION
C                 EXPONENTIAL        ANDERSON DARLING SCALE
C                 GAMMA (2-PAR)      ANDERSON DARLING
C                 GAMMA (2-PAR)      ANDERSON DARLING LOCATION
C                 GAMMA (2-PAR)      ANDERSON DARLING SCALE
C                 GUMBEL             ANDERSON DARLING
C                 GUMBEL             ANDERSON DARLING LOCATION
C                 GUMBEL             ANDERSON DARLING SCALE
C                 LOGISTIC           ANDERSON DARLING
C                 LOGISTIC           ANDERSON DARLING LOCATION
C                 LOGISTIC           ANDERSON DARLING SCALE
C                 LOGNORMAL (2-PAR)  ANDERSON DARLING
C                 LOGNORMAL (2-PAR)  ANDERSON DARLING LOCATION
C                 LOGNORMAL (2-PAR)  ANDERSON DARLING SCALE
C                 MAXWELL            ANDERSON DARLING
C                 MAXWELL            ANDERSON DARLING LOCATION
C                 MAXWELL            ANDERSON DARLING SCALE
C                 NORMAL             ANDERSON DARLING
C                 NORMAL             ANDERSON DARLING LOCATION
C                 NORMAL             ANDERSON DARLING SCALE
C                 RAYLEIGH           ANDERSON DARLING
C                 RAYLEIGH           ANDERSON DARLING LOCATION
C                 RAYLEIGH           ANDERSON DARLING SCALE
C                 UNIFORM            ANDERSON DARLING
C                 UNIFORM            ANDERSON DARLING LOCATION
C                 UNIFORM            ANDERSON DARLING SCALE
C                 WEIBULL (2-PAR)    ANDERSON DARLING
C                 WEIBULL (2-PAR)    ANDERSON DARLING LOCATION
C                 WEIBULL (2-PAR)    ANDERSON DARLING SCALE
C
C
C              MISCELLANOUS:
C                 COMMON DIGITS
C                 INTERVAL COUNT
C                 INTEGRAL
C                 NUMBER (OR COUNT OR SIZE)
C                 PRODUCT
C                 RAW SHANNON DIVERSITY INDEX
C                 RAW SHANNON EQUITABILITY INDEX
C                 RAW SIMPSON DIVERSITY INDEX
C                 SHANNON DIVERSITY INDEX
C                 SHANNON EQUITABILITY INDEX
C                 SIMPSON DIVERSITY INDEX
C                 SUM
C                 UNIQUE (NUMBER OF DISTINCT VALUES)
C                 VALUE COUNT
C                 PYTHON MEAN
C
C              FOLLOWING ARE USED BY LET ... = CROSS TABULATE ...
C                 GROUP ONE
C                 GROUP TWO
C                 GROUP THREE
C                 GROUP FOUR
C                 GROUP FIVE
C                 GROUP SIX
C
C              CASE 2: TWO RESPONSE VARIABLES
C
C              GROUP STATISTICS
C                 COMMON COEFFICIENT OF VARIATION
C                 COMMON BIAS CORRECTED COEFFICIENT OF VARIATION
C
C              WEIGHTED STATISTICS:
C                 WEIGHTED MEAN
C                 WEIGHTED ORDER STATISTIC MEAN
C                 WEIGHTED STANDARD DEVIATION
C                 WEIGHTED SKEWNESS
C                 WEIGHTED SUM
C                 WEIGHTED SUM OF ABSOLUTE VALUES
C                 WEIGHTED SUM OF SQUARES
C                 WEIGHTED TRIMMED MEAN
C                 WEIGHTED VARIANCE
C
C              CO-RELATION:
C                 ANGULAR COSINE DISTANCE
C                 ANGULAR COSINE SIMILARITY
C                 BINARY ASYMMETRIC DICE MATCH DISSIMILARITY
C                 BINARY ASYMMETRIC DICE MATCH SIMILARITY
C                 BINARY ASYMMETRIC SOKOL MATCH DISSIMILARITY
C                 BINARY ASYMMETRIC SOKOL MATCH SIMILARITY
C                 BINARY GAMMA COEFFICIENT
C                 BINARY JACCARD DISSIMILARITY
C                 BINARY JACCARD SIMILARITY
C                 BINARY MATCH DISSIMILARITY
C                 BINARY MATCH SIMILARITY
C                 BINARY ROGERS MATCH DISSIMILARITY
C                 BINARY ROGERS MATCH SIMILARITY
C                 BINARY SOKAL MATCH DISSIMILARITY
C                 BINARY SOKAL MATCH SIMILARITY
C                 BIWEIGHT MIDCOVARIANCE
C                 BIWEIGHT MIDCORRELATION
C                 CANBERRA DISTANCE
C                 CHEBYCHEV DISTANCE
C                 COMOVEMENT
C                 CORRELATION
C                 CORRELATION ABSOLUTE VALUE
C                 CORRELATION PVALUE
C                 CORRELATION CDF
C                 CORRELATION RATIO
C                 COSINE DISTANCE
C                 COSINE SIMILARITY
C                 COVARIANCE
C                 DOT PRODUCT
C                 EUCLIDEAN DISTANCE
C                 EUCLIDEAN LENGTH
C                 GENERALIZED JACCARD COEFFICIENT
C                 GENERALIZED JACCARD DISTANCE
C                 GINI MEAN DIFFERENCE LOG RATIO
C                 HAMMING DISTANCE
C                 INTRACLASS CORRELATION
C                 KENDALLS TAU (GAMMA CORRELATION COEFFICIENT)
C                 KENDALLS TAU A
C                 KENDALLS TAU B
C                 KENDALLS TAU C
C                 KENDALLS TAU ABSOLUTE VALUE
C                 KENDALLS TAU CDF
C                 KENDALLS TAU DISSIMILARITY
C                 KENDALLS TAU PVALUE
C                 KENDALLS TAU LOWER TAILED PVALUE
C                 KENDALLS TAU UPPER TAILED PVALUE
C                 MANHATTAN DISTANCE
C                 MINKOWSKI DISTANCE
C                 PERCENTAGE BEND CORRELATION
C                 PEARSON DISSIMILARITY
C                 PEARSON SIMILARITY
C                 RANK CORRELATION
C                 RANK CORRELATION ABSOLUTE VALUE
C                 RANK CORRELATION CDF
C                 RANK CORRELATION PVALUE
C                 RANK CORRELATION LOWER TAILED PVALUE
C                 RANK CORRELATION UPPER TAILED PVALUE
C                 RANK COMOVEMENT
C                 RANK COVARIANCE
C                 SPEARMAN DISSIMILARITY
C                 WINSORIZED COVARIANCE
C                 WINSORIZED CORRELATION
C                 YOUDEN INDEX
C                 YULES Q (BINARY GAMMA COEFFICIENT)
C                 YULES Y
C
C              REGRESSION/FITTING:
C                 CONSTANT INTERCEPT
C                 CONSTANT INTERCEPT SD
C                 LINEAR CORRELATION
C                 LINEAR DISTINCT X
C                 LINEAR INTERCEPT
C                 LINEAR INTERCEPT SD
C                 LINEAR RESSD
C                 LINEAR SLOPE
C                 LINEAR SLOPE SD
C                 REPEATABILITY SD
C                 REPRODUCABILITY SD
C
C              CATEGORICAL DATA:
C                 CRAMER CONTINGENCY COEFFICIENT
C                 FALSE POSITIVE
C                 FALSE NEGATIVE
C                 LOG ODDS RATIO (BIAS CORRECTED LOG ODDS RATIO)
C                 NEGATIVE PREDICTIVE VALUE
C                 ODDS RATIO (BIAS CORRECTED ODDS RATIO)
C                 PEARSON CONTINGENCY COEFFICIENT
C                 PERCENTAGE AGREE
C                 PERCENTAGE DISAGREE
C                 POSITIVE PREDICTIVE VALUE
C                 RATIO (= SUM1/SUM2)
C                 RELATIVE RISK
C                 STANDARD ERROR LOG ODDS RATIO (STANDARD ERROR OF
C                     THE BIAS CORRECTED LOG ODDS RATIO)
C                 STANDARD ERROR ODDS RATIO (STANDARD ERROR OF THE
C                     BIAS CORRECTED ODDS RATIO)
C                 TRUE NEGATIVE
C                 TRUE POSITIVE
C                 TEST SENSITIVITY
C                 TEST SPECIFICITY
C
C              DIFFERENCE OF LOCATION:
C                 DIFFERENCE OF BIWEIGHT LOCATION
C                 DIFFERENCE OF GEOMETRIC MEANS
C                 DIFFERENCE OF H10 LOCATION
C                 DIFFERENCE OF H12 LOCATION
C                 DIFFERENCE OF H15 LOCATION
C                 DIFFERENCE OF H17 LOCATION
C                 DIFFERENCE OF H20 LOCATION
C                 DIFFERENCE OF HARMONIC MEANS
C                 DIFFERENCE OF HODGES-LEHMAN
C                 DIFFERENCE OF LP LOCATION
C                 DIFFERENCE OF MEANS
C                 DIFFERENCE OF MEDIANS
C                 DIFFERENCE OF MIDHINGE
C                 DIFFERENCE OF MIDMEAN
C                 DIFFERENCE OF SHORTEST MIDMEAN
C                 DIFFERENCE OF SHORTEST MIDRANGE
C                 DIFFERENCE OF TRIMEAN
C                 DIFFERENCE OF TRIMMED MEANS
C                 DIFFERENCE OF WINSORIZED MEANS
C                 HEDGES G
C
C              DIFFERENCE OF SCALE AND HIGHER MOMENTS:
C                 DIFFERENCE OF AAD
C                 DIFFERENCE OF AVERAGE ABSOLUTE DEVIATION MEDIAN
C                 DIFFERENCE OF BIWEIGHT MIDVARIANCE
C                 DIFFERENCE OF BIWEIGHT SCALE
C                 DIFFERENCE OF COEFFICIENT OF DISPERSION
C                 DIFFERENCE OF COEFFICIENT OF VARIATION
C                 DIFFERENCE OF EXTREMES
C                 DIFFERENCE OF GEOMETRIC SD
C                 DIFFERENCE OF H10 SCALE
C                 DIFFERENCE OF H12 SCALE
C                 DIFFERENCE OF H15 SCALE
C                 DIFFERENCE OF H17 SCALE
C                 DIFFERENCE OF H20 SCALE
C                 DIFFERENCE OF INDEX OF DISPERSION
C                 DIFFERENCE OF INTERQUARTILE RANGE
C                 DIFFERENCE OF KURTOSIS
C                 DIFFERENCE OF EXCESS KURTOSIS
C                 DIFFERENCE OF MAD
C                 DIFFERENCE OF MAD TO MEDIAN
C                 DIFFERENCE OF MAXIMUM
C                 DIFFERENCE OF MIDRANGE
C                 DIFFERENCE OF MINIMUM
C                 DIFFERENCE OF NORMALIZED INTERQUARTILE RANGE
C                 DIFFERENCE OF PERCENTAGE BEND
C                 DIFFERENCE OF PRECISION
C                 DIFFERENCE OF QN
C                 DIFFERENCE OF QUANTILE
C                 DIFFERENCE OF QUARTILE COEFFICIENT OF DISPERSION
C                 DIFFERENCE OF RANGE
C                 DIFFERENCE OF RELATIVE SD
C                 DIFFERENCE OF RELATIVE VARIANCE
C                 DIFFERENCE OF RESCALED SUM
C                 DIFFERENCE OF ROOT MEAN SQUARE ERROR (OR RMS)
C                 DIFFERENCE OF SCALED MAD
C                 DIFFERENCE OF SD OF LP LOCATION
C                 DIFFERENCE OF SD OF MEAN
C                 DIFFERENCE OF SKEWNESS
C                 DIFFERENCE OF GALTON SKEWNESS
C                 DIFFERENCE OF PEARSON TWO SKEWNESS
C                 DIFFERENCE OF SN
C                 DIFFERENCE OF SIGNAL TO NOISE RATIO
C                 DIFFERENCE OF SUM OF SQUARES
C                 DIFFERENCE OF SUM OF SQUARES FROM MEAN
C                 DIFFERENCE OF STANDARD DEVIATIONS
C                 DIFFERENCE OF VARIANCES
C                 DIFFERENCE OF VARIANCE OF LP LOCATION
C                 DIFFERENCE OF VARIANCE OF THE MEAN
C                 DIFFERENCE OF WINSORIZED SD
C                 DIFFERENCE OF WINSORIZED VARIANCE
C                 RATIO OF STANDARD DEVIATION <LOWER/UPPER> CONFIDENCE LIMIT
C                 RATIO OF VARIANCE           <LOWER/UPPER> CONFIDENCE LIMIT
C
C              PERCENTILE STATISTICS
C                 GROUPED QUANTILE
C                 GROUPED PERCENTILE
C                 GROUPED DECILE RATIO
C
C              STATISTICAL TESTS
C                 ANDERSON DARLING K SAMPLE TEST
C                 ANDERSON DARLING K SAMPLE TEST CRITICAL VALUE
C                 BINOMIAL RATIO
C                 BIVARIATE CRAMER VON MISES 95 CRITICAL VALUE
C                 BIVARIATE CRAMER VON MISES 05 CRITICAL VALUE
C                 BIVARIATE CRAMER VON MISES TEST
C                 COCHRAN VARIANCE OUTLIER TEST
C                 COCHRAN VARIANCE OUTLIER CV95
C                 COCHRAN VARIANCE OUTLIER CV99
C                 COCHRAN VARIANCE OUTLIER PVALUE
C                 COCHRAN VARIANCE OUTLIER CDF
C                 COCHRAN MINIMUM VARIANCE OUTLIER TEST
C                 COCHRAN MINIMUM VARIANCE OUTLIER CV05
C                 COCHRAN MINIMUM VARIANCE OUTLIER CV01
C                 COCHRAN MINIMUM VARIANCE OUTLIER PVALUE
C                 COCHRAN MINIMUM VARIANCE OUTLIER CDF
C                 DIFFERENCE OF BINOMIAL PROPORTIONS
C                 DIFFERENCE OF BINOMIAL PROPORTIONS LOWER CONF LIMIT
C                 DIFFERENCE OF BINOMIAL PROPORTIONS UPPER CONF LIMIT
C                 F TEST
C                 F TEST CDF
C                 F TEST PVALUE
C                 FISHER TWO SAMPLE RANDOMIZATION TEST
C                 FISHER TWO SAMPLE RANDOMIZATION TEST PVALUE
C                 FISHER TWO SAMPLE RANDOMIZATION LOWER TAIL PVALUE
C                 GROUPED POISSON DISPERSION TEST
C                 GROUPED POISSON DISPERSION TEST CDF
C                 GROUPED POISSON DISPERSION TEST CDF PVALUE
C                 KLOTZ TEST
C                 KLOTZ TEST CDF
C                 KLOTZ TEST PVALUE
C                 KLOTZ TEST LOWER TAILED PVALUE
C                 KLOTZ TEST UPPER TAILED PVALUE
C                 KRUSKALL WALLIS TEST
C                 KRUSKALL WALLIS TEST CDF
C                 KRUSKALL WALLIS TEST PVALUE
C                 MANN WHITNEY RANK SUM TEST
C                 MANN WHITNEY RANK SUM TEST CDF
C                 MANN WHITNEY RANK SUM TEST PVALUE
C                 MANN WHITNEY RANK SUM LOWER TAIL PVALUE
C                 MANN WHITNEY RANK SUM UPPER TAIL PVALUE
C                 MANN WHITNEY U STATISTIC
C                 MEAN NEAREST NEIGHBOR DISTANCE CDF
C                 MEAN NEAREST NEIGHBOR DISTANCE PVALUE
C                 MEAN NEAREST NEIGHBOR DISTANCE TEST
C                 MEDIAN TEST
C                 MEDIAN TEST CDF
C                 MEDIAN TEST PVALUE
C                 ONE SAMPLE COEFFICIENT OF VARIATION TEST
C                 ONE SAMPLE COEFFICIENT OF VARIATION TEST CDF
C                 ONE SAMPLE COEFFICIENT OF VARIATION TEST PVALUE
C                 ONE SAMPLE COEFFICIENT OF VARIATION LOWER PVALUE
C                 ONE SAMPLE COEFFICIENT OF VARIATION UPPER PVALUE
C                 POLLARD ONE CDF
C                 POLLARD ONE PVALUE
C                 POLLARD ONE TEST
C                 POLLARD TWO CDF
C                 POLLARD TWO PVALUE
C                 POLLARD TWO TEST
C                 POLLARD THREE CDF
C                 POLLARD THREE PVALUE
C                 POLLARD THREE TEST
C                 POLLARD FOUR CDF
C                 POLLARD FOUR PVALUE
C                 POLLARD FOUR TEST
C                 POLLARD FIVE CDF
C                 POLLARD FIVE PVALUE
C                 POLLARD FIVE TEST
C                 RATIO OF MEANS
C                 RATIO OF MEANS LOWER CONFIDENCE LIMIT
C                 RATIO OF MEANS UPPER CONFIDENCE LIMIT
C                 SIEGEL TUKEY TEST
C                 SIEGEL TUKEY TEST CDF
C                 SIEGEL TUKEY TEST PVALUE
C                 SIEGEL TUKEY LOWER TAIL PVALUE
C                 SIEGEL TUKEY UPPER TAIL PVALUE
C                 SQUARED RANK TEST
C                 SQUARED RANK TEST CDF
C                 SQUARED RANK TEST PVALUE
C                 SQUARED RANK TEST LOWER TAILED PVALUE
C                 SQUARED RANK TEST UPPER TAILED PVALUE
C                 SUMMARY LOWER COEFFIENT OF VARIATION
C                 SUMMARY LOWER SD CONFIDENCE LIMITS
C                 SUMMARY LOWER SD PREDICTION LIMITS
C                 SUMMARY ONE SIDED LOWER SD CONFIDENCE LIMITS
C                 SUMMARY ONE SIDED LOWER SD PREDICTION LIMITS
C                 SUMMARY ONE SIDED UPPER SD CONFIDENCE LIMITS
C                 SUMMARY ONE SIDED UPPER SD PREDICTION LIMITS
C                 SUMMARY UPPER COEFFIENT OF VARIATION
C                 SUMMARY UPPER SD CONFIDENCE LIMITS
C                 SUMMARY UPPER SD PREDICTION LIMITS
C                 TWO SAMPLE CHI-SQUARE TEST
C                 TWO SAMPLE CHI-SQUARE TEST CDF
C                 TWO SAMPLE CHI-SQUARE TEST PVALUE
C                 TWO SAMPLE COEFFICIENT OF VARIATION TEST
C                 TWO SAMPLE COEFFICIENT OF VARIATION TEST CDF
C                 TWO SAMPLE COEFFICIENT OF VARIATION TEST PVALUE
C                 TWO SAMPLE COEFFICIENT OF VARIATION LOWER PVALUE
C                 TWO SAMPLE COEFFICIENT OF VARIATION UPPER PVALUE
C                 TWO SAMPLE KOLMOGOROV SMIRNOV TEST
C                 TWO SAMPLE KOLMOGOROV SMIRNOV CRITICAL VALUE
C                 TWO SAMPLE PAIRED T-TEST
C                 TWO SAMPLE PAIRED T-TEST CDF
C                 TWO SAMPLE PAIRED T-TEST PVALUE
C                 TWO SAMPLE PAIRED T-TEST LOWER TAIL PVALUE
C                 TWO SAMPLE PAIRED T-TEST UPPER TAIL PVALUE
C                 TWO SAMPLE SIGN TEST
C                 TWO SAMPLE SIGN TEST CDF
C                 TWO SAMPLE SIGN TEST PVALUE
C                 TWO SAMPLE SIGN TEST LOWER TAIL PVALUE
C                 TWO SAMPLE SIGN TEST UPPER TAIL PVALUE
C                 TWO SAMPLE T-TEST
C                 TWO SAMPLE T-TEST CDF
C                 TWO SAMPLE T-TEST PVALUE
C                 TWO SAMPLE T-TEST LOWER TAIL PVALUE
C                 TWO SAMPLE T-TEST UPPER TAIL PVALUE
C                 TWO SAMPLE WILCOXON SIGNED RANK TEST
C                 TWO SAMPLE WILCOXON SIGNED RANK TEST CDF
C                 TWO SAMPLE WILCOXON SIGNED RANK TEST PVALUE
C                 TWO SAMPLE WILCOXON SIGNED RANK TEST LOWER TAIL PVALUE
C                 TWO SAMPLE WILCOXON SIGNED RANK TEST UPPER TAIL PVALUE
C
C              DISTRIBUTION:
C                 COMMON WEIBULL SHAPE TEST
C                 COMMON WEIBULL SHAPE TEST CDF
C                 COMMON WEIBULL SHAPE TEST PVALUE
C                 COMMON WEIBULL SHAPE TEST CV90
C                 COMMON WEIBULL SHAPE TEST CV95
C                 COMMON WEIBULL SHAPE TEST CV99
C
C              CONSENSUS MEANS:
C                 DERSIMONIAN LAIRD
C                 DERSIMONIAN LAIRD STANDARD ERROR
C                 DERSIMONIAN LAIRD HHD
C                 DERSIMONIAN LAIRD MINMAX
C                 MANDEL PAULE
C                 MANDEL PAULE STANDARD ERROR
C                 MODIFIED MANDEL PAULE
C                 MODIFIED MANDEL PAULE STANDARD ERROR
C                 VANGEL RUKHIN
C                 VANGEL RUKHIN STANDARD ERROR
C                 GENERALIZED CONFIDENCE INTERVAL
C                 GENERALIZED CONFIDENCE INTERVAL STANDARD ERROR
C                 BOB
C                 BOB STANDARD ERROR
C                 BCP
C                 BCP STANDARD ERROR
C                 MEAN OF MEANS
C                 MEAN OF MEANS STANDARD ERROR
C                 FAIRWEATHER
C                 FAIRWEATHER STANDARD ERROR
C                 SCHILLER-EBERHARDT
C                 SCHILLER-EBERHARDT STANDARD ERROR
C                 GRAYBILL DEAL
C                 GRAYBILL DEAL SINHA STANDARD ERROR
C                 GRAYBILL DEAL NAIVE STANDARD ERROR
C                 GRAYBILL DEAL ZHANG ONE STANDARD ERROR
C                 GRAYBILL DEAL ZHANG TWO STANDARD ERROR
C                 LINEAR POOL
C                 LINEAR POOL STANDARD ERROR
C
C              MISCELLANEOUS:
C                 DIFFERENCE OF COUNTS
C                 DIFFERENCE OF SUMS
C                 DIFFERENCE OF PRODUCTS
C                 DIFFERENCE OF INTEGRALS
C                 DIFFERENCE OF BINOMIAL PROBABILITIES
C                 INDEX FIRST MATCH
C                 INDEX LAST  MATCH
C                 INDEX FIRST NOT MATCH
C                 INDEX LAST  NOT MATCH
C                 PERCENTAGE DIFFERENCE OF MEAN
C
C              CASE 3: THREE RESPONSE VARIABLES
C
C              WEIGHTED STATISTICS:
C                 GROUPED CORRELATION
C                 WEIGHTED CORRELATION
C                 WEIGHTED COSINE DISTANCE
C                 WEIGHTED COSINE SIMILARITY
C                 WEIGHTED COVARIANCE
C
C              FIT/CORRELATION
C                 EQUAL SLOPES
C                 EQUAL SLOPES CDF
C                 EQUAL SLOPES CRITICAL VALUE
C                 EQUAL SLOPES ONE SIDED PVALUE
C                 EQUAL SLOPES TWO SIDED PVALUE
C                 PARTIAL CORRELATION
C                 PARTIAL CORRELATION ABSOLUTE VALUE
C                 PARTIAL CORRELATION CDF
C                 PARTIAL CORRELATION PVALUE
C                 PARTIAL KENDALL TAU CORRELATION
C                 PARTIAL KENDALL TAU CORRELATION ABSOLUTE VALUE
C                 PARTIAL RANK CORRELATION
C                 PARTIAL RANK CORRELATION ABSOLUTE VALUE
C
C              STATISTICAL TESTS
C                 FRIEDMAN TEST
C                 FRIEDMAN TEST CDF
C                 FRIEDMAN TEST PVALUE
C                 PAGE TEST
C                 PAGE MODIFIED TEST
C                 PAGE TEST CDF
C                 PAGE TEST PVALUE
C                 QUADE TEST
C                 QUADE TEST CDF
C                 QUADE TEST PVALUE
C                 SUMMARY LOWER COEFFIENT OF VARIATION CONFIDENCE LIMITS
C                 SUMMARY LOWER CONFIDENCE LIMITS
C                 SUMMARY LOWER PREDICTION BOUNDS
C                 SUMMARY LOWER PREDICTION LIMITS
C                 SUMMARY NORMAL TOLERANCE K FACTOR
C                 SUMMARY NORMAL TOLERANCE LOWER LIMIT
C                 SUMMARY NORMAL TOLERANCE UPPER LIMIT
C                 SUMMARY NORMAL TOLERANCE ONE SIDED K FACTOR
C                 SUMMARY NORMAL TOLERANCE ONE SIDED LOWER LIMIT
C                 SUMMARY NORMAL TOLERANCE ONE SIDED UPPER LIMIT
C                 SUMMARY ONE SAMPLE COEFFICIENT OF VARIATION CDF
C                 SUMMARY ONE SAMPLE COEFFICIENT OF VARIATION PVALUE
C                 SUMMARY ONE SAMPLE COEFFICIENT OF VARIATION TEST
C                 SUMMARY ONE SIDED LOWER CONFIDENCE LIMITS
C                 SUMMARY ONE SIDED LOWER PREDICTION BOUNDS
C                 SUMMARY ONE SIDED LOWER PREDICTION LIMITS
C                 SUMMARY ONE SIDED UPPER CONFIDENCE LIMITS
C                 SUMMARY ONE SIDED UPPER PREDICTION BOUNDS
C                 SUMMARY ONE SIDED UPPER PREDICTION LIMITS
C                 SUMMARY UPPER COEFFIENT OF VARIATION CONFIDENCE LIMITS
C                 SUMMARY UPPER CONFIDENCE LIMITS
C                 SUMMARY UPPER PREDICTION BOUNDS
C                 SUMMARY UPPER PREDICTION LIMITS
C
C              CONSENSUS MEANS
C                 ANDERSON DARLING K SAMPLE TEST
C                 SUMMARY DERSIMONIAN LAIRD
C                 SUMMARY DERSIMONIAN LAIRD STANDARD ERROR
C                 SUMMARY DERSIMONIAN LAIRD HHD
C                 SUMMARY DERSIMONIAN LAIRD MINMAX
C                 SUMMARY MANDEL PAULE
C                 SUMMARY MANDEL PAULE STANDARD ERROR
C                 SUMMARY MODIFIED MANDEL PAULE
C                 SUMMARY MODIFIED MANDEL PAULE STANDARD ERROR
C                 SUMMARY VANGEL RUKHIN
C                 SUMMARY VANGEL RUKHIN STANDARD ERROR
C                 SUMMARY GENERALIZED CONFIDENCE INTERVAL
C                 SUMMARY GENERALIZED CONFIDENCE INTERVAL STANDARD ERROR
C                 SUMMARY BOB
C                 SUMMARY BOB STANDARD ERROR
C                 SUMMARY BCP
C                 SUMMARY BCP STANDARD ERROR
C                 SUMMARY MEAN OF MEANS
C                 SUMMARY MEAN OF MEANS STANDARD ERROR
C                 SUMMARY FAIRWEATHER
C                 SUMMARY FAIRWEATHER STANDARD ERROR
C                 SUMMARY SCHILLER-EBERHARDT
C                 SUMMARY SCHILLER-EBERHARDT STANDARD ERROR
C                 SUMMARY GRAYBILL DEAL
C                 SUMMARY GRAYBILL DEAL SINHA STANDARD ERROR
C                 SUMMARY GRAYBILL DEAL NAIVE STANDARD ERROR
C                 SUMMARY GRAYBILL DEAL ZHANG ONE STANDARD ERROR
C                 SUMMARY GRAYBILL DEAL ZHANG TWO STANDARD ERROR
C                 SUMMARY LINEAR POOL
C                 SUMMARY LINEAR POOL STANDARD ERROR
C
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2009/2
C     ORIGINAL VERSION--FEBRUARY  2009.
C     UPDATED         --JULY      2009. SUPPORT FOR H10, H12, H15,
C                                       H17, AND H20 LOCATION AND
C                                       SCALE ESTIMATES (AND
C                                       DIFFERENCE OF)
C     UPDATED         --SEPTEMBER 2009. QUANTILE AND PERCENTILE
C                                       COMMANDS CAN SUPPORT A
C                                       PARAMETER (E.G.,
C                                       LET X = XQ QUANTILE Y).
C                                       NEED TO ACCOUNT FOR THIS.
C     UPDATED         --NOVEMBER  2009. TIETJEN-MOORE TEST
C     UPDATED         --NOVEMBER  2009. EXTREME STUDENTIZED DEVIATE TEST
C     UPDATED         --JANUARY   2010. BINOMIAL RATIO
C     UPDATED         --JANUARY   2010. RMS AND DIFFERENCE OF RMS
C     UPDATED         --MARCH     2010. <ONE-SIDED/TWO-SIDED> <LOWER/UPPER>
C                                       AGRESTI-COUL
C     UPDATED         --MARCH     2010. <ONE-SIDED/TWO-SIDED> <LOWER/UPPER>
C                                       EXACT BINOMIAL
C     UPDATED         --MAY       2010. LINEAR INTERCEPT SD
C     UPDATED         --MAY       2010. LINEAR SLOPE     SD
C     UPDATED         --MAY       2010. LINEAR DISTINCT X
C     UPDATED         --JUNE      2010. VARIOUS CONSENSUS MEAN STATISTIC
C     UPDATED         --DECEMBER  2010. ROBUST POOLED SD
C     UPDATED         --DECEMBER  2010. ROBUST POOLED RANGE
C     UPDATED         --MARCH     2011. ANDERSON DARLING K SAMPLE TEST
C     UPDATED         --MARCH     2011. TWO SAMPLE KOLM SMIR TEST
C     UPDATED         --MARCH     2011. WILK SHAPIRO
C     UPDATED         --MARCH     2011. CUMULATIVE SUM
C     UPDATED         --MARCH     2011. NORMAL TOLERANCE LIMITS
C     UPDATED         --MARCH     2011. F-TEST
C     UPDATED         --APRIL     2011. TWO SAMPLE T-TEST
C     UPDATED         --APRIL     2011. ONE/TWO SAMPLE SIGN TEST
C     UPDATED         --MAY       2011. ABOUT A DOZEN ADDITIONAL PPCC
C     UPDATED         --MAY       2011. WILCOXON SIGNED RANK TEST
C     UPDATED         --MAY       2011. MANN WHITNEY RANK SUM TEST
C     UPDATED         --MAY       2011. KLOTZ TEST
C     UPDATED         --JUNE      2011. SQUARED RANK TEST
C     UPDATED         --JUNE      2011. MEDIAN TEST
C     UPDATED         --JUNE      2011. FISHER TWO SAMPLE RAND TEST
C     UPDATED         --JULY      2011. TWO SAMPLE CHI-SQUARE TEST
C     UPDATED         --JULY      2011. CHANGE ICASPL FOR LP LOCATION
C                                       TO AVOID CONFLICT WITH LEVEL
C                                       PLOT IN PLOTGE/PLOTG2
C     UPDATED         --JULY      2011. KRUSKALL WALLIS TEST
C     UPDATED         --JULY      2011. FRIEDMAN TEST
C     UPDATED         --JULY      2011. QUADE TEST
C     UPDATED         --JULY      2011. UNIQUE
C     UPDATED         --JULY      2011. PERCENTAGE AGREE
C                                       PERCENTAGE DISAGREE
C     UPDATED         --AUGUST    2011. SUMMARY NORMAL TOLERANCE LIMITS
C     UPDATED         --AUGUST    2011. CORRELATION ABSOLUTE VALUE
C     UPDATED         --NOVEMBER  2011. INDEX FIRST MATCH
C     UPDATED         --NOVEMBER  2011. INDEX LAST  MATCH
C     UPDATED         --NOVEMBER  2011. INDEX FIRST NOT MATCH
C     UPDATED         --NOVEMBER  2011. INDEX LAST  NOT MATCH
C     UPDATED         --DECEMBER  2011. SHANNON DIVERSITY INDEX
C     UPDATED         --DECEMBER  2011. SHANNON EQUITABILITY INDEX
C     UPDATED         --DECEMBER  2011. SIMPSON DIVERSITY INDEX
C     UPDATED         --DECEMBER  2011. JARQUE BERA
C     UPDATED         --FEBRUARY  2012. SUM OF SQUARES
C     UPDATED         --FEBRUARY  2012. RESCALED SUM
C     UPDATED         --FEBRUARY  2012. RELATIVE LABORATORY PERFORMANCE
C                                       (RLP)
C     UPDATED         --JUNE      2012. CORRELATION PVALUE
C     UPDATED         --JUNE      2012. CORRELATION CDF
C     UPDATED         --JUNE      2012. RANK CORRELATION ABSOLUTE VALUE
C     UPDATED         --JUNE      2012. KENDALL TAU CORRELATION
C                                       ABSOLUTE VALUE
C     UPDATED         --JUNE      2012. PARTIAL CORRELATION
C     UPDATED         --JUNE      2012. PARTIAL CORRELATION PVALUE
C     UPDATED         --JUNE      2012. PARTIAL CORRELATION CDF
C     UPDATED         --JUNE      2012. PARTIAL CORRELATION ABSOLUTE VALUE
C     UPDATED         --JUNE      2012. PARTIAL RANK CORRELATION
C     UPDATED         --JUNE      2012. PARTIAL RANK CORRELATION ABSO VALUE
C     UPDATED         --JUNE      2012. PARTIAL KENDALL TAU CORRELATION
C     UPDATED         --JUNE      2012. PARTIAL KENDALL TAU CORRELATION
C                                               ABSOLUTE VALUE
C     UPDATED         --JUNE      2012. WEIGHTED SUM
C     UPDATED         --JUNE      2012. WEIGHTED SUM OF SQUARES
C     UPDATED         --JUNE      2012. WEIGHTED SUM OF ABSOLUTE VALUES
C     UPDATED         --JUNE      2012. DIFFERENCE OF SUM OF SQUARES
C     UPDATED         --JUNE      2012. DIFFERENCE OF RESCALED SUM
C     UPDATED         --SEPTEMBER 2012. Q QUANTILE RANGE
C     UPDATED         --NOVEMBER  2012. WEIGHTED ORDER STATISTIC MEAN
C     UPDATED         --DECEMBER  2012. LOWER CONFIDENCE LIMIT
C     UPDATED         --DECEMBER  2012. ONE-SIDED LOWER CONFIDENCE
C                                       LIMIT
C     UPDATED         --DECEMBER  2012. UPPER CONFIDENCE LIMIT
C     UPDATED         --DECEMBER  2012. ONE-SIDED UPPER CONFIDENCE
C                                       LIMIT
C     UPDATED         --DECEMBER  2012. LOWER PREDICTION LIMIT
C     UPDATED         --DECEMBER  2012. ONE-SIDED LOWER PREDICTION
C                                       LIMIT
C     UPDATED         --DECEMBER  2012. UPPER PREDICTION LIMIT
C     UPDATED         --DECEMBER  2012. ONE-SIDED UPPER PREDICTION
C                                       LIMIT
C     UPDATED         --JANUARY   2013. NUMEROUS "PPCC" TYPE STATISTICS
C     UPDATED         --FEBRUARY  2013. NUMEROUS "PPCC" TYPE STATISTICS
C     UPDATED         --FEBRUARY  2013. LJUNG BOX TEST
C     UPDATED         --FEBRUARY  2013. PAGE TEST
C     UPDATED         --FEBRUARY  2013. KENDELL TAU CDF/PVALUE
C     UPDATED         --FEBRUARY  2013. SUM OF SQUARES FROM MEAN
C     UPDATED         --MARCH     2013. DIFFERENCE SUM OF SQUARES FROM MEAN
C     UPDATED         --MARCH     2013. PREDICTION BOUNDS
C     UPDATED         --MARCH     2013. SUMMARY PREDICTION LIMIT
C     UPDATED         --MARCH     2013. SUMMARY PREDICTION BOUNDS
C     UPDATED         --APRIL     2013. SD CONFIDENCE LIMITS
C     UPDATED         --APRIL     2013. SD PREDICTION LIMITS
C     UPDATED         --AUGUST    2013. MCCOOL WEIBULL LOCATION TEST
C     UPDATED         --OCTOBER   2013. CONSTANT INTERCEPT
C     UPDATED         --OCTOBER   2013. CONSTANT INTERCEPT SD
C     UPDATED         --NOVEMBER  2013. POISSON DISPERSION TEST
C     UPDATED         --NOVEMBER  2013. GROUPED POISSON DISPERSION TEST
C     UPDATED         --JANUARY   2014. BIVARIATE CRAMER VON MISES TEST
C     UPDATED         --JANUARY   2014. MEAN NEAREST NEIGHBOR DISTANCE
C                                       TEST
C     UPDATED         --JANUARY   2014. POLLARD TEST
C     UPDATED         --FEBRUARY  2014. VALUE COUNT
C     UPDATED         --MARCH     2014. VARIATIONAL DISTANCE
C     UPDATED         --MARCH     2014. RELATIVE DISPERSION INDEX
C     UPDATED         --MARCH     2014. UNIFORM CHI-SQUARE
C     UPDATED         --MARCH     2014. INTERDECILE RATIO
C     UPDATED         --MARCH     2014. GROUPED DECILE RATIO
C     UPDATED         --MARCH     2014. GROUPED PERCENTILE
C     UPDATED         --MARCH     2014. GROUPED QUANTILE
C     UPDATED         --APRIL     2014. COMMON WEIBULL SHAPE TEST
C     UPDATED         --MAY       2014. WEIGHTED SKEWNESS
C     UPDATED         --MAY       2014. KAPPENMAN R
C     UPDATED         --JULY      2014. BOX COX NORMALITY PPCC
C     UPDATED         --JULY      2014. BOX COX NORMALITY LAMBDA
C     UPDATED         --JULY      2014. AVERAGE ABSOLUTE DEVIATION
C                                       FROM THE MEDIAN
C     UPDATED         --JULY      2014. DIFFERENCE OF AVERAGE ABSOLUTE
C                                       DEVIATION FROM MEDIAN
C     UPDATED         --DECEMBER  2014. GALTON SKEWNESS
C     UPDATED         --DECEMBER  2014. PEARSON TWO SKEWNESS
C     UPDATED         --FEBRUARY  2015. BURR TYPE 10 ANDERSON DARLING
C     UPDATED         --FEBRUARY  2015. BURR TYPE 10 ANDERSON DARLING SHAPE
C     UPDATED         --FEBRUARY  2015. BURR TYPE 10 SCALE
C     UPDATED         --FEBRUARY  2015. DOUBLE EXPONENTIAL ANDERSON
C                                       DARLING
C     UPDATED         --FEBRUARY  2015. DOUBLE EXPONENTIAL ANDERSON
C                                       DARLING LOCATION
C     UPDATED         --FEBRUARY  2015. DOUBLE EXPONENTIAL ANDERSON
C                                       DARLING SCALE
C     UPDATED         --FEBRUARY  2015. EXPONENTIAL ANDERSON DARLING
C     UPDATED         --FEBRUARY  2015. EXPONENTIAL ANDERSON DARLING LOCATION
C     UPDATED         --FEBRUARY  2015. EXPONENTIAL ANDERSON DARLING SCALE
C     UPDATED         --FEBRUARY  2015. GAMMA ANDERSON DARLING
C     UPDATED         --FEBRUARY  2015. GAMMA ANDERSON DARLING SHAPE
C     UPDATED         --FEBRUARY  2015. GAMMA SCALE
C     UPDATED         --FEBRUARY  2015. FATIGUE LIFE ANDERSON DARLING
C     UPDATED         --FEBRUARY  2015. FATIGE LIFE ANDERSON DARLING SHAPE
C     UPDATED         --FEBRUARY  2015. FATIGUE LIFE SCALE
C     UPDATED         --FEBRUARY  2015. FRECHET ANDERSON DARLING
C     UPDATED         --FEBRUARY  2015. FRECHET ANDERSON DARLING SHAPE
C     UPDATED         --FEBRUARY  2015. FRECHET SCALE
C     UPDATED         --FEBRUARY  2015. GEOMETRIC EXPONENTIAL ANDERSON DARLING
C     UPDATED         --FEBRUARY  2015. GEOMETRIC EXPONENTIAL ANDERSON DARLING SHAPE
C     UPDATED         --FEBRUARY  2015. GEOMETRIC EXPONENTIAL SCALE
C     UPDATED         --FEBRUARY  2015. GUMBEL ANDERSON DARLING
C     UPDATED         --FEBRUARY  2015. GUMBEL ANDERSON DARLING LOCATION
C     UPDATED         --FEBRUARY  2015. GUMBEL SCALE
C     UPDATED         --FEBRUARY  2015. INVERTED GAMMA ANDERSON DARLING
C     UPDATED         --FEBRUARY  2015. INVERTED GAMMA ANDERSON DARLING SHAPE
C     UPDATED         --FEBRUARY  2015. INVERTED GAMMA SCALE
C     UPDATED         --FEBRUARY  2015. LOGISTIC ANDERSON DARLING
C     UPDATED         --FEBRUARY  2015. LOGISTIC ANDERSON DARLING LOCATION
C     UPDATED         --FEBRUARY  2015. LOGISTIC SCALE
C     UPDATED         --FEBRUARY  2015. LOGISTIC EXPONENTIAL ANDERSON DARLING
C     UPDATED         --FEBRUARY  2015. LOGISTIC EXPONENTIAL ANDERSON DARLING SHAPE
C     UPDATED         --FEBRUARY  2015. LOGISTIC EXPONENTIAL SCALE
C     UPDATED         --FEBRUARY  2015. LOGNORMAL ANDERSON DARLING
C     UPDATED         --FEBRUARY  2015. LOGNORMAL ANDERSON DARLING SHAPE
C     UPDATED         --FEBRUARY  2015. LOGNORMAL ANDERSON DARLING SCALE
C     UPDATED         --FEBRUARY  2015. MAXWELL ANDERSON DARLING
C     UPDATED         --FEBRUARY  2015. MAXWELL ANDERSON DARLING LOCATION
C     UPDATED         --FEBRUARY  2015. MAXWELL SCALE
C     UPDATED         --FEBRUARY  2015. NORMAL ANDERSON DARLING
C     UPDATED         --FEBRUARY  2015. NORMAL ANDERSON DARLING LOCATION
C     UPDATED         --FEBRUARY  2015. NORMAL ANDERSON DARLING SCALE
C     UPDATED         --FEBRUARY  2015. RAYLEIGH ANDERSON DARLING
C     UPDATED         --FEBRUARY  2015. RAYLEIGH ANDERSON DARLING LOCATION
C     UPDATED         --FEBRUARY  2015. RAYLEIGH SCALE
C     UPDATED         --FEBRUARY  2015. UNIFORM ANDERSON DARLING
C     UPDATED         --FEBRUARY  2015. UNIFORM ANDERSON DARLING LOCATION
C     UPDATED         --FEBRUARY  2015. UNIFORM SCALE
C     UPDATED         --FEBRUARY  2015. WEIBULL ANDERSON DARLING
C     UPDATED         --FEBRUARY  2015. WEIBULL ANDERSON DARLING SHAPE
C     UPDATED         --FEBRUARY  2015. WEIBULL ANDERSON DARLING SCALE
C     UPDATED         --FEBRUARY  2015. FOR RLP, SPECIFY 2 RESPONSE
C                                       VARIABLES
C     UPDATED         --FEBRUARY  2015. JSCORE STATISTIC
C     UPDATED         --MARCH     2015. COCHRAN VARIANCE OUTLIER TEST
C     UPDATED         --APRIL     2015. CPMK, CNP, CNPM, CNPMK
C     UPDATED         --OCTOBER   2015. EQUAL SLOPES TEST
C     UPDATED         --NOVEMBER  2015. DIFFERENCE OF EXCESS KURTOSIS
C     UPDATED         --NOVEMBER  2015. DIFFERENCE OF GALTON SKEWNESS
C     UPDATED         --NOVEMBER  2015. DIFFERENCE OF PEARSON TWO
C                                       SKEWNESS
C     UPDATED         --MARCH     2016. SCALED MAD
C     UPDATED         --MARCH     2016. NORMALIZED IQR
C     UPDATED         --MARCH     2016. DIFFERENCE OF SCALED MAD
C     UPDATED         --MARCH     2016. DIFFERENCE OF NORMALIZED IQR
C     UPDATED         --JUNE      2016. 2PARAMETER WEIBULL PPCC
C     UPDATED         --JUNE      2016. 2PARAMETER WEIBULL PPCC SCALE
C     UPDATED         --JUNE      2016. 2PARAMETER WEIBULL PPCC SHAPE
C     UPDATED         --AUGUST    2016. SUPPORT FOR FUNCTION BLOCKS
C     UPDATED         --DECEMBER  2016. COEFFICIENT OF VARIATION
C                                       CONFIDENCE LIMITS
C     UPDATED         --JANUARY   2017. UNBIASED COEFFICIENT OF VARIATION
C     UPDATED         --JANUARY   2017. SIGNAL TO NOISE RATIO
C     UPDATED         --JANUARY   2017. PRECISION
C     UPDATED         --JANUARY   2017. COEFFICIENT OF DISPERSION
C     UPDATED         --JANUARY   2017. QUARTILE COEFFICIENT OF
C                                       DISPERSION
C     UPDATED         --JANUARY   2017. INDEX OF DISPERSION
C     UPDATED         --JANUARY   2017. AAD TO MEDIAN
C     UPDATED         --FEBRUARY  2017. SHORTEST HALF MIDMEAN
C     UPDATED         --FEBRUARY  2017. SHORTEST HALF MIDRANGE
C     UPDATED         --FEBRUARY  2017. COMMON COEFFICIENT OF VARIATION
C     UPDATED         --FEBRUARY  2017. COMMON BIAS CORRECTED COEFFICIENT
C                                       OF VARIATION
C     UPDATED         --FEBRUARY  2017. LOWER COMMON COEFFICIENT OF
C                                       VARIATION CONFIDENCE LIMIT
C     UPDATED         --FEBRUARY  2017. UPPER COMMON COEFFICIENT OF
C                                       VARIATION CONFIDENCE LIMIT
C     UPDATED         --MARCH     2017. COSINE DISTANCE
C     UPDATED         --MARCH     2017. COSINE SIMILARITY
C     UPDATED         --MARCH     2017. ANGULAR COSINE DISTANCE
C     UPDATED         --MARCH     2017. ANGULAR COSINE SIMILARITY
C     UPDATED         --MARCH     2017. EUCLIDEAN DISTANCE
C     UPDATED         --MARCH     2017. EUCLIDEAN LENGTH
C     UPDATED         --MARCH     2017. DOT PRODUCT
C     UPDATED         --MARCH     2017. MANHATTAN DISTANCE
C     UPDATED         --MARCH     2017. DIFFERENCE OF PRECISION
C     UPDATED         --MARCH     2017. DIFFERENCE OF SNR
C     UPDATED         --JUNE      2017. PERCENTAGE DIFFERENCE OF MEAN
C     UPDATED         --JUNE      2017. ONE SAMPLE COEF OF VARI TEST
C     UPDATED         --JUNE      2017. ONE SAMPLE COEF OF VARI TEST CDF
C     UPDATED         --JUNE      2017. ONE SAMPLE COEF OF VARI TEST PVALUE
C     UPDATED         --JUNE      2017. ONE SAMPLE COEF OF VARI LOWER PVALUE
C     UPDATED         --JUNE      2017. ONE SAMPLE COEF OF VARI UPPER PVALUE
C     UPDATED         --JUNE      2017. SUMMARY ONE SAMPLE COEF OF VARI TEST
C     UPDATED         --JUNE      2017. SUMMARY ONE SAMPLE COEF OF VARI CDF
C     UPDATED         --JUNE      2017. SUMMARY ONE SAMPLE COEF OF VARI PVALUE
C     UPDATED         --JUNE      2017. TWO SAMPLE COEF OF VARI TEST
C     UPDATED         --JUNE      2017. TWO SAMPLE COEF OF VARI TEST CDF
C     UPDATED         --JUNE      2017. TWO SAMPLE COEF OF VARI TEST PVALUE
C     UPDATED         --JUNE      2017. TWO SAMPLE COEF OF VARI LOWER PVALUE
C     UPDATED         --JUNE      2017. TWO SAMPLE COEF OF VARI UPPER PVALUE
C     UPDATED         --JUNE      2017. DIFFERENCE OF AAD TO MEDIAN
C     UPDATED         --JUNE      2017. DIFFERENCE OF COEFFICIENT OF
C                                                  DISPERSION
C     UPDATED         --JUNE      2017. DIFFERENCE OF INDEX OF DISPERSION
C     UPDATED         --JUNE      2017. DIFFERENCE OF QUARTILE COEFFICIENT
C                                                  OF DISPERSION
C     UPDATED         --JULY      2017. HEDGES G
C     UPDATED         --JULY      2017. BIAS CORRECTED HEDGES G
C     UPDATED         --JULY      2017. COHENS D
C     UPDATED         --JULY      2017. GLASS G
C     UPDATED         --JULY      2017. MIDHINGE, TRIMEAN
C     UPDATED         --JULY      2017. DIFFERENCE OF MIDHINGE
C     UPDATED         --JULY      2017. DIFFERENCE OF TRIMEAN
C     UPDATED         --AUGUST    2017. PEARSON DISSIMILARITY
C     UPDATED         --AUGUST    2017. SPEARMAN DISSIMILARITY
C     UPDATED         --AUGUST    2017. KENDALL TAU DISSIMILARITY
C     UPDATED         --AUGUST    2017. BINARY MATCH DISSIMILARITY
C     UPDATED         --AUGUST    2017. BINARY MATCH SIMILARITY
C     UPDATED         --AUGUST    2017. BINARY ROGERS DISSIMILARITY
C     UPDATED         --AUGUST    2017. BINARY ROGERS SIMILARITY
C     UPDATED         --AUGUST    2017. BINARY SOKAL DISSIMILARITY
C     UPDATED         --AUGUST    2017. BINARY SOKAL SIMILARITY
C     UPDATED         --AUGUST    2017. BINARY JACCARD DISSIMILARITY
C     UPDATED         --AUGUST    2017. BINARY JACCARD SIMILARITY
C     UPDATED         --AUGUST    2017. BINARY ASYMMETRIC DICE DISSIMILARITY
C     UPDATED         --AUGUST    2017. BINARY ASYMMETRIC DICE SIMILARITY
C     UPDATED         --AUGUST    2017. BINARY ASYMMETRIC SOKAL DISSIMILARITY
C     UPDATED         --AUGUST    2017. BINARY ASYMMETRIC SOKAL SIMILARITY
C     UPDATED         --AUGUST    2017. GENERALZIED JACCARD COEFFICIENT
C     UPDATED         --AUGUST    2017. GENERALZIED JACCARD DISTANCE
C     UPDATED         --NOVEMBER  2017. DIFF OF BINO PROP LOWER CONF LIMIT
C     UPDATED         --NOVEMBER  2017. DIFF OF BINO PROP UPPER CONF LIMIT
C     UPDATED         --NOVEMBER  2017. COEFFICIENT OF DISPERSION
C                                       CONFIDENCE LIMITS
C     UPDATED         --DECEMBER  2017. COEFFICIENT OF QUARTILE DISPERSION
C                                       CONFIDENCE LIMITS
C     UPDATED         --JULY      2018. WEIGHTED COVARIANCE
C     UPDATED         --JULY      2018. WEIGHTED CORRELATION
C     UPDATED         --AUGUST    2018. PEARSON DISTANCE AS SYNONYM FOR
C                                       PEARSON DISSIMILARITY
C     UPDATED         --AUGUST    2018. HAMMING DISTANCE
C     UPDATED         --AUGUST    2018. WEIGHTED COSINE DISTANCE
C     UPDATED         --AUGUST    2018. CANBERRA DISTANCE
C     UPDATED         --OCTOBER   2018. INTERVAL COUNT SIMILARITY
C     UPDATED         --OCTOBER   2018. PEARSON SIMILARITY
C     UPDATED         --OCTOBER   2018. WEIGHTED COSINE SIMILARITY
C     UPDATED         --NOVEMBER  2018. GROUPED CORRELATION
C     UPDATED         --JANUARY   2019. PYTHON MEAN
C     UPDATED         --JULY      2019. LOWER SEMI-INTERQUARTILE RANGE
C     UPDATED         --JULY      2019. UPPER SEMI-INTERQUARTILE RANGE
C     UPDATED         --AUGUST    2019. GAMMA CORRELATION COEFFICIENT AS
C                                       SYNONYM FOR KENDALL'S TAU
C     UPDATED         --AUGUST    2019. BINARY GAMMA COEFFICIENT AS
C                                       SYNONYM FOR YULE'S Q
C     UPDATED         --AUGUST    2019. KENDALL TAU A
C     UPDATED         --AUGUST    2019. KENDALL TAU B
C     UPDATED         --AUGUST    2019. KENDALL TAU C
C     UPDATED         --AUGUST    2019. YULES Y
C     UPDATED         --SEPTEMBER 2019. RATIO OF MEANS
C     UPDATED         --SEPTEMBER 2019. RATIO OF MEANS LOWER CONFIDENCE
C                                       LIMIT
C     UPDATED         --SEPTEMBER 2019. RATIO OF MEANS UPPER CONFIDENCE
C                                       LIMIT
C     UPDATED         --OCTOBER   2019. DAVID TEST, DAVID TEST CDF
C     UPDATED         --OCTOBER   2019. DAVID TEST PVALUE
C     UPDATED         --OCTOBER   2019. DAVID TEST MINIMUM INDEX
C     UPDATED         --OCTOBER   2019. DAVID TEST MAXIMUM INDEX
C     UPDATED         --OCTOBER   2019. SKEW OUTLIER TEST
C     UPDATED         --OCTOBER   2019. SKEW OUTLIER CDF
C     UPDATED         --OCTOBER   2019. SKEW OUTLIER CRITICAL VALUE
C     UPDATED         --OCTOBER   2019. SKEW OUTLIER INDEX
C     UPDATED         --OCTOBER   2019. SKEW OUTLIER PVALUE
C     UPDATED         --OCTOBER   2019. KURTOSIS OUTLIER TEST
C     UPDATED         --OCTOBER   2019. KURTOSIS OUTLIER CDF
C     UPDATED         --OCTOBER   2019. KURTOSIS OUTLIER CRITICAL VALUE
C     UPDATED         --OCTOBER   2019. KURTOSIS OUTLIER INDEX
C     UPDATED         --OCTOBER   2019. KURTOSIS OUTLIER PVALUE
C     UPDATED         --MARCH     2021. SHANNON ENTROPY
C     UPDATED         --MARCH     2021. SHANNON ENTROPY MEAN
C     UPDATED         --MARCH     2021. SHANNON ENTROPY STANDARD
C                                       DEVIATION
C     UPDATED         --MARCH     2021. SHANNON ENTROPY VARIANCE
C     UPDATED         --APRIL     2023. LINEAR POOL
C     UPDATED         --APRIL     2023. LINEAR POOL STANDARD ERROR
C     UPDATED         --APRIL     2023. SUMMARY LINEAR POOL
C     UPDATED         --APRIL     2023. SUMMARY LINEAR POOL STANDARD ERROR
C     UPDATED         --JUNE      2023. SIEGEL TUKEY TEST
C     UPDATED         --JUNE      2023. RATIO OF SD LOWER CONFIDENCE LIMIT
C     UPDATED         --JUNE      2023. RATIO OF SD UPPER CONFIDENCE LIMIT
C     UPDATED         --JUNE      2023. RATIO OF VARIANCE LOWER CONFIDENCE LIMIT
C     UPDATED         --JUNE      2023. RATIO OF VARIANCE UPPER CONFIDENCE LIMIT
C     UPDATED         --JULY      2023. GINI MEAN DIFFERENCE
C     UPDATED         --JULY      2023. GINI MEAN DIFFERENCE LOG RATIO
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      REAL ARG(*)
C
      CHARACTER*4 ICOM
      CHARACTER*4 ICOM2
      CHARACTER*4 IHARG(*)
      CHARACTER*4 IHARG2(*)
      CHARACTER*4 IARGT(*)
      CHARACTER*4 ISUBRO
      CHARACTER*4 IBUGG3
      CHARACTER*4 IERROR
C
      CHARACTER*4  ISTACS
      CHARACTER*4  ISTADF
      CHARACTER*60 ISTANM
      CHARACTER*4  IFOUND
C
      CHARACTER*4 IWRITE
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
C
C---------------------------------------------------------------------
C
      INCLUDE 'DPCOPA.INC'
CCCCC INCLUDE 'DPCOZC.INC'
C
      PARAMETER (MAXSTA=1586)
      PARAMETER (MAXSCL=8)
      INTEGER      INFLAV(MAXSTA)
      CHARACTER*4  INAME(MAXSTA,MAXSCL)
      CHARACTER*4  INCASE(MAXSTA)
      CHARACTER*60 INLONG(MAXSTA)
      CHARACTER*4  INTEMP(MAXSCL)
CCCCC EQUIVALENCE (CGARBG(1),INLONG(1))
C
      CHARACTER*4 IPNAM1
      CHARACTER*4 IPNAM2
      COMMON/STATIS/APVAL,IPNAM1,IPNAM2
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOSB.INC'
      INCLUDE 'DPCOP2.INC'
C
C     CREATE TABLE OF STATISTIC NAMES.
C
C       1) INCASE      = 4-CHARACTER CODE FOR STATISTIC
C       2) INAME       = MATCHING ENTRIES FOR STATISTIC.  NOTE
C                        THAT FIRST TWO ENTRIES ARE CHARACTERS
C                        1 - 4 AND 5 - 8, RESPECTIVELY.  THIS IS
C                        TO ACCOMODATE POTENTIAL NAME CONFLICTS
C                        (E.G., AUTOCORRELATION/AUTOCOVARIANCE).
C                        REMAINING ENTRIES ARE CHARACTERS 1 - 4
C                        OF SUBSEQUENT ARGUMENTS.
C        3) INFLAV     = NUMBER OF RESPONSE VARIABLES.
C        4) INLONG     = DESCRIPTIVE NAME FOR STATISTIC.
C                
      DATA INCASE(1)/'NCDI'/
      DATA (INAME(1,J),J=1,MAXSCL)/
     1'NUMB','    ','OF  ','COMM','DIGI','    ','    ','    '/
      DATA INFLAV(1)/1/
      DATA INLONG(1)/'NUMBER'/
C
      DATA INCASE(2)/'NUMB'/
      DATA (INAME(2,J),J=1,MAXSCL)/
     1 'SIZE','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(2)/1/
      DATA INLONG(2)/'NUMBER'/
C
      DATA INCASE(3)/'NUMB'/
      DATA (INAME(3,J),J=1,MAXSCL)/
     1'COUN','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(3)/1/
      DATA INLONG(3)/'NUMB'/
C
      DATA INCASE(4)/'NUMB'/
      DATA (INAME(4,J),J=1,MAXSCL)/
     1'SAMP','    ','SIZE','    ','    ','    ','    ','    '/
      DATA INFLAV(4)/1/
      DATA INLONG(4)/'NUMBER'/
C
      DATA INCASE(5)/'NUMB'/
      DATA (INAME(5,J),J=1,MAXSCL)/
     1'SUBS','    ','SIZE','    ','    ','    ','    ','    '/
      DATA INFLAV(5)/1/
      DATA INLONG(5)/'NUMBER'/
C
      DATA INCASE(6)/'SSQM'/
      DATA (INAME(6,J),J=1,MAXSCL)/
     1'SUM ','    ','OF  ','SQUA','FROM','MEAN','    ','    '/
      DATA INFLAV(6)/1/
      DATA INLONG(6)/'SUM OF SQUARES FROM MEAN'/
C
      DATA INCASE(7)/'PROD'/
      DATA (INAME(7,J),J=1,MAXSCL)/
     1'PROD','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(7)/1/
      DATA INLONG(7)/'PRODUCT'/
C
      DATA INCASE(8)/'MIDR'/
      DATA (INAME(8,J),J=1,MAXSCL)/
     1'MIDR','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(8)/1/
      DATA INLONG(8)/'MID-RANGE'/
C
      DATA INCASE(9)/'WEME'/
      DATA (INAME(9,J),J=1,MAXSCL)/
     1'WEIG','    ','MEAN','    ','    ','    ','    ','    '/
      DATA INFLAV(9)/2/
      DATA INLONG(9)/'WEIGHTED MEAN'/
C
      DATA INCASE(10)/'MADR'/
      DATA (INAME(10,J),J=1,MAXSCL)/
     1'MAD ','    ','TO  ','MEDI','    ','    ','    ','    '/
      DATA INFLAV(10)/1/
      DATA INLONG(10)
     1 /'MAD TO MEDIAN'/
C
      DATA INCASE(11)/'AADM'/
      DATA (INAME(11,J),J=1,MAXSCL)/
     1'AVER','    ','ABSO','DEVI','FROM','THE ','MEDI','    '/
      DATA INFLAV(11)/1/
      DATA INLONG(11)/'AVERAGE ABSOLUTE DEVIATION FROM THE MEDIAN'/
C
      DATA INCASE(12)/'AAD '/
      DATA (INAME(12,J),J=1,MAXSCL)/
     1'AVER','    ','ABSO','DEVI','    ','    ','    ','    '/
      DATA INFLAV(12)/1/
      DATA INLONG(12)/'AVERAGE ABSOLUTE DEVIATION'/
C
      DATA INCASE(13)/'MIDM'/
      DATA (INAME(13,J),J=1,MAXSCL)/
     1'MIDM','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(13)/1/
      DATA INLONG(13)/'MID-MEAN'/
C
      DATA INCASE(15)/'MAD '/
      DATA (INAME(15,J),J=1,MAXSCL)/
     1'MAD ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(15)/1/
      DATA INLONG(15)/'MEDIAN ABSOLUTE DEVIATION'/
C
      DATA INCASE(16)/'MAD '/
      DATA (INAME(16,J),J=1,MAXSCL)/
     1'MEDI','    ','ABSO','DEVI','    ','    ','    ','    '/
      DATA INFLAV(16)/1/
      DATA INLONG(16)/'MEDIAN ABSOLUTE DEVIATION'/
C
      DATA INCASE(17)/'WEMD'/
      DATA (INAME(17,J),J=1,MAXSCL)/
     1'WEIG','    ','MEDI','    ','    ','    ','    ','    '/
      DATA INFLAV(17)/2/
      DATA INLONG(17)/'WEIGHTED MEDIAN'/
C
      DATA INCASE(18)/'TMSE'/
      DATA (INAME(18,J),J=1,MAXSCL)/
     1'TRIM','    ','MEAN','STAN','ERRO','    ','    ','    '/
      DATA INFLAV(18)/1/
      DATA INLONG(18)/'TRIMMED MEAN STANDARD ERROR'/
C
      DATA INCASE(19)/'WINM'/
      DATA (INAME(19,J),J=1,MAXSCL)/
     1'WINS','    ','MEAN','    ','    ','    ','    ','    '/
      DATA INFLAV(19)/1/
      DATA INLONG(19)/'WINSORIZED MEAN'/
C
      DATA INCASE(20)/'WINM'/
      DATA (INAME(20,J),J=1,MAXSCL)/
     1'WIND','    ','MEAN','    ','    ','    ','    ','    '/
      DATA INFLAV(20)/1/
      DATA INLONG(20)/'WINSORIZED MEAN'/
C
      DATA INCASE(21)/'RANG'/
      DATA (INAME(21,J),J=1,MAXSCL)/
     1'RANG','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(21)/1/
      DATA INLONG(21)/'RANGE'/
C
      DATA INCASE(22)/'RANG'/
      DATA (INAME(22,J),J=1,MAXSCL)/
     1'R   ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(22)/1/
      DATA INLONG(22)/'RANGE'/
C
      DATA INCASE(23)/'G1LO'/
      DATA (INAME(23,J),J=1,MAXSCL)/
     1'MINI','    ','GUMB','PPCC','LOCA','    ','    ','    '/
      DATA INFLAV(23)/1/
      DATA INLONG(23)/'MINIMUM GUMBEL PPCC LOCATION'/
C
      DATA INCASE(24)/'G2LO'/
      DATA (INAME(24,J),J=1,MAXSCL)/
     1'MAXI','    ','GUMB','PPCC','LOCA','    ','    ','    '/
      DATA INFLAV(24)/1/
      DATA INLONG(24)/'MAXIMUM GUMBEL PPCC LOCATION'/
C
      DATA INCASE(25)/'ESD '/
      DATA (INAME(25,J),J=1,MAXSCL)/
     1'EXTR','    ','STUD','DEVI','TEST','STAT','    ','    '/
      DATA INFLAV(25)/1/
      DATA INLONG(25)/'EXTREME STUDENTIZED DEVIATE TEST STATISTIC'/
C
      DATA INCASE(26)/'VM  '/
      DATA (INAME(26,J),J=1,MAXSCL)/
     1'VARI','    ','OF  ','THE ','MEAN','    ','    ','    '/
      DATA INFLAV(26)/1/
      DATA INLONG(26)/'VARIANCE OF THE MEAN'/
C
      DATA INCASE(27)/'VM  '/
      DATA (INAME(27,J),J=1,MAXSCL)/
     1'VARI','    ','OF  ','MEAN','    ','    ','    ','    '/
      DATA INFLAV(27)/1/
      DATA INLONG(27)/'VARIANCE OF THE MEAN'/
C
      DATA INCASE(28)/'VM  '/
      DATA (INAME(28,J),J=1,MAXSCL)/
     1'VARI','    ','MEAN','    ','    ','    ','    ','    '/
      DATA INFLAV(28)/1/
      DATA INLONG(28)/'VARIANCE OF THE MEAN'/
C
      DATA INCASE(29)/'LPVA'/
      DATA (INAME(29,J),J=1,MAXSCL)/
     1'VARI','    ','LP  ','LOCA','    ','    ','    ','    '/
      DATA INFLAV(29)/1/
      DATA INLONG(29)/'VARIANCE OF LP LOCATION'/
C
      DATA INCASE(30)/'SDME'/
      DATA (INAME(30,J),J=1,MAXSCL)/
     1'STAN','    ','DEVI','OF  ','THE ','MEAN','    ','    '/
      DATA INFLAV(30)/1/
      DATA INLONG(30)/'STANDARD DEVIATION OF THE MEAN'/
C
      DATA INCASE(31)/'SDME'/
      DATA (INAME(31,J),J=1,MAXSCL)/
     1'STAN','    ','DEVI','OF  ','MEAN','    ','    ','    '/
      DATA INFLAV(31)/1/
      DATA INLONG(31)/'STANDARD DEVIATION OF THE MEAN'/
C
      DATA INCASE(32)/'SDME'/
      DATA (INAME(32,J),J=1,MAXSCL)/
     1'STAN','    ','DEVI','MEAN','    ','    ','    ','    '/
      DATA INFLAV(32)/1/
      DATA INLONG(32)/'STANDARD DEVIATION OF THE MEAN'/
C
      DATA INCASE(33)/'SDME'/
      DATA (INAME(33,J),J=1,MAXSCL)/
     1'SD  ','    ','OF  ','THE ','MEAN','    ','    ','    '/
      DATA INFLAV(33)/1/
      DATA INLONG(33)/'STANDARD DEVIATION OF THE MEAN'/
C
      DATA INCASE(34)/'SDME'/
      DATA (INAME(34,J),J=1,MAXSCL)/
     1'SD  ','    ','OF  ','MEAN','    ','    ','    ','    '/
      DATA INFLAV(34)/1/
      DATA INLONG(34)/'STANDARD DEVIATION OF THE MEAN'/
C
      DATA INCASE(35)/'SDME'/
      DATA (INAME(35,J),J=1,MAXSCL)/
     1'SD  ','    ','MEAN','    ','    ','    ','    ','    '/
      DATA INFLAV(35)/1/
      DATA INLONG(35)/'STANDARD DEVIATION OF THE MEAN'/
C
      DATA INCASE(36)/'RESD'/
      DATA (INAME(36,J),J=1,MAXSCL)/
     1'RS  ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(36)/1/
      DATA INLONG(36)/'RELATIVE STANDARD DEVIATION'/
C
      DATA INCASE(37)/'RESD'/
      DATA (INAME(37,J),J=1,MAXSCL)/
     1'RSD ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(37)/1/
      DATA INLONG(37)/'RELATIVE STANDARD DEVIATION'/
C
      DATA INCASE(38)/'RESD'/
      DATA (INAME(38,J),J=1,MAXSCL)/
     1'RELS','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(38)/1/
      DATA INLONG(38)/'RELATIVE STANDARD DEVIATION'/
C
      DATA INCASE(39)/'RESD'/
      DATA (INAME(39,J),J=1,MAXSCL)/
     1'RELA','    ','STAN','DEVI','    ','    ','    ','    '/
      DATA INFLAV(39)/1/
      DATA INLONG(39)/'RELATIVE STANDARD DEVIATION'/
C
      DATA INCASE(40)/'RESD'/
      DATA (INAME(40,J),J=1,MAXSCL)/
     1'RELA','    ','SD  ','    ','    ','    ','    ','    '/
      DATA INFLAV(40)/1/
      DATA INLONG(40)/'RELATIVE STANDARD DEVIATION'/
C
      DATA INCASE(41)/'REVA'/
      DATA (INAME(41,J),J=1,MAXSCL)/
     1'RELA','    ','VARI','    ','    ','    ','    ','    '/
      DATA INFLAV(41)/1/
      DATA INLONG(41)/'RELATIVE VARIANCE'/
C
      DATA INCASE(42)/'REVA'/
      DATA (INAME(42,J),J=1,MAXSCL)/
     1'RV  ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(42)/1/
      DATA INLONG(42)/'RELATIVE VARIANCE'/
C
      DATA INCASE(43)/'REVA'/
      DATA (INAME(43,J),J=1,MAXSCL)/
     1'RELV','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(43)/1/
      DATA INLONG(43)/'RELATIVE VARIANCE'/
C
      DATA INCASE(44)/'REVA'/
      DATA (INAME(44,J),J=1,MAXSCL)/
     1'RVAR','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(44)/1/
      DATA INLONG(44)/'RELATIVE VARIANCE'/
C
      DATA INCASE(45)/'CVAR'/
      DATA (INAME(45,J),J=1,MAXSCL)/
     1'COEF','    ','VARI','    ','    ','    ','    ','    '/
      DATA INFLAV(45)/1/
      DATA INLONG(45)/'COEFFCIENT OF VARIATION'/
C
      DATA INCASE(46)/'CVAR'/
      DATA (INAME(46,J),J=1,MAXSCL)/
     1'COEF','    ','OF  ','VARI','    ','    ','    ','    '/
      DATA INFLAV(46)/1/
      DATA INLONG(46)/'COEFFCIENT OF VARIATION'/
C
      DATA INCASE(47)/'LOWQ'/
      DATA (INAME(47,J),J=1,MAXSCL)/
     1'LOWE','    ','QUAR','    ','    ','    ','    ','    '/
      DATA INFLAV(47)/1/
      DATA INLONG(47)/'LOWER QUARTILE'/
C
      DATA INCASE(48)/'LOWQ'/
      DATA (INAME(48,J),J=1,MAXSCL)/
     1'FIRS','    ','QUAR','    ','    ','    ','    ','    '/
      DATA INFLAV(48)/1/
      DATA INLONG(48)/'LOWER QUARTILE'/
C
      DATA INCASE(49)/'MIDQ'/
      DATA (INAME(49,J),J=1,MAXSCL)/
     1'SECO','    ','QUAR','    ','    ','    ','    ','    '/
      DATA INFLAV(49)/1/
      DATA INLONG(49)/'MEDIAN'/
C
      DATA INCASE(50)/'UPPQ'/
      DATA (INAME(50,J),J=1,MAXSCL)/
     1'THIR','    ','QUAR','    ','    ','    ','    ','    '/
      DATA INFLAV(50)/1/
      DATA INLONG(50)/'UPPER QUARTILE'/
C
      DATA INCASE(51)/'UPPQ'/
      DATA (INAME(51,J),J=1,MAXSCL)/
     1'UPPE','    ','QUAR','    ','    ','    ','    ','    '/
      DATA INFLAV(51)/1/
      DATA INLONG(51)/'UPPER QUARTILE'/
C
      DATA INCASE(52)/'UPPH'/
      DATA (INAME(52,J),J=1,MAXSCL)/
     1'UPPE','    ','HING','    ','    ','    ','    ','    '/
      DATA INFLAV(52)/1/
      DATA INLONG(52)/'UPPER HINGE'/
C
      DATA INCASE(53)/'LOWH'/
      DATA (INAME(53,J),J=1,MAXSCL)/
     1'LOWE','    ','HING','    ','    ','    ','    ','    '/
      DATA INFLAV(53)/1/
      DATA INLONG(53)/'LOWER HINGE'/
C
      DATA INCASE(54)/'SKEW'/
      DATA (INAME(54,J),J=1,MAXSCL)/
     1'STAN','    ','THIR','CENT','MOME','    ','    ','    '/
      DATA INFLAV(54)/1/
      DATA INLONG(54)/'SKEWNESS'/
C
      DATA INCASE(55)/'SKEW'/
      DATA (INAME(55,J),J=1,MAXSCL)/
     1'STAN','    ','3RD ','CENT','MOME','    ','    ','    '/
      DATA INFLAV(55)/1/
      DATA INLONG(55)/'SKEWNESS'/
C
      DATA INCASE(56)/'SOPV'/
      DATA (INAME(56,J),J=1,MAXSCL)/
     1'SKEW','    ','OUTL','TEST','PVAL','    ','    ','    '/
      DATA INFLAV(56)/1/
      DATA INLONG(56)/'SKEWNESS OUTLIER TEST PVALUE'/
C
      DATA INCASE(57)/'KURT'/
      DATA (INAME(57,J),J=1,MAXSCL)/
     1'STAN','    ','FOUR','CENT','MOME','    ','    ','    '/
      DATA INFLAV(57)/1/
      DATA INLONG(57)/'KURTOSIS'/
C
      DATA INCASE(58)/'KURT'/
      DATA (INAME(58,J),J=1,MAXSCL)/
     1'STAN','    ','4TH ','CENT','MOME','    ','    ','    '/
      DATA INFLAV(58)/1/
      DATA INLONG(58)/'KURTOSIS'/
C
      DATA INCASE(59)/'KOPV'/
      DATA (INAME(59,J),J=1,MAXSCL)/
     1'KURT','    ','OUTL','TEST','PVAL','    ','    ','    '/
      DATA INFLAV(59)/1/
      DATA INLONG(59)/'KURTOSIS OUTLIER TEST PVALUE'/
C
      DATA INCASE(60)/'AUCV'/
      DATA (INAME(60,J),J=1,MAXSCL)/
     1'AUTO','COVA','STAT','    ','    ','    ','    ','    '/
      DATA INFLAV(60)/1/
      DATA INLONG(60)/'AUTOCOVARIANCE'/
C
      DATA INCASE(61)/'AUCR'/
      DATA (INAME(61,J),J=1,MAXSCL)/
     1'AUTO','CORR','STAT','    ','    ','    ','    ','    '/
      DATA INFLAV(61)/1/
      DATA INLONG(61)/'AUTOCORRELATION'/
C
      DATA INCASE(62)/'RACV'/
      DATA (INAME(62,J),J=1,MAXSCL)/
     1'RANK','    ','COVA','    ','    ','    ','    ','    '/
      DATA INFLAV(62)/2/
      DATA INLONG(62)/'RANK COVARIANCE'/
C
      DATA INCASE(63)/'RACA'/
      DATA (INAME(63,J),J=1,MAXSCL)/
     1'RANK','    ','CORR','ABSO','VALU','    ','    ','    '/
      DATA INFLAV(63)/2/
      DATA INLONG(63)/'RANK CORRELATION ABSOLUTE VALUE'/
C
      DATA INCASE(64)/'KTAA'/
      DATA (INAME(64,J),J=1,MAXSCL)/
     1'KEND','    ','TAU ','ABSO','VALU','    ','    ','    '/
      DATA INFLAV(64)/2/
      DATA INLONG(64)/'KENDALLS TAU ABSOLUTE VALUE'/
C
      DATA INCASE(65)/'1DEC'/
      DATA (INAME(65,J),J=1,MAXSCL)/
     1'FIRS','    ','DECI','    ','    ','    ','    ','    '/
      DATA INFLAV(65)/1/
      DATA INLONG(65)/'FIRST DECILE'/
C
      DATA INCASE(66)/'2DEC'/
      DATA (INAME(66,J),J=1,MAXSCL)/
     1'SECO','    ','DECI','    ','    ','    ','    ','    '/
      DATA INFLAV(66)/1/
      DATA INLONG(66)/'SECOND DECILE'/
C
      DATA INCASE(67)/'3DEC'/
      DATA (INAME(67,J),J=1,MAXSCL)/
     1'THIR','    ','DECI','    ','    ','    ','    ','    '/
      DATA INFLAV(67)/1/
      DATA INLONG(67)/'THIRD DECILE'/
C
      DATA INCASE(68)/'4DEC'/
      DATA (INAME(68,J),J=1,MAXSCL)/
     1'FOUR','    ','DECI','    ','    ','    ','    ','    '/
      DATA INFLAV(68)/1/
      DATA INLONG(68)/'FOURTH DECILE'/
C
      DATA INCASE(69)/'5DEC'/
      DATA (INAME(69,J),J=1,MAXSCL)/
     1'FIFT','    ','DECI','    ','    ','    ','    ','    '/
      DATA INFLAV(69)/1/
      DATA INLONG(69)/'FIFTH DECILE'/
C
      DATA INCASE(70)/'6DEC'/
      DATA (INAME(70,J),J=1,MAXSCL)/
     1'SIXT','    ','DECI','    ','    ','    ','    ','    '/
      DATA INFLAV(70)/1/
      DATA INLONG(70)/'SIXTH DECILE'/
C
      DATA INCASE(71)/'7DEC'/
      DATA (INAME(71,J),J=1,MAXSCL)/
     1'SEVE','    ','DECI','    ','    ','    ','    ','    '/
      DATA INFLAV(71)/1/
      DATA INLONG(71)/'SEVENTH DECILE'/
C
      DATA INCASE(72)/'8DEC'/
      DATA (INAME(72,J),J=1,MAXSCL)/
     1'EIGH','    ','DECI','    ','    ','    ','    ','    '/
      DATA INFLAV(72)/1/
      DATA INLONG(72)/'EIGTH DECILE'/
C
      DATA INCASE(73)/'9DEC'/
      DATA (INAME(73,J),J=1,MAXSCL)/
     1'NINT','    ','DECI','    ','    ','    ','    ','    '/
      DATA INFLAV(73)/1/
      DATA INLONG(73)/'NINTH DECILE'/
C
      DATA INCASE(74)/'DPBN'/
      DATA (INAME(74,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','PERC','BEND','MIDV','    ','    '/
      DATA INFLAV(74)/2/
      DATA INLONG(74)/'DIFFERENCE OF PERCENTAGE BEND MIDVARIANCES'/
C
      DATA INCASE(75)/'SIFR'/
      DATA (INAME(75,J),J=1,MAXSCL)/
     1'SIN ','    ','FREQ','    ','    ','    ','    ','    '/
      DATA INFLAV(75)/1/
      DATA INLONG(75)/'SIN FREQUENCY'/
C
      DATA INCASE(76)/'SIFR'/
      DATA (INAME(76,J),J=1,MAXSCL)/
     1'SINE','    ','FREQ','    ','    ','    ','    ','    '/
      DATA INFLAV(76)/1/
      DATA INLONG(76)/'SIN FREQUENCY'/
C
      DATA INCASE(77)/'SIAM'/
      DATA (INAME(77,J),J=1,MAXSCL)/
     1'SIN ','    ','AMPL','    ','    ','    ','    ','    '/
      DATA INFLAV(77)/1/
      DATA INLONG(77)/'SIN AMPLITUDE'/
C
      DATA INCASE(78)/'SIAM'/
      DATA (INAME(78,J),J=1,MAXSCL)/
     1'SINE','    ','AMPL','    ','    ','    ','    ','    '/
      DATA INFLAV(78)/2/
      DATA INLONG(78)/'SIN AMPLITUDE'/
C
      DATA INCASE(79)/'LIIS'/
      DATA (INAME(79,J),J=1,MAXSCL)/
     1'LINE','    ','INTE','STAN','DEVI','    ','    ','    '/
      DATA INFLAV(79)/2/
      DATA INLONG(79)/'LINEAR INTERCEPT STANDARD DEVIATION'/
C
      DATA INCASE(80)/'LISS'/
      DATA (INAME(80,J),J=1,MAXSCL)/
     1'LINE','    ','SLOP','STAN','DEVI','    ','    ','    '/
      DATA INFLAV(80)/2/
      DATA INLONG(80)/'LINEAR SLOPE STANDARD DEVIATION'/
C
      DATA INCASE(81)/'LIRE'/
      DATA (INAME(81,J),J=1,MAXSCL)/
     1'LINE','    ','RESS','    ','    ','    ','    ','    '/
      DATA INFLAV(81)/2/
      DATA INLONG(81)/'LINEAR RESIDUAL SD'/
C
      DATA INCASE(82)/'LIRE'/
      DATA (INAME(82,J),J=1,MAXSCL)/
     1'LINE','    ','RESI','SD  ','    ','    ','    ','    '/
      DATA INFLAV(82)/2/
      DATA INLONG(82)/'LINEAR RESIDUAL SD'/
C
      DATA INCASE(83)/'LIRE'/
      DATA (INAME(83,J),J=1,MAXSCL)/
     1'LINE','    ','RESI','STAN','DEVI','    ','    ','    '/
      DATA INFLAV(83)/2/
      DATA INLONG(83)/'LINEAR RESIDUAL SD'/
C
      DATA INCASE(84)/'LICO'/
      DATA (INAME(84,J),J=1,MAXSCL)/
     1'LINE','    ','CORR','    ','    ','    ','    ','    '/
      DATA INFLAV(84)/2/
      DATA INLONG(84)/'LINEAR CORRELATION'/
C
      DATA INCASE(85)/'SNSC'/
      DATA (INAME(85,J),J=1,MAXSCL)/
     1'SN  ','    ','SCAL','    ','    ','    ','    ','    '/
      DATA INFLAV(85)/1/
      DATA INLONG(85)/'SN SCALE'/
C
      DATA INCASE(86)/'QNSC'/
      DATA (INAME(86,J),J=1,MAXSCL)/
     1'QN  ','    ','SCAL','    ','    ','    ','    ','    '/
      DATA INFLAV(86)/1/
      DATA INLONG(86)/'QN SCALE'/
C
      DATA INCASE(87)/'SN0 '/
      DATA (INAME(87,J),J=1,MAXSCL)/
     1'TAGU','   ','SN  ','    ','    ','    ','    ','    '/
      DATA INFLAV(87)/1/
      DATA INLONG(87)/'TAGUCHI SN'/
C
      DATA INCASE(88)/'SN0 '/
      DATA (INAME(88,J),J=1,MAXSCL)/
     1'TAGU','    ','SN0 ','    ','    ','    ','    ','    '/
      DATA INFLAV(88)/1/
      DATA INLONG(88)/'TAGUCHI SN0'/
C
      DATA INCASE(89)/'SN0 '/
      DATA (INAME(89,J),J=1,MAXSCL)/
     1'TAGU','    ','SNT ','    ','    ','    ','    ','    '/
      DATA INFLAV(89)/1/
      DATA INLONG(89)/'TAGUCHI SN0'/
C
      DATA INCASE(90)/'SN0 '/
      DATA (INAME(90,J),J=1,MAXSCL)/
     1'TAGU','    ','SNN ','    ','    ','    ','    ','    '/
      DATA INFLAV(90)/1/
      DATA INLONG(90)/'TAGUCHI SN0'/
C
      DATA INCASE(91)/'SN0 '/
      DATA (INAME(91,J),J=1,MAXSCL)/
     1'TAGU','    ','SNT1','    ','    ','    ','    ','    '/
      DATA INFLAV(91)/1/
      DATA INLONG(91)/'TAGUCHI SN0'/
C
      DATA INCASE(92)/'SN0 '/
      DATA (INAME(92,J),J=1,MAXSCL)/
     1'TAGU','    ','SNN1','    ','    ','    ','    ','    '/
      DATA INFLAV(92)/1/
      DATA INLONG(92)/'TAGUCHI SN0'/
C
      DATA INCASE(93)/'SN0 '/
      DATA (INAME(93,J),J=1,MAXSCL)/
     1'TAGU','    ','SN1 ','    ','    ','    ','    ','    '/
      DATA INFLAV(93)/1/
      DATA INLONG(93)/'TAGUCHI SN0'/
C
      DATA INCASE(94)/'SN+ '/
      DATA (INAME(94,J),J=1,MAXSCL)/
     1'TAGU','    ','SNL ','    ','    ','    ','    ','    '/
      DATA INFLAV(94)/1/
      DATA INLONG(94)/'TAGUCHI SN+'/
C
      DATA INCASE(95)/'SN+ '/
      DATA (INAME(95,J),J=1,MAXSCL)/
     1'TAGU','    ','SNB ','    ','    ','    ','    ','    '/
      DATA INFLAV(95)/1/
      DATA INLONG(95)/'TAGUCHI SN+'/
C
      DATA INCASE(96)/'SN+ '/
      DATA (INAME(96,J),J=1,MAXSCL)/
     1'TAGU','    ','SN+ ','    ','    ','    ','    ','    '/
      DATA INFLAV(96)/1/
      DATA INLONG(96)/'TAGUCHI SN+'/
C
      DATA INCASE(97)/'SN- '/
      DATA (INAME(97,J),J=1,MAXSCL)/
     1'TAGU','    ','SNS ','    ','    ','    ','    ','    '/
      DATA INFLAV(97)/1/
      DATA INLONG(97)/'TAGUCHI SN-'/
C
      DATA INCASE(98)/'SN- '/
      DATA (INAME(98,J),J=1,MAXSCL)/
     1'TAGU','    ','SN- ','    ','    ','    ','    ','    '/
      DATA INFLAV(98)/1/
      DATA INLONG(98)/'TAGUCHI SN-'/
C
      DATA INCASE(99)/'SN00'/
      DATA (INAME(99,J),J=1,MAXSCL)/
     1'TAGU','    ','SN2 ','    ','    ','    ','    ','    '/
      DATA INFLAV(99)/1/
      DATA INLONG(99)/'TAGUCHI SN00'/
C
      DATA INCASE(100)/'SN00'/
      DATA (INAME(100,J),J=1,MAXSCL)/
     1'TAGU','    ','SNT2','    ','    ','    ','    ','    '/
      DATA INFLAV(100)/1/
      DATA INLONG(100)/'TAGUCHI SN00'/
C
      DATA INCASE(101)/'SN00'/
      DATA (INAME(101,J),J=1,MAXSCL)/
     1'TAGU','    ','SNN2','    ','    ','    ','    ','    '/
      DATA INFLAV(101)/1/
      DATA INLONG(101)/'TAGUCHI SN00'/
C
      DATA INCASE(102)/'SN00'/
      DATA (INAME(102,J),J=1,MAXSCL)/
     1'TAGU','    ','SN00','    ','    ','    ','    ','    '/
      DATA INFLAV(102)/1/
      DATA INLONG(102)/'TAGUCHI SN00'/
C
      DATA INCASE(103)/'SN0 '/
      DATA (INAME(103,J),J=1,MAXSCL)/
     1'SN0 ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(103)/1/
      DATA INLONG(103)/'TAGUCHI SN0'/
C
      DATA INCASE(104)/'SN0 '/
      DATA (INAME(104,J),J=1,MAXSCL)/
     1'SN  ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(104)/1/
      DATA INLONG(104)/'TAGUCHI SN0'/
C
      DATA INCASE(105)/'SN0 '/
      DATA (INAME(105,J),J=1,MAXSCL)/
     1'SNT ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(105)/1/
      DATA INLONG(105)/'TAGUCHI SN0'/
C
      DATA INCASE(106)/'SN0 '/
      DATA (INAME(106,J),J=1,MAXSCL)/
     1'SNN ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(106)/1/
      DATA INLONG(106)/'TAGUCHI SN0'/
C
      DATA INCASE(107)/'SN0 '/
      DATA (INAME(107,J),J=1,MAXSCL)/
     1'SNT1','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(107)/1/
      DATA INLONG(107)/'TAGUCHI SN0'/
C
      DATA INCASE(108)/'SN0 '/
      DATA (INAME(108,J),J=1,MAXSCL)/
     1'SNN1','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(108)/1/
      DATA INLONG(108)/'TAGUCHI SN0'/
C
      DATA INCASE(109)/'SN0 '/
      DATA (INAME(109,J),J=1,MAXSCL)/
     1'SNN1','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(109)/1/
      DATA INLONG(109)/'TAGUCHI SN0'/
C
      DATA INCASE(110)/'SN0 '/
      DATA (INAME(110,J),J=1,MAXSCL)/
     1'SN1 ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(110)/1/
      DATA INLONG(110)/'TAGUCHI SN0'/
C
      DATA INCASE(111)/'SN+ '/
      DATA (INAME(111,J),J=1,MAXSCL)/
     1'SNL ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(111)/1/
      DATA INLONG(111)/'TAGUCHI SN+'/
C
      DATA INCASE(112)/'SN+ '/
      DATA (INAME(112,J),J=1,MAXSCL)/
     1'SNB ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(112)/1/
      DATA INLONG(112)/'TAGUCHI SN+'/
C
      DATA INCASE(113)/'SN+ '/
      DATA (INAME(113,J),J=1,MAXSCL)/
     1'SN+ ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(113)/1/
      DATA INLONG(113)/'TAGUCHI SN+'/
C
      DATA INCASE(114)/'SN- '/
      DATA (INAME(114,J),J=1,MAXSCL)/
     1'SN- ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(114)/1/
      DATA INLONG(114)/'TAGUCHI SN-'/
C
      DATA INCASE(115)/'SN00'/
      DATA (INAME(115,J),J=1,MAXSCL)/
     1'SN00','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(115)/1/
      DATA INLONG(115)/'TAGUCHI SN00'/
C
      DATA INCASE(116)/'SN00'/
      DATA (INAME(116,J),J=1,MAXSCL)/
     1'SNT2','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(116)/1/
      DATA INLONG(116)/'TAGUCHI SN00'/
C
      DATA INCASE(117)/'SN00'/
      DATA (INAME(117,J),J=1,MAXSCL)/
     1'SNN2','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(117)/1/
      DATA INLONG(117)/'TAGUCHI SN00'/
C
      DATA INCASE(118)/'SN00'/
      DATA (INAME(118,J),J=1,MAXSCL)/
     1'SN2 ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(118)/1/
      DATA INLONG(118)/'TAGUCHI SN00'/
C
      DATA INCASE(119)/'GEME'/
      DATA (INAME(119,J),J=1,MAXSCL)/
     1'GEOM','    ','MEAN','    ','    ','    ','    ','    '/
      DATA INFLAV(119)/1/
      DATA INLONG(119)/'GEOMETRIC MEAN'/
C
      DATA INCASE(120)/'GESD'/
      DATA (INAME(120,J),J=1,MAXSCL)/
     1'GEOM','    ','SD  ','    ','    ','    ','    ','    '/
      DATA INFLAV(120)/1/
      DATA INLONG(120)/'GEOMETRIC SD'/
C
      DATA INCASE(121)/'GESD'/
      DATA (INAME(121,J),J=1,MAXSCL)/
     1'GEOM','    ','STAN','DEVI','    ','    ','    ','    '/
      DATA INFLAV(121)/1/
      DATA INLONG(121)/'GEOMETRIC SD'/
C
      DATA INCASE(122)/'HAME'/
      DATA (INAME(122,J),J=1,MAXSCL)/
     1'HARM','    ','MEAN','    ','    ','    ','    ','    '/
      DATA INFLAV(122)/1/
      DATA INLONG(122)/'HARMONIC MEAN'/
C
      DATA INCASE(123)/'IQRA'/
      DATA (INAME(123,J),J=1,MAXSCL)/
     1'IQ  ','    ','RANG','    ','    ','    ','    ','    '/
      DATA INFLAV(123)/1/
      DATA INLONG(123)/'INTERQUARTILE RANGE'/
C
      DATA INCASE(124)/'IQRA'/
      DATA (INAME(124,J),J=1,MAXSCL)/
     1'INTE','    ','RANG','    ','    ','    ','    ','    '/
      DATA INFLAV(124)/1/
      DATA INLONG(124)/'INTERQUARTILE RANGE'/
C
      DATA INCASE(125)/'BILO'/
      DATA (INAME(125,J),J=1,MAXSCL)/
     1'BIWE','    ','LOCA','    ','    ','    ','    ','    '/
      DATA INFLAV(125)/1/
      DATA INLONG(125)/'BIWEIGHT LOCATION'/
C
      DATA INCASE(126)/'BISC'/
      DATA (INAME(126,J),J=1,MAXSCL)/
     1'BIWE','    ','SCAL','    ','    ','    ','    ','    '/
      DATA INFLAV(126)/1/
      DATA INLONG(126)/'BIWEIGHT SCALE'/
C
      DATA INCASE(127)/'WIVA'/
      DATA (INAME(127,J),J=1,MAXSCL)/
     1'WINS','    ','VARI','    ','    ','    ','    ','    '/
      DATA INFLAV(127)/1/
      DATA INLONG(127)/'WINSORIZED VARIANCE'/
C
      DATA INCASE(128)/'WIVA'/
      DATA (INAME(128,J),J=1,MAXSCL)/
     1'WIND','    ','VARI','    ','    ','    ','    ','    '/
      DATA INFLAV(128)/1/
      DATA INLONG(128)/'WINSORIZED VARIANCE'/
C
      DATA INCASE(129)/'WISD'/
      DATA (INAME(129,J),J=1,MAXSCL)/
     1'WINS','    ','SD  ','    ','    ','    ','    ','    '/
      DATA INFLAV(129)/1/
      DATA INLONG(129)/'WINSORIZED SD'/
C
      DATA INCASE(130)/'WISD'/
      DATA (INAME(130,J),J=1,MAXSCL)/
     1'WIND','    ','SD  ','    ','    ','    ','    ','    '/
      DATA INFLAV(130)/1/
      DATA INLONG(130)/'WINSORIZED SD'/
C
      DATA INCASE(131)/'WISD'/
      DATA (INAME(131,J),J=1,MAXSCL)/
     1'WINS','    ','STAN','DEVI','    ','    ','    ','    '/
      DATA INFLAV(131)/1/
      DATA INLONG(131)/'WINSORIZED SD'/
C
      DATA INCASE(132)/'WISD'/
      DATA (INAME(132,J),J=1,MAXSCL)/
     1'WIND','    ','STAN','DEVI','    ','    ','    ','    '/
      DATA INFLAV(132)/1/
      DATA INLONG(132)/'WINSORIZED SD'/
C
      DATA INCASE(133)/'WICV'/
      DATA (INAME(133,J),J=1,MAXSCL)/
     1'WINS','    ','COVA','    ','    ','    ','    ','    '/
      DATA INFLAV(133)/2/
      DATA INLONG(133)/'WINSORIZED COVARIANCE'/
C
      DATA INCASE(134)/'WICV'/
      DATA (INAME(134,J),J=1,MAXSCL)/
     1'WIND','    ','COVA','    ','    ','    ','    ','    '/
      DATA INFLAV(134)/2/
      DATA INLONG(134)/'WINSORIZED COVARIANCE'/
C
      DATA INCASE(135)/'WICR'/
      DATA (INAME(135,J),J=1,MAXSCL)/
     1'WINS','    ','CORR','    ','    ','    ','    ','    '/
      DATA INFLAV(135)/2/
      DATA INLONG(135)/'WINSORIZED CORRELATION'/
C
      DATA INCASE(136)/'WICR'/
      DATA (INAME(136,J),J=1,MAXSCL)/
     1'WIND','    ','CORR','    ','    ','    ','    ','    '/
      DATA INFLAV(136)/2/
      DATA INLONG(136)/'WINSORIZED CORRELATION'/
C
      DATA INCASE(137)/'BICR'/
      DATA (INAME(137,J),J=1,MAXSCL)/
     1'BIWE','    ','MIDC','    ','    ','    ','    ','    '/
      DATA INFLAV(137)/2/
      DATA INLONG(137)/'BIWEIGHT MIDCOVARIANCE'/
C
      DATA INCASE(138)/'BICR'/
      DATA (INAME(138,J),J=1,MAXSCL)/
     1'BIWE','    ','MID ','CORR','    ','    ','    ','    '/
      DATA INFLAV(138)/2/
      DATA INLONG(138)/'BIWEIGHT MIDCORRELATION'/
C
      DATA INCASE(139)/'BIMV'/
      DATA (INAME(139,J),J=1,MAXSCL)/
     1'BIWE','    ','MID ','VARI','    ','    ','    ','    '/
      DATA INFLAV(139)/1/
      DATA INLONG(139)/'BIWEIGHT MIDVARIANCE'/
C
      DATA INCASE(140)/'BIMV'/
      DATA (INAME(140,J),J=1,MAXSCL)/
     1'BIWE','    ','MIDV','    ','    ','    ','    ','    '/
      DATA INFLAV(140)/1/
      DATA INLONG(140)/'BIWEIGHT MIDVARIANCE'/
C
      DATA INCASE(141)/'PBMV'/
      DATA (INAME(141,J),J=1,MAXSCL)/
     1'PERC','    ','BEND','MIDV','    ','    ','    ','    '/
      DATA INFLAV(141)/1/
      DATA INLONG(141)/'PERCENTAGE BEND MIDVARINCE'/
C
      DATA INCASE(142)/'HLEH'/
      DATA (INAME(142,J),J=1,MAXSCL)/
     1'HODG','    ','LEHM','    ','    ','    ','    ','    '/
      DATA INFLAV(142)/1/
      DATA INLONG(142)/'HODGES-LEHMAN'/
C
      DATA INCASE(143)/'QUSE'/
      DATA (INAME(143,J),J=1,MAXSCL)/
     1'QUAN','    ','STAN','ERRO','    ','    ','    ','    '/
      DATA INFLAV(143)/1/
      DATA INLONG(143)/'QUANTILE STANDARD ERROR'/
C
      DATA INCASE(144)/'QUAN'/
      DATA (INAME(144,J),J=1,MAXSCL)/
     1'QUAN','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(144)/1/
      DATA INLONG(144)/'QUANTILE'/
C
      DATA INCASE(145)/'WETM'/
      DATA (INAME(145,J),J=1,MAXSCL)/
     1'WEIG','    ','TRIM','MEAN','    ','    ','    ','    '/
      DATA INFLAV(145)/1/
      DATA INLONG(145)/'WEIGHTED TRIMMED MEAN'/
C
      DATA INCASE(146)/'PBCR'/
      DATA (INAME(146,J),J=1,MAXSCL)/
     1'PERC','    ','BEND','CORR','    ','    ','    ','    '/
      DATA INFLAV(146)/2/
      DATA INLONG(146)/'PERCENTAGE BEND CORRELATION'/
C
      DATA INCASE(147)/'LICA'/
      DATA (INAME(147,J),J=1,MAXSCL)/
     1'LINE','    ','CALI','    ','    ','    ','    ','    '/
      DATA INFLAV(147)/2/
      DATA INLONG(147)/'LINEAR CALIBRATION'/
C
      DATA INCASE(148)/'QUCA'/
      DATA (INAME(148,J),J=1,MAXSCL)/
     1'QUAD','    ','CALI','    ','    ','    ','    ','    '/
      DATA INFLAV(148)/2/
      DATA INLONG(148)/'QUADRATIC CALIBRATION'/
C
      DATA INCASE(149)/'CP  '/
      DATA (INAME(149,J),J=1,MAXSCL)/
     1'CP  ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(149)/1/
      DATA INLONG(149)/'CP'/
C
      DATA INCASE(150)/'CPK '/
      DATA (INAME(150,J),J=1,MAXSCL)/
     1'CPK ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(150)/1/
      DATA INLONG(150)/'CPK'/
C
      DATA INCASE(151)/'CNPK'/
      DATA (INAME(151,J),J=1,MAXSCL)/
     1'CNPK','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(151)/1/
      DATA INLONG(151)/'CNPK'/
C
      DATA INCASE(152)/'CPM '/
      DATA (INAME(152,J),J=1,MAXSCL)/
     1'CPM ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(152)/1/
      DATA INLONG(152)/'CPM'/
C
      DATA INCASE(153)/'CC  '/
      DATA (INAME(153,J),J=1,MAXSCL)/
     1'CC  ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(153)/1/
      DATA INLONG(153)/'CC'/
C
      DATA INCASE(154)/'CPL '/
      DATA (INAME(154,J),J=1,MAXSCL)/
     1'CPL ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(154)/1/
      DATA INLONG(154)/'CPL'/
C
      DATA INCASE(155)/'CPU '/
      DATA (INAME(155,J),J=1,MAXSCL)/
     1'CPU ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(155)/1/
      DATA INLONG(155)/'CPU'/
C
      DATA INCASE(156)/'EXLO'/
      DATA (INAME(156,J),J=1,MAXSCL)/
     1'EXPE','    ','LOSS','    ','    ','    ','    ','    '/
      DATA INFLAV(156)/1/
      DATA INLONG(156)/'EXPECTED LOSS'/
C
      DATA INCASE(157)/'PEDE'/
      DATA (INAME(157,J),J=1,MAXSCL)/
     1'PERC','    ','DEFE','    ','    ','    ','    ','    '/
      DATA INFLAV(157)/1/
      DATA INLONG(157)/'PERCENT DEFECTIVE'/
C
      DATA INCASE(158)/'DMEA'/
      DATA (INAME(158,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','MEAN','    ','    ','    ','    '/
      DATA INFLAV(158)/2/
      DATA INLONG(158)/'DIFFERENCE OF MEANS'/
C
      DATA INCASE(159)/'DAAM'/
      DATA (INAME(159,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','AVER','ABSO','DEVI','FROM','MEDI'/
      DATA INFLAV(159)/2/
      DATA INLONG(159)/'DIFF OF AVERAGE ABSO DEVIATIONS FROM MEDIAN'/
C
      DATA INCASE(160)/'DAAD'/
      DATA (INAME(160,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','AVER','ABSO','DEVI','    ','    '/
      DATA INFLAV(160)/2/
      DATA INLONG(160)/'DIFFERENCE OF AVERAGE ABSOLUTE DEVIATIONS'/
C
      DATA INCASE(161)/'DMMD'/
      DATA (INAME(161,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','MAD ','TO  ','MEDI','    ','    '/
      DATA INFLAV(161)/2/
      DATA INLONG(161)/'DIFFERENCE OF AAD TO MEDIAN'/
C
      DATA INCASE(162)/'DMDM'/
      DATA (INAME(162,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','MIDM','    ','    ','    ','    '/
      DATA INFLAV(162)/2/
      DATA INLONG(162)/'DIFFERENCE OF MID-MEANS'/
C
      DATA INCASE(163)/'DMAD'/
      DATA (INAME(163,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','MAD ','    ','    ','    ','    '/
      DATA INFLAV(163)/2/
      DATA INLONG(163)/'DIFFERENCE OF MEDIAN ABSOLUTE DEVIATIONS'/
C
      DATA INCASE(164)/'DMAD'/
      DATA (INAME(164,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','MEDI','ABSO','DEVI','    ','    '/
      DATA INFLAV(164)/2/
      DATA INLONG(164)/'DIFFERENCE OF MEDIAN ABSOLUTE DEVIATIONS'/
C
      DATA INCASE(165)/'DMED'/
      DATA (INAME(165,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','MEDI','    ','    ','    ','    '/
      DATA INFLAV(165)/2/
      DATA INLONG(165)/'DIFFERENCE OF MEDIANS'/
C
      DATA INCASE(166)/'DTRM'/
      DATA (INAME(166,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','TRIM','MEAN','    ','    ','    '/
      DATA INFLAV(166)/2/
      DATA INLONG(166)/'DIFFERENCE OF TRIMMED MEANS'/
C
      DATA INCASE(167)/'DWNM'/
      DATA (INAME(167,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','WINS','MEAN','    ','    ','    '/
      DATA INFLAV(167)/2/
      DATA INLONG(167)/'DIFFERENCE OF WINSORIZED MEANS'/
C
      DATA INCASE(168)/'DWNM'/
      DATA (INAME(168,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','WIND','MEAN','    ','    ','    '/
      DATA INFLAV(168)/2/
      DATA INLONG(168)/'DIFFERENCE OF WINSORIZED MEANS'/
C
      DATA INCASE(169)/'DGEO'/
      DATA (INAME(169,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','GEOM','MEAN','    ','    ','    '/
      DATA INFLAV(169)/2/
      DATA INLONG(169)/'DIFFERENCE OF GEOMETRIC MEANS'/
C
      DATA INCASE(170)/'DHAR'/
      DATA (INAME(170,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','HARM','MEAN','    ','    ','    '/
      DATA INFLAV(170)/2/
      DATA INLONG(170)/'DIFFERENCE OF HARMONIC MEANS'/
C
      DATA INCASE(171)/'DHDL'/
      DATA (INAME(171,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','HODG','LEHM','    ','    ','    '/
      DATA INFLAV(171)/2/
      DATA INLONG(171)/'DIFFERENCE OF HODGES-LEHMAN'/
C
      DATA INCASE(172)/'DBIW'/
      DATA (INAME(172,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','BIWE','LOCA','    ','    ','    '/
      DATA INFLAV(172)/2/
      DATA INLONG(172)/'DIFFERENCE OF BIWEIGHT LOCATIONS'/
C
      DATA INCASE(173)/'DSD '/
      DATA (INAME(173,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','STAN','DEVI','    ','    ','    '/
      DATA INFLAV(173)/2/
      DATA INLONG(173)/'DIFFERENCE OF STANDARD DEVIATIONS'/
C
      DATA INCASE(174)/'DSD '/
      DATA (INAME(174,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','SD  ','    ','    ','    ','    '/
      DATA INFLAV(174)/2/
      DATA INLONG(174)/'DIFFERENCE OF STANDARD DEVIATIONS'/
C
      DATA INCASE(175)/'DVAR'/
      DATA (INAME(175,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','VARI','    ','    ','    ','    '/
      DATA INFLAV(175)/2/
      DATA INLONG(175)/'DIFFERENCE OF VARIANCES'/
C
      DATA INCASE(176)/'DSDM'/
      DATA (INAME(176,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','STAN','DEVI','OF  ','MEAN','    '/
      DATA INFLAV(176)/2/
      DATA INLONG(176)
     1     /'DIFFERENCE OF STANDARD DEVIATIONS OF THE MEANS'/
C
      DATA INCASE(177)/'DSDM'/
      DATA (INAME(177,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','STAN','DEVI','MEAN','    ','    '/
      DATA INFLAV(177)/2/
      DATA INLONG(177)
     1     /'DIFFERENCE OF STANDARD DEVIATIONS OF THE MEANS'/
C
      DATA INCASE(178)/'DSDM'/
      DATA (INAME(178,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','SD  ','OF  ','THE ','MEAN','    '/
      DATA INFLAV(178)/2/
      DATA INLONG(178)
     1     /'DIFFERENCE OF STANDARD DEVIATIONS OF THE MEANS'/
C
      DATA INCASE(179)/'DSDM'/
      DATA (INAME(179,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','SD  ','THE ','MEAN','    ','    '/
      DATA INFLAV(179)/2/
      DATA INLONG(179)
     1     /'DIFFERENCE OF STANDARD DEVIATIONS OF THE MEANS'/
C
      DATA INCASE(180)/'DSDM'/
      DATA (INAME(180,J),J=1,MAXSCL)/
     1'DIFF','OF  ','SD  ','MEAN','    ','    ','    ','    '/
      DATA INFLAV(180)/2/
      DATA INLONG(180)
     1     /'DIFFERENCE OF STANDARD DEVIATIONS OF THE MEANS'/
C
      DATA INCASE(181)/'DVAM'/
      DATA (INAME(181,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','VARI','MEAN','    ','    ','    '/
      DATA INFLAV(181)/2/
      DATA INLONG(181)/'DIFFERENCE OF VARIANCE OF THE MEANS'/
C
      DATA INCASE(182)/'DVAM'/
      DATA (INAME(182,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','VARI','OF  ','MEAN','    ','    '/
      DATA INFLAV(182)/2/
      DATA INLONG(182)/'DIFFERENCE OF VARIANCE OF THE MEANS'/
C
      DATA INCASE(183)/'DVAM'/
      DATA (INAME(183,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','VARI','OF  ','THE ','MEAN','    '/
      DATA INFLAV(183)/2/
      DATA INLONG(183)/'DIFFERENCE OF VARIANCE OF THE MEANS'/
C
      DATA INCASE(184)/'DIQR'/
      DATA (INAME(184,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','INTE','RANG','    ','    ','    '/
      DATA INFLAV(184)/2/
      DATA INLONG(184)/'DIFFERENCE OF INTERQUARTILE RANGES'/
C
      DATA INCASE(185)/'DIQR'/
      DATA (INAME(185,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','IQ  ','RANG','    ','    ','    '/
      DATA INFLAV(185)/2/
      DATA INLONG(185)/'DIFFERENCE OF THE INTERQUARTILE RANGES'/
C
      DATA INCASE(186)/'DWSD'/
      DATA (INAME(186,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','WINS','SD  ','    ','    ','    '/
      DATA INFLAV(186)/2/
      DATA INLONG(186)/'DIFFERENCE OF WINSORIZED STANDARD DEVIATIONS'/
C
      DATA INCASE(187)/'DWSD'/
      DATA (INAME(187,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','WIND','SD  ','    ','    ','    '/
      DATA INFLAV(187)/2/
      DATA INLONG(187)/'DIFFERENCE OF WINSORIZED STANDARD DEVIATIONS'/
C
      DATA INCASE(188)/'DWSD'/
      DATA (INAME(188,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','WINS','STAN','DEVI','    ','    '/
      DATA INFLAV(188)/2/
      DATA INLONG(188)/'DIFFERENCE OF WINSORIZED STANDARD DEVIATIONS'/
C
      DATA INCASE(189)/'DWSD'/
      DATA (INAME(189,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','WIND','STAN','DEVI','    ','    '/
      DATA INFLAV(189)/2/
      DATA INLONG(189)/'DIFFERENCE OF WINSORIZED STANDARD DEVIATIONS'/
C
      DATA INCASE(190)/'DWVA'/
      DATA (INAME(190,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','WINS','VARI','    ','    ','    '/
      DATA INFLAV(190)/2/
      DATA INLONG(190)/'DIFFERENCE OF WINSORIZED VARIANCES'/
C
      DATA INCASE(191)/'DWVA'/
      DATA (INAME(191,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','WIND','VARI','    ','    ','    '/
      DATA INFLAV(191)/2/
      DATA INLONG(191)/'DIFFERENCE OF WINSORIZED VARIANCES'/
C
      DATA INCASE(192)/'DBIM'/
      DATA (INAME(192,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','BIWE','MIDV','    ','    ','    '/
      DATA INFLAV(192)/2/
      DATA INLONG(192)/'DIFFERENCE OF BIWEIGHT MIDVARIANCES'/
C
      DATA INCASE(193)/'DBIS'/
      DATA (INAME(193,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','BIWE','SCAL','    ','    ','    '/
      DATA INFLAV(193)/2/
      DATA INLONG(193)/'DKIFFERENCE OF BIWEIGHT SCALES'/
C
      DATA INCASE(194)/'PEAG'/
      DATA (INAME(194,J),J=1,MAXSCL)/
     1'PERC','    ','AGRE','    ','    ','    ','    ','    '/
      DATA INFLAV(194)/2/
      DATA INLONG(194)/'PERCENTAGE AGREEMENT'/
C
      DATA INCASE(195)/'DGSD'/
      DATA (INAME(195,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','GEOM','SD  ','    ','    ','    '/
      DATA INFLAV(195)/2/
      DATA INLONG(195)/'DIFFERENCE OF GEOMETRIC STANDARD DEVIATIONS'/
C
      DATA INCASE(196)/'DGSD'/
      DATA (INAME(196,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','GEOM','STAN','DEVI','    ','    '/
      DATA INFLAV(196)/2/
      DATA INLONG(196)/'DIFFERENCE OF GEOMETRIC STANDARD DEVIATIONS'/
C
      DATA INCASE(197)/'DRAN'/
      DATA (INAME(197,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','RANG','    ','    ','    ','    '/
      DATA INFLAV(197)/2/
      DATA INLONG(197)/'DIFFERENCE OF RANGES'/
C
      DATA INCASE(198)/'DMDR'/
      DATA (INAME(198,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','MIDR','    ','    ','    ','    '/
      DATA INFLAV(198)/2/
      DATA INLONG(198)/'DIFFERENCE OF MID-RANGES'/
C
      DATA INCASE(199)/'DMDR'/
      DATA (INAME(199,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','MID ','RANG','    ','    ','    '/
      DATA INFLAV(199)/2/
      DATA INLONG(199)/'DIFFERENCE OF MID-RANGES'/
C
      DATA INCASE(200)/'DQUA'/
      DATA (INAME(200,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','QUAN','    ','    ','    ','    '/
      DATA INFLAV(200)/2/
      DATA INLONG(200)/'DIFFERENCE OF QUANTILES'/
C
      DATA INCASE(201)/'DSKE'/
      DATA (INAME(201,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','SKEW','    ','    ','    ','    '/
      DATA INFLAV(201)/2/
      DATA INLONG(201)/'DIFFERENCE OF SKEWNESS'/
C
      DATA INCASE(202)/'DSKE'/
      DATA (INAME(202,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','STAN','CENT','THIR','MOME','    '/
      DATA INFLAV(202)/2/
      DATA INLONG(202)/'DIFFERENCE OF SKEWNESS'/
C
      DATA INCASE(203)/'DSKE'/
      DATA (INAME(203,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','STAN','CENT','3RD ','MOME','    '/
      DATA INFLAV(203)/2/
      DATA INLONG(203)/'DIFFERENCE OF SKEWNESS'/
C
      DATA INCASE(204)/'DKUR'/
      DATA (INAME(204,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','KURT','    ','    ','    ','    '/
      DATA INFLAV(204)/2/
      DATA INLONG(204)/'DIFFERENCE OF KURTOSIS'/
C
      DATA INCASE(205)/'DKUR'/
      DATA (INAME(205,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','STAN','CENT','FOUR','MOME','    '/
      DATA INFLAV(205)/2/
      DATA INLONG(205)/'DIFFERENCE OF KURTOSIS'/
C
      DATA INCASE(206)/'DKUR'/
      DATA (INAME(206,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','STAN','CENT','4TH ','MOME','    '/
      DATA INFLAV(206)/2/
      DATA INLONG(206)/'DIFFERENCE OF KURTOSIS'/
C
      DATA INCASE(207)/'DRSD'/
      DATA (INAME(207,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','RELA','SD  ','    ','    ','    '/
      DATA INFLAV(207)/2/
      DATA INLONG(207)/'DIFFERENCE OF RELATIVE STANDARD DEVIATIONS'/
C
      DATA INCASE(208)/'DRSD'/
      DATA (INAME(208,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','RELA','STAN','DEVI','    ','    '/
      DATA INFLAV(208)/2/
      DATA INLONG(208)/'DIFFERENCE OF RELATIVE STANDARD DEVIATIONS'/
C
      DATA INCASE(209)/'DRVA'/
      DATA (INAME(209,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','RELA','VARI','    ','    ','    '/
      DATA INFLAV(209)/2/
      DATA INLONG(209)/'DIFFERENCE OF RELATIVE VARIANCES'/
C
      DATA INCASE(210)/'DMIN'/
      DATA (INAME(210,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','MINI','    ','    ','    ','    '/
      DATA INFLAV(210)/2/
      DATA INLONG(210)/'DIFFERENCE OF MINIMUMS'/
C
      DATA INCASE(211)/'DMAX'/
      DATA (INAME(211,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','MAXI','    ','    ','    ','    '/
      DATA INFLAV(211)/2/
      DATA INLONG(211)/'DIFFERENCE OF MAXIMUMS'/
C
      DATA INCASE(212)/'DEXT'/
      DATA (INAME(212,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','EXTR','    ','    ','    ','    '/
      DATA INFLAV(212)/2/
      DATA INLONG(212)/'DIFFERENCE OF EXTREMES'/
C
      DATA INCASE(213)/'DCVA'/
      DATA (INAME(213,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','COEF','OF  ','VARI','    ','    '/
      DATA INFLAV(213)/2/
      DATA INLONG(213)/'DIFFERENCE OF COEFFICIENT OF VARIATIONS'/
C
      DATA INCASE(214)/'DCVA'/
      DATA (INAME(214,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','COEF','VARI','    ','    ','    '/
      DATA INFLAV(214)/2/
      DATA INLONG(214)/'DIFFERENCE OF COEFFICIENT OF VARIATIONS'/
C
      DATA INCASE(215)/'DSN '/
      DATA (INAME(215,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','SN  ','SCAL','    ','    ','    '/
      DATA INFLAV(215)/2/
      DATA INLONG(215)/'DIFFERENCE OF SN SCALES'/
C
      DATA INCASE(216)/'DSN '/
      DATA (INAME(216,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','SN  ','    ','    ','    ','    '/
      DATA INFLAV(216)/2/
      DATA INLONG(216)/'DIFFERENCE OF SN SCALES'/
C
      DATA INCASE(217)/'DQN '/
      DATA (INAME(217,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','QN  ','SCAL','    ','    ','    '/
      DATA INFLAV(217)/2/
      DATA INLONG(217)/'DIFFERENCE OF QN SCALES'/
C
      DATA INCASE(218)/'DQN '/
      DATA (INAME(218,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','QN  ','    ','    ','    ','    '/
      DATA INFLAV(218)/2/
      DATA INLONG(218)/'DIFFERENCE OF QN SCALES'/
C
      DATA INCASE(219)/'DSSM'/
      DATA (INAME(219,J),J=1,MAXSCL)/
     1'DIFF','    ','SUM ','OF  ','SQUA','FROM','MEAN','    '/
      DATA INFLAV(219)/2/
      DATA INLONG(219)/'DIFFERENCE OF SUM OF SQUARES FROM MEAN'/
C
      DATA INCASE(220)/'DSSM'/
      DATA (INAME(220,J),J=1,MAXSCL)/
     1'DIFF','    ','SUMS','OF  ','SQUA','FROM','MEAN','    '/
      DATA INFLAV(220)/2/
      DATA INLONG(220)/'DIFFERENCE OF SUM OF SQUARES FROM MEAN'/
C
      DATA INCASE(221)/'COVA'/
      DATA (INAME(221,J),J=1,MAXSCL)/
     1'COVA','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(221)/2/
      DATA INLONG(221)/'COVARIANCE'/
C
      DATA INCASE(222)/'BPRC'/
      DATA (INAME(222,J),J=1,MAXSCL)/
     1'CORR','    ','BINO','PROB','    ','    ','    ','    '/
      DATA INFLAV(222)/1/
      DATA INLONG(222)/'BINOMIAL PROPORTION (CONTINUITY CORRECTION)'/
C
      DATA INCASE(223)/'RMLL'/
      DATA (INAME(223,J),J=1,MAXSCL)/
     1'RATI','    ','OF  ','MEAN','LOWE','CONF','LIMI','    '/
      DATA INFLAV(223)/2/
      DATA INLONG(223)/'RATIO OF MEANS LOWER CONFIDENCE LIMIT'/
C
      DATA INCASE(224)/'ORSE'/
      DATA (INAME(224,J),J=1,MAXSCL)/
     1'ODDS','    ','RATI','STAN','ERRO','    ','    ','    '/
      DATA INFLAV(224)/2/
      DATA INLONG(224)/'ODDS RATIO STANDARD ERROR'/
C
      DATA INCASE(225)/'ODRA'/
      DATA (INAME(225,J),J=1,MAXSCL)/
     1'ODDS','    ','RATI','    ','    ','    ','    ','    '/
      DATA INFLAV(225)/2/
      DATA INLONG(225)/'ODDS RATIO'/
C
      DATA INCASE(226)/'RELR'/
      DATA (INAME(226,J),J=1,MAXSCL)/
     1'RELA','    ','RISK','    ','    ','    ','    ','    '/
      DATA INFLAV(226)/2/
      DATA INLONG(226)/'RELATIVE RISK'/
C
      DATA INCASE(227)/'CRAM'/
      DATA (INAME(227,J),J=1,MAXSCL)/
     1'CRAM','    ','CONT','COEF','    ','    ','    ','    '/
      DATA INFLAV(227)/2/
      DATA INLONG(227)/'CRAMER CONTINGENCY COEFFICIENT'/
C
      DATA INCASE(228)/'PEAR'/
      DATA (INAME(228,J),J=1,MAXSCL)/
     1'PEAR','    ','CONT','COEF','    ','    ','    ','    '/
      DATA INFLAV(228)/2/
      DATA INLONG(228)/'PEARSON CONTINGENCY COEFFICIENT'/
C
      DATA INCASE(229)/'FALP'/
      DATA (INAME(229,J),J=1,MAXSCL)/
     1'FALS','    ','POSI','    ','    ','    ','    ','    '/
      DATA INFLAV(229)/2/
      DATA INLONG(229)/'FALSE POSITIVE'/
C
      DATA INCASE(230)/'FALN'/
      DATA (INAME(230,J),J=1,MAXSCL)/
     1'FALS','    ','NEGA','    ','    ','    ','    ','    '/
      DATA INFLAV(230)/2/
      DATA INLONG(230)/'FALSE NEGATIVES'/
C
      DATA INCASE(231)/'TRUP'/
      DATA (INAME(231,J),J=1,MAXSCL)/
     1'TRUE','    ','POSI','    ','    ','    ','    ','    '/
      DATA INFLAV(231)/2/
      DATA INLONG(231)/'TRUE POSITIVES'/
C
      DATA INCASE(232)/'TRUN'/
      DATA (INAME(232,J),J=1,MAXSCL)/
     1'TRUE','    ','NEGA','    ','    ','    ','    ','    '/
      DATA INFLAV(232)/2/
      DATA INLONG(232)/'TRUE NEGATIVES'/
C
      DATA INCASE(233)/'SENS'/
      DATA (INAME(233,J),J=1,MAXSCL)/
     1'TEST','    ','SENS','    ','    ','    ','    ','    '/
      DATA INFLAV(233)/2/
      DATA INLONG(233)/'TEST SENSITIVITY'/
C
      DATA INCASE(234)/'SPEC'/
      DATA (INAME(234,J),J=1,MAXSCL)/
     1'TEST','    ','SPEC','    ','    ','    ','    ','    '/
      DATA INFLAV(234)/2/
      DATA INLONG(234)/'TEST SPECIFICITY'/
C
      DATA INCASE(235)/'SENS'/
      DATA (INAME(235,J),J=1,MAXSCL)/
     1'SENS','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(235)/2/
      DATA INLONG(235)/'TEST SENSITIVITY'/
C
      DATA INCASE(236)/'SPEC'/
      DATA (INAME(236,J),J=1,MAXSCL)/
     1'SPEC','IFIC','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(236)/2/
      DATA INLONG(236)/'TEST SPECIFICITY'/
C
      DATA INCASE(237)/'PPV '/
      DATA (INAME(237,J),J=1,MAXSCL)/
     1'POSI','    ','PRED','VALU','    ','    ','    ','    '/
      DATA INFLAV(237)/2/
      DATA INLONG(237)/'POSITIVE PREDICTIVE VALUE'/
C
      DATA INCASE(238)/'PPV '/
      DATA (INAME(238,J),J=1,MAXSCL)/
     1'PPV ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(238)/2/
      DATA INLONG(238)/'POSITIVE PREDICTIVE VALUE'/
C
      DATA INCASE(239)/'NPV '/
      DATA (INAME(239,J),J=1,MAXSCL)/
     1'NEGA','    ','PRED','VALU','    ','    ','    ','    '/
      DATA INFLAV(239)/2/
      DATA INLONG(239)/'NEGATIVE PREDICTIVE VALUE'/
C
      DATA INCASE(240)/'NPV '/
      DATA (INAME(240,J),J=1,MAXSCL)/
     1'NPV ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(240)/2/
      DATA INLONG(240)/'NEGATIVE PREDICTIVE VALUE'/
C
      DATA INCASE(241)/'ORSE'/
      DATA (INAME(241,J),J=1,MAXSCL)/
     1'STAN','    ','ERRO','ODDS','RATI','    ','    ','    '/
      DATA INFLAV(241)/2/
      DATA INLONG(241)/'STANDARD ERROR OF THE ODDS RATIO'/
C
      DATA INCASE(242)/'LOSE'/
      DATA (INAME(242,J),J=1,MAXSCL)/
     1'STAN','    ','ERRO','LOG ','ODDS','RATI','    ','    '/
      DATA INFLAV(242)/2/
      DATA INLONG(242)/'STANDARD ERROR OF THE LOG ODDS RATIO'/
C
      DATA INCASE(243)/'LOSE'/
      DATA (INAME(243,J),J=1,MAXSCL)/
     1'STAN','    ','ERRO','LOGA','ODDS','RATI','    ','    '/
      DATA INFLAV(243)/2/
      DATA INLONG(243)/'STANDARD ERROR OF THE LOG ODDS RATIO'/
C
      DATA INCASE(244)/'LOSE'/
      DATA (INAME(244,J),J=1,MAXSCL)/
     1'LOG ','    ','ODDS','RATI','STAN','ERRO','    ','    '/
      DATA INFLAV(244)/2/
      DATA INLONG(244)/'STANDARD ERROR OF THE LOG ODDS RATIO'/
C
      DATA INCASE(245)/'LOSE'/
      DATA (INAME(245,J),J=1,MAXSCL)/
     1'LOGA','    ','ODDS','RATI','STAN','ERRO','    ','    '/
      DATA INFLAV(245)/2/
      DATA INLONG(245)/'STANDARD ERROR OF THE LOG ODDS RATIO'/
C
      DATA INCASE(246)/'LODR'/
      DATA (INAME(246,J),J=1,MAXSCL)/
     1'LOG ','    ','ODDS','RATI','    ','    ','    ','    '/
      DATA INFLAV(246)/2/
      DATA INLONG(246)/'LOG ODDS RATIO'/
C
      DATA INCASE(247)/'LODR'/
      DATA (INAME(247,J),J=1,MAXSCL)/
     1'LOGA','    ','ODDS','RATI','    ','    ','    ','    '/
      DATA INFLAV(247)/2/
      DATA INLONG(247)/'LOG ODDS RATIO'/
C
      DATA INCASE(248)/'TRSD'/
      DATA (INAME(248,J),J=1,MAXSCL)/
     1'TRIM','    ','STAN','DEVI','    ','    ','    ','    '/
      DATA INFLAV(248)/1/
      DATA INLONG(248)/'TRIMMED STANDARD DEVIATION'/
C
      DATA INCASE(249)/'TRSD'/
      DATA (INAME(249,J),J=1,MAXSCL)/
     1'TRIM','    ','SD  ','    ','    ','    ','    ','    '/
      DATA INFLAV(249)/1/
      DATA INLONG(249)/'TRIMMED STANDARD DEVIATION'/
C
      DATA INCASE(250)/'LPME'/
      DATA (INAME(250,J),J=1,MAXSCL)/
     1'LP  ','    ','LOCA','    ','    ','    ','    ','    '/
      DATA INFLAV(250)/1/
      DATA INLONG(250)/'LP LOCATION'/
C
      DATA INCASE(251)/'LPVA'/
      DATA (INAME(251,J),J=1,MAXSCL)/
     1'VARI','    ','OF  ','LP  ','LOCA','    ','    ','    '/
      DATA INFLAV(251)/1/
      DATA INLONG(251)/'VARIANCE OF LP LOCATION'/
C
      DATA INCASE(252)/'WEVA'/
      DATA (INAME(252,J),J=1,MAXSCL)/
     1'WEIG','    ','VARI','    ','    ','    ','    ','    '/
      DATA INFLAV(252)/2/
      DATA INLONG(252)/'WEIGHTED VARIANCE'/
C
      DATA INCASE(253)/'LPSD'/
      DATA (INAME(253,J),J=1,MAXSCL)/
     1'SD  ','    ','OF  ','LP  ','LOCA','    ','    ','    '/
      DATA INFLAV(253)/1/
      DATA INLONG(253)/'STANDARD DEVIATION OF LP LOCATION'/
C
      DATA INCASE(254)/'LPSD'/
      DATA (INAME(254,J),J=1,MAXSCL)/
     1'SD  ','    ','LP  ','LOCA','    ','    ','    ','    '/
      DATA INFLAV(254)/1/
      DATA INLONG(254)/'STANDARD DEVIATION OF LP LOCATION'/
C
      DATA INCASE(255)/'LPSD'/
      DATA (INAME(255,J),J=1,MAXSCL)/
     1'STAN','    ','DEVI','LP  ','LOCA','    ','    ','    '/
      DATA INFLAV(255)/1/
      DATA INLONG(255)/'STANDARD DEVIATION OF LP LOCATION'/
C
      DATA INCASE(256)/'LPSD'/
      DATA (INAME(256,J),J=1,MAXSCL)/
     1'STAN','    ','DEVI','OF  ','LP  ','LOCA','    ','    '/
      DATA INFLAV(256)/1/
      DATA INLONG(256)/'STANDARD DEVIATION OF LP LOCATION'/
C
      DATA INCASE(257)/'DLPL'/
      DATA (INAME(257,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','LP  ','LOCA','    ','    ','    '/
      DATA INFLAV(257)/2/
      DATA INLONG(257)/'DIFFERENCE OF LP LOCATIONS'/
C
      DATA INCASE(258)/'DLPV'/
      DATA (INAME(258,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','VARI','LP  ','LOCA','    ','    '/
      DATA INFLAV(258)/2/
      DATA INLONG(258)/'DIFFERENCE OF VARIANCE OF LP LOCATIONS'/
C
      DATA INCASE(259)/'DLPV'/
      DATA (INAME(259,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','VARI','OF  ','LP  ','LOCA','    '/
      DATA INFLAV(259)/2/
      DATA INLONG(259)/'DIFFERENCE OF VARIANCE OF LP LOCATIONS'/
C
      DATA INCASE(260)/'DLPS'/
      DATA (INAME(260,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','SD  ','LP  ','LOCA','    ','    '/
      DATA INFLAV(260)/2/
      DATA INLONG(260)
     1     /'DIFFERENCE OF STANDARD DEVIATIONS OF LP LOCATIONS'/
C
      DATA INCASE(261)/'DLPS'/
      DATA (INAME(261,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','SD  ','OF  ','LP  ','LOCA','    '/
      DATA INFLAV(261)/2/
      DATA INLONG(261)
     1     /'DIFFERENCE OF STANDARD DEVIATIONS OF LP LOCATIONS'/
C
      DATA INCASE(262)/'BPLC'/
      DATA (INAME(262,J),J=1,MAXSCL)/
     1'BINO','    ','PROB','LOWE','CONF','LIMI','    ','    '/
      DATA INFLAV(262)/1/
      DATA INLONG(262)/'BINOMIAL PROPORTION LOWER CONFIDENCE LIMIT'/
C
      DATA INCASE(263)/'BPLC'/
      DATA (INAME(263,J),J=1,MAXSCL)/
     1'BINO','    ','PROP','LOWE','CONF','LIMI','    ','    '/
      DATA INFLAV(263)/1/
      DATA INLONG(263)/'BINOMIAL PROPORTION LOWER CONFIDENCE LIMIT'/
C
      DATA INCASE(264)/'DBLC'/
      DATA (INAME(264,J),J=1,MAXSCL)/
     1'DIFF','    ','BINO','PROB','LOWE','CONF','LIMI','    '/
      DATA INFLAV(264)/2/
      DATA INLONG(264)/'DIFF OF BINOMIAL PROPORTIONS LOWER CONF LIMIT'/
C
      DATA INCASE(265)/'DBLC'/
      DATA (INAME(265,J),J=1,MAXSCL)/
     1'DIFF','    ','BINO','PROP','LOWE','CONF','LIMI','    '/
      DATA INFLAV(265)/2/
      DATA INLONG(265)/'DIFF OF BINOMIAL PROPORTIONS LOWER CONF LIMIT'/
C
      DATA INCASE(266)/'DBLC'/
      DATA (INAME(266,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','BINO','PROP','LOWE','CONF','LIMI'/
      DATA INFLAV(266)/2/
      DATA INLONG(266)/'DIFF OF BINOMIAL PROPORTIONS LOWER CONF LIMIT'/
C
      DATA INCASE(267)/'DBLC'/
      DATA (INAME(267,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','BINO','PROB','LOWE','CONF','LIMI'/
      DATA INFLAV(267)/2/
      DATA INLONG(267)/'DIFF OF BINOMIAL PROPORTIONS LOWER CONF LIMIT'/
C
      DATA INCASE(268)/'1TCD'/
      DATA (INAME(268,J),J=1,MAXSCL)/
     1'ONE ','    ','SAMP','T   ','TEST','CDF ','    ','    '/
      DATA INFLAV(268)/1/
      DATA INLONG(268)/'ONE SAMPLE T-TEST CDF'/
C
      DATA INCASE(269)/'1T2P'/
      DATA (INAME(269,J),J=1,MAXSCL)/
     1'ONE ','    ','SAMP','T   ','TEST','PVAL','    ','    '/
      DATA INFLAV(269)/1/
      DATA INLONG(269)/'ONE SAMPLE T-TEST P-VALUE'/
C
      DATA INCASE(270)/'GCDF'/
      DATA (INAME(270,J),J=1,MAXSCL)/
     1'GRUB','    ','CDF ','    ','    ','    ','    ','    '/
      DATA INFLAV(270)/1/
      DATA INLONG(270)/'GRUBB TEST STATISTIC CDF'/
C
      DATA INCASE(271)/'GCDF'/
      DATA (INAME(271,J),J=1,MAXSCL)/
     1'GRUB','    ','TEST','CDF ','    ','    ','    ','    '/
      DATA INFLAV(271)/1/
      DATA INLONG(271)/'GRUBB TEST STATISTIC CDF'/
C
      DATA INCASE(272)/'GCDF'/
      DATA (INAME(272,J),J=1,MAXSCL)/
     1'GRUB','    ','STAT','CDF ','    ','    ','    ','    '/
      DATA INFLAV(272)/1/
      DATA INLONG(272)/'GRUBB TEST STATISTIC CDF'/
C
      DATA INCASE(273)/'GDIR'/
      DATA (INAME(273,J),J=1,MAXSCL)/
     1'GRUB','    ','DIRE','    ','    ','    ','    ','    '/
      DATA INFLAV(273)/1/
      DATA INLONG(273)/'GRUBB TEST STATISTIC DIRECTION'/
C
      DATA INCASE(274)/'GDIR'/
      DATA (INAME(274,J),J=1,MAXSCL)/
     1'GRUB','    ','TEST','STAT','DIRE','    ','    ','    '/
      DATA INFLAV(274)/1/
      DATA INLONG(274)/'GRUBB TEST STATISTIC DIRECTION'/
C
      DATA INCASE(275)/'GDIR'/
      DATA (INAME(275,J),J=1,MAXSCL)/
     1'GRUB','    ','TEST','DIRE','    ','    ','    ','    '/
      DATA INFLAV(275)/1/
      DATA INLONG(275)/'GRUBB TEST STATISTIC DIRECTION'/
C
      DATA INCASE(276)/'GDIR'/
      DATA (INAME(276,J),J=1,MAXSCL)/
     1'GRUB','    ','TEST','DIRE','    ','    ','    ','    '/
      DATA INFLAV(276)/1/
      DATA INLONG(276)/'GRUBB TEST STATISTIC DIRECTION'/
C
      DATA INCASE(277)/'GIND'/
      DATA (INAME(277,J),J=1,MAXSCL)/
     1'GRUB','    ','INDE','    ','    ','    ','    ','    '/
      DATA INFLAV(277)/1/
      DATA INLONG(277)/'GRUBB TEST STATISTIC INDEX'/
C
      DATA INCASE(278)/'GIND'/
      DATA (INAME(278,J),J=1,MAXSCL)/
     1'GRUB','    ','STAT','INDE','    ','    ','    ','    '/
      DATA INFLAV(278)/1/
      DATA INLONG(278)/'GRUBB TEST STATISTIC INDEX'/
C
      DATA INCASE(279)/'GIND'/
      DATA (INAME(279,J),J=1,MAXSCL)/
     1'GRUB','    ','TEST','INDE','    ','    ','    ','    '/
      DATA INFLAV(279)/1/
      DATA INLONG(279)/'GRUBB TEST STATISTIC INDEX'/
C
      DATA INCASE(280)/'GIND'/
      DATA (INAME(280,J),J=1,MAXSCL)/
     1'GRUB','    ','TEST','STAT','INDE','    ','    ','    '/
      DATA INFLAV(280)/1/
      DATA INLONG(280)/'GRUBB TEST STATISTIC INDEX'/
C
      DATA INCASE(281)/'GRUB'/
      DATA (INAME(281,J),J=1,MAXSCL)/
     1'GRUB','    ','TEST','STAT','    ','    ','    ','    '/
      DATA INFLAV(281)/1/
      DATA INLONG(281)/'GRUBB TEST STATISTIC'/
C
      DATA INCASE(282)/'GRUB'/
      DATA (INAME(282,J),J=1,MAXSCL)/
     1'GRUB','    ','TEST','    ','    ','    ','    ','    '/
      DATA INFLAV(282)/1/
      DATA INLONG(282)/'GRUBB TEST STATISTIC'/
C
      DATA INCASE(283)/'GRUB'/
      DATA (INAME(283,J),J=1,MAXSCL)/
     1'GRUB','    ','STAT','    ','    ','    ','    ','    '/
      DATA INFLAV(283)/1/
      DATA INLONG(283)/'GRUBB TEST STATISTIC'/
C
      DATA INCASE(284)/'GRUB'/
      DATA (INAME(284,J),J=1,MAXSCL)/
     1'GRUB','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(284)/1/
      DATA INLONG(284)/'GRUBB TEST STATISTIC'/
C
      DATA INCASE(285)/'CCDF'/
      DATA (INAME(285,J),J=1,MAXSCL)/
     1'CHI ','    ','SQUA','SD  ','TEST','CDF ','    ','    '/
      DATA INFLAV(285)/1/
      DATA INLONG(285)/'CHI-SQUARE STANDARD DEVIATION STATISTIC CDF'/
C
      DATA INCASE(286)/'CCDF'/
      DATA (INAME(286,J),J=1,MAXSCL)/
     1'CHI ','    ','SQUA','STAN','DEVI','TEST','CDF ','    '/
      DATA INFLAV(286)/1/
      DATA INLONG(286)/'CHI-SQUARE STANDARD DEVIATION STATISTIC CDF'/
C
      DATA INCASE(287)/'CS2P'/
      DATA (INAME(287,J),J=1,MAXSCL)/
     1'CHI ','    ','SQUA','STAN','DEVI','TEST','PVAL','    '/
      DATA INFLAV(287)/1/
      DATA INLONG(287)/'CHI-SQUARE STANDARD DEVIATION PVALUE'/
C
      DATA INCASE(288)/'FRCD'/
      DATA (INAME(288,J),J=1,MAXSCL)/
     1'FREQ','    ','TEST','CDF ','    ','    ','    ','    '/
      DATA INFLAV(288)/1/
      DATA INLONG(288)/'FREQUENCY TEST STATISTIC CDF'/
C
      DATA INCASE(289)/'FRET'/
      DATA (INAME(289,J),J=1,MAXSCL)/
     1'FREQ','    ','TEST','    ','    ','    ','    ','    '/
      DATA INFLAV(289)/1/
      DATA INLONG(289)/'FREQUENCY TEST STATISTIC'/
C
      DATA INCASE(290)/'FBLO'/
      DATA (INAME(290,J),J=1,MAXSCL)/
     1'FREQ','    ','WITH','A   ','BLOC','TEST','    ','    '/
      DATA INFLAV(290)/1/
      DATA INLONG(290)/'FREQUENCY WITHIN A BLOCK FREQUENCY TEST'/
C
      DATA INCASE(291)/'FBCD'/
      DATA (INAME(291,J),J=1,MAXSCL)/
     1'FREQ','    ','WITH','A   ','BLOC','TEST','CDF ','    '/
      DATA INFLAV(291)/1/
      DATA INLONG(291)/'FREQUENCY WITHIN A BLOCK FREQUENCY TEST CDF'/
C
      DATA INCASE(292)/'INMN'/
      DATA (INAME(292,J),J=1,MAXSCL)/
     1'INDE','    ','MINI','    ','    ','    ','    ','    '/
      DATA INFLAV(292)/1/
      DATA INLONG(292)/'INDEX MINIMUM'/
C
      DATA INCASE(293)/'NUMB'/
      DATA (INAME(293,J),J=1,MAXSCL)/
     1'NUMB','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(293)/1/
      DATA INLONG(293)/'NUMBER'/
C
      DATA INCASE(294)/'CDIG'/
      DATA (INAME(294,J),J=1,MAXSCL)/
     1'COMM','    ','DIGI','    ','    ','    ','    ','    '/
      DATA INFLAV(294)/1/
      DATA INLONG(294)/'COMMON DIGITS'/
C
      DATA INCASE(295)/'NOLO'/
      DATA (INAME(295,J),J=1,MAXSCL)/
     1'NORM','    ','PPCC','LOCA','    ','    ','    ','    '/
      DATA INFLAV(295)/1/
      DATA INLONG(295)/'NORMAL PPCC LOCATION'/
C
      DATA INCASE(296)/'UNLO'/
      DATA (INAME(296,J),J=1,MAXSCL)/
     1'UNIF','    ','PPCC','LOCA','    ','    ','    ','    '/
      DATA INFLAV(296)/1/
      DATA INLONG(296)/'UNIFORM PPCC LOCATION'/
C
      DATA INCASE(297)/'MINI'/
      DATA (INAME(297,J),J=1,MAXSCL)/
     1'MIN ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(297)/1/
      DATA INLONG(297)/'MINIMUM'/
C
      DATA INCASE(298)/'MAXI'/
      DATA (INAME(298,J),J=1,MAXSCL)/
     1'MAX ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(298)/1/
      DATA INLONG(298)/'MAXIMUM'/
C
      DATA INCASE(299)/'AUVA'/
      DATA (INAME(299,J),J=1,MAXSCL)/
     1'AUTO','COVA','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(299)/1/
      DATA INLONG(299)/'AUTOCOVARIANCE'/
C
      DATA INCASE(300)/'AUCR'/
      DATA (INAME(300,J),J=1,MAXSCL)/
     1'AUTO','CORR','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(300)/1/
      DATA INLONG(300)/'AUTOCORRELATION'/
C
      DATA INCASE(301)/'INMN'/
      DATA (INAME(301,J),J=1,MAXSCL)/
     1'INDE','    ','MIN ','    ','    ','    ','    ','    '/
      DATA INFLAV(301)/1/
      DATA INLONG(301)/'INDEX MINIMUM'/
C
      DATA INCASE(302)/'INMX'/
      DATA (INAME(302,J),J=1,MAXSCL)/
     1'INDE','    ','MAXI','    ','    ','    ','    ','    '/
      DATA INFLAV(302)/1/
      DATA INLONG(302)/'INDEX MAXIMUM'/
C
      DATA INCASE(303)/'INMX'/
      DATA (INAME(303,J),J=1,MAXSCL)/
     1'INDE','    ','MAX ','    ','    ','    ','    ','    '/
      DATA INFLAV(303)/1/
      DATA INLONG(303)/'INDEX MAXIMUM'/
C
      DATA INCASE(304)/'INEX'/
      DATA (INAME(304,J),J=1,MAXSCL)/
     1'INDE','    ','EXTR','    ','    ','    ','    ','    '/
      DATA INFLAV(304)/1/
      DATA INLONG(304)/'INDEX EXTREME'/
C
      DATA INCASE(305)/'DPRO'/
      DATA (INAME(305,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','PROD','    ','    ','    ','    '/
      DATA INFLAV(305)/2/
      DATA INLONG(305)/'DIFFERENCE OF PRODUCTS'/
C
      DATA INCASE(306)/'DCOU'/
      DATA (INAME(306,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','COUN','    ','    ','    ','    '/
      DATA INFLAV(306)/2/
      DATA INLONG(306)/'DIFFERENCE OF COUNTS'/
C
      DATA INCASE(307)/'DCOU'/
      DATA (INAME(307,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','NUMB','    ','    ','    ','    '/
      DATA INFLAV(307)/2/
      DATA INLONG(307)/'DIFFERENCE OF COUNTS'/
C
      DATA INCASE(308)/'DCOU'/
      DATA (INAME(308,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','SIZE','    ','    ','    ','    '/
      DATA INFLAV(308)/2/
      DATA INLONG(308)/'DIFFERENCE OF COUNTS'/
C
      DATA INCASE(309)/'DCOU'/
      DATA (INAME(309,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','SUBS','SIZE','    ','    ','    '/
      DATA INFLAV(309)/2/
      DATA INLONG(309)/'DIFFERENCE OF COUNTS'/
C
      DATA INCASE(310)/'DPER'/
      DATA (INAME(310,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','PERC','    ','    ','    ','    '/
      DATA INFLAV(310)/2/
      DATA INLONG(310)/'DIFFERENCE OF PERCENTILES'/
C
      DATA INCASE(311)/'D1DE'/
      DATA (INAME(311,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','FIRS','DECI','    ','    ','    '/
      DATA INFLAV(311)/2/
      DATA INLONG(311)/'DIFFERENCE OF FIRST DECILES'/
C
      DATA INCASE(312)/'D2DE'/
      DATA (INAME(312,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','SECO','DECI','    ','    ','    '/
      DATA INFLAV(312)/2/
      DATA INLONG(312)/'DIFFERENCE OF SECOND DECILES'/
C
      DATA INCASE(313)/'D3DE'/
      DATA (INAME(313,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','THIR','DECI','    ','    ','    '/
      DATA INFLAV(313)/2/
      DATA INLONG(313)/'DIFFERENCE OF THIRD DECILES'/
C
      DATA INCASE(314)/'D4DE'/
      DATA (INAME(314,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','FOUR','DECI','    ','    ','    '/
      DATA INFLAV(314)/2/
      DATA INLONG(314)/'DIFFERENCE OF FOURTH DECILES'/
C
      DATA INCASE(315)/'D5DE'/
      DATA (INAME(315,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','FIFT','DECI','    ','    ','    '/
      DATA INFLAV(315)/2/
      DATA INLONG(315)/'DIFFERENCE OF FIFTH DECILES'/
C
      DATA INCASE(316)/'D6DE'/
      DATA (INAME(316,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','SIXT','DECI','    ','    ','    '/
      DATA INFLAV(316)/2/
      DATA INLONG(316)/'DIFFERENCE OF SIXTH DECILES'/
C
      DATA INCASE(317)/'D7DE'/
      DATA (INAME(317,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','SEVE','DECI','    ','    ','    '/
      DATA INFLAV(317)/2/
      DATA INLONG(317)/'DIFFERENCE OF SEVENTH DECILES'/
C
      DATA INCASE(318)/'D8DE'/
      DATA (INAME(318,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','EIGH','DECI','    ','    ','    '/
      DATA INFLAV(318)/2/
      DATA INLONG(318)/'DIFFERENCE OF EIGHTH DECILES'/
C
      DATA INCASE(319)/'D9DE'/
      DATA (INAME(319,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','NINT','DECI','    ','    ','    '/
      DATA INFLAV(319)/2/
      DATA INLONG(319)/'DIFFERENCE OF NINTH DECILES'/
C
      DATA INCASE(320)/'DQSE'/
      DATA (INAME(320,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','QUAN','STAN','ERRO','    ','    '/
      DATA INFLAV(320)/2/
      DATA INLONG(320)/'DIFFERENCE OF QUANTILE STANDARD ERRORS'/
C
      DATA INCASE(321)/'DQSE'/
      DATA (INAME(321,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','QUAN','STAN','DEVI','    ','    '/
      DATA INFLAV(321)/2/
      DATA INLONG(321)/'DIFFERENCE OF QUANTILE STANDARD ERRORS'/
C
      DATA INCASE(322)/'DQSE'/
      DATA (INAME(322,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','QUAN','SD  ','    ','    ','    '/
      DATA INFLAV(322)/2/
      DATA INLONG(322)/'DIFFERENCE OF QUANTILE STANDARD ERRORS'/
C
      DATA INCASE(323)/'WESD'/
      DATA (INAME(323,J),J=1,MAXSCL)/
     1'WEIG','    ','STAN','DEVI','    ','    ','    ','    '/
      DATA INFLAV(323)/2/
      DATA INLONG(323)/'WEIGHTED STANDARD DEVIATION'/
C
      DATA INCASE(324)/'WESD'/
      DATA (INAME(324,J),J=1,MAXSCL)/
     1'WEIG','    ','SD  ','    ','    ','    ','    ','    '/
      DATA INFLAV(324)/2/
      DATA INLONG(324)/'WEIGHTED STANDARD DEVIATION'/
C
      DATA INCASE(325)/'SD  '/
      DATA (INAME(325,J),J=1,MAXSCL)/
     1'S   ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(325)/1/
      DATA INLONG(325)/'STANDARD DEVIATION'/
C
      DATA INCASE(326)/'INTE'/
      DATA (INAME(326,J),J=1,MAXSCL)/
     1'INTE','GRAL','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(326)/1/
      DATA INLONG(326)/'INTEGRAL'/
C
      DATA INCASE(327)/'CS2P'/
      DATA (INAME(327,J),J=1,MAXSCL)/
     1'CHI ','    ','SQUA','SD  ','TEST','PVAL','    ','    '/
      DATA INFLAV(327)/1/
      DATA INLONG(327)/'CHI-SQUARE STANDARD DEVIATION PVALUE'/
C
      DATA INCASE(328)/'CCDF'/
      DATA (INAME(328,J),J=1,MAXSCL)/
     1'CHI ','    ','SQUA','SD  ','CDF ','    ','    ','    '/
      DATA INFLAV(328)/1/
      DATA INLONG(328)/'CHI-SQUARE STANDARD DEVIATION STATISTIC CDF'/
C
      DATA INCASE(329)/'CCDF'/
      DATA (INAME(329,J),J=1,MAXSCL)/
     1'CHI ','    ','SQUA','STAN','DEVI','CDF ','    ','    '/
      DATA INFLAV(329)/1/
      DATA INLONG(329)/'CHI-SQUARE STANDARD DEVIATION STATISTIC CDF'/
C
      DATA INCASE(330)/'CS2P'/
      DATA (INAME(330,J),J=1,MAXSCL)/
     1'CHI ','    ','SQUA','SD  ','PVAL','    ','    ','    '/
      DATA INFLAV(330)/1/
      DATA INLONG(330)/'CHI-SQUARE STANDARD DEVIATION PVALUE'/
C
      DATA INCASE(331)/'DTSD'/
      DATA (INAME(331,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','TRIM','STAN','DEVI','    ','    '/
      DATA INFLAV(331)/1/
      DATA INLONG(331)/'DIFFERENCE OF TRIMMED STANDARD DEVIATION'/
C
      DATA INCASE(332)/'DTSD'/
      DATA (INAME(332,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','TRIM','SD  ','    ','    ','    '/
      DATA INFLAV(332)/1/
      DATA INLONG(332)/'DIFFERENCE OF TRIMMED STANDARD DEVIATION'/
C
      DATA INCASE(333)/'DLHI'/
      DATA (INAME(333,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','LOWE','HING','    ','    ','    '/
      DATA INFLAV(333)/1/
      DATA INLONG(333)/'DIFFERENCE OF LOWER HINGE'/
C
      DATA INCASE(334)/'DUHI'/
      DATA (INAME(334,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','UPPE','HING','    ','    ','    '/
      DATA INFLAV(334)/1/
      DATA INLONG(334)/'DIFFERENCE OF UPPER HINGE'/
C
      DATA INCASE(335)/'DLQU'/
      DATA (INAME(335,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','LOWE','QUAR','    ','    ','    '/
      DATA INFLAV(335)/1/
      DATA INLONG(335)/'DIFFERENCE OF LOWER QUARTILE'/
C
      DATA INCASE(336)/'DUQU'/
      DATA (INAME(336,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','UPPE','QUAR','    ','    ','    '/
      DATA INFLAV(336)/1/
      DATA INLONG(336)/'DIFFERENCE OF UPPER QUARTILE'/
C
      DATA INCASE(337)/'GCDF'/
      DATA (INAME(337,J),J=1,MAXSCL)/
     1'GRUB','    ','TEST','STAT','CDF ','    ','    ','    '/
      DATA INFLAV(337)/1/
      DATA INLONG(337)/'GRUBB TEST STATISTIC CDF'/
C
      DATA INCASE(338)/'DCOU'/
      DATA (INAME(338,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','SUBS','SIZE','    ','    ','    '/
      DATA INFLAV(338)/2/
      DATA INLONG(338)/'DIFFERENCE OF COUNTS'/
C
      DATA INCASE(339)/'MDCL'/
      DATA (INAME(339,J),J=1,MAXSCL)/
     1'MEDI','    ','CONF','LIMI','    ','    ','    ','    '/
      DATA INFLAV(339)/1/
      DATA INLONG(339)/'MEDIAN CONFIDENCE LIMIT'/
C
      DATA INCASE(340)/'VDIS'/
      DATA (INAME(340,J),J=1,MAXSCL)/
     1'VARI','    ','DIST','    ','    ','    ','    ','    '/
      DATA INFLAV(340)/1/
      DATA INLONG(340)/'VARIATIONAL DISTANCE'/
C
      DATA INCASE(341)/'TRIM'/
      DATA (INAME(341,J),J=1,MAXSCL)/
     1'TRIM','    ','MEAN','    ','    ','    ','    ','    '/
      DATA INFLAV(341)/1/
      DATA INLONG(341)/'TRIMMED MEAN'/
C
      DATA INCASE(342)/'MECL'/
      DATA (INAME(342,J),J=1,MAXSCL)/
     1'MEAN','    ','CONF','LIMI','    ','    ','    ','    '/
      DATA INFLAV(342)/1/
      DATA INLONG(342)/'MEAN CONFIDENCE LIMIT'/
C
      DATA INCASE(343)/'LPS2'/
      DATA (INAME(343,J),J=1,MAXSCL)/
     1'STAN','    ','DEVI','PRED','INTE','    ','    ','    '/
      DATA INFLAV(343)/2/
      DATA INLONG(343)/'LOWER SD PREDICTION LIMITS'/
C
      DATA INCASE(344)/'LPS2'/
      DATA (INAME(344,J),J=1,MAXSCL)/
     1'SD  ','    ','PRED','INTE','    ','    ','    ','    '/
      DATA INFLAV(344)/2/
      DATA INLONG(344)/'LOWER SD PREDICTION LIMITS'/
C
      DATA INCASE(345)/'GRO1'/
      DATA (INAME(345,J),J=1,MAXSCL)/
     1'GROU','    ','ONE ','    ','    ','    ','    ','    '/
      DATA INFLAV(345)/1/
      DATA INLONG(345)/'GROUP ONE'/
C
      DATA INCASE(346)/'GRO1'/
      DATA (INAME(346,J),J=1,MAXSCL)/
     1'GROU','    ','1   ','    ','    ','    ','    ','    '/
      DATA INFLAV(346)/1/
      DATA INLONG(346)/'GROUP ONE'/
C
      DATA INCASE(347)/'GRO2'/
      DATA (INAME(347,J),J=1,MAXSCL)/
     1'GROU','    ','TWO ','    ','    ','    ','    ','    '/
      DATA INFLAV(347)/1/
      DATA INLONG(347)/'GROUP TWO'/
C
      DATA INCASE(348)/'GRO2'/
      DATA (INAME(348,J),J=1,MAXSCL)/
     1'GROU','    ','2   ','    ','    ','    ','    ','    '/
      DATA INFLAV(348)/1/
      DATA INLONG(348)/'GROUP TWO'/
C
      DATA INCASE(349)/'GRO3'/
      DATA (INAME(349,J),J=1,MAXSCL)/
     1'GROU','    ','THRE','    ','    ','    ','    ','    '/
      DATA INFLAV(349)/1/
      DATA INLONG(349)/'GROUP THREE'/
C
      DATA INCASE(350)/'GRO3'/
      DATA (INAME(350,J),J=1,MAXSCL)/
     1'GROU','    ','3   ','    ','    ','    ','    ','    '/
      DATA INFLAV(350)/1/
      DATA INLONG(350)/'GROUP THREE'/
C
      DATA INCASE(351)/'GRO4'/
      DATA (INAME(351,J),J=1,MAXSCL)/
     1'GROU','    ','FOUR','    ','    ','    ','    ','    '/
      DATA INFLAV(351)/1/
      DATA INLONG(351)/'GROUP FOUR'/
C
      DATA INCASE(352)/'GRO4'/
      DATA (INAME(352,J),J=1,MAXSCL)/
     1'GROU','    ','4   ','    ','    ','    ','    ','    '/
      DATA INFLAV(352)/1/
      DATA INLONG(352)/'GROUP FOUR'/
C
      DATA INCASE(353)/'GRO5'/
      DATA (INAME(353,J),J=1,MAXSCL)/
     1'GROU','    ','FIVE','    ','    ','    ','    ','    '/
      DATA INFLAV(353)/1/
      DATA INLONG(353)/'GROUP FIVE'/
C
      DATA INCASE(354)/'GRO5'/
      DATA (INAME(354,J),J=1,MAXSCL)/
     1'GROU','    ','5   ','    ','    ','    ','    ','    '/
      DATA INFLAV(354)/1/
      DATA INLONG(354)/'GROUP FIVE'/
C
      DATA INCASE(355)/'GRO6'/
      DATA (INAME(355,J),J=1,MAXSCL)/
     1'GROU','    ','SIX ','    ','    ','    ','    ','    '/
      DATA INFLAV(355)/1/
      DATA INLONG(355)/'GROUP SIX'/
C
      DATA INCASE(356)/'GRO6'/
      DATA (INAME(356,J),J=1,MAXSCL)/
     1'GROU','    ','6   ','    ','    ','    ','    ','    '/
      DATA INFLAV(356)/1/
      DATA INLONG(356)/'GROUP SIX'/
C
      DATA INCASE(357)/'MMES'/
      DATA (INAME(357,J),J=1,MAXSCL)/
     1'MEAN','    ','OF  ','MEAN','SE  ','    ','    ','    '/
      DATA INFLAV(357)/2/
      DATA INLONG(357)/'MEAN OF MEANS STANDARD ERROR'/
C
      DATA INCASE(358)/'MECD'/
      DATA (INAME(358,J),J=1,MAXSCL)/
     1'MEDI','    ','TEST','CDF ','    ','    ','    ','    '/
      DATA INFLAV(358)/2/
      DATA INLONG(358)/'MEDIAN TEST CDF'/
C
      DATA INCASE(359)/'H10L'/
      DATA (INAME(359,J),J=1,MAXSCL)/
     1'H10 ','    ','LOCA','    ','    ','    ','    ','    '/
      DATA INFLAV(359)/1/
      DATA INLONG(359)/'H10 LOCATION'/
C
      DATA INCASE(360)/'H12L'/
      DATA (INAME(360,J),J=1,MAXSCL)/
     1'H12 ','    ','LOCA','    ','    ','    ','    ','    '/
      DATA INFLAV(360)/1/
      DATA INLONG(360)/'H12 LOCATION'/
C
      DATA INCASE(361)/'H15L'/
      DATA (INAME(361,J),J=1,MAXSCL)/
     1'H15 ','    ','LOCA','    ','    ','    ','    ','    '/
      DATA INFLAV(361)/1/
      DATA INLONG(361)/'H15 LOCATION'/
C
      DATA INCASE(362)/'H17L'/
      DATA (INAME(362,J),J=1,MAXSCL)/
     1'H17 ','    ','LOCA','    ','    ','    ','    ','    '/
      DATA INFLAV(362)/1/
      DATA INLONG(362)/'H17 LOCATION'/
C
      DATA INCASE(363)/'H20L'/
      DATA (INAME(363,J),J=1,MAXSCL)/
     1'H20 ','    ','LOCA','    ','    ','    ','    ','    '/
      DATA INFLAV(363)/1/
      DATA INLONG(363)/'H20 LOCATION'/
C
      DATA INCASE(364)/'H10S'/
      DATA (INAME(364,J),J=1,MAXSCL)/
     1'H10 ','    ','SCAL','    ','    ','    ','    ','    '/
      DATA INFLAV(364)/1/
      DATA INLONG(364)/'H10 SCALE'/
C
      DATA INCASE(365)/'H12S'/
      DATA (INAME(365,J),J=1,MAXSCL)/
     1'H12 ','    ','SCAL','    ','    ','    ','    ','    '/
      DATA INFLAV(365)/1/
      DATA INLONG(365)/'H12 SCALE'/
C
      DATA INCASE(366)/'H15S'/
      DATA (INAME(366,J),J=1,MAXSCL)/
     1'H15 ','    ','SCAL','    ','    ','    ','    ','    '/
      DATA INFLAV(366)/1/
      DATA INLONG(366)/'H15 LOCATION'/
C
      DATA INCASE(367)/'H17S'/
      DATA (INAME(367,J),J=1,MAXSCL)/
     1'H17 ','    ','SCAL','    ','    ','    ','    ','    '/
      DATA INFLAV(367)/1/
      DATA INLONG(367)/'H17 SCALE'/
C
      DATA INCASE(368)/'H20S'/
      DATA (INAME(368,J),J=1,MAXSCL)/
     1'H20 ','    ','SCAL','    ','    ','    ','    ','    '/
      DATA INFLAV(368)/1/
      DATA INLONG(368)/'H20 SCALE'/
C
      DATA INCASE(369)/'10LD'/
      DATA (INAME(369,J),J=1,MAXSCL)/
     1'DIFF','    ','H10 ','LOCA','    ','    ','    ','    '/
      DATA INFLAV(369)/2/
      DATA INLONG(369)/'DIFFERENCE OF H10 LOCATION'/
C
      DATA INCASE(370)/'10LD'/
      DATA (INAME(370,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','H10 ','LOCA','    ','    ','    '/
      DATA INFLAV(370)/2/
      DATA INLONG(370)/'DIFFERENCE OF H10 LOCATION'/
C
      DATA INCASE(371)/'12LD'/
      DATA (INAME(371,J),J=1,MAXSCL)/
     1'DIFF','    ','H12 ','LOCA','    ','    ','    ','    '/
      DATA INFLAV(371)/2/
      DATA INLONG(371)/'DIFFERENCE OF H10 LOCATION'/
C
      DATA INCASE(372)/'12LD'/
      DATA (INAME(372,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','H12 ','LOCA','    ','    ','    '/
      DATA INFLAV(372)/2/
      DATA INLONG(372)/'DIFFERENCE OF H12 LOCATION'/
C
      DATA INCASE(373)/'15LD'/
      DATA (INAME(373,J),J=1,MAXSCL)/
     1'DIFF','    ','H15 ','LOCA','    ','    ','    ','    '/
      DATA INFLAV(373)/2/
      DATA INLONG(373)/'DIFFERENCE OF H15 LOCATION'/
C
      DATA INCASE(374)/'15LD'/
      DATA (INAME(374,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','H15 ','LOCA','    ','    ','    '/
      DATA INFLAV(374)/2/
      DATA INLONG(374)/'DIFFERENCE OF H15 LOCATION'/
C
      DATA INCASE(374)/'17LD'/
      DATA (INAME(374,J),J=1,MAXSCL)/
     1'DIFF','    ','H17 ','LOCA','    ','    ','    ','    '/
      DATA INFLAV(374)/2/
      DATA INLONG(374)/'DIFFERENCE OF H17 LOCATION'/
C
      DATA INCASE(375)/'17LD'/
      DATA (INAME(375,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','H17 ','LOCA','    ','    ','    '/
      DATA INFLAV(375)/2/
      DATA INLONG(375)/'DIFFERENCE OF H17 LOCATION'/
C
      DATA INCASE(376)/'20LD'/
      DATA (INAME(376,J),J=1,MAXSCL)/
     1'DIFF','    ','H20 ','LOCA','    ','    ','    ','    '/
      DATA INFLAV(376)/2/
      DATA INLONG(376)/'DIFFERENCE OF H20 LOCATION'/
C
      DATA INCASE(377)/'20LD'/
      DATA (INAME(377,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','H20 ','LOCA','    ','    ','    '/
      DATA INFLAV(377)/2/
      DATA INLONG(377)/'DIFFERENCE OF H20 LOCATION'/
C
      DATA INCASE(378)/'10SD'/
      DATA (INAME(378,J),J=1,MAXSCL)/
     1'DIFF','    ','H10 ','SCAL','    ','    ','    ','    '/
      DATA INFLAV(378)/2/
      DATA INLONG(378)/'DIFFERENCE OF H10 SCALE'/
C
      DATA INCASE(379)/'10SD'/
      DATA (INAME(379,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','H10 ','SCAL','    ','    ','    '/
      DATA INFLAV(379)/2/
      DATA INLONG(379)/'DIFFERENCE OF H10 SCALE'/
C
      DATA INCASE(380)/'12SD'/
      DATA (INAME(380,J),J=1,MAXSCL)/
     1'DIFF','    ','H12 ','SCAL','    ','    ','    ','    '/
      DATA INFLAV(380)/2/
      DATA INLONG(380)/'DIFFERENCE OF H12 SCALE'/
C
      DATA INCASE(381)/'12SD'/
      DATA (INAME(381,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','H12 ','SCAL','    ','    ','    '/
      DATA INFLAV(381)/2/
      DATA INLONG(381)/'DIFFERENCE OF H12 SCALE'/
C
      DATA INCASE(382)/'15SD'/
      DATA (INAME(382,J),J=1,MAXSCL)/
     1'DIFF','    ','H15 ','SCAL','    ','    ','    ','    '/
      DATA INFLAV(382)/2/
      DATA INLONG(382)/'DIFFERENCE OF H15 SCALE'/
C
      DATA INCASE(383)/'15SD'/
      DATA (INAME(383,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','H15 ','SCAL','    ','    ','    '/
      DATA INFLAV(383)/2/
      DATA INLONG(383)/'DIFFERENCE OF H15 SCALE'/
C
      DATA INCASE(384)/'17SD'/
      DATA (INAME(384,J),J=1,MAXSCL)/
     1'DIFF','    ','H17 ','SCAL','    ','    ','    ','    '/
      DATA INFLAV(384)/2/
      DATA INLONG(384)/'DIFFERENCE OF H17 SCALE'/
C
      DATA INCASE(385)/'17SD'/
      DATA (INAME(385,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','H17 ','SCAL','    ','    ','    '/
      DATA INFLAV(385)/2/
      DATA INLONG(385)/'DIFFERENCE OF H17 SCALE'/
C
      DATA INCASE(386)/'20SD'/
      DATA (INAME(386,J),J=1,MAXSCL)/
     1'DIFF','    ','H20 ','SCAL','    ','    ','    ','    '/
      DATA INFLAV(386)/2/
      DATA INLONG(386)/'DIFFERENCE OF H20 SCALE'/
C
      DATA INCASE(387)/'20SD'/
      DATA (INAME(387,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','H20 ','SCAL','    ','    ','    '/
      DATA INFLAV(387)/2/
      DATA INLONG(387)/'DIFFERENCE OF H20 SCALE'/
C
      DATA INCASE(388)/'TM2S'/
      DATA (INAME(388,J),J=1,MAXSCL)/
     1'TIET','    ','MOOR','TEST','STAT','    ','    ','    '/
      DATA INFLAV(388)/1/
      DATA INLONG(388)/'TIETJEN-MOORE TEST STATISTIC'/
C
      DATA INCASE(389)/'TM2S'/
      DATA (INAME(389,J),J=1,MAXSCL)/
     1'TIET','    ','MOOR','TEST','    ','    ','    ','    '/
      DATA INFLAV(389)/1/
      DATA INLONG(389)/'TIETJEN-MOORE TEST STATISTIC'/
C
      DATA INCASE(390)/'TM2S'/
      DATA (INAME(390,J),J=1,MAXSCL)/
     1'TIET','    ','MOOR','    ','    ','    ','    ','    '/
      DATA INFLAV(390)/1/
      DATA INLONG(390)/'TIETJEN-MOORE TEST STATISTIC'/
C
      DATA INCASE(391)/'TMMN'/
      DATA (INAME(391,J),J=1,MAXSCL)/
     1'TIET','    ','MOOR','MINI','TEST','STAT','    ','    '/
      DATA INFLAV(391)/1/
      DATA INLONG(391)/'TIETJEN-MOORE MINIMUM TEST STATISTIC'/
C
      DATA INCASE(392)/'TMMN'/
      DATA (INAME(392,J),J=1,MAXSCL)/
     1'TIET','    ','MOOR','MINI','TEST','    ','    ','    '/
      DATA INFLAV(392)/1/
      DATA INLONG(392)/'TIETJEN-MOORE MINIMUM TEST STATISTIC'/
C
      DATA INCASE(393)/'TMMN'/
      DATA (INAME(393,J),J=1,MAXSCL)/
     1'TIET','    ','MOOR','MINI','    ','    ','    ','    '/
      DATA INFLAV(393)/1/
      DATA INLONG(393)/'TIETJEN-MOORE MINIMUM TEST STATISTIC'/
C
      DATA INCASE(394)/'TMMX'/
      DATA (INAME(394,J),J=1,MAXSCL)/
     1'TIET','    ','MOOR','MAXI','TEST','STAT','    ','    '/
      DATA INFLAV(394)/1/
      DATA INLONG(394)/'TIETJEN-MOORE MAXIMUM TEST STATISTIC'/
C
      DATA INCASE(395)/'TMMX'/
      DATA (INAME(395,J),J=1,MAXSCL)/
     1'TIET','    ','MOOR','MAXI','TEST','    ','    ','    '/
      DATA INFLAV(395)/1/
      DATA INLONG(395)/'TIETJEN-MOORE MAXIMUM TEST STATISTIC'/
C
      DATA INCASE(396)/'TMMX'/
      DATA (INAME(396,J),J=1,MAXSCL)/
     1'TIET','    ','MOOR','MAXI','    ','    ','    ','    '/
      DATA INFLAV(396)/1/
      DATA INLONG(396)/'TIETJEN-MOORE MAXIMUM TEST STATISTIC'/
C
      DATA INCASE(397)/'ESD '/
      DATA (INAME(397,J),J=1,MAXSCL)/
     1'EXTR','    ','STUD','DEVI','TEST','    ','    ','    '/
      DATA INFLAV(397)/1/
      DATA INLONG(397)/'EXTREME STUDENTIZED DEVIATE TEST STATISTIC'/
C
      DATA INCASE(398)/'ESD '/
      DATA (INAME(398,J),J=1,MAXSCL)/
     1'EXTR','    ','STUD','DEVI','    ','    ','    ','    '/
      DATA INFLAV(398)/1/
      DATA INLONG(398)/'EXTREME STUDENTIZED DEVIATE TEST STATISTIC'/
C
      DATA INCASE(399)/'EXTR'/
      DATA (INAME(399,J),J=1,MAXSCL)/
     1'EXTR','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(399)/1/
      DATA INLONG(399)/'EXTREME'/
C
      DATA INCASE(400)/'DIMN'/
      DATA (INAME(400,J),J=1,MAXSCL)/
     1'DIXO','    ','MINI','TEST','    ','    ','    ','    '/
      DATA INFLAV(400)/1/
      DATA INLONG(400)/'DIXON MINIMUM TEST STATISTIC'/
C
      DATA INCASE(401)/'DIMN'/
      DATA (INAME(401,J),J=1,MAXSCL)/
     1'DIXO','    ','MINI','    ','    ','    ','    ','    '/
      DATA INFLAV(401)/1/
      DATA INLONG(401)/'DIXON MININUM TEST STATISTIC'/
C
      DATA INCASE(402)/'DIMX'/
      DATA (INAME(402,J),J=1,MAXSCL)/
     1'DIXO','    ','MAXI','TEST','    ','    ','    ','    '/
      DATA INFLAV(402)/1/
      DATA INLONG(402)/'DIXON MAXIMUM TEST STATISTIC'/
C
      DATA INCASE(403)/'DIMX'/
      DATA (INAME(403,J),J=1,MAXSCL)/
     1'DIXO','    ','MAXI','    ','    ','    ','    ','    '/
      DATA INFLAV(403)/1/
      DATA INLONG(403)/'DIXON MAXIMUM TEST STATISTIC'/
C
      DATA INCASE(404)/'DI2S'/
      DATA (INAME(404,J),J=1,MAXSCL)/
     1'DIXO','    ','TEST','    ','    ','    ','    ','    '/
      DATA INFLAV(404)/1/
      DATA INLONG(404)/'DIXON TEST STATISTIC'/
C
      DATA INCASE(405)/'DI2S'/
      DATA (INAME(405,J),J=1,MAXSCL)/
     1'DIXO','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(405)/1/
      DATA INLONG(405)/'DIXON TEST STATISTIC'/
C
      DATA INCASE(406)/'BRAT'/
      DATA (INAME(406,J),J=1,MAXSCL)/
     1'BINO','    ','RATI','    ','    ','    ','    ','    '/
      DATA INFLAV(406)/2/
      DATA INLONG(406)/'BINOMIAL RATIO'/
C
      DATA INCASE(407)/'RMS '/
      DATA (INAME(407,J),J=1,MAXSCL)/
     1'RMS ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(407)/1/
      DATA INLONG(407)/'ROOT MEAN SQUARE ERROR'/
C
      DATA INCASE(408)/'RMS '/
      DATA (INAME(408,J),J=1,MAXSCL)/
     1'ROOT','    ','MEAN','SQUA','    ','ERRO','    ','    '/
      DATA INFLAV(408)/1/
      DATA INLONG(408)/'ROOT MEAN SQUARE ERROR'/
C
      DATA INCASE(409)/'RMS '/
      DATA (INAME(409,J),J=1,MAXSCL)/
     1'ROOT','    ','MEAN','SQUA','    ','    ','    ','    '/
      DATA INFLAV(409)/1/
      DATA INLONG(409)/'ROOT MEAN SQUARE ERROR'/
C
      DATA INCASE(410)/'DRMS'/
      DATA (INAME(410,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','RMS ','    ','    ','    ','    '/
      DATA INFLAV(410)/2/
      DATA INLONG(410)/'DIFFERENCE OF ROOT MEAN SQUARE ERROR'/
C
      DATA INCASE(411)/'DRMS'/
      DATA (INAME(411,J),J=1,MAXSCL)/
     1'DIFF','    ','RMS ','    ','    ','    ','    ','    '/
      DATA INFLAV(411)/2/
      DATA INLONG(411)/'DIFFERENCE OF ROOT MEAN SQUARE ERROR'/
C
      DATA INCASE(412)/'DRMS'/
      DATA (INAME(412,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','ROOT','MEAN','SQUA','ERRO','    '/
      DATA INFLAV(412)/2/
      DATA INLONG(412)/'DIFFERENCE OF ROOT MEAN SQUARE ERROR'/
C
      DATA INCASE(413)/'DRMS'/
      DATA (INAME(413,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','ROOT','MEAN','SQUA','    ','    '/
      DATA INFLAV(413)/2/
      DATA INLONG(413)/'DIFFERENCE OF ROOT MEAN SQUARE ERROR'/
C
      DATA INCASE(414)/'DRMS'/
      DATA (INAME(414,J),J=1,MAXSCL)/
     1'DIFF','    ','ROOT','MEAN','SQUA','ERRO','    ','    '/
      DATA INFLAV(414)/2/
      DATA INLONG(414)/'DIFFERENCE OF ROOT MEAN SQUARE ERROR'/
C
      DATA INCASE(415)/'DRMS'/
      DATA (INAME(415,J),J=1,MAXSCL)/
     1'DIFF','    ','ROOT','MEAN','SQUA','    ','    ','    '/
      DATA INFLAV(415)/2/
      DATA INLONG(415)/'DIFFERENCE OF ROOT MEAN SQUARE ERROR'/
C
      DATA INCASE(416)/'RMS '/
      DATA (INAME(416,J),J=1,MAXSCL)/
     1'RMS0','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(416)/1/
      DATA INLONG(416)/'ROOT MEAN SQUARE ERROR'/
C
      DATA INCASE(417)/'DRMS'/
      DATA (INAME(417,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','RMS0','    ','    ','    ','    '/
      DATA INFLAV(417)/2/
      DATA INLONG(417)/'DIFFERENCE OF ROOT MEAN SQUARE ERROR'/
C
      DATA INCASE(418)/'DRMS'/
      DATA (INAME(418,J),J=1,MAXSCL)/
     1'DIFF','    ','RMS0','    ','    ','    ','    ','    '/
      DATA INFLAV(418)/2/
      DATA INLONG(418)/'DIFFERENCE OF ROOT MEAN SQUARE ERROR'/
C
      DATA INCASE(419)/'1LAC'/
      DATA (INAME(419,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','LOWE','AGRE','COUL','    ','    '/
      DATA INFLAV(419)/1/
      DATA INLONG(419)/'ONE-SIDED LOWER AGRESTI-COUL'/
C
      DATA INCASE(420)/'1UAC'/
      DATA (INAME(420,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','UPPE','AGRE','COUL','    ','    '/
      DATA INFLAV(420)/1/
      DATA INLONG(420)/'ONE-SIDED UPPER AGRESTI-COUL'/
C
      DATA INCASE(421)/'2LAC'/
      DATA (INAME(421,J),J=1,MAXSCL)/
     1'TWO ','    ','SIDE','LOWE','AGRE','COUL','    ','    '/
      DATA INFLAV(421)/1/
      DATA INLONG(421)/'TWO-SIDED LOWER AGRESTI-COUL'/
C
      DATA INCASE(422)/'2UAC'/
      DATA (INAME(422,J),J=1,MAXSCL)/
     1'TWO ','    ','SIDE','UPPE','AGRE','COUL','    ','    '/
      DATA INFLAV(422)/1/
      DATA INLONG(422)/'TWO-SIDED UPPER AGRESTI-COUL'/
C
      DATA INCASE(423)/'1LEB'/
      DATA (INAME(423,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','LOWE','EXAC','BINO','    ','    '/
      DATA INFLAV(423)/1/
      DATA INLONG(423)/'ONE-SIDED LOWER EXACT BINOMIAL'/
C
      DATA INCASE(424)/'1UEB'/
      DATA (INAME(424,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','UPPE','EXAC','BINO','    ','    '/
      DATA INFLAV(424)/1/
      DATA INLONG(424)/'ONE-SIDED UPPER EXACT BINOMIAL'/
C
      DATA INCASE(425)/'2LEB'/
      DATA (INAME(425,J),J=1,MAXSCL)/
     1'TWO ','    ','SIDE','LOWE','EXAC','BINO','    ','    '/
      DATA INFLAV(425)/1/
      DATA INLONG(425)/'TWO-SIDED LOWER EXACT BINOMIAL'/
C
      DATA INCASE(426)/'2UEB'/
      DATA (INAME(426,J),J=1,MAXSCL)/
     1'TWO ','    ','SIDE','UPPE','EXAC','BINO','    ','    '/
      DATA INFLAV(426)/1/
      DATA INLONG(426)/'TWO-SIDED UPPER EXACT BINOMIAL'/
C
      DATA INCASE(427)/'REPE'/
      DATA (INAME(427,J),J=1,MAXSCL)/
     1'REPE','    ','STAN','DEVI','    ','    ','    ','    '/
      DATA INFLAV(427)/2/
      DATA INLONG(427)/'REPEATABILITY STANDARD DEVIATION'/
C
      DATA INCASE(428)/'REPE'/
      DATA (INAME(428,J),J=1,MAXSCL)/
     1'REPE','    ','SD  ','    ','    ','    ','    ','    '/
      DATA INFLAV(428)/2/
      DATA INLONG(428)/'REPEATABILITY STANDARD DEVIATION'/
C
      DATA INCASE(429)/'REPR'/
      DATA (INAME(429,J),J=1,MAXSCL)/
     1'REPR','    ','STAN','DEVI','    ','    ','    ','    '/
      DATA INFLAV(429)/2/
      DATA INLONG(429)/'REPRODUCIBILITY STANDARD DEVIATION'/
C
      DATA INCASE(430)/'REPR'/
      DATA (INAME(430,J),J=1,MAXSCL)/
     1'REPR','    ','SD  ','    ','    ','    ','    ','    '/
      DATA INFLAV(430)/2/
      DATA INLONG(430)/'REPRODUCIBILITY STANDARD DEVIATION'/
C
      DATA INCASE(431)/'LIIS'/
      DATA (INAME(431,J),J=1,MAXSCL)/
     1'LINE','    ','INTE','SD  ','    ','    ','    ','    '/
      DATA INFLAV(431)/2/
      DATA INLONG(431)/'LINEAR INTERCEPT STANDARD DEVIATION'/
C
      DATA INCASE(432)/'LISS'/
      DATA (INAME(432,J),J=1,MAXSCL)/
     1'LINE','    ','SLOP','SD  ','    ','    ','    ','    '/
      DATA INFLAV(432)/2/
      DATA INLONG(432)/'LINEAR SLOPE STANDARD DEVIATION'/
C
      DATA INCASE(433)/'LIIN'/
      DATA (INAME(433,J),J=1,MAXSCL)/
     1'LINE','    ','INTE','    ','    ','    ','    ','    '/
      DATA INFLAV(433)/2/
      DATA INLONG(433)/'LINEAR INTERCEPT'/
C
      DATA INCASE(434)/'LISL'/
      DATA (INAME(434,J),J=1,MAXSCL)/
     1'LINE','    ','SLOP','    ','    ','    ','    ','    '/
      DATA INFLAV(434)/2/
      DATA INLONG(434)/'LINEAR SLOPE'/
C
      DATA INCASE(435)/'LIDX'/
      DATA (INAME(435,J),J=1,MAXSCL)/
     1'LINE','    ','DIST','X   ','    ','    ','    ','    '/
      DATA INFLAV(435)/2/
      DATA INLONG(435)/'LINEAR DISTINCT X'/
C
      DATA INCASE(436)/'DHHD'/
      DATA (INAME(436,J),J=1,MAXSCL)/
     1'SUMM','    ','DERS','LAIR','HHD ','    ','    ','    '/
      DATA INFLAV(436)/3/
      DATA INLONG(436)/'DERSIMONIAN-LAIRD HHD'/
C
      DATA INCASE(437)/'DSSE'/
      DATA (INAME(437,J),J=1,MAXSCL)/
     1'SUMM','    ','DERS','LAIR','STAN','ERRO','    ','    '/
      DATA INFLAV(437)/3/
      DATA INLONG(437)/'DERSIMONIAN-LAIRD STANDARD ERROR'/
C
      DATA INCASE(438)/'DSSE'/
      DATA (INAME(438,J),J=1,MAXSCL)/
     1'SUMM','    ','DERS','LAIR','SE  ','    ','    ','    '/
      DATA INFLAV(438)/3/
      DATA INLONG(438)/'DERSIMONIAN-LAIRD STANDARD ERROR'/
C
      DATA INCASE(439)/'DSMM'/
      DATA (INAME(439,J),J=1,MAXSCL)/
     1'SUMM','    ','DERS','LAIR','MINM','    ','    ','    '/
      DATA INFLAV(439)/3/
      DATA INLONG(439)/'DERSIMONIAN-LAIRD MINMAX'/
C
      DATA INCASE(440)/'DSLA'/
      DATA (INAME(440,J),J=1,MAXSCL)/
     1'SUMM','    ','DERS','LAIR','    ','    ','    ','    '/
      DATA INFLAV(440)/3/
      DATA INLONG(440)/'DERSIMONIAN-LAIRD'/
C
      DATA INCASE(441)/'MPSE'/
      DATA (INAME(441,J),J=1,MAXSCL)/
     1'SUMM','    ','MAND','PAUL','STAN','ERRO','    ','    '/
      DATA INFLAV(441)/3/
      DATA INLONG(441)/'MANDEL-PAULE STANDARD ERROR'/
C
      DATA INCASE(442)/'MPSE'/
      DATA (INAME(442,J),J=1,MAXSCL)/
     1'SUMM','    ','MAND','PAUL','SE  ','    ','    ','    '/
      DATA INFLAV(442)/3/
      DATA INLONG(442)/'MANDEL-PAULE STANDARD ERROR'/
C
      DATA INCASE(443)/'MPAU'/
      DATA (INAME(443,J),J=1,MAXSCL)/
     1'SUMM','    ','MAND','PAUL','    ','    ','    ','    '/
      DATA INFLAV(443)/3/
      DATA INLONG(443)/'MANDEL-PAULE'/
C
      DATA INCASE(444)/'MMPS'/
      DATA (INAME(444,J),J=1,MAXSCL)/
     1'SUMM','    ','MODI','MAND','PAUL','STAN','ERRO','    '/
      DATA INFLAV(444)/3/
      DATA INLONG(444)/'MODIFIED MANDEL-PAULE SE'/
C
      DATA INCASE(445)/'MMPS'/
      DATA (INAME(445,J),J=1,MAXSCL)/
     1'SUMM','    ','MODI','MAND','PAUL','SE  ','    ','    '/
      DATA INFLAV(445)/3/
      DATA INLONG(445)/'MODIFIED MANDEL-PAULE SE'/
C
      DATA INCASE(446)/'MMPA'/
      DATA (INAME(446,J),J=1,MAXSCL)/
     1'SUMM','    ','MODI','MAND','PAUL','    ','    ','    '/
      DATA INFLAV(446)/3/
      DATA INLONG(446)/'MODIFIED MANDEL-PAULE'/
C
      DATA INCASE(447)/'VRSE'/
      DATA (INAME(447,J),J=1,MAXSCL)/
     1'SUMM','    ','VANG','RUKH','STAN','ERRO','    ','    '/
      DATA INFLAV(447)/3/
      DATA INLONG(447)/'VANGEL-RUKHIN SE'/
C
      DATA INCASE(448)/'VRSE'/
      DATA (INAME(448,J),J=1,MAXSCL)/
     1'SUMM','    ','VANG','RUKH','SE  ','    ','    ','    '/
      DATA INFLAV(448)/3/
      DATA INLONG(448)/'VANGEL-RUKHIN SE'/
C
      DATA INCASE(449)/'VARU'/
      DATA (INAME(449,J),J=1,MAXSCL)/
     1'SUMM','    ','VANG','RUKH','    ','    ','    ','    '/
      DATA INFLAV(449)/3/
      DATA INLONG(449)/'VANGEL-RUKHIN'/
C
      DATA INCASE(450)/'DHHD'/
      DATA (INAME(450,J),J=1,MAXSCL)/
     1'DERS','    ','LAIR','HHD ','    ','    ','    ','    '/
      DATA INFLAV(450)/2/
      DATA INLONG(450)/'DERSIMONIAN-LAIRD HHD'/
C
      DATA INCASE(451)/'DSSE'/
      DATA (INAME(451,J),J=1,MAXSCL)/
     1'DERS','    ','LAIR','STAN','ERRO','    ','    ','    '/
      DATA INFLAV(451)/2/
      DATA INLONG(451)/'DERSIMONIAN-LAIRD STANDARD ERROR'/
C
      DATA INCASE(452)/'DSSE'/
      DATA (INAME(452,J),J=1,MAXSCL)/
     1'DERS','    ','LAIR','SE  ','    ','    ','    ','    '/
      DATA INFLAV(452)/2/
      DATA INLONG(452)/'DERSIMONIAN-LAIRD STANDARD ERROR'/
C
      DATA INCASE(453)/'DSMM'/
      DATA (INAME(453,J),J=1,MAXSCL)/
     1'DERS','    ','LAIR','MINM','    ','    ','    ','    '/
      DATA INFLAV(453)/2/
      DATA INLONG(453)/'DERSIMONIAN-LAIRD MINMAX'/
C
      DATA INCASE(454)/'DSLA'/
      DATA (INAME(454,J),J=1,MAXSCL)/
     1'DERS','    ','LAIR','    ','    ','    ','    ','    '/
      DATA INFLAV(454)/2/
      DATA INLONG(454)/'DERSIMONIAN-LAIRD'/
C
      DATA INCASE(455)/'MPSE'/
      DATA (INAME(455,J),J=1,MAXSCL)/
     1'MAND','    ','PAUL','STAN','ERRO','    ','    ','    '/
      DATA INFLAV(455)/2/
      DATA INLONG(455)/'MANDEL-PAULE STANDARD ERROR'/
C
      DATA INCASE(456)/'MPSE'/
      DATA (INAME(456,J),J=1,MAXSCL)/
     1'MAND','    ','PAUL','SE  ','    ','    ','    ','    '/
      DATA INFLAV(456)/2/
      DATA INLONG(456)/'MANDEL-PAULE STANDARD ERROR'/
C
      DATA INCASE(457)/'MPAU'/
      DATA (INAME(457,J),J=1,MAXSCL)/
     1'MAND','    ','PAUL','    ','    ','    ','    ','    '/
      DATA INFLAV(457)/2/
      DATA INLONG(457)/'MANDEL-PAULE'/
C
      DATA INCASE(458)/'MMPS'/
      DATA (INAME(458,J),J=1,MAXSCL)/
     1'MODI','    ','MAND','PAUL','STAN','ERRO','    ','    '/
      DATA INFLAV(458)/2/
      DATA INLONG(458)/'MODIFIED MANDEL-PAULE SE'/
C
      DATA INCASE(459)/'MMPS'/
      DATA (INAME(459,J),J=1,MAXSCL)/
     1'MODI','    ','MAND','PAUL','SE  ','    ','    ','    '/
      DATA INFLAV(459)/2/
      DATA INLONG(459)/'MODIFIED MANDEL-PAULE SE'/
C
      DATA INCASE(460)/'MMPA'/
      DATA (INAME(460,J),J=1,MAXSCL)/
     1'MODI','    ','MAND','PAUL','    ','    ','    ','    '/
      DATA INFLAV(460)/2/
      DATA INLONG(460)/'MODIFIED MANDEL-PAULE'/
C
      DATA INCASE(461)/'VRSE'/
      DATA (INAME(461,J),J=1,MAXSCL)/
     1'VANG','    ','RUKH','STAN','ERRO','    ','    ','    '/
      DATA INFLAV(461)/2/
      DATA INLONG(461)/'VANGEL-RUKHIN SE'/
C
      DATA INCASE(462)/'VRSE'/
      DATA (INAME(462,J),J=1,MAXSCL)/
     1'VANG','    ','RUKH','SE  ','    ','    ','    ','    '/
      DATA INFLAV(462)/2/
      DATA INLONG(462)/'VANGEL-RUKHIN SE'/
C
      DATA INCASE(463)/'VARU'/
      DATA (INAME(463,J),J=1,MAXSCL)/
     1'VANG','    ','RUKH','    ','    ','    ','    ','    '/
      DATA INFLAV(463)/2/
      DATA INLONG(463)/'VANGEL-RUKHIN'/
C
      DATA INCASE(464)/'GCIS'/
      DATA (INAME(464,J),J=1,MAXSCL)/
     1'SUMM','    ','GENE','CONF','INTE','STAN','ERRO','    '/
      DATA INFLAV(464)/3/
      DATA INLONG(464)/'GENERALIZED CONFIDENCE INTERVAL SE'/
C
      DATA INCASE(465)/'GCIS'/
      DATA (INAME(465,J),J=1,MAXSCL)/
     1'SUMM','    ','GENE','CONF','INTE','SE  ','    ','    '/
      DATA INFLAV(465)/3/
      DATA INLONG(465)/'GENERALIZED CONFIDENCE INTERVAL SE'/
C
      DATA INCASE(466)/'GCIS'/
      DATA (INAME(466,J),J=1,MAXSCL)/
     1'SUMM','    ','GCI ','STAN','ERRO','    ','    ','    '/
      DATA INFLAV(466)/3/
      DATA INLONG(466)/'GENERALIZED CONFIDENCE INTERVAL SE'/
C
      DATA INCASE(467)/'GCIS'/
      DATA (INAME(467,J),J=1,MAXSCL)/
     1'SUMM','    ','GCI ','SE  ','    ','    ','    ','    '/
      DATA INFLAV(467)/3/
      DATA INLONG(467)/'GENERALIZED CONFIDENCE INTERVAL SE'/
C
      DATA INCASE(468)/'GCIN'/
      DATA (INAME(468,J),J=1,MAXSCL)/
     1'SUMM','    ','GENE','CONF','INTE','    ','    ','    '/
      DATA INFLAV(468)/3/
      DATA INLONG(468)/'GENERALIZED CONFIDENCE INTERVAL'/
C
      DATA INCASE(469)/'GCIS'/
      DATA (INAME(469,J),J=1,MAXSCL)/
     1'GENE','    ','CONF','INTE','STAN','ERRO','    ','    '/
      DATA INFLAV(469)/2/
      DATA INLONG(469)/'GENERALIZED CONFIDENCE INTERVAL SE'/
C
      DATA INCASE(470)/'GCIS'/
      DATA (INAME(470,J),J=1,MAXSCL)/
     1'GENE','    ','CONF','INTE','SE  ','    ','    ','    '/
      DATA INFLAV(470)/2/
      DATA INLONG(470)/'GENERALIZED CONFIDENCE INTERVAL SE'/
C
      DATA INCASE(471)/'GCIS'/
      DATA (INAME(471,J),J=1,MAXSCL)/
     1'GCI ','    ','STAN','ERRO','    ','    ','    ','    '/
      DATA INFLAV(471)/2/
      DATA INLONG(471)/'GENERALIZED CONFIDENCE INTERVAL SE'/
C
      DATA INCASE(472)/'GCIS'/
      DATA (INAME(472,J),J=1,MAXSCL)/
     1'GGI ','    ','SE  ','    ','    ','    ','    ','    '/
      DATA INFLAV(472)/2/
      DATA INLONG(472)/'GENERALIZED CONFIDENCE INTERVAL SE'/
C
      DATA INCASE(473)/'GCIN'/
      DATA (INAME(473,J),J=1,MAXSCL)/
     1'GENE','    ','CONF','INTE','    ','    ','    ','    '/
      DATA INFLAV(473)/2/
      DATA INLONG(473)/'GENERALIZED CONFIDENCE INTERVAL'/
C
      DATA INCASE(474)/'GCIN'/
      DATA (INAME(474,J),J=1,MAXSCL)/
     1'GCI ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(474)/2/
      DATA INLONG(474)/'GENERALIZED CONFIDENCE INTERVAL'/
C
      DATA INCASE(475)/'BOBS'/
      DATA (INAME(475,J),J=1,MAXSCL)/
     1'SUMM','    ','BOB ','STAN','ERRO','    ','    ','    '/
      DATA INFLAV(475)/3/
      DATA INLONG(475)/'BOB STANDARD ERROR'/
C
      DATA INCASE(476)/'BOBS'/
      DATA (INAME(476,J),J=1,MAXSCL)/
     1'SUMM','    ','BOB ','SE  ','    ','    ','    ','    '/
      DATA INFLAV(476)/3/
      DATA INLONG(476)/'BOB STANDARD ERROR'/
C
      DATA INCASE(477)/'BOBS'/
      DATA (INAME(477,J),J=1,MAXSCL)/
     1'SUMM','    ','BOB ','    ','    ','    ','    ','    '/
      DATA INFLAV(477)/3/
      DATA INLONG(477)/'BOB'/
C
      DATA INCASE(478)/'BOBS'/
      DATA (INAME(478,J),J=1,MAXSCL)/
     1'BOB ','    ','STAN','ERRO','    ','    ','    ','    '/
      DATA INFLAV(478)/2/
      DATA INLONG(478)/'BOB STANDARD ERROR'/
C
      DATA INCASE(479)/'BOBS'/
      DATA (INAME(479,J),J=1,MAXSCL)/
     1'BOB ','    ','SE  ','    ','    ','    ','    ','    '/
      DATA INFLAV(479)/2/
      DATA INLONG(479)/'BOB STANDARD ERROR'/
C
      DATA INCASE(480)/'BOB '/
      DATA (INAME(480,J),J=1,MAXSCL)/
     1'BOB ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(480)/2/
      DATA INLONG(480)/'BOB'/
C
      DATA INCASE(481)/'BCPS'/
      DATA (INAME(481,J),J=1,MAXSCL)/
     1'BCP ','    ','STAN','ERRO','    ','    ','    ','    '/
      DATA INFLAV(481)/2/
      DATA INLONG(481)/'BCP STANDARD ERROR'/
C
      DATA INCASE(482)/'BCPS'/
      DATA (INAME(482,J),J=1,MAXSCL)/
     1'BCP ','    ','SE  ','    ','    ','    ','    ','    '/
      DATA INFLAV(482)/2/
      DATA INLONG(482)/'BCP STANDARD ERROR'/
C
      DATA INCASE(483)/'BCP '/
      DATA (INAME(483,J),J=1,MAXSCL)/
     1'BCP ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(483)/2/
      DATA INLONG(483)/'BCP'/
C
      DATA INCASE(484)/'BCPS'/
      DATA (INAME(484,J),J=1,MAXSCL)/
     1'BAYE','    ','CONS','PROC','STAN','ERRO','    ','    '/
      DATA INFLAV(484)/2/
      DATA INLONG(484)/'BCP STANDARD ERROR'/
C
      DATA INCASE(485)/'BCPS'/
      DATA (INAME(485,J),J=1,MAXSCL)/
     1'BAYE','    ','CONS','PROC','SE  ','    ','    ','    '/
      DATA INFLAV(485)/2/
      DATA INLONG(485)/'BCP STANDARD ERROR'/
C
      DATA INCASE(486)/'BCP '/
      DATA (INAME(486,J),J=1,MAXSCL)/
     1'BAYE','    ','CONS','PROC','    ','    ','    ','    '/
      DATA INFLAV(486)/2/
      DATA INLONG(486)/'BCP'/
C
      DATA INCASE(487)/'BCPS'/
      DATA (INAME(487,J),J=1,MAXSCL)/
     1'SUMM','    ','BCP ','STAN','ERRO','    ','    ','    '/
      DATA INFLAV(487)/3/
      DATA INLONG(487)/'BCP STANDARD ERROR'/
C
      DATA INCASE(488)/'BCPS'/
      DATA (INAME(488,J),J=1,MAXSCL)/
     1'SUMM','    ','BCP ','SE  ','    ','    ','    ','    '/
      DATA INFLAV(488)/3/
      DATA INLONG(488)/'BCP STANDARD ERROR'/
C
      DATA INCASE(489)/'BCP '/
      DATA (INAME(489,J),J=1,MAXSCL)/
     1'SUMM','    ','BCP ','    ','    ','    ','    ','    '/
      DATA INFLAV(489)/3/
      DATA INLONG(489)/'BCP'/
C
      DATA INCASE(489)/'BCPS'/
      DATA (INAME(489,J),J=1,MAXSCL)/
     1'SUMM','    ','BAYE','CONS','PROC','STAN','ERRO','    '/
      DATA INFLAV(489)/3/
      DATA INLONG(489)/'BCP STANDARD ERROR'/
C
      DATA INCASE(490)/'BCPS'/
      DATA (INAME(490,J),J=1,MAXSCL)/
     1'SUMM','    ','BAYE','CONS','PROC','SE  ','    ','    '/
      DATA INFLAV(490)/3/
      DATA INLONG(490)/'BCP STANDARD ERROR'/
C
      DATA INCASE(491)/'BCP '/
      DATA (INAME(491,J),J=1,MAXSCL)/
     1'SUMM','    ','BAYE','CONS','PROC','    ','    ','    '/
      DATA INFLAV(491)/3/
      DATA INLONG(491)/'BCP'/
C
      DATA INCASE(492)/'MMES'/
      DATA (INAME(492,J),J=1,MAXSCL)/
     1'SUMM','    ','MEAN','OF  ','MEAN','STAN','ERRO','    '/
      DATA INFLAV(492)/3/
      DATA INLONG(492)/'MEAN OF MEANS STANDARD ERROR'/
C
      DATA INCASE(493)/'MMES'/
      DATA (INAME(493,J),J=1,MAXSCL)/
     1'SUMM','    ','MEAN','OF  ','MEAN','SE  ','    ','    '/
      DATA INFLAV(493)/3/
      DATA INLONG(493)/'MEAN OF MEANS STANDARD ERROR'/
C
      DATA INCASE(494)/'MMEA'/
      DATA (INAME(494,J),J=1,MAXSCL)/
     1'SUMM','    ','MEAN','OF  ','MEAN','    ','    ','    '/
      DATA INFLAV(494)/3/
      DATA INLONG(494)/'MEAN OF MEANS'/
C
      DATA INCASE(495)/'MMES'/
      DATA (INAME(495,J),J=1,MAXSCL)/
     1'MEAN','    ','OF  ','MEAN','STAN','ERRO','    ','    '/
      DATA INFLAV(495)/2/
      DATA INLONG(495)/'MEAN OF MEANS STANDARD ERROR'/
C
      DATA INCASE(496)/'MMEA'/
      DATA (INAME(496,J),J=1,MAXSCL)/
     1'MEAN','    ','OF  ','MEAN','    ','    ','    ','    '/
      DATA INFLAV(496)/2/
      DATA INLONG(496)/'MEAN OF MEANS'/
C
      DATA INCASE(497)/'MSDN'/
      DATA (INAME(497,J),J=1,MAXSCL)/
     1'MEAN','    ','SUCC','DIFF','TEST','NORM','    ','    '/
      DATA INFLAV(497)/1/
      DATA INLONG(497)/'MEAN SUCCESSIVE DIFFERENCES NORMALIZED'/
C
      DATA INCASE(498)/'SESE'/
      DATA (INAME(498,J),J=1,MAXSCL)/
     1'SUMM','    ','SCHI','EBER','STAN','ERRO','    ','    '/
      DATA INFLAV(498)/3/
      DATA INLONG(498)/'SCHILLER-EBERHHARDT STANDARD ERROR'/
C
      DATA INCASE(499)/'SESE'/
      DATA (INAME(499,J),J=1,MAXSCL)/
     1'SUMM','    ','SCHI','EBER','SE  ','    ','    ','    '/
      DATA INFLAV(499)/3/
      DATA INLONG(499)/'SCHILLER-EBERHARDT STANDARD ERROR'/
C
      DATA INCASE(500)/'SCEB'/
      DATA (INAME(500,J),J=1,MAXSCL)/
     1'SUMM','    ','SCHI','EBER','    ','    ','    ','    '/
      DATA INFLAV(500)/3/
      DATA INLONG(500)/'SCHILLER-EBERHARDT'/
C
      DATA INCASE(501)/'SESE'/
      DATA (INAME(501,J),J=1,MAXSCL)/
     1'SCHI','    ','EBER','STAN','ERRO','    ','    ','    '/
      DATA INFLAV(501)/2/
      DATA INLONG(501)/'SCHILLER-EBERHHARDT STANDARD ERROR'/
C
      DATA INCASE(502)/'SESE'/
      DATA (INAME(502,J),J=1,MAXSCL)/
     1'SCHI','    ','EBER','SE  ','    ','    ','    ','    '/
      DATA INFLAV(502)/2/
      DATA INLONG(502)/'SCHILLER-EBERHARDT STANDARD ERROR'/
C
      DATA INCASE(503)/'GDSE'/
      DATA (INAME(503,J),J=1,MAXSCL)/
     1'SUMM','    ','GRAY','DEAL','SINH','STAN','ERRO','    '/
      DATA INFLAV(503)/3/
      DATA INLONG(503)/'GRAYBILL-DEAL SINHA STANDARD ERROR'/
C
      DATA INCASE(504)/'GDSE'/
      DATA (INAME(504,J),J=1,MAXSCL)/
     1'SUMM','    ','GRAY','DEAL','SINH','SE  ','    ','    '/
      DATA INFLAV(504)/3/
      DATA INLONG(504)/'GRAYBILL-DEAL SINHA STANDARD ERROR'/
C
      DATA INCASE(505)/'GDSN'/
      DATA (INAME(505,J),J=1,MAXSCL)/
     1'SUMM','    ','GRAY','DEAL','NAIV','STAN','ERRO','    '/
      DATA INFLAV(505)/3/
      DATA INLONG(505)/'GRAYBILL-DEAL NAIVE STANDARD ERROR'/
C
      DATA INCASE(506)/'GDSN'/
      DATA (INAME(506,J),J=1,MAXSCL)/
     1'SUMM','    ','GRAY','DEAL','NAIV','SE  ','    ','    '/
      DATA INFLAV(506)/3/
      DATA INLONG(506)/'GRAYBILL-DEAL NAIVE STANDARD ERROR'/
C
      DATA INCASE(507)/'GDZ1'/
      DATA (INAME(507,J),J=1,MAXSCL)/
     1'SUMM','    ','GRAY','DEAL','ZHAN','ONE ','STAN','ERRO'/
      DATA INFLAV(507)/3/
      DATA INLONG(507)/'GRAYBILL-DEAL ZHANG ONE STANDARD ERROR'/
C
      DATA INCASE(508)/'GDZ1'/
      DATA (INAME(508,J),J=1,MAXSCL)/
     1'SUMM','    ','GRAY','DEAL','ZHAN','1   ','STAN','ERRO'/
      DATA INFLAV(508)/3/
      DATA INLONG(508)/'GRAYBILL-DEAL ZHANG ONE STANDARD ERROR'/
C
      DATA INCASE(509)/'GDZ1'/
      DATA (INAME(509,J),J=1,MAXSCL)/
     1'SUMM','    ','GRAY','DEAL','ZHAN','ONE ','SE  ','    '/
      DATA INFLAV(509)/3/
      DATA INLONG(509)/'GRAYBILL-DEAL ZHANG ONE STANDARD ERROR'/
C
      DATA INCASE(510)/'GDZ1'/
      DATA (INAME(510,J),J=1,MAXSCL)/
     1'SUMM','    ','GRAY','DEAL','ZHAN','1   ','SE  ','    '/
      DATA INFLAV(510)/3/
      DATA INLONG(510)/'GRAYBILL-DEAL ZHANG ONE STANDARD ERROR'/
C
      DATA INCASE(511)/'GDZ2'/
      DATA (INAME(511,J),J=1,MAXSCL)/
     1'SUMM','    ','GRAY','DEAL','ZHAN','TWO ','STAN','ERRO'/
      DATA INFLAV(511)/3/
      DATA INLONG(511)/'GRAYBILL-DEAL ZHANG TWO STANDARD ERROR'/
C
      DATA INCASE(512)/'GDZ2'/
      DATA (INAME(512,J),J=1,MAXSCL)/
     1'SUMM','    ','GRAY','DEAL','ZHAN','2   ','STAN','ERRO'/
      DATA INFLAV(512)/3/
      DATA INLONG(512)/'GRAYBILL-DEAL ZHANG TWO STANDARD ERROR'/
C
      DATA INCASE(513)/'GDZ1'/
      DATA (INAME(513,J),J=1,MAXSCL)/
     1'SUMM','    ','GRAY','DEAL','ZHAN','TWO ','SE  ','    '/
      DATA INFLAV(513)/3/
      DATA INLONG(513)/'GRAYBILL-DEAL ZHANG TWO STANDARD ERROR'/
C
      DATA INCASE(514)/'GDZ2'/
      DATA (INAME(514,J),J=1,MAXSCL)/
     1'SUMM','    ','GRAY','DEAL','ZHAN','2   ','SE  ','    '/
      DATA INFLAV(514)/3/
      DATA INLONG(514)/'GRAYBILL-DEAL ZHANG TWO STANDARD ERROR'/
C
      DATA INCASE(515)/'GDSE'/
      DATA (INAME(515,J),J=1,MAXSCL)/
     1'SUMM','    ','GRAY','DEAL','STAN','ERRO','    ','    '/
      DATA INFLAV(515)/3/
      DATA INLONG(515)/'GRAYBILL-DEAL STANDARD ERROR'/
C
      DATA INCASE(516)/'GDSE'/
      DATA (INAME(516,J),J=1,MAXSCL)/
     1'SUMM','    ','GRAY','DEAL','SE  ','    ','    ','    '/
      DATA INFLAV(516)/3/
      DATA INLONG(516)/'GRAYBILL-DEAL STANDARD ERROR'/
C
      DATA INCASE(517)/'GDEA'/
      DATA (INAME(517,J),J=1,MAXSCL)/
     1'SUMM','    ','GRAY','DEAL','    ','    ','    ','    '/
      DATA INFLAV(517)/3/
      DATA INLONG(517)/'GRAYBILL-DEAL'/
C
      DATA INCASE(518)/'GDSE'/
      DATA (INAME(518,J),J=1,MAXSCL)/
     1'GRAY','    ','DEAL','SINH','STAN','ERRO','    ','    '/
      DATA INFLAV(518)/2/
      DATA INLONG(518)/'GRAYBILL-DEAL SINHA STANDARD ERROR'/
C
      DATA INCASE(519)/'GDSE'/
      DATA (INAME(519,J),J=1,MAXSCL)/
     1'GRAY','    ','DEAL','SINH','SE  ','    ','    ','    '/
      DATA INFLAV(519)/2/
      DATA INLONG(519)/'GRAYBILL-DEAL SINHA STANDARD ERROR'/
C
      DATA INCASE(520)/'GDSN'/
      DATA (INAME(520,J),J=1,MAXSCL)/
     1'GRAY','    ','DEAL','NAIV','STAN','ERRO','    ','    '/
      DATA INFLAV(520)/2/
      DATA INLONG(520)/'GRAYBILL-DEAL NAIVE STANDARD ERROR'/
C
      DATA INCASE(521)/'GDSN'/
      DATA (INAME(521,J),J=1,MAXSCL)/
     1'GRAY','    ','DEAL','NAIV','SE  ','    ','    ','    '/
      DATA INFLAV(521)/2/
      DATA INLONG(521)/'GRAYBILL-DEAL NAIVE STANDARD ERROR'/
C
      DATA INCASE(522)/'GDZ1'/
      DATA (INAME(522,J),J=1,MAXSCL)/
     1'GRAY','    ','DEAL','ZHAN','ONE ','STAN','ERRO','    '/
      DATA INFLAV(522)/2/
      DATA INLONG(522)/'GRAYBILL-DEAL ZHANG ONE STANDARD ERROR'/
C
      DATA INCASE(523)/'GDZ1'/
      DATA (INAME(523,J),J=1,MAXSCL)/
     1'GRAY','    ','DEAL','ZHAN','1   ','STAN','ERRO','    '/
      DATA INFLAV(523)/2/
      DATA INLONG(523)/'GRAYBILL-DEAL ZHANG ONE STANDARD ERROR'/
C
      DATA INCASE(524)/'GDZ1'/
      DATA (INAME(524,J),J=1,MAXSCL)/
     1'GRAY','    ','DEAL','ZHAN','ONE ','SE  ','    ','    '/
      DATA INFLAV(524)/2/
      DATA INLONG(524)/'GRAYBILL-DEAL ZHANG ONE STANDARD ERROR'/
C
      DATA INCASE(525)/'GDZ1'/
      DATA (INAME(525,J),J=1,MAXSCL)/
     1'GRAY','    ','DEAL','ZHAN','1   ','SE  ','    ','    '/
      DATA INFLAV(525)/2/
      DATA INLONG(525)/'GRAYBILL-DEAL ZHANG ONE STANDARD ERROR'/
C
      DATA INCASE(526)/'GDZ2'/
      DATA (INAME(526,J),J=1,MAXSCL)/
     1'GRAY','    ','DEAL','ZHAN','TWO ','STAN','ERRO','    '/
      DATA INFLAV(526)/2/
      DATA INLONG(526)/'GRAYBILL-DEAL ZHANG TWO STANDARD ERROR'/
C
      DATA INCASE(527)/'GDZ2'/
      DATA (INAME(527,J),J=1,MAXSCL)/
     1'GRAY','    ','DEAL','ZHAN','2   ','STAN','ERRO','    '/
      DATA INFLAV(527)/2/
      DATA INLONG(527)/'GRAYBILL-DEAL ZHANG TWO STANDARD ERROR'/
C
      DATA INCASE(528)/'GDZ2'/
      DATA (INAME(528,J),J=1,MAXSCL)/
     1'GRAY','    ','DEAL','ZHAN','TWO ','SE  ','    ','    '/
      DATA INFLAV(528)/2/
      DATA INLONG(528)/'GRAYBILL-DEAL ZHANG TWO STANDARD ERROR'/
C
      DATA INCASE(529)/'GDZ2'/
      DATA (INAME(529,J),J=1,MAXSCL)/
     1'GRAY','    ','DEAL','ZHAN','2   ','SE  ','    ','    '/
      DATA INFLAV(529)/2/
      DATA INLONG(529)/'GRAYBILL-DEAL ZHANG TWO STANDARD ERROR'/
C
      DATA INCASE(530)/'GDSE'/
      DATA (INAME(530,J),J=1,MAXSCL)/
     1'GRAY','    ','DEAL','STAN','ERRO','    ','    ','    '/
      DATA INFLAV(530)/2/
      DATA INLONG(530)/'GRAYBILL-DEAL SINHA STANDARD ERROR'/
C
      DATA INCASE(531)/'GDSE'/
      DATA (INAME(531,J),J=1,MAXSCL)/
     1'GRAY','    ','DEAL','SE  ','    ','    ','    ','    '/
      DATA INFLAV(531)/2/
      DATA INLONG(531)/'GRAYBILL-DEAL SINHA STANDARD ERROR'/
C
      DATA INCASE(532)/'GDEA'/
      DATA (INAME(532,J),J=1,MAXSCL)/
     1'GRAY','    ','DEAL','    ','    ','    ','    ','    '/
      DATA INFLAV(532)/2/
      DATA INLONG(532)/'GRAYBILL-DEAL'/
C
      DATA INCASE(533)/'FWSE'/
      DATA (INAME(533,J),J=1,MAXSCL)/
     1'SUMM','    ','FAIR','STAN','ERRO','    ','    ','    '/
      DATA INFLAV(533)/3/
      DATA INLONG(533)/'FAIRWEATHER STANDARD ERROR'/
C
      DATA INCASE(534)/'FWSE'/
      DATA (INAME(534,J),J=1,MAXSCL)/
     1'SUMM','    ','FAIR','SE  ','    ','    ','    ','    '/
      DATA INFLAV(534)/3/
      DATA INLONG(534)/'FAIRWEATHER STANDARD ERROR'/
C
      DATA INCASE(535)/'FAIR'/
      DATA (INAME(535,J),J=1,MAXSCL)/
     1'SUMM','    ','FAIR','    ','    ','    ','    ','    '/
      DATA INFLAV(535)/3/
      DATA INLONG(535)/'FAIRWEATHER'/
C
      DATA INCASE(536)/'FWSE'/
      DATA (INAME(536,J),J=1,MAXSCL)/
     1'FAIR','    ','STAN','ERRO','    ','    ','    ','    '/
      DATA INFLAV(536)/2/
      DATA INLONG(536)/'FAIRWEATHER STANDARD ERROR'/
C
      DATA INCASE(537)/'FWSE'/
      DATA (INAME(537,J),J=1,MAXSCL)/
     1'FAIR','    ','SE  ','    ','    ','    ','    ','    '/
      DATA INFLAV(537)/2/
      DATA INLONG(537)/'FAIRWEATHER STANDARD ERROR'/
C
      DATA INCASE(538)/'FAIR'/
      DATA (INAME(538,J),J=1,MAXSCL)/
     1'FAIR','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(538)/2/
      DATA INLONG(538)/'FAIRWEATHER'/
C
      DATA INCASE(539)/'SCEB'/
      DATA (INAME(539,J),J=1,MAXSCL)/
     1'SCHI','    ','EBER','    ','    ','    ','    ','    '/
      DATA INFLAV(539)/2/
      DATA INLONG(539)/'SCHILLER-EBERHARDT'/
C
      DATA INCASE(540)/'BPRC'/
      DATA (INAME(540,J),J=1,MAXSCL)/
     1'CORR','    ','BINO','PROP','    ','    ','    ','    '/
      DATA INFLAV(540)/1/
      DATA INLONG(540)/'BINOMIAL PROPORTION (CONTINUITY CORRECTION)'/
C
      DATA INCASE(541)/'COAB'/
      DATA (INAME(541,J),J=1,MAXSCL)/
     1'CORR','    ','ABSO','VALU','    ','    ','    ','    '/
      DATA INFLAV(541)/2/
      DATA INLONG(541)/'CORRELATION ABSOLUTE VALUE'/
C
      DATA INCASE(542)/'RPSD'/
      DATA (INAME(542,J),J=1,MAXSCL)/
     1'ROBU','    ','POOL','STAN','DEVI','    ','    ','    '/
      DATA INFLAV(542)/1/
      DATA INLONG(542)/'ROBUST POOLED STANDARD DEVIATION'/
C
      DATA INCASE(543)/'RPSD'/
      DATA (INAME(543,J),J=1,MAXSCL)/
     1'ROBU','    ','POOL','SD  ','    ','    ','    ','    '/
      DATA INFLAV(543)/1/
      DATA INLONG(543)/'ROBUST POOLED STANDARD DEVIATION'/
C
      DATA INCASE(544)/'RPRA'/
      DATA (INAME(544,J),J=1,MAXSCL)/
     1'ROBU','    ','POOL','RANG','    ','    ','    ','    '/
      DATA INFLAV(544)/1/
      DATA INLONG(544)/'ROBUST POOLED RANGE'/
C
      DATA INCASE(545)/'ADKC'/
      DATA (INAME(545,J),J=1,MAXSCL)/
     1'ANDE','    ','DARL','KSAM','TEST','CRIT','VALU','    '/
      DATA INFLAV(545)/2/
      DATA INLONG(545)/'ANDERSON DARLING K-SAMPLE TEST CRITICAL VALUE'/
C
      DATA INCASE(546)/'ADKC'/
      DATA (INAME(546,J),J=1,MAXSCL)/
     1'ANDE','    ','DARL','K   ','SAMP','TEST','CRIT','VALU'/
      DATA INFLAV(546)/2/
      DATA INLONG(546)/'ANDERSON DARLING K-SAMPLE TEST CRITICAL VALUE'/
C
      DATA INCASE(547)/'ADKS'/
      DATA (INAME(547,J),J=1,MAXSCL)/
     1'ANDE','    ','DARL','KSAM','TEST','    ','    ','    '/
      DATA INFLAV(547)/2/
      DATA INLONG(547)/'ANDERSON DARLING K-SAMPLE TEST'/
C
      DATA INCASE(548)/'ADKS'/
      DATA (INAME(548,J),J=1,MAXSCL)/
     1'ANDE','    ','DARL','K   ','SAMP','TEST','    ','    '/
      DATA INFLAV(548)/2/
      DATA INLONG(548)/'ANDERSON DARLING K-SAMPLE TEST'/
C
      DATA INCASE(549)/'KSCV'/
      DATA (INAME(549,J),J=1,MAXSCL)/
     1'KOLM','    ','SMIR','TWO ','SAMP','TEST','CRIT','VALU'/
      DATA INFLAV(549)/2/
      DATA INLONG(549)
     1     /'TWO SAMPLE KOLMOGOROV SMIRNOV TEST CRITICAL VALUE'/
C
      DATA INCASE(550)/'KSCV'/
      DATA (INAME(550,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','KOLM','SMIR','TEST','CRIT','VALU'/
      DATA INFLAV(550)/2/
      DATA INLONG(550)
     1     /'TWO SAMPLE KOLMOGOROV SMIRNOV TEST CRITICAL VALUE'/
C
      DATA INCASE(551)/'KS2S'/
      DATA (INAME(551,J),J=1,MAXSCL)/
     1'KOLM','    ','SMIR','TWO ','SAMP','TEST','    ','    '/
      DATA INFLAV(551)/2/
      DATA INLONG(551)/'TWO SAMPLE KOLMOGOROV SMIRNOV TEST'/
C
      DATA INCASE(552)/'KS2S'/
      DATA (INAME(552,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','KOLM','SMIR','TEST','    ','    '/
      DATA INFLAV(552)/2/
      DATA INLONG(552)/'TWO SAMPLE KOLMOGOROV SMIRNOV TEST'/
C
      DATA INCASE(553)/'WSPV'/
      DATA (INAME(553,J),J=1,MAXSCL)/
     1'WILK','    ','SHAP','NORM','TEST','PVAL','    ','    '/
      DATA INFLAV(553)/1/
      DATA INLONG(553)/'WILK SHAPIRO NORMALITY TEST P-VALUE'/
C
      DATA INCASE(554)/'WSPV'/
      DATA (INAME(554,J),J=1,MAXSCL)/
     1'WILK','    ','SHAP','TEST','PVAL','    ','    ','    '/
      DATA INFLAV(554)/1/
      DATA INLONG(554)/'WILK SHAPIRO NORMALITY TEST P-VALUE'/
C
      DATA INCASE(555)/'WSPV'/
      DATA (INAME(555,J),J=1,MAXSCL)/
     1'WILK','    ','SHAP','PVAL','    ','    ','    ','    '/
      DATA INFLAV(555)/1/
      DATA INLONG(555)/'WILK SHAPIRO NORMALITY TEST PVALUE'/
C
      DATA INCASE(556)/'WSHA'/
      DATA (INAME(556,J),J=1,MAXSCL)/
     1'WILK','    ','SHAP','NORM','TEST','    ','    ','    '/
      DATA INFLAV(556)/1/
      DATA INLONG(556)/'WILK SHAPIRO NORMALITY TEST'/
C
      DATA INCASE(557)/'WSHA'/
      DATA (INAME(557,J),J=1,MAXSCL)/
     1'WILK','    ','SHAP','TEST','    ','    ','    ','    '/
      DATA INFLAV(557)/1/
      DATA INLONG(557)/'WILK SHAPIRO NORMALITY TEST'/
C
      DATA INCASE(558)/'WSPV'/
      DATA (INAME(558,J),J=1,MAXSCL)/
     1'WILK','    ','SHAP','P   ','VALU','    ','    ','    '/
      DATA INFLAV(558)/1/
      DATA INLONG(558)/'WILK SHAPIRO NORMALITY TEST PVALUE'/
C
      DATA INCASE(559)/'CSFP'/
      DATA (INAME(559,J),J=1,MAXSCL)/
     1'CUMU','    ','SUM ','FORW','TEST','PVAL','    ','    '/
      DATA INFLAV(559)/1/
      DATA INLONG(559)/'CUMULATIVE SUM FORWARD TEST P-VALUE'/
C
      DATA INCASE(560)/'CSFP'/
      DATA (INAME(560,J),J=1,MAXSCL)/
     1'CUMU','    ','SUM ','FORW','TEST','P   ','VALU','    '/
      DATA INFLAV(560)/1/
      DATA INLONG(560)/'CUMULATIVE SUM FORWARD TEST P-VALUE'/
C
      DATA INCASE(561)/'CSFT'/
      DATA (INAME(561,J),J=1,MAXSCL)/
     1'CUMU','    ','SUM ','FORW','TEST','    ','    ','    '/
      DATA INFLAV(561)/1/
      DATA INLONG(561)/'CUMULATIVE SUM FORWARD TEST'/
C
      DATA INCASE(562)/'CSBP'/
      DATA (INAME(562,J),J=1,MAXSCL)/
     1'CUMU','    ','SUM ','BACK','TEST','PVAL','    ','    '/
      DATA INFLAV(562)/1/
      DATA INLONG(562)/'CUMULATIVE SUM BACKWARD TEST P-VALUE'/
C
      DATA INCASE(563)/'CSBP'/
      DATA (INAME(563,J),J=1,MAXSCL)/
     1'CUMU','    ','SUM ','BACK','TEST','P   ','VALU','    '/
      DATA INFLAV(563)/1/
      DATA INLONG(563)/'CUMULATIVE SUM BACKWARD TEST P-VALUE'/
C
      DATA INCASE(564)/'CSBT'/
      DATA (INAME(564,J),J=1,MAXSCL)/
     1'CUMU','    ','SUM ','BACK','TEST','    ','    ','    '/
      DATA INFLAV(564)/1/
      DATA INLONG(564)/'CUMULATIVE SUM BACKWARD TEST'/
C
      DATA INCASE(565)/'1LNT'/
      DATA (INAME(565,J),J=1,MAXSCL)/
     1'NORM','    ','TOLE','ONE ','SIDE','LOWE','LIMI','    '/
      DATA INFLAV(565)/1/
      DATA INLONG(565)/'NORMAL TOLERANCE ONE-SIDED LOWER LIMIT'/
C
      DATA INCASE(566)/'1UNT'/
      DATA (INAME(566,J),J=1,MAXSCL)/
     1'NORM','    ','TOLE','ONE ','SIDE','UPPE','LIMI','    '/
      DATA INFLAV(566)/1/
      DATA INLONG(566)/'NORMAL TOLERANCE ONE-SIDED UPPER LIMIT'/
C
      DATA INCASE(567)/'1KNT'/
      DATA (INAME(567,J),J=1,MAXSCL)/
     1'NORM','    ','TOLE','ONE ','SIDE','K   ','FACT','    '/
      DATA INFLAV(567)/1/
      DATA INLONG(567)/'NORMAL TOLERANCE ONE-SIDED K FACTOR'/
C
      DATA INCASE(568)/'2LNT'/
      DATA (INAME(568,J),J=1,MAXSCL)/
     1'NORM','    ','TOLE','LOWE','LIMI','    ','    ','    '/
      DATA INFLAV(568)/1/
      DATA INLONG(568)/'NORMAL TOLERANCE LOWER LIMIT'/
C
      DATA INCASE(569)/'2UNT'/
      DATA (INAME(569,J),J=1,MAXSCL)/
     1'NORM','    ','TOLE','UPPE','LIMI','    ','    ','    '/
      DATA INFLAV(569)/1/
      DATA INLONG(569)/'NORMAL TOLERANCE UPPER LIMIT'/
C
      DATA INCASE(570)/'2KNT'/
      DATA (INAME(570,J),J=1,MAXSCL)/
     1'NORM','    ','TOLE','K   ','FACT','    ','    ','    '/
      DATA INFLAV(570)/1/
      DATA INLONG(570)/'NORMAL TOLERANCE K FACTOR'/
C
      DATA INCASE(571)/'FTCD'/
      DATA (INAME(571,J),J=1,MAXSCL)/
     1'F   ','    ','TEST','CDF ','    ','    ','    ','    '/
      DATA INFLAV(571)/2/
      DATA INLONG(571)/'F TEST CDF'/
C
      DATA INCASE(572)/'FTPV'/
      DATA (INAME(572,J),J=1,MAXSCL)/
     1'F   ','    ','TEST','PVAL','    ','    ','    ','    '/
      DATA INFLAV(572)/2/
      DATA INLONG(572)/'F TEST PVALUE'/
C
      DATA INCASE(573)/'FTES'/
      DATA (INAME(573,J),J=1,MAXSCL)/
     1'F   ','    ','TEST','    ','    ','    ','    ','    '/
      DATA INFLAV(573)/2/
      DATA INLONG(573)/'F TEST'/
C
      DATA INCASE(574)/'1T2P'/
      DATA (INAME(574,J),J=1,MAXSCL)/
     1'ONE ','    ','SAMP','T   ','TEST','P   ','VALU','    '/
      DATA INFLAV(574)/1/
      DATA INLONG(574)/'ONE-SAMPLE T-TEST P-VALUE'/
C
      DATA INCASE(575)/'1TLP'/
      DATA (INAME(575,J),J=1,MAXSCL)/
     1'ONE ','    ','SAMP','T   ','TEST','LOWE','TAIL','PVAL'/
      DATA INFLAV(575)/1/
      DATA INLONG(575)/'ONE-SAMPLE T-TEST LOWER TAIL P-VALUE'/
C
      DATA INCASE(576)/'1TUP'/
      DATA (INAME(576,J),J=1,MAXSCL)/
     1'ONE ','    ','SAMP','T   ','TEST','UPPE','TAIL','PVAL'/
      DATA INFLAV(576)/1/
      DATA INLONG(576)/'ONE-SAMPLE T-TEST UPPER TAIL P-VALUE'/
C
      DATA INCASE(577)/'1TTE'/
      DATA (INAME(577,J),J=1,MAXSCL)/
     1'ONE ','    ','SAMP','T   ','TEST','    ','    ','    '/
      DATA INFLAV(577)/1/
      DATA INLONG(577)/'ONE-SAMPLE T-TEST'/
C
      DATA INCASE(578)/'2TCD'/
      DATA (INAME(578,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','T   ','TEST','CDF ','    ','    '/
      DATA INFLAV(578)/2/
      DATA INLONG(578)/'TWO-SAMPLE T-TEST CDF'/
C
      DATA INCASE(579)/'2T2P'/
      DATA (INAME(579,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','T   ','TEST','P   ','VALU','    '/
      DATA INFLAV(579)/2/
      DATA INLONG(579)/'TWO-SAMPLE T-TEST P-VALUE'/
C
      DATA INCASE(580)/'2T2P'/
      DATA (INAME(580,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','T   ','TEST','PVAL','    ','    '/
      DATA INFLAV(580)/2/
      DATA INLONG(580)/'TWO-SAMPLE T-TEST P-VALUE'/
C
      DATA INCASE(581)/'2TLP'/
      DATA (INAME(581,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','T   ','TEST','LOWE','TAIL','PVAL'/
      DATA INFLAV(581)/2/
      DATA INLONG(581)/'TWO-SAMPLE T-TEST LOWER TAIL P-VALUE'/
C
      DATA INCASE(582)/'2TUP'/
      DATA (INAME(582,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','T   ','TEST','UPPE','TAIL','PVAL'/
      DATA INFLAV(582)/2/
      DATA INLONG(582)/'TWO-SAMPLE T-TEST UPPER TAIL P-VALUE'/
C
      DATA INCASE(583)/'2TTE'/
      DATA (INAME(583,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','T   ','TEST','    ','    ','    '/
      DATA INFLAV(583)/2/
      DATA INLONG(583)/'TWO-SAMPLE T-TEST'/
C
      DATA INCASE(584)/'PTCD'/
      DATA (INAME(584,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','PAIR','T   ','TEST','CDF ','    '/
      DATA INFLAV(584)/2/
      DATA INLONG(584)/'TWO-SAMPLE PAIRED T-TEST CDF'/
C
      DATA INCASE(585)/'PT2P'/
      DATA (INAME(585,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','PAIR','T   ','TEST','P   ','VALU'/
      DATA INFLAV(585)/2/
      DATA INLONG(585)/'TWO-SAMPLE PAIRED T-TEST P-VALUE'/
C
      DATA INCASE(586)/'PT2P'/
      DATA (INAME(586,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','PAIR','T   ','TEST','PVAL','    '/
      DATA INFLAV(586)/2/
      DATA INLONG(586)/'TWO-SAMPLE PAIRED T-TEST P-VALUE'/
C
      DATA INCASE(587)/'PTLP'/
      DATA (INAME(587,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','PAIR','TTES','LOWE','TAIL','PVAL'/
      DATA INFLAV(587)/2/
      DATA INLONG(587)/'TWO-SAMPLE PAIRED T-TEST LOWER TAIL P-VALUE'/
C
      DATA INCASE(588)/'PTUP'/
      DATA (INAME(588,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','PAIR','TTES','UPPE','TAIL','PVAL'/
      DATA INFLAV(588)/2/
      DATA INLONG(588)/'TWO-SAMPLE PAIRED T-TEST UPPER TAIL P-VALUE'/
C
      DATA INCASE(589)/'PTTE'/
      DATA (INAME(589,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','PAIR','T   ','TEST','    ','    '/
      DATA INFLAV(589)/2/
      DATA INLONG(589)/'TWO-SAMPLE PAIRED T-TEST'/
C
      DATA INCASE(590)/'CSLP'/
      DATA (INAME(590,J),J=1,MAXSCL)/
     1'CHI ','    ','SQUA','SD  ','TEST','LOWE','TAIL','PVAL'/
      DATA INFLAV(590)/1/
      DATA INLONG(590)/'CHI-SQUARE SD LOWER TAIL PVALUE'/
C
      DATA INCASE(591)/'CSLP'/
      DATA (INAME(591,J),J=1,MAXSCL)/
     1'CHI ','    ','SQUA','STAN','DEVI','LOWE','TAIL','PVAL'/
      DATA INFLAV(591)/1/
      DATA INLONG(591)/'CHI-SQUARE SD LOWER TAIL PVALUE'/
C
      DATA INCASE(592)/'CSLP'/
      DATA (INAME(592,J),J=1,MAXSCL)/
     1'CHI ','    ','SQUA','SD  ','LOWE','TAIL','PVAL','    '/
      DATA INFLAV(592)/1/
      DATA INLONG(592)/'CHI-SQUARE SD LOWER TAIL PVALUE'/
C
      DATA INCASE(593)/'CSUP'/
      DATA (INAME(593,J),J=1,MAXSCL)/
     1'CHI ','    ','SQUA','SD  ','TEST','UPPE','TAIL','PVAL'/
      DATA INFLAV(593)/1/
      DATA INLONG(593)/'CHI-SQUARE SD UPPER TAIL PVALUE'/
C
      DATA INCASE(594)/'CSUP'/
      DATA (INAME(594,J),J=1,MAXSCL)/
     1'CHI ','    ','SQUA','STAN','DEVI','UPPE','TAIL','PVAL'/
      DATA INFLAV(594)/1/
      DATA INLONG(594)/'CHI-SQUARE SD UPPER TAIL PVALUE'/
C
      DATA INCASE(595)/'CSUP'/
      DATA (INAME(595,J),J=1,MAXSCL)/
     1'CHI ','    ','SQUA','SD  ','UPPE','TAIL','PVAL','    '/
      DATA INFLAV(595)/1/
      DATA INLONG(595)/'CHI-SQUARE SD UPPER TAIL PVALUE'/
C
      DATA INCASE(596)/'CSSD'/
      DATA (INAME(596,J),J=1,MAXSCL)/
     1'CHI ','    ','SQUA','STAN','DEVI','TEST','    ','    '/
      DATA INFLAV(596)/1/
      DATA INLONG(596)/'CHI-SQUARE STANDARD DEVIATION STATISTIC'/
C
      DATA INCASE(597)/'CSSD'/
      DATA (INAME(597,J),J=1,MAXSCL)/
     1'CHI ','    ','SQUA','SD  ','TEST','    ','    ','    '/
      DATA INFLAV(597)/1/
      DATA INLONG(597)/'CHI-SQUARE STANDARD DEVIATION STATISTIC'/
C
      DATA INCASE(598)/'CSSD'/
      DATA (INAME(598,J),J=1,MAXSCL)/
     1'CHI ','    ','SQUA','SD  ','    ','    ','    ','    '/
      DATA INFLAV(598)/1/
      DATA INLONG(598)/'CHI-SQUARE STANDARD DEVIATION STATISTIC'/
C
      DATA INCASE(599)/'CSSD'/
      DATA (INAME(599,J),J=1,MAXSCL)/
     1'CHI ','    ','SQUA','STAN','DEVI','    ','    ','    '/
      DATA INFLAV(599)/1/
      DATA INLONG(599)/'CHI-SQUARE STANDARD DEVIATION STATISTIC'/
C
      DATA INCASE(600)/'2SCD'/
      DATA (INAME(600,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','SIGN','TEST','CDF ','    ','    '/
      DATA INFLAV(600)/2/
      DATA INLONG(600)/'TWO-SAMPLE SIGN TEST CDF'/
C
      DATA INCASE(601)/'2S2P'/
      DATA (INAME(601,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','SIGN','TEST','P   ','VALU','    '/
      DATA INFLAV(601)/2/
      DATA INLONG(601)/'TWO-SAMPLE SIGN TEST P-VALUE'/
C
      DATA INCASE(602)/'2S2P'/
      DATA (INAME(602,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','SIGN','TEST','PVAL','    ','    '/
      DATA INFLAV(602)/2/
      DATA INLONG(602)/'TWO-SAMPLE SIGN TEST P-VALUE'/
C
      DATA INCASE(603)/'2SLP'/
      DATA (INAME(603,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','SIGN','TEST','LOWE','TAIL','PVAL'/
      DATA INFLAV(603)/2/
      DATA INLONG(603)/'TWO-SAMPLE SIGN TEST LOWER TAIL P-VALUE'/
C
      DATA INCASE(604)/'2SUP'/
      DATA (INAME(604,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','SIGN','TEST','UPPE','TAIL','PVAL'/
      DATA INFLAV(604)/2/
      DATA INLONG(604)/'TWO-SAMPLE SIGN TEST UPPER TAIL P-VALUE'/
C
      DATA INCASE(605)/'2STE'/
      DATA (INAME(605,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','SIGN','TEST','    ','    ','    '/
      DATA INFLAV(605)/2/
      DATA INLONG(605)/'TWO-SAMPLE SIGN TEST'/
C
      DATA INCASE(606)/'1SCD'/
      DATA (INAME(606,J),J=1,MAXSCL)/
     1'ONE ','    ','SAMP','SIGN','TEST','CDF ','    ','    '/
      DATA INFLAV(606)/1/
      DATA INLONG(606)/'ONE-SAMPLE SIGN TEST CDF'/
C
      DATA INCASE(607)/'1S2P'/
      DATA (INAME(607,J),J=1,MAXSCL)/
     1'ONE ','    ','SAMP','SIGN','TEST','P   ','VALU','    '/
      DATA INFLAV(607)/1/
      DATA INLONG(607)/'ONE-SAMPLE SIGN TEST P-VALUE'/
C
      DATA INCASE(608)/'1S2P'/
      DATA (INAME(608,J),J=1,MAXSCL)/
     1'ONE ','    ','SAMP','SIGN','TEST','PVAL','    ','    '/
      DATA INFLAV(608)/1/
      DATA INLONG(608)/'ONE-SAMPLE SIGN TEST P-VALUE'/
C
      DATA INCASE(609)/'1SLP'/
      DATA (INAME(609,J),J=1,MAXSCL)/
     1'ONE ','    ','SAMP','SIGN','TEST','LOWE','TAIL','PVAL'/
      DATA INFLAV(609)/1/
      DATA INLONG(609)/'ONE-SAMPLE SIGN TEST LOWER TAIL P-VALUE'/
C
      DATA INCASE(610)/'1SUP'/
      DATA (INAME(610,J),J=1,MAXSCL)/
     1'ONE ','    ','SAMP','SIGN','TEST','UPPE','TAIL','PVAL'/
      DATA INFLAV(610)/1/
      DATA INLONG(610)/'ONE-SAMPLE SIGN TEST UPPER TAIL P-VALUE'/
C
      DATA INCASE(611)/'1STE'/
      DATA (INAME(611,J),J=1,MAXSCL)/
     1'ONE ','    ','SAMP','SIGN','TEST','    ','    ','    '/
      DATA INFLAV(611)/1/
      DATA INLONG(611)/'ONE-SAMPLE SIGN TEST'/
C
      DATA INCASE(612)/'CALO'/
      DATA (INAME(612,J),J=1,MAXSCL)/
     1'CAUC','    ','PPCC','LOCA','    ','    ','    ','    '/
      DATA INFLAV(612)/1/
      DATA INLONG(612)/'CAUCHY PPCC LOCATION'/
C
      DATA INCASE(613)/'LOLO'/
      DATA (INAME(613,J),J=1,MAXSCL)/
     1'LOGI','    ','PPCC','LOCA','    ','    ','    ','    '/
      DATA INFLAV(613)/1/
      DATA INLONG(613)/'LOGISTIC PPCC LOCATION'/
C
      DATA INCASE(614)/'DELO'/
      DATA (INAME(614,J),J=1,MAXSCL)/
     1'DOUB','    ','EXPO','PPCC','LOCA','    ','    ','    '/
      DATA INFLAV(614)/1/
      DATA INLONG(614)/'DOUBLE EXPONENTIAL PPCC LOCATION'/
C
      DATA INCASE(615)/'HSLO'/
      DATA (INAME(615,J),J=1,MAXSCL)/
     1'HYPE','    ','SECA','PPCC','LOCA','    ','    ','    '/
      DATA INFLAV(615)/1/
      DATA INLONG(615)/'HYPERBOLIC SECANT PPCC LOCATION'/
C
      DATA INCASE(616)/'HNLO'/
      DATA (INAME(616,J),J=1,MAXSCL)/
     1'HALF','    ','NORM','PPCC','LOCA','    ','    ','    '/
      DATA INFLAV(616)/1/
      DATA INLONG(616)/'HALF-NORMAL PPCC LOCATION'/
C
      DATA INCASE(617)/'COLO'/
      DATA (INAME(617,J),J=1,MAXSCL)/
     1'COSI','    ','PPCC','LOCA','    ','    ','    ','    '/
      DATA INFLAV(617)/1/
      DATA INLONG(617)/'COSINE PPCC LOCATION'/
C
      DATA INCASE(618)/'ANLO'/
      DATA (INAME(618,J),J=1,MAXSCL)/
     1'ANGL','    ','PPCC','LOCA','    ','    ','    ','    '/
      DATA INFLAV(618)/1/
      DATA INLONG(618)/'ANGLIT PPCC LOCATION'/
C
      DATA INCASE(619)/'ARLO'/
      DATA (INAME(619,J),J=1,MAXSCL)/
     1'ARCS','    ','PPCC','LOCA','    ','    ','    ','    '/
      DATA INFLAV(619)/1/
      DATA INLONG(619)/'ARCSINE PPCC LOCATION'/
C
      DATA INCASE(620)/'EXLO'/
      DATA (INAME(620,J),J=1,MAXSCL)/
     1'EXPO','    ','PPCC','LOCA','    ','    ','    ','    '/
      DATA INFLAV(620)/1/
      DATA INLONG(620)/'EXPONENTIAL PPCC LOCATION'/
C
      DATA INCASE(621)/'SLLO'/
      DATA (INAME(621,J),J=1,MAXSCL)/
     1'SLAS','    ','PPCC','LOCA','    ','    ','    ','    '/
      DATA INFLAV(621)/1/
      DATA INLONG(621)/'SLASH PPCC LOCATION'/
C
      DATA INCASE(622)/'RALO'/
      DATA (INAME(622,J),J=1,MAXSCL)/
     1'RAYL','    ','PPCC','LOCA','    ','    ','    ','    '/
      DATA INFLAV(622)/1/
      DATA INLONG(622)/'RAYLEIGH PPCC LOCATION'/
C
      DATA INCASE(623)/'MXLO'/
      DATA (INAME(623,J),J=1,MAXSCL)/
     1'MAXW','    ','PPCC','LOCA','    ','    ','    ','    '/
      DATA INFLAV(623)/1/
      DATA INLONG(623)/'MAXWELL PPCC LOCATION'/
C
      DATA INCASE(624)/'TLPP'/
      DATA (INAME(624,J),J=1,MAXSCL)/
     1'TUKE','    ','LAMB','PPCC','STAT','    ','    ','    '/
      DATA INFLAV(624)/1/
      DATA INLONG(624)/'TUKEY LAMBDA PPCC'/
C
      DATA INCASE(625)/'DELO'/
      DATA (INAME(625,J),J=1,MAXSCL)/
     1'LAPL','    ','PPCC','LOCA','    ','    ','    ','    '/
      DATA INFLAV(625)/1/
      DATA INLONG(625)/'DOUBLE EXPONENTIAL PPCC LOCATION'/
C
      DATA INCASE(626)/'HCLO'/
      DATA (INAME(626,J),J=1,MAXSCL)/
     1'HALF','    ','CAUC','PPCC','LOCA','    ','    ','    '/
      DATA INFLAV(626)/1/
      DATA INLONG(626)/'HALF-CAUCHY PPCC LOCATION'/
C
      DATA INCASE(627)/'SCLO'/
      DATA (INAME(627,J),J=1,MAXSCL)/
     1'SEMI','    ','CIRC','PPCC','LOCA','    ','    ','    '/
      DATA INFLAV(627)/1/
      DATA INLONG(627)/'SEMI-CIRCULAR PPCC LOCATION'/
C
      DATA INCASE(628)/'G1SC'/
      DATA (INAME(628,J),J=1,MAXSCL)/
     1'MINI','    ','GUMB','PPCC','SCAL','    ','    ','    '/
      DATA INFLAV(628)/1/
      DATA INLONG(628)/'MINIMUM GUMBEL PPCC SCALE'/
C
      DATA INCASE(629)/'G2SC'/
      DATA (INAME(629,J),J=1,MAXSCL)/
     1'MAXI','    ','GUMB','PPCC','SCAL','    ','    ','    '/
      DATA INFLAV(629)/1/
      DATA INLONG(629)/'MAXIMUM GUMBEL PPCC SCALE'/
C
      DATA INCASE(630)/'WEPP'/
      DATA (INAME(630,J),J=1,MAXSCL)/
     1'WEIB','    ','PPCC','STAT','    ','    ','    ','    '/
      DATA INFLAV(630)/1/
      DATA INLONG(630)/'WEIBULL PPCC'/
C
      DATA INCASE(631)/'WABA'/
      DATA (INAME(631,J),J=1,MAXSCL)/
     1'WEIB','    ','A   ','BASI','    ','    ','    ','    '/
      DATA INFLAV(631)/1/
      DATA INLONG(631)/'WEIBULL A BASIS'/
C
      DATA INCASE(632)/'WABA'/
      DATA (INAME(632,J),J=1,MAXSCL)/
     1'WEIB','    ','ABAS','    ','    ','    ','    ','    '/
      DATA INFLAV(632)/1/
      DATA INLONG(632)/'WEIBULL A BASIS'/
C
      DATA INCASE(633)/'WBBA'/
      DATA (INAME(633,J),J=1,MAXSCL)/
     1'WEIB','    ','B   ','BASI','    ','    ','    ','    '/
      DATA INFLAV(633)/1/
      DATA INLONG(633)/'WEIBULL B BASIS'/
C
      DATA INCASE(634)/'WBBA'/
      DATA (INAME(634,J),J=1,MAXSCL)/
     1'WEIB','    ','BBAS','    ','    ','    ','    ','    '/
      DATA INFLAV(634)/1/
      DATA INLONG(634)/'WEIBULL B BASIS'/
C
      DATA INCASE(635)/'LABA'/
      DATA (INAME(635,J),J=1,MAXSCL)/
     1'LOGN','    ','A   ','BASI','    ','    ','    ','    '/
      DATA INFLAV(635)/1/
      DATA INLONG(635)/'LOGNORMAL A BASIS'/
C
      DATA INCASE(636)/'LABA'/
      DATA (INAME(636,J),J=1,MAXSCL)/
     1'LOGN','    ','ABAS','    ','    ','    ','    ','    '/
      DATA INFLAV(636)/1/
      DATA INLONG(636)/'LOGNORMAL A BASIS'/
C
      DATA INCASE(637)/'LBBA'/
      DATA (INAME(637,J),J=1,MAXSCL)/
     1'LOGN','    ','B   ','BASI','    ','    ','    ','    '/
      DATA INFLAV(637)/1/
      DATA INLONG(637)/'LOGNORMAL B BASIS'/
C
      DATA INCASE(638)/'LBBA'/
      DATA (INAME(638,J),J=1,MAXSCL)/
     1'LOGN','    ','BBAS','    ','    ','    ','    ','    '/
      DATA INFLAV(638)/1/
      DATA INLONG(638)/'LOGNORMAL B BASIS'/
C
      DATA INCASE(639)/'NABA'/
      DATA (INAME(639,J),J=1,MAXSCL)/
     1'NORM','    ','A   ','BASI','    ','    ','    ','    '/
      DATA INFLAV(639)/1/
      DATA INLONG(639)/'NORMAL A BASIS'/
C
      DATA INCASE(640)/'NABA'/
      DATA (INAME(640,J),J=1,MAXSCL)/
     1'NORM','    ','ABAS','    ','    ','    ','    ','    '/
      DATA INFLAV(640)/1/
      DATA INLONG(640)/'NORMAL A BASIS'/
C
      DATA INCASE(641)/'NBBA'/
      DATA (INAME(641,J),J=1,MAXSCL)/
     1'NORM','    ','B   ','BASI','    ','    ','    ','    '/
      DATA INFLAV(641)/1/
      DATA INLONG(641)/'NORMAL B BASIS'/
C
      DATA INCASE(642)/'NBBA'/
      DATA (INAME(642,J),J=1,MAXSCL)/
     1'NORM','    ','BBAS','    ','    ','    ','    ','    '/
      DATA INFLAV(642)/1/
      DATA INLONG(642)/'NORMAL B BASIS'/
C
      DATA INCASE(643)/'ZABA'/
      DATA (INAME(643,J),J=1,MAXSCL)/
     1'NONP','    ','A   ','BASI','    ','    ','    ','    '/
      DATA INFLAV(643)/1/
      DATA INLONG(643)/'NONPARAMETRIC A BASIS'/
C
      DATA INCASE(644)/'ZABA'/
      DATA (INAME(644,J),J=1,MAXSCL)/
     1'NONP','    ','ABAS','    ','    ','    ','    ','    '/
      DATA INFLAV(644)/1/
      DATA INLONG(644)/'NONPARAMETRIC A BASIS'/
C
      DATA INCASE(645)/'ZBBA'/
      DATA (INAME(645,J),J=1,MAXSCL)/
     1'NONP','    ','B   ','BASI','    ','    ','    ','    '/
      DATA INFLAV(645)/1/
      DATA INLONG(645)/'NONPARAMETRIC B BASIS'/
C
      DATA INCASE(646)/'ZBBA'/
      DATA (INAME(646,J),J=1,MAXSCL)/
     1'NONP','    ','BBAS','    ','    ','    ','    ','    '/
      DATA INFLAV(646)/1/
      DATA INLONG(646)/'NONPARAMETRIC B BASIS'/
C
      DATA INCASE(647)/'1WCD'/
      DATA (INAME(647,J),J=1,MAXSCL)/
     1'ONE ','    ','SAMP','WILC','SIGN','RANK','TEST','CDF '/
      DATA INFLAV(647)/1/
      DATA INLONG(647)/'ONE-SAMPLE WILCOXON SIGNED RANK TEST CDF'/
C
      DATA INCASE(648)/'1W2P'/
      DATA (INAME(648,J),J=1,MAXSCL)/
     1'ONE ','    ','SAMP','WILC','SIGN','RANK','TEST','PVAL'/
      DATA INFLAV(648)/1/
      DATA INLONG(648)/'ONE-SAMPLE WILCOXON SIGNED RANK TEST P-VALUE'/
C
      DATA INCASE(649)/'1WLP'/
      DATA (INAME(649,J),J=1,MAXSCL)/
     1'ONE ','    ','SAMP','WILC','TEST','LOWE','TAIL','PVAL'/
      DATA INFLAV(649)/1/
      DATA INLONG(649)/'ONE-SAMPLE WILCOXON TEST LOWER TAIL P-VALUE'/
C
      DATA INCASE(650)/'1WUP'/
      DATA (INAME(650,J),J=1,MAXSCL)/
     1'ONE ','    ','SAMP','WILC','TEST','UPPE','TAIL','PVAL'/
      DATA INFLAV(650)/1/
      DATA INLONG(650)/'ONE-SAMPLE WILCOXON TEST UPPER TAIL P-VALUE'/
C
      DATA INCASE(651)/'1WTE'/
      DATA (INAME(651,J),J=1,MAXSCL)/
     1'ONE ','    ','SAMP','WILC','SIGN','RANK','TEST','    '/
      DATA INFLAV(651)/1/
      DATA INLONG(651)/'ONE-SAMPLE T-TEST'/
C
      DATA INCASE(652)/'2WCD'/
      DATA (INAME(652,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','WILC','SIGN','RANK','TEST','CDF '/
      DATA INFLAV(652)/2/
      DATA INLONG(652)/'TWO-SAMPLE WILCOXON SIGNED RANK TEST CDF'/
C
      DATA INCASE(653)/'2W2P'/
      DATA (INAME(653,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','WILC','SIGN','RANK','TEST','PVAL'/
      DATA INFLAV(653)/2/
      DATA INLONG(653)/'TWO-SAMPLE WILCOXON SIGNED RANK TEST P-VALUE'/
C
      DATA INCASE(654)/'2WLP'/
      DATA (INAME(654,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','WILC','TEST','LOWE','TAIL','PVAL'/
      DATA INFLAV(654)/2/
      DATA INLONG(654)/'TWO-SAMPLE WILCOXON TEST LOWER TAIL P-VALUE'/
C
      DATA INCASE(655)/'2WUP'/
      DATA (INAME(655,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','WILC','TEST','UPPE','TAIL','PVAL'/
      DATA INFLAV(655)/2/
      DATA INLONG(655)/'TWO-SAMPLE WILCOXON TEST UPPER TAIL P-VALUE'/
C
      DATA INCASE(656)/'2WTE'/
      DATA (INAME(656,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','WILC','SIGN','RANK','TEST','    '/
      DATA INFLAV(656)/2/
      DATA INLONG(656)/'TWO-SAMPLE WILCOXON SIGNED RANK TEST'/
C
      DATA INCASE(657)/'MWCD'/
      DATA (INAME(657,J),J=1,MAXSCL)/
     1'MANN','    ','WHIT','RANK','SUM ','TEST','CDF ','    '/
      DATA INFLAV(657)/2/
      DATA INLONG(657)/'MANN WHITNEY RANK SUM TEST CDF'/
C
      DATA INCASE(658)/'MW2P'/
      DATA (INAME(658,J),J=1,MAXSCL)/
     1'MANN','    ','WHIT','RANK','SUM ','TEST','PVAL','    '/
      DATA INFLAV(658)/2/
      DATA INLONG(658)/'MANN WHITNEY RANK SUM TEST PVALUE'/
C
      DATA INCASE(659)/'MWLP'/
      DATA (INAME(659,J),J=1,MAXSCL)/
     1'MANN','    ','WHIT','RANK','SUM ','LOWE','TAIL','PVAL'/
      DATA INFLAV(659)/2/
      DATA INLONG(659)/'MANN WHITNEY RANK SUM LOWER TAIL PVALUE'/
C
      DATA INCASE(660)/'MWUP'/
      DATA (INAME(660,J),J=1,MAXSCL)/
     1'MANN','    ','WHIT','RANK','SUM ','UPPE','TAIL','PVAL'/
      DATA INFLAV(660)/2/
      DATA INLONG(660)/'MANN WHITNEY RANK SUM UPPER TAIL PVALUE'/
C
      DATA INCASE(661)/'MWTE'/
      DATA (INAME(661,J),J=1,MAXSCL)/
     1'MANN','    ','WHIT','RANK','SUM ','TEST','    ','    '/
      DATA INFLAV(661)/2/
      DATA INLONG(661)/'MANN WHITNEY RANK SUM TEST'/
C
      DATA INCASE(662)/'MWUS'/
      DATA (INAME(662,J),J=1,MAXSCL)/
     1'MANN','    ','WHIT','U   ','STAT','    ','    ','    '/
      DATA INFLAV(662)/2/
      DATA INLONG(662)/'MANN WHITNEY U STATISTIC'/
C
      DATA INCASE(663)/'KLCD'/
      DATA (INAME(663,J),J=1,MAXSCL)/
     1'KLOT','    ','TEST','CDF ','    ','    ','    ','    '/
      DATA INFLAV(663)/2/
      DATA INLONG(663)/'KLOTZ TEST CDF'/
C
      DATA INCASE(664)/'KL2P'/
      DATA (INAME(664,J),J=1,MAXSCL)/
     1'KLOT','    ','TEST','PVAL','    ','    ','    ','    '/
      DATA INFLAV(664)/2/
      DATA INLONG(664)/'KLOTZ TEST PVALUE'/
C
      DATA INCASE(665)/'KLLP'/
      DATA (INAME(665,J),J=1,MAXSCL)/
     1'KLOT','    ','TEST','LOWE','TAIL','PVAL','    ','    '/
      DATA INFLAV(665)/2/
      DATA INLONG(665)/'KLOTZ TEST LOWER TAIL PVALUE'/
C
      DATA INCASE(666)/'KLUP'/
      DATA (INAME(666,J),J=1,MAXSCL)/
     1'KLOT','    ','TEST','UPPE','TAIL','PVAL','    ','    '/
      DATA INFLAV(666)/2/
      DATA INLONG(666)/'KLOTZ TEST UPPER TAIL PVALUE'/
C
      DATA INCASE(667)/'KLTE'/
      DATA (INAME(667,J),J=1,MAXSCL)/
     1'KLOT','    ','TEST','    ','    ','    ','    ','    '/
      DATA INFLAV(667)/2/
      DATA INLONG(667)/'KLOTZ TEST'/
C
      DATA INCASE(668)/'SRCD'/
      DATA (INAME(668,J),J=1,MAXSCL)/
     1'SQUA','    ','RANK','TEST','CDF ','    ','    ','    '/
      DATA INFLAV(668)/2/
      DATA INLONG(668)/'SQUARED RANK TEST CDF'/
C
      DATA INCASE(669)/'SR2P'/
      DATA (INAME(669,J),J=1,MAXSCL)/
     1'SQUA','    ','RANK','TEST','PVAL','    ','    ','    '/
      DATA INFLAV(669)/2/
      DATA INLONG(669)/'SQUARED RANK TEST PVALUE'/
C
      DATA INCASE(670)/'SRLP'/
      DATA (INAME(670,J),J=1,MAXSCL)/
     1'SQUA','    ','RANK','TEST','LOWE','TAIL','PVAL','    '/
      DATA INFLAV(670)/2/
      DATA INLONG(670)/'SQUARED RANK TEST LOWER TAILED PVALUE'/
C
      DATA INCASE(671)/'SRUP'/
      DATA (INAME(671,J),J=1,MAXSCL)/
     1'SQUA','    ','RANK','TEST','UPPE','TAIL','PVAL','    '/
      DATA INFLAV(671)/2/
      DATA INLONG(671)/'SQUARED RANK TEST UPPER TAILED PVALUE'/
C
      DATA INCASE(672)/'SRTE'/
      DATA (INAME(672,J),J=1,MAXSCL)/
     1'SQUA','    ','RANK','TEST','    ','    ','    ','    '/
      DATA INFLAV(672)/2/
      DATA INLONG(672)/'SQUARED RANK TEST'/
C
      DATA INCASE(673)/'ME2P'/
      DATA (INAME(673,J),J=1,MAXSCL)/
     1'MEDI','    ','TEST','PVAL','    ','    ','    ','    '/
      DATA INFLAV(673)/2/
      DATA INLONG(673)/'MEDIAN TEST PVALUE'/
C
      DATA INCASE(674)/'METE'/
      DATA (INAME(674,J),J=1,MAXSCL)/
     1'MEDI','    ','TEST','    ','    ','    ','    ','    '/
      DATA INFLAV(674)/2/
      DATA INLONG(674)/'MEDIAN TEST'/
C
      DATA INCASE(675)/'MEDI'/
      DATA (INAME(675,J),J=1,MAXSCL)/
     1'MEDI','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(675)/1/
      DATA INLONG(675)/'MEDIAN'/
C
      DATA INCASE(676)/'2F2P'/
      DATA (INAME(676,J),J=1,MAXSCL)/
     1'FISH','    ','TWO ','SAMP','RAND','TEST','PVAL','    '/
      DATA INFLAV(676)/2/
      DATA INLONG(676)/'FISHER TWO SAMPLE RANDOMIZATION TEST PVALUE'/
C
      DATA INCASE(677)/'2F2P'/
      DATA (INAME(677,J),J=1,MAXSCL)/
     1'FISH','    ','2   ','SAMP','RAND','TEST','PVAL','    '/
      DATA INFLAV(677)/2/
      DATA INLONG(677)/'FISHER TWO SAMPLE RANDOMIZATION TEST PVALUE'/
C
      DATA INCASE(678)/'2F1P'/
      DATA (INAME(678,J),J=1,MAXSCL)/
     1'FISH','    ','TWO ','SAMP','RAND','LOWE','TAIL','PVAL'/
      DATA INFLAV(678)/2/
      DATA INLONG(678)/'FISHER TWO SAMPLE RAND LOWER TAIL PVALUE'/
C
      DATA INCASE(679)/'2F1P'/
      DATA (INAME(679,J),J=1,MAXSCL)/
     1'FISH','    ','2   ','SAMP','RAND','LOWE','TAIL','PVAL'/
      DATA INFLAV(679)/2/
      DATA INLONG(679)/'FISHER TWO SAMPLE RAND LOWER TAIL PVALUE'/
C
      DATA INCASE(680)/'2SFR'/
      DATA (INAME(680,J),J=1,MAXSCL)/
     1'FISH','    ','TWO ','SAMP','RAND','TEST','    ','    '/
      DATA INFLAV(680)/2/
      DATA INLONG(680)/'FISHER TWO SAMPLE RANDOMIZATION TEST'/
C
      DATA INCASE(681)/'2SFR'/
      DATA (INAME(681,J),J=1,MAXSCL)/
     1'FISH','    ','2   ','SAMP','RAND','TEST','    ','    '/
      DATA INFLAV(681)/2/
      DATA INLONG(681)/'FISHER TWO SAMPLE RANDOMIZATION TEST'/
C
      DATA INCASE(682)/'CC2S'/
      DATA (INAME(682,J),J=1,MAXSCL)/
     1'CHI ','    ','SQUA','TWO ','SAMP','TEST','CDF ','    '/
      DATA INFLAV(682)/2/
      DATA INLONG(682)/'TWO SAMPLE CHI-SQUARE TEST CDF'/
C
      DATA INCASE(683)/'CC2S'/
      DATA (INAME(683,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','CHI ','SQUA','TEST','CDF ','    '/
      DATA INFLAV(683)/2/
      DATA INLONG(683)/'TWO SAMPLE CHI-SQUARE TEST CDF'/
C
      DATA INCASE(684)/'CC2S'/
      DATA (INAME(684,J),J=1,MAXSCL)/
     1'CHI ','    ','SQUA','2   ','SAMP','TEST','CDF ','    '/
      DATA INFLAV(684)/2/
      DATA INLONG(684)/'TWO SAMPLE CHI-SQUARE TEST CDF'/
C
      DATA INCASE(685)/'CC2S'/
      DATA (INAME(685,J),J=1,MAXSCL)/
     1'2   ','    ','SAMP','CHI ','SQUA','TEST','CDF ','    '/
      DATA INFLAV(685)/2/
      DATA INLONG(685)/'TWO SAMPLE CHI-SQUARE TEST CDF'/
C
      DATA INCASE(686)/'CP2S'/
      DATA (INAME(686,J),J=1,MAXSCL)/
     1'CHI ','    ','SQUA','TWO ','SAMP','TEST','PVAL','    '/
      DATA INFLAV(686)/2/
      DATA INLONG(686)/'TWO SAMPLE CHI-SQUARE TEST PVALUE'/
C
      DATA INCASE(687)/'CP2S'/
      DATA (INAME(687,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','CHI ','SQUA','TEST','PVAL','    '/
      DATA INFLAV(687)/2/
      DATA INLONG(687)/'TWO SAMPLE CHI-SQUARE TEST PVALUE'/
C
      DATA INCASE(688)/'CP2S'/
      DATA (INAME(688,J),J=1,MAXSCL)/
     1'CHI ','    ','SQUA','2   ','SAMP','TEST','PVAL','    '/
      DATA INFLAV(688)/2/
      DATA INLONG(688)/'TWO SAMPLE CHI-SQUARE TEST PVALUE'/
C
      DATA INCASE(689)/'CP2S'/
      DATA (INAME(689,J),J=1,MAXSCL)/
     1'2   ','    ','SAMP','CHI ','SQUA','TEST','PVAL','    '/
      DATA INFLAV(689)/2/
      DATA INLONG(689)/'TWO SAMPLE CHI-SQUARE TEST PVALUE'/
C
      DATA INCASE(690)/'CS2S'/
      DATA (INAME(690,J),J=1,MAXSCL)/
     1'CHI ','    ','SQUA','TWO ','SAMP','TEST','    ','    '/
      DATA INFLAV(690)/2/
      DATA INLONG(690)/'TWO SAMPLE CHI-SQUARE TEST'/
C
      DATA INCASE(691)/'CS2S'/
      DATA (INAME(691,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','CHI ','SQUA','TEST','    ','    '/
      DATA INFLAV(691)/2/
      DATA INLONG(691)/'TWO SAMPLE CHI-SQUARE TEST'/
C
      DATA INCASE(692)/'CS2S'/
      DATA (INAME(692,J),J=1,MAXSCL)/
     1'CHI ','    ','SQUA','2   ','SAMP','TEST','    ','    '/
      DATA INFLAV(692)/2/
      DATA INLONG(692)/'TWO SAMPLE CHI-SQUARE TEST'/
C
      DATA INCASE(693)/'CS2S'/
      DATA (INAME(693,J),J=1,MAXSCL)/
     1'2   ','    ','SAMP','CHI ','SQUA','TEST','    ','    '/
      DATA INFLAV(693)/2/
      DATA INLONG(693)/'TWO SAMPLE CHI-SQUARE TEST'/
C
      DATA INCASE(694)/'KWCD'/
      DATA (INAME(694,J),J=1,MAXSCL)/
     1'KRUS','    ','WALL','TEST','CDF ','    ','    ','    '/
      DATA INFLAV(694)/2/
      DATA INLONG(694)/'KRUSKAL WALLIS TEST CDF'/
C
      DATA INCASE(695)/'KW2P'/
      DATA (INAME(695,J),J=1,MAXSCL)/
     1'KRUS','    ','WALL','TEST','PVAL','    ','    ','    '/
      DATA INFLAV(695)/2/
      DATA INLONG(695)/'KRUSKALL WALLIS TEST PVALUE'/
C
      DATA INCASE(696)/'KWTE'/
      DATA (INAME(696,J),J=1,MAXSCL)/
     1'KRUS','    ','WALL','TEST','    ','    ','    ','    '/
      DATA INFLAV(696)/2/
      DATA INLONG(696)/'KRUSKALL WALLIS TEST'/
C
      DATA INCASE(697)/'FZCD'/
      DATA (INAME(697,J),J=1,MAXSCL)/
     1'FRIE','    ','TEST','CDF ','    ','    ','    ','    '/
      DATA INFLAV(697)/3/
      DATA INLONG(697)/'FRIEDMAN TEST CDF'/
C
      DATA INCASE(698)/'FZ2P'/
      DATA (INAME(698,J),J=1,MAXSCL)/
     1'FRIE','    ','TEST','PVAL','    ','    ','    ','    '/
      DATA INFLAV(698)/3/
      DATA INLONG(698)/'FRIEDMAN TEST PVALUE'/
C
      DATA INCASE(699)/'FZTE'/
      DATA (INAME(699,J),J=1,MAXSCL)/
     1'FRIE','    ','TEST','    ','    ','    ','    ','    '/
      DATA INFLAV(699)/3/
      DATA INLONG(699)/'FRIEDMAN TEST'/
C
      DATA INCASE(700)/'QUCD'/
      DATA (INAME(700,J),J=1,MAXSCL)/
     1'QUAD','    ','TEST','CDF ','    ','    ','    ','    '/
      DATA INFLAV(700)/3/
      DATA INLONG(700)/'QUADE TEST CDF'/
C
      DATA INCASE(701)/'QU2P'/
      DATA (INAME(701,J),J=1,MAXSCL)/
     1'QUAD','    ','TEST','PVAL','    ','    ','    ','    '/
      DATA INFLAV(701)/3/
      DATA INLONG(701)/'QUADE TEST PVALUE'/
C
      DATA INCASE(702)/'QUTE'/
      DATA (INAME(702,J),J=1,MAXSCL)/
     1'QUAD','    ','TEST','    ','    ','    ','    ','    '/
      DATA INFLAV(702)/3/
      DATA INLONG(702)/'QUADE TEST'/
C
      DATA INCASE(703)/'UNIQ'/
      DATA (INAME(703,J),J=1,MAXSCL)/
     1 'UNIQ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(703)/1/
      DATA INLONG(703)/'UNIQUE'/
C
      DATA INCASE(704)/'PEDI'/
      DATA (INAME(704,J),J=1,MAXSCL)/
     1'PERC','    ','DISA','    ','    ','    ','    ','    '/
      DATA INFLAV(704)/2/
      DATA INLONG(704)/'PERCENTAGE DISAGREE'/
C
      DATA INCASE(705)/'PDIF'/
      DATA (INAME(705,J),J=1,MAXSCL)/
     1'PERC','    ','DIFF','OF  ','MEAN','    ','    ','    '/
      DATA INFLAV(705)/2/
      DATA INLONG(705)/'PERCENTAGE DIFFERENCE OF MEANS'/
C
      DATA INCASE(706)/'1LNT'/
      DATA (INAME(706,J),J=1,MAXSCL)/
     1'SUMM','    ','NORM','TOLE','ONE ','SIDE','LOWE','LIMI'/
      DATA INFLAV(706)/3/
      DATA INLONG(706)/'NORMAL TOLERANCE ONE-SIDED LOWER LIMIT'/
C
      DATA INCASE(707)/'1UNT'/
      DATA (INAME(707,J),J=1,MAXSCL)/
     1'SUMM','    ','NORM','TOLE','ONE ','SIDE','UPPE','LIMI'/
      DATA INFLAV(707)/3/
      DATA INLONG(707)/'NORMAL TOLERANCE ONE-SIDED UPPER LIMIT'/
C
      DATA INCASE(708)/'1KNT'/
      DATA (INAME(708,J),J=1,MAXSCL)/
     1'SUMM','    ','NORM','TOLE','ONE ','SIDE','K   ','FACT'/
      DATA INFLAV(708)/3/
      DATA INLONG(708)/'NORMAL TOLERANCE ONE-SIDED K FACTOR'/
C
      DATA INCASE(709)/'2LNT'/
      DATA (INAME(709,J),J=1,MAXSCL)/
     1'SUMM','    ','NORM','TOLE','LOWE','LIMI','    ','    '/
      DATA INFLAV(709)/3/
      DATA INLONG(709)/'NORMAL TOLERANCE LOWER LIMIT'/
C
      DATA INCASE(710)/'2UNT'/
      DATA (INAME(710,J),J=1,MAXSCL)/
     1'SUMM','    ','NORM','TOLE','UPPE','LIMI','    ','    '/
      DATA INFLAV(710)/3/
      DATA INLONG(710)/'NORMAL TOLERANCE UPPER LIMIT'/
C
      DATA INCASE(711)/'2KNT'/
      DATA (INAME(711,J),J=1,MAXSCL)/
     1'SUMM','    ','NORM','TOLE','K   ','FACT','    ','    '/
      DATA INFLAV(711)/3/
      DATA INLONG(711)/'NORMAL TOLERANCE K FACTOR'/
C
      DATA INCASE(712)/'COPV'/
      DATA (INAME(712,J),J=1,MAXSCL)/
     1'CORR','    ','P   ','VALU','    ','    ','    ','    '/
      DATA INFLAV(712)/2/
      DATA INLONG(712)/'CORRELATION P-VALUE'/
C
      DATA INCASE(713)/'GCIN'/
      DATA (INAME(713,J),J=1,MAXSCL)/
     1'SUMM','    ','GENE','CONF','INTE','    ','    ','    '/
      DATA INFLAV(713)/3/
      DATA INLONG(713)/'GENERALIZED CONFIDENCE INTERVAL'/
C
      DATA INCASE(714)/'GCIN'/
      DATA (INAME(714,J),J=1,MAXSCL)/
     1'SUMM','    ','GCI ','    ','    ','    ','    ','    '/
      DATA INFLAV(714)/3/
      DATA INLONG(714)/'GENERALIZED CONFIDENCE INTERVAL'/
C
      DATA INCASE(715)/'BOB '/
      DATA (INAME(715,J),J=1,MAXSCL)/
     1'SUMM','    ','BOB ','    ','    ','    ','    ','    '/
      DATA INFLAV(715)/3/
      DATA INLONG(715)/'BOB'/
C
      DATA INCASE(716)/'FMAT'/
      DATA (INAME(716,J),J=1,MAXSCL)/
     1'INDE','    ','FIRS','MATC','    ','    ','    ','    '/
      DATA INFLAV(716)/2/
      DATA INLONG(716)/'INDEX FIRST MATCH'/
C
      DATA INCASE(717)/'LMAT'/
      DATA (INAME(717,J),J=1,MAXSCL)/
     1'INDE','    ','LAST','MATC','    ','    ','    ','    '/
      DATA INFLAV(717)/2/
      DATA INLONG(717)/'INDEX LAST MATCH'/
C
      DATA INCASE(718)/'FNOM'/
      DATA (INAME(718,J),J=1,MAXSCL)/
     1'INDE','    ','FIRS','NOT ','MATC','    ','    ','    '/
      DATA INFLAV(718)/2/
      DATA INLONG(718)/'INDEX FIRST NOT MATCH'/
C
      DATA INCASE(719)/'FNOM'/
      DATA (INAME(719,J),J=1,MAXSCL)/
     1'INDE','    ','FIRS','NO  ','MATC','    ','    ','    '/
      DATA INFLAV(719)/2/
      DATA INLONG(719)/'INDEX FIRST NOT MATCH'/
C
      DATA INCASE(720)/'LNOM'/
      DATA (INAME(720,J),J=1,MAXSCL)/
     1'INDE','    ','LAST','NOT ','MATC','    ','    ','    '/
      DATA INFLAV(720)/2/
      DATA INLONG(720)/'INDEX LAST NOT MATCH'/
C
      DATA INCASE(721)/'LNOM'/
      DATA (INAME(721,J),J=1,MAXSCL)/
     1'INDE','    ','LAST','NO  ','MATC','    ','    ','    '/
      DATA INFLAV(721)/2/
      DATA INLONG(721)/'INDEX LAST NOT MATCH'/
C
      DATA INCASE(722)/'SHDI'/
      DATA (INAME(722,J),J=1,MAXSCL)/
     1'SHAN','    ','DIVE','INDE','    ','    ','    ','    '/
      DATA INFLAV(722)/1/
      DATA INLONG(722)/'SHANNON DIVERSITY INDEX'/
C
      DATA INCASE(723)/'SINR'/
      DATA (INAME(723,J),J=1,MAXSCL)/
     1'RAW ','    ','SHAN','DIVE','INDE','    ','    ','    '/
      DATA INFLAV(723)/1/
      DATA INLONG(723)/'SHANNON DIVERSITY INDEX'/
C
      DATA INCASE(724)/'SIDI'/
      DATA (INAME(724,J),J=1,MAXSCL)/
     1'SIMP','    ','DIVE','INDE','    ','    ','    ','    '/
      DATA INFLAV(724)/1/
      DATA INLONG(724)/'SIMPSON DIVERSITY INDEX'/
C
      DATA INCASE(725)/'SDIR'/
      DATA (INAME(725,J),J=1,MAXSCL)/
     1'RAW ','    ','SIMP','DIVE','INDE','    ','    ','    '/
      DATA INFLAV(725)/1/
      DATA INLONG(725)/'SIMPSON DIVERSITY INDEX'/
C
      DATA INCASE(726)/'SHEI'/
      DATA (INAME(726,J),J=1,MAXSCL)/
     1'SHAN','    ','EQUI','INDE','    ','    ','    ','    '/
      DATA INFLAV(726)/1/
      DATA INLONG(726)/'SHANNON EQUITABILITY INDEX'/
C
      DATA INCASE(727)/'SEIR'/
      DATA (INAME(727,J),J=1,MAXSCL)/
     1'RAW ','    ','SHAN','EQUI','INDE','    ','    ','    '/
      DATA INFLAV(727)/1/
      DATA INLONG(727)/'SHANNON EQUITABILITY INDEX'/
C
      DATA INCASE(728)/'SHEI'/
      DATA (INAME(728,J),J=1,MAXSCL)/
     1'SHAN','    ','EVEN','INDE','    ','    ','    ','    '/
      DATA INFLAV(728)/1/
      DATA INLONG(728)/'SHANNON EQUITABILITY INDEX'/
C
      DATA INCASE(729)/'SEIR'/
      DATA (INAME(729,J),J=1,MAXSCL)/
     1'RAW ','    ','SHAN','EVEN','INDE','    ','    ','    '/
      DATA INFLAV(729)/1/
      DATA INLONG(729)/'SHANNON EQUITABILITY INDEX'/
C
      DATA INCASE(730)/'JAPV'/
      DATA (INAME(730,J),J=1,MAXSCL)/
     1'JARQ','    ','BERA','TEST','PVAL','    ','    ','    '/
      DATA INFLAV(730)/1/
      DATA INLONG(730)/'JARQUE-BERA NORMALITY TEST P-VALUE'/
C
      DATA INCASE(731)/'JACD'/
      DATA (INAME(731,J),J=1,MAXSCL)/
     1'JARQ','    ','BERA','TEST','CDF ','    ','    ','    '/
      DATA INFLAV(731)/1/
      DATA INLONG(731)/'JARQUE-BERA NORMALITY TEST CDF'/
C
      DATA INCASE(732)/'JABE'/
      DATA (INAME(732,J),J=1,MAXSCL)/
     1'JARQ','    ','BERA','TEST','    ','    ','    ','    '/
      DATA INFLAV(732)/1/
      DATA INLONG(732)/'JARQUE-BERA NORMALITY TEST'/
C
      DATA INCASE(733)/'JAPV'/
      DATA (INAME(733,J),J=1,MAXSCL)/
     1'JARQ','    ','BERA','PVAL','    ','    ','    ','    '/
      DATA INFLAV(733)/1/
      DATA INLONG(733)/'JARQUE-BERA NORMALITY TEST P-VALUE'/
C
      DATA INCASE(734)/'JACD'/
      DATA (INAME(734,J),J=1,MAXSCL)/
     1'JARQ','    ','BERA','CDF ','    ','    ','    ','    '/
      DATA INFLAV(734)/1/
      DATA INLONG(734)/'JARQUE-BERA NORMALITY TEST CDF'/
C
      DATA INCASE(735)/'JABE'/
      DATA (INAME(735,J),J=1,MAXSCL)/
     1'JARQ','    ','BERA','    ','    ','    ','    ','    '/
      DATA INFLAV(735)/1/
      DATA INLONG(735)/'JARQUE-BERA NORMALITY TEST'/
C
      DATA INCASE(736)/'SSQ'/
      DATA (INAME(736,J),J=1,MAXSCL)/
     1'SUM ','    ','OF  ','SQUA','    ','    ','    ','    '/
      DATA INFLAV(736)/1/
      DATA INLONG(736)/'SUM OF SQUARES'/
C
      DATA INCASE(737)/'RSUM'/
      DATA (INAME(737,J),J=1,MAXSCL)/
     1'RESC','    ','SUM ','    ','    ','    ','    ','    '/
      DATA INFLAV(737)/1/
      DATA INLONG(737)/'RESCALED SUM'/
C
      DATA INCASE(738)/'RLP '/
      DATA (INAME(738,J),J=1,MAXSCL)/
     1'RELA','    ','LABO','PERF','    ','    ','    ','    '/
      DATA INFLAV(738)/2/
      DATA INLONG(738)/'RELATIVE LABORATORY PERFORMANCE'/
C
      DATA INCASE(739)/'RLP '/
      DATA (INAME(739,J),J=1,MAXSCL)/
     1'RLP ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(739)/2/
      DATA INLONG(739)/'RELATIVE LABORATORY PERFORMANCE'/
C
      DATA INCASE(740)/'WSPV'/
      DATA (INAME(740,J),J=1,MAXSCL)/
     1'WILK','    ','SHAP','NORM','TEST','P   ','VALU','    '/
      DATA INFLAV(740)/1/
      DATA INLONG(740)/'WILK SHAPIRO NORMALITY TEST P-VALUE'/
C
      DATA INCASE(741)/'WSPV'/
      DATA (INAME(741,J),J=1,MAXSCL)/
     1'WILK','    ','SHAP','TEST','P   ','VALU','    ','    '/
      DATA INFLAV(741)/1/
      DATA INLONG(741)/'WILK SHAPIRO NORMALITY TEST P-VALUE'/
C
      DATA INCASE(742)/'WSHA'/
      DATA (INAME(742,J),J=1,MAXSCL)/
     1'WILK','    ','SHAP','    ','    ','    ','    ','    '/
      DATA INFLAV(742)/1/
      DATA INLONG(742)/'WILK SHAPIRO NORMALITY TEST'/
C
      DATA INCASE(743)/'PCAB'/
      DATA (INAME(743,J),J=1,MAXSCL)/
     1'PART','    ','CORR','ABSO','VALU','    ','    ','    '/
      DATA INFLAV(743)/3/
      DATA INLONG(743)/'PARTIAL CORRELATION ABSOLUTE VALUE'/
C
      DATA INCASE(744)/'PCPV'/
      DATA (INAME(744,J),J=1,MAXSCL)/
     1'PART','    ','CORR','PVAL','    ','    ','    ','    '/
      DATA INFLAV(744)/3/
      DATA INLONG(744)/'PARTIAL CORRELATION P-VALUE'/
C
      DATA INCASE(745)/'PCPV'/
      DATA (INAME(745,J),J=1,MAXSCL)/
     1'PART','    ','CORR','P   ','VALU','    ','    ','    '/
      DATA INFLAV(745)/3/
      DATA INLONG(745)/'PARTIAL CORRELATION P-VALUE'/
C
      DATA INCASE(746)/'PCCD'/
      DATA (INAME(746,J),J=1,MAXSCL)/
     1'PART','    ','CORR','CDF ','    ','    ','    ','    '/
      DATA INFLAV(746)/3/
      DATA INLONG(746)/'PARTIAL CORRELATION CDF'/
C
      DATA INCASE(747)/'RPCA'/
      DATA (INAME(747,J),J=1,MAXSCL)/
     1'PART','    ','RANK','CORR','ABSO','VALU','    ','    '/
      DATA INFLAV(747)/3/
      DATA INLONG(747)/'PARTIAL RANK CORRELATION ABSOLUTE VALUE'/
C
      DATA INCASE(748)/'RPCR'/
      DATA (INAME(748,J),J=1,MAXSCL)/
     1'PART','    ','RANK','CORR','    ','    ','    ','    '/
      DATA INFLAV(748)/3/
      DATA INLONG(748)/'PARTIAL RANK CORRELATION'/
C
      DATA INCASE(749)/'PKAB'/
      DATA (INAME(749,J),J=1,MAXSCL)/
     1'PART','    ','KEND','TAU ','CORR','ABSO','VALU','    '/
      DATA INFLAV(749)/3/
      DATA INLONG(749)/'PARTIAL KENDALL TAU CORRELATION ABSO VALUE'/
C
      DATA INCASE(750)/'PKTA'/
      DATA (INAME(750,J),J=1,MAXSCL)/
     1'PART','    ','KEND','TAU ','CORR','    ','    ','    '/
      DATA INFLAV(750)/3/
      DATA INLONG(750)/'PARTIAL KENDALL TAU CORRELATION'/
C
      DATA INCASE(751)/'PKTA'/
      DATA (INAME(751,J),J=1,MAXSCL)/
     1'PART','    ','KEND','TAU ','    ','    ','    ','    '/
      DATA INFLAV(751)/3/
      DATA INLONG(751)/'PARTIAL KENDALL TAU CORRELATION'/
C
      DATA INCASE(752)/'RACC'/
      DATA (INAME(752,J),J=1,MAXSCL)/
     1'RANK','    ','CORR','CDF ','    ','    ','    ','    '/
      DATA INFLAV(752)/2/
      DATA INLONG(752)/'RANK CORRELATION CDF'/
C
      DATA INCASE(753)/'TAUA'/
      DATA (INAME(753,J),J=1,MAXSCL)/
     1'KEND','    ','TAU ','CORR','ABSO','VALU','    ','    '/
      DATA INFLAV(753)/2/
      DATA INLONG(753)/'KENDALLS TAU ABSOLUTE VALUE'/
C
      DATA INCASE(754)/'KTCD'/
      DATA (INAME(754,J),J=1,MAXSCL)/
     1'KEND','    ','TAU ','CORR','CD  ','    ','    ','    '/
      DATA INFLAV(754)/2/
      DATA INLONG(754)/'KENDALLS TAU CDF'/
C
      DATA INCASE(755)/'COPV'/
      DATA (INAME(755,J),J=1,MAXSCL)/
     1'CORR','    ','PVAL','    ','    ','    ','    ','    '/
      DATA INFLAV(755)/2/
      DATA INLONG(755)/'CORRELATION P-VALUE'/
C
      DATA INCASE(756)/'COCD'/
      DATA (INAME(756,J),J=1,MAXSCL)/
     1'CORR','    ','CDF ','    ','    ','    ','    ','    '/
      DATA INFLAV(756)/2/
      DATA INLONG(756)/'CORRELATION CDF'/
C
      DATA INCASE(757)/'COLC'/
      DATA (INAME(757,J),J=1,MAXSCL)/
     1'CORR','    ','LOWE','CONF','LIMI','    ','    ','    '/
      DATA INFLAV(757)/2/
      DATA INLONG(757)/'CORRELATION LOWER CONFIDENCE LIMIT'/
C
      DATA INCASE(758)/'COLC'/
      DATA (INAME(758,J),J=1,MAXSCL)/
     1'CORR','    ','LOWE','CONF','INTE','    ','    ','    '/
      DATA INFLAV(758)/2/
      DATA INLONG(758)/'CORRELATION LOWER CONFIDENCE LIMIT'/
C
      DATA INCASE(759)/'COUC'/
      DATA (INAME(759,J),J=1,MAXSCL)/
     1'CORR','    ','UPPE','CONF','LIMI','    ','    ','    '/
      DATA INFLAV(759)/2/
      DATA INLONG(759)/'CORRELATION UPPER CONFIDENCE LIMIT'/
C
      DATA INCASE(760)/'COUC'/
      DATA (INAME(760,J),J=1,MAXSCL)/
     1'CORR','    ','UPPE','CONF','INTE','    ','    ','    '/
      DATA INFLAV(760)/2/
      DATA INLONG(760)/'CORRELATION UPPER CONFIDENCE LIMIT'/
C
      DATA INCASE(761)/'CRAT'/
      DATA (INAME(761,J),J=1,MAXSCL)/
     1'CORR','    ','RATI','    ','    ','    ','    ','    '/
      DATA INFLAV(761)/2/
      DATA INLONG(761)/'CORRELATION RATIO'/
C
      DATA INCASE(762)/'PCOR'/
      DATA (INAME(762,J),J=1,MAXSCL)/
     1'PART','    ','CORR','    ','    ','    ','    ','    '/
      DATA INFLAV(762)/3/
      DATA INLONG(762)/'PARTIAL CORRELATION'/
C
      DATA INCASE(763)/'KTCD'/
      DATA (INAME(763,J),J=1,MAXSCL)/
     1'KEND','    ','TAU ','CDF ','    ','    ','    ','    '/
      DATA INFLAV(763)/2/
      DATA INLONG(763)/'KENDALLS TAU CDF'/
C
      DATA INCASE(764)/'WSSD'/
      DATA (INAME(764,J),J=1,MAXSCL)/
     1'WEIG','    ','SUM ','OF  ','SQUA','DEVI','FROM','MEAN'/
      DATA INFLAV(764)/2/
      DATA INLONG(764)/'WEIGHTED SUM OF SQUARED DEVIATIONS FROM MEAN'/
C
      DATA INCASE(765)/'WSAB'/
      DATA (INAME(765,J),J=1,MAXSCL)/
     1'WEIG','    ','SUM ','OF  ','ABSO','VALU','    ','    '/
      DATA INFLAV(765)/2/
      DATA INLONG(765)/'WEIGHTED SUM OF ABSOLUTE VALUES'/
C
      DATA INCASE(766)/'WSDV'/
      DATA (INAME(766,J),J=1,MAXSCL)/
     1'WEIG','    ','SUM ','OF  ','DEVI','FROM','MEAN','    '/
      DATA INFLAV(766)/2/
      DATA INLONG(766)/'WEIGHTED SUM OF DEVIATIONS FROM THE MEAN'/
C
      DATA INCASE(767)/'WSDV'/
      DATA (INAME(767,J),J=1,MAXSCL)/
     1'WEIG','    ','SUM ','OF  ','DEVI','FROM','THE ','MEAN'/
      DATA INFLAV(767)/2/
      DATA INLONG(767)/'WEIGHTED SUM OF DEVIATIONS FROM THE MEAN'/
C
      DATA INCASE(768)/'WAAB'/
      DATA (INAME(768,J),J=1,MAXSCL)/
     1'WEIG','    ','AVER','ABSO','VALU','    ','    ','    '/
      DATA INFLAV(768)/2/
      DATA INLONG(768)/'WEIGHTED AVERAGE ABSOLUTE VALUES'/
C
      DATA INCASE(769)/'WSSQ'/
      DATA (INAME(769,J),J=1,MAXSCL)/
     1'WEIG','    ','SUM ','OF  ','SQUA','    ','    ','    '/
      DATA INFLAV(769)/2/
      DATA INLONG(769)/'WEIGHTED SUM OF SQUARES'/
C
      DATA INCASE(770)/'WSUM'/
      DATA (INAME(770,J),J=1,MAXSCL)/
     1'WEIG','    ','SUM ','    ','    ','    ','    ','    '/
      DATA INFLAV(770)/2/
      DATA INLONG(770)/'WEIGHTED SUM'/
C
      DATA INCASE(771)/'WAAB'/
      DATA (INAME(771,J),J=1,MAXSCL)/
     1'WEIG','    ','AVER','OF  ','ABSO','VALU','    ','    '/
      DATA INFLAV(771)/2/
      DATA INLONG(771)/'WEIGHTED AVERAGE ABSOLUTE VALUES'/
C
      DATA INCASE(772)/'DSSM'/
      DATA (INAME(772,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','SUM ','OF  ','SQUA','FROM','MEAN'/
      DATA INFLAV(772)/2/
      DATA INLONG(772)/'DIFFERENCE OF SUM OF SQUARES'/
C
      DATA INCASE(773)/'DSSM'/
      DATA (INAME(773,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','SUMS','OF  ','SQUA','FROM','MEAN'/
      DATA INFLAV(773)/2/
      DATA INLONG(773)/'DIFFERENCE OF SUM OF SQUARES'/
C
      DATA INCASE(774)/'SSQ '/
      DATA (INAME(774,J),J=1,MAXSCL)/
     1'SSQ ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(774)/1/
      DATA INLONG(774)/'SUM OF SQUARES'/
C
      DATA INCASE(775)/'DSUM'/
      DATA (INAME(775,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','SUM ','    ','    ','    ','    '/
      DATA INFLAV(775)/2/
      DATA INLONG(775)/'DIFFERENCE OF SUMS'/
C
      DATA INCASE(776)/'DSUM'/
      DATA (INAME(776,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','SUMS','    ','    ','    ','    '/
      DATA INFLAV(776)/2/
      DATA INLONG(776)/'DIFFERENCE OF SUMS'/
C
      DATA INCASE(777)/'DRSC'/
      DATA (INAME(777,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','RESC','SUM ','    ','    ','    '/
      DATA INFLAV(777)/2/
      DATA INLONG(777)/'DIFFERENCE OF RESCALED SUM'/
C
      DATA INCASE(778)/'QQRA'/
      DATA (INAME(778,J),J=1,MAXSCL)/
     1'Q   ','    ','QUAN','RANG','    ','    ','    ','    '/
      DATA INFLAV(778)/1/
      DATA INLONG(778)/'Q QUANTILE RANGE'/
C
      DATA INCASE(779)/'QQRA'/
      DATA (INAME(779,J),J=1,MAXSCL)/
     1'QQUA','    ','RANG','    ','    ','    ','    ','    '/
      DATA INFLAV(779)/1/
      DATA INLONG(779)/'Q QUANTILE RANGE'/
C
      DATA INCASE(780)/'WOSM'/
      DATA (INAME(780,J),J=1,MAXSCL)/
     1'WEIG','    ','ORDE','STAT','MEAN','    ','    ','    '/
      DATA INFLAV(780)/2/
      DATA INLONG(780)/'WEIGHTED ORDER STATISTICS MEAN'/
C
      DATA INCASE(781)/'LCL '/
      DATA (INAME(781,J),J=1,MAXSCL)/
     1'LOWE','    ','CONF','LIMI','    ','    ','    ','    '/
      DATA INFLAV(781)/1/
      DATA INLONG(781)/'LOWER CONFIDENCE LIMIT'/
C
      DATA INCASE(782)/'LCL '/
      DATA (INAME(782,J),J=1,MAXSCL)/
     1'LOWE','    ','CONF','INTE','    ','    ','    ','    '/
      DATA INFLAV(782)/1/
      DATA INLONG(782)/'LOWER CONFIDENCE LIMIT'/
C
      DATA INCASE(783)/'UCL '/
      DATA (INAME(783,J),J=1,MAXSCL)/
     1'UPPE','    ','CONF','LIMI','    ','    ','    ','    '/
      DATA INFLAV(783)/1/
      DATA INLONG(783)/'UPPER CONFIDENCE LIMIT'/
C
      DATA INCASE(784)/'UCL '/
      DATA (INAME(784,J),J=1,MAXSCL)/
     1'UPPE','    ','CONF','INTE','    ','    ','    ','    '/
      DATA INFLAV(784)/1/
      DATA INLONG(784)/'UPPER CONFIDENCE LIMIT'/
C
      DATA INCASE(785)/'1LCL'/
      DATA (INAME(785,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','LOWE','CONF','INTE','    ','    '/
      DATA INFLAV(785)/1/
      DATA INLONG(785)/'ONE-SIDED LOWER CONFIDENCE LIMIT'/
C
      DATA INCASE(786)/'1LCL'/
      DATA (INAME(786,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','LOWE','CONF','LIMI','    ','    '/
      DATA INFLAV(786)/1/
      DATA INLONG(786)/'ONE-SIDED LOWER CONFIDENCE LIMIT'/
C
      DATA INCASE(787)/'1UCL'/
      DATA (INAME(787,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','UPPE','CONF','INTE','    ','    '/
      DATA INFLAV(787)/1/
      DATA INLONG(787)/'ONE-SIDED UPPER CONFIDENCE LIMIT'/
C
      DATA INCASE(788)/'1UCL'/
      DATA (INAME(788,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','UPPE','CONF','LIMI','    ','    '/
      DATA INFLAV(788)/1/
      DATA INLONG(788)/'ONE-SIDED UPPER CONFIDENCE LIMIT'/
C
      DATA INCASE(789)/'LPL '/
      DATA (INAME(789,J),J=1,MAXSCL)/
     1'LOWE','    ','PRED','LIMI','    ','    ','    ','    '/
      DATA INFLAV(789)/1/
      DATA INLONG(789)/'LOWER PREDICTION LIMIT'/
C
      DATA INCASE(790)/'LPL '/
      DATA (INAME(790,J),J=1,MAXSCL)/
     1'LOWE','    ','PRED','INTE','    ','    ','    ','    '/
      DATA INFLAV(790)/1/
      DATA INLONG(790)/'LOWER PREDICTION LIMIT'/
C
      DATA INCASE(791)/'UPL '/
      DATA (INAME(791,J),J=1,MAXSCL)/
     1'UPPE','    ','PRED','LIMI','    ','    ','    ','    '/
      DATA INFLAV(791)/1/
      DATA INLONG(791)/'UPPER PREDICTION LIMIT'/
C
      DATA INCASE(792)/'UPL '/
      DATA (INAME(792,J),J=1,MAXSCL)/
     1'UPPE','    ','PRED','INTE','    ','    ','    ','    '/
      DATA INFLAV(792)/1/
      DATA INLONG(792)/'UPPER PREDICTION LIMIT'/
C
      DATA INCASE(793)/'1LPL'/
      DATA (INAME(793,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','LOWE','PRED','INTE','    ','    '/
      DATA INFLAV(793)/1/
      DATA INLONG(793)/'ONE-SIDED LOWER PREDICTION LIMIT'/
C
      DATA INCASE(794)/'1LPL'/
      DATA (INAME(794,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','LOWE','PRED','LIMI','    ','    '/
      DATA INFLAV(794)/1/
      DATA INLONG(794)/'ONE-SIDED LOWER PREDICTION LIMIT'/
C
      DATA INCASE(795)/'1UPL'/
      DATA (INAME(795,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','UPPE','PRED','INTE','    ','    '/
      DATA INFLAV(795)/1/
      DATA INLONG(795)/'ONE-SIDED UPPER PREDICTION LIMIT'/
C
      DATA INCASE(796)/'1UPL'/
      DATA (INAME(796,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','UPPE','PRED','LIMI','    ','    '/
      DATA INFLAV(796)/1/
      DATA INLONG(796)/'ONE-SIDED UPPER PREDICTION LIMIT'/
C
      DATA INCASE(797)/'WESH'/
      DATA (INAME(797,J),J=1,MAXSCL)/
     1'WEIB','    ','PPCC','SHAP','    ','    ','    ','    '/
      DATA INFLAV(797)/1/
      DATA INLONG(797)/'WEIBULL SHAPE'/
C
      DATA INCASE(798)/'TLSH'/
      DATA (INAME(798,J),J=1,MAXSCL)/
     1'TUKE','    ','LAMB','PPCC','SHAP','    ','    ','    '/
      DATA INFLAV(798)/1/
      DATA INLONG(798)/'TUKEY-LAMBDA SHAPE'/
C
      DATA INCASE(799)/'MSDN'/
      DATA (INAME(799,J),J=1,MAXSCL)/
     1'MEAN','    ','SUCC','DIFF','NORM','    ','    ','    '/
      DATA INFLAV(799)/1/
      DATA INLONG(799)/'MEAN SUCCESSIVE DIFFERENCES NORMALIZED'/
C
      DATA INCASE(800)/'MSDC'/
      DATA (INAME(800,J),J=1,MAXSCL)/
     1'MEAN','    ','SUCC','DIFF','TEST','CDF ','    ','    '/
      DATA INFLAV(800)/1/
      DATA INLONG(800)/'MEAN SUCCESSIVE DIFFERENCES CDF'/
C
      DATA INCASE(801)/'WELO'/
      DATA (INAME(801,J),J=1,MAXSCL)/
     1'WEIB','    ','PPCC','LOCA','    ','    ','    ','    '/
      DATA INFLAV(801)/1/
      DATA INLONG(801)/'WEIBULL LOCATION'/
C
      DATA INCASE(802)/'WESC'/
      DATA (INAME(802,J),J=1,MAXSCL)/
     1'WEIB','    ','PPCC','SCAL','    ','    ','    ','    '/
      DATA INFLAV(802)/1/
      DATA INLONG(802)/'WEIBULL SCALE'/
C
      DATA INCASE(803)/'TLLO'/
      DATA (INAME(803,J),J=1,MAXSCL)/
     1'TUKE','    ','LAMB','PPCC','LOCA','    ','    ','    '/
      DATA INFLAV(803)/1/
      DATA INLONG(803)/'TUKEY-LAMBDA LOCATION'/
C
      DATA INCASE(804)/'TLSC'/
      DATA (INAME(804,J),J=1,MAXSCL)/
     1'TUKE','    ','LAMB','PPCC','SCAL','    ','    ','    '/
      DATA INFLAV(804)/1/
      DATA INLONG(804)/'TUKEY-LAMBDA SCALE'/
C
      DATA INCASE(805)/'NOSC'/
      DATA (INAME(805,J),J=1,MAXSCL)/
     1'NORM','    ','PPCC','SCAL','    ','    ','    ','    '/
      DATA INFLAV(805)/1/
      DATA INLONG(805)/'NORMAL PPCC SCALE'/
C
      DATA INCASE(806)/'NOPP'/
      DATA (INAME(806,J),J=1,MAXSCL)/
     1'NORM','    ','PPCC','    ','    ','    ','    ','    '/
      DATA INFLAV(806)/1/
      DATA INLONG(806)/'NORMAL PPCC'/
C
      DATA INCASE(807)/'UNSC'/
      DATA (INAME(807,J),J=1,MAXSCL)/
     1'UNIF','    ','PPCC','SCAL','    ','    ','    ','    '/
      DATA INFLAV(807)/1/
      DATA INLONG(807)/'UNIFORM PPCC SCALE'/
C
      DATA INCASE(808)/'UNPP'/
      DATA (INAME(808,J),J=1,MAXSCL)/
     1'UNIF','    ','PPCC','    ','    ','    ','    ','    '/
      DATA INFLAV(808)/1/
      DATA INLONG(808)/'UNIFORM PPCC'/
C
      DATA INCASE(809)/'CASC'/
      DATA (INAME(809,J),J=1,MAXSCL)/
     1'CAUC','    ','PPCC','SCAL','    ','    ','    ','    '/
      DATA INFLAV(809)/1/
      DATA INLONG(809)/'CAUCHY PPCC SCALE'/
C
      DATA INCASE(810)/'LOSC'/
      DATA (INAME(810,J),J=1,MAXSCL)/
     1'LOGI','    ','PPCC','SCAL','    ','    ','    ','    '/
      DATA INFLAV(810)/1/
      DATA INLONG(810)/'LOGISTIC PPCC SCALE'/
C
      DATA INCASE(811)/'DESC'/
      DATA (INAME(811,J),J=1,MAXSCL)/
     1'DOUB','    ','EXPO','PPCC','SCAL','    ','    ','    '/
      DATA INFLAV(811)/1/
      DATA INLONG(811)/'DOUBLE EXPONENTIAL PPCC SCALE'/
C
      DATA INCASE(812)/'HSSC'/
      DATA (INAME(812,J),J=1,MAXSCL)/
     1'HYPE','    ','SECA','PPCC','SCAL','    ','    ','    '/
      DATA INFLAV(812)/1/
      DATA INLONG(812)/'HYPERBOLIC SECANT PPCC SCALE'/
C
      DATA INCASE(813)/'HNSC'/
      DATA (INAME(813,J),J=1,MAXSCL)/
     1'HALF','    ','NORM','PPCC','SCAL','    ','    ','    '/
      DATA INFLAV(813)/1/
      DATA INLONG(813)/'HALF-NORMAL PPCC SCALE'/
C
      DATA INCASE(814)/'COSC'/
      DATA (INAME(814,J),J=1,MAXSCL)/
     1'COSI','    ','PPCC','SCAL','    ','    ','    ','    '/
      DATA INFLAV(814)/1/
      DATA INLONG(814)/'COSINE PPCC SCALE'/
C
      DATA INCASE(815)/'ANSC'/
      DATA (INAME(815,J),J=1,MAXSCL)/
     1'ANGL','    ','PPCC','SCAL','    ','    ','    ','    '/
      DATA INFLAV(815)/1/
      DATA INLONG(815)/'ANGLIT PPCC SCALE'/
C
      DATA INCASE(816)/'ARSC'/
      DATA (INAME(816,J),J=1,MAXSCL)/
     1'ARCS','    ','PPCC','SCAL','    ','    ','    ','    '/
      DATA INFLAV(816)/1/
      DATA INLONG(816)/'ARCSINE PPCC SCALE'/
C
      DATA INCASE(817)/'EXSC'/
      DATA (INAME(817,J),J=1,MAXSCL)/
     1'EXPO','    ','PPCC','SCAL','    ','    ','    ','    '/
      DATA INFLAV(817)/1/
      DATA INLONG(817)/'EXPONENTIAL PPCC SCALE'/
C
      DATA INCASE(819)/'SLSC'/
      DATA (INAME(819,J),J=1,MAXSCL)/
     1'SLAS','    ','PPCC','SCAL','    ','    ','    ','    '/
      DATA INFLAV(819)/1/
      DATA INLONG(819)/'SLASH PPCC SCALE'/
C
      DATA INCASE(820)/'RASC'/
      DATA (INAME(820,J),J=1,MAXSCL)/
     1'RAYL','    ','PPCC','SCAL','    ','    ','    ','    '/
      DATA INFLAV(820)/1/
      DATA INLONG(820)/'RAYLEIGH PPCC SCALE'/
C
      DATA INCASE(821)/'MXSC'/
      DATA (INAME(821,J),J=1,MAXSCL)/
     1'MAXW','    ','PPCC','SCAL','    ','    ','    ','    '/
      DATA INFLAV(821)/1/
      DATA INLONG(821)/'MAXWELL PPCC SCALE'/
C
      DATA INCASE(822)/'DESC'/
      DATA (INAME(822,J),J=1,MAXSCL)/
     1'LAPL','    ','PPCC','SCAL','    ','    ','    ','    '/
      DATA INFLAV(822)/1/
      DATA INLONG(822)/'DOUBLE EXPONENTIAL PPCC SCALE'/
C
      DATA INCASE(823)/'HCSC'/
      DATA (INAME(823,J),J=1,MAXSCL)/
     1'HALF','    ','CAUC','PPCC','SCAL','    ','    ','    '/
      DATA INFLAV(823)/1/
      DATA INLONG(823)/'HALF-CAUCHY PPCC SCALE'/
C
      DATA INCASE(824)/'SCSC'/
      DATA (INAME(824,J),J=1,MAXSCL)/
     1'SEMI','    ','CIRC','PPCC','SCAL','    ','    ','    '/
      DATA INFLAV(824)/1/
      DATA INLONG(824)/'SEMI-CIRCULAR PPCC SCALE'/
C
      DATA INCASE(825)/'CAPP'/
      DATA (INAME(825,J),J=1,MAXSCL)/
     1'CAUC','    ','PPCC','    ','    ','    ','    ','    '/
      DATA INFLAV(825)/1/
      DATA INLONG(825)/'CAUCHY PPCC'/
C
      DATA INCASE(826)/'LOPP'/
      DATA (INAME(826,J),J=1,MAXSCL)/
     1'LOGI','    ','PPCC','    ','    ','    ','    ','    '/
      DATA INFLAV(826)/1/
      DATA INLONG(826)/'LOGISTIC PPCC'/
C
      DATA INCASE(827)/'DEPP'/
      DATA (INAME(827,J),J=1,MAXSCL)/
     1'DOUB','    ','EXPO','PPCC','    ','    ','    ','    '/
      DATA INFLAV(827)/1/
      DATA INLONG(827)/'DOUBLE EXPONENTIAL PPCC'/
C
      DATA INCASE(828)/'HSPP'/
      DATA (INAME(828,J),J=1,MAXSCL)/
     1'HYPE','    ','SECA','PPCC','    ','    ','    ','    '/
      DATA INFLAV(828)/1/
      DATA INLONG(828)/'HYPERBOLIC SECANT PPCC'/
C
      DATA INCASE(829)/'HNPP'/
      DATA (INAME(829,J),J=1,MAXSCL)/
     1'HALF','    ','NORM','PPCC','    ','    ','    ','    '/
      DATA INFLAV(829)/1/
      DATA INLONG(829)/'HALF-NORMAL PPCC'/
C
      DATA INCASE(830)/'COPP'/
      DATA (INAME(830,J),J=1,MAXSCL)/
     1'COSI','    ','PPCC','    ','    ','    ','    ','    '/
      DATA INFLAV(830)/1/
      DATA INLONG(830)/'COSINE PPCC'/
C
      DATA INCASE(831)/'ANPP'/
      DATA (INAME(831,J),J=1,MAXSCL)/
     1'ANGL','    ','PPCC','    ','    ','    ','    ','    '/
      DATA INFLAV(831)/1/
      DATA INLONG(831)/'ANGLIT PPCC'/
C
      DATA INCASE(832)/'ARPP'/
      DATA (INAME(832,J),J=1,MAXSCL)/
     1'ARCS','    ','PPCC','    ','    ','    ','    ','    '/
      DATA INFLAV(832)/1/
      DATA INLONG(832)/'ARCSINE PPCC'/
C
      DATA INCASE(833)/'EXPP'/
      DATA (INAME(833,J),J=1,MAXSCL)/
     1'EXPO','    ','PPCC','    ','    ','    ','    ','    '/
      DATA INFLAV(833)/1/
      DATA INLONG(833)/'EXPONENTIAL PPCC'/
C
      DATA INCASE(834)/'SLPP'/
      DATA (INAME(834,J),J=1,MAXSCL)/
     1'SLAS','    ','PPCC','    ','    ','    ','    ','    '/
      DATA INFLAV(834)/1/
      DATA INLONG(834)/'SLASH PPCC'/
C
      DATA INCASE(835)/'RAPP'/
      DATA (INAME(835,J),J=1,MAXSCL)/
     1'RAYL','    ','PPCC','    ','    ','    ','    ','    '/
      DATA INFLAV(835)/1/
      DATA INLONG(835)/'RAYLEIGH PPCC'/
C
      DATA INCASE(836)/'MXPP'/
      DATA (INAME(836,J),J=1,MAXSCL)/
     1'MAXW','    ','PPCC','    ','    ','    ','    ','    '/
      DATA INFLAV(836)/1/
      DATA INLONG(836)/'MAXWELL PPCC'/
C
      DATA INCASE(837)/'DEPP'/
      DATA (INAME(837,J),J=1,MAXSCL)/
     1'LAPL','    ','PPCC','    ','    ','    ','    ','    '/
      DATA INFLAV(837)/1/
      DATA INLONG(837)/'DOUBLE EXPONENTIAL PPCC'/
C
      DATA INCASE(838)/'HCPP'/
      DATA (INAME(838,J),J=1,MAXSCL)/
     1'HALF','    ','CAUC','PPCC','    ','    ','    ','    '/
      DATA INFLAV(838)/1/
      DATA INLONG(838)/'HALF-CAUCHY PPCC'/
C
      DATA INCASE(839)/'SCPP'/
      DATA (INAME(839,J),J=1,MAXSCL)/
     1'SEMI','    ','CIRC','PPCC','    ','    ','    ','    '/
      DATA INFLAV(839)/1/
      DATA INLONG(839)/'SEMI-CIRCULAR PPCC'/
C
      DATA INCASE(840)/'G1PP'/
      DATA (INAME(840,J),J=1,MAXSCL)/
     1'MINI','    ','GUMB','PPCC','    ','    ','    ','    '/
      DATA INFLAV(840)/1/
      DATA INLONG(840)/'MINIMUM GUMBEL PPCC'/
C
      DATA INCASE(841)/'G2PP'/
      DATA (INAME(841,J),J=1,MAXSCL)/
     1'MAXI','    ','GUMB','PPCC','    ','    ','    ','    '/
      DATA INFLAV(841)/1/
      DATA INLONG(841)/'MAXIMUM GUMBEL PPCC'/
C
      DATA INCASE(842)/'MINI'/
      DATA (INAME(842,J),J=1,MAXSCL)/
     1'MINI','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(842)/1/
      DATA INLONG(842)/'MINIMUM'/
C
      DATA INCASE(843)/'LNLO'/
      DATA (INAME(843,J),J=1,MAXSCL)/
     1'LOG ','    ','NORM','PPCC','LOCA','    ','    ','    '/
      DATA INFLAV(843)/1/
      DATA INLONG(843)/'LOGNORMAL PPCC LOCATION'/
C
      DATA INCASE(844)/'LNSC'/
      DATA (INAME(844,J),J=1,MAXSCL)/
     1'LOG ','    ','NORM','PPCC','SCAL','    ','    ','    '/
      DATA INFLAV(844)/1/
      DATA INLONG(844)/'LOGNORMAL PPCC SCALE'/
C
      DATA INCASE(845)/'LNSH'/
      DATA (INAME(845,J),J=1,MAXSCL)/
     1'LOG ','    ','NORM','PPCC','SHAP','    ','    ','    '/
      DATA INFLAV(845)/1/
      DATA INLONG(845)/'LOGNORMAL PPCC SHAPE'/
C
      DATA INCASE(846)/'LNPP'/
      DATA (INAME(846,J),J=1,MAXSCL)/
     1'LOG ','    ','NORM','PPCC','STAT','    ','    ','    '/
      DATA INFLAV(846)/1/
      DATA INLONG(846)/'LOGNORMAL PPCC STATISTIC'/
C
      DATA INCASE(847)/'GPLO'/
      DATA (INAME(847,J),J=1,MAXSCL)/
     1'GENE','    ','PARE','PPCC','LOCA','    ','    ','    '/
      DATA INFLAV(847)/1/
      DATA INLONG(847)/'GENERALIZED PARETO PPCC LOCATION'/
C
      DATA INCASE(848)/'GPSC'/
      DATA (INAME(848,J),J=1,MAXSCL)/
     1'GENE','    ','PARE','PPCC','SCAL','    ','    ','    '/
      DATA INFLAV(848)/1/
      DATA INLONG(848)/'GENERALIZED PARETO PPCC SCALE'/
C
      DATA INCASE(849)/'GPSH'/
      DATA (INAME(849,J),J=1,MAXSCL)/
     1'GENE','    ','PARE','PPCC','SHAP','    ','    ','    '/
      DATA INFLAV(849)/1/
      DATA INLONG(849)/'GENERALIZED PARETO PPCC SHAPE'/
C
      DATA INCASE(850)/'GPPP'/
      DATA (INAME(850,J),J=1,MAXSCL)/
     1'GENE','    ','PARE','PPCC','STAT','    ','    ','    '/
      DATA INFLAV(850)/1/
      DATA INLONG(850)/'GENERALIZED PARETO PPCC STATISTIC'/
C
      DATA INCASE(851)/'GHLO'/
      DATA (INAME(851,J),J=1,MAXSCL)/
     1'G   ','    ','H   ','PPCC','LOCA','    ','    ','    '/
      DATA INFLAV(851)/1/
      DATA INLONG(851)/'G-AND-H PPCC LOCATION'/
C
      DATA INCASE(852)/'GHSC'/
      DATA (INAME(852,J),J=1,MAXSCL)/
     1'G   ','    ','H   ','PPCC','SCAL','    ','    ','    '/
      DATA INFLAV(852)/1/
      DATA INLONG(852)/'G-AND-H PPCC SCALE'/
C
      DATA INCASE(853)/'GHSH'/
      DATA (INAME(853,J),J=1,MAXSCL)/
     1'G   ','    ','H   ','PPCC','SHAP','ONE ','    ','    '/
      DATA INFLAV(853)/1/
      DATA INLONG(853)/'G-AND-H PPCC SHAPE ONE (G)'/
C
      DATA INCASE(854)/'GHS2'/
      DATA (INAME(854,J),J=1,MAXSCL)/
     1'G   ','    ','H   ','PPCC','SHAP','TWO ','    ','    '/
      DATA INFLAV(854)/1/
      DATA INLONG(854)/'G-AND-H PPCC SHAPE TWO (H)'/
C
      DATA INCASE(855)/'GHSH'/
      DATA (INAME(855,J),J=1,MAXSCL)/
     1'G   ','    ','H   ','PPCC','G   ','    ','    ','    '/
      DATA INFLAV(855)/1/
      DATA INLONG(855)/'G-AND-H PPCC SHAPE ONE (G)'/
C
      DATA INCASE(856)/'GHS2'/
      DATA (INAME(856,J),J=1,MAXSCL)/
     1'G   ','    ','H   ','PPCC','H   ','    ','    ','    '/
      DATA INFLAV(856)/1/
      DATA INLONG(856)/'G-AND-H PPCC SHAPE TWO (H)'/
C
      DATA INCASE(857)/'GHSH'/
      DATA (INAME(857,J),J=1,MAXSCL)/
     1'G   ','    ','H   ','PPCC','SHAP','    ','    ','    '/
      DATA INFLAV(857)/1/
      DATA INLONG(857)/'G-AND-H PPCC SHAPE ONE (G)'/
C
      DATA INCASE(858)/'GHPP'/
      DATA (INAME(858,J),J=1,MAXSCL)/
     1'G   ','    ','H   ','PPCC','STAT','    ','    ','    '/
      DATA INFLAV(858)/1/
      DATA INLONG(858)/'G-AND-H PPCC'/
C
      DATA INCASE(859)/'GHLO'/
      DATA (INAME(859,J),J=1,MAXSCL)/
     1'G   ','    ','AND ','H   ','PPCC','LOCA','    ','    '/
      DATA INFLAV(859)/1/
      DATA INLONG(859)/'G-AND-H PPCC LOCATION'/
C
      DATA INCASE(860)/'GHSC'/
      DATA (INAME(860,J),J=1,MAXSCL)/
     1'G   ','    ','AND ','H   ','PPCC','SCAL','    ','    '/
      DATA INFLAV(860)/1/
      DATA INLONG(860)/'G-AND-H PPCC SCALE'/
C
      DATA INCASE(861)/'GHSH'/
      DATA (INAME(861,J),J=1,MAXSCL)/
     1'G   ','    ','AND ','H   ','PPCC','SHAP','ONE ','    '/
      DATA INFLAV(861)/1/
      DATA INLONG(861)/'G-AND-H PPCC SHAPE ONE (G)'/
C
      DATA INCASE(862)/'GHS2'/
      DATA (INAME(862,J),J=1,MAXSCL)/
     1'G   ','    ','AND ','H   ','PPCC','SHAP','TWO ','    '/
      DATA INFLAV(862)/1/
      DATA INLONG(862)/'G-AND-H PPCC SHAPE TWO (H)'/
C
      DATA INCASE(863)/'GHSH'/
      DATA (INAME(863,J),J=1,MAXSCL)/
     1'G   ','    ','AND ','H   ','PPCC','G   ','    ','    '/
      DATA INFLAV(863)/1/
      DATA INLONG(863)/'G-AND-H PPCC SHAPE ONE (G)'/
C
      DATA INCASE(864)/'GHS2'/
      DATA (INAME(864,J),J=1,MAXSCL)/
     1'G   ','    ','AND ','H   ','PPCC','H   ','    ','    '/
      DATA INFLAV(864)/1/
      DATA INLONG(864)/'G-AND-H PPCC SHAPE TWO (H)'/
C
      DATA INCASE(865)/'GHSH'/
      DATA (INAME(865,J),J=1,MAXSCL)/
     1'G   ','    ','AND ','H   ','PPCC','SHAP','    ','    '/
      DATA INFLAV(865)/1/
      DATA INLONG(865)/'G-AND-H PPCC SHAPE ONE (G)'/
C
      DATA INCASE(866)/'GHPP'/
      DATA (INAME(866,J),J=1,MAXSCL)/
     1'G   ','    ','AND ','H   ','PPCC','STAT','    ','    '/
      DATA INFLAV(866)/1/
      DATA INLONG(866)/'G-AND-H PPCC'/
C
      DATA INCASE(867)/'LNLO'/
      DATA (INAME(867,J),J=1,MAXSCL)/
     1'LOGN','    ','PPCC','LOCA','    ','    ','    ','    '/
      DATA INFLAV(867)/1/
      DATA INLONG(867)/'LOGNORMAL PPCC LOCATION'/
C
      DATA INCASE(868)/'LNSC'/
      DATA (INAME(868,J),J=1,MAXSCL)/
     1'LOGN','    ','PPCC','SCAL','    ','    ','    ','    '/
      DATA INFLAV(868)/1/
      DATA INLONG(868)/'LOGNORMAL PPCC SCALE'/
C
      DATA INCASE(869)/'LNSH'/
      DATA (INAME(869,J),J=1,MAXSCL)/
     1'LOGN','    ','PPCC','SHAP','    ','    ','    ','    '/
      DATA INFLAV(869)/1/
      DATA INLONG(869)/'LOGNORMAL PPCC SHAPE'/
C
      DATA INCASE(870)/'LNPP'/
      DATA (INAME(870,J),J=1,MAXSCL)/
     1'LOGN','    ','PPCC','STAT','    ','    ','    ','    '/
      DATA INFLAV(870)/1/
      DATA INLONG(870)/'LOGNORMAL PPCC STATISTIC'/
C
      DATA INCASE(871)/'WALO'/
      DATA (INAME(871,J),J=1,MAXSCL)/
     1'WALD','    ','PPCC','LOCA','    ','    ','    ','    '/
      DATA INFLAV(871)/1/
      DATA INLONG(871)/'WALD PPCC LOCATION'/
C
      DATA INCASE(872)/'WASC'/
      DATA (INAME(872,J),J=1,MAXSCL)/
     1'WALD','    ','PPCC','SCAL','    ','    ','    ','    '/
      DATA INFLAV(872)/1/
      DATA INLONG(872)/'WALD PPCC SCALE'/
C
      DATA INCASE(873)/'WASH'/
      DATA (INAME(873,J),J=1,MAXSCL)/
     1'WALD','    ','PPCC','SHAP','    ','    ','    ','    '/
      DATA INFLAV(873)/1/
      DATA INLONG(873)/'WALD PPCC SHAPE'/
C
      DATA INCASE(874)/'WAPP'/
      DATA (INAME(874,J),J=1,MAXSCL)/
     1'WALD','    ','PPCC','STAT','    ','    ','    ','    '/
      DATA INFLAV(874)/1/
      DATA INLONG(874)/'WALD PPCC STATISTIC'/
C
      DATA INCASE(875)/'GALO'/
      DATA (INAME(875,J),J=1,MAXSCL)/
     1'GAMM','    ','PPCC','LOCA','    ','    ','    ','    '/
      DATA INFLAV(875)/1/
      DATA INLONG(875)/'GAMMA PPCC LOCATION'/
C
      DATA INCASE(876)/'GASC'/
      DATA (INAME(876,J),J=1,MAXSCL)/
     1'GAMM','    ','PPCC','SCAL','    ','    ','    ','    '/
      DATA INFLAV(876)/1/
      DATA INLONG(876)/'GAMMA PPCC SCALE'/
C
      DATA INCASE(877)/'GASH'/
      DATA (INAME(877,J),J=1,MAXSCL)/
     1'GAMM','    ','PPCC','SHAP','    ','    ','    ','    '/
      DATA INFLAV(877)/1/
      DATA INLONG(877)/'GAMMA PPCC SHAPE'/
C
      DATA INCASE(878)/'GAPP'/
      DATA (INAME(878,J),J=1,MAXSCL)/
     1'GAMM','    ','PPCC','STAT','    ','    ','    ','    '/
      DATA INFLAV(878)/1/
      DATA INLONG(878)/'GAMMA PPCC STATISTIC'/
C
      DATA INCASE(879)/'FLLO'/
      DATA (INAME(879,J),J=1,MAXSCL)/
     1'FATI','    ','LIFE','PPCC','LOCA','    ','    ','    '/
      DATA INFLAV(879)/1/
      DATA INLONG(879)/'FATIGUE LIFE PPCC LOCATION'/
C
      DATA INCASE(880)/'FLSC'/
      DATA (INAME(880,J),J=1,MAXSCL)/
     1'FATI','    ','LIFE','PPCC','SCAL','    ','    ','    '/
      DATA INFLAV(880)/1/
      DATA INLONG(880)/'FATIGUE LIFE PPCC SCALE'/
C
      DATA INCASE(881)/'FLSH'/
      DATA (INAME(881,J),J=1,MAXSCL)/
     1'FATI','    ','LIFE','PPCC','SHAP','    ','    ','    '/
      DATA INFLAV(881)/1/
      DATA INLONG(881)/'FATIGUE LIFE PPCC SHAPE'/
C
      DATA INCASE(882)/'FLPP'/
      DATA (INAME(882,J),J=1,MAXSCL)/
     1'FATI','    ','LIFE','PPCC','STAT','    ','    ','    '/
      DATA INFLAV(882)/1/
      DATA INLONG(882)/'FATIGUE LIFE PPCC STATISTIC'/
C
      DATA INCASE(883)/'IWLO'/
      DATA (INAME(883,J),J=1,MAXSCL)/
     1'INVE','    ','WEIB','PPCC','LOCA','    ','    ','    '/
      DATA INFLAV(883)/1/
      DATA INLONG(883)/'INVERTED WEIBULL PPCC LOCATION'/
C
      DATA INCASE(884)/'IWSH'/
      DATA (INAME(884,J),J=1,MAXSCL)/
     1'INVE','    ','WEIB','PPCC','SCAL','    ','    ','    '/
      DATA INFLAV(884)/1/
      DATA INLONG(884)/'INVERTED WEIBULL PPCC SCALE'/
C
      DATA INCASE(885)/'IWSH'/
      DATA (INAME(885,J),J=1,MAXSCL)/
     1'INVE','    ','WEIB','PPCC','SHAP','    ','    ','    '/
      DATA INFLAV(885)/1/
      DATA INLONG(885)/'INVERTED WEIBULL PPCC SHAPE'/
C
      DATA INCASE(886)/'IWPP'/
      DATA (INAME(886,J),J=1,MAXSCL)/
     1'INVE','    ','WEIB','PPCC','STAT','    ','    ','    '/
      DATA INFLAV(886)/1/
      DATA INLONG(886)/'INVERTED WEIBULL PPCC'/
C
      DATA INCASE(887)/'PACD'/
      DATA (INAME(887,J),J=1,MAXSCL)/
     1'PAGE','    ','TEST','CDF ','    ','    ','    ','    '/
      DATA INFLAV(887)/3/
      DATA INLONG(887)/'PAGE TEST CDF'/
C
      DATA INCASE(888)/'PAPV'/
      DATA (INAME(888,J),J=1,MAXSCL)/
     1'PAGE','    ','TEST','PVAL','    ','    ','    ','    '/
      DATA INFLAV(888)/3/
      DATA INLONG(888)/'PAGE TEST PVALUE'/
C
      DATA INCASE(889)/'PAT2'/
      DATA (INAME(889,J),J=1,MAXSCL)/
     1'PAGE','    ','TEST','NORM','    ','    ','    ','    '/
      DATA INFLAV(889)/3/
      DATA INLONG(889)/'PAGE TEST NORMALIZED'/
C
      DATA INCASE(890)/'PATE'/
      DATA (INAME(890,J),J=1,MAXSCL)/
     1'PAGE','    ','TEST','    ','    ','    ','    ','    '/
      DATA INFLAV(890)/3/
      DATA INLONG(890)/'PAGE TEST'/
C
      DATA INCASE(891)/'LJCD'/
      DATA (INAME(891,J),J=1,MAXSCL)/
     1'LJUN','    ','BOX ','TEST','CDF ','    ','    ','    '/
      DATA INFLAV(891)/1/
      DATA INLONG(891)/'LJUNG-BOX TEST'/
C
      DATA INCASE(892)/'LJPV'/
      DATA (INAME(892,J),J=1,MAXSCL)/
     1'LJUN','    ','BOX ','TEST','PVAL','    ','    ','    '/
      DATA INFLAV(892)/1/
      DATA INLONG(892)/'LJUNG-BOX TEST PVALUE'/
C
      DATA INCASE(893)/'LJUN'/
      DATA (INAME(893,J),J=1,MAXSCL)/
     1'LJUN','    ','BOX ','TEST','    ','    ','    ','    '/
      DATA INFLAV(893)/1/
      DATA INLONG(893)/'LJUNG-BOX TEST'/
C
      DATA INCASE(894)/'MSDC'/
      DATA (INAME(894,J),J=1,MAXSCL)/
     1'MEAN','    ','SUCC','DIFF','CDF ','    ','    ','    '/
      DATA INFLAV(894)/1/
      DATA INLONG(894)/'MEAN SUCCESSIVE DIFFERENCES CDF'/
C
      DATA INCASE(895)/'MSDP'/
      DATA (INAME(895,J),J=1,MAXSCL)/
     1'MEAN','    ','SUCC','DIFF','TEST','PVAL','    ','    '/
      DATA INFLAV(895)/1/
      DATA INLONG(895)/'MEAN SUCCESSIVE DIFFERENCES PVALUE'/
C
      DATA INCASE(896)/'MSDP'/
      DATA (INAME(896,J),J=1,MAXSCL)/
     1'MEAN','    ','SUCC','DIFF','PVAL','    ','    ','    '/
      DATA INFLAV(896)/1/
      DATA INLONG(896)/'MEAN SUCCESSIVE DIFFERENCES PVALUE'/
C
      DATA INCASE(897)/'MSDT'/
      DATA (INAME(897,J),J=1,MAXSCL)/
     1'MEAN','    ','SUCC','DIFF','TEST','    ','    ','    '/
      DATA INFLAV(897)/1/
      DATA INLONG(897)/'MEAN SUCCESSIVE DIFFERENCES'/
C
      DATA INCASE(898)/'MSDT'/
      DATA (INAME(898,J),J=1,MAXSCL)/
     1'MEAN','    ','SUCC','DIFF','    ','    ','    ','    '/
      DATA INFLAV(898)/1/
      DATA INLONG(898)/'MEAN SUCCESSIVE DIFFERENCES'/
C
      DATA INCASE(899)/'KTPV'/
      DATA (INAME(899,J),J=1,MAXSCL)/
     1'KEND','    ','TAU ','PVAL','    ','    ','    ','    '/
      DATA INFLAV(899)/2/
      DATA INLONG(899)/'KENDALLS TAU PVALUE'/
C
      DATA INCASE(900)/'KTPV'/
      DATA (INAME(900,J),J=1,MAXSCL)/
     1'KEND','    ','TAU ','PVAL','    ','    ','    ','    '/
      DATA INFLAV(900)/2/
      DATA INLONG(900)/'KENDALLS TAU PVALUE'/
C
      DATA INCASE(901)/'KTPL'/
      DATA (INAME(901,J),J=1,MAXSCL)/
     1'KEND','    ','TAU ','LOWE','TAIL','PVAL','    ','    '/
      DATA INFLAV(901)/2/
      DATA INLONG(901)/'KENDALLS TAU LOWER TAILED PVALUE'/
C
      DATA INCASE(902)/'MNNP'/
      DATA (INAME(902,J),J=1,MAXSCL)/
     1'MEAN','    ','NEAR','NEIG','DIST','PVAL','    ','    '/
      DATA INFLAV(902)/2/
      DATA INLONG(902)/'MEAN NEAREST NEIGHBOR DISTANCE PVALUE'/
C
      DATA INCASE(903)/'MAXI'/
      DATA (INAME(903,J),J=1,MAXSCL)/
     1'MAXI','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(903)/1/
      DATA INLONG(903)/'MAXIMUM'/
C
      DATA INCASE(904)/'MNNC'/
      DATA (INAME(904,J),J=1,MAXSCL)/
     1'MEAN','    ','NEAR','NEIG','DIST','CDF ','    ','    '/
      DATA INFLAV(904)/2/
      DATA INLONG(904)/'MEAN NEAREST NEIGHBOR DISTANCE CDF'/
C
      DATA INCASE(905)/'SUM '/
      DATA (INAME(905,J),J=1,MAXSCL)/
     1'SUM ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(905)/1/
      DATA INLONG(905)/'SUM'/
C
      DATA INCASE(906)/'RACP'/
      DATA (INAME(906,J),J=1,MAXSCL)/
     1'RANK','    ','CORR','PVAL','    ','    ','    ','    '/
      DATA INFLAV(906)/2/
      DATA INLONG(906)/'RANK CORRELATION P-VALUE'/
C
      DATA INCASE(907)/'RALP'/
      DATA (INAME(907,J),J=1,MAXSCL)/
     1'RANK','    ','CORR','LOWE','TAIL','PVAL','    ','    '/
      DATA INFLAV(907)/2/
      DATA INLONG(907)/'RANK CORRELATION LOWER TAILED P-VALUE'/
C
      DATA INCASE(908)/'RAUP'/
      DATA (INAME(908,J),J=1,MAXSCL)/
     1'RANK','    ','CORR','UPPE','TAIL','PVAL','    ','    '/
      DATA INFLAV(908)/2/
      DATA INLONG(908)/'RANK CORRELATION UPPER TAILED P-VALUE'/
C
      DATA INCASE(909)/'RACR'/
      DATA (INAME(909,J),J=1,MAXSCL)/
     1'RANK','    ','CORR','    ','    ','    ','    ','    '/
      DATA INFLAV(909)/2/
      DATA INLONG(909)/'RANK CORRELATION'/
C
      DATA INCASE(910)/'RACC'/
      DATA (INAME(910,J),J=1,MAXSCL)/
     1'SPEA','    ','RHO ','CDF ','    ','    ','    ','    '/
      DATA INFLAV(910)/2/
      DATA INLONG(910)/'RANK CORRELATION CDF'/
C
      DATA INCASE(911)/'RACP'/
      DATA (INAME(911,J),J=1,MAXSCL)/
     1'SPEA','    ','RHO ','PVAL','    ','    ','    ','    '/
      DATA INFLAV(911)/2/
      DATA INLONG(911)/'RANK CORRELATION PVALUE'/
C
      DATA INCASE(912)/'RALP'/
      DATA (INAME(912,J),J=1,MAXSCL)/
     1'SPEA','    ','RHO ','LOWE','TAIL','PVAL','    ','    '/
      DATA INFLAV(912)/2/
      DATA INLONG(912)/'RANK CORRELATION LOWER TAILED PVALUE'/
C
      DATA INCASE(913)/'RAUP'/
      DATA (INAME(913,J),J=1,MAXSCL)/
     1'SPEA','    ','RHO ','UPPE','TAIL','PVAL','    ','    '/
      DATA INFLAV(913)/2/
      DATA INLONG(913)/'RANK CORRELATION UPPER TAILED PVALUE'/
C
      DATA INCASE(914)/'RACR'/
      DATA (INAME(914,J),J=1,MAXSCL)/
     1'SPEA','    ','RHO ','    ','    ','    ','    ','    '/
      DATA INFLAV(914)/2/
      DATA INLONG(914)/'RANK CORRELATION'/
C
      DATA INCASE(915)/'KTPU'/
      DATA (INAME(915,J),J=1,MAXSCL)/
     1'KEND','    ','TAU ','UPPE','TAIL','PVAL','    ','    '/
      DATA INFLAV(915)/2/
      DATA INLONG(915)/'KENDALLS TAU UPPER TAILED PVALUE'/
C
      DATA INCASE(916)/'KDIS'/
      DATA (INAME(916,J),J=1,MAXSCL)/
     1'KEND','    ','TAU ','DISS','    ','    ','    ','    '/
      DATA INFLAV(916)/2/
      DATA INLONG(916)/'KENDALLS TAU DISSIMILARITY'/
C
      DATA INCASE(917)/'DSSQ'/
      DATA (INAME(917,J),J=1,MAXSCL)/
     1'DIFF','    ','SUM ','OF  ','SQUA','    ','    ','    '/
      DATA INFLAV(917)/2/
      DATA INLONG(917)/'DIFFERENCE OF SUM OF SQUARES'/
C
      DATA INCASE(918)/'DSSQ'/
      DATA (INAME(918,J),J=1,MAXSCL)/
     1'DIFF','    ','SUMS','OF  ','SQUA','    ','    ','    '/
      DATA INFLAV(918)/2/
      DATA INLONG(918)/'DIFFERENCE OF SUM OF SQUARES'/
C
      DATA INCASE(919)/'DSSQ'/
      DATA (INAME(919,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','SUM ','OF  ','SQUA','    ','    '/
      DATA INFLAV(919)/2/
      DATA INLONG(919)/'DIFFERENCE OF SUM OF SQUARES'/
C
      DATA INCASE(920)/'DSSQ'/
      DATA (INAME(920,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','SUMS','OF  ','SQUA','    ','    '/
      DATA INFLAV(920)/2/
      DATA INLONG(920)/'DIFFERENCE OF SUM OF SQUARES'/
C
      DATA INCASE(921)/'LPB '/
      DATA (INAME(921,J),J=1,MAXSCL)/
     1'LOWE','    ','PRED','BOUN','    ','    ','    ','    '/
      DATA INFLAV(921)/1/
      DATA INLONG(921)/'LOWER PREDICTION BOUND'/
C
      DATA INCASE(922)/'UPB '/
      DATA (INAME(922,J),J=1,MAXSCL)/
     1'UPPE','    ','PRED','BOUN','    ','    ','    ','    '/
      DATA INFLAV(922)/1/
      DATA INLONG(922)/'UPPER PREDICTION BOUND'/
C
      DATA INCASE(923)/'1LPB'/
      DATA (INAME(923,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','LOWE','PRED','BOUN','    ','    '/
      DATA INFLAV(923)/1/
      DATA INLONG(923)/'ONE-SIDED LOWER PREDICTION BOUND'/
C
      DATA INCASE(924)/'1UPL'/
      DATA (INAME(924,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','UPPE','PRED','BOUN','    ','    '/
      DATA INFLAV(924)/1/
      DATA INLONG(924)/'ONE-SIDED UPPER PREDICTION BOUND'/
C
      DATA INCASE(925)/'SLPL'/
      DATA (INAME(925,J),J=1,MAXSCL)/
     1'SUMM','    ','LOWE','PRED','LIMI','    ','    ','    '/
      DATA INFLAV(925)/3/
      DATA INLONG(925)/'SUMMARY LOWER PREDICTION LIMITS'/
C
      DATA INCASE(926)/'SLPL'/
      DATA (INAME(926,J),J=1,MAXSCL)/
     1'SUMM','    ','LOWE','PRED','INTE','    ','    ','    '/
      DATA INFLAV(926)/3/
      DATA INLONG(926)/'SUMMARY LOWER PREDICTION LIMITS'/
C
      DATA INCASE(927)/'SLP1'/
      DATA (INAME(927,J),J=1,MAXSCL)/
     1'SUMM','    ','ONE ','SIDE','LOWE','PRED','LIMI','    '/
      DATA INFLAV(927)/3/
      DATA INLONG(927)/'SUMMARY ONE SIDED LOWER PREDICTION LIMITS'/
C
      DATA INCASE(928)/'SLP1'/
      DATA (INAME(928,J),J=1,MAXSCL)/
     1'SUMM','    ','ONE ','SIDE','LOWE','PRED','INTE','    '/
      DATA INFLAV(928)/3/
      DATA INLONG(928)/'SUMMARY ONE SIDED LOWER PREDICTION LIMITS'/
C
      DATA INCASE(929)/'SUPL'/
      DATA (INAME(929,J),J=1,MAXSCL)/
     1'SUMM','    ','UPPE','PRED','LIMI','    ','    ','    '/
      DATA INFLAV(929)/3/
      DATA INLONG(929)/'SUMMARY UPPER PREDICTION LIMITS'/
C
      DATA INCASE(930)/'SUPL'/
      DATA (INAME(930,J),J=1,MAXSCL)/
     1'SUMM','    ','UPPE','PRED','INTE','    ','    ','    '/
      DATA INFLAV(930)/3/
      DATA INLONG(930)/'SUMMARY UPPER PREDICTION LIMITS'/
C
      DATA INCASE(931)/'SUP1'/
      DATA (INAME(931,J),J=1,MAXSCL)/
     1'SUMM','    ','ONE ','SIDE','UPPE','PRED','LIMI','    '/
      DATA INFLAV(931)/3/
      DATA INLONG(931)/'SUMMARY ONE SIDE UPPER PREDICTION LIMITS'/
C
      DATA INCASE(932)/'SUP1'/
      DATA (INAME(932,J),J=1,MAXSCL)/
     1'SUMM','    ','ONE ','SIDE','UPPE','PRED','INTE','    '/
      DATA INFLAV(932)/3/
      DATA INLONG(932)/'SUMMARY ONE SIDE UPPER PREDICTION LIMITS'/
C
      DATA INCASE(933)/'SLPB'/
      DATA (INAME(933,J),J=1,MAXSCL)/
     1'SUMM','    ','LOWE','PRED','BOUN','    ','    ','    '/
      DATA INFLAV(933)/3/
      DATA INLONG(933)/'SUMMARY LOWER PREDICTION BOUNDS'/
C
      DATA INCASE(934)/'SUPB'/
      DATA (INAME(934,J),J=1,MAXSCL)/
     1'SUMM','    ','UPPE','PRED','BOUN','    ','    ','    '/
      DATA INFLAV(934)/3/
      DATA INLONG(934)/'SUMMARY UPPER PREDICTION BOUNDS'/
C
      DATA INCASE(935)/'SLB1'/
      DATA (INAME(935,J),J=1,MAXSCL)/
     1'SUMM','    ','ONE ','SIDE','LOWE','PRED','BOUN','    '/
      DATA INFLAV(935)/3/
      DATA INLONG(935)/'SUMMARY ONE SIDED LOWER PREDICTION BOUNDS'/
C
      DATA INCASE(936)/'SUB1'/
      DATA (INAME(936,J),J=1,MAXSCL)/
     1'SUMM','    ','ONE ','SIDE','UPPE','PRED','BOUN','    '/
      DATA INFLAV(936)/3/
      DATA INLONG(936)/'SUMMARY ONE SIDED UPPER PREDICTION BOUNDS'/
C
      DATA INCASE(937)/'SILO'/
      DATA (INAME(937,J),J=1,MAXSCL)/
     1'SINE','    ','PPCC','LOCA','    ','    ','    ','    '/
      DATA INFLAV(937)/1/
      DATA INLONG(937)/'SINE PPCC LOCATION'/
C
      DATA INCASE(938)/'SISC'/
      DATA (INAME(938,J),J=1,MAXSCL)/
     1'SINE','    ','PPCC','SCAL','    ','    ','    ','    '/
      DATA INFLAV(938)/1/
      DATA INLONG(938)/'SINE PPCC SCALE'/
C
      DATA INCASE(939)/'SIPP'/
      DATA (INAME(939,J),J=1,MAXSCL)/
     1'SINE','    ','PPCC','    ','    ','    ','    ','    '/
      DATA INFLAV(939)/1/
      DATA INLONG(939)/'SINE PPCC'/
C
      DATA INCASE(940)/'SUS1'/
      DATA (INAME(940,J),J=1,MAXSCL)/
     1'SUMM','    ','ONE ','SIDE','UPPE','SD  ','PRED','LIMI'/
      DATA INFLAV(940)/2/
      DATA INLONG(940)/'SUMMARY ONE SIDED UPPER SD PREDICTION LIMITS'/
C
      DATA INCASE(941)/'SUS1'/
      DATA (INAME(941,J),J=1,MAXSCL)/
     1'SUMM','    ','ONE ','SIDE','UPPE','SD  ','PRED','INTE'/
      DATA INFLAV(941)/2/
      DATA INLONG(941)/'SUMMARY ONE SIDED UPPER SD PREDICTION LIMITS'/
C
      DATA INCASE(942)/'SLS1'/
      DATA (INAME(942,J),J=1,MAXSCL)/
     1'SUMM','    ','ONE ','SIDE','LOWE','SD  ','PRED','LIMI'/
      DATA INFLAV(942)/2/
      DATA INLONG(942)/'SUMMARY ONE SIDED LOWER SD PREDICTION LIMITS'/
C
      DATA INCASE(943)/'SLS1'/
      DATA (INAME(943,J),J=1,MAXSCL)/
     1'SUMM','    ','ONE ','SIDE','LOWE','SD  ','PRED','LIMI'/
      DATA INFLAV(943)/2/
      DATA INLONG(943)/'SUMMARY ONE SIDED LOWER SD PREDICTION LIMITS'/
C
      DATA INCASE(944)/'SUS2'/
      DATA (INAME(944,J),J=1,MAXSCL)/
     1'SUMM','    ','UPPE','SD  ','PRED','LIMI','    ','    '/
      DATA INFLAV(944)/2/
      DATA INLONG(944)/'SUMMARY UPPER SD PREDICTION LIMITS'/
C
      DATA INCASE(945)/'SUS2'/
      DATA (INAME(945,J),J=1,MAXSCL)/
     1'SUMM','    ','UPPE','SD  ','PRED','INTE','    ','    '/
      DATA INFLAV(945)/2/
      DATA INLONG(945)/'SUMMARY UPPER SD PREDICTION LIMITS'/
C
      DATA INCASE(946)/'SUS2'/
      DATA (INAME(946,J),J=1,MAXSCL)/
     1'SUMM','    ','UPPE','STAN','DEVI','PRED','LIMI','    '/
      DATA INFLAV(946)/2/
      DATA INLONG(946)/'SUMMARY UPPER SD PREDICTION LIMITS'/
C
      DATA INCASE(947)/'SUS2'/
      DATA (INAME(947,J),J=1,MAXSCL)/
     1'SUMM','    ','UPPE','STAN','DEVI','PRED','INTE','    '/
      DATA INFLAV(947)/2/
      DATA INLONG(947)/'SUMMARY UPPER SD PREDICTION LIMITS'/
C
      DATA INCASE(948)/'SLS2'/
      DATA (INAME(948,J),J=1,MAXSCL)/
     1'SUMM','    ','LOWE','SD  ','PRED','LIMI','    ','    '/
      DATA INFLAV(948)/2/
      DATA INLONG(948)/'SUMMARY LOWER SD PREDICTION LIMITS'/
C
      DATA INCASE(949)/'SLS2'/
      DATA (INAME(949,J),J=1,MAXSCL)/
     1'SUMM','    ','LOWE','SD  ','PRED','INTE','    ','    '/
      DATA INFLAV(949)/2/
      DATA INLONG(949)/'SUMMARY LOWER SD PREDICTION LIMITS'/
C
      DATA INCASE(950)/'SLS2'/
      DATA (INAME(950,J),J=1,MAXSCL)/
     1'SUMM','    ','LOWE','STAN','DEVI','PRED','LIMI','    '/
      DATA INFLAV(950)/2/
      DATA INLONG(950)/'SUMMARY LOWER SD PREDICTION LIMITS'/
C
      DATA INCASE(951)/'SLS2'/
      DATA (INAME(951,J),J=1,MAXSCL)/
     1'SUMM','    ','LOWE','STAN','DEVI','PRED','INTE','    '/
      DATA INFLAV(951)/2/
      DATA INLONG(951)/'SUMMARY LOWER SD PREDICTION LIMITS'/
C
      DATA INCASE(952)/'UPS1'/
      DATA (INAME(952,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','UPPE','SD  ','PRED','LIMI','    '/
      DATA INFLAV(952)/1/
      DATA INLONG(952)/'ONE SIDED UPPER SD PREDICTION LIMITS'/
C
      DATA INCASE(953)/'UPS1'/
      DATA (INAME(953,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','UPPE','SD  ','PRED','INTE','    '/
      DATA INFLAV(953)/1/
      DATA INLONG(953)/'ONE SIDED UPPER SD PREDICTION LIMITS'/
C
      DATA INCASE(954)/'UPS1'/
      DATA (INAME(954,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','UPPE','STAN','DEVI','PRED','LIMI'/
      DATA INFLAV(954)/1/
      DATA INLONG(954)/'ONE SIDED UPPER SD PREDICTION LIMITS'/
C
      DATA INCASE(955)/'UPS1'/
      DATA (INAME(955,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','UPPE','STAN','DEVI','PRED','INTE'/
      DATA INFLAV(955)/1/
      DATA INLONG(955)/'ONE SIDED UPPER SD PREDICTION LIMITS'/
C
      DATA INCASE(956)/'LPS1'/
      DATA (INAME(956,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','LOWE','SD  ','PRED','LIMI','    '/
      DATA INFLAV(956)/1/
      DATA INLONG(956)/'ONE SIDED LOWER SD PREDICTION LIMITS'/
C
      DATA INCASE(957)/'LPS1'/
      DATA (INAME(957,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','LOWE','SD  ','PRED','INTE','    '/
      DATA INFLAV(957)/1/
      DATA INLONG(957)/'ONE SIDED LOWER SD PREDICTION LIMITS'/
C
      DATA INCASE(958)/'LPS1'/
      DATA (INAME(958,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','LOWE','STAN','DEVI','PRED','LIMI'/
      DATA INFLAV(958)/1/
      DATA INLONG(958)/'ONE SIDED LOWER SD PREDICTION LIMITS'/
C
      DATA INCASE(959)/'LPS1'/
      DATA (INAME(959,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','LOWE','STAN','DEVI','PRED','INTE'/
      DATA INFLAV(959)/1/
      DATA INLONG(959)/'ONE SIDED LOWER SD PREDICTION LIMITS'/
C
      DATA INCASE(960)/'UPS2'/
      DATA (INAME(960,J),J=1,MAXSCL)/
     1'UPPE','    ','SD  ','PRED','LIMI','    ','    ','    '/
      DATA INFLAV(960)/1/
      DATA INLONG(960)/'UPPER SD PREDICTION LIMITS'/
C
      DATA INCASE(961)/'UPS2'/
      DATA (INAME(961,J),J=1,MAXSCL)/
     1'UPPE','    ','SD  ','PRED','INTE','    ','    ','    '/
      DATA INFLAV(961)/1/
      DATA INLONG(961)/'UPPER SD PREDICTION LIMITS'/
C
      DATA INCASE(962)/'UPS2'/
      DATA (INAME(962,J),J=1,MAXSCL)/
     1'UPPE','    ','STAN','DEVI','PRED','LIMI','    ','    '/
      DATA INFLAV(962)/1/
      DATA INLONG(962)/'UPPER SD PREDICTION LIMITS'/
C
      DATA INCASE(963)/'UPS2'/
      DATA (INAME(963,J),J=1,MAXSCL)/
     1'UPPE','    ','STAN','DEVI','PRED','INTE','    ','    '/
      DATA INFLAV(963)/1/
      DATA INLONG(963)/'UPPER SD PREDICTION LIMITS'/
C
      DATA INCASE(964)/'LPS2'/
      DATA (INAME(964,J),J=1,MAXSCL)/
     1'LOWE','    ','SD  ','PRED','LIMI','    ','    ','    '/
      DATA INFLAV(964)/1/
      DATA INLONG(964)/'LOWER SD PREDICTION LIMITS'/
C
      DATA INCASE(965)/'LPS2'/
      DATA (INAME(965,J),J=1,MAXSCL)/
     1'LOWE','    ','SD  ','PRED','INTE','    ','    ','    '/
      DATA INFLAV(965)/1/
      DATA INLONG(965)/'LOWER SD PREDICTION LIMITS'/
C
      DATA INCASE(966)/'LPS2'/
      DATA (INAME(966,J),J=1,MAXSCL)/
     1'LOWE','    ','STAN','DEVI','PRED','LIMI','    ','    '/
      DATA INFLAV(966)/1/
      DATA INLONG(966)/'LOWER SD PREDICTION LIMITS'/
C
      DATA INCASE(967)/'LPS2'/
      DATA (INAME(967,J),J=1,MAXSCL)/
     1'LOWE','    ','STAN','DEVI','PRED','INTE','    ','    '/
      DATA INFLAV(967)/1/
      DATA INLONG(967)/'LOWER SD PREDICTION LIMITS'/
C
      DATA INCASE(968)/'LCS2'/
      DATA (INAME(968,J),J=1,MAXSCL)/
     1'LOWE','    ','STAN','DEVI','CONF','INTE','    ','    '/
      DATA INFLAV(968)/1/
      DATA INLONG(968)/'LOWER SD CONFIDENCE LIMITS'/
C
      DATA INCASE(969)/'SUZ1'/
      DATA (INAME(969,J),J=1,MAXSCL)/
     1'SUMM','    ','ONE ','SIDE','UPPE','SD  ','CONF','LIMI'/
      DATA INFLAV(969)/2/
      DATA INLONG(969)/'SUMMARY ONE SIDED UPPER SD CONFIDENCE LIMITS'/
C
      DATA INCASE(970)/'SUZ1'/
      DATA (INAME(970,J),J=1,MAXSCL)/
     1'SUMM','    ','ONE ','SIDE','UPPE','SD  ','CONF','INTE'/
      DATA INFLAV(970)/2/
      DATA INLONG(970)/'SUMMARY ONE SIDED UPPER SD CONFIDENCE LIMITS'/
C
      DATA INCASE(971)/'SLZ1'/
      DATA (INAME(971,J),J=1,MAXSCL)/
     1'SUMM','    ','ONE ','SIDE','LOWE','SD  ','CONF','LIMI'/
      DATA INFLAV(971)/2/
      DATA INLONG(971)/'SUMMARY ONE SIDED LOWER SD CONFIDENCE LIMITS'/
C
      DATA INCASE(972)/'SLZ1'/
      DATA (INAME(972,J),J=1,MAXSCL)/
     1'SUMM','    ','ONE ','SIDE','LOWE','SD  ','CONF','INTE'/
      DATA INFLAV(972)/2/
      DATA INLONG(972)/'SUMMARY ONE SIDED LOWER SD CONFIDENCE LIMITS'/
C
      DATA INCASE(973)/'SUZ2'/
      DATA (INAME(973,J),J=1,MAXSCL)/
     1'SUMM','    ','UPPE','SD  ','CONF','LIMI','    ','    '/
      DATA INFLAV(973)/2/
      DATA INLONG(973)/'SUMMARY UPPER SD CONFIDENCE LIMITS'/
C
      DATA INCASE(974)/'SUZ2'/
      DATA (INAME(974,J),J=1,MAXSCL)/
     1'SUMM','    ','UPPE','SD  ','CONF','INTE','    ','    '/
      DATA INFLAV(974)/2/
      DATA INLONG(974)/'SUMMARY UPPER SD CONFIDENCE LIMITS'/
C
      DATA INCASE(975)/'SUZ2'/
      DATA (INAME(975,J),J=1,MAXSCL)/
     1'SUMM','    ','UPPE','STAN','DEVI','CONF','LIMI','    '/
      DATA INFLAV(975)/2/
      DATA INLONG(975)/'SUMMARY UPPER SD CONFIDENCE LIMITS'/
C
      DATA INCASE(976)/'SUZ2'/
      DATA (INAME(976,J),J=1,MAXSCL)/
     1'SUMM','    ','UPPE','STAN','DEVI','CONF','INTE','    '/
      DATA INFLAV(976)/2/
      DATA INLONG(976)/'SUMMARY UPPER SD CONFIDENCE LIMITS'/
C
      DATA INCASE(977)/'SLZ2'/
      DATA (INAME(977,J),J=1,MAXSCL)/
     1'SUMM','    ','LOWE','SD  ','CONF','LIMI','    ','    '/
      DATA INFLAV(977)/2/
      DATA INLONG(977)/'SUMMARY LOWER SD CONFIDENCE LIMITS'/
C
      DATA INCASE(977)/'SLZ2'/
      DATA (INAME(977,J),J=1,MAXSCL)/
     1'SUMM','    ','LOWE','SD  ','CONF','INTE','    ','    '/
      DATA INFLAV(977)/2/
      DATA INLONG(977)/'SUMMARY LOWER SD CONFIDENCE LIMITS'/
C
      DATA INCASE(978)/'SLZ2'/
      DATA (INAME(978,J),J=1,MAXSCL)/
     1'SUMM','    ','LOWE','STAN','DEVI','CONF','LIMI','    '/
      DATA INFLAV(978)/2/
      DATA INLONG(978)/'SUMMARY LOWER SD CONFIDENCE LIMITS'/
C
      DATA INCASE(979)/'SLZ2'/
      DATA (INAME(979,J),J=1,MAXSCL)/
     1'SUMM','    ','LOWE','STAN','DEVI','CONF','INTE','    '/
      DATA INFLAV(979)/2/
      DATA INLONG(979)/'SUMMARY LOWER SD CONFIDENCE LIMITS'/
C
      DATA INCASE(980)/'UCS1'/
      DATA (INAME(980,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','UPPE','SD  ','CONF','LIMI','    '/
      DATA INFLAV(980)/1/
      DATA INLONG(980)/'ONE SIDED UPPER SD CONFIDENCE LIMITS'/
C
      DATA INCASE(981)/'UCS1'/
      DATA (INAME(981,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','UPPE','SD  ','CONF','INTE','    '/
      DATA INFLAV(981)/1/
      DATA INLONG(981)/'ONE SIDED UPPER SD CONFIDENCE LIMITS'/
C
      DATA INCASE(982)/'UCS1'/
      DATA (INAME(982,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','UPPE','STAN','DEVI','CONF','LIMI'/
      DATA INFLAV(982)/1/
      DATA INLONG(982)/'ONE SIDED UPPER SD CONFIDENCE LIMITS'/
C
      DATA INCASE(983)/'UCS1'/
      DATA (INAME(983,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','UPPE','STAN','DEVI','CONF','INTE'/
      DATA INFLAV(983)/1/
      DATA INLONG(983)/'ONE SIDED UPPER SD CONFIDENCE LIMITS'/
C
      DATA INCASE(984)/'LCS1'/
      DATA (INAME(984,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','LOWE','SD  ','CONF','LIMI','    '/
      DATA INFLAV(984)/1/
      DATA INLONG(984)/'ONE SIDED LOWER SD CONFIDENCE LIMITS'/
C
      DATA INCASE(985)/'LCS1'/
      DATA (INAME(985,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','LOWE','SD  ','CONF','INTE','    '/
      DATA INFLAV(985)/1/
      DATA INLONG(985)/'ONE SIDED LOWER SD CONFIDENCE LIMITS'/
C
      DATA INCASE(986)/'LCS1'/
      DATA (INAME(986,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','LOWE','STAN','DEVI','CONF','LIMI'/
      DATA INFLAV(986)/1/
      DATA INLONG(986)/'ONE SIDED LOWER SD CONFIDENCE LIMITS'/
C
      DATA INCASE(987)/'LCS1'/
      DATA (INAME(987,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','LOWE','STAN','DEVI','CONF','INTE'/
      DATA INFLAV(987)/1/
      DATA INLONG(987)/'ONE SIDED LOWER SD CONFIDENCE LIMITS'/
C
      DATA INCASE(988)/'UCS2'/
      DATA (INAME(988,J),J=1,MAXSCL)/
     1'UPPE','    ','SD  ','CONF','LIMI','    ','    ','    '/
      DATA INFLAV(988)/1/
      DATA INLONG(988)/'UPPER SD CONFIDENCE LIMITS'/
C
      DATA INCASE(989)/'UCS2'/
      DATA (INAME(989,J),J=1,MAXSCL)/
     1'UPPE','    ','SD  ','CONF','INTE','    ','    ','    '/
      DATA INFLAV(989)/1/
      DATA INLONG(989)/'UPPER SD CONFIDENCE LIMITS'/
C
      DATA INCASE(990)/'UCS2'/
      DATA (INAME(990,J),J=1,MAXSCL)/
     1'UPPE','    ','STAN','DEVI','CONF','LIMI','    ','    '/
      DATA INFLAV(990)/1/
      DATA INLONG(990)/'UPPER SD CONFIDENCE LIMITS'/
C
      DATA INCASE(991)/'UCS2'/
      DATA (INAME(991,J),J=1,MAXSCL)/
     1'UPPE','    ','STAN','DEVI','CONF','INTE','    ','    '/
      DATA INFLAV(991)/1/
      DATA INLONG(991)/'UPPER SD CONFIDENCE LIMITS'/
C
      DATA INCASE(992)/'LCS2'/
      DATA (INAME(992,J),J=1,MAXSCL)/
     1'LOWE','    ','SD  ','CONF','LIMI','    ','    ','    '/
      DATA INFLAV(992)/1/
      DATA INLONG(992)/'LOWER SD CONFIDENCE LIMITS'/
C
      DATA INCASE(993)/'LCS2'/
      DATA (INAME(993,J),J=1,MAXSCL)/
     1'LOWE','    ','SD  ','CONF','INTE','    ','    ','    '/
      DATA INFLAV(993)/1/
      DATA INLONG(993)/'LOWER SD CONFIDENCE LIMITS'/
C
      DATA INCASE(994)/'LCS2'/
      DATA (INAME(994,J),J=1,MAXSCL)/
     1'LOWE','    ','STAN','DEVI','CONF','LIMI','    ','    '/
      DATA INFLAV(994)/1/
      DATA INLONG(994)/'LOWER SD CONFIDENCE LIMITS'/
C
      DATA INCASE(995)/'SD  '/
      DATA (INAME(995,J),J=1,MAXSCL)/
     1'STAN','    ','DEVI','    ','    ','    ','    ','    '/
      DATA INFLAV(995)/1/
      DATA INLONG(995)/'STANDARD DEVIATION'/
C
      DATA INCASE(996)/'SD  '/
      DATA (INAME(996,J),J=1,MAXSCL)/
     1'SD  ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(996)/1/
      DATA INLONG(996)/'STANDARD DEVIATION'/
C
      DATA INCASE(997)/'SLCL'/
      DATA (INAME(997,J),J=1,MAXSCL)/
     1'SUMM','    ','LOWE','CONF','LIMI','    ','    ','    '/
      DATA INFLAV(997)/3/
      DATA INLONG(997)/'SUMMARY LOWER CONFIDENCE LIMIT'/
C
      DATA INCASE(998)/'SLCL'/
      DATA (INAME(998,J),J=1,MAXSCL)/
     1'SUMM','    ','LOWE','CONF','INTE','    ','    ','    '/
      DATA INFLAV(998)/3/
      DATA INLONG(998)/'SUMMARY LOWER CONFIDENCE LIMIT'/
C
      DATA INCASE(999)/'SUCL'/
      DATA (INAME(999,J),J=1,MAXSCL)/
     1'SUMM','    ','UPPE','CONF','LIMI','    ','    ','    '/
      DATA INFLAV(999)/3/
      DATA INLONG(999)/'SUMMARY UPPER CONFIDENCE LIMIT'/
C
      DATA INCASE(1000)/'SUCL'/
      DATA (INAME(1000,J),J=1,MAXSCL)/
     1'SUMM','    ','UPPE','CONF','INTE','    ','    ','    '/
      DATA INFLAV(1000)/3/
      DATA INLONG(1000)/'SUMMARY UPPER CONFIDENCE LIMIT'/
C
      DATA INCASE(1001)/'SLC1'/
      DATA (INAME(1001,J),J=1,MAXSCL)/
     1'SUMM','    ','ONE ','SIDE','LOWE','CONF','LIMI','    '/
      DATA INFLAV(1001)/3/
      DATA INLONG(1001)/'SUMMARY ONE SIDED LOWER CONFIDENCE LIMIT'/
C
      DATA INCASE(1002)/'SLC1'/
      DATA (INAME(1002,J),J=1,MAXSCL)/
     1'SUMM','    ','ONE ','SIDE','LOWE','CONF','INTE','    '/
      DATA INFLAV(1002)/3/
      DATA INLONG(1002)/'SUMMARY ONE SIDED LOWER CONFIDENCE LIMIT'/
C
      DATA INCASE(1003)/'SUC1'/
      DATA (INAME(1003,J),J=1,MAXSCL)/
     1'SUMM','    ','ONE ','SIDE','UPPE','CONF','LIMI','    '/
      DATA INFLAV(1003)/3/
      DATA INLONG(1003)/'SUMMARY ONE SIDED UPPER CONFIDENCE LIMIT'/
C
      DATA INCASE(1004)/'SUC1'/
      DATA (INAME(1004,J),J=1,MAXSCL)/
     1'SUMM','    ','ONE ','SIDE','UPPE','CONF','INTE','    '/
      DATA INFLAV(1004)/3/
      DATA INLONG(1004)/'SUMMARY ONE SIDED UPPER CONFIDENCE LIMIT'/
C
      DATA INCASE(1005)/'MWPV'/
      DATA (INAME(1005,J),J=1,MAXSCL)/
     1'MCCO','    ','WEIB','LOCA','TEST','PVAL','    ','    '/
      DATA INFLAV(1005)/2/
      DATA INLONG(1005)/'MCCOOL WEIBULL LOCATION TEST PVALUE'/
C
      DATA INCASE(1006)/'MWLC'/
      DATA (INAME(1006,J),J=1,MAXSCL)/
     1'MCCO','    ','WEIB','LOCA','TEST','CDF ','    ','    '/
      DATA INFLAV(1006)/2/
      DATA INLONG(1006)/'MCCOOL WEIBULL LOCATION TEST CDF'/
C
      DATA INCASE(1007)/'MW50'/
      DATA (INAME(1007,J),J=1,MAXSCL)/
     1'MCCO','    ','WEIB','LOCA','TEST','CV50','    ','    '/
      DATA INFLAV(1007)/2/
      DATA INLONG(1007)/'MCCOOL WEIBULL LOCATION TEST CV50'/
C
      DATA INCASE(1008)/'MW90'/
      DATA (INAME(1008,J),J=1,MAXSCL)/
     1'MCCO','    ','WEIB','LOCA','TEST','CV90','    ','    '/
      DATA INFLAV(1008)/2/
      DATA INLONG(1008)/'MCCOOL WEIBULL LOCATION TEST CV90'/
C
      DATA INCASE(1009)/'MW95'/
      DATA (INAME(1009,J),J=1,MAXSCL)/
     1'MCCO','    ','WEIB','LOCA','TEST','CV95','    ','    '/
      DATA INFLAV(1009)/2/
      DATA INLONG(1009)/'MCCOOL WEIBULL LOCATION TEST CV95'/
C
      DATA INCASE(1010)/'MWLT'/
      DATA (INAME(1010,J),J=1,MAXSCL)/
     1'MCCO','    ','WEIB','LOCA','TEST','    ','    ','    '/
      DATA INFLAV(1010)/2/
      DATA INLONG(1010)/'MCCOOL WEIBULL LOCATION TEST'/
C
      DATA INCASE(1011)/'CSD '/
      DATA (INAME(1011,J),J=1,MAXSCL)/
     1'CONS','    ','SD  ','    ','    ','    ','    ','    '/
      DATA INFLAV(1011)/1/
      DATA INLONG(1011)/'CONSTANT INTERCEPT SD'/
C
      DATA INCASE(1012)/'CSD '/
      DATA (INAME(1012,J),J=1,MAXSCL)/
     1'CONS','    ','STAN','DEVI','    ','    ','    ','    '/
      DATA INFLAV(1012)/1/
      DATA INLONG(1012)/'CONSTANT INTERCEPT SD'/
C
      DATA INCASE(1013)/'CINT'/
      DATA (INAME(1013,J),J=1,MAXSCL)/
     1'CONS','    ','INTE','    ','    ','    ','    ','    '/
      DATA INFLAV(1013)/1/
      DATA INLONG(1013)/'CONSTANT INTERCEPT'/
C
      DATA INCASE(1014)/'PDCD'/
      DATA (INAME(1014,J),J=1,MAXSCL)/
     1'POIS','    ','DISP','TEST','CDF ','    ','    ','    '/
      DATA INFLAV(1014)/1/
      DATA INLONG(1014)/'POISSON DISPERSION TEST CDF'/
C
      DATA INCASE(1015)/'PDPV'/
      DATA (INAME(1015,J),J=1,MAXSCL)/
     1'POIS','    ','DISP','TEST','PVAL','    ','    ','    '/
      DATA INFLAV(1015)/1/
      DATA INLONG(1015)/'POISSON DISPERSION TEST PVALUE'/
C
      DATA INCASE(1016)/'PDTE'/
      DATA (INAME(1016,J),J=1,MAXSCL)/
     1'POIS','    ','DISP','TEST','    ','    ','    ','    '/
      DATA INFLAV(1016)/1/
      DATA INLONG(1016)/'POISSON DISPERSION TEST'/
C
      DATA INCASE(1017)/'GPDC'/
      DATA (INAME(1017,J),J=1,MAXSCL)/
     1'GROU','    ','POIS','DISP','TEST','CDF ','    ','    '/
      DATA INFLAV(1017)/2/
      DATA INLONG(1017)/'POISSON DISPERSION TEST CDF'/
C
      DATA INCASE(1018)/'GPDP'/
      DATA (INAME(1018,J),J=1,MAXSCL)/
     1'GROU','    ','POIS','DISP','TEST','PVAL','    ','    '/
      DATA INFLAV(1018)/2/
      DATA INLONG(1018)/'POISSON DISPERSION TEST PVALUE'/
C
      DATA INCASE(1019)/'GPDT'/
      DATA (INAME(1019,J),J=1,MAXSCL)/
     1'GROU','    ','POIS','DISP','TEST','    ','    ','    '/
      DATA INFLAV(1019)/2/
      DATA INLONG(1019)/'POISSON DISPERSION TEST'/
C
      DATA INCASE(1020)/'BCVM'/
      DATA (INAME(1020,J),J=1,MAXSCL)/
     1'BIVA','    ','CRAM','VON ','MISE','TEST','    ','    '/
      DATA INFLAV(1020)/2/
      DATA INLONG(1020)/'BIVARIATE CRAMER VON MISES TEST'/
C
      DATA INCASE(1021)/'BC95'/
      DATA (INAME(1021,J),J=1,MAXSCL)/
     1'BIVA','    ','CRAM','VON ','MISE','95  ','CRIT','VALU'/
      DATA INFLAV(1021)/2/
      DATA INLONG(1021)/'BIVARIATE CRAMER VON MISES 95 CRITICAL VALUE'/
C
      DATA INCASE(1022)/'BC05'/
      DATA (INAME(1022,J),J=1,MAXSCL)/
     1'BIVA','    ','CRAM','VON ','MISE','05  ','CRIT','VALU'/
      DATA INFLAV(1022)/2/
      DATA INLONG(1022)/'BIVARIATE CRAMER VON MISES 05 CRITICAL VALUE'/
C
      DATA INCASE(1023)/'MNND'/
      DATA (INAME(1023,J),J=1,MAXSCL)/
     1'MEAN','    ','NEAR','NEIG','DIST','TEST','    ','    '/
      DATA INFLAV(1023)/2/
      DATA INLONG(1023)/'MEAN NEAREST NEIGHBOR DISTANCE TEST'/
C
      DATA INCASE(1024)/'MEAN'/
      DATA (INAME(1024,J),J=1,MAXSCL)/
     1'MEAN','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(1024)/1/
      DATA INLONG(1024)/'MEAN'/
C
      DATA INCASE(1025)/'PO1P'/
      DATA (INAME(1025,J),J=1,MAXSCL)/
     1'POLL','    ','ONE ','TEST','PVAL','    ','    ','    '/
      DATA INFLAV(1025)/2/
      DATA INLONG(1025)/'POLLARD ONE TEST PVALUE'/
C
      DATA INCASE(1026)/'PO1P'/
      DATA (INAME(1026,J),J=1,MAXSCL)/
     1'POLL','    ','ONE ','PVAL','    ','    ','    ','    '/
      DATA INFLAV(1026)/2/
      DATA INLONG(1026)/'POLLARD ONE TEST PVALUE'/
C
      DATA INCASE(1027)/'PO1C'/
      DATA (INAME(1027,J),J=1,MAXSCL)/
     1'POLL','    ','ONE ','TEST','CDF ','    ','    ','    '/
      DATA INFLAV(1027)/2/
      DATA INLONG(1027)/'POLLARD ONE TEST CDF'/
C
      DATA INCASE(1028)/'PO1C'/
      DATA (INAME(1028,J),J=1,MAXSCL)/
     1'POLL','    ','ONE ','CDF ','    ','    ','    ','    '/
      DATA INFLAV(1028)/2/
      DATA INLONG(1028)/'POLLARD ONE TEST CDF'/
C
      DATA INCASE(1029)/'POL1'/
      DATA (INAME(1029,J),J=1,MAXSCL)/
     1'POLL','    ','ONE ','TEST','    ','    ','    ','    '/
      DATA INFLAV(1029)/2/
      DATA INLONG(1029)/'POLLARD ONE STATISTIC'/
C
      DATA INCASE(1030)/'POL1'/
      DATA (INAME(1030,J),J=1,MAXSCL)/
     1'POLL','    ','ONE ','STAT','    ','    ','    ','    '/
      DATA INFLAV(1030)/2/
      DATA INLONG(1030)/'POLLARD ONE STATISTIC'/
C
      DATA INCASE(1031)/'POL1'/
      DATA (INAME(1031,J),J=1,MAXSCL)/
     1'POLL','    ','ONE ','    ','    ','    ','    ','    '/
      DATA INFLAV(1031)/2/
      DATA INLONG(1031)/'POLLARD ONE STATISTIC'/
C
      DATA INCASE(1032)/'PO1P'/
      DATA (INAME(1032,J),J=1,MAXSCL)/
     1'POLL','    ','1   ','TEST','PVAL','    ','    ','    '/
      DATA INFLAV(1032)/2/
      DATA INLONG(1032)/'POLLARD ONE TEST PVALUE'/
C
      DATA INCASE(1033)/'PO1P'/
      DATA (INAME(1033,J),J=1,MAXSCL)/
     1'POLL','    ','1   ','PVAL','    ','    ','    ','    '/
      DATA INFLAV(1033)/2/
      DATA INLONG(1033)/'POLLARD ONE TEST PVALUE'/
C
      DATA INCASE(1034)/'PO1C'/
      DATA (INAME(1034,J),J=1,MAXSCL)/
     1'POLL','    ','1   ','TEST','CDF ','    ','    ','    '/
      DATA INFLAV(1034)/2/
      DATA INLONG(1034)/'POLLARD ONE TEST CDF'/
C
      DATA INCASE(1035)/'PO1C'/
      DATA (INAME(1035,J),J=1,MAXSCL)/
     1'POLL','    ','1   ','CDF ','    ','    ','    ','    '/
      DATA INFLAV(1035)/2/
      DATA INLONG(1035)/'POLLARD ONE TEST CDF'/
C
      DATA INCASE(1036)/'POL1'/
      DATA (INAME(1036,J),J=1,MAXSCL)/
     1'POLL','    ','1   ','TEST','    ','    ','    ','    '/
      DATA INFLAV(1036)/2/
      DATA INLONG(1036)/'POLLARD ONE STATISTIC'/
C
      DATA INCASE(1037)/'POL1'/
      DATA (INAME(1037,J),J=1,MAXSCL)/
     1'POLL','    ','1   ','STAT','    ','    ','    ','    '/
      DATA INFLAV(1037)/2/
      DATA INLONG(1037)/'POLLARD ONE STATISTIC'/
C
      DATA INCASE(1038)/'POL1'/
      DATA (INAME(1038,J),J=1,MAXSCL)/
     1'POLL','    ','1   ','    ','    ','    ','    ','    '/
      DATA INFLAV(1038)/2/
      DATA INLONG(1038)/'POLLARD ONE STATISTIC'/
C
      DATA INCASE(1039)/'PO2P'/
      DATA (INAME(1039,J),J=1,MAXSCL)/
     1'POLL','    ','TWO ','TEST','PVAL','    ','    ','    '/
      DATA INFLAV(1039)/2/
      DATA INLONG(1039)/'POLLARD TWO TEST PVALUE'/
C
      DATA INCASE(1040)/'PO2P'/
      DATA (INAME(1040,J),J=1,MAXSCL)/
     1'POLL','    ','TWO ','PVAL','    ','    ','    ','    '/
      DATA INFLAV(1040)/2/
      DATA INLONG(1040)/'POLLARD TWO TEST PVALUE'/
C
      DATA INCASE(1041)/'PO2C'/
      DATA (INAME(1041,J),J=1,MAXSCL)/
     1'POLL','    ','TWO ','TEST','CDF ','    ','    ','    '/
      DATA INFLAV(1041)/2/
      DATA INLONG(1041)/'POLLARD TWO TEST CDF'/
C
      DATA INCASE(1042)/'PO2C'/
      DATA (INAME(1042,J),J=1,MAXSCL)/
     1'POLL','    ','TWO ','CDF ','    ','    ','    ','    '/
      DATA INFLAV(1042)/2/
      DATA INLONG(1042)/'POLLARD TWO TEST CDF'/
C
      DATA INCASE(1043)/'POL2'/
      DATA (INAME(1043,J),J=1,MAXSCL)/
     1'POLL','    ','TWO ','TEST','    ','    ','    ','    '/
      DATA INFLAV(1043)/2/
      DATA INLONG(1043)/'POLLARD TWO STATISTIC'/
C
      DATA INCASE(1044)/'POL2'/
      DATA (INAME(1044,J),J=1,MAXSCL)/
     1'POLL','    ','TWO ','STAT','    ','    ','    ','    '/
      DATA INFLAV(1044)/2/
      DATA INLONG(1044)/'POLLARD TWO STATISTIC'/
C
      DATA INCASE(1045)/'POL2'/
      DATA (INAME(1045,J),J=1,MAXSCL)/
     1'POLL','    ','TWO ','    ','    ','    ','    ','    '/
      DATA INFLAV(1045)/2/
      DATA INLONG(1045)/'POLLARD TWO STATISTIC'/
C
      DATA INCASE(1046)/'PO2P'/
      DATA (INAME(1046,J),J=1,MAXSCL)/
     1'POLL','    ','2   ','TEST','PVAL','    ','    ','    '/
      DATA INFLAV(1046)/2/
      DATA INLONG(1046)/'POLLARD TWO TEST PVALUE'/
C
      DATA INCASE(1047)/'PO2P'/
      DATA (INAME(1047,J),J=1,MAXSCL)/
     1'POLL','    ','2   ','PVAL','    ','    ','    ','    '/
      DATA INFLAV(1047)/2/
      DATA INLONG(1047)/'POLLARD TWO TEST PVALUE'/
C
      DATA INCASE(1048)/'PO2C'/
      DATA (INAME(1048,J),J=1,MAXSCL)/
     1'POLL','    ','2   ','TEST','CDF ','    ','    ','    '/
      DATA INFLAV(1048)/2/
      DATA INLONG(1048)/'POLLARD TWO TEST CDF'/
C
      DATA INCASE(1049)/'PO2C'/
      DATA (INAME(1049,J),J=1,MAXSCL)/
     1'POLL','    ','2   ','CDF ','    ','    ','    ','    '/
      DATA INFLAV(1049)/2/
      DATA INLONG(1049)/'POLLARD TWO TEST CDF'/
C
      DATA INCASE(1050)/'POL2'/
      DATA (INAME(1050,J),J=1,MAXSCL)/
     1'POLL','    ','2   ','TEST','    ','    ','    ','    '/
      DATA INFLAV(1050)/2/
      DATA INLONG(1050)/'POLLARD TWO STATISTIC'/
C
      DATA INCASE(1051)/'POL2'/
      DATA (INAME(1051,J),J=1,MAXSCL)/
     1'POLL','    ','2   ','STAT','    ','    ','    ','    '/
      DATA INFLAV(1051)/2/
      DATA INLONG(1051)/'POLLARD TWO STATISTIC'/
C
      DATA INCASE(1052)/'POL2'/
      DATA (INAME(1052,J),J=1,MAXSCL)/
     1'POLL','    ','2   ','    ','    ','    ','    ','    '/
      DATA INFLAV(1052)/2/
      DATA INLONG(1052)/'POLLARD TWO STATISTIC'/
C
      DATA INCASE(1053)/'PO3P'/
      DATA (INAME(1053,J),J=1,MAXSCL)/
     1'POLL','    ','THRE','TEST','PVAL','    ','    ','    '/
      DATA INFLAV(1053)/2/
      DATA INLONG(1053)/'POLLARD THREE TEST PVALUE'/
C
      DATA INCASE(1054)/'PO3P'/
      DATA (INAME(1054,J),J=1,MAXSCL)/
     1'POLL','    ','THRE','PVAL','    ','    ','    ','    '/
      DATA INFLAV(1054)/2/
      DATA INLONG(1054)/'POLLARD THREE TEST PVALUE'/
C
      DATA INCASE(1055)/'PO3C'/
      DATA (INAME(1055,J),J=1,MAXSCL)/
     1'POLL','    ','THRE','TEST','CDF ','    ','    ','    '/
      DATA INFLAV(1055)/2/
      DATA INLONG(1055)/'POLLARD THREE TEST CDF'/
C
      DATA INCASE(1056)/'PO3C'/
      DATA (INAME(1056,J),J=1,MAXSCL)/
     1'POLL','    ','THRE','CDF ','    ','    ','    ','    '/
      DATA INFLAV(1056)/2/
      DATA INLONG(1056)/'POLLARD THREE TEST CDF'/
C
      DATA INCASE(1057)/'POL3'/
      DATA (INAME(1057,J),J=1,MAXSCL)/
     1'POLL','    ','THRE','TEST','    ','    ','    ','    '/
      DATA INFLAV(1057)/2/
      DATA INLONG(1057)/'POLLARD THREE STATISTIC'/
C
      DATA INCASE(1058)/'POL3'/
      DATA (INAME(1058,J),J=1,MAXSCL)/
     1'POLL','    ','THRE','STAT','    ','    ','    ','    '/
      DATA INFLAV(1058)/2/
      DATA INLONG(1058)/'POLLARD THREE STATISTIC'/
C
      DATA INCASE(1059)/'POL3'/
      DATA (INAME(1059,J),J=1,MAXSCL)/
     1'POLL','    ','THRE','    ','    ','    ','    ','    '/
      DATA INFLAV(1059)/2/
      DATA INLONG(1059)/'POLLARD THREE STATISTIC'/
C
      DATA INCASE(1060)/'PO3P'/
      DATA (INAME(1060,J),J=1,MAXSCL)/
     1'POLL','    ','3   ','TEST','PVAL','    ','    ','    '/
      DATA INFLAV(1060)/2/
      DATA INLONG(1060)/'POLLARD THREE TEST PVALUE'/
C
      DATA INCASE(1061)/'PO3P'/
      DATA (INAME(1061,J),J=1,MAXSCL)/
     1'POLL','    ','3   ','PVAL','    ','    ','    ','    '/
      DATA INFLAV(1061)/2/
      DATA INLONG(1061)/'POLLARD THREE TEST PVALUE'/
C
      DATA INCASE(1062)/'PO3C'/
      DATA (INAME(1062,J),J=1,MAXSCL)/
     1'POLL','    ','3   ','TEST','CDF ','    ','    ','    '/
      DATA INFLAV(1062)/2/
      DATA INLONG(1062)/'POLLARD THREE TEST CDF'/
C
      DATA INCASE(1063)/'PO3C'/
      DATA (INAME(1063,J),J=1,MAXSCL)/
     1'POLL','    ','3   ','CDF ','    ','    ','    ','    '/
      DATA INFLAV(1063)/2/
      DATA INLONG(1063)/'POLLARD THREE TEST CDF'/
C
      DATA INCASE(1064)/'POL3'/
      DATA (INAME(1064,J),J=1,MAXSCL)/
     1'POLL','    ','3   ','TEST','    ','    ','    ','    '/
      DATA INFLAV(1064)/2/
      DATA INLONG(1064)/'POLLARD THREE STATISTIC'/
C
      DATA INCASE(1065)/'POL3'/
      DATA (INAME(1065,J),J=1,MAXSCL)/
     1'POLL','    ','3   ','STAT','    ','    ','    ','    '/
      DATA INFLAV(1065)/2/
      DATA INLONG(1065)/'POLLARD THREE STATISTIC'/
C
      DATA INCASE(1066)/'POL3'/
      DATA (INAME(1066,J),J=1,MAXSCL)/
     1'POLL','    ','3   ','    ','    ','    ','    ','    '/
      DATA INFLAV(1066)/2/
      DATA INLONG(1066)/'POLLARD THREE STATISTIC'/
C
      DATA INCASE(1067)/'PO4P'/
      DATA (INAME(1067,J),J=1,MAXSCL)/
     1'POLL','    ','FOUR','TEST','PVAL','    ','    ','    '/
      DATA INFLAV(1067)/2/
      DATA INLONG(1067)/'POLLARD FOUR TEST PVALUE'/
C
      DATA INCASE(1068)/'PO4P'/
      DATA (INAME(1068,J),J=1,MAXSCL)/
     1'POLL','    ','FOUR','PVAL','    ','    ','    ','    '/
      DATA INFLAV(1068)/2/
      DATA INLONG(1068)/'POLLARD FOUR TEST PVALUE'/
C
      DATA INCASE(1069)/'PO4C'/
      DATA (INAME(1069,J),J=1,MAXSCL)/
     1'POLL','    ','FOUR','TEST','CDF ','    ','    ','    '/
      DATA INFLAV(1069)/2/
      DATA INLONG(1069)/'POLLARD FOUR TEST CDF'/
C
      DATA INCASE(1070)/'PO4C'/
      DATA (INAME(1070,J),J=1,MAXSCL)/
     1'POLL','    ','FOUR','CDF ','    ','    ','    ','    '/
      DATA INFLAV(1070)/2/
      DATA INLONG(1070)/'POLLARD FOUR TEST CDF'/
C
      DATA INCASE(1071)/'POL4'/
      DATA (INAME(1071,J),J=1,MAXSCL)/
     1'POLL','    ','FOUR','TEST','    ','    ','    ','    '/
      DATA INFLAV(1071)/2/
      DATA INLONG(1071)/'POLLARD FOUR STATISTIC'/
C
      DATA INCASE(1072)/'POL4'/
      DATA (INAME(1072,J),J=1,MAXSCL)/
     1'POLL','    ','FOUR','STAT','    ','    ','    ','    '/
      DATA INFLAV(1072)/2/
      DATA INLONG(1072)/'POLLARD FOUR STATISTIC'/
C
      DATA INCASE(1073)/'POL4'/
      DATA (INAME(1073,J),J=1,MAXSCL)/
     1'POLL','    ','FOUR','    ','    ','    ','    ','    '/
      DATA INFLAV(1073)/2/
      DATA INLONG(1073)/'POLLARD FOUR STATISTIC'/
C
      DATA INCASE(1074)/'PO4P'/
      DATA (INAME(1074,J),J=1,MAXSCL)/
     1'POLL','    ','4   ','TEST','PVAL','    ','    ','    '/
      DATA INFLAV(1074)/2/
      DATA INLONG(1074)/'POLLARD FOUR TEST PVALUE'/
C
      DATA INCASE(1075)/'PO4P'/
      DATA (INAME(1075,J),J=1,MAXSCL)/
     1'POLL','    ','4   ','PVAL','    ','    ','    ','    '/
      DATA INFLAV(1075)/2/
      DATA INLONG(1075)/'POLLARD FOUR TEST PVALUE'/
C
      DATA INCASE(1076)/'PO4C'/
      DATA (INAME(1076,J),J=1,MAXSCL)/
     1'POLL','    ','4   ','TEST','CDF ','    ','    ','    '/
      DATA INFLAV(1076)/2/
      DATA INLONG(1076)/'POLLARD FOUR TEST CDF'/
C
      DATA INCASE(1077)/'PO4C'/
      DATA (INAME(1077,J),J=1,MAXSCL)/
     1'POLL','    ','4   ','CDF ','    ','    ','    ','    '/
      DATA INFLAV(1077)/2/
      DATA INLONG(1077)/'POLLARD FOUR TEST CDF'/
C
      DATA INCASE(1078)/'POL4'/
      DATA (INAME(1078,J),J=1,MAXSCL)/
     1'POLL','    ','4   ','TEST','    ','    ','    ','    '/
      DATA INFLAV(1078)/2/
      DATA INLONG(1078)/'POLLARD FOUR STATISTIC'/
C
      DATA INCASE(1079)/'POL4'/
      DATA (INAME(1079,J),J=1,MAXSCL)/
     1'POLL','    ','4   ','STAT','    ','    ','    ','    '/
      DATA INFLAV(1079)/2/
      DATA INLONG(1079)/'POLLARD FOUR STATISTIC'/
C
      DATA INCASE(1080)/'POL4'/
      DATA (INAME(1080,J),J=1,MAXSCL)/
     1'POLL','    ','4   ','    ','    ','    ','    ','    '/
      DATA INFLAV(1080)/2/
      DATA INLONG(1080)/'POLLARD FOUR STATISTIC'/
C
      DATA INCASE(1081)/'PO5P'/
      DATA (INAME(1081,J),J=1,MAXSCL)/
     1'POLL','    ','FIVE','TEST','PVAL','    ','    ','    '/
      DATA INFLAV(1081)/2/
      DATA INLONG(1081)/'POLLARD FIVE TEST PVALUE'/
C
      DATA INCASE(1082)/'PO5P'/
      DATA (INAME(1082,J),J=1,MAXSCL)/
     1'POLL','    ','FIVE','PVAL','    ','    ','    ','    '/
      DATA INFLAV(1082)/2/
      DATA INLONG(1082)/'POLLARD FIVE TEST PVALUE'/
C
      DATA INCASE(1083)/'PO5C'/
      DATA (INAME(1083,J),J=1,MAXSCL)/
     1'POLL','    ','FIVE','TEST','CDF ','    ','    ','    '/
      DATA INFLAV(1083)/2/
      DATA INLONG(1083)/'POLLARD FIVE TEST CDF'/
C
      DATA INCASE(1084)/'PO5C'/
      DATA (INAME(1084,J),J=1,MAXSCL)/
     1'POLL','    ','FIVE','CDF ','    ','    ','    ','    '/
      DATA INFLAV(1084)/2/
      DATA INLONG(1084)/'POLLARD FIVE TEST CDF'/
C
      DATA INCASE(1085)/'POL5'/
      DATA (INAME(1085,J),J=1,MAXSCL)/
     1'POLL','    ','FIVE','TEST','    ','    ','    ','    '/
      DATA INFLAV(1085)/2/
      DATA INLONG(1085)/'POLLARD FIVE STATISTIC'/
C
      DATA INCASE(1086)/'POL5'/
      DATA (INAME(1086,J),J=1,MAXSCL)/
     1'POLL','    ','6IVE','STAT','    ','    ','    ','    '/
      DATA INFLAV(1086)/2/
      DATA INLONG(1086)/'POLLARD FIVE STATISTIC'/
C
      DATA INCASE(1087)/'POL5'/
      DATA (INAME(1087,J),J=1,MAXSCL)/
     1'POLL','    ','FIVE','    ','    ','    ','    ','    '/
      DATA INFLAV(1087)/2/
      DATA INLONG(1087)/'POLLARD FIVE STATISTIC'/
C
      DATA INCASE(1088)/'PO5P'/
      DATA (INAME(1088,J),J=1,MAXSCL)/
     1'POLL','    ','5   ','TEST','PVAL','    ','    ','    '/
      DATA INFLAV(1088)/2/
      DATA INLONG(1088)/'POLLARD FIVE TEST PVALUE'/
C
      DATA INCASE(1089)/'PO5P'/
      DATA (INAME(1089,J),J=1,MAXSCL)/
     1'POLL','    ','5   ','PVAL','    ','    ','    ','    '/
      DATA INFLAV(1089)/2/
      DATA INLONG(1089)/'POLLARD FIVE TEST PVALUE'/
C
      DATA INCASE(1090)/'PO5C'/
      DATA (INAME(1090,J),J=1,MAXSCL)/
     1'POLL','    ','5   ','TEST','CDF ','    ','    ','    '/
      DATA INFLAV(1090)/2/
      DATA INLONG(1090)/'POLLARD FIVE TEST CDF'/
C
      DATA INCASE(1091)/'PO5C'/
      DATA (INAME(1091,J),J=1,MAXSCL)/
     1'POLL','    ','5   ','CDF ','    ','    ','    ','    '/
      DATA INFLAV(1091)/2/
      DATA INLONG(1091)/'POLLARD FIVE TEST CDF'/
C
      DATA INCASE(1092)/'POL5'/
      DATA (INAME(1092,J),J=1,MAXSCL)/
     1'POLL','    ','5   ','TEST','    ','    ','    ','    '/
      DATA INFLAV(1092)/2/
      DATA INLONG(1092)/'POLLARD FIVE STATISTIC'/
C
      DATA INCASE(1093)/'POL5'/
      DATA (INAME(1093,J),J=1,MAXSCL)/
     1'POLL','    ','5   ','STAT','    ','    ','    ','    '/
      DATA INFLAV(1093)/2/
      DATA INLONG(1093)/'POLLARD FIVE STATISTIC'/
C
      DATA INCASE(1094)/'POL5'/
      DATA (INAME(1094,J),J=1,MAXSCL)/
     1'POLL','    ','5   ','    ','    ','    ','    ','    '/
      DATA INFLAV(1094)/2/
      DATA INLONG(1094)/'POLLARD FIVE STATISTIC'/
C
      DATA INCASE(1095)/'VALC'/
      DATA (INAME(1095,J),J=1,MAXSCL)/
     1'VALU','    ','COUN','    ','    ','    ','    ','    '/
      DATA INFLAV(1095)/1/
      DATA INLONG(1095)/'VALUE COUNT'/
C
      DATA INCASE(1096)/'VARI'/
      DATA (INAME(1096,J),J=1,MAXSCL)/
     1'VARI','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(1096)/1/
      DATA INLONG(1096)/'VARIANCE'/
C
      DATA INCASE(1097)/'RDI '/
      DATA (INAME(1097,J),J=1,MAXSCL)/
     1'RELA','    ','DISP','INDE','    ','    ','    ','    '/
      DATA INFLAV(1097)/1/
      DATA INLONG(1097)/'RELATIVE DISPERSION INDEX'/
C
      DATA INCASE(1098)/'UCHS'/
      DATA (INAME(1098,J),J=1,MAXSCL)/
     1'UNIF','    ','CHI ','SQUA','    ','    ','    ','    '/
      DATA INFLAV(1098)/1/
      DATA INLONG(1098)/'UNIFORM CHI-SQUARE'/
C
      DATA INCASE(1099)/'UCHS'/
      DATA (INAME(1099,J),J=1,MAXSCL)/
     1'UNIF','    ','CHIS','    ','    ','    ','    ','    '/
      DATA INFLAV(1099)/1/
      DATA INLONG(1099)/'UNIFORM CHI-SQUARE'/
C
      DATA INCASE(1100)/'UCHS'/
      DATA (INAME(1100,J),J=1,MAXSCL)/
     1'UNIF','    ','CHI-','    ','    ','    ','    ','    '/
      DATA INFLAV(1100)/1/
      DATA INLONG(1100)/'UNIFORM CHI-SQUARE'/
C
      DATA INCASE(1101)/'DRAT'/
      DATA (INAME(1101,J),J=1,MAXSCL)/
     1'DECI','    ','RATI','    ','    ','    ','    ','    '/
      DATA INFLAV(1101)/1/
      DATA INLONG(1101)/'INTER DECILE RATIO'/
C
      DATA INCASE(1102)/'DRAT'/
      DATA (INAME(1102,J),J=1,MAXSCL)/
     1'INTE','RDEC','RATI','    ','    ','    ','    ','    '/
      DATA INFLAV(1102)/1/
      DATA INLONG(1102)/'DECILE RATIO'/
C
      DATA INCASE(1103)/'DRAT'/
      DATA (INAME(1103,J),J=1,MAXSCL)/
     1'INTE','    ','DECI','RATI','    ','    ','    ','    '/
      DATA INFLAV(1103)/1/
      DATA INLONG(1103)/'DECILE RATIO'/
C
      DATA INCASE(1104)/'GDRA'/
      DATA (INAME(1104,J),J=1,MAXSCL)/
     1'GROU','    ','DECI','RATI','    ','    ','    ','    '/
      DATA INFLAV(1104)/2/
      DATA INLONG(1104)/'DECILE RATIO (GROUPED DATA)'/
C
      DATA INCASE(1105)/'GDRA'/
      DATA (INAME(1105,J),J=1,MAXSCL)/
     1'GROU','    ','INTE','DECI','RATI','    ','    ','    '/
      DATA INFLAV(1105)/2/
      DATA INLONG(1105)/'DECILE RATIO (GROUPED DATA)'/
C
      DATA INCASE(1106)/'GDRA'/
      DATA (INAME(1106,J),J=1,MAXSCL)/
     1'GROU','    ','INTE','RATI','    ','    ','    ','    '/
      DATA INFLAV(1106)/2/
      DATA INLONG(1106)/'DECILE RATIO (GROUPED DATA)'/
C
      DATA INCASE(1107)/'GQUA'/
      DATA (INAME(1107,J),J=1,MAXSCL)/
     1'GROU','    ','QUAN','    ','    ','    ','    ','    '/
      DATA INFLAV(1107)/2/
      DATA INLONG(1107)/'QUANTILE (GROUPED DATA)'/
C
      DATA INCASE(1108)/'GPER'/
      DATA (INAME(1108,J),J=1,MAXSCL)/
     1'GROU','    ','PERC','    ','    ','    ','    ','    '/
      DATA INFLAV(1108)/2/
      DATA INLONG(1108)/'PERCENTILE (GROUPED DATA)'/
C
      DATA INCASE(1109)/'WSCD'/
      DATA (INAME(1109,J),J=1,MAXSCL)/
     1'COMM','    ','WEIB','SHAP','TEST','CDF ','    ','    '/
      DATA INFLAV(1109)/2/
      DATA INLONG(1109)/'COMMON WEIBULL SHAPE TEST CDF'/
C
      DATA INCASE(1110)/'WSHP'/
      DATA (INAME(1110,J),J=1,MAXSCL)/
     1'COMM','    ','WEIB','SHAP','TEST','PVAL','    ','    '/
      DATA INFLAV(1110)/2/
      DATA INLONG(1110)/'COMMON WEIBULL SHAPE TEST PVALUE'/
C
      DATA INCASE(1111)/'WS90'/
      DATA (INAME(1111,J),J=1,MAXSCL)/
     1'COMM','    ','WEIB','SHAP','TEST','CV90','    ','    '/
      DATA INFLAV(1111)/2/
      DATA INLONG(1111)/'COMMON WEIBULL SHAPE TEST CV90'/
C
      DATA INCASE(1112)/'WS95'/
      DATA (INAME(1112,J),J=1,MAXSCL)/
     1'COMM','    ','WEIB','SHAP','TEST','CV95','    ','    '/
      DATA INFLAV(1112)/2/
      DATA INLONG(1112)/'COMMON WEIBULL SHAPE TEST CV95'/
C
      DATA INCASE(1113)/'WS99'/
      DATA (INAME(1113,J),J=1,MAXSCL)/
     1'COMM','    ','WEIB','SHAP','TEST','CV99','    ','    '/
      DATA INFLAV(1113)/2/
      DATA INLONG(1113)/'COMMON WEIBULL SHAPE TEST CV99'/
C
      DATA INCASE(1114)/'WSHT'/
      DATA (INAME(1114,J),J=1,MAXSCL)/
     1'COMM','    ','WEIB','SHAP','TEST','    ','    ','    '/
      DATA INFLAV(1114)/2/
      DATA INLONG(1114)/'COMMON WEIBULL SHAPE TEST'/
C
      DATA INCASE(1115)/'WESK'/
      DATA (INAME(1115,J),J=1,MAXSCL)/
     1'WEIG','    ','SKEW','    ','    ','    ','    ','    '/
      DATA INFLAV(1115)/2/
      DATA INLONG(1115)/'WEIGHTED SKEWNESS'/
C
      DATA INCASE(1116)/'KARC'/
      DATA (INAME(1116,J),J=1,MAXSCL)/
     1'KAPP','    ','R   ','CUTO','    ','    ','    ','    '/
      DATA INFLAV(1116)/1/
      DATA INLONG(1116)/'KAPPENMMAN R CUTOFF'/
C
      DATA INCASE(1117)/'KAPR'/
      DATA (INAME(1117,J),J=1,MAXSCL)/
     1'KAPP','    ','R   ','    ','    ','    ','    ','    '/
      DATA INFLAV(1117)/1/
      DATA INLONG(1117)/'KAPPENMMAN R'/
C
      DATA INCASE(1118)/'BCPP'/
      DATA (INAME(1118,J),J=1,MAXSCL)/
     1'BOX ','    ','COX ','NORM','PPCC','    ','    ','    '/
      DATA INFLAV(1118)/1/
      DATA INLONG(1118)/'BOX-COX NORMALITY PPCC'/
C
      DATA INCASE(1119)/'BCLA'/
      DATA (INAME(1119,J),J=1,MAXSCL)/
     1'BOX ','    ','COX ','NORM','LAMB','    ','    ','    '/
      DATA INFLAV(1119)/1/
      DATA INLONG(1119)/'BOX-COX NORMALITY LAMBDA'/
C
      DATA INCASE(1120)/'MEAN'/
      DATA (INAME(1120,J),J=1,MAXSCL)/
     1'AVER','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(1120)/1/
      DATA INLONG(1120)/'MEAN'/
C
      DATA INCASE(1121)/'DMEA'/
      DATA (INAME(1121,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','AVER','    ','    ','    ','    '/
      DATA INFLAV(1121)/2/
      DATA INLONG(1121)/'DIFFERENCE OF MEANS'/
C
      DATA INCASE(1122)/'GSKE'/
      DATA (INAME(1122,J),J=1,MAXSCL)/
     1'GALT','    ','SKEW','    ','    ','    ','    ','    '/
      DATA INFLAV(1122)/1/
      DATA INLONG(1122)/'GALTON SKEWNESS'/
C
      DATA INCASE(1123)/'PSK2'/
      DATA (INAME(1123,J),J=1,MAXSCL)/
     1'PEAR','    ','TWO ','SKEW','    ','    ','    ','    '/
      DATA INFLAV(1123)/1/
      DATA INLONG(1123)/'PEARSON TWO SKEWNESS'/
C
      DATA INCASE(1124)/'PSK2'/
      DATA (INAME(1124,J),J=1,MAXSCL)/
     1'PEAR','    ','2   ','SKEW','    ','    ','    ','    '/
      DATA INFLAV(1124)/1/
      DATA INLONG(1124)/'PEARSON TWO SKEWNESS'/
C
      DATA INCASE(1125)/'PSK2'/
      DATA (INAME(1125,J),J=1,MAXSCL)/
     1'PEAR','    ','TYPE','TWO ','SKEW','    ','    ','    '/
      DATA INFLAV(1125)/1/
      DATA INLONG(1125)/'PEARSON TWO SKEWNESS'/
C
      DATA INCASE(1126)/'PSK2'/
      DATA (INAME(1126,J),J=1,MAXSCL)/
     1'PEAR','    ','TYPE','2   ','SKEW','    ','    ','    '/
      DATA INFLAV(1126)/1/
      DATA INLONG(1126)/'PEARSON TWO SKEWNESS'/
C
      DATA INCASE(1127)/'EKUR'/
      DATA (INAME(1127,J),J=1,MAXSCL)/
     1'EXCE','    ','KURT','    ','    ','    ','    ','    '/
      DATA INFLAV(1127)/1/
      DATA INLONG(1127)/'EXCESS KURTOSIS'/
C
      DATA INCASE(1128)/'NADL'/
      DATA (INAME(1128,J),J=1,MAXSCL)/
     1'NORM','    ','AD  ','LOCA','    ','    ','    ','    '/
      DATA INFLAV(1128)/1/
      DATA INLONG(1128)/'NORMAL ANDERSON DARLING LOCATION'/
C
      DATA INCASE(1129)/'NADL'/
      DATA (INAME(1129,J),J=1,MAXSCL)/
     1'NORM','    ','ANDE','DARL','LOCA','    ','    ','    '/
      DATA INFLAV(1129)/1/
      DATA INLONG(1129)/'NORMAL ANDERSON DARLING LOCATION'/
C
      DATA INCASE(1130)/'NADS'/
      DATA (INAME(1130,J),J=1,MAXSCL)/
     1'NORM','    ','AD  ','SCAL','    ','    ','    ','    '/
      DATA INFLAV(1130)/1/
      DATA INLONG(1130)/'NORMAL ANDERSON DARLING SCALE'/
C
      DATA INCASE(1131)/'NADS'/
      DATA (INAME(1131,J),J=1,MAXSCL)/
     1'NORM','    ','ANDE','DARL','SCAL','    ','    ','    '/
      DATA INFLAV(1131)/1/
      DATA INLONG(1131)/'NORMAL ANDERSON DARLING SCALE'/
C
      DATA INCASE(1132)/'NOAD'/
      DATA (INAME(1132,J),J=1,MAXSCL)/
     1'NORM','    ','AD  ','    ','    ','    ','    ','    '/
      DATA INFLAV(1132)/1/
      DATA INLONG(1132)/'NORMAL ANDERSON DARLING STATISTIC'/
C
      DATA INCASE(1133)/'NOAD'/
      DATA (INAME(1133,J),J=1,MAXSCL)/
     1'NORM','    ','ANDE','DARL','    ','    ','    ','    '/
      DATA INFLAV(1133)/1/
      DATA INLONG(1133)/'NORMAL ANDERSON DARLING STATISTIC'/
C
      DATA INCASE(1134)/'EADL'/
      DATA (INAME(1134,J),J=1,MAXSCL)/
     1'EXPO','    ','AD  ','LOCA','    ','    ','    ','    '/
      DATA INFLAV(1134)/1/
      DATA INLONG(1134)/'EXPONENTIAL ANDERSON DARLING LOCATION'/
C
      DATA INCASE(1135)/'EADL'/
      DATA (INAME(1135,J),J=1,MAXSCL)/
     1'EXPO','    ','ANDE','DARL','LOCA','    ','    ','    '/
      DATA INFLAV(1135)/1/
      DATA INLONG(1135)/'EXPONENTIAL ANDERSON DARLING LOCATION'/
C
      DATA INCASE(1136)/'EADS'/
      DATA (INAME(1136,J),J=1,MAXSCL)/
     1'EXPO','    ','AD  ','SCAL','    ','    ','    ','    '/
      DATA INFLAV(1136)/1/
      DATA INLONG(1136)/'EXPONENTIAL ANDERSON DARLING SCALE'/
C
      DATA INCASE(1137)/'EADS'/
      DATA (INAME(1137,J),J=1,MAXSCL)/
     1'EXPO','    ','ANDE','DARL','SCAL','    ','    ','    '/
      DATA INFLAV(1137)/1/
      DATA INLONG(1137)/'EXPONENTIAL ANDERSON DARLING SCALE'/
C
      DATA INCASE(1138)/'EXAD'/
      DATA (INAME(1138,J),J=1,MAXSCL)/
     1'EXPO','    ','AD  ','    ','    ','    ','    ','    '/
      DATA INFLAV(1138)/1/
      DATA INLONG(1138)/'EXPONENTIAL ANDERSON DARLING STATISTIC'/
C
      DATA INCASE(1139)/'EXAD'/
      DATA (INAME(1139,J),J=1,MAXSCL)/
     1'EXPO','    ','ANDE','DARL','    ','    ','    ','    '/
      DATA INFLAV(1139)/1/
      DATA INLONG(1139)/'EXPONENTIAL ANDERSON DARLING STATISTIC'/
C
      DATA INCASE(1140)/'DXAL'/
      DATA (INAME(1140,J),J=1,MAXSCL)/
     1'DOUB','    ','EXPO','AD  ','LOCA','    ','    ','    '/
      DATA INFLAV(1140)/1/
      DATA INLONG(1140)/'DOUBLE EXPONENTIAL ANDERSON DARLING LOCATION'/
C
      DATA INCASE(1141)/'DXAL'/
      DATA (INAME(1141,J),J=1,MAXSCL)/
     1'DOUB','    ','EXPO','ANDE','DARL','LOCA','    ','    '/
      DATA INFLAV(1141)/1/
      DATA INLONG(1141)/'DOUBLE EXPONENTIAL ANDERSON DARLING LOCATION'/
C
      DATA INCASE(1142)/'DXAS'/
      DATA (INAME(1142,J),J=1,MAXSCL)/
     1'DOUB','    ','EXPO','AD  ','SCAL','    ','    ','    '/
      DATA INFLAV(1142)/1/
      DATA INLONG(1142)/'DOUBLE EXPONENTIAL ANDERSON DARLING SCALE'/
C
      DATA INCASE(1143)/'DXAS'/
      DATA (INAME(1143,J),J=1,MAXSCL)/
     1'DOUB','    ','EXPO','ANDE','DARL','SCAL','    ','    '/
      DATA INFLAV(1143)/1/
      DATA INLONG(1143)/'DOUBLE EXPONENTIAL ANDERSON DARLING SCALE'/
C
      DATA INCASE(1144)/'DXAD'/
      DATA (INAME(1144,J),J=1,MAXSCL)/
     1'DOUB','    ','EXPO','AD  ','    ','    ','    ','    '/
      DATA INFLAV(1144)/1/
      DATA INLONG(1144)/'DOUBLE EXPONENTIAL ANDERSON DARLING'/
C
      DATA INCASE(1145)/'DXAD'/
      DATA (INAME(1145,J),J=1,MAXSCL)/
     1'DOUB','    ','EXPO','ANDE','DARL','    ','    ','    '/
      DATA INFLAV(1145)/1/
      DATA INLONG(1145)/'DOUBLE EXPONENTIAL ANDERSON DARLING'/
C
      DATA INCASE(1146)/'DXAL'/
      DATA (INAME(1146,J),J=1,MAXSCL)/
     1'LAPL','    ','AD  ','LOCA','    ','    ','    ','    '/
      DATA INFLAV(1146)/1/
      DATA INLONG(1146)/'DOUBLE EXPONENTIAL ANDERSON DARLING LOCATION'/
C
      DATA INCASE(1147)/'DXAL'/
      DATA (INAME(1147,J),J=1,MAXSCL)/
     1'LAPL','    ','ANDE','DARL','LOCA','    ','    ','    '/
      DATA INFLAV(1147)/1/
      DATA INLONG(1147)/'DOUBLE EXPONENTIAL ANDERSON DARLING LOCATION'/
C
      DATA INCASE(1148)/'DXAS'/
      DATA (INAME(1148,J),J=1,MAXSCL)/
     1'LAPL','    ','AD  ','SCAL','    ','    ','    ','    '/
      DATA INFLAV(1148)/1/
      DATA INLONG(1148)/'DOUBLE EXPONENTIAL ANDERSON DARLING SCALE'/
C
      DATA INCASE(1149)/'DXAS'/
      DATA (INAME(1149,J),J=1,MAXSCL)/
     1'LAPL','    ','ANDE','DARL','SCAL','    ','    ','    '/
      DATA INFLAV(1149)/1/
      DATA INLONG(1149)/'DOUBLE EXPONENTIAL ANDERSON DARLING SCALE'/
C
      DATA INCASE(1150)/'DXAD'/
      DATA (INAME(1150,J),J=1,MAXSCL)/
     1'LAPL','    ','AD  ','    ','    ','    ','    ','    '/
      DATA INFLAV(1150)/1/
      DATA INLONG(1150)/'DOUBLE EXPONENTIAL ANDERSON DARLING'/
C
      DATA INCASE(1151)/'DXAD'/
      DATA (INAME(1151,J),J=1,MAXSCL)/
     1'LAPL','    ','ANDE','DARL','    ','    ','    ','    '/
      DATA INFLAV(1151)/1/
      DATA INLONG(1151)/'DOUBLE EXPONENTIAL ANDERSON DARLING'/
C
      DATA INCASE(1152)/'GUAL'/
      DATA (INAME(1152,J),J=1,MAXSCL)/
     1'GUMB','    ','AD  ','LOCA','    ','    ','    ','    '/
      DATA INFLAV(1152)/1/
      DATA INLONG(1152)/'GUMBEL ANDERSON DARLING LOCATION'/
C
      DATA INCASE(1153)/'GUAL'/
      DATA (INAME(1153,J),J=1,MAXSCL)/
     1'GUMB','    ','ANDE','DARL','LOCA','    ','    ','    '/
      DATA INFLAV(1153)/1/
      DATA INLONG(1153)/'GUMBEL ANDERSON DARLING LOCATION'/
C
      DATA INCASE(1154)/'GUAS'/
      DATA (INAME(1154,J),J=1,MAXSCL)/
     1'GUMB','    ','AD  ','SCAL','    ','    ','    ','    '/
      DATA INFLAV(1154)/1/
      DATA INLONG(1154)/'GUMBEL ANDERSON DARLING SCALE'/
C
      DATA INCASE(1155)/'GUAS'/
      DATA (INAME(1155,J),J=1,MAXSCL)/
     1'GUMB','    ','ANDE','DARL','SCAL','    ','    ','    '/
      DATA INFLAV(1155)/1/
      DATA INLONG(1155)/'GUMBEL ANDERSON DARLING SCALE'/
C
      DATA INCASE(1156)/'GUAD'/
      DATA (INAME(1156,J),J=1,MAXSCL)/
     1'GUMB','    ','AD  ','    ','    ','    ','    ','    '/
      DATA INFLAV(1156)/1/
      DATA INLONG(1156)/'GUMBEL ANDERSON DARLING'/
C
      DATA INCASE(1157)/'GUAD'/
      DATA (INAME(1157,J),J=1,MAXSCL)/
     1'GUMB','    ','ANDE','DARL','    ','    ','    ','    '/
      DATA INFLAV(1157)/1/
      DATA INLONG(1157)/'GUMBEL ANDERSON DARLING'/
C
      DATA INCASE(1158)/'GAAZ'/
      DATA (INAME(1158,J),J=1,MAXSCL)/
     1'GAMM','    ','AD  ','SHAP','    ','    ','    ','    '/
      DATA INFLAV(1158)/1/
      DATA INLONG(1158)/'GAMMA ANDERSON DARLING SHAPE'/
C
      DATA INCASE(1159)/'GAAZ'/
      DATA (INAME(1159,J),J=1,MAXSCL)/
     1'GAMM','    ','ANDE','DARL','SHAP','    ','    ','    '/
      DATA INFLAV(1159)/1/
      DATA INLONG(1159)/'GAMMA ANDERSON DARLING SHAPE'/
C
      DATA INCASE(1160)/'GAAS'/
      DATA (INAME(1160,J),J=1,MAXSCL)/
     1'GAMM','    ','AD  ','SCAL','    ','    ','    ','    '/
      DATA INFLAV(1160)/1/
      DATA INLONG(1160)/'GAMMA ANDERSON DARLING SCALE'/
C
      DATA INCASE(1161)/'GAAS'/
      DATA (INAME(1161,J),J=1,MAXSCL)/
     1'GAMM','    ','ANDE','DARL','SCAL','    ','    ','    '/
      DATA INFLAV(1161)/1/
      DATA INLONG(1161)/'GAMMA ANDERSON DARLING SCALE'/
C
      DATA INCASE(1162)/'GAAD'/
      DATA (INAME(1162,J),J=1,MAXSCL)/
     1'GAMM','    ','AD  ','STAT','    ','    ','    ','    '/
      DATA INFLAV(1162)/1/
      DATA INLONG(1162)/'GAMMA ANDERSON DARLING'/
C
      DATA INCASE(1163)/'GAAD'/
      DATA (INAME(1163,J),J=1,MAXSCL)/
     1'GAMM','    ','ANDE','DARL','STAT','    ','    ','    '/
      DATA INFLAV(1163)/1/
      DATA INLONG(1163)/'GAMMA ANDERSON DARLING'/
C
      DATA INCASE(1164)/'WEAZ'/
      DATA (INAME(1164,J),J=1,MAXSCL)/
     1'WEIB','    ','AD  ','SHAP','    ','    ','    ','    '/
      DATA INFLAV(1164)/1/
      DATA INLONG(1164)/'WEIBULL ANDERSON DARLING SHAPE'/
C
      DATA INCASE(1165)/'WEAZ'/
      DATA (INAME(1165,J),J=1,MAXSCL)/
     1'WEIB','    ','ANDE','DARL','SHAP','    ','    ','    '/
      DATA INFLAV(1165)/1/
      DATA INLONG(1165)/'WEIBULL ANDERSON DARLING SHAPE'/
C
      DATA INCASE(1166)/'WEAS'/
      DATA (INAME(1166,J),J=1,MAXSCL)/
     1'WEIB','    ','AD  ','SCAL','    ','    ','    ','    '/
      DATA INFLAV(1166)/1/
      DATA INLONG(1166)/'WEIBULL ANDERSON DARLING SCALE'/
C
      DATA INCASE(1167)/'WEAS'/
      DATA (INAME(1167,J),J=1,MAXSCL)/
     1'WEIB','    ','ANDE','DARL','SCAL','    ','    ','    '/
      DATA INFLAV(1167)/1/
      DATA INLONG(1167)/'WEIBULL ANDERSON DARLING SCALE'/
C
      DATA INCASE(1168)/'WEAD'/
      DATA (INAME(1168,J),J=1,MAXSCL)/
     1'WEIB','    ','AD  ','STAT','    ','    ','    ','    '/
      DATA INFLAV(1168)/1/
      DATA INLONG(1168)/'WEIBULL ANDERSON DARLING'/
C
      DATA INCASE(1169)/'WEAD'/
      DATA (INAME(1169,J),J=1,MAXSCL)/
     1'WEIB','    ','ANDE','DARL','STAT','    ','    ','    '/
      DATA INFLAV(1169)/1/
      DATA INLONG(1169)/'WEIBULL ANDERSON DARLING'/
C
      DATA INCASE(1170)/'LNAZ'/
      DATA (INAME(1170,J),J=1,MAXSCL)/
     1'LOGN','    ','AD  ','SHAP','    ','    ','    ','    '/
      DATA INFLAV(1170)/1/
      DATA INLONG(1170)/'LOGNORMAL ANDERSON DARLING SHAPE'/
C
      DATA INCASE(1171)/'LNAZ'/
      DATA (INAME(1171,J),J=1,MAXSCL)/
     1'LOGN','    ','ANDE','DARL','SHAP','    ','    ','    '/
      DATA INFLAV(1171)/1/
      DATA INLONG(1171)/'LOGNORMAL ANDERSON DARLING SHAPE'/
C
      DATA INCASE(1172)/'LNAS'/
      DATA (INAME(1172,J),J=1,MAXSCL)/
     1'LOGN','    ','AD  ','SCAL','    ','    ','    ','    '/
      DATA INFLAV(1172)/1/
      DATA INLONG(1172)/'LOGNORMAL ANDERSON DARLING SCALE'/
C
      DATA INCASE(1173)/'LNAS'/
      DATA (INAME(1173,J),J=1,MAXSCL)/
     1'LOGN','    ','ANDE','DARL','SCAL','    ','    ','    '/
      DATA INFLAV(1173)/1/
      DATA INLONG(1173)/'LOGNORMAL ANDERSON DARLING SCALE'/
C
      DATA INCASE(1174)/'LNAD'/
      DATA (INAME(1174,J),J=1,MAXSCL)/
     1'LOGN','    ','AD  ','STAT','    ','    ','    ','    '/
      DATA INFLAV(1174)/1/
      DATA INLONG(1174)/'LOGNORMAL ANDERSON DARLING'/
C
      DATA INCASE(1175)/'LNAD'/
      DATA (INAME(1175,J),J=1,MAXSCL)/
     1'LOGN','    ','ANDE','DARL','STAT','    ','    ','    '/
      DATA INFLAV(1175)/1/
      DATA INLONG(1175)/'LOGNORMAL ANDERSON DARLING'/
C
      DATA INCASE(1176)/'LOAL'/
      DATA (INAME(1176,J),J=1,MAXSCL)/
     1'LOGI','    ','AD  ','LOCA','    ','    ','    ','    '/
      DATA INFLAV(1176)/1/
      DATA INLONG(1176)/'LOGISTIC ANDERSON DARLING LOCATION'/
C
      DATA INCASE(1177)/'LOAL'/
      DATA (INAME(1177,J),J=1,MAXSCL)/
     1'LOGI','    ','ANDE','DARL','LOCA','    ','    ','    '/
      DATA INFLAV(1177)/1/
      DATA INLONG(1177)/'LOGISTIC ANDERSON DARLING LOCATION'/
C
      DATA INCASE(1178)/'LOAS'/
      DATA (INAME(1178,J),J=1,MAXSCL)/
     1'LOGI','    ','AD  ','SCAL','    ','    ','    ','    '/
      DATA INFLAV(1178)/1/
      DATA INLONG(1178)/'LOGISTIC ANDERSON DARLING SCALE'/
C
      DATA INCASE(1179)/'LOAS'/
      DATA (INAME(1179,J),J=1,MAXSCL)/
     1'LOGI','    ','ANDE','DARL','SCAL','    ','    ','    '/
      DATA INFLAV(1179)/1/
      DATA INLONG(1179)/'LOGISTIC ANDERSON DARLING SCALE'/
C
      DATA INCASE(1180)/'LOAD'/
      DATA (INAME(1180,J),J=1,MAXSCL)/
     1'LOGI','    ','AD  ','    ','    ','    ','    ','    '/
      DATA INFLAV(1180)/1/
      DATA INLONG(1180)/'LOGISTIC ANDERSON DARLING'/
C
      DATA INCASE(1181)/'LOAD'/
      DATA (INAME(1181,J),J=1,MAXSCL)/
     1'LOGI','    ','ANDE','DARL','    ','    ','    ','    '/
      DATA INFLAV(1181)/1/
      DATA INLONG(1181)/'LOGISTIC ANDERSON DARLING'/
C
      DATA INCASE(1182)/'UNAL'/
      DATA (INAME(1182,J),J=1,MAXSCL)/
     1'UNIF','    ','AD  ','LOCA','    ','    ','    ','    '/
      DATA INFLAV(1182)/1/
      DATA INLONG(1182)/'UNIFORM ANDERSON DARLING LOCATION'/
C
      DATA INCASE(1183)/'UNAL'/
      DATA (INAME(1183,J),J=1,MAXSCL)/
     1'UNIF','    ','ANDE','DARL','LOCA','    ','    ','    '/
      DATA INFLAV(1183)/1/
      DATA INLONG(1183)/'UNIFORM ANDERSON DARLING LOCATION'/
C
      DATA INCASE(1184)/'UNAS'/
      DATA (INAME(1184,J),J=1,MAXSCL)/
     1'UNIF','    ','AD  ','SCAL','    ','    ','    ','    '/
      DATA INFLAV(1184)/1/
      DATA INLONG(1184)/'UNIFORM ANDERSON DARLING SCALE'/
C
      DATA INCASE(1185)/'UNAS'/
      DATA (INAME(1185,J),J=1,MAXSCL)/
     1'UNIF','    ','ANDE','DARL','SCAL','    ','    ','    '/
      DATA INFLAV(1185)/1/
      DATA INLONG(1185)/'UNIFORM ANDERSON DARLING SCALE'/
C
      DATA INCASE(1186)/'UNAD'/
      DATA (INAME(1186,J),J=1,MAXSCL)/
     1'UNIF','    ','AD  ','    ','    ','    ','    ','    '/
      DATA INFLAV(1186)/1/
      DATA INLONG(1186)/'UNIFORM ANDERSON DARLING'/
C
      DATA INCASE(1187)/'UNAD'/
      DATA (INAME(1187,J),J=1,MAXSCL)/
     1'UNIF','    ','ANDE','DARL','    ','    ','    ','    '/
      DATA INFLAV(1187)/1/
      DATA INLONG(1187)/'UNIFORM ANDERSON DARLING'/
C
      DATA INCASE(1188)/'MXAL'/
      DATA (INAME(1188,J),J=1,MAXSCL)/
     1'MAXW','    ','AD  ','LOCA','    ','    ','    ','    '/
      DATA INFLAV(1188)/1/
      DATA INLONG(1188)/'MAXWELL ANDERSON DARLING LOCATION'/
C
      DATA INCASE(1189)/'MXAL'/
      DATA (INAME(1189,J),J=1,MAXSCL)/
     1'MAXW','    ','ANDE','DARL','LOCA','    ','    ','    '/
      DATA INFLAV(1189)/1/
      DATA INLONG(1189)/'MAXWELL ANDERSON DARLING LOCATION'/
C
      DATA INCASE(1190)/'MXAS'/
      DATA (INAME(1190,J),J=1,MAXSCL)/
     1'MAXW','    ','AD  ','SCAL','    ','    ','    ','    '/
      DATA INFLAV(1190)/1/
      DATA INLONG(1190)/'MAXWELL ANDERSON DARLING SCALE'/
C
      DATA INCASE(1191)/'MXAS'/
      DATA (INAME(1191,J),J=1,MAXSCL)/
     1'MAXW','    ','ANDE','DARL','SCAL','    ','    ','    '/
      DATA INFLAV(1191)/1/
      DATA INLONG(1191)/'MAXWELL ANDERSON DARLING SCALE'/
C
      DATA INCASE(1192)/'MXAD'/
      DATA (INAME(1192,J),J=1,MAXSCL)/
     1'MAXW','    ','AD  ','    ','    ','    ','    ','    '/
      DATA INFLAV(1192)/1/
      DATA INLONG(1192)/'MAXWELL ANDERSON DARLING'/
C
      DATA INCASE(1193)/'MXAD'/
      DATA (INAME(1193,J),J=1,MAXSCL)/
     1'MAXW','    ','ANDE','DARL','    ','    ','    ','    '/
      DATA INFLAV(1193)/1/
      DATA INLONG(1193)/'MAXWELL ANDERSON DARLING'/
C
      DATA INCASE(1194)/'RAAL'/
      DATA (INAME(1194,J),J=1,MAXSCL)/
     1'RAYL','    ','AD  ','LOCA','    ','    ','    ','    '/
      DATA INFLAV(1194)/1/
      DATA INLONG(1194)/'RAYLEIGH ANDERSON DARLING LOCATION'/
C
      DATA INCASE(1195)/'RAAL'/
      DATA (INAME(1195,J),J=1,MAXSCL)/
     1'RAYL','    ','ANDE','DARL','LOCA','    ','    ','    '/
      DATA INFLAV(1195)/1/
      DATA INLONG(1195)/'RAYLEIGH ANDERSON DARLING LOCATION'/
C
      DATA INCASE(1196)/'RAAS'/
      DATA (INAME(1196,J),J=1,MAXSCL)/
     1'RAYL','    ','AD  ','SCAL','    ','    ','    ','    '/
      DATA INFLAV(1196)/1/
      DATA INLONG(1196)/'RAYLEIGH ANDERSON DARLING SCALE'/
C
      DATA INCASE(1197)/'RAAS'/
      DATA (INAME(1197,J),J=1,MAXSCL)/
     1'RAYL','    ','ANDE','DARL','SCAL','    ','    ','    '/
      DATA INFLAV(1197)/1/
      DATA INLONG(1197)/'RAYLEIGH ANDERSON DARLING SCALE'/
C
      DATA INCASE(1198)/'RAAD'/
      DATA (INAME(1198,J),J=1,MAXSCL)/
     1'RAYL','    ','AD  ','    ','    ','    ','    ','    '/
      DATA INFLAV(1198)/1/
      DATA INLONG(1198)/'RAYLEIGH ANDERSON DARLING'/
C
      DATA INCASE(1199)/'RAAD'/
      DATA (INAME(1199,J),J=1,MAXSCL)/
     1'RAYL','    ','ANDE','DARL','    ','    ','    ','    '/
      DATA INFLAV(1199)/1/
      DATA INLONG(1199)/'RAYLEIGH ANDERSON DARLING'/
C
      DATA INCASE(1200)/'FLAZ'/
      DATA (INAME(1200,J),J=1,MAXSCL)/
     1'FATI','    ','LIFE','AD  ','SHAP','    ','    ','    '/
      DATA INFLAV(1200)/1/
      DATA INLONG(1200)/'FATIGUE LIFE ANDERSON DARLING SHAPE'/
C
      DATA INCASE(1201)/'FLAZ'/
      DATA (INAME(1201,J),J=1,MAXSCL)/
     1'FATI','    ','LIFE','ANDE','DARL','SHAP','    ','    '/
      DATA INFLAV(1201)/1/
      DATA INLONG(1201)/'FATIGUE LIFE ANDERSON DARLING SHAPE'/
C
      DATA INCASE(1202)/'FLAS'/
      DATA (INAME(1202,J),J=1,MAXSCL)/
     1'FATI','    ','LIFE','AD  ','SCAL','    ','    ','    '/
      DATA INFLAV(1202)/1/
      DATA INLONG(1202)/'FATIGUE LIFE ANDERSON DARLING SCALE'/
C
      DATA INCASE(1203)/'FLAS'/
      DATA (INAME(1203,J),J=1,MAXSCL)/
     1'FATI','    ','LIFE','ANDE','DARL','SCAL','    ','    '/
      DATA INFLAV(1203)/1/
      DATA INLONG(1203)/'FATIGUE LIFE ANDERSON DARLING SCALE'/
C
      DATA INCASE(1204)/'FLAD'/
      DATA (INAME(1204,J),J=1,MAXSCL)/
     1'FATI','    ','LIFE','AD  ','STAT','    ','    ','    '/
      DATA INFLAV(1204)/1/
      DATA INLONG(1204)/'FATIGUE LIFE ANDERSON DARLING'/
C
      DATA INCASE(1205)/'FLAD'/
      DATA (INAME(1205,J),J=1,MAXSCL)/
     1'FATI','    ','LIFE','ANDE','DARL','STAT','    ','    '/
      DATA INFLAV(1205)/1/
      DATA INLONG(1205)/'FATIGUE LIFE ANDERSON DARLING'/
C
      DATA INCASE(1206)/'FRAZ'/
      DATA (INAME(1206,J),J=1,MAXSCL)/
     1'FREC','    ','AD  ','SHAP','    ','    ','    ','    '/
      DATA INFLAV(1206)/1/
      DATA INLONG(1206)/'FRECHET ANDERSON DARLING SHAPE'/
C
      DATA INCASE(1207)/'FRAZ'/
      DATA (INAME(1207,J),J=1,MAXSCL)/
     1'FREC','    ','ANDE','DARL','SHAP','    ','    ','    '/
      DATA INFLAV(1207)/1/
      DATA INLONG(1207)/'FRECHET ANDERSON DARLING SHAPE'/
C
      DATA INCASE(1208)/'FRAS'/
      DATA (INAME(1208,J),J=1,MAXSCL)/
     1'FREC','    ','AD  ','SCAL','    ','    ','    ','    '/
      DATA INFLAV(1208)/1/
      DATA INLONG(1208)/'FRECHET ANDERSON DARLING SCALE'/
C
      DATA INCASE(1209)/'FRAS'/
      DATA (INAME(1209,J),J=1,MAXSCL)/
     1'FREC','    ','ANDE','DARL','SCAL','    ','    ','    '/
      DATA INFLAV(1209)/1/
      DATA INLONG(1209)/'FRECHET ANDERSON DARLING SCALE'/
C
      DATA INCASE(1210)/'FRAD'/
      DATA (INAME(1210,J),J=1,MAXSCL)/
     1'FREC','    ','AD  ','STAT','    ','    ','    ','    '/
      DATA INFLAV(1210)/1/
      DATA INLONG(1210)/'FRECHET ANDERSON DARLING'/
C
      DATA INCASE(1211)/'FRAD'/
      DATA (INAME(1211,J),J=1,MAXSCL)/
     1'FREC','    ','ANDE','DARL','STAT','    ','    ','    '/
      DATA INFLAV(1211)/1/
      DATA INLONG(1211)/'FRECHET ANDERSON DARLING'/
C
      DATA INCASE(1212)/'LXAZ'/
      DATA (INAME(1212,J),J=1,MAXSCL)/
     1'LOGI','    ','EXPO','AD  ','SHAP','    ','    ','    '/
      DATA INFLAV(1212)/1/
      DATA INLONG(1212)/'LOGISTIC EXPONENTIAL ANDERSON DARLING SHAPE'/
C
      DATA INCASE(1213)/'LXAZ'/
      DATA (INAME(1213,J),J=1,MAXSCL)/
     1'LOGI','    ','EXPO','ANDE','DARL','SHAP','    ','    '/
      DATA INFLAV(1213)/1/
      DATA INLONG(1213)/'LOGISTIC EXPONENTIAL ANDERSON DARLING SHAPE'/
C
      DATA INCASE(1214)/'LXAS'/
      DATA (INAME(1214,J),J=1,MAXSCL)/
     1'LOGI','    ','EXPO','AD  ','SCAL','    ','    ','    '/
      DATA INFLAV(1214)/1/
      DATA INLONG(1214)/'LOGISTIC EXPONENTIAL ANDERSON DARLING SCALE'/
C
      DATA INCASE(1215)/'LXAS'/
      DATA (INAME(1215,J),J=1,MAXSCL)/
     1'LOGI','    ','EXPO','ANDE','DARL','SCAL','    ','    '/
      DATA INFLAV(1215)/1/
      DATA INLONG(1215)/'LOGISTIC EXPONENTIAL ANDERSON DARLING SCALE'/
C
      DATA INCASE(1216)/'LXAD'/
      DATA (INAME(1216,J),J=1,MAXSCL)/
     1'LOGI','    ','EXPO','AD  ','STAT','    ','    ','    '/
      DATA INFLAV(1216)/1/
      DATA INLONG(1216)/'LOGISTIC EXPONENTIAL ANDERSON DARLING'/
C
      DATA INCASE(1217)/'LXAD'/
      DATA (INAME(1217,J),J=1,MAXSCL)/
     1'LOGI','    ','EXPO','ANDE','DARL','STAT','    ','    '/
      DATA INFLAV(1217)/1/
      DATA INLONG(1217)/'LOGISTIC EXPONENTIAL ANDERSON DARLING'/
C
      DATA INCASE(1218)/'IGAZ'/
      DATA (INAME(1218,J),J=1,MAXSCL)/
     1'INVE','    ','GAMM','AD  ','SHAP','    ','    ','    '/
      DATA INFLAV(1218)/1/
      DATA INLONG(1218)/'INVERTED GAMMA ANDERSON DARLING SHAPE'/
C
      DATA INCASE(1219)/'IGAZ'/
      DATA (INAME(1219,J),J=1,MAXSCL)/
     1'INVE','    ','GAMM','ANDE','DARL','SHAP','    ','    '/
      DATA INFLAV(1219)/1/
      DATA INLONG(1219)/'INVERTED GAMMA ANDERSON DARLING SHAPE'/
C
      DATA INCASE(1220)/'IGAS'/
      DATA (INAME(1220,J),J=1,MAXSCL)/
     1'INVE','    ','GAMM','AD  ','SCAL','    ','    ','    '/
      DATA INFLAV(1220)/1/
      DATA INLONG(1220)/'INVERTED GAMMA ANDERSON DARLING SCALE'/
C
      DATA INCASE(1221)/'IGAS'/
      DATA (INAME(1221,J),J=1,MAXSCL)/
     1'INVE','    ','GAMM','ANDE','DARL','SCAL','    ','    '/
      DATA INFLAV(1221)/1/
      DATA INLONG(1221)/'INVERTED GAMMA ANDERSON DARLING SCALE'/
C
      DATA INCASE(1222)/'IGAD'/
      DATA (INAME(1222,J),J=1,MAXSCL)/
     1'INVE','    ','GAMM','AD  ','STAT','    ','    ','    '/
      DATA INFLAV(1222)/1/
      DATA INLONG(1222)/'INVERTED GAMMA ANDERSON DARLING'/
C
      DATA INCASE(1223)/'IGAD'/
      DATA (INAME(1223,J),J=1,MAXSCL)/
     1'INVE','    ','GAMM','ANDE','DARL','STAT','    ','    '/
      DATA INFLAV(1223)/1/
      DATA INLONG(1223)/'INVERTED GAMMA ANDERSON DARLING'/
C
      DATA INCASE(1224)/'B1AZ'/
      DATA (INAME(1224,J),J=1,MAXSCL)/
     1'BURR','    ','TYPE','10  ','AD  ','SHAP','    ','    '/
      DATA INFLAV(1224)/1/
      DATA INLONG(1224)/'BURR TYPE 10 ANDERSON DARLING SHAPE'/
C
      DATA INCASE(1225)/'B1AZ'/
      DATA (INAME(1225,J),J=1,MAXSCL)/
     1'BURR','    ','TYPE','10  ','ANDE','DARL','SHAP','    '/
      DATA INFLAV(1225)/1/
      DATA INLONG(1225)/'BURR TYPE 10 ANDERSON DARLING SHAPE'/
C
      DATA INCASE(1226)/'B1AS'/
      DATA (INAME(1226,J),J=1,MAXSCL)/
     1'BURR','    ','TYPE','10  ','AD  ','SCAL','    ','    '/
      DATA INFLAV(1226)/1/
      DATA INLONG(1226)/'BURR TYPE 10 ANDERSON DARLING SCALE'/
C
      DATA INCASE(1227)/'B1AS'/
      DATA (INAME(1227,J),J=1,MAXSCL)/
     1'BURR','    ','TYPE','10  ','ANDE','DARL','SCAL','    '/
      DATA INFLAV(1227)/1/
      DATA INLONG(1227)/'BURR TYPE 10 ANDERSON DARLING SCALE'/
C
      DATA INCASE(1228)/'B1AD'/
      DATA (INAME(1228,J),J=1,MAXSCL)/
     1'BURR','    ','TYPE','10  ','AD  ','STAT','    ','    '/
      DATA INFLAV(1228)/1/
      DATA INLONG(1228)/'BURR TYPE 10 ANDERSON DARLING'/
C
      DATA INCASE(1229)/'B1AD'/
      DATA (INAME(1229,J),J=1,MAXSCL)/
     1'BURR','    ','TYPE','10  ','ANDE','DARL','STAT','    '/
      DATA INFLAV(1229)/1/
      DATA INLONG(1229)/'BURR TYPE 10 ANDERSON DARLING'/
C
      DATA INCASE(1230)/'GEAZ'/
      DATA (INAME(1230,J),J=1,MAXSCL)/
     1'GEOM','    ','EXTR','EXPO','AD  ','SHAP','    ','    '/
      DATA INFLAV(1230)/1/
      DATA INLONG(1230)/'GEOMETRIC EXTR EXPO ANDERSON DARLING SHAPE'/
C
      DATA INCASE(1231)/'GEAZ'/
      DATA (INAME(1231,J),J=1,MAXSCL)/
     1'GEOM','    ','EXTR','EXPO','ANDE','DARL','SHAP','    '/
      DATA INFLAV(1231)/1/
      DATA INLONG(1231)/'GEOMETRIC EXTR EXPO ANDERSON DARLING SHAPE'/
C
      DATA INCASE(1232)/'GEAS'/
      DATA (INAME(1232,J),J=1,MAXSCL)/
     1'GEOM','    ','EXTR','EXPO','AD  ','SCAL','    ','    '/
      DATA INFLAV(1232)/1/
      DATA INLONG(1232)/'GEOMETRIC EXTR EXPO ANDERSON DARLING SCALE'/
C
      DATA INCASE(1233)/'GEAS'/
      DATA (INAME(1233,J),J=1,MAXSCL)/
     1'GEOM','    ','EXTR','EXPO','ANDE','DARL','SCAL','    '/
      DATA INFLAV(1233)/1/
      DATA INLONG(1233)/'GEOMETRIC EXTR EXPO ANDERSON DARLING SCALE'/
C
      DATA INCASE(1234)/'GEAD'/
      DATA (INAME(1234,J),J=1,MAXSCL)/
     1'GEOM','    ','EXTR','EXPO','AD  ','STAT','    ','    '/
      DATA INFLAV(1234)/1/
      DATA INLONG(1234)/'GEOMETRIC EXTR EXPO ANDERSON DARLING'/
C
      DATA INCASE(1235)/'GEAD'/
      DATA (INAME(1235,J),J=1,MAXSCL)/
     1'GEOM','    ','EXTR','EXPO','ANDE','DARL','STAT','    '/
      DATA INFLAV(1235)/1/
      DATA INLONG(1235)/'GEOMETRIC EXTR EXPO ANDERSON DARLING'/
C
      DATA INCASE(1236)/'GLOC'/
      DATA (INAME(1236,J),J=1,MAXSCL)/
     1'G   ','    ','PPCC','LOCA','    ','    ','    ','    '/
      DATA INFLAV(1236)/1/
      DATA INLONG(1236)/'G PPCC LOCATION'/
C
      DATA INCASE(1237)/'GSCA'/
      DATA (INAME(1237,J),J=1,MAXSCL)/
     1'G   ','    ','PPCC','SCAL','    ','    ','    ','    '/
      DATA INFLAV(1237)/1/
      DATA INLONG(1237)/'G PPCC SCALE'/
C
      DATA INCASE(1238)/'GSHA'/
      DATA (INAME(1238,J),J=1,MAXSCL)/
     1'G   ','    ','PPCC','SHAP','    ','    ','    ','    '/
      DATA INFLAV(1238)/1/
      DATA INLONG(1238)/'G PPCC SHAPE (G)'/
C
      DATA INCASE(1239)/'GSHA'/
      DATA (INAME(1239,J),J=1,MAXSCL)/
     1'G   ','    ','PPCC','G   ','    ','    ','    ','    '/
      DATA INFLAV(1239)/1/
      DATA INLONG(1239)/'G PPCC SHAPE (G)'/
C
      DATA INCASE(1240)/'GPPC'/
      DATA (INAME(1240,J),J=1,MAXSCL)/
     1'G   ','    ','PPCC','STAT','    ','    ','    ','    '/
      DATA INFLAV(1240)/1/
      DATA INLONG(1240)/'G PPCC'/
C
      DATA INCASE(1241)/'JSCO'/
      DATA (INAME(1241,J),J=1,MAXSCL)/
     1'JSCO','    ','STAT','    ','    ','    ','    ','    '/
      DATA INFLAV(1241)/1/
      DATA INLONG(1241)/'JSCORE'/
C
      DATA INCASE(1242)/'ADCD'/
      DATA (INAME(1242,J),J=1,MAXSCL)/
     1'ADJA','    ','RAND','TEST','CDF ','    ','    ','    '/
      DATA INFLAV(1242)/1/
      DATA INLONG(1242)/'ADJACENCY RANDOMNESS TEST CDF'/
C
      DATA INCASE(1243)/'ADPV'/
      DATA (INAME(1243,J),J=1,MAXSCL)/
     1'ADJA','    ','RAND','TEST','PVAL','    ','    ','    '/
      DATA INFLAV(1243)/1/
      DATA INLONG(1243)/'ADJACENCY RANDOMNESS TEST P-VALUE'/
C
      DATA INCASE(1244)/'AD01'/
      DATA (INAME(1244,J),J=1,MAXSCL)/
     1'ADJA','    ','RAND','TEST','CV01','    ','    ','    '/
      DATA INFLAV(1244)/1/
      DATA INLONG(1244)/'ADJACENCY RANDOMNESS TEST CV01'/
C
      DATA INCASE(1245)/'AD05'/
      DATA (INAME(1245,J),J=1,MAXSCL)/
     1'ADJA','    ','RAND','TEST','CV05','    ','    ','    '/
      DATA INFLAV(1245)/1/
      DATA INLONG(1245)/'ADJACENCY RANDOMNESS TEST CV05'/
C
      DATA INCASE(1246)/'AD95'/
      DATA (INAME(1246,J),J=1,MAXSCL)/
     1'ADJA','    ','RAND','TEST','CV95','    ','    ','    '/
      DATA INFLAV(1246)/1/
      DATA INLONG(1246)/'ADJACENCY RANDOMNESS TEST CV95'/
C
      DATA INCASE(1247)/'AD99'/
      DATA (INAME(1247,J),J=1,MAXSCL)/
     1'ADJA','    ','RAND','TEST','CV99','    ','    ','    '/
      DATA INFLAV(1247)/1/
      DATA INLONG(1247)/'ADJACENCY RANDOMNESS TEST CV99'/
C
      DATA INCASE(1248)/'ADRA'/
      DATA (INAME(1248,J),J=1,MAXSCL)/
     1'ADJA','    ','RAND','TEST','    ','    ','    ','    '/
      DATA INFLAV(1248)/1/
      DATA INLONG(1248)/'ADJACENCY RANDOMNESS TEST'/
C
      DATA INCASE(1249)/'ADCD'/
      DATA (INAME(1249,J),J=1,MAXSCL)/
     1'ADJA','    ','TEST','CDF ','    ','    ','    ','    '/
      DATA INFLAV(1249)/1/
      DATA INLONG(1249)/'ADJACENCY RANDOMNESS TEST CDF'/
C
      DATA INCASE(1250)/'ADPV'/
      DATA (INAME(1250,J),J=1,MAXSCL)/
     1'ADJA','    ','TEST','PVAL','    ','    ','    ','    '/
      DATA INFLAV(1250)/1/
      DATA INLONG(1250)/'ADJACENCY RANDOMNESS TEST P-VALUE'/
C
      DATA INCASE(1251)/'AD01'/
      DATA (INAME(1251,J),J=1,MAXSCL)/
     1'ADJA','    ','TEST','CV01','    ','    ','    ','    '/
      DATA INFLAV(1251)/1/
      DATA INLONG(1251)/'ADJACENCY RANDOMNESS TEST CV01'/
C
      DATA INCASE(1252)/'AD05'/
      DATA (INAME(1252,J),J=1,MAXSCL)/
     1'ADJA','    ','TEST','CV05','    ','    ','    ','    '/
      DATA INFLAV(1252)/1/
      DATA INLONG(1252)/'ADJACENCY RANDOMNESS TEST CV05'/
C
      DATA INCASE(1253)/'AD95'/
      DATA (INAME(1253,J),J=1,MAXSCL)/
     1'ADJA','    ','TEST','CV95','    ','    ','    ','    '/
      DATA INFLAV(1253)/1/
      DATA INLONG(1253)/'ADJACENCY RANDOMNESS TEST CV95'/
C
      DATA INCASE(1254)/'AD99'/
      DATA (INAME(1254,J),J=1,MAXSCL)/
     1'ADJA','    ','TEST','CV99','    ','    ','    ','    '/
      DATA INFLAV(1254)/1/
      DATA INLONG(1254)/'ADJACENCY RANDOMNESS TEST CV99'/
C
      DATA INCASE(1255)/'ADRA'/
      DATA (INAME(1255,J),J=1,MAXSCL)/
     1'ADJA','    ','TEST','    ','    ','    ','    ','    '/
      DATA INFLAV(1255)/1/
      DATA INLONG(1255)/'ADJACENCY RANDOMNESS TEST'/
C
      DATA INCASE(1256)/'NPMK'/
      DATA (INAME(1256,J),J=1,MAXSCL)/
     1'CNPM','K   ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(1256)/1/
      DATA INLONG(1256)/'CNPMK'/
C
      DATA INCASE(1257)/'CNPM'/
      DATA (INAME(1257,J),J=1,MAXSCL)/
     1'CNPM','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(1257)/1/
      DATA INLONG(1257)/'CNPM'/
C
      DATA INCASE(1258)/'CNP '/
      DATA (INAME(1258,J),J=1,MAXSCL)/
     1'CNP ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(1258)/1/
      DATA INLONG(1258)/'CNP'/
C
      DATA INCASE(1259)/'CPMK'/
      DATA (INAME(1259,J),J=1,MAXSCL)/
     1'CPMK','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(1259)/1/
      DATA INLONG(1259)/'CPMK'/
C
      DATA INCASE(1260)/'CV95'/
      DATA (INAME(1260,J),J=1,MAXSCL)/
     1'COCH','    ','VARI','OUTL','CV95','    ','    ','    '/
      DATA INFLAV(1260)/2/
      DATA INLONG(1260)/'COCHRAN VARIANCE OUTLIER CV95'/
C
      DATA INCASE(1261)/'CV99'/
      DATA (INAME(1261,J),J=1,MAXSCL)/
     1'COCH','    ','VARI','OUTL','CV99','    ','    ','    '/
      DATA INFLAV(1261)/2/
      DATA INLONG(1261)/'COCHRAN VARIANCE OUTLIER CV99'/
C
      DATA INCASE(1262)/'CVCD'/
      DATA (INAME(1262,J),J=1,MAXSCL)/
     1'COCH','    ','VARI','OUTL','CDF ','    ','    ','    '/
      DATA INFLAV(1262)/2/
      DATA INLONG(1262)/'COCHRAN VARIANCE OUTLIER CDF'/
C
      DATA INCASE(1263)/'CVPV'/
      DATA (INAME(1263,J),J=1,MAXSCL)/
     1'COCH','    ','VARI','OUTL','PVAL','    ','    ','    '/
      DATA INFLAV(1263)/2/
      DATA INLONG(1263)/'COCHRAN VARIANCE OUTLIER P-VALUE'/
C
      DATA INCASE(1264)/'CVOT'/
      DATA (INAME(1264,J),J=1,MAXSCL)/
     1'COCH','    ','VARI','OUTL','TEST','    ','    ','    '/
      DATA INFLAV(1264)/2/
      DATA INLONG(1264)/'COCHRAN VARIANCE OUTLIER TEST'/
C
      DATA INCASE(1265)/'CVOT'/
      DATA (INAME(1265,J),J=1,MAXSCL)/
     1'COCH','    ','VARI','TEST','    ','    ','    ','    '/
      DATA INFLAV(1265)/2/
      DATA INLONG(1265)/'COCHRAN VARIANCE OUTLIER TEST'/
C
      DATA INCASE(1266)/'CV05'/
      DATA (INAME(1266,J),J=1,MAXSCL)/
     1'COCH','    ','MINI','VARI','OUTL','CV05','    ','    '/
      DATA INFLAV(1266)/2/
      DATA INLONG(1266)/'COCHRAN MINIMUMUM VARIANCE OUTLIER CV05'/
C
      DATA INCASE(1267)/'CV01'/
      DATA (INAME(1267,J),J=1,MAXSCL)/
     1'COCH','    ','MINI','VARI','OUTL','CV01','    ','    '/
      DATA INFLAV(1267)/2/
      DATA INLONG(1267)/'COCHRAN MINIMUM VARIANCE OUTLIER CV01'/
C
      DATA INCASE(1268)/'CMVC'/
      DATA (INAME(1268,J),J=1,MAXSCL)/
     1'COCH','    ','MINI','VARI','OUTL','CDF ','    ','    '/
      DATA INFLAV(1268)/2/
      DATA INLONG(1268)/'COCHRAN MINIMUM VARIANCE OUTLIER CDF'/
C
      DATA INCASE(1269)/'CMVP'/
      DATA (INAME(1269,J),J=1,MAXSCL)/
     1'COCH','    ','MINI','VARI','OUTL','PVAL','    ','    '/
      DATA INFLAV(1269)/2/
      DATA INLONG(1269)/'COCHRAN MINIMUM VARIANCE OUTLIER P-VALUE'/
C
      DATA INCASE(1270)/'CVMO'/
      DATA (INAME(1270,J),J=1,MAXSCL)/
     1'COCH','    ','MINI','VARI','OUTL','TEST','    ','    '/
      DATA INFLAV(1270)/2/
      DATA INLONG(1270)/'COCHRAN VARIANCE OUTLIER TEST'/
C
      DATA INCASE(1271)/'CVMO'/
      DATA (INAME(1271,J),J=1,MAXSCL)/
     1'COCH','    ','MINI','VARI','TEST','    ','    ','    '/
      DATA INFLAV(1271)/2/
      DATA INLONG(1271)/'COCHRAN MINIMUM VARIANCE OUTLIER TEST'/
C
      DATA INCASE(1272)/'ESCD'/
      DATA (INAME(1272,J),J=1,MAXSCL)/
     1'EQUA','    ','SLOP','TEST','CDF ','    ','    ','    '/
      DATA INFLAV(1272)/3/
      DATA INLONG(1272)/'EQUAL SLOPES TEST CDF'/
C
      DATA INCASE(1273)/'ESCV'/
      DATA (INAME(1273,J),J=1,MAXSCL)/
     1'EQUA','    ','SLOP','TEST','CRIT','VALU','    ','    '/
      DATA INFLAV(1273)/3/
      DATA INLONG(1273)/'EQUAL SLOPES TEST CRITICAL VALUE'/
C
      DATA INCASE(1274)/'ESCV'/
      DATA (INAME(1274,J),J=1,MAXSCL)/
     1'EQUA','    ','SLOP','TEST','CV95','    ','    ','    '/
      DATA INFLAV(1274)/3/
      DATA INLONG(1274)/'EQUAL SLOPES TEST CRITICAL VALUE'/
C
      DATA INCASE(1275)/'ESPV'/
      DATA (INAME(1275,J),J=1,MAXSCL)/
     1'EQUA','    ','SLOP','TEST','PVAL','    ','    ','    '/
      DATA INFLAV(1275)/3/
      DATA INLONG(1275)/'EQUAL SLOPES PVALUE'/
C
      DATA INCASE(1276)/'ESP1'/
      DATA (INAME(1276,J),J=1,MAXSCL)/
     1'EQUA','    ','SLOP','TEST','ONE ','SIDE','PVAL','    '/
      DATA INFLAV(1276)/3/
      DATA INLONG(1276)/'EQUAL SLOPES PVALUE'/
C
      DATA INCASE(1277)/'ESPV'/
      DATA (INAME(1277,J),J=1,MAXSCL)/
     1'EQUA','    ','SLOP','TEST','P   ','VALU','    ','    '/
      DATA INFLAV(1277)/3/
      DATA INLONG(1277)/'EQUAL SLOPES TEST PVALUE'/
C
      DATA INCASE(1278)/'ESP1'/
      DATA (INAME(1278,J),J=1,MAXSCL)/
     1'EQUA','    ','SLOP','TEST','ONE ','SIDE','P   ','VALU'/
      DATA INFLAV(1278)/3/
      DATA INLONG(1278)/'EQUAL SLOPES TEST ONE SIDED PVALUE'/
C
      DATA INCASE(1279)/'ESLO'/
      DATA (INAME(1279,J),J=1,MAXSCL)/
     1'EQUA','    ','SLOP','TEST','    ','    ','    ','    '/
      DATA INFLAV(1279)/3/
      DATA INLONG(1279)/'EQUAL SLOPES TEST'/
C
      DATA INCASE(1280)/'DEKU'/
      DATA (INAME(1280,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','EXCE','KURT','    ','    ','    '/
      DATA INFLAV(1280)/2/
      DATA INLONG(1280)/'DIFFERENCE OF EXCESS KURTOSIS'/
C
      DATA INCASE(1281)/'DEKU'/
      DATA (INAME(1281,J),J=1,MAXSCL)/
     1'DIFF','    ','EXCE','KURT','    ','    ','    ','    '/
      DATA INFLAV(1281)/2/
      DATA INLONG(1281)/'DIFFERENCE OF EXCESS KURTOSIS'/
C
      DATA INCASE(1282)/'DKUR'/
      DATA (INAME(1282,J),J=1,MAXSCL)/
     1'DIFF','    ','KURT','    ','    ','    ','    ','    '/
      DATA INFLAV(1282)/2/
      DATA INLONG(1282)/'DIFFERENCE OF KURTOSIS'/
C
      DATA INCASE(1283)/'DINT'/
      DATA (INAME(1283,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','INTE','GRAL','    ','    ','    '/
      DATA INFLAV(1283)/2/
      DATA INLONG(1283)/'DIFFERENCE OF INTEGRALS'/
C
      DATA INCASE(1284)/'DINT'/
      DATA (INAME(1284,J),J=1,MAXSCL)/
     1'DIFF','    ','INTE','    ','    ','    ','    ','    '/
      DATA INFLAV(1284)/2/
      DATA INLONG(1284)/'DIFFERENCE OF INTEGRALS'/
C
      DATA INCASE(1285)/'DGSK'/
      DATA (INAME(1285,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','GALT','SKEW','    ','    ','    '/
      DATA INFLAV(1285)/2/
      DATA INLONG(1285)/'DIFFERENCE OF GALTON SKEWNESS'/
C
      DATA INCASE(1286)/'DGSK'/
      DATA (INAME(1286,J),J=1,MAXSCL)/
     1'DIFF','    ','GALT','SKEW','    ','    ','    ','    '/
      DATA INFLAV(1286)/2/
      DATA INLONG(1286)/'DIFFERENCE OF GALTON SKEWNESS'/
C
      DATA INCASE(1287)/'DPSK'/
      DATA (INAME(1287,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','PEAR','TWO ','SKEW','    ','    '/
      DATA INFLAV(1287)/2/
      DATA INLONG(1287)/'DIFFERENCE OF PEARSON SKEWNESS'/
C
      DATA INCASE(1288)/'DPSK'/
      DATA (INAME(1288,J),J=1,MAXSCL)/
     1'DIFF','    ','PEAR','TWO ','SKEW','    ','    ','    '/
      DATA INFLAV(1288)/2/
      DATA INLONG(1288)/'DIFFERENCE OF PEARSON SKEWNESS'/
C
      DATA INCASE(1289)/'DPSK'/
      DATA (INAME(1289,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','PEAR','2   ','SKEW','    ','    '/
      DATA INFLAV(1289)/2/
      DATA INLONG(1289)/'DIFFERENCE OF PEARSON SKEWNESS'/
C
      DATA INCASE(1290)/'DPSK'/
      DATA (INAME(1290,J),J=1,MAXSCL)/
     1'DIFF','    ','PEAR','2   ','SKEW','    ','    ','    '/
      DATA INFLAV(1290)/2/
      DATA INLONG(1290)/'DIFFERENCE OF PEARSON SKEWNESS'/
C
      DATA INCASE(1291)/'MADN'/
      DATA (INAME(1291,J),J=1,MAXSCL)/
     1'MADN','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(1291)/1/
      DATA INLONG(1291)/'SCALED MEDIAN ABSOLUTE DEVIATION'/
C
      DATA INCASE(1292)/'MADN'/
      DATA (INAME(1292,J),J=1,MAXSCL)/
     1'SCAL','    ','MEDI','ABSO','DEVI','    ','    ','    '/
      DATA INFLAV(1292)/1/
      DATA INLONG(1292)/'SCALED MEDIAN ABSOLUTE DEVIATION'/
C
      DATA INCASE(1293)/'MADN'/
      DATA (INAME(1293,J),J=1,MAXSCL)/
     1'NORM','    ','MEDI','ABSO','DEVI','    ','    ','    '/
      DATA INFLAV(1293)/1/
      DATA INLONG(1293)/'SCALED MEDIAN ABSOLUTE DEVIATION'/
C
      DATA INCASE(1294)/'DMAN'/
      DATA (INAME(1294,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','MADN','    ','    ','    ','    '/
      DATA INFLAV(1294)/2/
      DATA INLONG(1294)/'DIFF OF SCALED MEDIAN ABSOLUTE DEVIATION'/
C
      DATA INCASE(1295)/'DMAN'/
      DATA (INAME(1295,J),J=1,MAXSCL)/
     1'DIFF','    ','MADN','    ','    ','    ','    ','    '/
      DATA INFLAV(1295)/2/
      DATA INLONG(1295)/'DIFF OF SCALED MEDIAN ABSOLUTE DEVIATION'/
C
      DATA INCASE(1296)/'DMAN'/
      DATA (INAME(1296,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','SCAL','MEDI','ABSO','DEVI','    '/
      DATA INFLAV(1296)/2/
      DATA INLONG(1296)/'DIFF OF SCALED MEDIAN ABSOLUTE DEVIATION'/
C
      DATA INCASE(1297)/'DMAN'/
      DATA (INAME(1297,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','NORM','MEDI','ABSO','DEVI','    '/
      DATA INFLAV(1297)/2/
      DATA INLONG(1297)/'DIFF OF SCALED MEDIAN ABSOLUTE DEVIATION'/
C
      DATA INCASE(1298)/'DMAN'/
      DATA (INAME(1298,J),J=1,MAXSCL)/
     1'DIFF','    ','SCAL','MEDI','ABSO','DEVI','    ','    '/
      DATA INFLAV(1298)/2/
      DATA INLONG(1298)/'DIFF OF SCALED MEDIAN ABSOLUTE DEVIATION'/
C
      DATA INCASE(1299)/'DMAN'/
      DATA (INAME(1299,J),J=1,MAXSCL)/
     1'DIFF','    ','NORM','MEDI','ABSO','DEVI','    ','    '/
      DATA INFLAV(1299)/2/
      DATA INLONG(1299)/'DIFF OF SCALED MEDIAN ABSOLUTE DEVIATION'/
C
      DATA INCASE(1300)/'IQRA'/
      DATA (INAME(1300,J),J=1,MAXSCL)/
     1'IQR ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(1300)/1/
      DATA INLONG(1300)/'INTERQUARTILE RANGE'/
C
      DATA INCASE(1301)/'NIQR'/
      DATA (INAME(1301,J),J=1,MAXSCL)/
     1'NORM','    ','IQR ','    ','    ','    ','    ','    '/
      DATA INFLAV(1301)/1/
      DATA INLONG(1301)/'NORMALIZED INTERQUARTILE RANGE'/
C
      DATA INCASE(1302)/'NIQR'/
      DATA (INAME(1302,J),J=1,MAXSCL)/
     1'SCAL','    ','IQR ','    ','    ','    ','    ','    '/
      DATA INFLAV(1302)/1/
      DATA INLONG(1302)/'NORMALIZED INTERQUARTILE RANGE'/
C
      DATA INCASE(1303)/'NIQR'/
      DATA (INAME(1303,J),J=1,MAXSCL)/
     1'NORM','    ','IQ  ','RANG','    ','    ','    ','    '/
      DATA INFLAV(1303)/1/
      DATA INLONG(1303)/'NORMALIZED INTERQUARTILE RANGE'/
C
      DATA INCASE(1304)/'NIQR'/
      DATA (INAME(1304,J),J=1,MAXSCL)/
     1'SCAL','    ','IQ  ','RANG','    ','    ','    ','    '/
      DATA INFLAV(1304)/1/
      DATA INLONG(1304)/'NORMALIZED INTERQUARTILE RANGE'/
C
      DATA INCASE(1305)/'NIQR'/
      DATA (INAME(1305,J),J=1,MAXSCL)/
     1'NORM','    ','INTE','RANG','    ','    ','    ','    '/
      DATA INFLAV(1305)/1/
      DATA INLONG(1305)/'INTERQUARTILE RANGE'/
C
      DATA INCASE(1306)/'NIQR'/
      DATA (INAME(1306,J),J=1,MAXSCL)/
     1'SCAL','    ','INTE','RANG','    ','    ','    ','    '/
      DATA INFLAV(1306)/1/
      DATA INLONG(1306)/'INTERQUARTILE RANGE'/
C
      DATA INCASE(1307)/'DIQR'/
      DATA (INAME(1307,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','IQR ','    ','    ','    ','    '/
      DATA INFLAV(1307)/2/
      DATA INLONG(1307)/'DIFFERENCE OF INTERQUARTILE RANGES'/
C
      DATA INCASE(1308)/'DIQR'/
      DATA (INAME(1308,J),J=1,MAXSCL)/
     1'DIFF','    ','IQR ','    ','    ','    ','    ','    '/
      DATA INFLAV(1308)/2/
      DATA INLONG(1308)/'DIFFERENCE OF INTERQUARTILE RANGES'/
C
      DATA INCASE(1309)/'DNIQ'/
      DATA (INAME(1309,J),J=1,MAXSCL)/
     1'DIFF','    ','NORM','IQR ','    ','    ','    ','    '/
      DATA INFLAV(1309)/2/
      DATA INLONG(1309)/'DIFFERENCE OF NORMALIZED INTERQUARTILE RANGE'/
C
      DATA INCASE(1310)/'DNIQ'/
      DATA (INAME(1310,J),J=1,MAXSCL)/
     1'DIFF','    ','SCAL','IQR ','    ','    ','    ','    '/
      DATA INFLAV(1310)/2/
      DATA INLONG(1310)/'DIFFERENCE OF NORMALIZED INTERQUARTILE RANGE'/
C
      DATA INCASE(1311)/'DNIQ'/
      DATA (INAME(1311,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','NORM','IQR ','    ','    ','    '/
      DATA INFLAV(1311)/2/
      DATA INLONG(1311)/'DIFFERENCE OF NORMALIZED INTERQUARTILE RANGE'/
C
      DATA INCASE(1312)/'DNIQ'/
      DATA (INAME(1312,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','NORM','IQR ','    ','    ','    '/
      DATA INFLAV(1312)/2/
      DATA INLONG(1312)/'DIFFERENCE OF NORMALIZED INTERQUARTILE RANGE'/
C
      DATA INCASE(1313)/'DNIQ'/
      DATA (INAME(1313,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','NORM','IQ  ','RANG','    ','    '/
      DATA INFLAV(1313)/2/
      DATA INLONG(1313)/'DIFFERENCE OF NORMALIZED INTERQUARTILE RANGE'/
C
      DATA INCASE(1314)/'DNIQ'/
      DATA (INAME(1314,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','SCAL','IQ  ','RANG','    ','    '/
      DATA INFLAV(1314)/2/
      DATA INLONG(1314)/'DIFFERENCE OF NORMALIZED INTERQUARTILE RANGE'/
C
      DATA INCASE(1313)/'DNIQ'/
      DATA (INAME(1313,J),J=1,MAXSCL)/
     1'DIFF','    ','NORM','IQ  ','RANG','    ','    ','    '/
      DATA INFLAV(1313)/2/
      DATA INLONG(1313)/'DIFFERENCE OF NORMALIZED INTERQUARTILE RANGE'/
C
      DATA INCASE(1314)/'DNIQ'/
      DATA (INAME(1314,J),J=1,MAXSCL)/
     1'DIFF','    ','SCAL','IQ  ','RANG','    ','    ','    '/
      DATA INFLAV(1314)/2/
      DATA INLONG(1314)/'DIFFERENCE OF NORMALIZED INTERQUARTILE RANGE'/
C
      DATA INCASE(1315)/'DNIQ'/
      DATA (INAME(1315,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','NORM','INTE','QUAR','RANG','    '/
      DATA INFLAV(1315)/2/
      DATA INLONG(1315)/'DIFFERENCE OF NORMALIZED INTERQUARTILE RANGE'/
C
      DATA INCASE(1316)/'DNIQ'/
      DATA (INAME(1316,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','SCAL','INTE','QUAR','RANG','    '/
      DATA INFLAV(1316)/2/
      DATA INLONG(1316)/'DIFFERENCE OF NORMALIZED INTERQUARTILE RANGE'/
C
      DATA INCASE(1317)/'DNIQ'/
      DATA (INAME(1317,J),J=1,MAXSCL)/
     1'DIFF','    ','NORM','INTE','QUAR','RANG','    ','    '/
      DATA INFLAV(1317)/2/
      DATA INLONG(1317)/'DIFFERENCE OF NORMALIZED INTERQUARTILE RANGE'/
C
      DATA INCASE(1318)/'DNIQ'/
      DATA (INAME(1318,J),J=1,MAXSCL)/
     1'DIFF','    ','SCAL','INTE','QUAR','RANG','    ','    '/
      DATA INFLAV(1318)/2/
      DATA INLONG(1318)/'DIFFERENCE OF NORMALIZED INTERQUARTILE RANGE'/
C
      DATA INCASE(1319)/'W2PP'/
      DATA (INAME(1319,J),J=1,MAXSCL)/
     1'2PAR','    ','WEIB','PPCC','STAT','    ','    ','    '/
      DATA INFLAV(1319)/1/
      DATA INLONG(1319)/'2-PARAMETER WEIBULL PPCC'/
C
      DATA INCASE(1320)/'W2SH'/
      DATA (INAME(1320,J),J=1,MAXSCL)/
     1'2PAR','    ','WEIB','PPCC','SHAP','    ','    ','    '/
      DATA INFLAV(1320)/1/
      DATA INLONG(1320)/'2-PARAMETER WEIBULL SHAPE'/
C
      DATA INCASE(1321)/'W2SC'/
      DATA (INAME(1321,J),J=1,MAXSCL)/
     1'2PAR','    ','WEIB','PPCC','SCAL','    ','    ','    '/
      DATA INFLAV(1321)/1/
      DATA INLONG(1321)/'2-PARAMETER WEIBULL SCALE'/
C
      DATA INCASE(1322)/'CVLC'/
      DATA (INAME(1322,J),J=1,MAXSCL)/
     1'LOWE','    ','COEF','OF  ','VARI','CONF','LIMI','    '/
      DATA INFLAV(1322)/1/
      DATA INLONG(1322)
     1 /'LOWER COEFFICIENT OF VARIATION CONFIDENCE LIMIT'/
C
      DATA INCASE(1323)/'CVLC'/
      DATA (INAME(1323,J),J=1,MAXSCL)/
     1'LOWE','    ','COEF','OF  ','VARI','CONF','INTE','    '/
      DATA INFLAV(1323)/1/
      DATA INLONG(1323)
     1 /'LOWER COEFFICIENT OF VARIATION CONFIDENCE LIMIT'/
C
      DATA INCASE(1324)/'CVUC'/
      DATA (INAME(1324,J),J=1,MAXSCL)/
     1'UPPE','    ','COEF','OF  ','VARI','CONF','LIMI','    '/
      DATA INFLAV(1324)/1/
      DATA INLONG(1324)
     1 /'UPPER COEFFICIENT OF VARIATION CONFIDENCE LIMIT'/
C
      DATA INCASE(1325)/'CVUC'/
      DATA (INAME(1325,J),J=1,MAXSCL)/
     1'UPPE','    ','COEF','OF  ','VARI','CONF','INTE','    '/
      DATA INFLAV(1325)/1/
      DATA INLONG(1325)
     1 /'UPPER COEFFICIENT OF VARIATION CONFIDENCE LIMIT'/
C
      DATA INCASE(1326)/'CVLO'/
      DATA (INAME(1326,J),J=1,MAXSCL)/
     1'LOWE','    ','ONES','COEF','OF  ','VARI','CONF','LIMI'/
      DATA INFLAV(1326)/1/
      DATA INLONG(1326)
     1 /'ONE-SIDED LOWER COEF OF VARIATION CONFIDENCE LIMIT'/
C
      DATA INCASE(1327)/'CVLO'/
      DATA (INAME(1327,J),J=1,MAXSCL)/
     1'LOWE','    ','ONES','COEF','OF  ','VARI','CONF','INTE'/
      DATA INFLAV(1327)/1/
      DATA INLONG(1327)
     1 /'ONE-SIDED LOWER COEF OF VARIATION CONFIDENCE LIMIT'/
C
      DATA INCASE(1328)/'CVUO'/
      DATA (INAME(1328,J),J=1,MAXSCL)/
     1'UPPE','    ','ONES','COEF','OF  ','VARI','CONF','LIMI'/
      DATA INFLAV(1328)/1/
      DATA INLONG(1328)
     1 /'ONE-SIDED UPPER COEF OF VARIATION CONFIDENCE LIMIT'/
C
      DATA INCASE(1329)/'CVUO'/
      DATA (INAME(1329,J),J=1,MAXSCL)/
     1'UPPE','    ','ONES','COEF','OF  ','VARI','CONF','INTE'/
      DATA INFLAV(1329)/1/
      DATA INLONG(1329)
     1 /'ONE-SIDED UPPER COEF OF VARIATION CONFIDENCE LIMIT'/
C
      DATA INCASE(1330)/'SCVL'/
      DATA (INAME(1330,J),J=1,MAXSCL)/
     1'SUMM','    ','LOWE','COEF','OF  ','VARI','CONF','LIMI'/
      DATA INFLAV(1330)/3/
      DATA INLONG(1330)
     1 /'LOWER COEFFICIENT OF VARIATION CONFIDENCE LIMIT'/
C
      DATA INCASE(1331)/'SCVL'/
      DATA (INAME(1331,J),J=1,MAXSCL)/
     1'SUMM','    ','LOWE','COEF','OF  ','VARI','CONF','INTE'/
      DATA INFLAV(1331)/3/
      DATA INLONG(1331)
     1 /'LOWER COEFFICIENT OF VARIATION CONFIDENCE LIMIT'/
C
      DATA INCASE(1332)/'SCVU'/
      DATA (INAME(1332,J),J=1,MAXSCL)/
     1'SUMM','    ','UPPE','COEF','OF  ','VARI','CONF','LIMI'/
      DATA INFLAV(1332)/3/
      DATA INLONG(1332)
     1 /'UPPER COEFFICIENT OF VARIATION CONFIDENCE LIMIT'/
C
      DATA INCASE(1333)/'SCVU'/
      DATA (INAME(1333,J),J=1,MAXSCL)/
     1'SUMM','    ','UPPE','COEF','OF  ','VARI','CONF','INTE'/
      DATA INFLAV(1333)/3/
      DATA INLONG(1333)
     1 /'UPPER COEFFICIENT OF VARIATION CONFIDENCE LIMIT'/
C
      DATA INCASE(1334)/'SCVA'/
      DATA (INAME(1334,J),J=1,MAXSCL)/
     1'SUMM','    ','COEF','OF  ','VARI','    ','    ','    '/
      DATA INFLAV(1334)/2/
      DATA INLONG(1334)
     1 /'COEFFICIENT OF VARIATION'/
C
      DATA INCASE(1335)/'UCVA'/
      DATA (INAME(1335,J),J=1,MAXSCL)/
     1'UNBI','    ','COEF','OF  ','VARI','    ','    ','    '/
      DATA INFLAV(1335)/1/
      DATA INLONG(1335)
     1 /'UNBIASED COEFFICIENT OF VARIATION'/
C
      DATA INCASE(1336)/'SNRA'/
      DATA (INAME(1336,J),J=1,MAXSCL)/
     1'SIGN','    ','TO  ','NOIS','RATI','    ','    ','    '/
      DATA INFLAV(1336)/1/
      DATA INLONG(1336)
     1 /'SIGNAL TO NOISE RATIO'/
C
      DATA INCASE(1337)/'QCDI'/
      DATA (INAME(1337,J),J=1,MAXSCL)/
     1'QUAR','    ','COEF','OF  ','DISP','    ','    ','    '/
      DATA INFLAV(1337)/1/
      DATA INLONG(1337)
     1 /'QUARTILE COEFFICIENT OF DISPERSION'/
C
      DATA INCASE(1338)/'LLCV'/
      DATA (INAME(1338,J),J=1,MAXSCL)/
     1'LOWE','    ','LOGN','COEF','OF  ','VARI','CONF','LIMI'/
      DATA INFLAV(1338)/1/
      DATA INLONG(1338)
     1 /'LOWER LOGNORMAL COEFFICENT OF VARIATION CONFIDENCE LIMIT'/
C
      DATA INCASE(1339)/'LLCV'/
      DATA (INAME(1339,J),J=1,MAXSCL)/
     1'LOWE','    ','LOGN','COEF','OF  ','VARI','CONF','INTE'/
      DATA INFLAV(1339)/1/
      DATA INLONG(1339)
     1 /'LOWER LOGNORMAL COEFFICENT OF VARIATION CONFIDENCE LIMIT'/
C
      DATA INCASE(1340)/'ULCV'/
      DATA (INAME(1340,J),J=1,MAXSCL)/
     1'UPPE','    ','LOGN','COEF','OF  ','VARI','CONF','LIMI'/
      DATA INFLAV(1340)/1/
      DATA INLONG(1340)
     1 /'UPPER LOGNORMAL COEFFICENT OF VARIATION CONFIDENCE LIMIT'/
C
      DATA INCASE(1341)/'ULCV'/
      DATA (INAME(1341,J),J=1,MAXSCL)/
     1'UPPE','    ','LOGN','COEF','OF  ','VARI','CONF','INTE'/
      DATA INFLAV(1341)/1/
      DATA INLONG(1341)
     1 /'UPPER LOGNORMAL COEFFICENT OF VARIATION CONFIDENCE LIMIT'/
C
      DATA INCASE(1342)/'LCVA'/
      DATA (INAME(1342,J),J=1,MAXSCL)/
     1'LOGN','    ','COEF','OF  ','VARI','    ','    ','    '/
      DATA INFLAV(1342)/1/
      DATA INLONG(1342)
     1 /'LOGNORMAL COEFFICIENT OF VARIATION'/
C
      DATA INCASE(1343)/'SNRA'/
      DATA (INAME(1343,J),J=1,MAXSCL)/
     1'SNR ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(1343)/1/
      DATA INLONG(1343)
     1 /'SIGNAL TO NOISE RATIO'/
C
      DATA INCASE(1344)/'PREC'/
      DATA (INAME(1344,J),J=1,MAXSCL)/
     1'PREC','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(1344)/1/
      DATA INLONG(1344)
     1 /'PRECISION'/
C
      DATA INCASE(1345)/'CCVA'/
      DATA (INAME(1345,J),J=1,MAXSCL)/
     1'COMM','    ','COEF','OF  ','VARI','    ','    ','    '/
      DATA INFLAV(1345)/2/
      DATA INLONG(1345)
     1 /'COMMON COEFFICIENT OF VARIATION'/
C
      DATA INCASE(1346)/'UCCV'/
      DATA (INAME(1346,J),J=1,MAXSCL)/
     1'COMM','    ','BIAS','CORR','COEF','OF  ','VARI','    '/
      DATA INFLAV(1346)/2/
      DATA INLONG(1346)
     1 /'COMMON BIAS CORRECTED COEFFICIENT OF VARIATION'/
C
      DATA INCASE(1347)/'LCCV'/
      DATA (INAME(1347,J),J=1,MAXSCL)/
     1'LOWE','    ','COMM','COEF','OF  ','VARI','CONF','LIMI'/
      DATA INFLAV(1347)/2/
      DATA INLONG(1347)
     1 /'LOWER COMMON COEFFICIENT OF VARIATION CONFIDENCE LIMIT'/
C
      DATA INCASE(1348)/'UCC2'/
      DATA (INAME(1348,J),J=1,MAXSCL)/
     1'UPPE','    ','COMM','COEF','OF  ','VARI','CONF','LIMI'/
      DATA INFLAV(1348)/2/
      DATA INLONG(1348)
     1 /'UPPER COMMON COEFFICIENT OF VARIATION CONFIDENCE LIMIT'/
C
      DATA INCASE(1349)/'QCDI'/
      DATA (INAME(1349,J),J=1,MAXSCL)/
     1'QCD ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(1349)/1/
      DATA INLONG(1349)
     1 /'QUARTILE COEFFICIENT OF DISPERSION'/
C
      DATA INCASE(1350)/'CDIS'/
      DATA (INAME(1350,J),J=1,MAXSCL)/
     1'COEF','    ','OF  ','DISP','    ','    ','    ','    '/
      DATA INFLAV(1350)/1/
      DATA INLONG(1350)
     1 /'COEFFICIENT OF DISPERSION'/
C
      DATA INCASE(1351)/'IDIS'/
      DATA (INAME(1351,J),J=1,MAXSCL)/
     1'INDE','    ','OF  ','DISP','    ','    ','    ','    '/
      DATA INFLAV(1351)/1/
      DATA INLONG(1351)
     1 /'INDEX OF DISPERSION'/
C
      DATA INCASE(1352)/'AAD '/
      DATA (INAME(1352,J),J=1,MAXSCL)/
     1'AAD ','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(1352)/1/
      DATA INLONG(1352)/'AVERAGE ABSOLUTE DEVIATION'/
C
      DATA INCASE(1353)/'SHMM'/
      DATA (INAME(1353,J),J=1,MAXSCL)/
     1'SHOR','    ','HALF','MIDM','    ','    ','    ','    '/
      DATA INFLAV(1353)/1/
      DATA INLONG(1353)/'SHORTEST HALF MIDMEAN'/
C
      DATA INCASE(1354)/'SHMM'/
      DATA (INAME(1354,J),J=1,MAXSCL)/
     1'SHOR','    ','HALF','MID ','MEAN','    ','    ','    '/
      DATA INFLAV(1354)/1/
      DATA INLONG(1354)/'SHORTEST HALF MIDMEAN'/
C
      DATA INCASE(1355)/'SHMR'/
      DATA (INAME(1355,J),J=1,MAXSCL)/
     1'SHOR','    ','HALF','MIDR','    ','    ','    ','    '/
      DATA INFLAV(1355)/1/
      DATA INLONG(1355)/'SHORTEST HALF MIDRANGE'/
C
      DATA INCASE(1356)/'SHMR'/
      DATA (INAME(1356,J),J=1,MAXSCL)/
     1'SHOR','    ','HALF','MID ','RANG','    ','    ','    '/
      DATA INFLAV(1356)/1/
      DATA INLONG(1356)/'SHORTEST HALF MIDRANGE'/
C
      DATA INCASE(1357)/'COSD'/
      DATA (INAME(1357,J),J=1,MAXSCL)/
     1'COSI','    ','DIST','    ','    ','    ','    ','    '/
      DATA INFLAV(1357)/2/
      DATA INLONG(1357)/'COSINE DISTANCE'/
C
      DATA INCASE(1358)/'COSS'/
      DATA (INAME(1358,J),J=1,MAXSCL)/
     1'COSI','    ','SIMI','    ','    ','    ','    ','    '/
      DATA INFLAV(1358)/2/
      DATA INLONG(1358)/'COSINE SIMILARITY'/
C
      DATA INCASE(1359)/'ACOD'/
      DATA (INAME(1359,J),J=1,MAXSCL)/
     1'ANGU','    ','COSI','DIST','    ','    ','    ','    '/
      DATA INFLAV(1359)/2/
      DATA INLONG(1359)/'ANGULAR COSINE DISTANCE'/
C
      DATA INCASE(1360)/'ACOS'/
      DATA (INAME(1360,J),J=1,MAXSCL)/
     1'ANGU','    ','COSI','SIMI','    ','    ','    ','    '/
      DATA INFLAV(1360)/2/
      DATA INLONG(1360)/'ANGULAR COSINE SIMILARITY'/
C
      DATA INCASE(1361)/'EUCD'/
      DATA (INAME(1361,J),J=1,MAXSCL)/
     1'EUCL','    ','DIST','    ','    ','    ','    ','    '/
      DATA INFLAV(1361)/2/
      DATA INLONG(1361)/'EUCLIDEAN DISTANCE'/
C
      DATA INCASE(1362)/'EUCL'/
      DATA (INAME(1362,J),J=1,MAXSCL)/
     1'EUCL','    ','LENG','    ','    ','    ','    ','    '/
      DATA INFLAV(1362)/1/
      DATA INLONG(1362)/'EUCLIDEAN LENGTH'/
C
      DATA INCASE(1363)/'DOTP'/
      DATA (INAME(1363,J),J=1,MAXSCL)/
     1'DOT ','    ','PROD','    ','    ','    ','    ','    '/
      DATA INFLAV(1363)/2/
      DATA INLONG(1363)/'DOT PRODUCT'/
C
      DATA INCASE(1364)/'MAND'/
      DATA (INAME(1364,J),J=1,MAXSCL)/
     1'MANH','    ','DIST','    ','    ','    ','    ','    '/
      DATA INFLAV(1364)/2/
      DATA INLONG(1364)/'MANHATTAN DISTANCE'/
C
      DATA INCASE(1365)/'DPRE'/
      DATA (INAME(1365,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','PREC','    ','    ','    ','    '/
      DATA INFLAV(1365)/2/
      DATA INLONG(1365)/'DIFFERENCE OF PRECISION'/
C
      DATA INCASE(1366)/'DPRE'/
      DATA (INAME(1366,J),J=1,MAXSCL)/
     1'DIFF','    ','PREC','    ','    ','    ','    ','    '/
      DATA INFLAV(1366)/2/
      DATA INLONG(1366)/'DIFFERENCE OF PRECISION'/
C
      DATA INCASE(1367)/'DSNR'/
      DATA (INAME(1367,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','SNR ','    ','    ','    ','    '/
      DATA INFLAV(1367)/2/
      DATA INLONG(1367)/'DIFFERENCE OF SNR'/
C
      DATA INCASE(1368)/'DSNR'/
      DATA (INAME(1368,J),J=1,MAXSCL)/
     1'DIFF','    ','SNR ','    ','    ','    ','    ','    '/
      DATA INFLAV(1368)/2/
      DATA INLONG(1368)/'DIFFERENCE OF SNR'/
C
      DATA INCASE(1369)/'DSNR'/
      DATA (INAME(1369,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','SIGN','TO  ','NOIS','RATI','    '/
      DATA INFLAV(1369)/2/
      DATA INLONG(1369)/'DIFFERENCE OF SNR'/
C
      DATA INCASE(1370)/'DSNR'/
      DATA (INAME(1370,J),J=1,MAXSCL)/
     1'DIFF','    ','SIGN','TO  ','NOIS','RATI','    ','    '/
      DATA INFLAV(1370)/2/
      DATA INLONG(1370)/'DIFFERENCE OF SNR'/
C
      DATA INCASE(1371)/'1CCD'/
      DATA (INAME(1371,J),J=1,MAXSCL)/
     1'ONE ','    ','SAMP','COEF','OF  ','VARI','TEST','CDF '/
      DATA INFLAV(1371)/2/
      DATA INLONG(1371)/'ONE SAMPLE COEFFICIENT OF VARIATION TEST CDF'/
C
      DATA INCASE(1372)/'1C2P'/
      DATA (INAME(1372,J),J=1,MAXSCL)/
     1'ONE ','    ','SAMP','COEF','OF  ','VARI','TEST','PVAL'/
      DATA INFLAV(1372)/2/
      DATA INLONG(1372)/'ONE SAMPLE COEFFICIENT OF VARIATION P-VALUE'/
C
      DATA INCASE(1373)/'1CLP'/
      DATA (INAME(1373,J),J=1,MAXSCL)/
     1'ONE ','    ','SAMP','COEF','OF  ','VARI','LOWE','PVAL'/
      DATA INFLAV(1373)/2/
      DATA INLONG(1373)
     1     /'ONE SAMPLE COEFFICIENT OF VARIATION LOWER P-VALUE'/
C
      DATA INCASE(1374)/'1CUP'/
      DATA (INAME(1374,J),J=1,MAXSCL)/
     1'ONE ','    ','SAMP','COEF','OF  ','VARI','UPPE','PVAL'/
      DATA INFLAV(1374)/2/
      DATA INLONG(1374)
     1     /'ONE SAMPLE COEFFICIENT OF VARIATION UPPER P-VALUE'/
C
      DATA INCASE(1375)/'1CCD'/
      DATA (INAME(1375,J),J=1,MAXSCL)/
     1'1   ','    ','SAMP','COEF','OF  ','VARI','TEST','CDF '/
      DATA INFLAV(1375)/2/
      DATA INLONG(1375)/'ONE SAMPLE COEFFICIENT OF VARIATION TEST CDF'/
C
      DATA INCASE(1376)/'1C2P'/
      DATA (INAME(1376,J),J=1,MAXSCL)/
     1'1   ','    ','SAMP','COEF','OF  ','VARI','TEST','PVAL'/
      DATA INFLAV(1376)/2/
      DATA INLONG(1376)/'ONE SAMPLE COEFFICIENT OF VARIATION P-VALUE'/
C
      DATA INCASE(1377)/'1CLP'/
      DATA (INAME(1377,J),J=1,MAXSCL)/
     1'1   ','    ','SAMP','COEF','OF  ','VARI','LOWE','PVAL'/
      DATA INFLAV(1377)/2/
      DATA INLONG(1377)
     1     /'ONE SAMPLE COEFFICIENT OF VARIATION LOWER P-VALUE'/
C
      DATA INCASE(1378)/'1CUP'/
      DATA (INAME(1378,J),J=1,MAXSCL)/
     1'ONE ','    ','SAMP','COEF','OF  ','VARI','UPPE','PVAL'/
      DATA INFLAV(1378)/2/
      DATA INLONG(1378)
     1     /'ONE SAMPLE COEFFICIENT OF VARIATION UPPER P-VALUE'/
C
      DATA INCASE(1379)/'1CTE'/
      DATA (INAME(1379,J),J=1,MAXSCL)/
     1'ONE ','    ','SAMP','COEF','OF  ','VARI','TEST','    '/
      DATA INFLAV(1379)/2/
      DATA INLONG(1379)/'ONE SAMPLE COEFFICIENT OF VARIATION TEST'/
C
      DATA INCASE(1380)/'1CTE'/
      DATA (INAME(1380,J),J=1,MAXSCL)/
     1'1   ','    ','SAMP','COEF','OF  ','VARI','TEST','    '/
      DATA INFLAV(1380)/2/
      DATA INLONG(1380)/'ONE SAMPLE COEFFICIENT OF VARIATION TEST'/
C
      DATA INCASE(1381)/'S1CT'/
      DATA (INAME(1381,J),J=1,MAXSCL)/
     1'SUMM','    ','ONE ','SAMP','COEF','OF  ','VARI','TEST'/
      DATA INFLAV(1381)/3/
      DATA INLONG(1381)
     1  /'SUMMARY ONE SAMPLE COEFFICIENT OF VARIATION TEST'/
C
      DATA INCASE(1382)/'S1CT'/
      DATA (INAME(1382,J),J=1,MAXSCL)/
     1'SUMM','    ','1   ','SAMP','COEF','OF  ','VARI','TEST'/
      DATA INFLAV(1382)/3/
      DATA INLONG(1382)
     1  /'SUMMARY ONE SAMPLE COEFFICIENT OF VARIATION TEST'/
C
      DATA INCASE(1383)/'S1CC'/
      DATA (INAME(1383,J),J=1,MAXSCL)/
     1'SUMM','    ','ONE ','SAMP','COEF','OF  ','VARI','CDF '/
      DATA INFLAV(1383)/3/
      DATA INLONG(1383)
     1  /'SUMMARY ONE SAMPLE COEFFICIENT OF VARIATION CDF VALUE'/
C
      DATA INCASE(1384)/'S1CC'/
      DATA (INAME(1384,J),J=1,MAXSCL)/
     1'SUMM','    ','1   ','SAMP','COEF','OF  ','VARI','CDF '/
      DATA INFLAV(1384)/3/
      DATA INLONG(1384)
     1  /'SUMMARY ONE SAMPLE COEFFICIENT OF VARIATION CDF VALUE'/
C
      DATA INCASE(1385)/'S1CP'/
      DATA (INAME(1385,J),J=1,MAXSCL)/
     1'SUMM','    ','ONE ','SAMP','COEF','OF  ','VARI','PVAL'/
      DATA INFLAV(1385)/3/
      DATA INLONG(1385)
     1  /'SUMMARY ONE SAMPLE COEFFICIENT OF VARIATION P-VALUE'/
C
      DATA INCASE(1386)/'S1CP'/
      DATA (INAME(1386,J),J=1,MAXSCL)/
     1'SUMM','    ','1   ','SAMP','COEF','OF  ','VARI','PVAL'/
      DATA INFLAV(1386)/3/
      DATA INLONG(1386)
     1  /'SUMMARY ONE SAMPLE COEFFICIENT OF VARIATION P-VALUE'/
C
      DATA INCASE(1387)/'2CCD'/
      DATA (INAME(1387,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','COEF','OF  ','VARI','TEST','CDF '/
      DATA INFLAV(1387)/2/
      DATA INLONG(1387)/'TWO SAMPLE COEFFICIENT OF VARIATION TEST CDF'/
C
      DATA INCASE(1388)/'2C2P'/
      DATA (INAME(1388,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','COEF','OF  ','VARI','TEST','PVAL'/
      DATA INFLAV(1388)/2/
      DATA INLONG(1388)/'TWO SAMPLE COEFFICIENT OF VARIATION P-VALUE'/
C
      DATA INCASE(1389)/'2CLP'/
      DATA (INAME(1389,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','COEF','OF  ','VARI','LOWE','PVAL'/
      DATA INFLAV(1389)/2/
      DATA INLONG(1389)
     1     /'TWO SAMPLE COEFFICIENT OF VARIATION LOWER P-VALUE'/
C
      DATA INCASE(1390)/'2CUP'/
      DATA (INAME(1390,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','COEF','OF  ','VARI','UPPE','PVAL'/
      DATA INFLAV(1390)/2/
      DATA INLONG(1390)
     1     /'TWO SAMPLE COEFFICIENT OF VARIATION UPPER P-VALUE'/
C
      DATA INCASE(1391)/'2CCD'/
      DATA (INAME(1391,J),J=1,MAXSCL)/
     1'2   ','    ','SAMP','COEF','OF  ','VARI','TEST','CDF '/
      DATA INFLAV(1391)/2/
      DATA INLONG(1391)/'TWO SAMPLE COEFFICIENT OF VARIATION TEST CDF'/
C
      DATA INCASE(1392)/'2C2P'/
      DATA (INAME(1392,J),J=1,MAXSCL)/
     1'2   ','    ','SAMP','COEF','OF  ','VARI','TEST','PVAL'/
      DATA INFLAV(1392)/2/
      DATA INLONG(1392)/'TWO SAMPLE COEFFICIENT OF VARIATION P-VALUE'/
C
      DATA INCASE(1393)/'2CLP'/
      DATA (INAME(1393,J),J=1,MAXSCL)/
     1'2   ','    ','SAMP','COEF','OF  ','VARI','LOWE','PVAL'/
      DATA INFLAV(1393)/2/
      DATA INLONG(1393)
     1     /'TWO SAMPLE COEFFICIENT OF VARIATION LOWER P-VALUE'/
C
      DATA INCASE(1394)/'2CUP'/
      DATA (INAME(1394,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','COEF','OF  ','VARI','UPPE','PVAL'/
      DATA INFLAV(1394)/2/
      DATA INLONG(1394)
     1     /'TWO SAMPLE COEFFICIENT OF VARIATION UPPER P-VALUE'/
C
      DATA INCASE(1395)/'2CTE'/
      DATA (INAME(1395,J),J=1,MAXSCL)/
     1'TWO ','    ','SAMP','COEF','OF  ','VARI','TEST','    '/
      DATA INFLAV(1395)/2/
      DATA INLONG(1395)/'TWO SAMPLE COEFFICIENT OF VARIATION TEST'/
C
      DATA INCASE(1396)/'2CTE'/
      DATA (INAME(1396,J),J=1,MAXSCL)/
     1'2   ','    ','SAMP','COEF','OF  ','VARI','TEST','    '/
      DATA INFLAV(1396)/2/
      DATA INLONG(1396)/'TWO SAMPLE COEFFICIENT OF VARIATION TEST'/
C
      DATA INCASE(1397)/'DCDI'/
      DATA (INAME(1397,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','COEF','OF  ','DISP','    ','    '/
      DATA INFLAV(1397)/2/
      DATA INLONG(1397)/'DIFFERENCE OF COEFFICIENT OF DISPERSION'/
C
      DATA INCASE(1398)/'DIDI'/
      DATA (INAME(1398,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','INDE','OF  ','DISP','    ','    '/
      DATA INFLAV(1398)/2/
      DATA INLONG(1398)/'DIFFERENCE OF INDEX OF DISPERSION'/
C
      DATA INCASE(1399)/'DQDI'/
      DATA (INAME(1399,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','QUAR','COEF','OF  ','DISP','    '/
      DATA INFLAV(1399)/2/
      DATA INLONG(1399)/
     1     'DIFFERENCE OF QuARTILE COEFFICIENT OF DISPERSION'/
C
      DATA INCASE(1400)/'DAAD'/
      DATA (INAME(1400,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','AAD ','    ','    ','    ','    '/
      DATA INFLAV(1400)/2/
      DATA INLONG(1400)/'DIFFERENCE OF AVERAGE ABSOLUTE DEVIATIONS'/
C
      DATA INCASE(1401)/'DSHM'/
      DATA (INAME(1401,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','SHOR','HALF','MIDM','    ','    '/
      DATA INFLAV(1401)/2/
      DATA INLONG(1401)/'DIFFERENCE OF SHORTEST HALF MIDMEAN'/
C
      DATA INCASE(1402)/'DSHM'/
      DATA (INAME(1401,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','SHOR','HALF','MID ','MEAN','    '/
      DATA INFLAV(1402)/2/
      DATA INLONG(1402)/'DIFFERENCE OF SHORTEST HALF MIDMEAN'/
C
      DATA INCASE(1403)/'DSHR'/
      DATA (INAME(1403,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','SHOR','HALF','MIDR','    ','    '/
      DATA INFLAV(1403)/2/
      DATA INLONG(1403)/'DIFFERENCE OF SHORTEST HALF MIDRANGE'/
C
      DATA INCASE(1404)/'DSHR'/
      DATA (INAME(1404,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','SHOR','HALF','MID ','RANG','    '/
      DATA INFLAV(1404)/2/
      DATA INLONG(1404)/'DIFFERENCE OF SHORTEST HALF MIDRANGE'/
C
      DATA INCASE(1405)/'HESE'/
      DATA (INAME(1405,J),J=1,MAXSCL)/
     1'HEDG','    ','G   ','STAN','ERRO','    ','    ','    '/
      DATA INFLAV(1405)/2/
      DATA INLONG(1405)/'HEDGES G STANDARD ERROR'/
C
      DATA INCASE(1406)/'BCHG'/
      DATA (INAME(1406,J),J=1,MAXSCL)/
     1'BIAS','    ','CORR','HEDG','G   ','    ','    ','    '/
      DATA INFLAV(1406)/2/
      DATA INLONG(1406)/'BIAS CORRECTED HEDGES G'/
C
      DATA INCASE(1407)/'GLAS'/
      DATA (INAME(1407,J),J=1,MAXSCL)/
     1'GLAS','    ','G   ','    ','    ','    ','    ','    '/
      DATA INFLAV(1407)/2/
      DATA INLONG(1407)/'GLASS G'/
C
      DATA INCASE(1408)/'COHD'/
      DATA (INAME(1408,J),J=1,MAXSCL)/
     1'COHE','    ','D   ','    ','    ','    ','    ','    '/
      DATA INFLAV(1408)/2/
      DATA INLONG(1408)/'COHENS D'/
C
      DATA INCASE(1409)/'MHIN'/
      DATA (INAME(1409,J),J=1,MAXSCL)/
     1'MIDH','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(1409)/1/
      DATA INLONG(1409)/'MID-HINGE'/
C
      DATA INCASE(1410)/'MHIN'/
      DATA (INAME(1410,J),J=1,MAXSCL)/
     1'MID ','    ','HING','    ','    ','    ','    ','    '/
      DATA INFLAV(1410)/1/
      DATA INLONG(1410)/'MID-HINGE'/
C
      DATA INCASE(1411)/'TMEA'/
      DATA (INAME(1411,J),J=1,MAXSCL)/
     1'TRIM','EAN ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(1411)/1/
      DATA INLONG(1411)/'TRI-MEAN'/
C
      DATA INCASE(1412)/'TMEA'/
      DATA (INAME(1412,J),J=1,MAXSCL)/
     1'TRI ','    ','MEAN','    ','    ','    ','    ','    '/
      DATA INFLAV(1412)/1/
      DATA INLONG(1412)/'TRI-MEAN'/
C
      DATA INCASE(1413)/'DMHI'/
      DATA (INAME(1413,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','MID ','HING','    ','    ','    '/
      DATA INFLAV(1413)/2/
      DATA INLONG(1413)/'DIFFERENCE OF MID-HINGE'/
C
      DATA INCASE(1414)/'DMHI'/
      DATA (INAME(1414,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','MIDH','    ','    ','    ','    '/
      DATA INFLAV(1414)/2/
      DATA INLONG(1414)/'DIFFERENCE OF MID-HINGE'/
C
      DATA INCASE(1415)/'DTRI'/
      DATA (INAME(1415,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','TRI ','MEAN','    ','    ','    '/
      DATA INFLAV(1415)/2/
      DATA INLONG(1415)/'DIFFERENCE OF TRI-MEAN'/
C
      DATA INCASE(1416)/'DTRI'/
      DATA (INAME(1416,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','TRIM','    ','    ','    ','    '/
      DATA INFLAV(1416)/2/
      DATA INLONG(1416)/'DIFFERENCE OF TRI-MEAN'/
C
      DATA INCASE(1417)/'PDIS'/
      DATA (INAME(1417,J),J=1,MAXSCL)/
     1'PEAR','    ','DISS','    ','    ','    ','    ','    '/
      DATA INFLAV(1417)/2/
      DATA INLONG(1417)/'PEARSON DISSIMILARITY'/
C
      DATA INCASE(1418)/'RDIS'/
      DATA (INAME(1418,J),J=1,MAXSCL)/
     1'SPEA','    ','DISS','    ','    ','    ','    ','    '/
      DATA INFLAV(1418)/2/
      DATA INLONG(1418)/'SPEARMAN DISSIMILARITY'/
C
      DATA INCASE(1419)/'KSIM'/
      DATA (INAME(1419,J),J=1,MAXSCL)/
     1'KEND','    ','TAU ','SIMI','    ','    ','    ','    '/
      DATA INFLAV(1419)/2/
      DATA INLONG(1419)/'KENDELLS TAU SIMILARITY'/
C
      DATA INCASE(1420)/'CHDI'/
      DATA (INAME(1420,J),J=1,MAXSCL)/
     1'CHEB','    ','DIST','    ','    ','    ','    ','    '/
      DATA INFLAV(1420)/2/
      DATA INLONG(1420)/'CHEBYSHEV DISTANCE'/
C
      DATA INCASE(1421)/'MDIS'/
      DATA (INAME(1421,J),J=1,MAXSCL)/
     1'MINK','    ','DIST','    ','    ','    ','    ','    '/
      DATA INFLAV(1421)/2/
      DATA INLONG(1421)/'MINKOWSKI DISTANCE'/
C
      DATA INCASE(1422)/'BMDI'/
      DATA (INAME(1422,J),J=1,MAXSCL)/
     1'BINA','    ','MATC','DISS','    ','    ','    ','    '/
      DATA INFLAV(1422)/2/
      DATA INLONG(1422)/'BINARY MATCH DISSIMILARITY'/
C
      DATA INCASE(1423)/'BMRD'/
      DATA (INAME(1423,J),J=1,MAXSCL)/
     1'BINA','    ','ROGE','MATC','DISS','    ','    ','    '/
      DATA INFLAV(1423)/2/
      DATA INLONG(1423)/'BINARY ROGERS MATCH DISSIMILARITY'/
C
      DATA INCASE(1424)/'BMSD'/
      DATA (INAME(1424,J),J=1,MAXSCL)/
     1'BINA','    ','SOKA','MATC','DISS','    ','    ','    '/
      DATA INFLAV(1424)/2/
      DATA INLONG(1424)/'BINARY SOKAL MATCH DISSIMILARITY'/
C
      DATA INCASE(1425)/'BJDI'/
      DATA (INAME(1425,J),J=1,MAXSCL)/
     1'BINA','    ','JACC','DISS','    ','    ','    ','    '/
      DATA INFLAV(1425)/2/
      DATA INLONG(1425)/'BINARY JACCARD DISSIMILARITY'/
C
      DATA INCASE(1426)/'BSDI'/
      DATA (INAME(1426,J),J=1,MAXSCL)/
     1'BINA','    ','ASYM','SOKA','DISS','    ','    ','    '/
      DATA INFLAV(1426)/2/
      DATA INLONG(1426)/'BINARY ASYYMETRIC SOKAL DISSIMILARITY'/
C
      DATA INCASE(1427)/'BDDI'/
      DATA (INAME(1427,J),J=1,MAXSCL)/
     1'BINA','    ','ASYM','DICE','DISS','    ','    ','    '/
      DATA INFLAV(1427)/2/
      DATA INLONG(1427)/'BINARY ASYYMETRIC DICE DISSIMILARITY'/
C
      DATA INCASE(1428)/'BMSI'/
      DATA (INAME(1428,J),J=1,MAXSCL)/
     1'BINA','    ','MATC','SIMI','    ','    ','    ','    '/
      DATA INFLAV(1428)/2/
      DATA INLONG(1428)/'BINARY MATCH SIMILARITY'/
C
      DATA INCASE(1429)/'BMRS'/
      DATA (INAME(1429,J),J=1,MAXSCL)/
     1'BINA','    ','ROGE','MATC','SIMI','    ','    ','    '/
      DATA INFLAV(1429)/2/
      DATA INLONG(1429)/'BINARY ROGERS MATCH SIMILARITY'/
C
      DATA INCASE(1430)/'BMSS'/
      DATA (INAME(1430,J),J=1,MAXSCL)/
     1'BINA','    ','SOKA','MATC','SIMI','    ','    ','    '/
      DATA INFLAV(1430)/2/
      DATA INLONG(1430)/'BINARY SOKAL MATCH SIMILARITY'/
C
      DATA INCASE(1431)/'BJSI'/
      DATA (INAME(1431,J),J=1,MAXSCL)/
     1'BINA','    ','JACC','SIMI','    ','    ','    ','    '/
      DATA INFLAV(1431)/2/
      DATA INLONG(1431)/'BINARY JACCARD SIMILARITY'/
C
      DATA INCASE(1432)/'BSSI'/
      DATA (INAME(1432,J),J=1,MAXSCL)/
     1'BINA','    ','ASYM','SOKA','SIMI','    ','    ','    '/
      DATA INFLAV(1432)/2/
      DATA INLONG(1432)/'BINARY ASYYMETRIC SOKAL SIMILARITY'/
C
      DATA INCASE(1433)/'BDSI'/
      DATA (INAME(1433,J),J=1,MAXSCL)/
     1'BINA','    ','ASYM','DICE','SIMI','    ','    ','    '/
      DATA INFLAV(1433)/2/
      DATA INLONG(1433)/'BINARY ASYYMETRIC DICE SIMILARITY'/
C
      DATA INCASE(1434)/'GJCO'/
      DATA (INAME(1434,J),J=1,MAXSCL)/
     1'GENE','    ','JACC','COEF','    ','    ','    ','    '/
      DATA INFLAV(1434)/2/
      DATA INLONG(1434)/'JACCARD SIMILARITY'/
C
      DATA INCASE(1435)/'GJDI'/
      DATA (INAME(1435,J),J=1,MAXSCL)/
     1'GENE','    ','JACC','DIST','    ','    ','    ','    '/
      DATA INFLAV(1435)/2/
      DATA INLONG(1435)/'JACCARD DISTANCE'/
C
      DATA INCASE(1436)/'YULQ'/
      DATA (INAME(1436,J),J=1,MAXSCL)/
     1'YULE','    ','Q   ','    ','    ','    ','    ','    '/
      DATA INFLAV(1436)/2/
      DATA INLONG(1436)/'YULES Q'/
C
      DATA INCASE(1437)/'DBUC'/
      DATA (INAME(1437,J),J=1,MAXSCL)/
     1'DIFF','    ','BINO','PROB','UPPE','CONF','LIMI','    '/
      DATA INFLAV(1437)/2/
      DATA INLONG(1437)/'DIFF OF BINOMIAL PROPORTIONS UPPER CONF LIMIT'/
C
      DATA INCASE(1438)/'DBUC'/
      DATA (INAME(1438,J),J=1,MAXSCL)/
     1'DIFF','    ','BINO','PROP','UPPE','CONF','LIMI','    '/
      DATA INFLAV(1438)/2/
      DATA INLONG(1438)/'DIFF OF BINOMIAL PROPORTIONS UPPER CONF LIMIT'/
C
      DATA INCASE(1439)/'DBUC'/
      DATA (INAME(1439,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','BINO','PROP','UPPE','CONF','LIMI'/
      DATA INFLAV(1439)/2/
      DATA INLONG(1439)/'DIFF OF BINOMIAL PROPORTIONS UPPER CONF LIMIT'/
C
      DATA INCASE(1440)/'DBUC'/
      DATA (INAME(1440,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','BINO','PROB','UPPE','CONF','LIMI'/
      DATA INFLAV(1440)/2/
      DATA INLONG(1440)/'DIFF OF BINOMIAL PROPORTIONS UPPER CONF LIMIT'/
C
      DATA INCASE(1441)/'DBPR'/
      DATA (INAME(1441,J),J=1,MAXSCL)/
     1'DIFF','    ','BINO','PROB','    ','    ','    ','    '/
      DATA INFLAV(1441)/2/
      DATA INLONG(1441)/'DIFFERENCE OF BINOMIAL PROPORTIONS'/
C
      DATA INCASE(1441)/'DBPR'/
      DATA (INAME(1441,J),J=1,MAXSCL)/
     1'DIFF','    ','BINO','PROP','    ','    ','    ','    '/
      DATA INFLAV(1441)/2/
      DATA INLONG(1441)/'DIFFERENCE OF BINOMIAL PROPORTIONS'/
C
      DATA INCASE(1442)/'DBPR'/
      DATA (INAME(1442,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','BINO','PROP','    ','    ','    '/
      DATA INFLAV(1442)/2/
      DATA INLONG(1442)/'DIFFERENCE OF BINOMIAL PROPORTIONS'/
C
      DATA INCASE(1443)/'DBPR'/
      DATA (INAME(1443,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','BINO','PROB','    ','    ','    '/
      DATA INFLAV(1443)/2/
      DATA INLONG(1443)/'DIFFERENCE OF BINOMIAL PROPORTIONS'/
C
      DATA INCASE(1444)/'BPUC'/
      DATA (INAME(1444,J),J=1,MAXSCL)/
     1'BINO','    ','PROB','UPPE','CONF','LIMI','    ','    '/
      DATA INFLAV(1444)/1/
      DATA INLONG(1444)/'BINOMIAL PROPORTION UPPER CONFIDENCE LIMIT'/
C
      DATA INCASE(1445)/'BPUC'/
      DATA (INAME(1445,J),J=1,MAXSCL)/
     1'BINO','    ','PROP','UPPE','CONF','LIMI','    ','    '/
      DATA INFLAV(1445)/1/
      DATA INLONG(1445)/'BINOMIAL PROPORTION UPPER CONFIDENCE LIMIT'/
C
      DATA INCASE(1446)/'BPRO'/
      DATA (INAME(1446,J),J=1,MAXSCL)/
     1'BINO','    ','PROB','    ','    ','    ','    ','    '/
      DATA INFLAV(1446)/1/
      DATA INLONG(1446)/'BINOMIAL PROPORTION'/
C
      DATA INCASE(1447)/'LCDL'/
      DATA (INAME(1447,J),J=1,MAXSCL)/
     1'LOWE','    ','COEF','OF  ','DISP','CONF','LIMI','    '/
      DATA INFLAV(1447)/1/
      DATA INLONG(1447)/'LOWER COEF OF DISPERSION CONFIDENCE LIMIT'/
C
      DATA INCASE(1448)/'LCDL'/
      DATA (INAME(1448,J),J=1,MAXSCL)/
     1'LOWE','    ','COEF','DISP','CONF','LIMI','    ','    '/
      DATA INFLAV(1448)/1/
      DATA INLONG(1448)/'LOWER COEF OF DISPERSION CONFIDENCE LIMIT'/
C
      DATA INCASE(1449)/'UCDL'/
      DATA (INAME(1449,J),J=1,MAXSCL)/
     1'UPPE','    ','COEF','OF  ','DISP','CONF','LIMI','    '/
      DATA INFLAV(1449)/1/
      DATA INLONG(1449)/'UPPER COEF OF DISPERSION CONFIDENCE LIMIT'/
C
      DATA INCASE(1450)/'UCDL'/
      DATA (INAME(1450,J),J=1,MAXSCL)/
     1'UPPE','    ','COEF','DISP','CONF','LIMI','    ','    '/
      DATA INFLAV(1450)/1/
      DATA INLONG(1450)/'UPPER COEF OF DISPERSION CONFIDENCE LIMIT'/
C
      DATA INCASE(1451)/'1LCD'/
      DATA (INAME(1451,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','LOWE','COEF','DISP','CONF','LIMI'/
      DATA INFLAV(1451)/1/
      DATA INLONG(1451)/'ONE SIDED LOWER COEF OF DISP CONF LIMIT'/
C
      DATA INCASE(1452)/'1UCD'/
      DATA (INAME(1452,J),J=1,MAXSCL)/
     1'ONE ','    ','SIDE','UPPE','COEF','DISP','CONF','LIMI'/
      DATA INFLAV(1452)/1/
      DATA INLONG(1452)/'ONE SIDED UPPER COEF OF DISP CONF LIMIT'/
C
      DATA INCASE(1453)/'BPRO'/
      DATA (INAME(1453,J),J=1,MAXSCL)/
     1'BINO','    ','PROP','    ','    ','    ','    ','    '/
      DATA INFLAV(1453)/1/
      DATA INLONG(1453)/'BINOMIAL PROPORTION'/
C
      DATA INCASE(1454)/'1LCD'/
      DATA (INAME(1454,J),J=1,MAXSCL)/
     1'ONES','    ','LOWE','COEF','OF  ','DISP','CONF','LIMI'/
      DATA INFLAV(1454)/1/
      DATA INLONG(1454)/'ONE SIDED LOWER COEF OF DISP CONF LIMIT'/
C
      DATA INCASE(1455)/'1UCD'/
      DATA (INAME(1455,J),J=1,MAXSCL)/
     1'ONES','    ','UPPE','COEF','OF  ','DISP','CONF','LIMI'/
      DATA INFLAV(1455)/1/
      DATA INLONG(1455)/'ONE SIDED UPPER COEF OF DISP CONF LIMIT'/
C
      DATA INCASE(1456)/'DQDI'/
      DATA (INAME(1456,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','QUAR','COEF','OF  ','VARI','    '/
      DATA INFLAV(1456)/2/
      DATA INLONG(1456)/
     1     'DIFFERENCE OF QUARTILE COEFFICIENT OF DISPERSION'/
C
      DATA INCASE(1457)/'DQDI'/
      DATA (INAME(1457,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','COEF','OF  ','QUAR','VARI','    '/
      DATA INFLAV(1457)/2/
      DATA INLONG(1457)/
     1     'DIFFERENCE OF QUARTILE COEFFICIENT OF DISPERSION'/
C
      DATA INCASE(1458)/'DQDI'/
      DATA (INAME(1458,J),J=1,MAXSCL)/
     1'DIFF','    ','OF  ','COEF','OF  ','QUAR','DISP','    '/
      DATA INFLAV(1458)/2/
      DATA INLONG(1458)/
     1     'DIFFERENCE OF QUARTILE COEFFICIENT OF DISPERSION'/
C
      DATA INCASE(1459)/'QCDI'/
      DATA (INAME(1459,J),J=1,MAXSCL)/
     1'COEF','    ','OF  ','QUAR','DISP','    ','    ','    '/
      DATA INFLAV(1459)/1/
      DATA INLONG(1459)/'QUARTILE COEFFICIENT OF DISPERSION'/
C
      DATA INCASE(1460)/'QCDI'/
      DATA (INAME(1460,J),J=1,MAXSCL)/
     1'COEF','    ','OF  ','QUAR','VARI','    ','    ','    '/
      DATA INFLAV(1460)/1/
      DATA INLONG(1460)/'QUARTILE COEFFICIENT OF DISPERSION'/
C
      DATA INCASE(1461)/'QCDI'/
      DATA (INAME(1461,J),J=1,MAXSCL)/
     1'QUAR','    ','COEF','OF  ','VARI','    ','    ','    '/
      DATA INFLAV(1461)/1/
      DATA INLONG(1461)/'QUARTILE COEFFICIENT OF DISPERSION'/
C
      DATA INCASE(1462)/'LCDQ'/
      DATA (INAME(1462,J),J=1,MAXSCL)/
     1'LOWE','    ','COEF','OF  ','QUAR','DISP','CONF','LIMI'/
      DATA INFLAV(1462)/1/
      DATA INLONG(1462)/
     1     'LOWER COEF OF QUARTILE DISPERSION CONFIDENCE LIMIT'/
C
      DATA INCASE(1463)/'LCDQ'/
      DATA (INAME(1463,J),J=1,MAXSCL)/
     1'LOWE','    ','COEF','OF  ','QUAR','VARI','CONF','LIMI'/
      DATA INFLAV(1463)/1/
      DATA INLONG(1463)/
     1     'LOWER COEF OF QUARTILE DISPERSION CONFIDENCE LIMIT'/
C
      DATA INCASE(1464)/'LCDQ'/
      DATA (INAME(1464,J),J=1,MAXSCL)/
     1'LOWE','    ','COEF','QUAR','DISP','CONF','LIMI','    '/
      DATA INFLAV(1464)/1/
      DATA INLONG(1464)/
     1     'LOWER COEF OF QUARTILE DISPERSION CONFIDENCE LIMIT'/
C
      DATA INCASE(1465)/'LCDQ'/
      DATA (INAME(1465,J),J=1,MAXSCL)/
     1'LOWE','    ','COEF','QUAR','VARI','CONF','LIMI','    '/
      DATA INFLAV(1465)/1/
      DATA INLONG(1465)/
     1     'LOWER COEF OF QUARTILE DISPERSION CONFIDENCE LIMIT'/
C
      DATA INCASE(1466)/'LCDQ'/
      DATA (INAME(1466,J),J=1,MAXSCL)/
     1'LOWE','    ','QUAR','COEF','OF  ','DISP','CONF','LIMI'/
      DATA INFLAV(1466)/1/
      DATA INLONG(1466)/
     1     'LOWER COEF OF QUARTILE DISPERSION CONFIDENCE LIMIT'/
C
      DATA INCASE(1467)/'LCDQ'/
      DATA (INAME(1467,J),J=1,MAXSCL)/
     1'LOWE','    ','QUAR','COEF','OF  ','VARI','CONF','LIMI'/
      DATA INFLAV(1467)/1/
      DATA INLONG(1467)/
     1     'LOWER COEF OF QUARTILE DISPERSION CONFIDENCE LIMIT'/
C
      DATA INCASE(1468)/'UCDQ'/
      DATA (INAME(1468,J),J=1,MAXSCL)/
     1'UPPE','    ','COEF','OF  ','QUAR','DISP','CONF','LIMI'/
      DATA INFLAV(1468)/1/
      DATA INLONG(1468)/
     1     'UPPER COEF OF QUARTILE DISPERSION CONFIDENCE LIMIT'/
C
      DATA INCASE(1469)/'UCDQ'/
      DATA (INAME(1469,J),J=1,MAXSCL)/
     1'UPPE','    ','COEF','OF  ','QUAR','VARI','CONF','LIMI'/
      DATA INFLAV(1469)/1/
      DATA INLONG(1469)/
     1     'UPPER COEF OF QUARTILE DISPERSION CONFIDENCE LIMIT'/
C
      DATA INCASE(1470)/'UCDQ'/
      DATA (INAME(1470,J),J=1,MAXSCL)/
     1'UPPE','    ','COEF','QUAR','DISP','CONF','LIMI','    '/
      DATA INFLAV(1470)/1/
      DATA INLONG(1470)/
     1     'UPPER COEF OF QUARTILE DISPERSION CONFIDENCE LIMIT'/
C
      DATA INCASE(1471)/'UCDQ'/
      DATA (INAME(1471,J),J=1,MAXSCL)/
     1'UPPE','    ','COEF','QUAR','VARI','CONF','LIMI','    '/
      DATA INFLAV(1471)/1/
      DATA INLONG(1471)/
     1     'UPPER COEF OF QUARTILE DISPERSION CONFIDENCE LIMIT'/
C
      DATA INCASE(1472)/'UCDQ'/
      DATA (INAME(1472,J),J=1,MAXSCL)/
     1'UPPE','    ','QUAR','COEF','OF  ','DISP','CONF','LIMI'/
      DATA INFLAV(1472)/1/
      DATA INLONG(1472)/
     1     'UPPER COEF OF QUARTILE DISPERSION CONFIDENCE LIMIT'/
C
      DATA INCASE(1473)/'UCDQ'/
      DATA (INAME(1473,J),J=1,MAXSCL)/
     1'UPPE','    ','QUAR','COEF','OF  ','VARI','CONF','LIMI'/
      DATA INFLAV(1473)/1/
      DATA INLONG(1473)/
     1     'UPPER COEF OF QUARTILE DISPERSION CONFIDENCE LIMIT'/
C
      DATA INCASE(1474)/'BLSD'/
      DATA (INAME(1474,J),J=1,MAXSCL)/
     1'LOWE','    ','BONE','STAN','DEVI','CONF','LIMI','    '/
      DATA INFLAV(1474)/1/
      DATA INLONG(1474)/
     1     'LOWER BONETT STANDARD DEVIATION CONFIDENCE LIMIT'/
C
      DATA INCASE(1475)/'BLSD'/
      DATA (INAME(1475,J),J=1,MAXSCL)/
     1'LOWE','    ','BONE','STAN','DEVI','CONF','INTE','    '/
      DATA INFLAV(1475)/1/
      DATA INLONG(1475)/
     1     'LOWER BONETT STANDARD DEVIATION CONFIDENCE LIMIT'/
C
      DATA INCASE(1476)/'BLSD'/
      DATA (INAME(1476,J),J=1,MAXSCL)/
     1'LOWE','    ','BONE','SD  ','CONF','LIMI','    ','    '/
      DATA INFLAV(1476)/1/
      DATA INLONG(1476)/
     1     'LOWER BONETT STANDARD DEVIATION CONFIDENCE LIMIT'/
C
      DATA INCASE(1477)/'BLSD'/
      DATA (INAME(1477,J),J=1,MAXSCL)/
     1'LOWE','    ','BONE','SD  ','CONF','INTE','    ','    '/
      DATA INFLAV(1477)/1/
      DATA INLONG(1477)/
     1     'LOWER BONETT STANDARD DEVIATION CONFIDENCE LIMIT'/
C
      DATA INCASE(1478)/'BUSD'/
      DATA (INAME(1478,J),J=1,MAXSCL)/
     1'UPPE','    ','BONE','STAN','DEVI','CONF','LIMI','    '/
      DATA INFLAV(1478)/1/
      DATA INLONG(1478)/
     1     'UPPER BONETT STANDARD DEVIATION CONFIDENCE LIMIT'/
C
      DATA INCASE(1479)/'BUSD'/
      DATA (INAME(1479,J),J=1,MAXSCL)/
     1'UPPE','    ','BONE','STAN','DEVI','CONF','INTE','    '/
      DATA INFLAV(1479)/1/
      DATA INLONG(1479)/
     1     'UPPER BONETT STANDARD DEVIATION CONFIDENCE LIMIT'/
C
      DATA INCASE(1480)/'BUSD'/
      DATA (INAME(1480,J),J=1,MAXSCL)/
     1'UPPE','    ','BONE','SD  ','CONF','LIMI','    ','    '/
      DATA INFLAV(1480)/1/
      DATA INLONG(1480)/
     1     'UPPER BONETT STANDARD DEVIATION CONFIDENCE LIMIT'/
C
      DATA INCASE(1481)/'BUSD'/
      DATA (INAME(1481,J),J=1,MAXSCL)/
     1'UPPE','    ','BONE','SD  ','CONF','INTE','    ','    '/
      DATA INFLAV(1481)/1/
      DATA INLONG(1481)/
     1     'UPPER BONETT STANDARD DEVIATION CONFIDENCE LIMIT'/
C
      DATA INCASE(1482)/'PERC'/
      DATA (INAME(1482,J),J=1,MAXSCL)/
     1'PERC','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(1482)/1/
      DATA INLONG(1482)/'PERCENTILE'/
C
      DATA INCASE(1483)/'WCOV'/
      DATA (INAME(1483,J),J=1,MAXSCL)/
     1'WEIG','    ','COVA','    ','    ','    ','    ','    '/
      DATA INFLAV(1483)/3/
      DATA INLONG(1483)/'WEIGHTED COVARIANCE'/
C
      DATA INCASE(1484)/'WCOR'/
      DATA (INAME(1484,J),J=1,MAXSCL)/
     1'WEIG','    ','CORR','    ','    ','    ','    ','    '/
      DATA INFLAV(1484)/3/
      DATA INLONG(1484)/'WEIGHTED CORRELATION'/
C
      DATA INCASE(1485)/'GJCO'/
      DATA (INAME(1485,J),J=1,MAXSCL)/
     1'JACC','    ','SIMI','    ','    ','    ','    ','    '/
      DATA INFLAV(1485)/2/
      DATA INLONG(1485)/'JACCARD SIMILARITY'/
C
      DATA INCASE(1486)/'GJDI'/
      DATA (INAME(1486,J),J=1,MAXSCL)/
     1'JACC','    ','DIST','    ','    ','    ','    ','    '/
      DATA INFLAV(1486)/2/
      DATA INLONG(1486)/'JACCARD DISTANCE'/
C
      DATA INCASE(1487)/'HELC'/
      DATA (INAME(1487,J),J=1,MAXSCL)/
     1'HEDG','    ','G   ','LOWE','CONF','LIMI','    ','    '/
      DATA INFLAV(1487)/2/
      DATA INLONG(1487)/'HEDGES G LOWER CONFIDENCE LIMIT'/
C
      DATA INCASE(1488)/'HELC'/
      DATA (INAME(1488,J),J=1,MAXSCL)/
     1'HEDG','    ','G   ','LOWE','CONF','LEVE','    ','    '/
      DATA INFLAV(1488)/2/
      DATA INLONG(1488)/'HEDGES G LOWER CONFIDENCE LIMIT'/
C
      DATA INCASE(1489)/'HEUC'/
      DATA (INAME(1489,J),J=1,MAXSCL)/
     1'HEDG','    ','G   ','UPPE','CONF','LIMI','    ','    '/
      DATA INFLAV(1489)/2/
      DATA INLONG(1489)/'HEDGES G UPPER CONFIDENCE LIMIT'/
C
      DATA INCASE(1490)/'HEUC'/
      DATA (INAME(1490,J),J=1,MAXSCL)/
     1'HEDG','    ','G   ','UPPE','CONF','LEVE','    ','    '/
      DATA INFLAV(1490)/2/
      DATA INLONG(1490)/'HEDGES G UPPER CONFIDENCE LIMIT'/
C
      DATA INCASE(1491)/'HEDG'/
      DATA (INAME(1491,J),J=1,MAXSCL)/
     1'HEDG','    ','G   ','    ','    ','    ','    ','    '/
      DATA INFLAV(1491)/2/
      DATA INLONG(1491)/'HEDGES G'/
C
      DATA INCASE(1492)/'PDIS'/
      DATA (INAME(1492,J),J=1,MAXSCL)/
     1'PEAR','    ','DIST','    ','    ','    ','    ','    '/
      DATA INFLAV(1492)/2/
      DATA INLONG(1492)/'PEARSON DISTANCE'/
C
      DATA INCASE(1493)/'HDIS'/
      DATA (INAME(1493,J),J=1,MAXSCL)/
     1'HAMM','    ','DIST','    ','    ','    ','    ','    '/
      DATA INFLAV(1493)/2/
      DATA INLONG(1493)/'HAMMING DISTANCE'/
C
      DATA INCASE(1494)/'WCDI'/
      DATA (INAME(1494,J),J=1,MAXSCL)/
     1'WEIG','    ','COSI','DIST','    ','    ','    ','    '/
      DATA INFLAV(1494)/3/
      DATA INLONG(1494)/'WEIGHTED COSINE DISTANCE'/
C
      DATA INCASE(1495)/'CNDI'/
      DATA (INAME(1495,J),J=1,MAXSCL)/
     1'CANB','    ','DIST','    ','    ','    ','    ','    '/
      DATA INFLAV(1495)/2/
      DATA INLONG(1495)/'CANBERRA DISTANCE'/
C
      DATA INCASE(1496)/'CORR'/
      DATA (INAME(1496,J),J=1,MAXSCL)/
     1'CORR','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(1496)/2/
      DATA INLONG(1496)/'CORRELATION'/
C
      DATA INCASE(1497)/'ICCR'/
      DATA (INAME(1497,J),J=1,MAXSCL)/
     1'INTR','ACLA','CORR','    ','    ','    ','    ','    '/
      DATA INFLAV(1497)/2/
      DATA INLONG(1497)/'INTRACLASS CORRELATION'/
C
      DATA INCASE(1498)/'ICCR'/
      DATA (INAME(1498,J),J=1,MAXSCL)/
     1'INTR','    ','CLAS','CORR','    ','    ','    ','    '/
      DATA INFLAV(1498)/2/
      DATA INLONG(1498)/'INTRACLASS CORRELATION'/
C
      DATA INCASE(1499)/'INTC'/
      DATA (INAME(1499,J),J=1,MAXSCL)/
     1'INTE','    ','COUN','    ','    ','    ','    ','    '/
      DATA INFLAV(1499)/1/
      DATA INLONG(1499)/'INTERVAL COUNT'/
C
      DATA INCASE(1500)/'PSIM'/
      DATA (INAME(1500,J),J=1,MAXSCL)/
     1'PEAR','    ','SIMI','    ','    ','    ','    ','    '/
      DATA INFLAV(1500)/2/
      DATA INLONG(1500)/'PEARSON SIMILARITY'/
C
      DATA INCASE(1501)/'RSIM'/
      DATA (INAME(1501,J),J=1,MAXSCL)/
     1'SPEA','    ','SIMI','    ','    ','    ','    ','    '/
      DATA INFLAV(1501)/2/
      DATA INLONG(1501)/'SPEARMAN SIMILARITY'/
C
      DATA INCASE(1502)/'RDIS'/
      DATA (INAME(1502,J),J=1,MAXSCL)/
     1'SPEA','    ','DIST','    ','    ','    ','    ','    '/
      DATA INFLAV(1502)/2/
      DATA INLONG(1502)/'SPEARMAN DISSIMILARITY'/
C
      DATA INCASE(1503)/'KDIS'/
      DATA (INAME(1503,J),J=1,MAXSCL)/
     1'KEND','    ','TAU ','DIST','    ','    ','    ','    '/
      DATA INFLAV(1503)/2/
      DATA INLONG(1503)/'KENDALLS TAU DISSIMILARITY'/
C
      DATA INCASE(1504)/'TAUA'/
      DATA (INAME(1504,J),J=1,MAXSCL)/
     1'KEND','    ','TAU ','A   ','    ','    ','    ','    '/
      DATA INFLAV(1504)/2/
      DATA INLONG(1504)/'KENDALLS TAU A'/
C
      DATA INCASE(1505)/'WCSI'/
      DATA (INAME(1505,J),J=1,MAXSCL)/
     1'WEIG','    ','COSI','SIMI','    ','    ','    ','    '/
      DATA INFLAV(1505)/3/
      DATA INLONG(1505)/'WEIGHTED COSINE SIMILARITY'/
C
      DATA INCASE(1506)/'GCOR'/
      DATA (INAME(1506,J),J=1,MAXSCL)/
     1'GROU','    ','CORR','    ','    ','    ','    ','    '/
      DATA INFLAV(1506)/3/
      DATA INLONG(1506)/'GROUPED CORRELATION'/
C
      DATA INCASE(1507)/'PMEA'/
      DATA (INAME(1507,J),J=1,MAXSCL)/
     1'PYTH','    ','MEAN','    ','    ','    ','    ','    '/
      DATA INFLAV(1507)/1/
      DATA INLONG(1507)/'PYTHON MEAN'/
C
      DATA INCASE(1508)/'YOUD'/
      DATA (INAME(1508,J),J=1,MAXSCL)/
     1'YOUD','    ','INDE','    ','    ','    ','    ','    '/
      DATA INFLAV(1508)/2/
      DATA INLONG(1508)/'YOUDEN INDEX'/
C
      DATA INCASE(1509)/'SIQL'/
      DATA (INAME(1509,J),J=1,MAXSCL)/
     1'LOWE','    ','SEMI','INTE','RANG','    ','    ','    '/
      DATA INFLAV(1509)/1/
      DATA INLONG(1509)/'LOWER SEMI-INTERQUARTILE RANGE'/
C
      DATA INCASE(1510)/'SIQU'/
      DATA (INAME(1510,J),J=1,MAXSCL)/
     1'UPPE','    ','SEMI','INTE','RANG','    ','    ','    '/
      DATA INFLAV(1510)/1/
      DATA INLONG(1510)/'UPPER SEMI-INTERQUARTILE RANGE'/
C
      DATA INCASE(1511)/'YULQ'/
      DATA (INAME(1511,J),J=1,MAXSCL)/
     1'BINA','    ','GAMM','COEF','    ','    ','    ','    '/
      DATA INFLAV(1511)/2/
      DATA INLONG(1511)/'YULES Q'/
C
      DATA INCASE(1512)/'YULQ'/
      DATA (INAME(1512,J),J=1,MAXSCL)/
     1'KRUS','    ','GOOD','BINA','GAMM','COEF','    ','    '/
      DATA INFLAV(1512)/2/
      DATA INLONG(1512)/'YULES Q'/
C
      DATA INCASE(1513)/'YULY'/
      DATA (INAME(1513,J),J=1,MAXSCL)/
     1'YULE','    ','Y   ','    ','    ','    ','    ','    '/
      DATA INFLAV(1513)/2/
      DATA INLONG(1513)/'YULES Y'/
C
      DATA INCASE(1514)/'KTAU'/
      DATA (INAME(1514,J),J=1,MAXSCL)/
     1'GAMM','    ','CORR','COEF','    ','    ','    ','    '/
      DATA INFLAV(1514)/2/
      DATA INLONG(1514)/'GAMMA CORRELATION COEFFICIENT (KENDALL TAU)'/
C
      DATA INCASE(1515)/'KTAU'/
      DATA (INAME(1515,J),J=1,MAXSCL)/
     1'KRUS','    ','GOOD','GAMM','CORR','COEF','    ','    '/
      DATA INFLAV(1515)/2/
      DATA INLONG(1515)/'GAMMA CORRELATION COEFFICIENT (KENDALL TAU)'/
C
      DATA INCASE(1516)/'KTAB'/
      DATA (INAME(1516,J),J=1,MAXSCL)/
     1'KEND','    ','TAU ','B   ','    ','    ','    ','    '/
      DATA INFLAV(1516)/2/
      DATA INLONG(1516)/'KENDALLS TAU B'/
C
      DATA INCASE(1517)/'KTAC'/
      DATA (INAME(1517,J),J=1,MAXSCL)/
     1'KEND','    ','TAU ','C   ','    ','    ','    ','    '/
      DATA INFLAV(1517)/2/
      DATA INLONG(1517)/'KENDALLS TAU C'/
C
      DATA INCASE(1518)/'KTAU'/
      DATA (INAME(1518,J),J=1,MAXSCL)/
     1'KEND','    ','TAU ','    ','    ','    ','    ','    '/
      DATA INFLAV(1518)/2/
      DATA INLONG(1518)/'KENDALLS TAU'/
C
      DATA INCASE(1519)/'RMLL'/
      DATA (INAME(1519,J),J=1,MAXSCL)/
     1'RATI','    ','OF  ','MEAN','LOWE','CONF','INTE','    '/
      DATA INFLAV(1519)/2/
      DATA INLONG(1519)/'RATIO OF MEANS LOWER CONFIDENCE LIMIT'/
C
      DATA INCASE(1520)/'RMUL'/
      DATA (INAME(1520,J),J=1,MAXSCL)/
     1'RATI','    ','OF  ','MEAN','UPPE','CONF','LIMI','    '/
      DATA INFLAV(1520)/2/
      DATA INLONG(1520)/'RATIO OF MEANS UPPER CONFIDENCE LIMIT'/
C
      DATA INCASE(1521)/'RMUL'/
      DATA (INAME(1521,J),J=1,MAXSCL)/
     1'RATI','    ','OF  ','MEAN','UPPE','CONF','INTE','    '/
      DATA INFLAV(1521)/2/
      DATA INLONG(1521)/'RATIO OF MEANS UPPER CONFIDENCE LIMIT'/
C
      DATA INCASE(1522)/'RMEA'/
      DATA (INAME(1522,J),J=1,MAXSCL)/
     1'RATI','    ','OF  ','MEAN','    ','    ','    ','    '/
      DATA INFLAV(1522)/2/
      DATA INLONG(1522)/'RATIO OF MEANS'/
C
      DATA INCASE(1523)/'RSLL'/
      DATA (INAME(1523,J),J=1,MAXSCL)/
     1'RATI','    ','OF  ','SD  ','LOWE','CONF','LIMI','    '/
      DATA INFLAV(1523)/2/
      DATA INLONG(1523)/'RATIO OF SDS LOWER CONFIDENCE LIMIT'/
C
      DATA INCASE(1523)/'RATI'/
      DATA (INAME(1523,J),J=1,MAXSCL)/
     1'RATI','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(1523)/2/
      DATA INLONG(1523)/'RATIO'/
C
      DATA INCASE(1524)/'DCDF'/
      DATA (INAME(1524,J),J=1,MAXSCL)/
     1'DAVI','    ','TEST','CDF ','    ','    ','    ','    '/
      DATA INFLAV(1524)/1/
      DATA INLONG(1524)/'DAVID TEST CDF'/
C
      DATA INCASE(1525)/'DCDF'/
      DATA (INAME(1525,J),J=1,MAXSCL)/
     1'DAVI','    ','CDF ','    ','    ','    ','    ','    '/
      DATA INFLAV(1525)/1/
      DATA INLONG(1525)/'DAVID TEST CDF'/
C
      DATA INCASE(1526)/'DPVA'/
      DATA (INAME(1526,J),J=1,MAXSCL)/
     1'DAVI','    ','TEST','PVAL','    ','    ','    ','    '/
      DATA INFLAV(1526)/1/
      DATA INLONG(1526)/'DAVID TEST P-VALUE'/
C
      DATA INCASE(1527)/'DPVA'/
      DATA (INAME(1527,J),J=1,MAXSCL)/
     1'DAVI','    ','TEST','P   ','VALU','    ','    ','    '/
      DATA INFLAV(1527)/1/
      DATA INLONG(1527)/'DAVID TEST P-VALUE'/
C
      DATA INCASE(1528)/'DPVA'/
      DATA (INAME(1528,J),J=1,MAXSCL)/
     1'DAVI','    ','PVAL','    ','    ','    ','    ','    '/
      DATA INFLAV(1528)/1/
      DATA INLONG(1528)/'DAVID TEST P-VALUE'/
C
      DATA INCASE(1529)/'DPVA'/
      DATA (INAME(1529,J),J=1,MAXSCL)/
     1'DAVI','    ','P   ','VALU','    ','    ','    ','    '/
      DATA INFLAV(1529)/1/
      DATA INLONG(1529)/'DAVID TEST P-VALUE'/
C
      DATA INCASE(1530)/'DMNI'/
      DATA (INAME(1530,J),J=1,MAXSCL)/
     1'DAVI','    ','TEST','MINI','INDE','    ','    ','    '/
      DATA INFLAV(1530)/1/
      DATA INLONG(1530)/'DAVID TEST MINIMUM INDEX'/
C
      DATA INCASE(1531)/'DMNI'/
      DATA (INAME(1531,J),J=1,MAXSCL)/
     1'DAVI','    ','MINI','INDE','    ','    ','    ','    '/
      DATA INFLAV(1531)/1/
      DATA INLONG(1531)/'DAVID TEST MINIMUM INDEX'/
C
      DATA INCASE(1532)/'DMXI'/
      DATA (INAME(1532,J),J=1,MAXSCL)/
     1'DAVI','    ','TEST','MAXI','INDE','    ','    ','    '/
      DATA INFLAV(1532)/1/
      DATA INLONG(1532)/'DAVID TEST MAXIMUM INDEX'/
C
      DATA INCASE(1533)/'DMXI'/
      DATA (INAME(1533,J),J=1,MAXSCL)/
     1'DAVI','    ','MINI','INDE','    ','    ','    ','    '/
      DATA INFLAV(1533)/1/
      DATA INLONG(1533)/'DAVID TEST MAXIMUM INDEX'/
C
      DATA INCASE(1534)/'DACV'/
      DATA (INAME(1534,J),J=1,MAXSCL)/
     1'DAVI','    ','TEST','CRIT','VALU','    ','    ','    '/
      DATA INFLAV(1534)/1/
      DATA INLONG(1534)/'DAVID TEST CRITICAL VALUE'/
C
      DATA INCASE(1535)/'DACV'/
      DATA (INAME(1535,J),J=1,MAXSCL)/
     1'DAVI','    ','CRIT','VALU','    ','    ','    ','    '/
      DATA INFLAV(1535)/1/
      DATA INLONG(1535)/'DAVID TEST CRITICAL VALUE'/
C
      DATA INCASE(1536)/'DAVI'/
      DATA (INAME(1536,J),J=1,MAXSCL)/
     1'DAVI','    ','TEST','    ','    ','    ','    ','    '/
      DATA INFLAV(1536)/1/
      DATA INLONG(1536)/'DAVID TEST'/
C
      DATA INCASE(1537)/'DAVI'/
      DATA (INAME(1537,J),J=1,MAXSCL)/
     1'DAVI','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(1537)/1/
      DATA INLONG(1537)/'DAVID TEST'/
C
      DATA INCASE(1538)/'SOCD'/
      DATA (INAME(1538,J),J=1,MAXSCL)/
     1'SKEW','    ','OUTL','CDF ','    ','    ','    ','    '/
      DATA INFLAV(1538)/1/
      DATA INLONG(1538)/'SKEWNESS OUTLIER TEST CDF'/
C
      DATA INCASE(1539)/'SOCD'/
      DATA (INAME(1539,J),J=1,MAXSCL)/
     1'SKEW','    ','OUTL','TEST','CDF ','    ','    ','    '/
      DATA INFLAV(1539)/1/
      DATA INLONG(1539)/'SKEWNESS OUTLIER TEST CDF'/
C
      DATA INCASE(1540)/'SOCV'/
      DATA (INAME(1540,J),J=1,MAXSCL)/
     1'SKEW','    ','OUTL','CRIT','VALU','    ','    ','    '/
      DATA INFLAV(1540)/1/
      DATA INLONG(1540)/'SKEWNESS OUTLIER TEST CRITICAL VALUE'/
C
      DATA INCASE(1541)/'SOCV'/
      DATA (INAME(1541,J),J=1,MAXSCL)/
     1'SKEW','    ','OUTL','TEST','CRIT','VALU','    ','    '/
      DATA INFLAV(1541)/1/
      DATA INLONG(1541)/'SKEWNESS OUTLIER TEST CDF'/
C
      DATA INCASE(1542)/'SOIN'/
      DATA (INAME(1542,J),J=1,MAXSCL)/
     1'SKEW','    ','OUTL','INDE','    ','    ','    ','    '/
      DATA INFLAV(1542)/1/
      DATA INLONG(1542)/'SKEWNESS OUTLIER TEST INDEX'/
C
      DATA INCASE(1543)/'SOIN'/
      DATA (INAME(1543,J),J=1,MAXSCL)/
     1'SKEW','    ','OUTL','TEST','INDE','    ','    ','    '/
      DATA INFLAV(1543)/1/
      DATA INLONG(1543)/'SKEWNESS OUTLIER TEST INDEX'/
C
      DATA INCASE(1544)/'SOPV'/
      DATA (INAME(1544,J),J=1,MAXSCL)/
     1'SKEW','    ','OUTL','PVAL','    ','    ','    ','    '/
      DATA INFLAV(1544)/1/
      DATA INLONG(1544)/'SKEWNESS OUTLIER TEST PVALUE'/
C
      DATA INCASE(1545)/'SOUT'/
      DATA (INAME(1545,J),J=1,MAXSCL)/
     1'SKEW','    ','OUTL','TEST','    ','    ','    ','    '/
      DATA INFLAV(1545)/1/
      DATA INLONG(1545)/'SKEWNESS OUTLIER TEST'/
C
      DATA INCASE(1546)/'SOUT'/
      DATA (INAME(1546,J),J=1,MAXSCL)/
     1'SKEW','    ','OUTL','    ','    ','    ','    ','    '/
      DATA INFLAV(1546)/1/
      DATA INLONG(1546)/'SKEWNESS OUTLIER TEST'/
C
      DATA INCASE(1547)/'SKEW'/
      DATA (INAME(1547,J),J=1,MAXSCL)/
     1'SKEW','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(1547)/1/
      DATA INLONG(1547)/'SKEWNESS'/
C
      DATA INCASE(1548)/'KOCD'/
      DATA (INAME(1548,J),J=1,MAXSCL)/
     1'KURT','    ','OUTL','CDF ','    ','    ','    ','    '/
      DATA INFLAV(1548)/1/
      DATA INLONG(1548)/'KURTOSIS OUTLIER TEST CDF'/
C
      DATA INCASE(1549)/'KOCD'/
      DATA (INAME(1549,J),J=1,MAXSCL)/
     1'KURT','    ','OUTL','TEST','CDF ','    ','    ','    '/
      DATA INFLAV(1549)/1/
      DATA INLONG(1549)/'KURTOSIS OUTLIER TEST CDF'/
C
      DATA INCASE(1550)/'KOCV'/
      DATA (INAME(1550,J),J=1,MAXSCL)/
     1'KURT','    ','OUTL','CRIT','VALU','    ','    ','    '/
      DATA INFLAV(1550)/1/
      DATA INLONG(1550)/'KURTOSIS OUTLIER TEST CRITICAL VALUE'/
C
      DATA INCASE(1551)/'KOCV'/
      DATA (INAME(1551,J),J=1,MAXSCL)/
     1'KURT','    ','OUTL','TEST','CRIT','VALU','    ','    '/
      DATA INFLAV(1551)/1/
      DATA INLONG(1551)/'KURTOSIS OUTLIER TEST CDF'/
C
      DATA INCASE(1552)/'KOIN'/
      DATA (INAME(1552,J),J=1,MAXSCL)/
     1'KURT','    ','OUTL','INDE','    ','    ','    ','    '/
      DATA INFLAV(1552)/1/
      DATA INLONG(1552)/'KURTOSIS OUTLIER TEST INDEX'/
C
      DATA INCASE(1553)/'KOIN'/
      DATA (INAME(1553,J),J=1,MAXSCL)/
     1'KURT','    ','OUTL','TEST','INDE','    ','    ','    '/
      DATA INFLAV(1553)/1/
      DATA INLONG(1553)/'KURTOSIS OUTLIER TEST INDEX'/
C
      DATA INCASE(1554)/'KOPV'/
      DATA (INAME(1554,J),J=1,MAXSCL)/
     1'KURT','    ','OUTL','PVAL','    ','    ','    ','    '/
      DATA INFLAV(1554)/1/
      DATA INLONG(1554)/'KURTOSIS OUTLIER TEST PVALUE'/
C
      DATA INCASE(1555)/'KOUT'/
      DATA (INAME(1555,J),J=1,MAXSCL)/
     1'KURT','    ','OUTL','TEST','    ','    ','    ','    '/
      DATA INFLAV(1555)/1/
      DATA INLONG(1555)/'KURTOSIS OUTLIER TEST'/
C
      DATA INCASE(1556)/'KOUT'/
      DATA (INAME(1556,J),J=1,MAXSCL)/
     1'KURT','    ','OUTL','    ','    ','    ','    ','    '/
      DATA INFLAV(1556)/1/
      DATA INLONG(1556)/'KURTOSIS OUTLIER TEST'/
C
      DATA INCASE(1557)/'KURT'/
      DATA (INAME(1557,J),J=1,MAXSCL)/
     1'KURT','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(1557)/1/
      DATA INLONG(1557)/'KURTOSIS'/
C
      DATA INCASE(1558)/'SEME'/
      DATA (INAME(1558,J),J=1,MAXSCL)/
     1'SHAN','    ','ENTR','MEAN','    ','    ','    ','    '/
      DATA INFLAV(1558)/1/
      DATA INLONG(1558)/'SHANNON ENTROPY MEAN'/
C
      DATA INCASE(1559)/'SEVA'/
      DATA (INAME(1559,J),J=1,MAXSCL)/
     1'SHAN','    ','ENTR','VARI','    ','    ','    ','    '/
      DATA INFLAV(1559)/1/
      DATA INLONG(1559)/'SHANNON ENTROPY VARIANCE'/
C
      DATA INCASE(1560)/'SESD'/
      DATA (INAME(1560,J),J=1,MAXSCL)/
     1'SHAN','    ','ENTR','SD  ','    ','    ','    ','    '/
      DATA INFLAV(1560)/1/
      DATA INLONG(1560)/'SHANNON ENTROPY STANDARD DEVIATION'/
C
      DATA INCASE(1561)/'SESD'/
      DATA (INAME(1561,J),J=1,MAXSCL)/
     1'SHAN','    ','ENTR','STAN','DEVI','    ','    ','    '/
      DATA INFLAV(1561)/1/
      DATA INLONG(1561)/'SHANNON ENTROPY STANDARD DEVIATION'/
C
      DATA INCASE(1562)/'SENT'/
      DATA (INAME(1562,J),J=1,MAXSCL)/
     1'SHAN','    ','ENTR','    ','    ','    ','    ','    '/
      DATA INFLAV(1562)/1/
      DATA INLONG(1562)/'SHANNON ENTROPY'/
C
      DATA INCASE(1563)/'LPSE'/
      DATA (INAME(1563,J),J=1,MAXSCL)/
     1'LINE','    ','POOL','STAN','ERRO','    ','    ','    '/
      DATA INFLAV(1563)/2/
      DATA INLONG(1563)/'LINEAR POOL STANDARD ERROR'/
C
      DATA INCASE(1564)/'LPOO'/
      DATA (INAME(1564,J),J=1,MAXSCL)/
     1'LINE','    ','POOL','    ','    ','    ','    ','    '/
      DATA INFLAV(1564)/2/
      DATA INLONG(1564)/'LINEAR POOL'/
C
      DATA INCASE(1565)/'LPSE'/
      DATA (INAME(1565,J),J=1,MAXSCL)/
     1'SUMM','    ','LINE','POOL','STAN','ERRO','    ','    '/
      DATA INFLAV(1565)/3/
      DATA INLONG(1565)/'SUMMARY LINEAR POOL STANDARD ERROR'/
C
      DATA INCASE(1566)/'LPOO'/
      DATA (INAME(1566,J),J=1,MAXSCL)/
     1'SUMM','    ','LINE','POOL','    ','    ','    ','    '/
      DATA INFLAV(1566)/3/
      DATA INLONG(1566)/'LINEAR POOL'/
C
      DATA INCASE(1567)/'SGCD'/
      DATA (INAME(1567,J),J=1,MAXSCL)/
     1'SIEG','    ','TUKE','TEST','CDF ','    ','    ','    '/
      DATA INFLAV(1567)/2/
      DATA INLONG(1567)/'SIEGEL TUKEY TEST CDF'/
C
      DATA INCASE(1568)/'SG2P'/
      DATA (INAME(1568,J),J=1,MAXSCL)/
     1'SIEG','    ','TUKE','TEST','PVAL','    ','    ','    '/
      DATA INFLAV(1568)/2/
      DATA INLONG(1568)/'SIEGEL TUKEY TEST PVALUE'/
C
      DATA INCASE(1569)/'SGLP'/
      DATA (INAME(1569,J),J=1,MAXSCL)/
     1'SIEG','    ','TUKE','TEST','LOWE','TAIL','PVAL','    '/
      DATA INFLAV(1569)/2/
      DATA INLONG(1569)/'SIEGEL TUKEY TEST LOWER TAIL PVALUE'/
C
      DATA INCASE(1570)/'SGUP'/
      DATA (INAME(1570,J),J=1,MAXSCL)/
     1'SIEG','    ','TUKE','TEST','UPPE','TAIL','PVAL','    '/
      DATA INFLAV(1570)/2/
      DATA INLONG(1570)/'SIEGEL TUKEY TEST UPPER TAIL PVALUE'/
C
      DATA INCASE(1571)/'SGTE'/
      DATA (INAME(1571,J),J=1,MAXSCL)/
     1'SIEG','    ','TUKE','TEST','    ','    ','    ','    '/
      DATA INFLAV(1571)/2/
      DATA INLONG(1571)/'SIEGEL TUKEY TEST'/
C
      DATA INCASE(1572)/'RSLL'/
      DATA (INAME(1572,J),J=1,MAXSCL)/
     1'RATI','    ','OF  ','SD  ','LOWE','CONF','INTE','    '/
      DATA INFLAV(1572)/2/
      DATA INLONG(1572)/'RATIO OF SD LOWER CONFIDENCE LIMIT'/
C
      DATA INCASE(1573)/'RSLL'/
      DATA (INAME(1573,J),J=1,MAXSCL)/
     1'RATI','    ','OF  ','STAN','DEVI','LOWE','CONF','LIMI'/
      DATA INFLAV(1573)/2/
      DATA INLONG(1573)/'RATIO OF SD LOWER CONFIDENCE LIMIT'/
C
      DATA INCASE(1574)/'RSLL'/
      DATA (INAME(1574,J),J=1,MAXSCL)/
     1'RATI','    ','OF  ','STAN','DEVI','LOWE','CONF','INTE'/
      DATA INFLAV(1574)/2/
      DATA INLONG(1574)/'RATIO OF SD LOWER CONFIDENCE LIMIT'/
C
      DATA INCASE(1575)/'RSUL'/
      DATA (INAME(1575,J),J=1,MAXSCL)/
     1'RATI','    ','OF  ','SD  ','UPPE','CONF','LIMI','    '/
      DATA INFLAV(1575)/2/
      DATA INLONG(1575)/'RATIO OF SD UPPER CONFIDENCE LIMIT'/
C
      DATA INCASE(1576)/'RSUL'/
      DATA (INAME(1576,J),J=1,MAXSCL)/
     1'RATI','    ','OF  ','SD  ','UPPE','CONF','INTE','    '/
      DATA INFLAV(1576)/2/
      DATA INLONG(1576)/'RATIO OF SD UPPE CONFIDENCE LIMIT'/
C
      DATA INCASE(1577)/'RSUL'/
      DATA (INAME(1577,J),J=1,MAXSCL)/
     1'RATI','    ','OF  ','SD  ','UPPE','CONF','INTE','    '/
      DATA INFLAV(1577)/2/
      DATA INLONG(1577)/'RATIO OF SD UPPER CONFIDENCE LIMIT'/
C
      DATA INCASE(1578)/'RSUL'/
      DATA (INAME(1578,J),J=1,MAXSCL)/
     1'RATI','    ','OF  ','STAN','DEVI','UPPE','CONF','LIMI'/
      DATA INFLAV(1578)/2/
      DATA INLONG(1578)/'RATIO OF SD UPPER CONFIDENCE LIMIT'/
C
      DATA INCASE(1579)/'RSUL'/
      DATA (INAME(1579,J),J=1,MAXSCL)/
     1'RATI','    ','OF  ','STAN','DEVI','UPPE','CONF','INTE'/
      DATA INFLAV(1579)/2/
      DATA INLONG(1579)/'RATIO OF SD UPPER CONFIDENCE LIMIT'/
C
C-----START POINT-----------------------------------------------------
C
      DATA INCASE(1580)/'RVUL'/
      DATA (INAME(1580,J),J=1,MAXSCL)/
     1'RATI','    ','OF  ','VARI','UPPE','CONF','LIMI','    '/
      DATA INFLAV(1580)/2/
      DATA INLONG(1580)/'RATIO OF VARIANCE UPPER CONFIDENCE LIMIT'/
C
      DATA INCASE(1581)/'RVUL'/
      DATA (INAME(1581,J),J=1,MAXSCL)/
     1'RATI','    ','OF  ','VARI','UPPE','CONF','INTE','    '/
      DATA INFLAV(1581)/2/
      DATA INLONG(1581)/'RATIO OF VARIANCE UPPER CONFIDENCE LIMIT'/
C
      DATA INCASE(1582)/'RVLL'/
      DATA (INAME(1582,J),J=1,MAXSCL)/
     1'RATI','    ','OF  ','VARI','LOWE','CONF','LIMI','    '/
      DATA INFLAV(1582)/2/
      DATA INLONG(1582)/'RATIO OF VARIANCE LOWER CONFIDENCE LIMIT'/
C
      DATA INCASE(1583)/'RVLL'/
      DATA (INAME(1583,J),J=1,MAXSCL)/
     1'RATI','    ','OF  ','VARI','LOWE','CONF','INTE','    '/
      DATA INFLAV(1583)/2/
      DATA INLONG(1583)/'RATIO OF VARIANCE LOWE CONFIDENCE LIMIT'/
C
      DATA INCASE(1584)/'RATI'/
      DATA (INAME(1584,J),J=1,MAXSCL)/
     1'RATI','    ','    ','    ','    ','    ','    ','    '/
      DATA INFLAV(1584)/2/
      DATA INLONG(1584)/'RATIO'/
C
      DATA INCASE(1585)/'GMDR'/
      DATA (INAME(1585,J),J=1,MAXSCL)/
     1'GINI','    ','MEAN','DIFF','LOG ','RATI','    ','    '/
      DATA INFLAV(1585)/2/
      DATA INLONG(1585)/'GINI MEAN DIFFERENCE LOG RATIO'/
C
      DATA INCASE(1586)/'GMD '/
      DATA (INAME(1586,J),J=1,MAXSCL)/
     1'GINI','    ','MEAN','DIFF','    ','    ','    ','    '/
      DATA INFLAV(1586)/1/
      DATA INLONG(1586)/'GINI MEAN DIFFERENCE'/
C
      ISUBN1='EXTS'
      ISUBN2='TA  '
      IWRITE='OFF'
      ISUBN1='EXTS'
      ISUBN2='TA  '
      IWRITE='OFF'
      IFOUND='NO'
      IERROR='NO'
C
      IF(IBUGG3.EQ.'ON'.OR.ISUBRO.EQ.'TSTA')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,51)
   51   FORMAT('***** AT THE BEGINNING OF EXTSTA--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,52)IBUGG3,ISUBRO,NUMARG,JMIN,JMAX
   52   FORMAT('IBUGG3,ISUBRO,NUMARG,JMIN,JMAX = ',A4,2X,A4,3I8)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,53)ICOM,ICOM2
   53   FORMAT('ICOM,ICOM2 = ',A4,2X,A4)
        CALL DPWRST('XXX','BUG ')
        IF(NUMARG.GE.1)THEN
          DO60I=1,NUMARG
            WRITE(ICOUT,61)I,IHARG(I),IHARG2(I)
   61       FORMAT('I,IHARG(I),IHARG2(I) = ',I8,2X,A4,2X,A4)
            CALL DPWRST('XXX','BUG ')
   60     CONTINUE
        ENDIF
        WRITE(ICOUT,63)MAXSTA,MAXSCL
   63   FORMAT('MAXSTA,MAXSCL = ',2I8)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
C     STEP 1: INITIALIZE THE MATCHING VARIABLE
C
      DO1010I=1,MAXSCL
        INTEMP(I)='    '
 1010 CONTINUE
      IF(JMIN.EQ.0)THEN
        INTEMP(1)=ICOM
        INTEMP(2)=ICOM2
        ICNT=2
        IF(JMIN.LT.JMAX)THEN
          DO1020I=JMIN+1,JMAX
            ICNT=ICNT+1
            INTEMP(ICNT)=IHARG(I)
 1020     CONTINUE
        ENDIF
C
        IF(IBUGG3.EQ.'ON'.OR.ISUBRO.EQ.'TSTA')THEN
           WRITE(ICOUT,999)
           CALL DPWRST('XXX','BUG ')
           WRITE(ICOUT,1021)ICNT
 1021      FORMAT('JMIN = 0 CASE, ICNT = ',I8)
           CALL DPWRST('XXX','BUG ')
           DO1022II=1,ICNT
             WRITE(ICOUT,1023)II,INTEMP(II)
 1023        FORMAT('II,INTEMP(II) = ',I8,A4)
             CALL DPWRST('XXX','BUG ')
 1022      CONTINUE
        ENDIF
C
      ELSE
        INTEMP(1)=IHARG(JMIN)
        INTEMP(2)=IHARG2(JMIN)
        ICNT=2
        IF(JMAX.GT.JMIN)THEN
          DO1030I=JMIN+1,JMAX
            ICNT=ICNT+1
            INTEMP(ICNT)=IHARG(I)
 1030     CONTINUE
        ENDIF
C
        IF(IBUGG3.EQ.'ON'.OR.ISUBRO.EQ.'TSTA')THEN
           WRITE(ICOUT,999)
           CALL DPWRST('XXX','BUG ')
           WRITE(ICOUT,1031)ICNT
 1031      FORMAT('JMIN > 0 CASE, ICNT = ',I8)
           CALL DPWRST('XXX','BUG ')
           DO1032II=1,ICNT
             WRITE(ICOUT,1033)II,INTEMP(II)
 1033        FORMAT('II,INTEMP(II) = ',I8,A4)
             CALL DPWRST('XXX','BUG ')
 1032      CONTINUE
        ENDIF
C
      ENDIF
C
C     STEP 1A: CHECK FOR "QUANTILE" OR "PERCENTILE" AS SECOND
C              ARGUMENT (INTEMP(3)).  IF SO, SAVE THE PARAMETER
C              NAME IN A COMMON BLOCK (IF ARGUMENT TYPE IS
C              NUMERIC, SAVE THE VALUE).
C
      IPNAM1='    '
      IPNAM2='    '
      APVAL=CPUMIN
      IFLAGQ=0
      IF((INTEMP(3).EQ.'QUAN' .OR. INTEMP(3).EQ.'PERC' ).AND.
     1   INTEMP(1).NE.'Q   ' .AND. INTEMP(1).NE.'BOOT' .AND.
     1   INTEMP(1).NE.'JACK')THEN
        IF(IARGT(JMIN).EQ.'NUMB')THEN
          APVAL=ARG(JMIN)
        ELSE
          IPNAM1=INTEMP(1)
          IPNAM2=INTEMP(2)
        ENDIF
        INTEMP(1)=INTEMP(3)
        INTEMP(2)='    '
        DO1090I=3,MAXSCL-1
          INTEMP(I)=INTEMP(I+1)
 1090   CONTINUE
        INTEMP(MAXSCL)='    '
        IFLAGQ=1
      ENDIF
C
C     STEP 2: NOW CHECK IF MATCHING VARIABLE MATCHES AN ENTRY
C             IN THE TABLE.  NOTE THAT WE NEED TO CHECK FOR
C             NAME CONFLICTS IN FIRST 4 CHARACTERS OF FIRST
C             ARGUMENT.
C
      DO2000I=1,MAXSTA
        IROW=I
        IF(INAME(I,1).NE.INTEMP(1))GOTO2000
C
        IF(IBUGG3.EQ.'ON'.OR.ISUBRO.EQ.'TSTA')THEN
           WRITE(ICOUT,999)
           CALL DPWRST('XXX','BUG ')
           WRITE(ICOUT,2001)I,INAME(I,1),INTEMP(1)
 2001      FORMAT('I,INAME(I,1),INTEMP(1) = ',I8,2X,A4,2X,A4)
           CALL DPWRST('XXX','BUG ')
        ENDIF
C
C       FIRST 4 CHARACTERS MATCHED.  NEED TO CHECK IF CHARACTERS
C       5-8 MATCH FOR CERTAIN CASES.
C
        IF(INAME(I,2).NE.'    ')THEN
          IF(INAME(I,2).NE.INTEMP(2))GOTO2000
        ENDIF
C
C       NOW CHECK IF REMAINING ARGUMENTS MATCH
C
        ITEMP=1
        DO2022J=3,MAXSCL
          IF(INAME(IROW,J).NE.'    ')GOTO2022
            ITEMP=J-1
            GOTO2024
 2022   CONTINUE
        ITEMP=MAXSCL
 2024   CONTINUE
C
        IF(IBUGG3.EQ.'ON'.OR.ISUBRO.EQ.'TSTA')THEN
           WRITE(ICOUT,2027)IROW,ITEMP
 2027      FORMAT('IROW,ITEMP = ',2I8)
           CALL DPWRST('XXX','BUG ')
        ENDIF
C
        IF(ITEMP.GT.2)THEN
          DO2028J=3,ITEMP
            IF(INAME(IROW,J).NE.INTEMP(J))GOTO2000
 2028     CONTINUE
        ENDIF
C
        IFOUND='YES'
        IF(ITEMP.EQ.1)THEN
          ILOCV=JMIN+1
        ELSE
          ILOCV=JMIN+(ITEMP-2)+1
        ENDIF
        IF(IFLAGQ.EQ.1)ILOCV=ILOCV+1
        ISTACS=INCASE(IROW)
        ISTANR=INFLAV(IROW)
        ISTANM=INLONG(IROW)
        ISTADF='OFF'
        IF(INTEMP(1).EQ.'DIFF')ISTADF='ON'
        GOTO2099
C
 2000 CONTINUE
C
C     2016/08: IF NO MATCH FOUND, CHECK FOR "STATISTIC BLOCK".
C
      IF(IBUGG3.EQ.'ON'.OR.ISUBRO.EQ.'TSTA')THEN
        WRITE(ICOUT,2101)
 2101   FORMAT('AFTER CHECK PRE-DEFINED STATISTICS')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,2103)ISBNA1
 2103   FORMAT('ISBNA1 = ',A8)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,2105)ISBNA2
 2105   FORMAT('ISBNA2 = ',A8)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,2107)ISBNA3
 2107   FORMAT('ISBNA3 = ',A8)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,2109)INTEMP(1),INTEMP(2)
 2109   FORMAT('INTEMP(1),INTEMP(2) = ',A4,2X,A4)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
      IF(INTEMP(1).EQ.ISBNA1(1:4).AND.INTEMP(2).EQ.ISBNA1(5:8))THEN
        IFOUND='YES'
        ILOCV=JMIN+1
        ISTACS='SBL1'
        ISTANR=ISBCP1
        ISTANM='STATISTIC BLOCK ONE'
        ISTADF='OFF'
      ELSEIF(INTEMP(1).EQ.ISBNA2(1:4).AND.INTEMP(2).EQ.ISBNA2(5:8))THEN
        IFOUND='YES'
        ILOCV=JMIN+1
        ISTACS='SBL2'
        ISTANR=ISBCP1
        ISTANM='STATISTIC BLOCK TWO'
        ISTADF='OFF'
      ELSEIF(INTEMP(1).EQ.ISBNA3(1:4).AND.INTEMP(2).EQ.ISBNA3(5:8))THEN
        IFOUND='YES'
        ILOCV=JMIN+1
        ISTACS='SBL3'
        ISTANR=ISBCP3
        ISTANM='STATISTIC BLOCK THREE'
        ISTADF='OFF'
      ENDIF
C
 2099 CONTINUE
C
C               ******************
C               **   STEP 90--  **
C               **   EXIT       **
C               ******************
C
      IF(IBUGG3.EQ.'ON'.OR.ISUBRO.EQ.'TSTA')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9011)
 9011   FORMAT('***** AT THE END       OF EXTSTA--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9012)IBUGG3,ISUBRO,IFOUND
 9012   FORMAT('IBUGG3,ISUBRO,IFOUND = ',A4,2X,A4,2X,A4)
        CALL DPWRST('XXX','BUG ')
        IF(IFOUND.EQ.'YES')THEN
          WRITE(ICOUT,9013)ISTACS,ISTADF,ISTANR,ILOCV
 9013     FORMAT('ISTACS,ISTADF,ISTANR,ILOCV = ',A4,2X,A4,2X,2I8)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,9014)ISTANM
 9014     FORMAT('ISTANM = ',A60)
          CALL DPWRST('XXX','BUG ')
        ENDIF
      ENDIF
C
      RETURN
      END
      SUBROUTINE EXTSTR(IHARG,IHARG2,NUMARG,JMIN,JMAX,MAXIND,
     1                  IHNAME,IHNAM2,IUSE,NUMNAM,
     1                  ISTRN1,ISTRN2,NUMSTR,
     1                  IWRITE,IBUGA2,ISUBRO,IERROR)
C
C     PURPOSE--EXAMINE IHARG(.) AND IHARG2(.) FROM JMIN TO JMAX, EXTRACT
C              ALL NAMES (INCLUDING THOSE IMPLIED BY A   TO   KEYWORD)
C              AND PLACE THESE NAMES IN ISTRN1(.) AND ISTRN2(.).
C              NOTE THE NUMBER OF SUCH NAMES AND PLACE IT IN NUMSTR.
C              NUMSTR STANDS FOR NUMBER OF STRINGS.
C     NOTE--JMIN   = START POINT IN IHARG/IHARG2 FOR THE SCAN
C           JMAX   = STOP POINT  IN IHARG/IHARG2 FOR THE SCAN
C           MAXIND = MAXIMUM PERMITTED NUMBER OF STRINGS
C     NOTE--THIS SUBROUTINE ALSO CHECKS TO MAKE SURE THE LIST ITEMS ARE
C           IN FACT STRINGS (AS OPPOSED TO PARAMETERS, VARIABLES,
C           MATRICES, OR UNKNOWNS).
C     OUTPUT--ISTRN1(.), ISTRN2(.), AND NUMSTR.
C     ORIGINAL VERSION--JANUARY   2006.
C     UPDATED         --JULY      2009. ALLOW "Y1 TO Y1" (USEFUL FOR
C                                       MACROS WHERE NUMBER OF STRINGS
C                                       IS NOT KNOWN IN ADVANCE)
C
C---------------------------------------------------------------------
C
      DIMENSION IHARG(*)
      DIMENSION IHARG2(*)
      DIMENSION IHNAME(*)
      DIMENSION IHNAM2(*)
      DIMENSION IUSE(*)
      DIMENSION ISTRN1(*)
      DIMENSION ISTRN2(*)
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 IHARG
      CHARACTER*4 IHARG2
      CHARACTER*4 IHNAME
      CHARACTER*4 IHNAM2
      CHARACTER*4 IUSE
      CHARACTER*4 ISTRN1
      CHARACTER*4 ISTRN2
      CHARACTER*4 IWRITE
      CHARACTER*4 IBUGA2
      CHARACTER*4 ISUBRO
      CHARACTER*4 IERROR
C
      CHARACTER*4 IH1
      CHARACTER*4 IH2
      CHARACTER*4 ICASTO
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      NUMSTR=0
      JM1=0
C
      IF(IBUGA2.EQ.'ON'.OR.ISUBRO.EQ.'TSTR')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,51)
   51   FORMAT('***** AT THE BEGINNING OF EXTSTR--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,53)IBUGA2,ISUBRO
   53   FORMAT('IBUGA2,ISUBRO = ',A4,2X,A4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,54)JMIN,JMAX,MAXIND,NUMSTR,NUMARG,NUMNAM
   54   FORMAT('JMIN,JMAX,MAXIND,NUMSTR,NUMARG,NUMNAM = ',5I6)
        CALL DPWRST('XXX','BUG ')
        DO62I=1,NUMARG
          WRITE(ICOUT,63)I,IHARG(I),IHARG2(I)
   63     FORMAT('I,IHARG(I),IHARG2(I) = ',I8,2(2X,A4))
          CALL DPWRST('XXX','BUG ')
   62   CONTINUE
        DO72I=1,NUMNAM
          WRITE(ICOUT,73)I,IHNAME(I),IHNAM2(I),IUSE(I)
   73     FORMAT('I,IHNAME(I),IHNAM2(I),IUSE(I) = ',
     1           I8,2X,2A4,2X,A4,2I8,G15.7)
        CALL DPWRST('XXX','BUG ')
   72   CONTINUE
      ENDIF
C
      IISKIP=0
C
      DO1200J=JMIN,JMAX
C
        IF(IISKIP.EQ.1)THEN
          IISKIP=0
          GOTO1200
        ENDIF
C
        IH1=IHARG(J)
        IH2=IHARG2(J)
        ICASTO='OFF'
C
        IF(IH1.EQ.'TO  ')THEN
          ICASTO='ON'
          JM1=J-1
          JP1=J+1
          CALL DPEXTL(IHARG(JM1),IHARG2(JM1),IHARG(JP1),IHARG2(JP1),
     1                KNUMB,IVAL1,IVAL2,IBUGA2,ISUBRO,IERROR)
C
          IF(IVAL1.EQ.IVAL2)THEN
            IISKIP=1
            GOTO1200
          ENDIF
C
          IVA1P1=IVAL1+1
          IVA2M1=IVAL2-1
          IF(IVA1P1.GT.IVA2M1)GOTO1200
          IVAL=IVAL1
          IVAL=IVAL+1
          IF(IVAL.GE.IVAL2)GOTO1200
          CALL DPAPNU(IHARG(JM1),IHARG2(JM1),KNUMB,IVAL,
     1                IH1,IH2,IBUGA2,ISUBRO,IERROR)
        ENDIF
C
 1215   CONTINUE
C
        DO1300I=1,NUMNAM
          I2=I
          IF(IH1.EQ.IHNAME(I).AND.IH2.EQ.IHNAM2(I))THEN
            IF(IUSE(I).EQ.'V')GOTO1320
            IF(IUSE(I).EQ.'P')GOTO1320
            IF(IUSE(I).EQ.'M')GOTO1320
            IF(IUSE(I).EQ.'F')GOTO1310
          ENDIF
 1300   CONTINUE
        GOTO1320
C
 1310   CONTINUE
        NUMSTR=NUMSTR+1
        IF(NUMSTR.GT.MAXIND)THEN
          WRITE(ICOUT,999)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,1331)
 1331     FORMAT('***** ERROR IN EXTSTR--')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,1332)
 1332     FORMAT('      THE NUMBER OF STRINGS PERMITTED HAS JUST')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,1334)MAXIND
 1334     FORMAT('      EXCEEDED THE ALLOWABLE MAXIMUM (',I8,')')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,1336)IH1,IH2
 1336     FORMAT('      THE STRING IN QUESTION WAS ',2A4,'   .')
          CALL DPWRST('XXX','BUG ')
          IERROR='YES'
          GOTO9000
        ENDIF
        ISTRN1(NUMSTR)=IH1
        ISTRN2(NUMSTR)=IH2
        GOTO1280
C
 1320   CONTINUE
        IF(IWRITE.EQ.'ON')THEN
          WRITE(ICOUT,999)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,1311)
 1311     FORMAT('***** ERROR IN EXTSTR--')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,1312)
 1312     FORMAT('      A NAME IN THE LIST OF STRINGS INCLUDED THE ',
     1           'NAME OF A')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,1315)
 1315     FORMAT('      NON-EXISTENT STRING OR A NON-STRING.')
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,1316)IH1,IH2
 1316     FORMAT('      THE NAME IN QUESTION WAS ',2A4,'   .')
          CALL DPWRST('XXX','BUG ')
        ENDIF
        IERROR='YES'
        GOTO9000
C
 1280   CONTINUE
        IF(ICASTO.EQ.'ON')THEN
          IVAL=IVAL+1
          IF(IVAL.GE.IVAL2)GOTO1200
          CALL DPAPNU(IHARG(JM1),IHARG2(JM1),KNUMB,IVAL,
     1                IH1,IH2,IBUGA2,ISUBRO,IERROR)
          GOTO1215
        ENDIF
C
 1200 CONTINUE
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT       **
C               *****************
C
 9000 CONTINUE
      IF(IBUGA2.EQ.'ON'.OR.ISUBRO.EQ.'TSTR')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9011)
 9011   FORMAT('***** AT THE END       OF EXTSTR--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9013)IBUGA2,ISUBRO
 9013   FORMAT('IBUGA2,ISUBRO = ',A4,2X,A4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9014)JMIN,JMAX,NUMSTR
 9014   FORMAT('JMIN,JMAX,NUMSTR = ',3I8)
        CALL DPWRST('XXX','BUG ')
        DO9042I=1,NUMSTR
          WRITE(ICOUT,9043)I,ISTRN1(I),ISTRN2(I)
 9043     FORMAT('I,ISTRN1(I),ISTRN2(I) = ',I8,2(2X,A4))
          CALL DPWRST('XXX','BUG ')
 9042   CONTINUE
      ENDIF
C
      RETURN
      END
      SUBROUTINE EXTVAR(IHARG,IHARG2,NUMARG,JMIN,JMAX,MAXIND,
     1IHNAME,IHNAM2,IUSE,NUMNAM,
     1IVARN1,IVARN2,NUMIND,IBUGA2,ISUBRO,IERROR)
C
C     PURPOSE--EXAMINE IHARG(.) AND IHARG2(.) FROM JMIN TO JMAX,
C              EXTRACT ALL NAMES
C              (INCLUDING THOSE IMPLIED BY A   TO   KEYWORD)
C              AND PLACE THESE NAMES IN IVARN1(.) AND IVARN2(.).
C              NOTE THE NUMBER OF SUCH NAMES AND PLACE IT IN NUMIND.
C              NUMIND STANDS FOR NUMBER OF INDEPENDENT VARIABLES
C              (NOT INCLUDING THE IMPLICIT UNITY VARIABLE).
C     NOTE--JMIN   = START POINT IN IHARG/IHARG2 FOR THE SCAN
C           JMAX   = STOP POINT  IN IHARG/IHARG2 FOR THE SCAN
C           MAXIND = MAXIMUM PERMITTED NUMBER OF VARIABLES
C     NOTE--THIS SUBROUTINE IS USED IN CONJUNCTION
C           WITH THE MULTI-LINEAR OPTION OF THE FIT COMMAND;
C           IT IS CALLED BY DPFIT.
C     NOTE--THIS SUBROUTINE ALSO CHECKS TO MAKE SURE THE
C           LIST ITEMS ARE IN FACT VARIABLES (AS OPPOSED
C           TO PARAMETERS, FUNCTIONS, MATRICES, OR
C           UNKNOWNS).
C     OUTPUT--IVARN1(.), IVARN2(.), AND NUMIND.
C     EXAMPLE--FIT Y X1 X2 X3
C              WOULD YIELD NUMIND = 3
C     EXAMPLE--FIT Y X1 TO X15
C              WOULD YIELD NUMIND = 15
C     EXAMPLE--FIT Y R1 R2 X5 TO X11 Z1 Z2
C              WOULD YIELD NUMIND = 11
C     ORIGINAL VERSION--JUNE      1989.
C     UPDATED         --JULY      1989. FIX FORMAT STATEMENT
C     UPDATED         --JULY      2009. ALLOW "Y1 TO Y1" (USEFUL FOR
C                                       MACROS WHERE NUMBER OF VARIABLES
C                                       NOT KNOWN IN ADVANCE)
C
C---------------------------------------------------------------------
C
      DIMENSION IHARG(*)
      DIMENSION IHARG2(*)
      DIMENSION IHNAME(*)
      DIMENSION IHNAM2(*)
      DIMENSION IUSE(*)
      DIMENSION IVARN1(*)
      DIMENSION IVARN2(*)
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 IHARG
      CHARACTER*4 IHARG2
      CHARACTER*4 IHNAME
      CHARACTER*4 IHNAM2
      CHARACTER*4 IUSE
      CHARACTER*4 IVARN1
      CHARACTER*4 IVARN2
      CHARACTER*4 IBUGA2
      CHARACTER*4 ISUBRO
      CHARACTER*4 IERROR
C
      CHARACTER*4 IH1
      CHARACTER*4 IH2
      CHARACTER*4 ICASTO
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOPA.INC'
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      NUMIND=0
      JM1=0
C
      IF(IBUGA2.EQ.'OFF'.AND.ISUBRO.NE.'TVAR')GOTO90
      WRITE(ICOUT,999)
  999 FORMAT(1X)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,51)
   51 FORMAT('***** AT THE BEGINNING OF EXTVAR--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,53)IBUGA2,ISUBRO
   53 FORMAT('IBUGA2,ISUBRO = ',A4,2X,A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,54)JMIN,JMAX,MAXIND,NUMIND
   54 FORMAT('JMIN,JMAX,MAXIND,NUMIND = ',4I8)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,61)NUMARG
   61 FORMAT('NUMARG = ',A4)
      CALL DPWRST('XXX','BUG ')
      DO62I=1,NUMARG
      WRITE(ICOUT,63)I,IHARG(I),IHARG2(I)
   63 FORMAT('I,IHARG(I),IHARG2(I) = ',I8,2X,A4,2X,A4)
      CALL DPWRST('XXX','BUG ')
   62 CONTINUE
      WRITE(ICOUT,71)NUMNAM
   71 FORMAT('NUMNAM = ',I8)
      CALL DPWRST('XXX','BUG ')
      DO72I=1,NUMNAM
      WRITE(ICOUT,73)I,IHNAME(I),IHNAM2(I),IUSE(I)
   73 FORMAT('I,IHNAME(I),IHNAM2(I),IUSE(I) = ',
     1I8,2X,A4,A4,2X,A4,I8,I8,E15.7)
      CALL DPWRST('XXX','BUG ')
   72 CONTINUE
   90 CONTINUE
C
      IISKIP=0
C
      DO1200J=JMIN,JMAX
C
      IF(IISKIP.EQ.1)THEN
        IISKIP=0
        GOTO1200
      ENDIF
C
      IH1=IHARG(J)
      IH2=IHARG2(J)
      ICASTO='OFF'
C
      IF (IH1.EQ.'TO  ')GOTO1210
      GOTO1220
C
 1210 CONTINUE
      ICASTO='ON'
      JM1=J-1
      JP1=J+1
      CALL DPEXTL(IHARG(JM1),IHARG2(JM1),IHARG(JP1),IHARG2(JP1),
     1KNUMB,IVAL1,IVAL2,IBUGA2,ISUBRO,IERROR)
C
      IF(IVAL1.EQ.IVAL2)THEN
        IISKIP=1
        GOTO1200
      ENDIF
C
      IVA1P1=IVAL1+1
      IVA2M1=IVAL2-1
      IF(IVA1P1.GT.IVA2M1)GOTO1200
      IVAL=IVAL1
C
 1215 CONTINUE
      IVAL=IVAL+1
      IF(IVAL.GE.IVAL2)GOTO1200
C
      CALL DPAPNU(IHARG(JM1),IHARG2(JM1),KNUMB,IVAL,
     1IH1,IH2,IBUGA2,ISUBRO,IERROR)
      GOTO1220
C
 1220 CONTINUE
      DO1300I=1,NUMNAM
      I2=I
      IF(IH1.EQ.IHNAME(I).AND.IH2.EQ.IHNAM2(I))GOTO1305
      GOTO1300
 1305 CONTINUE
      IF(IUSE(I).EQ.'V')GOTO1310
      IF(IUSE(I).EQ.'P')GOTO1320
      IF(IUSE(I).EQ.'M')GOTO1320
      IF(IUSE(I).EQ.'F')GOTO1320
 1300 CONTINUE
      GOTO1320
C
 1310 CONTINUE
      NUMIND=NUMIND+1
      IF(NUMIND.GT.MAXIND)GOTO1330
      IVARN1(NUMIND)=IH1
      IVARN2(NUMIND)=IH2
      GOTO1280
C
 1320 CONTINUE
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1311)
 1311 FORMAT('***** ERROR IN EXTVAR--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1312)
 1312 FORMAT('      A NAME IN THE LIST ')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1313)
 1313 FORMAT('      OF VARIABLES TO BE FIT ')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1314)
 1314 FORMAT('      INCLUDED THE NAME OF A ')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1315)
 1315 FORMAT('      NON-EXISTENT VARIABLE OR A NON-VARIABLE.')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1316)IH1,IH2
 1316 FORMAT('      THE NAME IN QUESTION WAS ',
     12A4,'   .')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1317)
 1317 FORMAT('      NO FIT WAS CARRIED OUT.')
      CALL DPWRST('XXX','BUG ')
      IERROR='YES'
      GOTO9000
C
 1330 CONTINUE
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1331)
 1331 FORMAT('***** ERROR IN EXTVAR--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1332)
 1332 FORMAT('      THE NUMBER OF VARIABLES PERMITTED')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1333)
 1333 FORMAT('      IN A MULTI-LINEAR FIT')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1334)
 1334 FORMAT('      HAS JUST EXCEEDED THE ALLOWABLE MAXIMUM')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1335)MAXIND
 1335 FORMAT('       (',I8,')')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1336)IH1,IH2
 1336 FORMAT('      THE VARIBLE IN QUESTION WAS ',
     12A4,'   .')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1337)
 1337 FORMAT('      NO FIT WAS CARRIED OUT.')
      CALL DPWRST('XXX','BUG ')
      IERROR='YES'
      GOTO9000
C
 1280 CONTINUE
      IF(ICASTO.EQ.'ON')GOTO1215
C
 1200 CONTINUE
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT       **
C               *****************
C
 9000 CONTINUE
      IF(IBUGA2.EQ.'OFF'.AND.ISUBRO.NE.'TVAR')GOTO9090
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9011)
 9011 FORMAT('***** AT THE END       OF EXTVAR--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9013)IBUGA2,ISUBRO
 9013 FORMAT('IBUGA2,ISUBRO = ',A4,2X,A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9014)JMIN,JMAX,NUMIND
 9014 FORMAT('JMIN,JMAX,NUMIND = ',3I8)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9021)NUMARG
 9021 FORMAT('NUMARG = ',A4)
      CALL DPWRST('XXX','BUG ')
      DO9022I=1,NUMARG
      WRITE(ICOUT,9023)I,IHARG(I),IHARG2(I)
 9023 FORMAT('I,IHARG(I),IHARG2(I) = ',I8,2X,A4,2X,A4)
      CALL DPWRST('XXX','BUG ')
 9022 CONTINUE
      WRITE(ICOUT,9031)NUMNAM
 9031 FORMAT('NUMNAM = ',I8)
      CALL DPWRST('XXX','BUG ')
      DO9032I=1,NUMNAM
      WRITE(ICOUT,9033)I,IHNAME(I),IHNAM2(I),IUSE(I)
CCCCC THE FOLLOWING FORMAT STATEMENT WAS FIXED JULY 1989
      CALL DPWRST('XXX','BUG ')
C9033 FORMAT('I,IHNAME(I),IHNAM2(I),IUSE(I) = ',
CCCCC1I8,2X,A4,A4,2X,A4,I8,I8,E1901.7)
 9033 FORMAT('I,IHNAME(I),IHNAM2(I),IUSE(I) = ',
     1I8,2X,A4,A4,2X,A4,I8,I8,E15.7)
 9032 CONTINUE
      WRITE(ICOUT,9041)NUMIND
 9041 FORMAT('NUMIND = ',I8)
      CALL DPWRST('XXX','BUG ')
      DO9042I=1,NUMIND
      WRITE(ICOUT,9043)I,IVARN1(I),IVARN2(I)
 9043 FORMAT('I,IVARN1(I),IVARN2(I) = ',I8,2X,A4,2X,A4)
      CALL DPWRST('XXX','BUG ')
 9042 CONTINUE
 9090 CONTINUE
C
      RETURN
      END
      SUBROUTINE EXTVA2(IHARG,IHARG2,IARGT,ARG,NUMARG,JMIN,JMAX,MAXIND,
     1                  IHNAME,IHNAM2,IUSE,NUMNAM,
     1                  IVARN1,IVARN2,IVARTY,PVAR,NUMIND,
     1                  IFLAGM,IFLAGP,IFLAGT,
     1                  IBUGA2,ISUBRO,IERROR)
C
C     PURPOSE--EXAMINE IHARG(.) AND IHARG2(.) FROM JMIN TO JMAX, EXTRACT
C              ALL NAMES (INCLUDING THOSE IMPLIED BY A   TO   KEYWORD)
C              AND PLACE THESE NAMES IN IVARN1(.) AND IVARN2(.).
C              NOTE THE NUMBER OF SUCH NAMES AND PLACE IT IN NUMIND.
C              NUMIND STANDS FOR NUMBER OF INDEPENDENT VARIABLES
C              (NOT INCLUDING THE IMPLICIT UNITY VARIABLE).
C              THIS ROUTINE IS SIMILAR TO "EXTVAR".  HOWEVER, IT
C              ALSO ALLOWS PARAMETER NAMES, NUMERIC VALUES, AND
C              MATRIX NAMES TO BE EXTRACTED.  THE ARRAY "IVARTY"
C              WILL BE CREATED TO STORE THE NAME TYPE AND PVAR
C              WILL CONTAIN THE VALUE OF ANY NUMERIC VALUES ENTERED.
C              THIS WILL MAKE THE "DPPARS" ROUTINE MORE GENERAL IN
C              THAT IT CAN HANDLE COMMANDS THAT ALLOW MATRICES AND
C              PARAMETER/SCALAR TO BE USED AS ARGUMENTS.
C     NOTE--JMIN   = START POINT IN IHARG/IHARG2 FOR THE SCAN
C           JMAX   = STOP POINT  IN IHARG/IHARG2 FOR THE SCAN
C           MAXIND = MAXIMUM PERMITTED NUMBER OF VARIABLES
C     OUTPUT--IVARN1(.), IVARN2(.), IVARTY(.), PVAR(.) AND NUMIND.
C     ORIGINAL VERSION--SEPTEMBER 2009.
C
C---------------------------------------------------------------------
C
      CHARACTER*4 IHARG(*)
      CHARACTER*4 IHARG2(*)
      CHARACTER*4 IARGT(*)
      CHARACTER*4 IHNAME(*)
      CHARACTER*4 IHNAM2(*)
      CHARACTER*4 IUSE(*)
      CHARACTER*4 IVARN1(*)
      CHARACTER*4 IVARN2(*)
      CHARACTER*4 IVARTY(*)
      REAL        ARG(*)
      REAL        PVAR(*)
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 IBUGA2
      CHARACTER*4 ISUBRO
      CHARACTER*4 IERROR
C
      CHARACTER*4 IH1
      CHARACTER*4 IH2
      CHARACTER*4 IHT
      CHARACTER*4 ICASTO
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOPA.INC'
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      NUMIND=0
      JM1=0
C
      IF(IBUGA2.EQ.'ON'.OR.ISUBRO.EQ.'TVA2')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,51)
   51   FORMAT('***** AT THE BEGINNING OF EXTVA2--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,53)IBUGA2,ISUBRO,IFLAGM,IFLAGP,IFLAGT
   53   FORMAT('IBUGA2,ISUBRO,IFLAGM,IFLAGP,IFLAGT = ',2(A4,2X),3I5)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,54)JMIN,JMAX,MAXIND,NUMIND,NUMARG
   54   FORMAT('JMIN,JMAX,MAXIND,NUMIND,NUMARG = ',5I8)
        CALL DPWRST('XXX','BUG ')
        IF(NUMARG.GE.1)THEN
          DO62I=1,NUMARG
            WRITE(ICOUT,63)I,IHARG(I),IHARG2(I),IARGT(I),ARG(I)
   63       FORMAT('I,IHARG(I),IHARG2(I),IARGT(I),ARG(I) = ',
     1             I8,2X,3(A4,2X),G15.7)
            CALL DPWRST('XXX','BUG ')
   62     CONTINUE
        ENDIF
        WRITE(ICOUT,71)NUMNAM
   71   FORMAT('NUMNAM = ',I8)
        CALL DPWRST('XXX','BUG ')
        DO72I=1,NUMNAM
          WRITE(ICOUT,73)I,IHNAME(I),IHNAM2(I),IUSE(I)
   73     FORMAT('I,IHNAME(I),IHNAM2(I),IUSE(I) = ',
     1           I8,2X,A4,A4,2X,A4,I8,I8,E15.7)
          CALL DPWRST('XXX','BUG ')
   72   CONTINUE
      ENDIF
C
      IISKIP=0
C
      DO1200J=JMIN,JMAX
C
C       CHECK FIRST TO SEE IF THE ARGUMENT IS ACTUALLY
C       A "NUMBER" (AS OPPOSSED TO A VARIABLE OR PARAMETER
C       NAME).
C
C       2010/12: MOVE THIS BELOW.
C
CCCCC   IF(IARGT(J).EQ.'NUMB')THEN
CCCCC     NUMIND=NUMIND+1
CCCCC     IF(NUMIND.GT.MAXIND)GOTO1330
CCCCC     IVARN1(NUMIND)='    '
CCCCC     IVARN2(NUMIND)='    '
CCCCC     IVARTY(NUMIND)='NUMB'
CCCCC     PVAR(NUMIND)=ARG(J)
CCCCC     GOTO1200
CCCCC   ENDIF
C
        IF(IISKIP.EQ.1)THEN
          IISKIP=0
          GOTO1200
        ENDIF
C
        IH1=IHARG(J)
        IH2=IHARG2(J)
        ICASTO='OFF'
C
        IF(IH1.EQ.'TO  ')GOTO1210
        GOTO1220
C
 1210   CONTINUE
          ICASTO='ON'
          JM1=J-1
          JP1=J+1
          CALL DPEXTL(IHARG(JM1),IHARG2(JM1),IHARG(JP1),IHARG2(JP1),
     1                KNUMB,IVAL1,IVAL2,IBUGA2,ISUBRO,IERROR)
C
          IF(IVAL1.EQ.IVAL2)THEN
            IISKIP=1
            GOTO1200
          ENDIF
C
          IVA1P1=IVAL1+1
          IVA2M1=IVAL2-1
          IF(IVA1P1.GT.IVA2M1)GOTO1200
          IVAL=IVAL1
C
 1215     CONTINUE
          IVAL=IVAL+1
          IF(IVAL.GE.IVAL2)GOTO1200
C
          CALL DPAPNU(IHARG(JM1),IHARG2(JM1),KNUMB,IVAL,
     1                IH1,IH2,IBUGA2,ISUBRO,IERROR)
          GOTO1220
C
 1220   CONTINUE
        IHT='NONE'
        DO1300I=1,NUMNAM
          I2=I
          IF(IH1.EQ.IHNAME(I).AND.IH2.EQ.IHNAM2(I))THEN
            IHT=IUSE(I)
            IF(IUSE(I).EQ.'V')THEN
              NUMIND=NUMIND+1
              IF(NUMIND.GT.MAXIND)GOTO1330
              IVARN1(NUMIND)=IH1
              IVARN2(NUMIND)=IH2
              IVARTY(NUMIND)='VARI'
              PVAR(NUMIND)=CPUMIN
              IF(ICASTO.EQ.'ON')GOTO1215
              GOTO1200
            ELSEIF(IUSE(I).EQ.'P')THEN
              IF(IFLAGP.EQ.0)GOTO1320
              NUMIND=NUMIND+1
              IF(NUMIND.GT.MAXIND)GOTO1330
              IVARN1(NUMIND)=IH1
              IVARN2(NUMIND)=IH2
              IVARTY(NUMIND)='PARA'
              PVAR(NUMIND)=CPUMIN
              IF(ICASTO.EQ.'ON')GOTO1215
              GOTO1200
            ELSEIF(IUSE(I).EQ.'M')THEN
              IF(IFLAGM.EQ.0)GOTO1320
              NUMIND=NUMIND+1
              IF(NUMIND.GT.MAXIND)GOTO1330
              IVARN1(NUMIND)=IH1
              IVARN2(NUMIND)=IH2
              IVARTY(NUMIND)='MATR'
              PVAR(NUMIND)=CPUMIN
              IF(ICASTO.EQ.'ON')GOTO1215
              GOTO1200
            ELSEIF(IUSE(I).EQ.'F')THEN
              IF(IFLAGT.EQ.0)GOTO1320
              NUMIND=NUMIND+1
              IF(NUMIND.GT.MAXIND)GOTO1330
              IVARN1(NUMIND)=IH1
              IVARN2(NUMIND)=IH2
              IVARTY(NUMIND)='F   '
              PVAR(NUMIND)=CPUMIN
              IF(ICASTO.EQ.'ON')GOTO1215
              GOTO1200
            ENDIF
          ENDIF
 1300   CONTINUE
C
C       2010/12: IF NO NAME FOUND, CHECK IF IT IS A LITERAL
C                NUMBER.
C
        IF(IARGT(J).EQ.'NUMB')THEN
          NUMIND=NUMIND+1
          IF(NUMIND.GT.MAXIND)GOTO1330
          IVARN1(NUMIND)='    '
          IVARN2(NUMIND)='    '
          IVARTY(NUMIND)='NUMB'
          PVAR(NUMIND)=ARG(J)
          GOTO1200
        ENDIF
C
        IF(IFLAGT.EQ.1)THEN
          NUMIND=NUMIND+1
          IF(NUMIND.GT.MAXIND)GOTO1330
          IVARN1(NUMIND)=IH1
          IVARN2(NUMIND)=IH2
          IVARTY(NUMIND)='UNKN'
          PVAR(NUMIND)=CPUMIN
          IF(ICASTO.EQ.'ON')GOTO1215
          GOTO1200
        ENDIF
C
 1320   CONTINUE
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1311)
 1311   FORMAT('***** ERROR IN EXTVA2--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1312)
 1312   FORMAT('      A NAME IN THE LIST OF EXTRACTED NAMES INCLUDED A')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1315)
 1315   FORMAT('      NON-EXISTENT NAME OR A NAME OF THE WRONG TYPE.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1316)IH1,IH2,IHT
 1316   FORMAT('      THE NAME IN QUESTION WAS ',A4,A4,' AND IS OF ',
     1         'TYPE ',A4)
        CALL DPWRST('XXX','BUG ')
        IERROR='YES'
        GOTO9000
C
 1330   CONTINUE
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1311)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1332)
 1332   FORMAT('      THE NUMBER OF VARIABLES EXTRACTED FROM THIS ',
     1         'COMMAND HAS JUST')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1334)MAXIND
 1334   FORMAT('      EXCEEDED THE ALLOWABLE MAXIMUM (',I8,')')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,1316)IH1,IH2,IHT
        CALL DPWRST('XXX','BUG ')
        IERROR='YES'
        GOTO9000
C
 1200 CONTINUE
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT       **
C               *****************
C
 9000 CONTINUE
      IF(IBUGA2.EQ.'ON'.OR.ISUBRO.EQ.'TVA2')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9011)
 9011   FORMAT('***** AT THE END       OF EXTVA2--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9013)IBUGA2,ISUBRO
 9013   FORMAT('IBUGA2,ISUBRO = ',A4,2X,A4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9014)JMIN,JMAX,NUMIND,NUMARG
 9014   FORMAT('JMIN,JMAX,NUMIND,NUMARG = ',4I8)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9041)NUMIND
 9041   FORMAT('NUMIND = ',I8)
        CALL DPWRST('XXX','BUG ')
        IF(NUMIND.GE.1)THEN
          DO9042I=1,NUMIND
            WRITE(ICOUT,9043)I,IVARN1(I),IVARN2(I),IVARTY(I),PVAR(I)
 9043       FORMAT('I,IVARN1(I),IVARN2(I),IVARTY(I),PVAR(I) = ',
     1             I8,2X,A4,2X,A4,2X,A4,2X,G15.7)
            CALL DPWRST('XXX','BUG ')
 9042     CONTINUE
        ENDIF
      ENDIF
C
      RETURN
      END
      SUBROUTINE EXTVA3(IHARG,IHARG2,NUMARG,JMIN,JMAX,MAXIND,
     1                  IHNAME,IHNAM2,NUMNAM,
     1                  IVARN1,IVARN2,NUMIND,
     1                  IBUGA2,ISUBRO,IERROR)
C
C     PURPOSE--EXAMINE IHARG(.) AND IHARG2(.) FROM JMIN TO JMAX, EXTRACT
C              ALL NAMES (INCLUDING THOSE IMPLIED BY A   TO   KEYWORD)
C              AND PLACE THESE NAMES IN IVARN1(.) AND IVARN2(.).
C              NOTE THE NUMBER OF SUCH NAMES AND PLACE IT IN NUMIND.
C              NUMIND STANDS FOR NUMBER OF INDEPENDENT VARIABLES
C              (NOT INCLUDING THE IMPLICIT UNITY VARIABLE).
C              THIS ROUTINE IS SIMILAR TO "EXTVAR" AND "EXTVA2".  HOWEVER,
C              THIS ROUTINE SIMPLY RETURNS THE LIST OF NAMES WITHOUT ANY
C              ERROR PROCESSING (I.E., DO NOT CHECK FOR EXISTENCE OR
C              TYPE).
C     NOTE--JMIN   = START POINT IN IHARG/IHARG2 FOR THE SCAN
C           JMAX   = STOP POINT  IN IHARG/IHARG2 FOR THE SCAN
C           MAXIND = MAXIMUM PERMITTED NUMBER OF VARIABLES
C     OUTPUT--IVARN1(.), IVARN2(.), AND NUMIND.
C     ORIGINAL VERSION--SEPTEMBER 2009.
C
C---------------------------------------------------------------------
C
      CHARACTER*4 IHARG(*)
      CHARACTER*4 IHARG2(*)
      CHARACTER*4 IHNAME(*)
      CHARACTER*4 IHNAM2(*)
      CHARACTER*4 IVARN1(*)
      CHARACTER*4 IVARN2(*)
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 IBUGA2
      CHARACTER*4 ISUBRO
      CHARACTER*4 IERROR
C
      CHARACTER*4 IH1
      CHARACTER*4 IH2
      CHARACTER*4 ICASTO
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOPA.INC'
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      NUMIND=0
      JM1=0
C
      IF(IBUGA2.EQ.'ON'.OR.ISUBRO.EQ.'TVA3')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,51)
   51   FORMAT('***** AT THE BEGINNING OF EXTVA3--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,53)IBUGA2,ISUBRO,JMIN,JMAX,NUMARG,NUMNAM,MAXIND
   53   FORMAT('IBUGA2,ISUBRO,JMIN,JMAX,NUMARG,NUMNAM,MAXIND = ',
     1         2(A4,2X),5I8)
        CALL DPWRST('XXX','BUG ')
        IF(NUMARG.GE.1)THEN
          DO62I=1,NUMARG
            WRITE(ICOUT,63)I,IHARG(I),IHARG2(I)
   63       FORMAT('I,IHARG(I),IHARG2(I) = ',I8,2(2X,A4))
            CALL DPWRST('XXX','BUG ')
   62     CONTINUE
        ENDIF
        DO72I=1,NUMNAM
          WRITE(ICOUT,73)I,IHNAME(I),IHNAM2(I)
   73     FORMAT('I,IHNAME(I),IHNAM2(I) = ',I8,2(A4,2X))
          CALL DPWRST('XXX','BUG ')
   72   CONTINUE
      ENDIF
C
      IISKIP=0
C
      DO1200J=JMIN,JMAX
C
        IF(IISKIP.EQ.1)THEN
          IISKIP=0
          GOTO1200
        ENDIF
C
        IH1=IHARG(J)
        IH2=IHARG2(J)
        ICASTO='OFF'
C
        IF(IH1.NE.'TO  ')GOTO1220
C
          ICASTO='ON'
          JM1=J-1
          JP1=J+1
          CALL DPEXTL(IHARG(JM1),IHARG2(JM1),IHARG(JP1),IHARG2(JP1),
     1                KNUMB,IVAL1,IVAL2,IBUGA2,ISUBRO,IERROR)
C
          IF(IVAL1.EQ.IVAL2)THEN
            IISKIP=1
            GOTO1200
          ENDIF
C
          IVA1P1=IVAL1+1
          IVA2M1=IVAL2-1
          IF(IVA1P1.GT.IVA2M1)GOTO1200
          IVAL=IVAL1
C
 1215     CONTINUE
          IVAL=IVAL+1
          IF(IVAL.GE.IVAL2)GOTO1200
C
          CALL DPAPNU(IHARG(JM1),IHARG2(JM1),KNUMB,IVAL,
     1                IH1,IH2,IBUGA2,ISUBRO,IERROR)
C
 1220   CONTINUE
        NUMIND=NUMIND+1
        IVARN1(NUMIND)=IH1
        IVARN2(NUMIND)=IH2
        IF(ICASTO.EQ.'ON')GOTO1215
C
 1200 CONTINUE
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT       **
C               *****************
C
      IF(IBUGA2.EQ.'ON'.OR.ISUBRO.EQ.'TVA2')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9011)
 9011   FORMAT('***** AT THE END       OF EXTVA3--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9013)IBUGA2,ISUBRO
 9013   FORMAT('IBUGA2,ISUBRO = ',A4,2X,A4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9014)JMIN,JMAX,NUMIND,NUMARG
 9014   FORMAT('JMIN,JMAX,NUMIND,NUMARG = ',4I8)
        CALL DPWRST('XXX','BUG ')
        IF(NUMIND.GE.1)THEN
          DO9042I=1,NUMIND
            WRITE(ICOUT,9043)I,IVARN1(I),IVARN2(I)
 9043       FORMAT('I,IVARN1(I),IVARN2(I) = ',
     1             I8,2X,A4,2X,A4,2X,A4,2X,G15.7)
            CALL DPWRST('XXX','BUG ')
 9042     CONTINUE
        ENDIF
      ENDIF
C
      RETURN
      END
      SUBROUTINE FALNEG(X,Y,N,IWRITE,XIDTEM,STAT,IBUGA3,IERROR)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE PROPORTION OF
C              FALSE NEGATIVES BETEEN TWO VARIABLES.
C
C              THIS IS SPECIFICALLY FOR THE 2X2 CASE.  THAT IS,
C              EACH VARIABLE HAS TWO MUTUALLY EXCLUSIVE
C              CHOICES CODED AS 1 (FOR SUCCESS) OR 0 (FOR
C              FAILURE).  A FALSE NEGATIVE IS DEFINED AS THE
C              ERROR WHERE THE SECOND VARIABLE IS 1 AND THE FIRST
C              VARIABLE IS A 0.
C
C              A TYPICAL EXAMPLE WOULD BE WHERE VARIABLE ONE
C              DENOTES THE GROUND TRUTH AND A VALUE OF 1
C              INDICATES "PRESENT" AND A VALUE OF 0 INDICATES
C              "NOT PRESENT".  VARIABLE TWO REPRESENTS SOME TYPE
C              OF DETECTION DEVICE WHERE A VALUE OF 1 INDICATES
C              THE DEVICE DETECTED THE SPECIFIED OBJECT WHILE A
C              VALUE OF 0 INDICATES THAT THE OBJECT WAS NOT
C              DETECTED.  A FALSE NEGATIVE THEN IS THE CASE WHERE
C              THE DEVICE FAILED TO DETECT THE OBJECT WHEN IT WAS
C              ACTUALY THERE.
C
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VECTOR OF
C                                (UNSORTED) OBSERVATIONS
C                                WHICH CONSTITUTE THE FIRST SET
C                                OF DATA.
C                     --Y      = THE SINGLE PRECISION VECTOR OF
C                                (UNSORTED) OBSERVATIONS
C                                WHICH CONSTITUTE THE SECOND SET
C                                OF DATA.
C                     --N      = THE INTEGER NUMBER OF OBSERVATIONS
C                                IN THE VECTOR X, OR EQUIVALENTLY,
C                                THE INTEGER NUMBER OF OBSERVATIONS
C                                IN THE VECTOR Y.
C     OUTPUT ARGUMENTS--STAT   = THE SINGLE PRECISION VALUE OF THE
C                                COMPUTED FALSE NEGATIVE PROPORTION
C                                BETWEEN THE 2 SETS OF DATA
C                                IN THE INPUT VECTORS X AND Y.
C     OUTPUT--THE COMPUTED SINGLE PRECISION VALUE OF THE
C             SAMPLE FALSE NEGATIVE PROPORTION BETWEEN THE 2 SETS
C             OF DATA IN THE INPUT VECTORS X AND Y.
C     RESTRICTIONS--THERE IS NO RESTRICTION ON THE MAXIMUM VALUE
C                   OF N FOR THIS SUBROUTINE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--NONE.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTIUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2007/3
C     ORIGINAL VERSION--MARCH     2007.
C     UPDATED         --AUGUST    2007. IF 2X2 CASE, CHECK IF SUM
C                                       OF ENTRIES IS <= 4.  IN THIS
C                                       CASE, ASSUME WE HAVE RAW DATA
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 IWRITE
      CHARACTER*4 IBUGA3
      CHARACTER*4 IERROR
C
      CHARACTER*4 ISTEPN
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
C
C---------------------------------------------------------------------
C
      DIMENSION X(*)
      DIMENSION Y(*)
      DIMENSION XIDTEM(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='FALN'
      ISUBN2='EG  '
      IERROR='NO'
C
C
      IF(IBUGA3.EQ.'ON')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,51)
   51   FORMAT('***** AT THE BEGINNING OF FALNEG--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,52)IBUGA3
   52   FORMAT('IBUGA3 = ',A4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,53)N
   53   FORMAT('N = ',I8)
        CALL DPWRST('XXX','BUG ')
        DO55I=1,N
          WRITE(ICOUT,56)I,X(I),Y(I)
   56     FORMAT('I,X(I),Y(I) = ',I8,2G15.7)
          CALL DPWRST('XXX','BUG ')
   55   CONTINUE
      ENDIF
C
C               ********************************************
C               **  STEP 21--                             **
C               **  CHECK THE INPUT ARGUMENTS FOR ERRORS  **
C               ********************************************
C
      ISTEPN='21'
      IF(IBUGA3.EQ.'ON')CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      IF(N.LT.2)THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,1201)
 1201   FORMAT('***** ERROR IN THE FALSE NEGATIVE PROPORTION')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,1203)
 1203   FORMAT('      THE NUMBER OF OBSERVATIONS FOR THE RESPONSE ',
     1         'VARIABLES IS LESS THAN TWO')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,1205)N
 1205   FORMAT('SAMPLE SIZE = ',I8)
        CALL DPWRST('XXX','WRIT')
        IERROR='YES'
        GOTO9000
      ENDIF
C
C               ********************************************
C               **  STEP 22--                             **
C               **  CHECK THAT THE VARIABLES HAVE AT MOST **
C               **  TWO DISTINCT VALUES (1 INDICATES A    **
C               **  SUCCESS, 0 INDICATES A FAILURE).      **
C               ********************************************
C
      ISTEPN='22'
      IF(IBUGA3.EQ.'ON')CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
C     NOTE: CHECK FOR SPECIAL CASE N = 2.  IN THIS CASE,
C           ASSUME WE HAVE A 2X2 TABLE OF COUNTS INSTEAD
C           OF RAW DATA.
C
      IF(N.EQ.2)THEN
        N11=INT(X(1)+0.5)
        N21=INT(X(2)+0.5)
        N12=INT(Y(1)+0.5)
        N22=INT(Y(2)+0.5)
C
C       CHECK IF ALL ENTRIES 0 OR 1. IF SO, ASSUME
C       RAW DATA CASE.
C
        IF((N11.EQ.0 .OR. N11.EQ.1) .AND.
     1     (N12.EQ.0 .OR. N12.EQ.1) .AND.
     1     (N21.EQ.0 .OR. N21.EQ.1) .AND.
     1     (N22.EQ.0 .OR. N22.EQ.1)) GOTO1349
C
        IF(N11.LT.0)THEN
          WRITE(ICOUT,999)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,1201)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,1311)
 1311     FORMAT('      ROW 1 COLUMN 1 OF THE COUNTS TABLE IS ',
     1           'NEGATIVE.')
          CALL DPWRST('XXX','BUG ')
        ELSEIF(N21.LT.0)THEN
          WRITE(ICOUT,999)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,1201)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,1321)
 1321     FORMAT('      ROW 2 COLUMN 1 OF THE COUNTS TABLE IS ',
     1           'NEGATIVE.')
          CALL DPWRST('XXX','BUG ')
        ELSEIF(N12.LT.0)THEN
          WRITE(ICOUT,999)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,1201)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,1331)
 1331     FORMAT('      ROW 1 COLUMN 2 OF THE COUNTS TABLE IS ',
     1           'NEGATIVE.')
          CALL DPWRST('XXX','BUG ')
        ELSEIF(N22.LT.0)THEN
          WRITE(ICOUT,999)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,1201)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,1341)
 1341     FORMAT('      ROW 2 COLUMN 2 OF THE COUNTS TABLE IS ',
     1           'NEGATIVE.')
          CALL DPWRST('XXX','BUG ')
        ENDIF
C
        NTEMP=N11 + N12 + N21 + N22
        STAT=REAL(N12)/REAL(NTEMP)
        GOTO3000
      ENDIF
C
 1349 CONTINUE
C
      CALL DISTIN(X,N,IWRITE,XIDTEM,NDIST,IBUGA3,IERROR)
      IF(NDIST.EQ.1)THEN
        AVAL=XIDTEM(1)
        IF(ABS(AVAL).LE.0.5)THEN
          AVAL=0.0
        ELSE
          AVAL=1.0
        ENDIF
        DO2202I=1,N
          X(I)=1.0
 2202   CONTINUE
      ELSEIF(NDIST.EQ.2)THEN
        IF(XIDTEM(1).EQ.1.0 .OR. XIDTEM(2).EQ.1.0)THEN
          DO2203I=1,N
            IF(X(I).NE.1.0)X(I)=0.0
 2203     CONTINUE
        ELSE
          ATEMP1=MIN(XIDTEM(1),XIDTEM(2))
          ATEMP2=MAX(XIDTEM(1),XIDTEM(2))
          DO2208I=1,N
            IF(X(I).EQ.ATEMP1)X(I)=0.0
            IF(X(I).EQ.ATEMP2)X(I)=1.0
 2208     CONTINUE
        ENDIF
      ELSEIF(NDIST.GT.2)THEN
        N11=0
        N12=0
        N21=0
        DO2510I=1,N
          IF(Y(I).EQ.X(I))THEN
            N11=N11+1
          ELSEIF(Y(I).LT.X(I))THEN
            N12=N12+1
          ELSEIF(Y(I).GT.X(I))THEN
            N21=N21+1
          ENDIF
 2510   CONTINUE
        STAT=REAL(N12)/REAL(N)
        GOTO9000
      ELSE
CCCCC   WRITE(ICOUT,999)
CCCCC   CALL DPWRST('XXX','BUG ')
CCCCC   WRITE(ICOUT,1201)
CCCCC   CALL DPWRST('XXX','BUG ')
CCCCC   WRITE(ICOUT,2211)
C2211   FORMAT('      RESPONSE VARIABLE ONE SHOULD CONTAIN AT MOST')
CCCCC   CALL DPWRST('XXX','BUG ')
CCCCC   WRITE(ICOUT,2213)
C2213   FORMAT('      TWO DISTINCT VALUES.')
CCCCC   CALL DPWRST('XXX','BUG ')
CCCCC   WRITE(ICOUT,2215)NDIST
C2215   FORMAT('      ',I8,' DISTINCT VALUES FOUND.')
CCCCC   CALL DPWRST('XXX','BUG ')
CCCCC   IERROR='YES'
CCCCC   GOTO9000
      ENDIF
C
      CALL DISTIN(Y,N,IWRITE,XIDTEM,NDIST,IBUGA3,IERROR)
      IF(NDIST.EQ.1)THEN
        AVAL=XIDTEM(1)
        IF(ABS(AVAL).LE.0.5)THEN
          AVAL=0.0
        ELSE
          AVAL=1.0
        ENDIF
        DO2302I=1,N
          Y(I)=1.0
 2302   CONTINUE
      ELSEIF(NDIST.EQ.2)THEN
        IF(XIDTEM(1).EQ.1.0 .OR. XIDTEM(2).EQ.1.0)THEN
          DO2303I=1,N
            IF(Y(I).NE.1.0)Y(I)=0.0
 2303     CONTINUE
        ELSE
          ATEMP1=MIN(XIDTEM(1),XIDTEM(2))
          ATEMP2=MAX(XIDTEM(1),XIDTEM(2))
          DO2308I=1,N
            IF(Y(I).EQ.ATEMP1)Y(I)=0.0
            IF(Y(I).EQ.ATEMP2)Y(I)=1.0
 2308     CONTINUE
        ENDIF
      ELSEIF(NDIST.GT.2)THEN
        N11=0
        N12=0
        N21=0
        DO2520I=1,N
          IF(Y(I).EQ.X(I))THEN
            N11=N11+1
          ELSEIF(Y(I).LT.X(I))THEN
            N12=N12+1
          ELSEIF(Y(I).GT.X(I))THEN
            N21=N21+1
          ENDIF
 2520   CONTINUE
        STAT=REAL(N12)/REAL(N)
        GOTO9000
      ELSE
CCCCC   WRITE(ICOUT,999)
CCCCC   CALL DPWRST('XXX','BUG ')
CCCCC   WRITE(ICOUT,1201)
CCCCC   CALL DPWRST('XXX','BUG ')
CCCCC   WRITE(ICOUT,2311)
C2311   FORMAT('      RESPONSE VARIABLE TWO SHOULD CONTAIN AT MOST')
CCCCC   CALL DPWRST('XXX','BUG ')
CCCCC   WRITE(ICOUT,2313)
C2313   FORMAT('      TWO DISTINCT VALUES.')
CCCCC   CALL DPWRST('XXX','BUG ')
CCCCC   WRITE(ICOUT,2315)NDIST
C2315   FORMAT('      ',I8,' DISTINCT VALUES FOUND.')
CCCCC   CALL DPWRST('XXX','BUG ')
CCCCC   IERROR='YES'
CCCCC   GOTO9000
      ENDIF
C
      N11=0
      N12=0
      N21=0
      N22=0
      DO2410I=1,N
        IF(X(I).EQ.1.0 .AND. Y(I).EQ.1.0)THEN
          N11=N11+1
        ELSEIF(X(I).EQ.0.0 .AND. Y(I).EQ.0.0)THEN
          N22=N22+1
        ELSEIF(X(I).EQ.1.0 .AND. Y(I).EQ.0.0)THEN
          N12=N12+1
        ELSEIF(X(I).EQ.0.0 .AND. Y(I).EQ.1.0)THEN
          N21=N21+1
        ENDIF
 2410 CONTINUE
C
      STAT=REAL(N12)/REAL(N)
C
 3000 CONTINUE
C
C
C               *******************************
C               **  STEP 3--                 **
C               **  WRITE OUT A LINE         **
C               **  OF SUMMARY INFORMATION.  **
C               *******************************
C
      IF(IFEEDB.EQ.'OFF')GOTO890
      IF(IWRITE.EQ.'OFF' .OR. IWRITE.EQ.'NO')GOTO890
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,811)STAT
  811 FORMAT('THE FALSE NEGATIVE PROPORTION = ',G15.7)
      CALL DPWRST('XXX','BUG ')
  890 CONTINUE
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT.      **
C               *****************
C
 9000 CONTINUE
      IF(IBUGA3.EQ.'ON')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9011)
 9011   FORMAT('***** AT THE END OF FALNEG--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9012)IBUGA3,IERROR
 9012   FORMAT('IBUGA3,IERROR = ',A4,2X,A4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9013)N,N11,N12,N21,N22
 9013   FORMAT('N,N11,N12,N21,N22 = ',5I10)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9015)STAT
 9015   FORMAT('STAT = ',G15.7)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
      RETURN
      END
      SUBROUTINE FALPOS(X,Y,N,IWRITE,XIDTEM,STAT,IBUGA3,IERROR)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE PROPORTION OF
C              FALSE POSITIVES BETEEN TWO VARIABLES.
C
C              THIS IS SPECIFICALLY FOR THE 2X2 CASE.  THAT IS,
C              EACH VARIABLE HAS TWO MUTUALLY EXCLUSIVE
C              CHOICES CODED AS 1 (FOR SUCCESS) OR 0 (FOR
C              FAILURE).  A FALSE POSITIVE IS DEFINED AS THE
C              ERROR WHERE THE SECOND VARIABLE IS 1 AND THE FIRST
C              VARIABLE IS A 0.
C
C              A TYPICAL EXAMPLE WOULD BE WHERE VARIABLE ONE
C              DENOTES THE GROUND TRUTH AND A VALUE OF 1
C              INDICATES "PRESENT" AND A VALUE OF 0 INDICATES
C              "NOT PRESENT".  VARIABLE TWO REPRESENTS SOME TYPE
C              OF DETECTION DEVICE WHERE A VALUE OF 1 INDICATES
C              THE DEVICE DETECTED THE SPECIFIED OBJECT WHILE A
C              VALUE OF 0 INDICATES THAT THE OBJECT WAS NOT
C              DETECTED.  A FALSE POSITIVE THEN IS THE CASE WHERE
C              THE DEVICE DETECTED THE OBJECT WHEN IT WAS NOT
C              ACTUALY THERE.
C
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VECTOR OF
C                                (UNSORTED) OBSERVATIONS
C                                WHICH CONSTITUTE THE FIRST SET
C                                OF DATA.
C                     --Y      = THE SINGLE PRECISION VECTOR OF
C                                (UNSORTED) OBSERVATIONS
C                                WHICH CONSTITUTE THE SECOND SET
C                                OF DATA.
C                     --N      = THE INTEGER NUMBER OF OBSERVATIONS
C                                IN THE VECTOR X, OR EQUIVALENTLY,
C                                THE INTEGER NUMBER OF OBSERVATIONS
C                                IN THE VECTOR Y.
C     OUTPUT ARGUMENTS--STAT   = THE SINGLE PRECISION VALUE OF THE
C                                COMPUTED FALSE POSITIVE PROPORTION
C                                BETWEEN THE 2 SETS OF DATA
C                                IN THE INPUT VECTORS X AND Y.
C     OUTPUT--THE COMPUTED SINGLE PRECISION VALUE OF THE
C             SAMPLE FALSE POSITIVE PROPORTION BETWEEN THE 2 SETS
C             OF DATA IN THE INPUT VECTORS X AND Y.
C     RESTRICTIONS--THERE IS NO RESTRICTION ON THE MAXIMUM VALUE
C                   OF N FOR THIS SUBROUTINE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--NONE.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTIUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2007/3
C     ORIGINAL VERSION--MARCH     2007.
C     UPDATED         --AUGUST    2007. IF 2X2 CASE, CHECK IF SUM
C                                       OF ENTRIES IS <= 4.  IN THIS
C                                       CASE, ASSUME WE HAVE RAW DATA
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 IWRITE
      CHARACTER*4 IBUGA3
      CHARACTER*4 IERROR
C
      CHARACTER*4 ISTEPN
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
C
C---------------------------------------------------------------------
C
      DIMENSION X(*)
      DIMENSION Y(*)
      DIMENSION XIDTEM(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='FALP'
      ISUBN2='OS  '
      IERROR='NO'
C
      IF(IBUGA3.EQ.'ON')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,51)
   51   FORMAT('***** AT THE BEGINNING OF FALPOS--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,52)IBUGA3
   52   FORMAT('IBUGA3 = ',A4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,53)N
   53   FORMAT('N = ',I8)
        CALL DPWRST('XXX','BUG ')
        DO55I=1,N
          WRITE(ICOUT,56)I,X(I),Y(I)
   56     FORMAT('I,X(I),Y(I) = ',I8,2G15.7)
          CALL DPWRST('XXX','BUG ')
   55   CONTINUE
      ENDIF
C
C               ********************************************
C               **  STEP 21--                             **
C               **  CHECK THE INPUT ARGUMENTS FOR ERRORS  **
C               ********************************************
C
      ISTEPN='21'
      IF(IBUGA3.EQ.'ON')CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      IF(N.LT.2)THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,1201)
 1201   FORMAT('***** ERROR IN THE FALSE POSITIVE PROPORTION')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,1203)
 1203   FORMAT('      THE NUMBER OF OBSERVATIONS FOR THE RESPONSE ',
     1         'VARIABLES IS LESS THAN TWO')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,1205)N
 1205   FORMAT('SAMPLE SIZE = ',I8)
        CALL DPWRST('XXX','WRIT')
        IERROR='YES'
        GOTO9000
      ENDIF
C
C               ********************************************
C               **  STEP 22--                             **
C               **  CHECK THAT THE VARIABLES HAVE AT MOST **
C               **  TWO DISTINCT VALUES (1 INDICATES A    **
C               **  SUCCESS, 0 INDICATES A FAILURE).      **
C               ********************************************
C
      ISTEPN='22'
      IF(IBUGA3.EQ.'ON')CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
C     NOTE: CHECK FOR SPECIAL CASE N = 2.  IN THIS CASE,
C           ASSUME WE HAVE A 2X2 TABLE OF COUNTS INSTEAD
C           OF RAW DATA.
C
      IF(N.EQ.2)THEN
        N11=INT(X(1)+0.5)
        N21=INT(X(2)+0.5)
        N12=INT(Y(1)+0.5)
        N22=INT(Y(2)+0.5)
C
C       CHECK IF ALL ENTRIES 0 OR 1. IF SO, ASSUME
C       RAW DATA CASE.
C
        IF((N11.EQ.0 .OR. N11.EQ.1) .AND.
     1     (N12.EQ.0 .OR. N12.EQ.1) .AND.
     1     (N21.EQ.0 .OR. N21.EQ.1) .AND.
     1     (N22.EQ.0 .OR. N22.EQ.1)) GOTO1349
C
        IF(N11.LT.0)THEN
          WRITE(ICOUT,999)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,1201)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,1311)
 1311     FORMAT('      ROW 1 COLUMN 1 OF THE COUNTS TABLE IS ',
     1           'NEGATIVE.')
          CALL DPWRST('XXX','BUG ')
        ELSEIF(N21.LT.0)THEN
          WRITE(ICOUT,999)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,1201)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,1321)
 1321     FORMAT('      ROW 2 COLUMN 1 OF THE COUNTS TABLE IS ',
     1           'NEGATIVE.')
          CALL DPWRST('XXX','BUG ')
        ELSEIF(N12.LT.0)THEN
          WRITE(ICOUT,999)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,1201)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,1331)
 1331     FORMAT('      ROW 1 COLUMN 2 OF THE COUNTS TABLE IS ',
     1           'NEGATIVE.')
          CALL DPWRST('XXX','BUG ')
        ELSEIF(N22.LT.0)THEN
          WRITE(ICOUT,999)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,1201)
          CALL DPWRST('XXX','BUG ')
          WRITE(ICOUT,1341)
 1341     FORMAT('      ROW 2 COLUMN 2 OF THE COUNTS TABLE IS ',
     1           'NEGATIVE.')
          CALL DPWRST('XXX','BUG ')
        ENDIF
C
        NTEMP=N11 + N12 + N21 + N22
        STAT=REAL(N21)/REAL(NTEMP)
        GOTO3000
      ENDIF
C
 1349 CONTINUE
C
      CALL DISTIN(X,N,IWRITE,XIDTEM,NDIST,IBUGA3,IERROR)
      IF(NDIST.EQ.1)THEN
        AVAL=XIDTEM(1)
        IF(ABS(AVAL).LE.0.5)THEN
          AVAL=0.0
        ELSE
          AVAL=1.0
        ENDIF
        DO2202I=1,N
          X(I)=1.0
 2202   CONTINUE
      ELSEIF(NDIST.EQ.2)THEN
        IF(XIDTEM(1).EQ.1.0 .OR. XIDTEM(2).EQ.1.0)THEN
          DO2203I=1,N
            IF(X(I).NE.1.0)X(I)=0.0
 2203     CONTINUE
        ELSE
          ATEMP1=MIN(XIDTEM(1),XIDTEM(2))
          ATEMP2=MAX(XIDTEM(1),XIDTEM(2))
          DO2208I=1,N
            IF(X(I).EQ.ATEMP1)X(I)=0.0
            IF(X(I).EQ.ATEMP2)X(I)=1.0
 2208     CONTINUE
        ENDIF
      ELSEIF(NDIST.GT.2)THEN
C
C       CASE WITH MORE THAN 2 DISTINCT VALUES FOR GROUND
C       TRUTH VARIABLE.  IN THIS CASE, JUST CHECK IF
C
C          X(I) = Y(I)
C          X(I) < Y(I)
C          X(I) > Y(I)
C
        N11=0
        N12=0
        N21=0
        DO2510I=1,N
          IF(Y(I).EQ.X(I))THEN
            N11=N11+1
          ELSEIF(Y(I).LT.X(I))THEN
            N12=N12+1
          ELSEIF(Y(I).GT.X(I))THEN
            N21=N21+1
          ENDIF
 2510   CONTINUE
        STAT=REAL(N21)/REAL(N)
        GOTO9000
      ELSE
CCCCC   WRITE(ICOUT,999)
CCCCC   CALL DPWRST('XXX','BUG ')
CCCCC   WRITE(ICOUT,1201)
CCCCC   CALL DPWRST('XXX','BUG ')
CCCCC   WRITE(ICOUT,2211)
C2211   FORMAT('      RESPONSE VARIABLE ONE SHOULD CONTAIN AT MOST')
CCCCC   CALL DPWRST('XXX','BUG ')
CCCCC   WRITE(ICOUT,2213)
C2213   FORMAT('      TWO DISTINCT VALUES.')
CCCCC   CALL DPWRST('XXX','BUG ')
CCCCC   WRITE(ICOUT,2215)NDIST
C2215   FORMAT('      ',I8,' DISTINCT VALUES FOUND.')
CCCCC   CALL DPWRST('XXX','BUG ')
CCCCC   IERROR='YES'
CCCCC   GOTO9000
      ENDIF
C
      CALL DISTIN(Y,N,IWRITE,XIDTEM,NDIST,IBUGA3,IERROR)
      IF(NDIST.EQ.1)THEN
        AVAL=XIDTEM(1)
        IF(ABS(AVAL).LE.0.5)THEN
          AVAL=0.0
        ELSE
          AVAL=1.0
        ENDIF
        DO2302I=1,N
          Y(I)=1.0
 2302   CONTINUE
      ELSEIF(NDIST.EQ.2)THEN
        IF(XIDTEM(1).EQ.1.0 .OR. XIDTEM(2).EQ.1.0)THEN
          DO2303I=1,N
            IF(Y(I).NE.1.0)Y(I)=0.0
 2303     CONTINUE
        ELSE
          ATEMP1=MIN(XIDTEM(1),XIDTEM(2))
          ATEMP2=MAX(XIDTEM(1),XIDTEM(2))
          DO2308I=1,N
            IF(Y(I).EQ.ATEMP1)Y(I)=0.0
            IF(Y(I).EQ.ATEMP2)Y(I)=1.0
 2308     CONTINUE
        ENDIF
      ELSEIF(NDIST.GT.2)THEN
        N11=0
        N12=0
        N21=0
        DO2520I=1,N
          IF(Y(I).EQ.X(I))THEN
            N11=N11+1
          ELSEIF(Y(I).LT.X(I))THEN
            N12=N12+1
          ELSEIF(Y(I).GT.X(I))THEN
            N21=N21+1
          ENDIF
 2520   CONTINUE
        STAT=REAL(N21)/REAL(N)
        GOTO9000
      ELSE
CCCCC   WRITE(ICOUT,999)
CCCCC   CALL DPWRST('XXX','BUG ')
CCCCC   WRITE(ICOUT,1201)
CCCCC   CALL DPWRST('XXX','BUG ')
CCCCC   WRITE(ICOUT,2311)
C2311   FORMAT('      RESPONSE VARIABLE TWO SHOULD CONTAIN AT MOST')
CCCCC   CALL DPWRST('XXX','BUG ')
CCCCC   WRITE(ICOUT,2313)
C2313   FORMAT('      TWO DISTINCT VALUES.')
CCCCC   CALL DPWRST('XXX','BUG ')
CCCCC   WRITE(ICOUT,2315)NDIST
C2315   FORMAT('      ',I8,' DISTINCT VALUES FOUND.')
CCCCC   CALL DPWRST('XXX','BUG ')
CCCCC   IERROR='YES'
CCCCC   GOTO9000
      ENDIF
C
      N11=0
      N12=0
      N21=0
      N22=0
      DO2410I=1,N
        IF(X(I).EQ.1.0 .AND. Y(I).EQ.1.0)THEN
          N11=N11+1
        ELSEIF(X(I).EQ.0.0 .AND. Y(I).EQ.0.0)THEN
          N22=N22+1
        ELSEIF(X(I).EQ.1.0 .AND. Y(I).EQ.0.0)THEN
          N12=N12+1
        ELSEIF(X(I).EQ.0.0 .AND. Y(I).EQ.1.0)THEN
          N21=N21+1
        ENDIF
 2410 CONTINUE
C
      STAT=REAL(N21)/REAL(N)
C
 3000 CONTINUE
C
C
C               *******************************
C               **  STEP 3--                 **
C               **  WRITE OUT A LINE         **
C               **  OF SUMMARY INFORMATION.  **
C               *******************************
C
      IF(IFEEDB.EQ.'OFF')GOTO890
      IF(IWRITE.EQ.'OFF' .OR. IWRITE.EQ.'NO')GOTO890
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,811)STAT
  811 FORMAT('THE FALSE POSITIVE PROPORTION = ',G15.7)
      CALL DPWRST('XXX','BUG ')
  890 CONTINUE
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT.      **
C               *****************
C
 9000 CONTINUE
      IF(IBUGA3.EQ.'ON')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9011)
 9011   FORMAT('***** AT THE END OF FALPOS--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9012)IBUGA3,IERROR
 9012   FORMAT('IBUGA3,IERROR = ',A4,2X,A4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9013)N,N11,N12,N21,N22
 9013   FORMAT('N,N11,N12,N21,N22 = ',5I10)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9015)STAT
 9015   FORMAT('STAT = ',G15.7)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
      RETURN
      END
      SUBROUTINE FCACDF(X,U,SD,CDF)
C
C     NOTE--FOLDED-CAUCHY PDF IS:
C              FCAPDF(X,U,S)=(1/S)*(CAUPDF((X-U)/S)+CAUPDF((X+U)/S)))
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--96/1
C     ORIGINAL VERSION--JANUARY   1996.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      CDF=0.0
C
      IF(X.LT.0.0)THEN
        WRITE(ICOUT,4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)SD
        CALL DPWRST('XXX','BUG ')
        CDF=0.0
        GOTO9999
      ENDIF
      IF(SD.LE.0.0)THEN
        WRITE(ICOUT,201)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)SD
        CALL DPWRST('XXX','BUG ')
        CDF=0.0
        GOTO9999
      ENDIF
    4 FORMAT('***** NON-FATAL DIAGNOSTIC--THE FIRST  INPUT ARGUMENT ',
     1'TO THE FCACDF SUBROUTINE IS NEGATIVE *****')
   46 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',E15.8,' *****')
  201 FORMAT('***** FATAL DIAGNOSTIC--THE THIRD  INPUT ARGUMENT ',
     1' TO THE FCACDF SUBROUTINE IS NEGATIVE *****')
C
      TERM1=(X-U)/SD
      CALL CAUCDF(TERM1,TERM2)
      TERM3=(-X-U)/SD
      CALL CAUCDF(TERM3,TERM4)
      CDF=TERM2-TERM4
      GOTO9999
C
 9999 CONTINUE
      RETURN
      END
      SUBROUTINE FCAPDF(X,U,SD,PDF)
C
C     NOTE--FOLDED-CAUCHY PDF IS:
C              FCAPDF(X,U,S)=(1/S)*(CAUPDF((X-U)/S) + CAUPDF((X+U)/S)))
C           WHERE CAUPDF IS THE PDF OF THE STANDARD CAUCHY DISTRIBUTION
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--96/1
C     ORIGINAL VERSION--JANUARY   1996.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      PDF=0.0
C
      IF(X.LT.0.0)THEN
        WRITE(ICOUT,4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)X
        CALL DPWRST('XXX','BUG ')
        PDF=0.0
        GOTO9999
      ENDIF
      IF(SD.LE.0.0)THEN
        WRITE(ICOUT,201)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)SD
        CALL DPWRST('XXX','BUG ')
        GOTO9999
      ENDIF
    4 FORMAT('***** NON-FATAL DIAGNOSTIC--THE FIRST  INPUT ARGUMENT ',
     1'TO THE FCAPDF SUBROUTINE IS NEGATIVE *****')
   46 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',E15.8,' *****')
  201 FORMAT('***** FATAL DIAGNOSTIC--THE THIRD  INPUT ARGUMENT ',
     1'TO THE FCAPDF SUBROUTINE IS NON-POSITIVE *****')
C
      TERM1=(X-U)/SD
      CALL CAUPDF(TERM1,TERM2)
      TERM2=TERM2/SD
      TERM3=(X+U)/SD
      CALL CAUPDF(TERM3,TERM4)
      TERM4=TERM4/SD
      PDF=TERM2+TERM4
      GOTO9999
C
 9999 CONTINUE
      RETURN
      END
      SUBROUTINE FCAPPF(P,U,SD,PPF)
C
C     PURPOSE   --PERCENT POINT FUNCTION FOR THE FOLDED CAUCHY
C                 DISTRIBUTION.  USES A BISECTION METHOD.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--96/1
C     ORIGINAL VERSION--JANUARY 1996.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DU
      DOUBLE PRECISION DMEAN
      DOUBLE PRECISION DSD
CCCCC DOUBLE PRECISION DPI
      DOUBLE PRECISION DSDF
CCCCC DOUBLE PRECISION DTERM1, DTERM2
C
      INCLUDE 'DPCOP2.INC'
C
CCCCC DATA DPI /3.14159265358979D0/
      DATA EPSZ /0.0001/
      DATA SIGZ /1.0E-5/
      DATA ZERO /0./
      DATA MAXIT /30000/
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      PPF=0.0
      IF(P.LT.0.0.OR.P.GE.1.0)THEN
        WRITE(ICOUT,1)
    1   FORMAT('***** ERROR--THE FIRST ARGUMENT TO FCAPPF ',
     1         'IS OUTSIDE THE ALLOWABLE (0,1) INTERVAL.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)P
   46   FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7,'.')
        CALL DPWRST('XXX','BUG ')
        GOTO9999
      ELSEIF(SD.LE.0.0)THEN
        WRITE(ICOUT,35)
   35   FORMAT('***** ERROR--THE THIRD ARGUMENT TO FCAPPF ',
     1         'IS NON-POSITIVE.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)SD
        CALL DPWRST('XXX','BUG ')
        GOTO9999
      ENDIF
C
C  IF P IS 0, PPF IS ZERO.  HANDLE THIS TRIVIAL CASE.
C
      IF(P.EQ.0.0)THEN
        PPF=0.0
        GOTO9999
      ENDIF
C
C  FIND BRACKETING INTERVAL.
C  AFTER SUCCESSFULLY FIND BRACKETING INTERVAL, THEN SWITCH TO 
C  MORE EFFICIENT BISECTION METHOD.
C
      EPS=EPSZ
      SIG=SIGZ
      DU=DBLE(U)
      DSD=DBLE(SD)
CCCCC DTERM1=DEXP(-DU**2/(2.0D0*DSD**2))
CCCCC DTERM2=DSQRT(2.D0/DPI)
CCCCC TERM3=-U/SD
CCCCC CALL CAUCDF(TERM3,TERM4)
CCCCC DMEAN=DTERM2*DSD*DTERM1 + DU*(1.D0-2.D0*DBLE(TERM4))
CCCCC DSDF=DMEAN**2 + DU*DU + DSD*DSD
      DMEAN=DU
      DSDF=DSD**2
C
      XL=SNGL(DMEAN)
      XINC=SNGL(DSDF)
      IF(XINC.LT.1.0)XINC=1.0
      ICOUNT=0
C
   91 CONTINUE
      XR=XL+XINC
      IF(XL.LE.0.0)XL=0.0
      IF(XR.LE.0.0)XR=XL+XINC
      CALL FCACDF(XL,U,SD,CDFL)
      CALL FCACDF(XR,U,SD,CDFR)
      IF(CDFL.LT.P .AND. CDFR.LT.P)THEN
        XL=XR
      ELSEIF(CDFL.GT.P .AND. CDFR.GT.P)THEN
        XL=XL-XINC
      ELSE
        GOTO99
      ENDIF
      ICOUNT=ICOUNT+1
      IF(ICOUNT.GT.MAXIT)THEN
        WRITE(ICOUT,96)
        CALL DPWRST('XXX','BUG ')
        PPF=0.0
        GOTO9999
      ENDIF
   96 FORMAT('***** ERROR--FCAPPF UNABLE TO FIND BRACKETING ',
     *       'INTERVAL.')
      GOTO91
C
C  BISECTION METHOD
C
   99 CONTINUE
      IF(XR.GT.10000.0)THEN
        EPS=0.001
        SIG=5.0E-2
      ELSEIF(XR.GT.1000.0)THEN
        EPS=0.001
        SIG=5.0E-3
      ELSEIF(XR.GT.500.0)THEN
        EPS=0.0001
        SIG=5.0E-4
      ELSEIF(XR.GT.100.0)THEN
        EPS=0.0001
        SIG=1.0E-4
      ENDIF
C
      IC = 0
      FXL = -P
      FXR = 1.0 - P
  105 CONTINUE
      X = (XL+XR)*0.5
      CALL FCACDF(X,U,SD,CDF)
      P1=CDF
      PPF=X
      FCS = P1 - P
      IF(FCS*FXL.GT.ZERO)GOTO110
      XR = X
      FXR = FCS 
      GOTO115
  110 CONTINUE
      XL = X
      FXL = FCS
  115 CONTINUE
      XRML = XR - XL
      IF(XRML.LE.SIG .AND. ABS(FCS).LE.EPS)GOTO9999
      IC = IC + 1
      IF(IC.LE.MAXIT)GOTO105
      WRITE(ICOUT,130)
      CALL DPWRST('XXX','BUG ')
  130 FORMAT('***** WARNING--FCAPPF ROUTINE DID NOT CONVERGE.')
      GOTO9999
C
 9999 CONTINUE
      RETURN
      END
      SUBROUTINE FCARAN(N,ALOC,ASCALE,ISEED,X)
C
C     PURPOSE--THIS SUBROUTINE GENERATES A RANDOM SAMPLE OF SIZE N
C              FROM THE FOLDED CAUCHY DISTRIBUTION.  THE FOLDED CAUCHY
C              IS THE ABSOLUTE VALUE OF A CAUCHY DISTRIBUTION.
C              GENERATE FOLDED CAUCHY RANDOM NUMBERS BY FINDING CAUCHY
C              RANDOM NUMBERS AND THEN TAKING ABSOLUTE VALUE.
C     INPUT  ARGUMENTS--N      = THE DESIRED INTEGER NUMBER
C                                OF RANDOM NUMBERS TO BE
C                                GENERATED.
C                     --ALOC   = LOCATION PARAMETER OF PARENT CAUCHY
C                                DISTRIBUTION.
C                     --ASCALE = SCALE PARAMETER OF PARENT CAUCHY
C                                DISTRIBUTION.
C                     --ISEED  = SEED FOR UNIFORM RANDOM NUMBER GENERATOR
C     OUTPUT ARGUMENTS--X      = A SINGLE PRECISION VECTOR
C                                (OF DIMENSION AT LEAST N)
C                                INTO WHICH THE GENERATED
C                                RANDOM SAMPLE WILL BE PLACED.
C     OUTPUT--A RANDOM SAMPLE OF SIZE N
C             FUNCTION VALUE FOR THE FOLDED CAUCHY DISTRIBUTION.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--THERE IS NO RESTRICTION ON THE MAXIMUM VALUE
C                   OF N FOR THIS SUBROUTINE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--UNIRAN.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--SIN, COS.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--TOCHER, THE ART OF SIMULATION,
C                 1963, PAGE 15.
C               --HAMMERSLEY AND HANDSCOMB, MONTE CARLO METHODS,
C                 1964, PAGE 36.
C               --FILLIBEN, SIMPLE AND ROBUST LINEAR ESTIMATION
C                 OF THE LOCATION PARAMETER OF A SYMMETRIC
C                 DISTRIBUTION (UNPUBLISHED PH.D. DISSERTATION,
C                 PRINCETON UNIVERSITY), 1969, PAGE 231.
C               --FILLIBEN, 'THE PERCENT POINT FUNCTION',
C                 (UNPUBLISHED MANUSCRIPT), 1970, PAGES 28-31.
C               --JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--1, 1970, PAGES 154-165.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1966)
C     VERSION NUMBER--2003/7
C     ORIGINAL VERSION--JULY      2003.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C---------------------------------------------------------------------
C
      DIMENSION X(*)
C
C---------------------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----DATA STATEMENTS-------------------------------------------------
C
      DATA PI/3.14159265359/
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(N.LT.1)THEN
        WRITE(ICOUT,5)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,47)N
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
    5 FORMAT('***** ERROR--THE REQUESTED NUMBER OF FOLDED CAUCHY ',
     1'RANDON NUMBERS IS NON-POSITIVE.')
   47 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',I8)
      IF(ASCALE.LE.0.0)THEN
        WRITE(ICOUT,15)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,48)ASCALE
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
   15 FORMAT('***** FATAL ERROR--THE SCALE PARAMETER FOR THE FOLDED ',
     1'CAUCHY RANDON NUMBERS IS NON-POSITIVE.')
   48 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',E15.7)
C
C     GENERATE N UNIFORM (0,1) RANDOM NUMBERS;
C
      CALL UNIRAN(N,ISEED,X)
C
C     GENERATE N CAUCHY RANDOM NUMBERS
C     USING THE PERCENT POINT FUNCTION TRANSFORMATION METHOD.
C     THEN APPLY LOCATION AND SCALE TRANSFORMATION AND TAKE ABSOLUTE VALUE.
C
      DO100I=1,N
        ARG=PI*X(I)
        X(I)=-COS(ARG)/SIN(ARG)
        X(I)=ABS(ALOC + ASCALE*X(I))
  100 CONTINUE
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE FCDF(X,NU1,NU2,CDF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE CUMULATIVE DISTRIBUTION
C              FUNCTION VALUE FOR THE F DISTRIBUTION
C              WITH INTEGER DEGREES OF FREEDOM
C              PARAMETERS = NU1 AND NU2.
C              THIS DISTRIBUTION IS DEFINED FOR ALL NON-NEGATIVE X.
C              THE PROBABILITY DENSITY FUNCTION IS GIVEN
C              IN THE REFERENCES BELOW.
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE AT
C                                WHICH THE CUMULATIVE DISTRIBUTION
C                                FUNCTION IS TO BE EVALUATED.
C                                X SHOULD BE NON-NEGATIVE.
C                     --NU1    = THE INTEGER DEGREES OF FREEDOM
C                                FOR THE NUMERATOR OF THE F RATIO.
C                                NU1 SHOULD BE POSITIVE.
C                     --NU2    = THE INTEGER DEGREES OF FREEDOM
C                                FOR THE DENOMINATOR OF THE F RATIO.
C                                NU2 SHOULD BE POSITIVE.
C     OUTPUT ARGUMENTS--CDF    = THE SINGLE PRECISION CUMULATIVE
C                                DISTRIBUTION FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION CUMULATIVE DISTRIBUTION
C             FUNCTION VALUE CDF FOR THE F DISTRIBUTION
C             WITH DEGREES OF FREEDOM
C             PARAMETERS = NU1 AND NU2.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--X SHOULD BE NON-NEGATIVE.
C                 --NU1 SHOULD BE A POSITIVE INTEGER VARIABLE.
C                 --NU2 SHOULD BE A POSITIVE INTEGER VARIABLE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NORCDF,CHSCDF.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--DSQRT, DATAN.
C     MODE OF INTERNAL OPERATIONS--DOUBLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY APPLIED MATHEMATICS
C                 SERIES 55, 1964, PAGES 946-947,
C                 FORMULAE 26.6.4, 26.6.5, 26.6.8, AND 26.6.15.
C               --JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--2, 1970, PAGE 83, FORMULA 20,
C                 AND PAGE 84, THIRD FORMULA.
C               --PAULSON, AN APPROXIMATE NORMAILIZATION
C                 OF THE ANALYSIS OF VARIANCE DISTRIBUTION,
C                 ANNALS OF MATHEMATICAL STATISTICS, 1942,
C                 NUMBER 13, PAGES 233-135.
C               --SCHEFFE AND TUKEY, A FORMULA FOR SAMPLE SIZES
C                 FOR POPULATION TOLERANCE LIMITS, 1944,
C                 NUMBER 15, PAGE 217.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1966)
C     VERSION NUMBER--82/7
C     ORIGINAL VERSION--AUGUST    1972.
C     UPDATED         --SEPTEMBER 1975.
C     UPDATED         --NOVEMBER  1975.
C     UPDATED         --OCTOBER   1976.
C     UPDATED         --DECEMBER  1981.
C     UPDATED         --MAY       1982.
C     UPDATED         --JANUARY   2021. SET PRINT TYPE TO "ERRO" (USER
C                                       CAN SUPPRESS ERROR MESSAGE IF
C                                       "SET ERROR MESSAGE OFF" ENTERED.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DX,PI,ANU1,ANU2,Z,SUM,TERM,AI,COEF1,COEF2,ARG
      DOUBLE PRECISION COEF
      DOUBLE PRECISION THETA,SINTH,COSTH,A,B
      DOUBLE PRECISION DSQRT,DATAN
      DOUBLE PRECISION DFACT1,DFACT2,DNUM,DDEN
      DOUBLE PRECISION DPOW1,DPOW2
      DOUBLE PRECISION DNU1,DNU2
      DOUBLE PRECISION TERM1,TERM2,TERM3
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----DATA STATEMENTS-------------------------------------------------
C
      DATA PI/3.14159265358979D0/
CCCCC DATA DPOW1,DPOW2/0.33333333333333D0,0.66666666666667D0/
C     THE FOLLOWING WAS COMMENTED OUT AND CHANGED
C     IN AUGUST OF 1986 DUE TO BOMB ON VAX
C     FOR FCDF(2,400,100)    .
C     CHANGING NUCUT2 FROM 1000 TO 250 WAS SUFFICIENT
C     TO SOLVE THE PROBLEM.
CCCCC DATA NUCUT1,NUCUT2/100,1000/
      DATA NUCUT1,NUCUT2/100,250/
C
C-----START POINT-----------------------------------------------------
C
      B=0.0
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      CDF=0.0
      IF(NU1.LE.0)THEN
        WRITE(ICOUT,15)
   15   FORMAT('***** ERROR--THE SECOND ARGUMENT TO FCDF IS ',
     1         'NON-POSITIVE.')
        CALL DPWRST('XXX','ERRO')
        WRITE(ICOUT,47)NU1
   47   FORMAT('***** THE VALUE OF THE ARGUMENT IS ',I8,'.')
        CALL DPWRST('XXX','ERRO')
        RETURN
      ELSEIF(NU2.LE.0)THEN
        WRITE(ICOUT,23)
   23   FORMAT('***** ERROR--THE THIRD ARGUMENT TO FCDF IS ',
     1         'NON-POSITIVE.')
        CALL DPWRST('XXX','ERRO')
        WRITE(ICOUT,47)NU2
        CALL DPWRST('XXX','ERRO')
        RETURN
      ELSEIF(X.LT.0.0)THEN
        WRITE(ICOUT,4)
    4   FORMAT('***** WARNING--THE FIRST ARGUMENT TO FCDF IS NEGATIVE.')
        CALL DPWRST('XXX','ERRO')
        WRITE(ICOUT,46)X
   46   FORMAT('***** THE VALUE OF THE ARGUMENT IS ',E15.7,'.')
        CALL DPWRST('XXX','ERRO')
        RETURN
      ENDIF
C
      DX=X
      M=NU1
      N=NU2
      ANU1=NU1
      ANU2=NU2
      DNU1=NU1
      DNU2=NU2
C
C     IF X IS NON-POSITIVE, SET CDF = 0.0 AND RETURN.
C     IF NU2 IS 5 THROUGH 9 AND X IS MORE THAN 3000
C     STANDARD DEVIATIONS BELOW THE MEAN,
C     SET CDF = 0.0 AND RETURN.
C     IF NU2 IS 10 OR LARGER AND X IS MORE THAN 150
C     STANDARD DEVIATIONS BELOW THE MEAN,
C     SET CDF = 0.0 AND RETURN.
C     IF NU2 IS 5 THROUGH 9 AND X IS MORE THAN 3000
C     STANDARD DEVIATIONS ABOVE THE MEAN,
C     SET CDF = 1.0 AND RETURN.
C     IF NU2 IS 10 OR LARGER AND X IS MORE THAN 150
C     STANDARD DEVIATIONS ABOVE THE MEAN,
C     SET CDF = 1.0 AND RETURN.
C
      IF(X.LE.0.0)GOTO105
      IF(NU2.LE.4)GOTO109
      T1=2.0/ANU1
      T2=ANU2/(ANU2-2.0)
      T3=(ANU1+ANU2-2.0)/(ANU2-4.0)
      AMEAN=T2
      SD=SQRT(T1*T2*T2*T3)
      ZRATIO=(X-AMEAN)/SD
      IF(NU2.LT.10.AND.ZRATIO.LT.-3000.0)GOTO105
      IF(NU2.GE.10.AND.ZRATIO.LT.-150.0)GOTO105
      IF(NU2.LT.10.AND.ZRATIO.GT.3000.0)GOTO107
      IF(NU2.GE.10.AND.ZRATIO.GT.150.0)GOTO107
      GOTO109
  105 CDF=0.0
      RETURN
  107 CDF=1.0
      RETURN
  109 CONTINUE
C
C     DISTINGUISH BETWEEN 6 SEPARATE REGIONS
C     OF THE (NU1,NU2) SPACE.
C     BRANCH TO THE PROPER COMPUTATIONAL METHOD
C     DEPENDING ON THE REGION.
C     NUCUT1 HAS THE VALUE 100.
C     NUCUT2 HAS THE VALUE 1000.
C
      IF(NU1.LT.NUCUT2.AND.NU2.LT.NUCUT2)GOTO1000
      IF(NU1.GE.NUCUT2.AND.NU2.GE.NUCUT2)GOTO2000
      IF(NU1.LT.NUCUT1.AND.NU2.GE.NUCUT2)GOTO3000
      IF(NU1.GE.NUCUT1.AND.NU2.GE.NUCUT2)GOTO2000
      IF(NU1.GE.NUCUT2.AND.NU2.LT.NUCUT1)GOTO5000
      IF(NU1.GE.NUCUT2.AND.NU2.GE.NUCUT1)GOTO2000
      IBRAN=5
      WRITE(ICOUT,99)IBRAN
   99 FORMAT('*****INTERNAL ERROR IN   FCDF SUBROUTINE--',
     1'IMPOSSIBLE BRANCH CONDITION AT BRANCH POINT = ',I8)
      CALL DPWRST('XXX','ERRO')
      RETURN
C
C     TREAT THE CASE WHEN NU1 AND NU2
C     ARE BOTH SMALL OR MODERATE
C     (THAT IS, BOTH ARE SMALLER THAN 1000).
C     METHOD UTILIZED--EXACT FINITE SUM
C     (SEE AMS 55, PAGE 946, FORMULAE 26.6.4, 26.6.5,
C     AND 26.6.8).
C
 1000 CONTINUE
      Z=ANU2/(ANU2+ANU1*DX)
      IFLAG1=NU1-2*(NU1/2)
      IFLAG2=NU2-2*(NU2/2)
      IF(IFLAG1.EQ.0)GOTO120
      IF(IFLAG2.EQ.0)GOTO150
      GOTO250
C
C     DO THE NU1 EVEN AND NU2 EVEN OR ODD CASE
C
  120 SUM=0.0D0
      TERM=1.0D0
      IMAX=(M-2)/2
      IF(IMAX.LE.0)GOTO110
      DO100I=1,IMAX
      AI=I
      COEF1=2.0D0*(AI-1.0D0)
      COEF2=2.0D0*AI
      TERM=TERM*((ANU2+COEF1)/COEF2)*(1.0D0-Z)
      SUM=SUM+TERM
  100 CONTINUE
C
  110 SUM=SUM+1.0D0
      SUM=(Z**(ANU2/2.0D0))*SUM
      CDF=1.0D0-SUM
      RETURN
C
C     DO THE NU1 ODD AND NU2 EVEN CASE
C
  150 SUM=0.0D0
      TERM=1.0D0
      IMAX=(N-2)/2
      IF(IMAX.LE.0)GOTO210
      DO200I=1,IMAX
      AI=I
      COEF1=2.0D0*(AI-1.0D0)
      COEF2=2.0D0*AI
      TERM=TERM*((ANU1+COEF1)/COEF2)*Z
      SUM=SUM+TERM
  200 CONTINUE
C
  210 SUM=SUM+1.0D0
      CDF=((1.0D0-Z)**(ANU1/2.0D0))*SUM
      RETURN
C
C     DO THE NU1 ODD AND NU2 ODD CASE
C
  250 SUM=0.0D0
      TERM=1.0D0
      ARG=DSQRT((ANU1/ANU2)*DX)
      THETA=DATAN(ARG)
      SINTH=ARG/DSQRT(1.0D0+ARG*ARG)
      COSTH=1.0D0/DSQRT(1.0D0+ARG*ARG)
      IF(N.EQ.1)GOTO320
      IF(N.EQ.3)GOTO310
      IMAX=N-2
      DO300I=3,IMAX,2
      AI=I
      COEF1=AI-1.0D0
      COEF2=AI
      TERM=TERM*(COEF1/COEF2)*(COSTH*COSTH)
      SUM=SUM+TERM
  300 CONTINUE
C
  310 SUM=SUM+1.0D0
      SUM=SUM*SINTH*COSTH
C
  320 CONTINUE
      A=(2.0D0/PI)*(THETA+SUM)
      SUM=0.0D0
      TERM=1.0D0
      IF(M.EQ.1)B=0.0D0
      IF(M.EQ.1)GOTO450
      IF(M.EQ.3)GOTO410
      IMAX=M-3
      DO400I=1,IMAX,2
      AI=I
      COEF1=AI
      COEF2=AI+2.0D0
      TERM=TERM*((ANU2+COEF1)/COEF2)*(SINTH*SINTH)
      SUM=SUM+TERM
  400 CONTINUE
C
  410 SUM=SUM+1.0D0
      SUM=SUM*SINTH*(COSTH**N)
      COEF=1.0D0
      IEVODD=N-2*(N/2)
      IMIN=3
      IF(IEVODD.EQ.0)IMIN=2
      IF(IMIN.GT.N)GOTO420
      DO430I=IMIN,N,2
      AI=I
      COEF=((AI-1.0D0)/AI)*COEF
  430 CONTINUE
C
  420 COEF=COEF*ANU2
      IF(IEVODD.EQ.0)GOTO440
      COEF=COEF*(2.0D0/PI)
C
  440 B=COEF*SUM
C
  450 CDF=A-B
      RETURN
C
C     TREAT THE CASE WHEN NU1 AND NU2
C     ARE BOTH LARGE
C     (THAT IS, BOTH ARE EQUAL TO OR LARGER THAN 1000);
C     OR WHEN NU1 IS MODERATE AND NU2 IS LARGE
C     (THAT IS, WHEN NU1 IS EQUAL TO OR GREATER THAN 100
C     BUT SMALLER THAN 1000,
C     AND NU2 IS EQUAL TO OR LARGER THAN 1000);
C     OR WHEN NU2 IS MODERATE AND NU1 IS LARGE
C     (THAT IS WHEN NU2 IS EQUAL TO OR GREATER THAN 100
C     BUT SMALLER THAN 1000,
C     AND NU1 IS EQUAL TO OR LARGER THAN 1000).
C     METHOD UTILIZED--PAULSON APPROXIMATION
C     (SEE AMS 55, PAGE 947, FORMULA 26.6.15).
C
 2000 CONTINUE
      DFACT1=1.0D0/(4.5D0*DNU1)
      DFACT2=1.0D0/(4.5D0*DNU2)
      DPOW1=1.0D0/3.0D0
      DPOW2=2.0D0/3.0D0
      DNUM=((1.0D0-DFACT2)*(DX**DPOW1))-(1.0D0-DFACT1)
      DDEN=DSQRT((DFACT2*(DX**DPOW2))+DFACT1)
      U=DNUM/DDEN
      CALL NORCDF(U,GCDF)
      CDF=GCDF
      RETURN
C
C     TREAT THE CASE WHEN NU1 IS SMALL
C     AND NU2 IS LARGE
C     (THAT IS, WHEN NU1 IS SMALLER THAN 100,
C     AND NU2 IS EQUAL TO OR LARGER THAN 1000).
C     METHOD UTILIZED--SHEFFE-TUKEY APPROXIMATION
C     (SEE JOHNSON AND KOTZ, VOLUME 2, PAGE 84, THIRD FORMULA).
C
 3000 CONTINUE
      TERM1=DNU1
      TERM2=(DNU1/DNU2)*(0.5D0*DNU1-1.0D0)
      TERM3=-(DNU1/DNU2)*0.5D0
      U=(TERM1+TERM2)/((1.0D0/DX)-TERM3)
      CALL CHSCDF(U,NU1,CCDF)
      CDF=CCDF
      RETURN
C
C     TREAT THE CASE WHEN NU2 IS SMALL
C     AND NU1 IS LARGE
C     (THAT IS, WHEN NU2 IS SMALLER THAN 100,
C     AND NU1 IS EQUAL TO OR LARGER THAN 1000).
C     METHOD UTILIZED--SHEFFE-TUKEY APPROXIMATION
C     (SEE JOHNSON AND KOTZ, VOLUME 2, PAGE 84, THIRD FORMULA).
C
 5000 CONTINUE
      TERM1=DNU2
      TERM2=(DNU2/DNU1)*(0.5D0*DNU2-1.0D0)
      TERM3=-(DNU2/DNU1)*0.5D0
      U=(TERM1+TERM2)/(DX-TERM3)
      CALL CHSCDF(U,NU2,CCDF)
      CDF=1.0-CCDF
      RETURN
C
      END
      SUBROUTINE F2CDF(X,ANU1,ANU2,CDF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE CUMULATIVE DISTRIBUTION
C              FUNCTION VALUE FOR THE F DISTRIBUTION WHERE FRACTIONAL
C              DEGREES OF FREEDOM ARE SUPPORTED.  IT IS BASED ON THE
C              RELATIONSHIP BETWEEN AN F DISTRIBUTION AND A BETA
C              DISTRIBUTION.
C
C                 IF X IS DISTRIBUTED AS F WITH V1 AND V2 DEGREES
C                 OF FREEDOM, THEN
C
C                      (V1*X/V2)/(1 + (V1*X/V2))
C
C                 IS DISTRIBUTED AS A BETA WITH PARAMETERS
C                 V1/2 AND V2/2.
C
C              THIS DISTRIBUTION IS DEFINED FOR ALL NON-NEGATIVE X.
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE AT
C                                WHICH THE CUMULATIVE DISTRIBUTION
C                                FUNCTION IS TO BE EVALUATED.
C                                X SHOULD BE NON-NEGATIVE.
C                     --ANU1   = THE REAL DEGREES OF FREEDOM
C                                FOR THE NUMERATOR OF THE F RATIO.
C                                ANU1 SHOULD BE POSITIVE.
C                     --ANU2   = THE REAL DEGREES OF FREEDOM
C                                FOR THE DENOMINATOR OF THE F RATIO.
C                                ANU2 SHOULD BE POSITIVE.
C     OUTPUT ARGUMENTS--CDF    = THE SINGLE PRECISION CUMULATIVE
C                                DISTRIBUTION FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION CUMULATIVE DISTRIBUTION FUNCTION
C             VALUE CDF FOR THE F DISTRIBUTION WITH DEGREES OF FREEDOM
C             PARAMETERS NU1 AND NU2.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--X SHOULD BE NON-NEGATIVE.
C                 --ANU1 SHOULD BE POSITIVE.
C                 --ANU2 SHOULD BE POSITIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--BETCDF.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--NONE
C     MODE OF INTERNAL OPERATIONS--DOUBLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--XX
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2023/06
C     ORIGINAL VERSION--JUNE      2023.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DX
      DOUBLE PRECISION DCDF
      DOUBLE PRECISION DNU1
      DOUBLE PRECISION DNU2
      DOUBLE PRECISION DTERM1
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----DATA STATEMENTS-------------------------------------------------
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      CDF=0.0
      IF(ANU1.LT.1.0)THEN
        WRITE(ICOUT,15)
   15   FORMAT('***** ERROR--THE SECOND ARGUMENT TO F2CDF IS ',
     1         '< 1.')
        CALL DPWRST('XXX','ERRO')
        WRITE(ICOUT,4)ANU1
        CALL DPWRST('XXX','ERRO')
        GOTO9000
      ELSEIF(ANU2.LT.1.0)THEN
        WRITE(ICOUT,23)
   23   FORMAT('***** ERROR--THE THIRD ARGUMENT TO F2CDF IS ',
     1         '< 1.')
        CALL DPWRST('XXX','ERRO')
        WRITE(ICOUT,4)ANU2
        CALL DPWRST('XXX','ERRO')
        GOTO9000
      ELSEIF(X.LT.0.0)THEN
        WRITE(ICOUT,4)
    4   FORMAT('***** ERROR--THE FIRST ARGUMENT TO FCDF IS NEGATIVE.')
        CALL DPWRST('XXX','ERRO')
        WRITE(ICOUT,46)X
   46   FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7,'.')
        CALL DPWRST('XXX','ERRO')
        GOTO9000
      ENDIF
C
      DX=DBLE(X)
      DNU1=DBLE(ANU1)
      DNU2=DBLE(ANU2)
      DTERM1=DNU1*DX/DNU2
      DX=DTERM1/(1.0D0 + DTERM1)
C
      DNU1=DNU1/2.0D0
      DNU2=DNU2/2.0D0
      IF(DX.LE.0.0D0)THEN
        CDF=0.0
      ELSEIF(DX.GE.1.0D0)THEN
        CDF=1.0
      ELSE
        DCDF=DBETAI(DX,DNU1,DNU2)
        CDF=REAL(DCDF)
      ENDIF
C
 9000 CONTINUE
      RETURN
      END
      FUNCTION F2FUN(X0)
C
C   COMPUTE F2CDF FUNCTION USED IN F2PDF ROUTINE (I.E.,
C   COMPUTE PDF BY DIFFERENTIATING THE CDF FUNCTION).
C
      COMMON/F2COMM/ANU1,ANU2
C
      CALL F2CDF(X0,ANU1,ANU2,FCDF)
      F2FUN=FCDF
C
      RETURN
      END
      DOUBLE PRECISION FUNCTION FDM0P5(XVALUE)
C
C   DESCRIPTION:
C
C      This function computes the Fermi-Dirac function of
C      order -1/2, defined as
C
C                     Int{0 to inf} t**(-1/2) / (1+exp(t-x)) dt
C         FDM0P5(x) = -----------------------------------------
C                                 Gamma(1/2)
C
C      The function uses Chebyshev expansions which are given to
C      16 decimal places for x <= 2, but only 10 decimal places 
C      for x > 2.
C
C
C   ERROR RETURNS:
C    
C      None.
C
C
C   MACHINE-DEPENDENT CONSTANTS:
C
C      NTERMS1 - INTEGER - The number of terms used from the array
C                          ARRFD1. The recommended value is such that
C                               ABS(ARRFD1(NTERMS1)) < EPS/10
C                          subject to 1 <= NTERMS1 <= 14.
C
C      NTERMS2 - INTEGER - The number of terms used from the array
C                          ARRFD2. The recommended value is such that
C                               ABS(ARRFD2(NTERMS2)) < EPS/10
C                          subject to 1 <= NTERMS1 <= 23.
C
C      NTERMS3 - INTEGER - The number of terms used from the array
C                          ARRFD3. The recommended value is such that
C                               ABS(ARRFD3(NTERMS3)) < EPS/10
C                          subject to 1 <= NTERMS3 <= 28.
C
C      XMIN1 - REAL - The value of x below which
C                         FDM0P5(x) = exp(x)
C                     to machine precision. The recommended value
C                     is    LN ( SQRT(2) * EPSNEG )
C
C      XMIN2 - REAL - The value of x below which
C                         FDM0P5(x) = 0.0 
C                     to machine precision. The recommended value
C                     is    LN ( XMIN )
C
C      XHIGH - REAL - The value of x above which
C                         FDM0P5(x) = 2 sqrt (x/pi) 
C                     to machine precision. The recommended value
C                     is    1 / sqrt( 2 * EPSNEG )
C
C      For values of EPS, EPSNEG, and XMIN the user should refer to the
C      paper by Cody in ACM. Trans. Math. Soft. Vol. 14 (1988) p303-311.
C   
C      This code is provided with single and double precision values
C      of the machine-dependent parameters, suitable for machines
C      which satisfy the IEEE floating-point standard.
C
C
C   AUTHOR:
C          DR. ALLAN MACLEOD,
C          DEPT. OF MATHEMATICS AND STATISTICS,
C          UNIVERSITY OF PAISLEY,
C          HIGH ST.,
C          PAISLEY,
C          SCOTLAND
C          PA1 2BE
C
C          (e-mail: macl-ms0@paisley.ac.uk )
C
C
C   LATEST UPDATE:
C                 20 NOVEMBER, 1996
C
      INTEGER NTERM1,NTERM2,NTERM3
      DOUBLE PRECISION
     1     ARRFD1(0:14),ARRFD2(0:23),ARRFD3(0:58),
     2     CHEVAL,CHV,EXPX,FIFTY,FORTY2,
     3     GAM1P5,ONE,T,THREE,TWO,TWOE,
     4     X,XHIGH,XMIN1,XMIN2,XSQ,XVALUE,ZERO
      DATA ARRFD1/1.7863 5963 8510 2264  D   0,
     1           -0.9993 7200 7632 333   D  -1,
     2            0.6414 4652 2160 54    D  -2,
     3           -0.4356 4153 7134 5     D  -3,
     4            0.3052 1670 0310       D  -4,
     5           -0.2181 0648 110        D  -5,
     6            0.1580 0507 81         D  -6,
     7           -0.1156 2057 0          D  -7,
     8            0.8525 860             D  -9,
     9           -0.6325 29              D -10,
     X            0.4715 9               D -11,
     1           -0.3530                 D -12,
     2            0.265                  D -13,
     3           -0.20                   D -14,
     4            0.2                    D -15/
      DATA ARRFD2( 0)/ 1.6877 1115 2605 2352  D   0/
      DATA ARRFD2( 1)/ 0.5978 3602 2633 6983  D   0/
      DATA ARRFD2( 2)/ 0.3572 2600 4541 669   D  -1/
      DATA ARRFD2( 3)/-0.1321 4478 6506 426   D  -1/
      DATA ARRFD2( 4)/-0.4040 1342 0744 7     D  -3/
      DATA ARRFD2( 5)/ 0.5330 0118 4688 7     D  -3/
      DATA ARRFD2( 6)/-0.1489 2350 4863       D  -4/
      DATA ARRFD2( 7)/-0.2188 6382 2916       D  -4/
      DATA ARRFD2( 8)/ 0.1965 2084 277        D  -5/
      DATA ARRFD2( 9)/ 0.8565 8304 66         D  -6/
      DATA ARRFD2(10)/-0.1407 7231 33         D  -6/
      DATA ARRFD2(11)/-0.3051 7580 3          D  -7/
      DATA ARRFD2(12)/ 0.8352 4532            D  -8/
      DATA ARRFD2(13)/ 0.9025 750             D  -9/
      DATA ARRFD2(14)/-0.4455 471             D  -9/
      DATA ARRFD2(15)/-0.1483 42              D -10/
      DATA ARRFD2(16)/ 0.2192 66              D -10/
      DATA ARRFD2(17)/-0.6579                 D -12/
      DATA ARRFD2(18)/-0.1000 9               D -11/
      DATA ARRFD2(19)/ 0.936                  D -13/
      DATA ARRFD2(20)/ 0.420                  D -13/
      DATA ARRFD2(21)/-0.71                   D -14/
      DATA ARRFD2(22)/-0.16                   D -14/
      DATA ARRFD2(23)/ 0.4                    D -15/
      DATA ARRFD3(0)/  0.8707 1950 2959 0563  D    0/
      DATA ARRFD3(1)/  0.5983 3110 2317 33    D   -2/
      DATA ARRFD3(2)/ -0.4326 7047 0895 746   D   -1/
      DATA ARRFD3(3)/ -0.3930 8368 1608 590   D   -1/
      DATA ARRFD3(4)/ -0.1914 8268 8045 932   D   -1/
      DATA ARRFD3(5)/ -0.6558 2880 9801 58    D   -2/
      DATA ARRFD3(6)/ -0.2227 6691 5163 12    D   -2/
      DATA ARRFD3(7)/ -0.8466 7869 3617 8     D   -3/
      DATA ARRFD3(8)/ -0.2807 4594 8921 9     D   -3/
      DATA ARRFD3(9)/ -0.9555 7502 4348       D   -4/
      DATA ARRFD3(10)/-0.3623 6766 2803       D   -4/
      DATA ARRFD3(11)/-0.1091 5846 8869       D   -4/
      DATA ARRFD3(12)/-0.3935 6701 000        D   -5/
      DATA ARRFD3(13)/-0.1310 8192 725        D   -5/
      DATA ARRFD3(14)/-0.2468 8163 88         D   -6/
      DATA ARRFD3(15)/-0.1048 3803 11         D   -6/
      DATA ARRFD3(16)/ 0.2361 8148 7          D   -7/
      DATA ARRFD3(17)/ 0.2271 4535 9          D   -7/
      DATA ARRFD3(18)/ 0.1457 7517 4          D   -7/
      DATA ARRFD3(19)/ 0.1539 2676 7          D   -7/
      DATA ARRFD3(20)/ 0.5692 4772            D   -8/
      DATA ARRFD3(21)/ 0.5062 3068            D   -8/
      DATA ARRFD3(22)/ 0.2342 6075            D   -8/
      DATA ARRFD3(23)/ 0.1265 2275            D   -8/
      DATA ARRFD3(24)/ 0.8927 773             D   -9/
      DATA ARRFD3(25)/ 0.2994 501             D   -9/
      DATA ARRFD3(26)/ 0.2822 785             D   -9/
      DATA ARRFD3(27)/ 0.9106 85              D  -10/
      DATA ARRFD3(28)/ 0.6962 85              D  -10/
      DATA ARRFD3(29)/ 0.3662 25              D  -10/
      DATA ARRFD3(30)/ 0.1243 51              D  -10/
      DATA ARRFD3(31)/ 0.1450 19              D  -10/
      DATA ARRFD3(32)/ 0.1664 5               D  -11/
      DATA ARRFD3(33)/ 0.4585 6               D  -11/
      DATA ARRFD3(34)/ 0.6092                 D  -12/
      DATA ARRFD3(35)/ 0.9331                 D  -12/
      DATA ARRFD3(36)/ 0.5238                 D  -12/
      DATA ARRFD3(37)/-0.56                   D  -14/
      DATA ARRFD3(38)/ 0.3170                 D  -12/
      DATA ARRFD3(39)/-0.926                  D  -13/
      DATA ARRFD3(40)/ 0.1265                 D  -12/
      DATA ARRFD3(41)/-0.327                  D  -13/
      DATA ARRFD3(42)/ 0.276                  D  -13/
      DATA ARRFD3(43)/ 0.33                   D  -14/
      DATA ARRFD3(44)/-0.42                   D  -14/
      DATA ARRFD3(45)/ 0.101                  D  -13/
      DATA ARRFD3(46)/-0.73                   D  -14/
      DATA ARRFD3(47)/ 0.64                   D  -14/
      DATA ARRFD3(48)/-0.37                   D  -14/
      DATA ARRFD3(49)/ 0.23                   D  -14/
      DATA ARRFD3(50)/-0.9                    D  -15/
      DATA ARRFD3(51)/ 0.2                    D  -15/
      DATA ARRFD3(52)/ 0.2                    D  -15/
      DATA ARRFD3(53)/-0.3                    D  -15/
      DATA ARRFD3(54)/ 0.4                    D  -15/
      DATA ARRFD3(55)/-0.3                    D  -15/
      DATA ARRFD3(56)/ 0.2                    D  -15/
      DATA ARRFD3(57)/-0.1                    D  -15/
      DATA ARRFD3(58)/ 0.1                    D  -15/
      DATA ZERO,ONE,TWO/ 0.0 D 0 , 1.0 D 0 , 2.0 D 0/
      DATA THREE,FORTY2,FIFTY/ 3.0 D 0 , 42.0 D 0 , 50.0 D 0/
      DATA GAM1P5/0.8862 2692 5452 7580 D 0/
      DATA TWOE/5.4365 6365 6918 0905 D 0/
C
C   Machine-dependent constants
C
      DATA NTERM1,NTERM2,NTERM3/14,23,58/
      DATA XMIN1,XMIN2,XHIGH/-36.39023D0,-708.39641D0,67108864.0D0/
C
C   Start calculation
C
      X=XVALUE
C
C   Code for x < -1
C
      IF ( X .LT. -ONE ) THEN
         IF ( X .GT. XMIN1 ) THEN
            EXPX = EXP(X)
            T = TWOE * EXPX - ONE
            FDM0P5 = EXPX * CHEVAL ( NTERM1 , ARRFD1 , T )
         ELSE
            IF ( X .LT. XMIN2 ) THEN
               FDM0P5 = ZERO
            ELSE
               FDM0P5 = EXP(X)
            ENDIF
         ENDIF
      ELSE
C
C   Code for -1 <= x <= 2
C
         IF ( X .LE. TWO ) THEN
            T = ( TWO * X - ONE ) / THREE
            FDM0P5 = CHEVAL ( NTERM2 , ARRFD2 , T )
         ELSE
C
C   Code for x > 2
C
            FDM0P5 = SQRT(X) / GAM1P5
            IF ( X .LE. XHIGH ) THEN 
               XSQ = X * X
               T = ( FIFTY - XSQ ) / ( FORTY2 + XSQ )
               CHV = CHEVAL ( NTERM3 , ARRFD3 , T )
               FDM0P5 = FDM0P5 * ( ONE - CHV / XSQ )
            ENDIF
         ENDIF
      ENDIF
      RETURN
      END
      DOUBLE PRECISION FUNCTION FDP0P5(XVALUE)
C
C   DESCRIPTION:
C
C      This function computes the Fermi-Dirac function of
C      order 1/2, defined as
C
C                     Int{0 to inf} t**(1/2) / (1+exp(t-x)) dt
C         FDP0P5(x) = -----------------------------------------
C                                 Gamma(3/2)
C
C      The function uses Chebyshev expansions which are given to
C      16 decimal places for x <= 2, but only 10 decimal places 
C      for x > 2.
C
C
C   ERROR RETURNS:
C    
C      If XVALUE too large and positive, the function value
C      will overflow. An error message is printed and the function
C      returns the value 0.0.
C
C
C   MACHINE-DEPENDENT CONSTANTS:
C
C      NTERMS1 - INTEGER - The number of terms used from the array
C                          ARRFD1. The recommended value is such that
C                               ABS(ARRFD1(NTERMS1)) < EPS/10
C                          subject to 1 <= NTERMS1 <= 13.
C
C      NTERMS2 - INTEGER - The number of terms used from the array
C                          ARRFD2. The recommended value is such that
C                               ABS(ARRFD2(NTERMS2)) < EPS/10
C                          subject to 1 <= NTERMS1 <= 23.
C
C      NTERMS3 - INTEGER - The number of terms used from the array
C                          ARRFD3. The recommended value is such that
C                               ABS(ARRFD3(NTERMS3)) < EPS/10
C                          subject to 1 <= NTERMS3 <= 32.
C
C      XMIN1 - REAL - The value of x below which
C                         FDP0P5(x) = exp(x)
C                     to machine precision. The recommended value
C                     is   1.5*LN(2) + LN(EPSNEG)
C
C      XMIN2 - REAL - The value of x below which
C                         FDP0P5(x) = 0.0 
C                     to machine precision. The recommended value
C                     is    LN ( XMIN )
C
C      XHIGH1 - REAL - The value of x above which
C                         FDP0P5(x) = x**(3/2)/GAMMA(5/2)
C                     to machine precision. The recommended value
C                     is   pi / SQRT(8*EPS)
C
C      XHIGH2 - REAL - The value of x above which FDP0P5 would 
C                      overflow. The reommended value is
C                              (1.329*XMAX)**(2/3)
C
C      For values of EPS, EPSNEG, and XMIN the user should refer to the
C      paper by Cody in ACM. Trans. Math. Soft. Vol. 14 (1988) p303-311.
C   
C      This code is provided with single and double precision values
C      of the machine-dependent parameters, suitable for machines
C      which satisfy the IEEE floating-point standard.
C
C
C   AUTHOR:
C          DR. ALLAN MACLEOD,
C          DEPT. OF MATHEMATICS AND STATISTICS,
C          UNIVERSITY OF PAISLEY,
C          HIGH ST.,
C          PAISLEY,
C          SCOTLAND
C          PA1 2BE
C
C          (e-mail: macl-ms0@paisley.ac.uk )
C
C
C   LATEST UPDATE:
C                 20 NOVEMBER, 1996
C
      INTEGER NTERM1,NTERM2,NTERM3
      DOUBLE PRECISION
     1     ARRFD1(0:13),ARRFD2(0:23),ARRFD3(0:53),
     2     CHEVAL,CHV,EXPX,FIFTY,FORTY2,
     3     GAM2P5,ONE,T,THREE,TWO,TWOE,X,XHIGH1,
     4     XHIGH2,XMIN1,XMIN2,XSQ,XVALUE,ZERO
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
      DATA ARRFD1/1.8862 9683 9273 4597  D   0,
     1           -0.5435 8081 7644 053   D  -1,
     2            0.2364 4975 4397 20    D  -2,
     3           -0.1216 9293 6588 0     D  -3,
     4            0.6869 5130 622        D  -5,
     5           -0.4112 0761 72         D  -6,
     6            0.2563 5162 8          D  -7,
     7           -0.1646 5008            D  -8,
     8            0.1081 948             D  -9,
     9           -0.7239 2               D -11,
     X            0.4915                 D -12,
     1           -0.338                  D -13,
     2            0.23                   D -14,
     3           -0.2                    D -15/
      DATA ARRFD2( 0)/ 2.6982 4927 8817 0612  D   0/
      DATA ARRFD2( 1)/ 1.2389 9141 4113 3012  D   0/
      DATA ARRFD2( 2)/ 0.2291 4393 7981 6278  D   0/
      DATA ARRFD2( 3)/ 0.9031 6534 6872 79    D  -2/
      DATA ARRFD2( 4)/-0.2577 6524 6912 46    D  -2/
      DATA ARRFD2( 5)/-0.5836 8160 5388       D  -4/
      DATA ARRFD2( 6)/ 0.6936 0945 8725       D  -4/
      DATA ARRFD2( 7)/-0.1806 1670 265        D  -5/
      DATA ARRFD2( 8)/-0.2132 1530 005        D  -5/
      DATA ARRFD2( 9)/ 0.1754 9839 51         D  -6/
      DATA ARRFD2(10)/ 0.6653 2547 0          D  -7/
      DATA ARRFD2(11)/-0.1016 7597 7          D  -7/
      DATA ARRFD2(12)/-0.1963 7597            D  -8/
      DATA ARRFD2(13)/ 0.5075 769             D  -9/
      DATA ARRFD2(14)/ 0.4914 69              D -10/
      DATA ARRFD2(15)/-0.2337 37              D -10/
      DATA ARRFD2(16)/-0.6645                 D -12/
      DATA ARRFD2(17)/ 0.1011 5               D -11/
      DATA ARRFD2(18)/-0.313                  D -13/
      DATA ARRFD2(19)/-0.412                  D -13/
      DATA ARRFD2(20)/ 0.38                   D -14/
      DATA ARRFD2(21)/ 0.16                   D -14/
      DATA ARRFD2(22)/-0.3                    D -15/
      DATA ARRFD2(23)/-0.1                    D -15/
      DATA ARRFD3(0)/  2.5484 3841 9800 9122  D    0/
      DATA ARRFD3(1)/  0.5104 3940 8960 652   D   -1/
      DATA ARRFD3(2)/  0.7749 3527 6282 94    D   -2/
      DATA ARRFD3(3)/ -0.7504 1656 5849 53    D   -2/
      DATA ARRFD3(4)/ -0.7754 0826 3202 96    D   -2/
      DATA ARRFD3(5)/ -0.4581 0844 5399 77    D   -2/
      DATA ARRFD3(6)/ -0.2343 1641 5873 63    D   -2/
      DATA ARRFD3(7)/ -0.1178 8049 5135 91    D   -2/
      DATA ARRFD3(8)/ -0.5802 7393 5970 2     D   -3/
      DATA ARRFD3(9)/ -0.2825 3507 0053 7     D   -3/
      DATA ARRFD3(10)/-0.1388 1366 5179 9     D   -3/
      DATA ARRFD3(11)/-0.6806 9508 4875       D   -4/
      DATA ARRFD3(12)/-0.3353 5635 0608       D   -4/
      DATA ARRFD3(13)/-0.1665 3301 8734       D   -4/
      DATA ARRFD3(14)/-0.8271 4908 266        D   -5/
      DATA ARRFD3(15)/-0.4142 5714 409        D   -5/
      DATA ARRFD3(16)/-0.2080 5255 294        D   -5/
      DATA ARRFD3(17)/-0.1047 9767 478        D   -5/
      DATA ARRFD3(18)/-0.5315 2738 02         D   -6/
      DATA ARRFD3(19)/-0.2694 0611 78         D   -6/
      DATA ARRFD3(20)/-0.1374 8787 49         D   -6/
      DATA ARRFD3(21)/-0.7023 0888 7          D   -7/
      DATA ARRFD3(22)/-0.3595 4394 2          D   -7/
      DATA ARRFD3(23)/-0.1851 0612 6          D   -7/
      DATA ARRFD3(24)/-0.9502 3937            D   -8/
      DATA ARRFD3(25)/-0.4918 4811            D   -8/
      DATA ARRFD3(26)/-0.2537 1950            D   -8/
      DATA ARRFD3(27)/-0.1315 1532            D   -8/
      DATA ARRFD3(28)/-0.6835 168             D   -9/
      DATA ARRFD3(29)/-0.3538 244             D   -9/
      DATA ARRFD3(30)/-0.1853 182             D   -9/
      DATA ARRFD3(31)/-0.9589 83              D  -10/
      DATA ARRFD3(32)/-0.5040 83              D  -10/
      DATA ARRFD3(33)/-0.2622 38              D  -10/
      DATA ARRFD3(34)/-0.1372 55              D  -10/
      DATA ARRFD3(35)/-0.7234 0               D  -11/
      DATA ARRFD3(36)/-0.3742 9               D  -11/
      DATA ARRFD3(37)/-0.2005 9               D  -11/
      DATA ARRFD3(38)/-0.1026 9               D  -11/
      DATA ARRFD3(39)/-0.5551                 D  -12/
      DATA ARRFD3(40)/-0.2857                 D  -12/
      DATA ARRFD3(41)/-0.1520                 D  -12/
      DATA ARRFD3(42)/-0.811                  D  -13/
      DATA ARRFD3(43)/-0.410                  D  -13/
      DATA ARRFD3(44)/-0.234                  D  -13/
      DATA ARRFD3(45)/-0.110                  D  -13/
      DATA ARRFD3(46)/-0.67                   D  -14/
      DATA ARRFD3(47)/-0.30                   D  -14/
      DATA ARRFD3(48)/-0.19                   D  -14/
      DATA ARRFD3(49)/-0.9                    D  -15/
      DATA ARRFD3(50)/-0.5                    D  -15/
      DATA ARRFD3(51)/-0.3                    D  -15/
      DATA ARRFD3(52)/-0.1                    D  -15/
      DATA ARRFD3(53)/-0.1                    D  -15/
      DATA ZERO,ONE,TWO/ 0.0 D 0 , 1.0 D 0 , 2.0 D 0/
      DATA THREE,FORTY2,FIFTY/ 3.0 D 0 , 42.0 D 0 , 50.0 D 0/
      DATA GAM2P5/0.1329 3403 8817 9137 D 1/
      DATA TWOE/5.4365 6365 6918 0905 D 0/
C
C   Machine-dependent constants (suitable for IEEE machines)
C
      DATA NTERM1,NTERM2,NTERM3/13,23,53/
      DATA XMIN1,XMIN2/-35.7D00,-708.394D00/
      DATA XHIGH1,XHIGH2/7.45467D7,3.8392996D205/
C
C   Start calculation
C
      X=XVALUE
C
C   Test for error condition
C
      IF ( X .GT. XHIGH2 ) THEN
         WRITE(ICOUT,11)
   11    FORMAT('**** ERROR FROM FDP0P5: X (=',G15.7,') TOO LARGE, ',
     1          'WOULD RESULT IN OVERFLOW.')
         CALL DPWRST('XXX','BUG ')
         FDP0P5 = ZERO
         RETURN
      ENDIF    
C
C   Code for x < -1
C
      IF ( X .LT. -ONE ) THEN
         IF ( X .GT. XMIN1 ) THEN
            EXPX = EXP(X)
            T = TWOE * EXPX - ONE
            FDP0P5 = EXPX * CHEVAL ( NTERM1 , ARRFD1 , T )
         ELSE
            IF ( X .LT. XMIN2 ) THEN
               FDP0P5 = ZERO
            ELSE
               FDP0P5 = EXP(X)
            ENDIF
         ENDIF
      ELSE
C
C   Code for -1 <= x <= 2
C
         IF ( X .LE. TWO ) THEN
            T = ( TWO * X - ONE ) / THREE
            FDP0P5 = CHEVAL ( NTERM2 , ARRFD2 , T )
         ELSE
C
C   Code for x > 2
C
            FDP0P5 = X * SQRT(X) / GAM2P5
            IF ( X .LE. XHIGH1 ) THEN 
               XSQ = X * X
               T = ( FIFTY - XSQ ) / ( FORTY2 + XSQ )
               CHV = CHEVAL ( NTERM3 , ARRFD3 , T )
               FDP0P5 = FDP0P5 * ( ONE + CHV / XSQ )
            ENDIF
         ENDIF
      ENDIF
      RETURN
      END
      DOUBLE PRECISION FUNCTION FDP1P5(XVALUE)
C
C   DESCRIPTION:
C
C      This function computes the Fermi-Dirac function of
C      order 3/2, defined as
C
C                     Int{0 to inf} t**(3/2) / (1+exp(t-x)) dt
C         FDP1P5(x) = -----------------------------------------
C                                 Gamma(5/2)
C
C      The function uses Chebyshev expansions which are given to
C      16 decimal places for x <= 2, but only 10 decimal places 
C      for x > 2.
C
C
C   ERROR RETURNS:
C    
C      If XVALUE too large and positive, the function value
C      will overflow. An error message is printed and the function
C      returns the value 0.0.
C
C
C   MACHINE-DEPENDENT CONSTANTS:
C
C      NTERMS1 - INTEGER - The number of terms used from the array
C                          ARRFD1. The recommended value is such that
C                               ABS(ARRFD1(NTERMS1)) < EPS/10
C                          subject to 1 <= NTERMS1 <= 12.
C
C      NTERMS2 - INTEGER - The number of terms used from the array
C                          ARRFD2. The recommended value is such that
C                               ABS(ARRFD2(NTERMS2)) < EPS/10
C                          subject to 1 <= NTERMS1 <= 22.
C
C      NTERMS3 - INTEGER - The number of terms used from the array
C                          ARRFD3. The recommended value is such that
C                               ABS(ARRFD3(NTERMS3)) < EPS/10
C                          subject to 1 <= NTERMS3 <= 33.
C
C      XMIN1 - REAL - The value of x below which
C                         FDP1P5(x) = exp(x)
C                     to machine precision. The recommended value
C                     is   2.5*LN(2) + LN(EPSNEG)
C
C      XMIN2 - REAL - The value of x below which
C                         FDP1P5(x) = 0.0 
C                     to machine precision. The recommended value
C                     is    LN ( XMIN )
C
C      XHIGH1 - REAL - The value of x above which
C                         FDP1P5(x) = x**(5/2)/GAMMA(7/2) 
C                     to machine precision. The recommended value
C                     is   pi * SQRT(1.6/EPS)
C
C      XHIGH2 - REAL - The value of x above which FDP1P5 would 
C                      overflow. The reommended value is
C                              (3.233509*XMAX)**(2/5)
C
C      For values of EPS, EPSNEG, and XMIN the user should refer to the
C      paper by Cody in ACM. Trans. Math. Soft. Vol. 14 (1988) p303-311.
C   
C      This code is provided with single and double precision values
C      of the machine-dependent parameters, suitable for machines
C      which satisfy the IEEE floating-point standard.
C
C
C   AUTHOR:
C          DR. ALLAN MACLEOD,
C          DEPT. OF MATHEMATICS AND STATISTICS,
C          UNIVERSITY OF PAISLEY,
C          HIGH ST.,
C          PAISLEY,
C          SCOTLAND
C          PA1 2BE
C
C          (e-mail: macl_ms0@paisley.ac.uk )
C
C
C   LATEST UPDATE:
C                 21 NOVEMBER, 1996
C
      INTEGER NTERM1,NTERM2,NTERM3
      DOUBLE PRECISION
     1     ARRFD1(0:12),ARRFD2(0:22),ARRFD3(0:55),
     2     CHEVAL,CHV,EXPX,FIFTY,FORTY2,
     3     GAM3P5,ONE,T,THREE,TWO,TWOE,X,XHIGH1,
     4     XHIGH2,XMIN1,XMIN2,XSQ,XVALUE,ZERO
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOMC.INC'
      INCLUDE 'DPCOP2.INC'
C
      DATA ARRFD1/1.9406 5492 1037 8650  D   0,
     1           -0.2878 6747 5518 043   D  -1,
     2            0.8509 1579 5231 3     D  -3,
     3           -0.3327 8452 5669       D  -4,
     4            0.1517 1202 058        D  -5,
     5           -0.7622 0087 4          D  -7,
     6            0.4095 5489            D  -8,
     7           -0.2311 964             D  -9,
     8            0.1355 37              D -10,
     9           -0.8187                 D -12,
     X            0.507                  D -13,
     1           -0.32                   D -14,
     2            0.2                    D -15/
      DATA ARRFD2( 0)/ 3.5862 2516 1563 4306 D   0/
      DATA ARRFD2( 1)/ 1.8518 2900 5626 5751 D   0/
      DATA ARRFD2( 2)/ 0.4612 3491 0241 7150 D   0/
      DATA ARRFD2( 3)/ 0.5793 0397 6126 881  D  -1/
      DATA ARRFD2( 4)/ 0.1704 3790 5548 75   D  -2/
      DATA ARRFD2( 5)/-0.3970 5201 2249 6    D  -3/
      DATA ARRFD2( 6)/-0.7070 2491 890       D  -5/
      DATA ARRFD2( 7)/ 0.7659 9748 792       D  -5/
      DATA ARRFD2( 8)/-0.1857 8113 33        D  -6/
      DATA ARRFD2( 9)/-0.1832 2379 56        D  -6/
      DATA ARRFD2(10)/ 0.1392 4949 5         D  -7/
      DATA ARRFD2(11)/ 0.4670 2027           D  -8/
      DATA ARRFD2(12)/-0.6671 984            D  -9/
      DATA ARRFD2(13)/-0.1161 292            D  -9/
      DATA ARRFD2(14)/ 0.2844 38             D -10/
      DATA ARRFD2(15)/ 0.2490 6              D -11/
      DATA ARRFD2(16)/-0.1143 1              D -11/
      DATA ARRFD2(17)/-0.279                 D -13/
      DATA ARRFD2(18)/ 0.439                 D -13/
      DATA ARRFD2(19)/-0.14                  D -14/
      DATA ARRFD2(20)/-0.16                  D -14/
      DATA ARRFD2(21)/ 0.1                   D -15/
      DATA ARRFD2(22)/ 0.1                   D -15/
      DATA ARRFD3( 0)/12.1307 5817 3688 4627  D   0/
      DATA ARRFD3( 1)/-0.1547 5011 1128 7255  D   0/
      DATA ARRFD3( 2)/-0.7390 0738 8850 999   D  -1/
      DATA ARRFD3( 3)/-0.3072 3537 7959 258   D  -1/
      DATA ARRFD3( 4)/-0.1145 4857 9330 328   D  -1/
      DATA ARRFD3( 5)/-0.4056 7636 8095 39    D  -2/
      DATA ARRFD3( 6)/-0.1398 0158 3732 27    D  -2/
      DATA ARRFD3( 7)/-0.4454 9018 1015 3     D  -3/
      DATA ARRFD3( 8)/-0.1173 9461 1270 4     D  -3/
      DATA ARRFD3( 9)/-0.1484 0898 0093       D  -4/
      DATA ARRFD3(10)/ 0.1188 9515 4223       D  -4/
      DATA ARRFD3(11)/ 0.1464 7695 8178       D  -4/
      DATA ARRFD3(12)/ 0.1132 2874 1730       D  -4/
      DATA ARRFD3(13)/ 0.7576 2292 948        D  -5/
      DATA ARRFD3(14)/ 0.4712 0400 466        D  -5/
      DATA ARRFD3(15)/ 0.2813 2628 202        D  -5/
      DATA ARRFD3(16)/ 0.1637 0517 341        D  -5/
      DATA ARRFD3(17)/ 0.9351 0762 72         D  -6/
      DATA ARRFD3(18)/ 0.5278 6892 10         D  -6/
      DATA ARRFD3(19)/ 0.2951 0798 70         D  -6/
      DATA ARRFD3(20)/ 0.1638 6001 90         D  -6/
      DATA ARRFD3(21)/ 0.9052 0540 9          D  -7/
      DATA ARRFD3(22)/ 0.4977 5697 5          D  -7/
      DATA ARRFD3(23)/ 0.2729 5586 3          D  -7/
      DATA ARRFD3(24)/ 0.1492 1458 5          D  -7/
      DATA ARRFD3(25)/ 0.8142 0359            D  -8/
      DATA ARRFD3(26)/ 0.4434 9200            D  -8/
      DATA ARRFD3(27)/ 0.2411 6032            D  -8/
      DATA ARRFD3(28)/ 0.1310 5018            D  -8/
      DATA ARRFD3(29)/ 0.7109 736             D  -9/
      DATA ARRFD3(30)/ 0.3856 721             D  -9/
      DATA ARRFD3(31)/ 0.2089 529             D  -9/
      DATA ARRFD3(32)/ 0.1131 735             D  -9/
      DATA ARRFD3(33)/ 0.6127 85              D -10/
      DATA ARRFD3(34)/ 0.3314 48              D -10/
      DATA ARRFD3(35)/ 0.1794 19              D -10/
      DATA ARRFD3(36)/ 0.9695 3               D -11/
      DATA ARRFD3(37)/ 0.5246 3               D -11/
      DATA ARRFD3(38)/ 0.2834 3               D -11/
      DATA ARRFD3(39)/ 0.1532 3               D -11/
      DATA ARRFD3(40)/ 0.8284                 D -12/
      DATA ARRFD3(41)/ 0.4472                 D -12/
      DATA ARRFD3(42)/ 0.2421                 D -12/
      DATA ARRFD3(43)/ 0.1304                 D -12/
      DATA ARRFD3(44)/ 0.707                  D -13/
      DATA ARRFD3(45)/ 0.381                  D -13/
      DATA ARRFD3(46)/ 0.206                  D -13/
      DATA ARRFD3(47)/ 0.111                  D -13/
      DATA ARRFD3(48)/ 0.60                   D -14/
      DATA ARRFD3(49)/ 0.33                   D -14/
      DATA ARRFD3(50)/ 0.17                   D -14/
      DATA ARRFD3(51)/ 0.11                   D -14/
      DATA ARRFD3(52)/ 0.5                    D -15/
      DATA ARRFD3(53)/ 0.3                    D -15/
      DATA ARRFD3(54)/ 0.1                    D -15/
      DATA ARRFD3(55)/ 0.1                    D -15/
      DATA ZERO,ONE,TWO/ 0.0 D 0 , 1.0 D 0 , 2.0 D 0/
      DATA THREE,FORTY2,FIFTY/ 3.0 D 0 , 42.0 D 0 , 50.0 D 0/
      DATA GAM3P5/0.3323 3509 7044 7843 D 1/
      DATA TWOE/5.4365 6365 6918 0905 D 0/
C
C   Machine-dependent constants (suitable for IEEE machines)
C
      DATA NTERM1,NTERM2,NTERM3/12,22,55/
      DATA XMIN1,XMIN2/-35.004D0,-708.396418D0/
      DATA XHIGH1,XHIGH2/166674733.2D0,3.204467D123/
C
C   Start calculation
C
      X=XVALUE
C
C   Test for error condition
C
      IF ( X .GT. XHIGH2 ) THEN
         WRITE(ICOUT,11)
   11    FORMAT('**** ERROR FROM FDP1P5: X (=',G15.7,') TOO LARGE, ',
     1          'WOULD RESULT IN OVERFLOW.')
         CALL DPWRST('XXX','BUG ')
         FDP1P5 = ZERO
         RETURN
      ENDIF    
C
C   Code for x < -1
C
      IF ( X .LT. -ONE ) THEN
         IF ( X .GT. XMIN1 ) THEN
            EXPX = EXP(X)
            T = TWOE * EXPX - ONE
            FDP1P5 = EXPX * CHEVAL ( NTERM1 , ARRFD1 , T )
         ELSE
            IF ( X .LT. XMIN2 ) THEN
               FDP1P5 = ZERO
            ELSE
               FDP1P5 = EXP(X)
            ENDIF
         ENDIF
      ELSE
C
C   Code for -1 <= x <= 2
C
         IF ( X .LE. TWO ) THEN
            T = ( TWO * X - ONE ) / THREE
            FDP1P5 = CHEVAL ( NTERM2 , ARRFD2 , T )
         ELSE
C
C   Code for x > 2
C
            FDP1P5 = X * X * SQRT(X) / GAM3P5
            IF ( X .LE. XHIGH1 ) THEN 
               XSQ = X * X
               T = ( FIFTY - XSQ ) / ( FORTY2 + XSQ )
               CHV = CHEVAL ( NTERM3 , ARRFD3 , T )
               FDP1P5 = FDP1P5 * ( ONE + CHV / XSQ )
            ENDIF
         ENDIF
      ENDIF
      RETURN
      END
      DOUBLE PRECISION FUNCTION FDP2P5(XVALUE)
C
C   DESCRIPTION:
C
C      This function computes the Fermi-Dirac function of
C      order 5/2, defined as
C
C                     Int{0 to inf} t**(5/2) / (1+exp(t-x)) dt
C         FDP2P5(x) = -----------------------------------------
C                                 Gamma(7/2)
C
C      The function uses Chebyshev expansions which are given to
C      16 decimal places for x <= 2, but only 10 decimal places 
C      for x > 2.
C
C
C   ERROR RETURNS:
C    
C      If XVALUE too large and positive, the function value
C      will overflow. An error message is printed and the function
C      returns the value 0.0.
C
C
C   MACHINE-DEPENDENT CONSTANTS:
C
C      NTERMS1 - INTEGER - The number of terms used from the array
C                          ARRFD1. The recommended value is such that
C                               ABS(ARRFD1(NTERMS1)) < EPS/10
C                          subject to 1 <= NTERMS1 <= 11.
C
C      NTERMS2 - INTEGER - The number of terms used from the array
C                          ARRFD2. The recommended value is such that
C                               ABS(ARRFD2(NTERMS2)) < EPS/10
C                          subject to 1 <= NTERMS1 <= 21.
C
C      NTERMS3 - INTEGER - The number of terms used from the array
C                          ARRFD3. The recommended value is such that
C                               ABS(ARRFD3(NTERMS3)) < EPS/10
C                          subject to 1 <= NTERMS3 <= 39.
C
C      XMIN1 - REAL - The value of x below which
C                         FDP2P5(x) = exp(x)
C                     to machine precision. The recommended value
C                     is   3.5*LN(2) + LN(EPSNEG)
C
C      XMIN2 - REAL - The value of x below which
C                         FDP2P5(x) = 0.0 
C                     to machine precision. The recommended value
C                     is    LN ( XMIN )
C
C      XHIGH1 - REAL - The value of x above which
C                         FDP2P5(x) = x**(7/2)/GAMMA(9/2) 
C                     to machine precision. The recommended value
C                     is   pi * SQRT(35/(12*EPS))
C
C      XHIGH2 - REAL - The value of x above which FDP2P5 would 
C                      overflow. The reommended value is
C                              (11.6317*XMAX)**(2/7)
C
C      For values of EPS, EPSNEG, and XMIN the user should refer to the
C      paper by Cody in ACM. Trans. Math. Soft. Vol. 14 (1988) p303-311.
C   
C      This code is provided with single and double precision values
C      of the machine-dependent parameters, suitable for machines
C      which satisfy the IEEE floating-point standard.
C
C
C   AUTHOR:
C          DR. ALLAN MACLEOD,
C          DEPT. OF MATHEMATICS AND STATISTICS,
C          UNIVERSITY OF PAISLEY,
C          HIGH ST.,
C          PAISLEY,
C          SCOTLAND
C          PA1 2BE
C
C          (e-mail: macl-ms0@paisley.ac.uk )
C
C
C   LATEST UPDATE:
C                 21 NOVEMBER, 1996
C
      INTEGER NTERM1,NTERM2,NTERM3
      DOUBLE PRECISION
     1     ARRFD1(0:11),ARRFD2(0:21),ARRFD3(0:61),
     2     CHEVAL,CHV,EXPX,FIFTY,FORTY2,
     3     GAM4P5,ONE,T,THREE,TWO,TWOE,X,XHIGH1,
     4     XHIGH2,XMIN1,XMIN2,XSQ,XVALUE,ZERO
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOMC.INC'
      INCLUDE 'DPCOP2.INC'
C
      DATA ARRFD1/1.9694 4166 8589 6693  D   0,
     1           -0.1496 9179 4643 492   D  -1,
     2            0.3006 9558 1662 7     D  -3,
     3           -0.8946 2485 950        D  -5,
     4            0.3298 0720 25         D  -6,
     5           -0.1392 3929 8          D  -7,
     6            0.6455 885             D  -9,
     7           -0.3206 23              D -10,
     8            0.1678 3               D -11,
     9           -0.916                  D -13,
     X            0.52                   D -14,
     1           -0.3                    D -15/
      DATA ARRFD2( 0)/ 4.2642 8383 9865 5301  D   0/
      DATA ARRFD2( 1)/ 2.3437 4268 8491 2867  D   0/
      DATA ARRFD2( 2)/ 0.6727 1197 8005 2076  D   0/
      DATA ARRFD2( 3)/ 0.1148 8263 2796 5569  D   0/
      DATA ARRFD2( 4)/ 0.1093 6396 8046 758   D  -1/
      DATA ARRFD2( 5)/ 0.2567 1739 5701 5     D  -3/
      DATA ARRFD2( 6)/-0.5058 8998 3911       D  -4/
      DATA ARRFD2( 7)/-0.7376 2157 74         D  -6/
      DATA ARRFD2( 8)/ 0.7352 9987 58         D  -6/
      DATA ARRFD2( 9)/-0.1664 2173 6          D  -7/
      DATA ARRFD2(10)/-0.1409 2049 9          D  -7/
      DATA ARRFD2(11)/ 0.9949 192             D  -9/
      DATA ARRFD2(12)/ 0.2991 457             D  -9/
      DATA ARRFD2(13)/-0.4013 32              D -10/
      DATA ARRFD2(14)/-0.6354 6               D -11/
      DATA ARRFD2(15)/ 0.1479 3               D -11/
      DATA ARRFD2(16)/ 0.1181                 D -12/
      DATA ARRFD2(17)/-0.524                  D -13/
      DATA ARRFD2(18)/-0.11                   D -14/
      DATA ARRFD2(19)/ 0.18                   D -14/
      DATA ARRFD2(20)/-0.1                    D -15/
      DATA ARRFD2(21)/-0.1                    D -15/
      DATA ARRFD3( 0)/30.2895 6768 5980 2579  D   0/
      DATA ARRFD3( 1)/ 1.1678 9766 4206 0562  D   0/
      DATA ARRFD3( 2)/ 0.6420 5918 0082 1472  D   0/
      DATA ARRFD3( 3)/ 0.3461 7238 6840 7417  D   0/
      DATA ARRFD3( 4)/ 0.1840 8167 9078 1889  D   0/
      DATA ARRFD3( 5)/ 0.9730 9243 5354 509   D  -1/
      DATA ARRFD3( 6)/ 0.5139 7329 2675 393   D  -1/
      DATA ARRFD3( 7)/ 0.2717 0980 1041 757   D  -1/
      DATA ARRFD3( 8)/ 0.1438 3327 1401 165   D  -1/
      DATA ARRFD3( 9)/ 0.7626 4863 9521 55    D  -2/
      DATA ARRFD3(10)/ 0.4050 3695 7672 02    D  -2/
      DATA ARRFD3(11)/ 0.2154 3961 4641 49    D  -2/
      DATA ARRFD3(12)/ 0.1147 5689 9017 77    D  -2/
      DATA ARRFD3(13)/ 0.6120 6223 6928 2     D  -3/
      DATA ARRFD3(14)/ 0.3268 3403 3785 9     D  -3/
      DATA ARRFD3(15)/ 0.1747 1455 2274 2     D  -3/
      DATA ARRFD3(16)/ 0.9348 7845 7860       D  -4/
      DATA ARRFD3(17)/ 0.5006 9221 2553       D  -4/
      DATA ARRFD3(18)/ 0.2683 7382 1846       D  -4/
      DATA ARRFD3(19)/ 0.1439 5719 1251       D  -4/
      DATA ARRFD3(20)/ 0.7727 2440 700        D  -5/
      DATA ARRFD3(21)/ 0.4150 3820 336        D  -5/
      DATA ARRFD3(22)/ 0.2230 5118 261        D  -5/
      DATA ARRFD3(23)/ 0.1199 3697 093        D  -5/
      DATA ARRFD3(24)/ 0.6452 3443 69         D  -6/
      DATA ARRFD3(25)/ 0.3472 8228 81         D  -6/
      DATA ARRFD3(26)/ 0.1869 9642 15         D  -6/
      DATA ARRFD3(27)/ 0.1007 3002 72         D  -6/
      DATA ARRFD3(28)/ 0.5428 0756 1          D  -7/
      DATA ARRFD3(29)/ 0.2926 0782 9          D  -7/
      DATA ARRFD3(30)/ 0.1577 8591 8          D  -7/
      DATA ARRFD3(31)/ 0.8511 0768            D  -8/
      DATA ARRFD3(32)/ 0.4592 2760            D  -8/
      DATA ARRFD3(33)/ 0.2478 5001            D  -8/
      DATA ARRFD3(34)/ 0.1338 0255            D  -8/
      DATA ARRFD3(35)/ 0.7225 103             D  -9/
      DATA ARRFD3(36)/ 0.3902 350             D  -9/
      DATA ARRFD3(37)/ 0.2108 157             D  -9/
      DATA ARRFD3(38)/ 0.1139 122             D  -9/
      DATA ARRFD3(39)/ 0.6156 38              D -10/
      DATA ARRFD3(40)/ 0.3327 81              D -10/
      DATA ARRFD3(41)/ 0.1799 19              D -10/
      DATA ARRFD3(42)/ 0.9728 8               D -11/
      DATA ARRFD3(43)/ 0.5261 7               D -11/
      DATA ARRFD3(44)/ 0.2846 1               D -11/
      DATA ARRFD3(45)/ 0.1539 7               D -11/
      DATA ARRFD3(46)/ 0.8331                 D -12/
      DATA ARRFD3(47)/ 0.4508                 D -12/
      DATA ARRFD3(48)/ 0.2440                 D -12/
      DATA ARRFD3(49)/ 0.1321                 D -12/
      DATA ARRFD3(50)/ 0.715                  D -13/
      DATA ARRFD3(51)/ 0.387                  D -13/
      DATA ARRFD3(52)/ 0.210                  D -13/
      DATA ARRFD3(53)/ 0.114                  D -13/
      DATA ARRFD3(54)/ 0.61                   D -14/
      DATA ARRFD3(55)/ 0.33                   D -14/
      DATA ARRFD3(56)/ 0.18                   D -14/
      DATA ARRFD3(57)/ 0.11                   D -14/
      DATA ARRFD3(58)/ 0.5                    D -15/
      DATA ARRFD3(59)/ 0.3                    D -15/
      DATA ARRFD3(60)/ 0.2                    D -15/
      DATA ARRFD3(61)/ 0.1                    D -15/
      DATA ZERO,ONE,TWO/ 0.0 D 0 , 1.0 D 0 , 2.0 D 0/
      DATA THREE,FORTY2,FIFTY/ 3.0 D 0 , 42.0 D 0 , 50.0 D 0/
      DATA GAM4P5/0.1163 1728 3965 6745 D 2/
      DATA TWOE/5.4365 6365 6918 0905 D 0/
C
C   Machine-dependent constants (suitable for IEEE machines)
C
      DATA NTERM1,NTERM2,NTERM3/11,21,61/
      DATA XMIN1,XMIN2/-34.3107854D0,-708.396418D0/
      DATA XHIGH1,XHIGH2/254599860.5D0,2.383665D88/
C
C   Start calculation
C
      X=XVALUE
C
C   Test for error condition
C
      IF ( X .GT. XHIGH2 ) THEN
         WRITE(ICOUT,11)
   11    FORMAT('**** ERROR FROM FDP2P5: X (=',G15.7,') TOO LARGE, ',
     1          'WOULD RESULT IN OVERFLOW.')
         CALL DPWRST('XXX','BUG ')
         FDP2P5 = ZERO
         RETURN
      ENDIF    
C
C   Code for x < -1
C
      IF ( X .LT. -ONE ) THEN
         IF ( X .GT. XMIN1 ) THEN
            EXPX = EXP(X)
            T = TWOE * EXPX - ONE
            FDP2P5 = EXPX * CHEVAL ( NTERM1 , ARRFD1 , T )
         ELSE
            IF ( X .LT. XMIN2 ) THEN
               FDP2P5 = ZERO
            ELSE
               FDP2P5 = EXP(X)
            ENDIF
         ENDIF
      ELSE
C
C   Code for -1 <= x <= 2
C
         IF ( X .LE. TWO ) THEN
            T = ( TWO * X - ONE ) / THREE
            FDP2P5 = CHEVAL ( NTERM2 , ARRFD2 , T )
         ELSE
C
C   Code for x > 2
C
            FDP2P5 = X * X * X * SQRT(X) / GAM4P5
            IF ( X .LE. XHIGH1 ) THEN 
               XSQ = X * X
               T = ( FIFTY - XSQ ) / ( FORTY2 + XSQ )
               CHV = CHEVAL ( NTERM3 , ARRFD3 , T )
               FDP2P5 = FDP2P5 * ( ONE + CHV / XSQ )
            ENDIF
         ENDIF
      ENDIF
      RETURN
      END
      SUBROUTINE FIBONN(N,X,IERROR)
C
C     PURPOSE--THIS SUBROUTINE GENERATES THE FIRST N FIBONNACI NUMBERS--
C              1, 1, 2, 3, 5, 8, 13, 21, ...
C     INPUT  ARGUMENTS--N      = THE DESIRED INTEGER NUMBER
C                                OF FIBONNACI NUMBERS
C                                TO BE GENERATED.
C     OUTPUT ARGUMENTS--X      = A SINGLE PRECISION VECTOR
C                                (OF DIMENSION AT LEAST N)
C                                INTO WHICH THE GENERATED
C                                FIBONNACI NUMBERS
C                                WILL BE PLACED.
C     OUTPUT--THE FIRST N FIBONNACI NUMBERS.
C     RESTRICTIONS--THERE IS NO RESTRICTION ON THE MAXIMUM VALUE
C                   OF N FOR THIS SUBROUTINE.
C     LANGUAGE--ANSI FORTRAN (1977)
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--87.10
C     ORIGINAL VERSION--SEPTEMBER 1987.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 IERROR
C
C---------------------------------------------------------------------
C
      DIMENSION X(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      CPUMA3=CPUMAX/3.0
C
C               ******************************************
C               **  TREAT THE FIBONNACCI SEQUENCE CASE  **
C               ******************************************
C
C               *******************************************
C               **  STEP 1--                             **
C               **  TEST THE INPUT ARGUMENTS FOR ERRORS  **
C               *******************************************
C
      IF(N.GE.1)GOTO190
      WRITE(ICOUT,999)
  999 FORMAT(1X)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,101)
  101 FORMAT('***** ERROR IN GENMS--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,102)
  102 FORMAT('      THE LENGTH OF THE DESIRED SEQUENCE')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,103)
  103 FORMAT('      OF FIBONNACI NUMBERS MUST BE 1 OR LARGER;')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,104)
  104 FORMAT('      SUCH WAS NOT THE CASE HERE.')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,105)N
  105 FORMAT('      N = ',I8)
      CALL DPWRST('XXX','BUG ')
      IERROR='YES'
      GOTO9000
  190 CONTINUE
C
C               ******************************
C               **  STEP 2--                **
C               **  GENERATE THE SEQUENCE   **
C               ******************************
C
      X(1)=1.0
      X(2)=1.0
      IF(N.LT.3)GOTO1190
      DO1100I=3,N
      I2=I
      IM2=I-2
      IM1=I-1
      X(I)=X(IM2)+X(IM1)
      IF(X(I).GE.CPUMA3)GOTO1150
 1100 CONTINUE
      GOTO1190
C
 1150 CONTINUE
      I2P1=I2+1
      WRITE(ICOUT,1151)
 1151 FORMAT('***** ERROR IN FIBONN--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1152)
 1152 FORMAT('      A NUMBER IN THE FIBONNACCI SEQUENCE')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1153)
 1153 FORMAT('      HAS JUST EXCEEDED THE ')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1154)
 1154 FORMAT('      LARGEST FLOATING POINT NUMBER')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1155)
 1155 FORMAT('      ALLOWABLE FOR THIS COMPUTER (',E15.7,').')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1156)
 1156 FORMAT('      THE VALUE CAUSING THE OVERFLOW WAS')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1157)I2P1
 1157 FORMAT('      THE ',I8,'-TH NUMBER IN THE')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1158)
 1158 FORMAT('      FIBONNACCI SEQUENCE.')
      CALL DPWRST('XXX','BUG ')
      IERROR='YES'
      GOTO9000
C
 1190 CONTINUE
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT       **
C               *****************
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE FILLHT(IPHORI,ICHORI,AUPPER,ALOWER,XHORIZ,NHORP,ICASEF,
     1IBUGU2,ISUBRO,IERROR)
C
C     PURPOSE--FILL IN (LINEARLY INTERPOLATE) VALUES IN THE HORIZON
C              TABLES FROM ELEMENTS IPREV TO ICUR, INCLUSIVE.
C     REFERENCE--ROGERS, DAVID F. (1985).  PROCEDURAL
C                ELEMENTS FOR COMPUTER GRAPHICS.
C                MCGRAW-HILL, NEW YORK, PAGE 197-201.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--88/9
C     ORIGINAL VERSION--AUGUST    1988.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 ICASEF
C
      CHARACTER*4 IBUGU2
      CHARACTER*4 ISUBRO
      CHARACTER*4 IERROR
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
CCCCC CHARACTER*4 ISTEPN
C
C---------------------------------------------------------------------
C
      DIMENSION AUPPER(*)
      DIMENSION ALOWER(*)
      DIMENSION XHORIZ(*)
C
C-----COMMON VARIABLES (GENERAL)--------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='FILL'
      ISUBN2='HT  '
C
      IF(IBUGU2.EQ.'ON'.OR.ISUBRO.EQ.'LLHT')GOTO50
      GOTO90
   50 CONTINUE
      WRITE(ICOUT,999)
  999 FORMAT(1X)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,51)
   51 FORMAT('***** AT THE BEGINNING OF FILLHT--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,52)IBUGU2,ISUBRO,IERROR
   52 FORMAT('IBUGU2,ISUBRO,IERROR = ',A4,2X,A4,2X,A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,53)ICASEF
   53 FORMAT('ICASEF = ',A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,61)IPHORI,ICHORI,NHORP
   61 FORMAT('IPHORI,ICHORI,NHORP = ',3I8)
      CALL DPWRST('XXX','BUG ')
      DO65I=IPHORI,ICHORI
      WRITE(ICOUT,66)I,AUPPER(I),ALOWER(I),XHORIZ(I)
   66 FORMAT('I,AUPPER(I),ALOWER(I),XHORIZ(I) = ',I8,3E15.7)
      CALL DPWRST('XXX','BUG ')
   65 CONTINUE
   90 CONTINUE
C
      YPU=AUPPER(IPHORI)
      YPL=ALOWER(IPHORI)
      XP=XHORIZ(IPHORI)
C
      YCU=AUPPER(ICHORI)
      YCL=ALOWER(ICHORI)
      XC=XHORIZ(ICHORI)
C
C               **************************************************
C               **  STEP 10--                                   **
C               **  BRANCH, BASED ON                            **
C               **  INDEX DIFFERENCE AND SLOPE                  **
C               **************************************************
C
      IDEL=ICHORI-IPHORI
      IF(IDEL.LE.1)GOTO9000
      IF(XC.EQ.XP)GOTO6000
      GOTO7000
C
C               **************************************************
C               **  STEP 60--                                   **
C     ----------**  TREAT THE CASE OF NON-ADJ. HORIZON CELL     **----------
C               **  AND INFINITE SLOPE                          **
C               **  (SHOULD BE IMPOSSIBLE)                      **
C               **************************************************
C
 6000 CONTINUE
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,6010)
 6010 FORMAT('***** INTERNAL ERROR IN FILLHT--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,6011)
 6011 FORMAT('      AT BRANCH POINT 4000 (AN IMPOSSIBLE BRANCH)')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,6012)
 6012 FORMAT('      CONDITION = ADJACENT CELL BUT INFINITE SLOPE.')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,6013)
 6013 FORMAT('      IF HAVE INFINITE SLOPE, THEN NECESSARILY MUST')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,6014)
 6014 FORMAT('      BE IN SAME CELL.')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,6015)IPHORI,ICHORI
 6015 FORMAT('IPHORI,ICHORI = ',2I8)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,6016)XHORIZ(IPHORI),XHORIZ(ICHORI)
 6016 FORMAT('XHORIZ(IPHORI),XHORIZ(ICHORI) = ',2E15.7)
      CALL DPWRST('XXX','BUG ')
      IERROR='YES'
      GOTO9000
C
C               **************************************************
C               **  STEP 70--                                   **
C     ----------**  TREAT THE CASE OF NON-ADJ. HORIZON CELL     **----------
C               **  AND FINITE SLOPE                            **
C               **************************************************
C
 7000 CONTINUE
      IF(ICASEF.EQ.'UPPE'.OR.ICASEF.EQ.'BOTH')GOTO7100
      GOTO7190
 7100 CONTINUE
      SLOPEU=(YCU-YPU)/(XC-XP)
      IMIN=IPHORI+1
      IMAX=ICHORI-1
      DO7110I=IMIN,IMAX
      XTEMP=XHORIZ(I)
      YTEMPU=YPU+(XTEMP-XP)*SLOPEU
      IF(YTEMPU.GT.AUPPER(I))AUPPER(I)=YTEMPU
 7110 CONTINUE
 7190 CONTINUE
C
      IF(ICASEF.EQ.'LOWE'.OR.ICASEF.EQ.'BOTH')GOTO7200
      GOTO7290
 7200 CONTINUE
      SLOPEL=(YCL-YPL)/(XC-XP)
      IMIN=IPHORI+1
      IMAX=ICHORI-1
      DO7210I=IMIN,IMAX
      XTEMP=XHORIZ(I)
      YTEMPL=YPL+(XTEMP-XP)*SLOPEL
      IF(YTEMPL.LT.ALOWER(I))ALOWER(I)=YTEMPL
 7210 CONTINUE
 7290 CONTINUE
C
C               **************************************************
C               **  STEP 90--                                   **
C               **  EXIT.                                       **
C               **************************************************
C
 9000 CONTINUE
      IF(IBUGU2.EQ.'ON'.OR.ISUBRO.EQ.'LLHT')GOTO9010
      GOTO9090
 9010 CONTINUE
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9011)
 9011 FORMAT('***** AT THE END       OF FILLHT--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9012)IBUGU2,ISUBRO,IERROR
 9012 FORMAT('IBUGU2,ISUBRO,IERROR = ',A4,2X,A4,2X,A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9013)ICASEF
 9013 FORMAT('ICASEF = ',A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9021)IPHORI,ICHORI,NHORP
 9021 FORMAT('IPHORI,ICHORI,NHORP = ',3I8)
      CALL DPWRST('XXX','BUG ')
      DO9025I=IPHORI,ICHORI
      WRITE(ICOUT,9026)I,AUPPER(I),ALOWER(I),XHORIZ(I)
 9026 FORMAT('I,AUPPER(I),ALOWER(I),XHORIZ(I) = ',I8,3E15.7)
      CALL DPWRST('XXX','BUG ')
 9025 CONTINUE
 9090 CONTINUE
C
      RETURN
      END
      SUBROUTINE FISHER(X, M, Y, N, TOTAL, POSSIB, P,
     1                  SUMX, SUMY, MEANX, MEANY,
     1                  WS1, WS2, WS3, MAXSAM, MAXNXT,
     1                  IFAULT,IBUGA3)
C
C        ALGORITHM AS 304.1 APPL.STATIST. (1996), VOL.45, NO.3
C
C        Fisher's non-parametric randomization test for two small
C        independent random samples
C
CCCCC INTEGER M, N, TOTAL, POSSIB, IFAULT
CCCCC INTEGER WS3(MAXSAM)
      INTEGER M, N, TOTAL, IFAULT
      INTEGER WS3(*)
      REAL X(*), Y(*), P
CCCCC REAL WS1(MAXSIZ), WS2(MAXSIZ)
      REAL WS1(*), WS2(*)
C
      INTEGER MAXSAM, MAXSIZ, MAXNXT
CCCCC PARAMETER (MAXSAM = 14, MAXSIZ = 3432)
C
C        Important : set MAXSIZ >= COMB(MAXSAM, MAXSAM / 2)
C
CCCCC INTEGER K, SIZE1, SIZE2, COUNT
      INTEGER K, SIZE1, SIZE2
CCCCC REAL SUMX, SUMY, SUMM, POSSIB
      REAL SUMX, SUMY, POSSIB
      REAL MEANX, MEANY
C
      INTEGER TRADES
CCCCC REAL MEAN, SUM
CCCCC EXTERNAL COMB, SUM, TRADES
      REAL BINOM
      EXTERNAL BINOM, TRADES
C
      EXTERNAL CMPLMT, EXCHNG, KTRADE
C
      CHARACTER*4 IBUGA3
      CHARACTER*4 IWRITE
      CHARACTER*4 IERROR
C
CCCCC MEAN(SUMM, COUNT) = SUMM / REAL(COUNT)
C
      IWRITE='OFF'
CCCCC IF (COMB(MAXSAM, MAXSAM/2) .GT. MAXSIZ) THEN
      ATEMP=BINOM(MAXSAM,MAXSAM/2)
      MAXSIZ=INT(ATEMP+0.5)
C
      IF (MAXSIZ.GT.MAXNXT) THEN
         IFAULT = 1
      ELSE IF (M .GT. MAXSAM .OR. N .GT. MAXSAM) THEN
              IFAULT = 2
           ELSE
              IFAULT = 0
              CALL SUMDP(X,M,IWRITE,SUMX,IBUGA3,IERROR)
              CALL SUMDP(Y,N,IWRITE,SUMY,IBUGA3,IERROR)
              MEANX=SUMX/REAL(M)
              MEANY=SUMY/REAL(N)
CCCCC         IF (MEAN(SUMX, M) .GT. MEAN(SUMY, N)) THEN
              IF (MEANX.GT.MEANY) THEN
                 CALL EXCHNG(X, M, Y, N, SUMX, SUMY)
           END IF
           TOTAL = 0
           IF (M .EQ. N) THEN
              DO 10 K = 1, (M-1)/2
                 CALL KTRADE(X, M, WS1, SIZE1, WS3, K)
                 CALL KTRADE(Y, N, WS2, SIZE2, WS3, K)
                 TOTAL = TOTAL + TRADES(WS1, SIZE1, WS2, SIZE2)
                 CALL CMPLMT(WS1, SIZE1, SUMX)
                 CALL CMPLMT(WS2, SIZE2, SUMY)
                 TOTAL = TOTAL + TRADES(WS1, SIZE1, WS2, SIZE2)
   10         CONTINUE
              IF (MOD(M, 2) .EQ. 0) THEN
                 CALL KTRADE(X, M, WS1, SIZE1, WS3, K)
                 CALL KTRADE(Y, N, WS2, SIZE2, WS3, K)
                 TOTAL = TOTAL + TRADES(WS1, SIZE1, WS2, SIZE2)
              END IF
         ELSE
            DO 20 K = 1, MIN(M, N)
               CALL KTRADE(X, M, WS1, SIZE1, WS3, K)
               CALL KTRADE(Y, N, WS2, SIZE2, WS3, K)
               TOTAL = TOTAL + TRADES(WS1, SIZE1, WS2, SIZE2)
   20       CONTINUE
         END IF
CCCCC    POSSIB = COMB(M+N, M)
         POSSIB = BINOM(M+N, M)
         P = REAL(TOTAL + 1)/POSSIB
      END IF
C
      RETURN
      END
      SUBROUTINE FLCDF(X,GAMMA,CDF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE CUMULATIVE DISTRIBUTION
C              FUNCTION VALUE FOR THE FATIGUE LIFE DISTRIBUTION
C              WITH SHAPE PARAMETER = GAMMA
C              AND LOCATION PARAMETER = 1.
C              THE FATIGUE LIFE DISTRIBUTION IS "HALF WAY BETWEEN"
C              THE INVERSE GAUSSIAN DISTRIBUTION AND
C              THE RECIPROCAL INVERSE GAUSSIAN DISTRIBUTION.
C     NOTE--THE FATIGUE LIFE DISTRIBUTION HAS--
C              FLPDF(X,GAMMA) = (IGPDF(X,GAMMA)+RIGPDF(X,GAMMA)) / 2
C                             = ((1+X)/2)*IGPDF(X,GAMMA)
C              FLCDF(X,GAMMA) = (IGCDF(X,GAMMA)+RIGCDF(X,GAMMA)) / 2
C                             = NORCDF((1/GAMMA)*(SQRT(X)-SQRT(1/X)))
C              FLPPF(P,GAMMA) = (SEE FLPPF.FOR)
C     NOTE--THE FATIGUE LIFE DISTRIBUTION--
C              GOES FROM 0 TO INFINITY
C              HAS MEAN = MU = 1
C              HAS STANDARD DEVIATION = MU*GAMMA*SQRT(1+(5/4)*GAMMA**2)
C              HAS SHAPE PARAMETER = GAMMA
C              IS NEAR-SYMMETRIC AND MODERATE-TAILED FOR SMALL GAMMA
C              IS HIGHLY-SKEWED AND LONG-TAILED FOR LARGE GAMMA
C              APPROACHES NORMALITY AS GAMMA APPROACHES 0
C     NOTE--TO OBTAIN THE PPF FOR GENERAL MU,
C           COMPUTE THE PPF FOR X AROUND 1, AND THEN
C           SIMPLY SCALE UP THE HORIZONTAL AXIS X BY THE DESIRED MU
C           AS IN Y2 = MU*Y
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE AT
C                                WHICH THE CUMULATIVE DISTRIBUTION
C                                FUNCTION IS TO BE EVALUATED.
C                                X SHOULD BE POSITIVE.
C                     --GAMMA  = THE SHAPE PARAMETER
C                                GAMMA SHOULD BE POSITIVE.
C                                (ALSO = COEF. OF VARIATION)
C     OUTPUT ARGUMENTS--CDF    = THE SINGLE PRECISION CUMULATIVE
C                                DISTRIBUTION FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION CUMULATIVE DISTRIBUTION
C             FUNCTION VALUE CDF FOR THE FATIGUE LIFE DISTRIBUTION
C             WITH TAIL LENGTH PARAMETER = GAMMA
C             AND WITH SCALE PARAMETER = 1
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--X SHOULD BE POSITIVE.
C                 --GAMMA SHOULD BE POSITIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--EXP.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--SAM SAUNDERS TALK, MAY 1990
C     REFERENCES--JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--1, 1970, PAGES
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--90.6
C     ORIGINAL VERSION--MAY       1990.
C     UPDATED         --JUNE      1999. REVERT TO NORCDF VERSION.
C                                       OTHER CODE PRODUCED NONSENSE.
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DCDF
      DOUBLE PRECISION DX
      DOUBLE PRECISION DGAMMA
      DOUBLE PRECISION DTERM1
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      CDF=0.0
      IF(GAMMA.LE.0)THEN
        WRITE(ICOUT,51)
   51   FORMAT('***** ERROR--THE SECOND ARGUMENT TO FLCDF IS ',
     1         'NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,52)GAMMA
   52   FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7)
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(X.LT.0.0)THEN
        WRITE(ICOUT,56)
   56   FORMAT('***** ERROR--THE FIRST  ARGUMENT TO FLCDF IS ',
     1         'NON-POSITIVE')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,52)X
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
C
      IF(X.EQ.0.0)THEN
        CDF=0.0
      ELSE
CCCCC   CALL IGCDF(X,GAMMA,CDF1)
CCCCC   CALL RIGCDF(X,GAMMA,CDF2)
CCCCC   CDF=(CDF1+CDF2)/2.0
        DX=DBLE(X)
        DGAMMA=DBLE(GAMMA)
        DTERM1=(DSQRT(DX)-DSQRT(1.0D0/DX))/DGAMMA
        CALL NODCDF(DTERM1,DCDF)
        CDF=REAL(DCDF)
      ENDIF
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE FLCHA(X,GAMMA,HAZ)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE CUMULATIVE HAZARD
C              FUNCTION VALUE FOR THE FATIGUE LIFE DISTRIBUTION
C              WITH SHAPE PARAMETER = GAMMA
C              AND LOCATION PARAMETER = 1.
C              THE FATIGUE LIFE DISTRIBUTION IS "HALF WAY BETWEEN"
C              THE INVERSE GAUSSIAN DISTRIBUTION AND
C              THE RECIPROCAL INVERSE GAUSSIAN DISTRIBUTION.
C     NOTE--THE FATIGUE LIFE DISTRIBUTION HAS--
C              FLPDF(X,GAMMA) = (IGPDF(X,GAMMA)+RIGPDF(X,GAMMA)) / 2
C                             = ((1+X)/2)*IGPDF(X,GAMMA)
C              FLCDF(X,GAMMA) = (IGCDF(X,GAMMA)+RIGCDF(X,GAMMA)) / 2
C                             = NORCDF((1/GAMMA)*(SQRT(X)-SQRT(1/X)))
C              FLPPF(P,GAMMA) = (SEE FLPPF.FOR)
C     NOTE--THE FATIGUE LIFE DISTRIBUTION--
C              GOES FROM 0 TO INFINITY
C              HAS MEAN = MU = 1
C              HAS STANDARD DEVIATION = MU*GAMMA*SQRT(1+(5/4)*GAMMA**2)
C              HAS SHAPE PARAMETER = GAMMA
C              IS NEAR-SYMMETRIC AND MODERATE-TAILED FOR SMALL GAMMA
C              IS HIGHLY-SKEWED AND LONG-TAILED FOR LARGE GAMMA
C              APPROACHES NORMALITY AS GAMMA APPROACHES 0
C     NOTE--TO OBTAIN THE PPF FOR GENERAL MU,
C           COMPUTE THE PPF FOR X AROUND 1, AND THEN
C           SIMPLY SCALE UP THE HORIZONTAL AXIS X BY THE DESIRED MU
C           AS IN Y2 = MU*Y
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE AT
C                                WHICH THE CUMULATIVE HAZARD
C                                FUNCTION IS TO BE EVALUATED.
C                                X SHOULD BE POSITIVE.
C                     --GAMMA  = THE SHAPE PARAMETER
C                                GAMMA SHOULD BE POSITIVE.
C     OUTPUT ARGUMENTS--HAZ    = THE SINGLE PRECISION CUMULATIVE HAZARD
C                                FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION CUMULATIVE HAZARD
C             FUNCTION VALUE FOR THE FATIGUE LIFE DISTRIBUTION
C             WITH TAIL LENGTH PARAMETER = GAMMA
C             AND WITH LOCATION PARAMETER = 1
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--X SHOULD BE POSITIVE.
C                 --GAMMA SHOULD BE POSITIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--EXP.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--SAM SAUNDERS TALK, MAY 1990
C     REFERENCES--JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--1, 1970, PAGES
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--98.4
C     ORIGINAL VERSION--APRIL     1998.
C     UPDATED         --JULY      1999.
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DCDF
      DOUBLE PRECISION DX
      DOUBLE PRECISION DGAMMA
      DOUBLE PRECISION DTERM1
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(GAMMA.LE.0)GOTO50
      IF(X.LT.0.0)GOTO55
      GOTO90
   50 CONTINUE
      WRITE(ICOUT,51)
   51 FORMAT('***** NON-FATAL DIAGNOSTIC--THE SECOND INPUT ',
     1'ARGUMENT TO THE FLCHA SUBROUTINE IS NON-POSITIVE *****')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,52)GAMMA
   52 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',
     1E15.8,' *****')
      CALL DPWRST('XXX','BUG ')
      HAZ=0.0
      GOTO9000
   55 CONTINUE
      WRITE(ICOUT,56)
   56 FORMAT('***** NON-FATAL DIAGNOSTIC--THE FIRST  INPUT ',
     1'ARGUMENT TO THE FLCHA SUBROUTINE IS NON-POSITIVE *****')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,57)X
   57 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',
     1E15.8,' *****')
      CALL DPWRST('XXX','BUG ')
      HAZ=0.0
      GOTO9000
   90 CONTINUE
C
      IF(X.EQ.0.0)THEN
        HAZ=0.0
      ELSEIF(X.GT.0.0)THEN
CCCCC    CALL FLCDF(X,GAMMA,CDF)
         DX=DBLE(X)
         DGAMMA=DBLE(GAMMA)
         DTERM1=(DSQRT(DX)-DSQRT(1.0D0/DX))/DGAMMA 
         CALL NODCDF(DTERM1,DCDF)
         DCDF=1.0D0-DCDF
         IF(DCDF.GT.0.0D0)THEN
           HAZ=REAL(-DLOG(DCDF))
         ELSE
           WRITE(ICOUT,162)X
  162    FORMAT('***** FOR THE VALUE OF THE ARGUMENT ',
     1   E15.8,' THE CDF IS ESSENTIALLY 1, HAZARD SET TO 0.')
         CALL DPWRST('XXX','BUG ')
         HAZ=0.0
         ENDIF
      ENDIF
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE FLHAZ(X,GAMMA,HAZ)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE HAZARD
C              FUNCTION VALUE FOR THE FATIGUE LIFE DISTRIBUTION
C              WITH SHAPE PARAMETER = GAMMA
C              AND LOCATION PARAMETER = 1.
C              THE FATIGUE LIFE DISTRIBUTION IS "HALF WAY BETWEEN"
C              THE INVERSE GAUSSIAN DISTRIBUTION AND
C              THE RECIPROCAL INVERSE GAUSSIAN DISTRIBUTION.
C     NOTE--THE FATIGUE LIFE DISTRIBUTION HAS--
C              FLPDF(X,GAMMA) = (IGPDF(X,GAMMA)+RIGPDF(X,GAMMA)) / 2
C                             = ((1+X)/2)*IGPDF(X,GAMMA)
C              FLCDF(X,GAMMA) = (IGCDF(X,GAMMA)+RIGCDF(X,GAMMA)) / 2
C                             = NORCDF((1/GAMMA)*(SQRT(X)-SQRT(1/X)))
C              FLPPF(P,GAMMA) = (SEE FLPPF.FOR)
C     NOTE--THE FATIGUE LIFE DISTRIBUTION--
C              GOES FROM 0 TO INFINITY
C              HAS MEAN = MU = 1
C              HAS STANDARD DEVIATION = MU*GAMMA*SQRT(1+(5/4)*GAMMA**2)
C              HAS SHAPE PARAMETER = GAMMA
C              IS NEAR-SYMMETRIC AND MODERATE-TAILED FOR SMALL GAMMA
C              IS HIGHLY-SKEWED AND LONG-TAILED FOR LARGE GAMMA
C              APPROACHES NORMALITY AS GAMMA APPROACHES 0
C     NOTE--TO OBTAIN THE PPF FOR GENERAL MU,
C           COMPUTE THE PPF FOR X AROUND 1, AND THEN
C           SIMPLY SCALE UP THE HORIZONTAL AXIS X BY THE DESIRED MU
C           AS IN Y2 = MU*Y
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE AT
C                                WHICH THE PROBABILITY DENSITY
C                                FUNCTION IS TO BE EVALUATED.
C                                X SHOULD BE POSITIVE.
C                     --GAMMA  = THE SHAPE PARAMETER
C                                GAMMA SHOULD BE POSITIVE.
C                                (ALSO = COEF. OF VARIATION)
C     OUTPUT ARGUMENTS--HAZ    = THE SINGLE PRECISION HAZARD
C                                FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION HAZARD
C             FUNCTION VALUE FOR THE FATIGUE LIFE DISTRIBUTION
C             WITH TAIL LENGTH PARAMETER = GAMMA
C             AND WITH LOCATION PARAMETER = 1
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--X SHOULD BE POSITIVE.
C                 --GAMMA SHOULD BE POSITIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--EXP.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--SAM SAUNDERS TALK, MAY 1990
C     REFERENCES--JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--1, 1970, PAGES
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--98.4
C     ORIGINAL VERSION--APRIL     1998.
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DCDF
      DOUBLE PRECISION DX
      DOUBLE PRECISION DGAMMA
      DOUBLE PRECISION DTERM1
      DOUBLE PRECISION DTERM2
      DOUBLE PRECISION DTERM3
      DOUBLE PRECISION DTERM4
      DOUBLE PRECISION DPDF
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(GAMMA.LE.0)GOTO50
      IF(X.LT.0.0)GOTO55
      GOTO90
   50 CONTINUE
      WRITE(ICOUT,51)
   51 FORMAT('***** NON-FATAL DIAGNOSTIC--THE SECOND INPUT ',
     1'ARGUMENT TO THE FLHAZ SUBROUTINE IS NON-POSITIVE *****')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,52)GAMMA
   52 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',
     1E15.8,' *****')
      CALL DPWRST('XXX','BUG ')
      HAZ=0.0
      GOTO9000
   55 CONTINUE
      WRITE(ICOUT,56)
   56 FORMAT('***** NON-FATAL DIAGNOSTIC--THE FIRST  INPUT ',
     1'ARGUMENT TO THE FLHAZ SUBROUTINE IS NON-POSITIVE *****')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,57)X
   57 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',
     1E15.8,' *****')
      CALL DPWRST('XXX','BUG ')
      HAZ=0.0
      GOTO9000
   90 CONTINUE
C
      IF(X.EQ.0.0)THEN
        HAZ=0.0
      ELSEIF(X.GT.0.0)THEN
CCCCC    CALL FLCDF(X,GAMMA,CDF)
CCCCC    CDF=1.0-CDF
         DX=DBLE(X)
         DGAMMA=DBLE(GAMMA)
         DTERM1=(DSQRT(DX)-DSQRT(1.0D0/DX))/DGAMMA 
         CALL NODCDF(DTERM1,DCDF)
         DCDF=1.0D0-DCDF
         IF(DCDF.GT.0.0D0)THEN
CCCCC      CALL FLPDF(X,GAMMA,PDF)
           DTERM1=DLOG(DSQRT(DX)+DSQRT(1.0D0/DX))
           DTERM2=DLOG(2.0D0*DX*DGAMMA)
           DTERM3=(DSQRT(DX)-DSQRT(1.0D0/DX))/DGAMMA
           CALL NODPDF(DTERM3,DTERM4)
           IF(DTERM4.LE.0.0D0)THEN
             DPDF=0.0D0
           ELSE
             DTERM4=DLOG(DTERM4)
             DPDF=DEXP(DTERM1-DTERM2+DTERM4)
           ENDIF
           HAZ=REAL(DPDF/DCDF)
         ELSE
           WRITE(ICOUT,162)X
  162    FORMAT('***** FOR THE VALUE OF THE ARGUMENT ',
     1   E15.8,' THE CDF IS ESSENTIALLY 1, HAZARD SET TO 0.')
         CALL DPWRST('XXX','BUG ')
         HAZ=0.0
         ENDIF
      ENDIF
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE FLFUN (N, X, FVEC, IFLAG, XDATA, NOBS)
C
C     PURPOSE--THIS ROUTINE COMPUTES THE FUNCTIONS FOR THE
C              FATIGUE LIFE MAXIMUM LIKELIHOOD EQUATIONS.
C
C              THE MAXIMUM LIKELIHOOD ESTIMATE OF BETA IS THE
C              POSITIVE ROOT OF:
C
C                 BHAT**2 - BHAT*{2*H+K(BHAT)} + H*{TBAR+K(BHAT)}=0
C
C              WITH
C
C                  H=1/[N*SUM[i=1 to N][1/X(i)]
C                  TBAR = SUM[i=1 to N][X(i)]/N
C                  K(BHAT) = 1/[N*SUM[i=1 to N][1/(BHAT+X(i))]
C
C              AND
C
C                  AHAT = 2*SQRT[0.5*(TBAR/BHAT + BHAT/H) - 1]
C
C              FLFUN IS CALLED BY DNSQE ROUTINE FOR SOLVING
C              SIMULTANEOUS NONLINEAR EQUATIONS.  NOTE THAT THE
C              CALLING SEQUENCE DID NOT ACCOMODATE A DATA ARRAY
C              (AND ASSCIATED NUMBER OF OBSERVATIONS), SO THESE WERE
C              ADDED TO THE CALL LIST.
C     EXAMPLE--FATIGUE LIFE MAXIMUM LIKELIHOOD Y
C     REFERENCE--JOHNSON, KOTZ, AND BALAKRISHNAN (1994).  "CONTINUOUS
C                UNIVARIATE DISTRIBUTIONS: VOLUME 2", SECOND EDITION,
C                JOHN WILEY, PP.  651-658.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBUG, MD 20899-8980
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2004/3
C     ORIGINAL VERSION--MARCH     2004.
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION X(*)
      DOUBLE PRECISION FVEC(*)
      REAL XDATA(*)
C
      DOUBLE PRECISION DN
      DOUBLE PRECISION DX
      DOUBLE PRECISION DBETA
      DOUBLE PRECISION DSUM1
      DOUBLE PRECISION DSUM2
      DOUBLE PRECISION DSUM3
      DOUBLE PRECISION TBAR
      DOUBLE PRECISION H
      DOUBLE PRECISION DK
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C  COMPUTE SOME SUMS
C
      N=1
      IFLAG=0
C
      DBETA=X(1)
      DN=DBLE(NOBS)
C
      DSUM1=0.0D0
      DSUM2=0.0D0
      DSUM3=0.0D0
C
      DO200I=1,NOBS
        DX=DBLE(XDATA(I))
        DSUM1=DSUM1 + DX
        DSUM2=DSUM2 + 1.0D0/DX
        DSUM3=DSUM3 + 1.0D0/(DX + DBETA)
  200 CONTINUE
      TBAR=DSUM1/DN
      H=DN/DSUM2
      DK=DN/DSUM3
      FVEC(1)=DBETA**2 - DBETA*(2.0D0*H + DK) + H*(TBAR+DK)
C
      RETURN
      END
      SUBROUTINE FLML1(Y,N,MAXNXT,
     1                  TEMP1,DTEMP1,
     1                  XMEAN,XSD,XVAR,XMIN,XMAX,
     1                  SCALML,SHAPML,SCALMO,SHAPMO,
     1                  ISUBRO,IBUGA3,IERROR)
C
C     PURPOSE--THIS ROUTINE COMPUTES THE MAXIMUM LIKELIHOOD ESTIMATES
C              FOR THE 2-PARAMETER FATIGUE LIFE DISTRIBUTION FOR THE
C              RAW DATA CASE (I.E., NO CENSORING AND NO GROUPING).  THIS
C              ROUTINE RETURNS ONLY THE POINT ESTIMATES (CONFIDENCE
C              INTERVALS WILL BE COMPUTED IN A SEPARATE ROUTINE).
C
C              IT IS ASSUMED THAT BASIC ERROR CHECKING HAS ALREADY BEEN
C              PERFORMED.
C
C              PUT THIS IN A SEPARATE ROUTINE AS IT MAY BE CALLED
C              FROM MULTIPLE PLACES (DPMLFL WILL GENERATE THE OUTPUT
C              FOR THE FATIGUE LIFE MLE COMMAND).
C
C     REFERENCE--JOHNSON, KOTZ, AND BALAKRISHNAN.  "CONTINUOUS
C                UNIVARIATE DISTRIBUTIONS, VOLUME I", SECOND
C                EDITION, WILEY, 1994, PP. 614-619.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2010/2
C     ORIGINAL VERSION--FEBRUARY  2010. EXTRACTED AS A SEPARATE
C                                       SUBROUTINE (FROM DPMLE1)
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      DIMENSION Y(*)
      DIMENSION TEMP1(*)
      DOUBLE PRECISION DTEMP1(*)
C
      DOUBLE PRECISION DGAMM1
      DOUBLE PRECISION DALPHA
      DOUBLE PRECISION DALPH2
      DOUBLE PRECISION DSUM1
      DOUBLE PRECISION DSUM2
      DOUBLE PRECISION DSUM3
      DOUBLE PRECISION DSUM4
      DOUBLE PRECISION DX
      DOUBLE PRECISION DN
      DOUBLE PRECISION TBAR
      DOUBLE PRECISION H
      DOUBLE PRECISION DK
      DOUBLE PRECISION TOL
      DOUBLE PRECISION XPAR(1)
      DOUBLE PRECISION FVEC(1)
C
      EXTERNAL FLFUN
C
      CHARACTER*4 ISUBRO
      CHARACTER*4 IBUGA3
      CHARACTER*4 IERROR
C
      CHARACTER*4 IWRITE
      CHARACTER*40 IDIST
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
      CHARACTER*4 ISTEPN
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='FLML'
      ISUBN2='1   '
      IERROR='NO'
      IWRITE='NO'
C
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'LML1')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,51)
   51   FORMAT('**** AT THE BEGINNING OF FLML1--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,52)IBUGA3,ISUBRO
   52   FORMAT('IBUGA3,ISUBRO = ',A4,2X,A4)
        CALL DPWRST('XXX','WRIT')
        DO56I=1,MIN(N,100)
          WRITE(ICOUT,57)I,Y(I),TEMP1(I)
   57     FORMAT('I,Y(I),TEMP1(I) = ',I8,2G15.7)
          CALL DPWRST('XXX','WRIT')
   56   CONTINUE
      ENDIF
C
C               ********************************************
C               **  STEP 1--                              **
C               **  CHECK THE INPUT ARGUMENTS FOR ERRORS  **
C               ********************************************
C
      ISTEPN='1'
      IF(IBUGA3.EQ.'ON' .OR. ISUBRO.EQ.'LML1')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
C               *******************************************
C               **  STEP 2--                             **
C               **  CARRY OUT CALCULATIONS               **
C               **  FOR FATIGUE LIFE MLE ESTIMATE        **
C               *******************************************
C
      ISTEPN='2'
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'LML1')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      IDIST='FATIGUE LIFE'
C
      IFLAG=2
      CALL SUMRAW(Y,N,IDIST,IFLAG,
     1            XMEAN,XVAR,XSD,XMIN,XMAX,
     1            ISUBRO,IBUGA3,IERROR)
C
      SHAPML=CPUMIN
      SCALML=CPUMIN
      SHAPMO=CPUMIN
      SCALMO=CPUMIN
C
      DN=DBLE(N)
      DSUM1=0.0D0
      DSUM2=0.0D0
      DSUM3=0.0D0
      DSUM4=0.0D0
      DO2110I=1,N
        DX=DBLE(Y(I))
        DSUM1=DSUM1 + DSQRT(DX)
        DSUM2=DSUM2 + 1.0D0/DSQRT(DX)
        DSUM3=DSUM3 + DX
        DSUM4=DSUM4 + 1.0D0/DX
 2110 CONTINUE
      DGAMM1=DSUM1/DSUM2
      XPAR(1)=DSQRT(DSUM3/DSUM4)
C
      DSUM1=0.0D0
      DO2120I=1,N
        DX=DBLE(Y(I))
        DSUM1=DSUM1 + (DSQRT(DX/DGAMM1) - DSQRT(DGAMM1/DX))**2
 2120 CONTINUE
      DALPHA=DSQRT(DSUM1/DN)
      SCALMO=REAL(DGAMM1)
      SHAPMO=REAL(DALPHA)
C
      XPAR(1)=DGAMM1
C
      IOPT=2
      TOL=1.0D-6
      NVAR=1
      NPRINT=-1
      INFO=0
      LWA=MAXNXT
      CALL DNSQE(FLFUN,JAC,IOPT,NVAR,XPAR,FVEC,TOL,NPRINT,INFO,
     1           DTEMP1,MAXNXT,Y,N)
C
      DSUM1=0.0D0
      DSUM2=0.0D0
      DSUM3=0.0D0
C
      DO200I=1,N
        DX=DBLE(Y(I))
        DSUM1=DSUM1 + DX
        DSUM2=DSUM2 + 1.0D0/DX
        DSUM3=DSUM3 + 1.0D0/(DX + XPAR(1))
  200 CONTINUE
      TBAR=DSUM1/DN
      H=DN/DSUM2
      DK=DN/DSUM3
      DALPH2=2.0D0*DSQRT(0.5D0*((TBAR/XPAR(1)) + XPAR(1)/H) - 1.0D0)
      SCALML=REAL(XPAR(1))
      SHAPML=REAL(DALPH2)
C
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'LML1')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9011)
 9011   FORMAT('**** AT THE END OF FLML1--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9013)N,XMEAN,XSD,XMIN,XMAX
 9013   FORMAT('N,XMEAN,XSD,XMIN,XMAX = ',I8,4G15.7)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9017)SHAPML,SCALML,SHAPMO,SCALMO
 9017   FORMAT('SHAPML,SCALML,SHAPMO,SCALMO =  ',4G15.7)
        CALL DPWRST('XXX','WRIT')
      ENDIF
C
      RETURN
      END
      SUBROUTINE FLPDF(X,GAMMA,PDF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE PROBABILITY DENSITY
C              FUNCTION VALUE FOR THE FATIGUE LIFE DISTRIBUTION
C              WITH SHAPE PARAMETER = GAMMA
C              AND LOCATION PARAMETER = 1.
C              THE FATIGUE LIFE DISTRIBUTION IS "HALF WAY BETWEEN"
C              THE INVERSE GAUSSIAN DISTRIBUTION AND
C              THE RECIPROCAL INVERSE GAUSSIAN DISTRIBUTION.
C     NOTE--THE FATIGUE LIFE DISTRIBUTION HAS--
C              FLPDF(X,GAMMA) = (IGPDF(X,GAMMA)+RIGPDF(X,GAMMA)) / 2
C                             = ((1+X)/2)*IGPDF(X,GAMMA)
C              FLCDF(X,GAMMA) = (IGCDF(X,GAMMA)+RIGCDF(X,GAMMA)) / 2
C                             = NORCDF((1/GAMMA)*(SQRT(X)-SQRT(1/X)))
C              FLPPF(P,GAMMA) = (SEE FLPPF.FOR)
C     NOTE--THE FATIGUE LIFE DISTRIBUTION--
C              GOES FROM 0 TO INFINITY
C              HAS MEAN = MU = 1
C              HAS STANDARD DEVIATION = MU*GAMMA*SQRT(1+(5/4)*GAMMA**2)
C              HAS SHAPE PARAMETER = GAMMA
C              IS NEAR-SYMMETRIC AND MODERATE-TAILED FOR SMALL GAMMA
C              IS HIGHLY-SKEWED AND LONG-TAILED FOR LARGE GAMMA
C              APPROACHES NORMALITY AS GAMMA APPROACHES 0
C     NOTE--TO OBTAIN THE PPF FOR GENERAL MU,
C           COMPUTE THE PPF FOR X AROUND 1, AND THEN
C           SIMPLY SCALE UP THE HORIZONTAL AXIS X BY THE DESIRED MU
C           AS IN Y2 = MU*Y
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE AT
C                                WHICH THE PROBABILITY DENSITY
C                                FUNCTION IS TO BE EVALUATED.
C                                X SHOULD BE POSITIVE.
C                     --GAMMA  = THE SHAPE PARAMETER
C                                GAMMA SHOULD BE POSITIVE.
C                                (ALSO = COEF. OF VARIATION)
C     OUTPUT ARGUMENTS--PDF    = THE SINGLE PRECISION PROBABILITY
C                                DENSITY FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION PROBABILITY DENSITY
C             FUNCTION VALUE PDF FOR THE FATIGUE LIFE DISTRIBUTION
C             WITH TAIL LENGTH PARAMETER = GAMMA
C             AND WITH SCALE PARAMETER = 1
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--X SHOULD BE POSITIVE.
C                 --GAMMA SHOULD BE POSITIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--EXP.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--SAM SAUNDERS TALK, MAY 1990
C     REFERENCES--JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--1, 1970, PAGES
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--90.6
C     ORIGINAL VERSION--MAY       1990.
C     UPDATED         --JULY      1999. USE DIFFERENT FORMULA
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DX
      DOUBLE PRECISION DGAMMA
      DOUBLE PRECISION DTERM1
      DOUBLE PRECISION DTERM2
      DOUBLE PRECISION DTERM3
      DOUBLE PRECISION DTERM4
      DOUBLE PRECISION DPDF
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(GAMMA.LE.0)GOTO50
      IF(X.LT.0.0)GOTO55
      GOTO90
   50 CONTINUE
      WRITE(ICOUT,51)
   51 FORMAT('***** NON-FATAL DIAGNOSTIC--THE SECOND INPUT ',
     1'ARGUMENT TO THE WFPDF SUBROUTINE IS NON-POSITIVE *****')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,52)GAMMA
   52 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',
     1E15.8,' *****')
      CALL DPWRST('XXX','BUG ')
      PDF=0.0
      GOTO9000
   55 CONTINUE
      WRITE(ICOUT,56)
   56 FORMAT('***** NON-FATAL DIAGNOSTIC--THE FIRST  INPUT ',
     1'ARGUMENT TO THE WFPDF SUBROUTINE IS NON-POSITIVE *****')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,57)X
   57 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',
     1E15.8,' *****')
      CALL DPWRST('XXX','BUG ')
      PDF=0.0
      GOTO9000
   90 CONTINUE
C
      IF(X.EQ.0.0)GOTO1100
      GOTO1200
C
 1100 CONTINUE
      PDF=0.0
      GOTO9000
C
 1200 CONTINUE
C
CCCCC JULY 1999.  USE DIFFERENT FORMULA
CCCCC CALL IGPDF(X,GAMMA,PDF1)
CCCCC CALL RIGPDF(X,GAMMA,PDF2)
C
      DX=DBLE(X)
      DGAMMA=DBLE(GAMMA)
      DTERM1=DLOG(DSQRT(DX)+DSQRT(1.0D0/DX))
      DTERM2=DLOG(2.0D0*DX*DGAMMA)
      DTERM3=(DSQRT(DX)-DSQRT(1.0D0/DX))/DGAMMA
      CALL NODPDF(DTERM3,DTERM4)
      IF(DTERM4.LE.0.0D0)THEN
        PDF=0.0
        GOTO9000
      ENDIF
      DTERM4=DLOG(DTERM4)
      DPDF=DEXP(DTERM1-DTERM2+DTERM4)
      PDF=REAL(DPDF)
CCCCC PDF=(PDF1+PDF2)/2.0
CCCCC ARG1=(X**0.5+X**1.5)/(2.0*GAMMA)
CCCCC ARG2=(1.0/GAMMA)
CCCCC ARG3=SQRT(X)-1.0/SQRT(X)
CCCCC ARG4=ARG2*ARG3
CCCCC CALL NORPDF(ARG4,PDFN)
CCCCC PDF=ARG1*PDFN
      GOTO9000
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE FLPPF(P,GAMMA,PPF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE PERCENT POINT
C              FUNCTION VALUE FOR THE FATIGUE LIFE DISTRIBUTION
C              WITH SHAPE PARAMETER = GAMMA
C              AND LOCATION PARAMETER = 1.
C              THE FATIGUE LIFE DISTRIBUTION IS "HALF WAY BETWEEN"
C              THE INVERSE GAUSSIAN DISTRIBUTION AND
C              THE RECIPROCAL INVERSE GAUSSIAN DISTRIBUTION.
C     NOTE--THE FATIGUE LIFE DISTRIBUTION HAS--
C              FLPDF(X,GAMMA) = (IGPDF(X,GAMMA)+RIGPDF(X,GAMMA)) / 2
C                             = ((1+X)/2)*IGPDF(X,GAMMA)
C              FLCDF(X,GAMMA) = (IGCDF(X,GAMMA)+RIGCDF(X,GAMMA)) / 2
C                             = NORCDF((1/GAMMA)*(SQRT(X)-SQRT(1/X)))
C              FLPPF(P,GAMMA) = (SEE BELOW)
C     NOTE--THE FATIGUE LIFE DISTRIBUTION--
C              GOES FROM 0 TO INFINITY
C              HAS MEAN = MU = 1
C              HAS STANDARD DEVIATION = MU*GAMMA*SQRT(1+(5/4)*GAMMA**2)
C              HAS SHAPE PARAMETER = GAMMA
C              IS NEAR-SYMMETRIC AND MODERATE-TAILED FOR SMALL GAMMA
C              IS HIGHLY-SKEWED AND LONG-TAILED FOR LARGE GAMMA
C              APPROACHES NORMALITY AS GAMMA APPROACHES 0
C     NOTE--TO OBTAIN THE PPF FOR GENERAL MU,
C           COMPUTE THE PPF FOR X AROUND 1, AND THEN
C           SIMPLY SCALE UP THE HORIZONTAL AXIS X BY THE DESIRED MU
C           AS IN Y2 = MU*Y
C     INPUT  ARGUMENTS--P      = THE SINGLE PRECISION VALUE
C                                (BETWEEN 0.0 AND 1.0)
C                                AT WHICH THE PERCENT POINT
C                                FUNCTION IS TO BE EVALUATED.
C                     --GAMMA  = THE SHAPE PARAMETER
C                                GAMMA SHOULD BE POSITIVE.
C                                (ALSO = COEF. OF VARIATION)
C     OUTPUT ARGUMENTS--PPF    = THE SINGLE PRECISION PERCENT POINT
C                                FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION CUMULATIVE DISTRIBUTION
C     OUTPUT--THE SINGLE PRECISION PERCENT POINT
C             FUNCTION VALUE PPF FOR THE INVERSE GAUSSIAN DISRIBUTION
C             WITH SHAPE PARAMETER GAMMA
C             AND SCALE PARAMETER 1
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--P SHOULD BE BETWEEN
C                   0.0 (INCLUSIVELY) AND 1.0 (EXCLUSIVELY).
C                 --GAMMA SHOULD BE POSITIVE
C     OTHER DATAPAC   SUBROUTINES NEEDED--IGCDF, NORCDF
C     FORTRAN LIBRARY SUBROUTINES NEEDED--
C     MODE OF INTERNAL OPERATIONS--DOUBLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--SAM SAUNDERS TALK, MAY 1990
C     REFERENCES--JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--1, 1970, PAGES
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--90.6
C     ORIGINAL VERSION--MAY       1990.
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(GAMMA.LE.0)GOTO50
      IF(P.LT.0.0.OR.P.GE.1.0)GOTO60
      GOTO90
   50 CONTINUE
      WRITE(ICOUT,51)
   51 FORMAT('***** NON-FATAL DIAGNOSTIC--THE SECOND INPUT ',
     1'ARGUMENT TO THE FLPPF SUBROUTINE IS NON-POSITIVE *****')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,52)GAMMA
   52 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',
     1E15.8,' *****')
      CALL DPWRST('XXX','BUG ')
      PPF=0.0
      GOTO9000
   60 CONTINUE
      WRITE(ICOUT,61)
   61 FORMAT('***** FATAL ERROR--THE FIRST  INPUT ARGUMENT ',
     1'TO THE FLPPF SUBROUTINE ',
     1'IS OUTSIDE THE ALLOWABLE (0,1) INTERVAL *****')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,62)P
   62 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',
     1E15.8,' *****')
      CALL DPWRST('XXX','BUG ')
      PPF=0.0
      GOTO9000
   90 CONTINUE
C
      CALL NORPPF(P,PPFN)
      C=GAMMA*PPFN
C
      C2=C+SQRT(C*C+4.0)
CCCCC C3=C2/2.0
CCCCC PPF=C3**2
      PPF=0.25*(C2*C2)
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE FLRAN(N,GAMMA,ISEED,X)
C
C     PURPOSE--THIS SUBROUTINE GENERATES A RANDOM SAMPLE OF SIZE N
C              FROM THE FATIGUE LIFE DISTRIBUTION
C              WITH SHAPE PARAMETER VALUE = GAMMA
C              AND LOCATION PARAMETER MU = 1.
C              THE PROTOTYPE FATIGUE LIFE DISTRIBUTION USED
C              HEREIN IS DEFINED FOR ALL POSITIVE X,
C              AND HAS THE PROBABILITY DENSITY FUNCTION
C              RIGPDF(X,GAMMA) = ???
C                     WITH MU = 1
C     NOTE--THE FATIGUE LIFE DISTRIBUTION--
C              GOES FROM 0 TO INFINITY
C              HAS MEAN = MU = 1
C              HAS STANDARD DEVIATION =
C              HAS SHAPE PARAMETER = GAMMA
C              IS HIGHLY-SKEWED AND LONG-TAILED FOR SMALL GAMMA???
C              IS SYMMETRIC AND MODERATE-TAILED FOR LARGE GAMMA???
C              APPROACHES NORMALITY AS GAMMA APPROACHES INFINITY???
C     NOTE--TO OBTAIN THE PDF FOR GENERAL MU,
C           COMPUTE THE PDF FOR X AROUND 1, AND THEN
C           SIMPLY SCALE UP THE HORIZONTAL AXIS X BY THE DESIRED MU
C           AS IN Y2 = MU*Y
C              F(X) = GAMMA * (X**(GAMMA-1)) * EXP(-(X**GAMMA)).
C     INPUT  ARGUMENTS--N      = THE DESIRED INTEGER NUMBER
C                                OF RANDOM NUMBERS TO BE
C                                GENERATED.
C                     --GAMMA  = THE SINGLE PRECISION VALUE OF THE
C                                TAIL LENGTH PARAMETER.
C                                GAMMA SHOULD BE POSITIVE.
C     OUTPUT ARGUMENTS--X      = A SINGLE PRECISION VECTOR
C                                (OF DIMENSION AT LEAST N)
C                                INTO WHICH THE GENERATED
C                                RANDOM SAMPLE WILL BE PLACED.
C     OUTPUT--A RANDOM SAMPLE OF SIZE N
C             FROM THE FATIGUE LIFE DISTRIBUTION
C             WITH TAIL LENGTH PARAMETER VALUE = GAMMA.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--THERE IS NO RESTRICTION ON THE MAXIMUM VALUE
C                   OF N FOR THIS SUBROUTINE.
C                 --GAMMA SHOULD BE POSITIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--UNIRAN.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--NONE HEREIN.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--JOHNSON AND KOTZ
C               --SAM SAUNDERS
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1966)
C     VERSION NUMBER--90.6
C     ORIGINAL VERSION--MAY       1990.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C---------------------------------------------------------------------
C
      DIMENSION X(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(N.LT.1)GOTO50
      IF(GAMMA.LE.0.0)GOTO60
      GOTO90
   50 WRITE(ICOUT, 5)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,47)N
      CALL DPWRST('XXX','BUG ')
      RETURN
   60 WRITE(ICOUT,15)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,46)GAMMA
      CALL DPWRST('XXX','BUG ')
      RETURN
   90 CONTINUE
    5 FORMAT('***** FATAL ERROR--THE FIRST  INPUT ARGUMENT ',
     1'TO THE FLRAN SUBROUTINE IS NON-POSITIVE *****')
   15 FORMAT('***** FATAL ERROR--THE SECOND INPUT ARGUMENT ',
     1'TO THE FLRAN SUBROUTINE IS NON-POSITIVE *****')
   46 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',E15.8,
     1' *****')
   47 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',I8,
     1' *****')
C
C     GENERATE N UNIFORM (0,1) RANDOM NUMBERS;
C
      CALL UNIRAN(N,ISEED,X)
C
C     GENERATE N FATIGUE LIFE DISTRIBUTION RANDOM NUMBERS
C     USING THE PERCENT POINT FUNCTION TRANSFORMATION METHOD.
C
      DO100I=1,N
      XTEMP=X(I)
      CALL FLPPF(XTEMP,GAMMA,X(I))
  100 CONTINUE
C
      RETURN
      END
      REAL FUNCTION FMINDP(AX,BX,F,TOL)
C
C   NOTE: ADDED TO DATAPLOT 12/2003.  USE THIS ROUTINE FOR INTERNAL
C         DATAPLOT USE.  THE DPOPT2 ROUTINE IS ESSENTIALLY A DATAPLOT
C         ADAPTATION OF FMIN THAT IMPLEMENTS "LET A = OPTIMIZE ..."
C         COMMANDS.  IT IS MORE EFFICIENT FOR INTERNAL USE TO USE
C         FMIN EXPLICITLY (AVOID OVERHEAD OF FUNCTION PARSING, ETC.)
C
C   NOTE: MARCH 2005.  RENAME TO FMINDP TO AVOID NAME CONFLICT ON MAC OSX.
C
C***BEGIN PROLOGUE  FMIN
C***DATE WRITTEN   730101  (YYMMDD)
C***REVISION DATE  730101  (YYMMDD) 
C***CATEGORY NO.  G1A2
C***KEYWORDS  ONE-DIMENSIONAL MINIMIZATION, UNIMODAL FUNCTION
C***AUTHOR  BRENT, R.
C***PURPOSE  An approximation to the point where F attains a minimum on
C            the interval (AX,BX) is determined as the value of the 
C            function FMIN.
C***DESCRIPTION
C
C     From the book, "Numerical Methods and Software" by
C                D. Kahaner, C. Moler, S. Nash
C                Prentice Hall, 1988
C
C     The method used is a combination of golden section search and
C     successive parabolic interpolation.  Convergence is never much 
C     slower than that for a Fibonacci search.  If F has a continuous 
C     second derivative which is positive at the minimum (which is not
C     at AX or BX), then convergence is superlinear, and usually of the 
C     order of about 1.324....
C
C     The function F is never evaluated at two points closer together
C     than EPS*ABS(FMIN) + (TOL/3), where EPS is approximately the 
C     square root of the relative machine precision.  If F is a unimodal
C     function and the computed values of F are always unimodal when
C     separated by at least EPS*ABS(XSTAR) + (TOL/3), then FMIN 
C     approximates the abcissa of the global minimum of F on the 
C     interval AX,BX with an error less than 3*EPS*ABS(FMIN) + TOL.  
C     If F is not unimodal, then FMIN may approximate a local, but 
C     perhaps non-global, minimum to the same accuracy.
C
C     This function subprogram is a slightly modified version of the
C     ALGOL 60 procedure LOCALMIN given in Richard Brent, Algorithms for
C     Minimization Without Derivatives, Prentice-Hall, Inc. (1973).
C
C INPUT PARAMETERS
C
C  AX    (real)  left endpoint of initial interval
C  BX    (real) right endpoint of initial interval
C  F     Real function of the form REAL FUNCTION F(X) which evaluates 
C          F(X)  for any  X in the interval  (AX,BX)
C        Must be declared EXTERNAL in calling routine.
C  TOL   (real) desired length of the interval of uncertainty of the 
C        final result ( .ge. 0.0)
C
C
C OUTPUT PARAMETERS
C
C FMIN   abcissa approximating the minimizer of F
C AX     lower bound for minimizer
C BX     upper bound for minimizer
C
C***REFERENCES  RICHARD BRENT, ALGORITHMS FOR MINIMIZATION WITHOUT 
C                 DERIVATIVES, PRENTICE-HALL, INC. (1973).
C***ROUTINES CALLED  (NONE)
C***END PROLOGUE  FMIN
      REAL  AX,BX,F,TOL
      REAL  A,B,C,D,E,EPS,XM,P,Q,R,TOL1,TOL2,U,V,W
      REAL  FU,FV,FW,FX,X
      REAL  ABS,SQRT,SIGN
C***FIRST EXECUTABLE STATEMENT  FMIN
      C = 0.5*(3. - SQRT(5.0))
C
C  C is the squared inverse of the golden ratio
C
C  EPS is approximately the square root of the relative machine
C  precision.
C
      EPS = 1.0
   10 EPS = EPS/2.0
      TOL1 = 1.0 + EPS
      IF (TOL1 .GT. 1.0) GO TO 10
      EPS = SQRT(EPS)
C
C  initialization
C
      A = AX
      B = BX
      V = A + C*(B - A)
      W = V
      X = V
      E = 0.0
      FX = F(X)
      FV = FX
      FW = FX
      D=0.0
      C=0.0
C
C  main loop starts here
C
   20 XM = 0.5*(A + B)
      TOL1 = EPS*ABS(X) + TOL/3.0
      TOL2 = 2.0*TOL1
C
C  check stopping criterion
C
      IF (ABS(X - XM) .LE. (TOL2 - 0.5*(B - A))) GO TO 90
C
C is golden-section necessary
C
      IF (ABS(E) .LE. TOL1) GO TO 40
C
C  fit parabola
C
      R = (X - W)*(FX - FV)
      Q = (X - V)*(FX - FW)
      P = (X - V)*Q - (X - W)*R
      Q = 2.0*(Q - R)
      IF (Q .GT. 0.0) P = -P
      Q = ABS(Q)
      R = E
      E = D
C
C  is parabola acceptable
C
      IF (ABS(P) .GE. ABS(0.5*Q*R)) GO TO 40
      IF (P .LE. Q*(A - X)) GO TO 40
      IF (P .GE. Q*(B - X)) GO TO 40
C
C  a parabolic interpolation step
C
      D = P/Q
      U = X + D
C
C  F must not be evaluated too close to AX or BX
C
      IF ((U - A) .LT. TOL2) D = SIGN(TOL1, XM - X)
      IF ((B - U) .LT. TOL2) D = SIGN(TOL1, XM - X)
      GO TO 50
C
C  a golden-section step
C
   40 IF (X .GE. XM) E = A - X
      IF (X .LT. XM) E = B - X
      D = C*E
C
C  F must not be evaluated too close to X
C
   50 IF (ABS(D) .GE. TOL1) U = X + D
      IF (ABS(D) .LT. TOL1) U = X + SIGN(TOL1, D)
      FU = F(U)
C
C  update  A, B, V, W, and X
C
      IF (FU .GT. FX) GO TO 60
      IF (U .GE. X) A = X
      IF (U .LT. X) B = X
      V = W
      FV = FW
      W = X
      FW = FX
      X = U
      FX = FU
      GO TO 20
   60 IF (U .LT. X) A = U
      IF (U .GE. X) B = U
      IF (FU .LE. FW) GO TO 70
      IF (W .EQ. X) GO TO 70
      IF (FU .LE. FV) GO TO 80
      IF (V .EQ. X) GO TO 80
      IF (V .EQ. W) GO TO 80
      GO TO 20
   70 V = W
      FV = FW
      W = U
      FW = FU
      GO TO 20
   80 V = U
      FV = FU
      GO TO 20
C
C  end of main loop
C
   90 FMINDP = X
      RETURN
      END
      REAL FUNCTION FMIND2(AX,BX,F,DTEMP1,N,TOL)
C
C   NOTE: THIS VERSION OF FMIN ALLOWS PASSING OF ARRAY OF
C         DATA (DTEMP1 AND N TO DENOTE THE SAMPLE SIZE).
C
C***BEGIN PROLOGUE  FMIN
C***DATE WRITTEN   730101  (YYMMDD)
C***REVISION DATE  730101  (YYMMDD) 
C***CATEGORY NO.  G1A2
C***KEYWORDS  ONE-DIMENSIONAL MINIMIZATION, UNIMODAL FUNCTION
C***AUTHOR  BRENT, R.
C***PURPOSE  An approximation to the point where F attains a minimum on
C            the interval (AX,BX) is determined as the value of the 
C            function FMIN.
C***DESCRIPTION
C
C     From the book, "Numerical Methods and Software" by
C                D. Kahaner, C. Moler, S. Nash
C                Prentice Hall, 1988
C
C     The method used is a combination of golden section search and
C     successive parabolic interpolation.  Convergence is never much 
C     slower than that for a Fibonacci search.  If F has a continuous 
C     second derivative which is positive at the minimum (which is not
C     at AX or BX), then convergence is superlinear, and usually of the 
C     order of about 1.324....
C
C     The function F is never evaluated at two points closer together
C     than EPS*ABS(FMIN) + (TOL/3), where EPS is approximately the 
C     square root of the relative machine precision.  If F is a unimodal
C     function and the computed values of F are always unimodal when
C     separated by at least EPS*ABS(XSTAR) + (TOL/3), then FMIN 
C     approximates the abcissa of the global minimum of F on the 
C     interval AX,BX with an error less than 3*EPS*ABS(FMIN) + TOL.  
C     If F is not unimodal, then FMIN may approximate a local, but 
C     perhaps non-global, minimum to the same accuracy.
C
C     This function subprogram is a slightly modified version of the
C     ALGOL 60 procedure LOCALMIN given in Richard Brent, Algorithms for
C     Minimization Without Derivatives, Prentice-Hall, Inc. (1973).
C
C INPUT PARAMETERS
C
C  AX    (real)  left endpoint of initial interval
C  BX    (real) right endpoint of initial interval
C  F     Real function of the form REAL FUNCTION F(X) which evaluates 
C          F(X)  for any  X in the interval  (AX,BX)
C        Must be declared EXTERNAL in calling routine.
C  TOL   (real) desired length of the interval of uncertainty of the 
C        final result ( .ge. 0.0)
C
C
C OUTPUT PARAMETERS
C
C FMIN   abcissa approximating the minimizer of F
C AX     lower bound for minimizer
C BX     upper bound for minimizer
C
C***REFERENCES  RICHARD BRENT, ALGORITHMS FOR MINIMIZATION WITHOUT 
C                 DERIVATIVES, PRENTICE-HALL, INC. (1973).
C***ROUTINES CALLED  (NONE)
C***END PROLOGUE  FMIN
      REAL  AX,BX,F,TOL
      REAL  A,B,C,D,E,EPS,XM,P,Q,R,TOL1,TOL2,U,V,W
      REAL  FU,FV,FW,FX,X
      REAL  ABS,SQRT,SIGN
      DOUBLE PRECISION DTEMP1(*)
C
      INCLUDE 'DPCOP2.INC'
C
C***FIRST EXECUTABLE STATEMENT  FMIN
      FMIND2 = CPUMIN
C
      C = 0.5*(3. - SQRT(5.0))
C
C  C is the squared inverse of the golden ratio
C
C  EPS is approximately the square root of the relative machine
C  precision.
C
      EPS = 1.0
   10 EPS = EPS/2.0
      TOL1 = 1.0 + EPS
      IF (TOL1 .GT. 1.0) GO TO 10
      EPS = SQRT(EPS)
C
C  initialization
C
      A = AX
      B = BX
      V = A + C*(B - A)
      W = V
      X = V
      E = 0.0
      FX = F(X,DTEMP1,N)
      FV = FX
      FW = FX
      D=0.0
      C=0.0
C
C  main loop starts here
C
   20 XM = 0.5*(A + B)
      TOL1 = EPS*ABS(X) + TOL/3.0
      TOL2 = 2.0*TOL1
C
C  check stopping criterion
C
      IF (ABS(X - XM) .LE. (TOL2 - 0.5*(B - A))) GO TO 90
C
C is golden-section necessary
C
      IF (ABS(E) .LE. TOL1) GO TO 40
C
C  fit parabola
C
      R = (X - W)*(FX - FV)
      Q = (X - V)*(FX - FW)
      P = (X - V)*Q - (X - W)*R
      Q = 2.0*(Q - R)
      IF (Q .GT. 0.0) P = -P
      Q = ABS(Q)
      R = E
      E = D
C
C  is parabola acceptable
C
      IF (ABS(P) .GE. ABS(0.5*Q*R)) GO TO 40
      IF (P .LE. Q*(A - X)) GO TO 40
      IF (P .GE. Q*(B - X)) GO TO 40
C
C  a parabolic interpolation step
C
      D = P/Q
      U = X + D
C
C  F must not be evaluated too close to AX or BX
C
      IF ((U - A) .LT. TOL2) D = SIGN(TOL1, XM - X)
      IF ((B - U) .LT. TOL2) D = SIGN(TOL1, XM - X)
      GO TO 50
C
C  a golden-section step
C
   40 IF (X .GE. XM) E = A - X
      IF (X .LT. XM) E = B - X
      D = C*E
C
C  F must not be evaluated too close to X
C
   50 IF (ABS(D) .GE. TOL1) U = X + D
      IF (ABS(D) .LT. TOL1) U = X + SIGN(TOL1, D)
      FU = F(U,DTEMP1,N)
C
C  update  A, B, V, W, and X
C
      IF (FU .GT. FX) GO TO 60
      IF (U .GE. X) A = X
      IF (U .LT. X) B = X
      V = W
      FV = FW
      W = X
      FW = FX
      X = U
      FX = FU
      GO TO 20
   60 IF (U .LT. X) A = U
      IF (U .GE. X) B = U
      IF (FU .LE. FW) GO TO 70
      IF (W .EQ. X) GO TO 70
      IF (FU .LE. FV) GO TO 80
      IF (V .EQ. X) GO TO 80
      IF (V .EQ. W) GO TO 80
      GO TO 20
   70 V = W
      FV = FW
      W = U
      FW = FU
      GO TO 20
   80 V = U
      FV = FU
      GO TO 20
C
C  end of main loop
C
   90 FMIND2 = X
      RETURN
      END
      FUNCTION FNALPH(X,NOBS,BETA,XGM)
C
C COMPUTE MLE FOR SCALE PARAMETER (ALPHA)
C    XGM IS THE GEOMETRIC MEAN OF THE X'S
C
      DOUBLE PRECISION SUMZ
      DIMENSION X(*)
C
      RN=FLOAT(NOBS)
C
      SUMZ=0.0D0
      DO 20 I=1,NOBS
        SUMZ=SUMZ+DBLE((X(I)/XGM)**BETA)
   20 CONTINUE
C
      FNALPH=XGM*(SNGL(SUMZ)/RN)**(1./BETA)
C
      RETURN
      END
      FUNCTION FNALP2(X,NOBS,IR,GAMMA)
C
C    COMPUTE MLE FOR SCALE PARAMETER (ALPHA)
C    THIS IS FOR THE TYPE 2 CENSORED CASE.
C    XGM IS THE GEOMETRIC MEAN OF THE X'S
C
      DOUBLE PRECISION DG
      DOUBLE PRECISION DSUM1
      DOUBLE PRECISION DTERM1
      DOUBLE PRECISION DTERM2
      DOUBLE PRECISION DTERM3
C
      DIMENSION X(*)
C
      DG=DBLE(GAMMA)
C
      DSUM1=0.0D0
      DO 20 I=1,IR
        DSUM1=DSUM1+(DBLE(X(I))**DG)
   20 CONTINUE
      DTERM1=DSUM1/DBLE(IR)
      DTERM2=DBLE(NOBS-IR)*DBLE(X(I))**DG
      DTERM3=(DTERM1 + DTERM2)**(1.0D0/DG)
C
      FNALP2=REAL(DTERM3)
C
      RETURN
      END
      DOUBLE PRECISION FUNCTION FNCMVT(N, W)
*     
*     Integrand subroutine
*
      INTEGER N, NUIN, INFIN(*), INFIS
      DOUBLE PRECISION W(*), LOWER(*), UPPER(*), CORREL(*), D, E
      INTEGER NL, IJ, I, J, NU
      PARAMETER ( NL = 20 )
      DOUBLE PRECISION COV((NL*(NL+1))/2), A(NL), B(NL), Y(NL)
      INTEGER INFI(NL)
      DOUBLE PRECISION PROD, D1, E1, DI, EI, SUM, STDINV, YD, UI, MVTNIT
      SAVE NU, D1, E1, A, B, INFI, COV
      DI = D1
      EI = E1
      PROD = EI - DI
      IJ = 1
      YD = 1.0D0
      DO 100 I = 1, N
         UI = STDINV( NU+I-1, DI + W(I)*( EI - DI ) )
         Y(I) = UI/YD
         YD = YD/SQRT( 1.0D0 + ( UI - 1.0D0 )*( UI + 1.0D0 )/
     +        DBLE( NU + I ) )
         SUM = 0.0D0
         DO 200 J = 1, I
            IJ = IJ + 1
            SUM = SUM + COV(IJ)*Y(J)
  200    CONTINUE
         IJ = IJ + 1
         CALL MVTLMS( NU+I, ( A(I+1) - SUM )*YD, ( B(I+1) - SUM )*YD, 
     &                INFI(I+1), DI, EI ) 
         PROD = PROD*( EI - DI )
  100 CONTINUE
      FNCMVT = PROD
      RETURN 
*
*     Entry point for intialization
*
      ENTRY MVTNIT( N, NUIN, CORREL, LOWER, UPPER, INFIN, INFIS, D, E ) 
      MVTNIT = 0.0D0
*
*     Initialization and computation of covariance matrix Cholesky factor
*
      CALL MVTSRT( N, NUIN, LOWER, UPPER, CORREL, INFIN, Y, INFIS, 
     &             A, B, INFI, COV, D, E )
      NU = NUIN
      D1 = D
      E1 = E
C
      RETURN
      END
      SUBROUTINE FNRCDF(X,U,SD,CDF)
C
C     NOTE--FOLDED-NORMAL PDF IS:
C              FNRPDF(X,U,S,P) = NORPDF((X-U)/S) + NORPDF((X+U)/S))
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--95/9
C     ORIGINAL VERSION--SEPTEMBER 1995.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      CDF=0.0
C
      IF(X.LT.0.0)THEN
        CDF=0.0
        GOTO9999
      ENDIF
      IF(SD.LE.0.0)THEN
        WRITE(ICOUT,201)
  201   FORMAT('***** ERROR--THE THIRD ARGUMENT TO FNRCDF (STANDARD ',
     1         'DEVIATION) IS NON-POSITIVE.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)SD
   46   FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7)
        CALL DPWRST('XXX','BUG ')
        GOTO9999
      ENDIF
C
      TERM1=(X-U)/SD
      CALL NORCDF(TERM1,TERM2)
      TERM2=TERM2
      TERM3=(-X-U)/SD
      CALL NORCDF(TERM3,TERM4)
      TERM4=TERM4
      CDF=TERM2-TERM4
      GOTO9999
C
 9999 CONTINUE
      RETURN
      END
      SUBROUTINE FNRFUN (N, X, FVEC, IFLAG, XDATA, NOBS)
C
C     PURPOSE--THIS ROUTINE COMPUTES THE FUNCTIONS FOR THE
C              FOLDED NORMAL MAXIMUM LIKELIHOOD
C              EQUATIONS.
C
C              MU**2 + SIGMA**2 - SUM[i=1 to n][X(i)**2]/N
C
C              MU - SUM[i=1 to n][X(i)*TANH(LOC*X(i)/SIGMA**2)]/N
C
C              WITH LOC AND SCALE DENOTING THE SHAPE PARAMETERS.
C
C              CALLED BY DNSQE ROUTINE FOR SOLVING SIMULTANEOUS
C              NONLINEAR EQUATIONS.  NOTE THAT THE CALLING SEQUENCE
C              DID NOT ACCOMODATE A DATA ARRAY (AND ASSCIATED NUMBER OF
C              OBSERVATIONS), SO THESE WERE ADDED TO THE CALL LIST.
C     EXAMPLE--FOLDED NORMAL MAXIMUM LIKELIHOOD Y
C     REFERENCE--"CONTINUOUS UNIVARIATE DISTRIBUTIONS-VVOLUME II",
C                SECOND EDITION, JOHNSON, KOTZ, AND BALAKRISHNAN,
C                1994, WILEY, P. 454.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBUG, MD 20899-8980
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2004/3
C     ORIGINAL VERSION--MARCH     2004.
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION X(*)
      DOUBLE PRECISION FVEC(*)
      REAL XDATA(*)
C
      DOUBLE PRECISION DN
      DOUBLE PRECISION DX
      DOUBLE PRECISION DLOC
      DOUBLE PRECISION DSCALE
      DOUBLE PRECISION DSUM1
      DOUBLE PRECISION DSUM2
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C  COMPUTE SOME SUMS
C
      N=2
      IFLAG=0
C
      DLOC=X(1)
      DSCALE=X(2)
      DN=DBLE(NOBS)
C
      DSUM1=0.0D0
      DSUM2=0.0D0
C
      DO200I=1,NOBS
        DX=DBLE(XDATA(I))
        DSUM1=DSUM1 + DX*DX
        DSUM2=DSUM2 + DX*TANH(DLOC*DX/DSCALE)
  200 CONTINUE
C
      FVEC(1)=DLOC*DLOC + DSCALE - (DSUM1/DN)
      FVEC(2)=DLOC - (DSUM2/DN)
C
      RETURN
      END
      DOUBLE PRECISION FUNCTION FNRFU2 (DX)
C
C     PURPOSE--THIS ROUTINE COMPUTES A FUNCTION NEEDED TO OBTAIN THE
C              PARAMETER COVARIANCE MATRIX FOR THE FOLDED NORMAL MLE.
C
C              SPECIFICALLY, THE INDEFINITE INTEGRAL IS NEEDED FOR
C
C              X**2*EXP(0.5*X**2)*SECH(THETA*X)
C
C              CALLED BY DQAGI.
C     REFERENCE--N. L. JOHNSON (1962), "THE FOLDED NORMAL DISTRIBUTION:
C                ACCURACY OF ESTIMATION BY MAXIMUM LIKELIHOOD",
C                TECHNOMETRICS, VOL. 4, NO. 2, PP. 249-256.
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBUG, MD 20899-8980
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2014/5
C     ORIGINAL VERSION--MAY       2014.
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DX
C
      DOUBLE PRECISION DTERM1
      DOUBLE PRECISION DTERM2
      DOUBLE PRECISION DARG
C
      DOUBLE PRECISION DTHETA
      COMMON/FNRCOM/DTHETA
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C  COMPUTE SOME SUMS
C
      DTERM1=DX**2*DEXP(-0.5D0*DX**2)
      DARG=DTHETA*DX
      DTERM2=2.0D0/(DEXP(DARG)+DEXP(-DARG))
      FNRFU2=DTERM1*DTERM2
C
      RETURN
      END
      SUBROUTINE FNRLI1(Y,N,ALOC,SCALE,
     1                  ALIK,AIC,AICC,BIC,
     1                  ISUBRO,IBUGA3,IERROR)
C
C     PURPOSE--THIS ROUTINE COMPUTES THE LIKELIHOOD FUNCTION FOR
C              THE FOLED NORMAL DISTRIBUTION.  THIS IS FOR THE FULL
C              SAMPLE RAW DATA CASE (I.E., NO GROUPING AND NO CENSORING).
C
C     REFERENCE--N. L. JOHNSON (1962), "THE FOLDED NORMAL DISTRIBUTION:
C                ACCURACY OF ESTIMATION BY MAXIMUM LIKELIHOOD",
C                TECHNOMETRICS, VOL. 4, NO. 2, PP. 249-256.
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2014/05
C     ORIGINAL VERSION--MAY       2014.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 ISUBRO
      CHARACTER*4 IBUGA3
      CHARACTER*4 IERROR
C
      CHARACTER*4 IWRITE
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
      CHARACTER*4 ISTEPN
C
      DOUBLE PRECISION DX
      DOUBLE PRECISION DS
      DOUBLE PRECISION DU
      DOUBLE PRECISION DTHETA
      DOUBLE PRECISION DN
      DOUBLE PRECISION DPI
      DOUBLE PRECISION DNP
      DOUBLE PRECISION DLIK
      DOUBLE PRECISION DSUM1
      DOUBLE PRECISION DSUM2
      DOUBLE PRECISION DTERM1
      DOUBLE PRECISION DTERM2
      DOUBLE PRECISION DTERM3
C
C---------------------------------------------------------------------
C
      DIMENSION Y(*)
C
C---------------------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
      DATA DPI / 3.1415926535 8979323846 2643383279 503 D0 /
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='NORL'
      ISUBN2='I1  '
C
      IERROR='NO'
C
      ALIK=CPUMIN
      AIC=CPUMIN
      AICC=CPUMIN
      BIC=CPUMIN
C
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'RLI1')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,51)
   51   FORMAT('**** AT THE BEGINNING OF FNRLI1--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,52)IBUGA3,ISUBRO,N,ALOC,SCALE
   52   FORMAT('IBUGA3,ISUBRO,N,ALOC,SCALE = ',2(A4,2X),I8,2G15.7)
        CALL DPWRST('XXX','WRIT')
        DO56I=1,MIN(N,100)
          WRITE(ICOUT,57)I,Y(I)
   57     FORMAT('I,Y(I) = ',I8,G15.7)
          CALL DPWRST('XXX','WRIT')
   56   CONTINUE
      ENDIF
C
C               ******************************************
C               **  STEP 1--                            **
C               **  COMPUTE LIKELIHOOD FUNCTION         **
C               ******************************************
C
      ISTEPN='1'
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'RLI1')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      IERFLG=0
      IERROR='NO'
      IWRITE='OFF'
C
C     NOTE THAT THE LOG-LIKELIHOOD IS GIVEN IN TERMS OF SIGMA AND
C     THETA = (MU/SIGMA).
C
C     THE LOG-LIKELIHOOD FUNCTION IS THEN:
C
C     -(N/2)*LOG(2*PI) - N*LOG(SIGMA) - N*THETA**2/2 -
C     0.5*SUM[i=1 to N][X(I)**2]/SIGMA)**2 +
C     SUM[i=1 to N][LOG(COSH(THETA*X(I)/SIGMA))]
C
      DN=DBLE(N)
      DS=DBLE(SCALE)
      DU=DBLE(ALOC)
      DTHETA=DU/DS
      DTERM1=(DN/2.0D0)*DLOG(2.0D0/DPI) - DN*DLOG(DS) -
     1       DN*DTHETA**2/2.0D0
C
      DSUM1=0.0D0
      DSUM2=0.0D0
      DO1000I=1,N
        DX=DBLE(Y(I))
        DSUM1=DSUM1 + (DX/DS)**2
        DTERM2=DTHETA*DX/DS
        DTERM3=(DEXP(DTERM2)+DEXP(-DTERM2))/2.0D0
        DSUM2=DSUM2 + DLOG(DTERM3)
 1000 CONTINUE
C
      DLIK=DTERM1 - 0.5D0*DSUM1 + DSUM2
      ALIK=REAL(DLIK)
      DNP=2.0D0
      AIC=REAL(-2.0D0*DLIK + 2.0D0*DNP)
      DTERM3=(2.0D0*DNP*(DNP+1.0D0))/(DN-DNP-1.0D0)
      AICC=REAL(-2.0D0*DLIK + 2.0D0*DNP + DTERM3)
      BIC=REAL(-2.0D0*DLIK + DNP*LOG(DN))
C
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'RLI1')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9011)
 9011   FORMAT('**** AT THE END OF FNRLI1--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9013)DSUM1,DSUM2,DTERM1,DTERM3
 9013   FORMAT('DSUM1,DSUM2,DTERM1,DTERM3 = ',4G15.7)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9014)ALIK,AIC,AICC,BIC
 9014   FORMAT('ALIK,AIC,AICC,BIC = ',4G15.7)
        CALL DPWRST('XXX','WRIT')
      ENDIF
C
      RETURN
      END
      SUBROUTINE FNRML1(Y,N,MAXNXT,
     1                  TEMP1,DTEMP1,
     1                  XMEAN,XSD,XVAR,XMIN,XMAX,
     1                  ALOCML,SCALML,
     1                  ISUBRO,IBUGA3,IERROR)
C
C     PURPOSE--THIS ROUTINE COMPUTES THE MAXIMUM LIKELIHOOD ESTIMATES
C              FOR THE 2-PARAMETER FOLDED NORMAL DISTRIBUTION FOR THE
C              RAW DATA CASE (I.E., NO CENSORING AND NO GROUPING).  THIS
C              ROUTINE RETURNS ONLY THE POINT ESTIMATES (CONFIDENCE
C              INTERVALS WILL BE COMPUTED IN A SEPARATE ROUTINE).
C
C              IT IS ASSUMED THAT BASIC ERROR CHECKING HAS ALREADY BEEN
C              PERFORMED.
C
C              PUT THIS IN A SEPARATE ROUTINE AS IT MAY BE CALLED
C              FROM MULTIPLE PLACES (DPMLFN WILL GENERATE THE OUTPUT
C              FOR THE FOLDED NORMAL MLE COMMAND).
C
C     REFERENCE--"CONTINUOUS UNIVARIATE DISTRIBUTIONS-VVOLUME II",
C                SECOND EDITION, JOHNSON, KOTZ, AND BALAKRISHNAN,
C                1994, WILEY, P. 454.
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2010/2
C     ORIGINAL VERSION--FEBRUARY  2010. EXTRACTED AS A SEPARATE
C                                       SUBROUTINE (FROM DPMLE1)
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      DIMENSION Y(*)
      DIMENSION TEMP1(*)
      DOUBLE PRECISION DTEMP1(*)
C
      DOUBLE PRECISION TOL
      DOUBLE PRECISION XPAR(2)
      DOUBLE PRECISION FVEC(2)
C
      EXTERNAL FNRFUN
C
      CHARACTER*4 ISUBRO
      CHARACTER*4 IBUGA3
      CHARACTER*4 IERROR
C
      CHARACTER*4 IWRITE
      CHARACTER*40 IDIST
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
      CHARACTER*4 ISTEPN
C
C---------------------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='FNRM'
      ISUBN2='L1  '
      IERROR='NO'
      IWRITE='OFF'
C
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'RML1')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,51)
   51   FORMAT('**** AT THE BEGINNING OF FNRML1--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,52)IBUGA3,ISUBRO
   52   FORMAT('IBUGA3,ISUBRO = ',A4,2X,A4)
        CALL DPWRST('XXX','WRIT')
        DO56I=1,MIN(N,100)
          WRITE(ICOUT,57)I,Y(I),TEMP1(I)
   57     FORMAT('I,Y(I),TEMP1((I) = ',I8,2G15.7)
          CALL DPWRST('XXX','WRIT')
   56   CONTINUE
      ENDIF
C
C               ********************************************
C               **  STEP 1--                              **
C               **  CHECK THE INPUT ARGUMENTS FOR ERRORS  **
C               ********************************************
C
      ISTEPN='1'
      IF(IBUGA3.EQ.'ON' .OR. ISUBRO.EQ.'RML1')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
C               *****************************************************
C               **  STEP 2--                                       **
C               **  CARRY OUT CALCULATIONS                         **
C               **  FOR FOLDED NORMAL MLE ESTIMATE                 **
C               *****************************************************
C
      ISTEPN='2'
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'RML1')
     1CALL TRACE2(ISTEPN,ISUBN1,ISUBN2)
C
      IDIST='FOLDED NORMAL'
C
      IFLAG=2
      CALL SUMRAW(Y,N,IDIST,IFLAG,
     1            XMEAN,XVAR,XSD,XMIN,XMAX,
     1            ISUBRO,IBUGA3,IERROR)
C
      ALOCML=CPUMIN
      SCALML=CPUMIN
C
      XPAR(1)=DBLE(XMEAN)
      XPAR(2)=DBLE(XSD*XSD)
C
      IOPT=2
      TOL=1.0D-5
      NVAR=2
      NPRINT=-1
      INFO=0
      LWA=MAXNXT
      CALL DNSQE(FNRFUN,JAC,IOPT,NVAR,XPAR,FVEC,TOL,NPRINT,INFO,
     1           DTEMP1,MAXNXT,Y,N)
C
      ALOCML=REAL(XPAR(1))
      SCALML=REAL(XPAR(2))
      SCALML=SQRT(SCALML)
C
      IF(IBUGA3.EQ.'ON'.OR.ISUBRO.EQ.'RML1')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9011)
 9011   FORMAT('**** AT THE END OF FNRML1--')
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9013)N,XMEAN,XSD,XMIN,XMAX
 9013   FORMAT('N,XMEAN,XSD,XMIN,XMAX = ',I8,4G15.7)
        CALL DPWRST('XXX','WRIT')
        WRITE(ICOUT,9017)ALOCML,SCALML
 9017   FORMAT('ALOCML,SCALML =  ',2G15.7)
        CALL DPWRST('XXX','WRIT')
      ENDIF
C
      RETURN
      END
      SUBROUTINE FNRPDF(X,U,SD,PDF)
C
C     NOTE--FOLDED-NORMAL PDF IS:
C              FNRPDF(X,U,S)=(1/S)*(NORPDF((X-U)/S) + NORPDF((X+U)/S)))
C           WHERE NORPDF IS THE PDF OF THE STANDARD NORMAL DISTRIBUTION
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--95/4
C     ORIGINAL VERSION--APRIL     1995.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      PDF=0.0
C
      IF(X.LT.0.0)THEN
        WRITE(ICOUT,4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)X
        CALL DPWRST('XXX','BUG ')
        PDF=0.0
        GOTO9999
      ENDIF
      IF(SD.LE.0.0)THEN
        WRITE(ICOUT,201)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)SD
        CALL DPWRST('XXX','BUG ')
        GOTO9999
      ENDIF
    4 FORMAT('***** ERROR--THE FIRST ARGUMENT TO FNRPDF IS NEGATIVE.')
   46 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7)
  201 FORMAT('***** ERROR--THE THIRD ARGUMENT TO FNRPDF (STANDARD ',
     1       'DEVIATION) IS NON-POSITIVE.')
C
      TERM1=(X-U)/SD
      CALL NORPDF(TERM1,TERM2)
      TERM2=TERM2/SD
      TERM3=(X+U)/SD
      CALL NORPDF(TERM3,TERM4)
      TERM4=TERM4/SD
      PDF=TERM2+TERM4
      GOTO9999
C
 9999 CONTINUE
      RETURN
      END
      SUBROUTINE FNRPPF(P,U,SD,PPF)
C
C     PURPOSE   --PERCENT POINT FUNCTION FOR THE FOLDED NORMAL
C                 DISTRIBUTION.  USES A BISECTION METHOD.
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899-8980
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--95/9
C     ORIGINAL VERSION--SEPTEMBER 1995.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DU
      DOUBLE PRECISION DMEAN
      DOUBLE PRECISION DSD
      DOUBLE PRECISION DPI
      DOUBLE PRECISION DSDF
C
      DOUBLE PRECISION DP
      DOUBLE PRECISION EPS
      DOUBLE PRECISION SIG
      DOUBLE PRECISION ZERO
      DOUBLE PRECISION DTERM1
      DOUBLE PRECISION DTERM2
      DOUBLE PRECISION DTERM3
      DOUBLE PRECISION DTERM4
      DOUBLE PRECISION XL
      DOUBLE PRECISION XR
      DOUBLE PRECISION XINC
      DOUBLE PRECISION X
      DOUBLE PRECISION FXL
      DOUBLE PRECISION FXR
      DOUBLE PRECISION P1
      DOUBLE PRECISION FCS
      DOUBLE PRECISION XRML
      DOUBLE PRECISION DCDF
      DOUBLE PRECISION CDFL
      DOUBLE PRECISION CDFR
C
      INCLUDE 'DPCOP2.INC'
C
      DATA DPI /3.14159265358979D0/
      DATA EPS /0.00001D0/
      DATA SIG /1.0D-6/
      DATA ZERO /0.0D0/
      DATA MAXIT /5000/
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      PPF=0.0
      IF(P.LT.0.0.OR.P.GE.1.0)THEN
        WRITE(ICOUT,1)
    1   FORMAT('***** ERROR--THE FIRST ARGUMENT TO FNRPPF IS OUTSIDE ',
     1         'THE ALLOWABLE (0,1) INTERVAL.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)P
        CALL DPWRST('XXX','BUG ')
        GOTO9999
      ELSEIF(SD.LE.0.0)THEN
        WRITE(ICOUT,35)
   35   FORMAT('***** ERROR--THE THIRD ARGUMENT TO FNRPPF IS ',
     1         'NON-POSITIVE.')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)SD
        CALL DPWRST('XXX','BUG ')
        GOTO9999
      ENDIF
C
   46 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7)
C
C  NOVEMBER 1995.  IF P IS 0, PPF IS ZERO.  HANDLE THIS TRIVIAL CASE.
C
      IF(P.EQ.0.0)THEN
        PPF=0.0
        GOTO9999
      ENDIF
C
C  FIND BRACKETING INTERVAL.
C  AFTER SUCCESSFULLY FIND BRACKETING INTERVAL, THEN SWITCH TO 
C  MORE EFFICIENT BISECTION METHOD.
C
C  CALCULATE MEAN AND STANDARD DEVIATION OF FOLDED NORMAL
C
      DU=DBLE(U)
      DSD=DBLE(SD)
      DP=DBLE(P)
      DTERM1=DEXP(-DU**2/(2.0D0*DSD**2))
      DTERM2=DSQRT(2.D0/DPI)
      DTERM3=-DU/DSD
      CALL NODCDF(DTERM3,DTERM4)
      DMEAN=DTERM2*DSD*DTERM1 + DU*(1.D0-2.D0*DTERM4)
      DSDF=DMEAN**2 + DU*DU + DSD*DSD
C
      XL=DMEAN
      XINC=DSDF
      IF(XINC.LT.1.0D0)XINC=1.0D0
      ICOUNT=0
C
   91 CONTINUE
      XR=XL+XINC
      IF(XL.LE.0.0D0)XL=0.0D0
      IF(XR.LE.0.0D0)XR=XL+1.0D0
CCCCC CALL FNRCDF(XL,U,SD,CDFL)
C
      DTERM1=(XL-DU)/DSD
      CALL NODCDF(DTERM1,DTERM2)
      DTERM3=(-XL-DU)/DSD
      CALL NODCDF(DTERM3,DTERM4)
      CDFL=DTERM2-DTERM4
C
CCCCC CALL FNRCDF(XR,U,SD,CDFR)
C
      DTERM1=(XR-DU)/DSD
      CALL NODCDF(DTERM1,DTERM2)
      DTERM3=(-XR-DU)/DSD
      CALL NODCDF(DTERM3,DTERM4)
      CDFR=DTERM2-DTERM4
C
      IF(CDFL.LT.DP .AND. CDFR.LT.DP)THEN
        XL=XR
      ELSEIF(CDFL.GT.DP .AND. CDFR.GT.DP)THEN
        XL=XL-XINC
      ELSE
        GOTO99
      ENDIF
      ICOUNT=ICOUNT+1
      IF(ICOUNT.GT.MAXIT)THEN
        WRITE(ICOUT,96)
        CALL DPWRST('XXX','BUG ')
        PPF=0.0
        GOTO9999
      ENDIF
   96 FORMAT('***** FATAL ERROR--FNRPPF UNABLE TO FIND BRACKETING ',
     *       'INTERVAL. *****')
      GOTO91
C
C  BISECTION METHOD
C
   99 CONTINUE
      IC = 0
      FXL = -DP
      FXR = 1.0D0 - DP
  105 CONTINUE
      X = (XL+XR)*0.5D0
CCCCC CALL FNRCDF(X,U,SD,CDF)
C
      DTERM1=(X-DU)/DSD
      CALL NODCDF(DTERM1,DTERM2)
      DTERM3=(-X-DU)/DSD
      CALL NODCDF(DTERM3,DTERM4)
      DCDF=DTERM2-DTERM4
C
      P1=DCDF
      PPF=X
      FCS = P1 - DP
      IF(FCS*FXL.GT.ZERO)GOTO110
      XR = X
      FXR = FCS 
      GOTO115
  110 CONTINUE
      XL = X
      FXL = FCS
  115 CONTINUE
      XRML = XR - XL
      IF(XRML.LE.SIG .AND. ABS(FCS).LE.EPS)GOTO9999
      IC = IC + 1
      IF(IC.LE.MAXIT)GOTO105
      WRITE(ICOUT,130)
      CALL DPWRST('XXX','BUG ')
  130 FORMAT('***** FATAL ERROR--FNRPPF ROUTINE DID NOT CONVERGE. ***')
      GOTO9999
C
 9999 CONTINUE
      RETURN
      END
      SUBROUTINE FNRRAN(N,U,SD,ISEED,X)
C
C     PURPOSE--THIS SUBROUTINE GENERATES A RANDOM SAMPLE OF SIZE N
C              FROM THE FOLDED NORMAL DISTRIBUTION.
C     INPUT  ARGUMENTS--N      = THE DESIRED INTEGER NUMBER
C                                OF RANDOM NUMBERS TO BE
C                                GENERATED.
C                       U      = MEAN OF PARENT NORMAL DISTRIBUTION
C                       SD     = STANDARD DEVIATION OF PARENT NORMAL
C                                DISTRIBUTION
C     OUTPUT ARGUMENTS--X      = A SINGLE PRECISION VECTOR
C                                (OF DIMENSION AT LEAST N)
C                                INTO WHICH THE GENERATED
C                                RANDOM SAMPLE WILL BE PLACED.
C     OUTPUT--A RANDOM SAMPLE OF SIZE N
C             FROM THE FOLDED-NORMAL DISTRIBUTION
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--THERE IS NO RESTRICTION ON THE MAXIMUM VALUE
C                   OF N FOR THIS SUBROUTINE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--UNIRAN.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--LOG, SQRT, SIN, COS.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--TOCHER, THE ART OF SIMULATION,
C                 1963, PAGES 14-15.
C               --HAMMERSLEY AND HANDSCOMB, MONTE CARLO METHODS,
C                 1964, PAGE 36.
C               --JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--1, 1970, PAGES 53, 59, 81, 83.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1966)
C     VERSION NUMBER--95/10
C     ORIGINAL VERSION--OCTOBER   1995.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C---------------------------------------------------------------------
C
      DIMENSION X(*)
      DIMENSION Y(2)
C
C-----COMMOMN---------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----DATA STATEMENTS-------------------------------------------------
C
      DATA PI/3.14159265359/
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(N.LT.1)GOTO50
      GOTO90
   50 WRITE(ICOUT, 5)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,47)N
      CALL DPWRST('XXX','BUG ')
      RETURN
   90 CONTINUE
    5 FORMAT('***** FATAL ERROR--THE 1ST INPUT ARGUMENT TO THE ',
     1'FNRRAN SUBROUTINE IS NON-POSITIVE *****')
   47 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',I8,' *****')
C
C     GENERATE N UNIFORM (0,1) RANDOM NUMBERS;
C     THEN GENERATE 2 ADDITIONAL UNIFORM (0,1) RANDOM NUMBERS
C     (TO BE USED BELOW IN FORMING THE N-TH NORMAL
C     RANDOM NUMBER WHEN THE DESIRED SAMPLE SIZE N
C     HAPPENS TO BE ODD).
C
      CALL UNIRAN(N,ISEED,X)
      CALL UNIRAN(2,ISEED,Y)
C
C     GENERATE N NORMAL RANDOM NUMBERS
C     USING THE BOX-MULLER METHOD.
C
      DO200I=1,N,2
      IP1=I+1
      U1=X(I)
      IF(I.EQ.N)GOTO210
      U2=X(IP1)
      GOTO220
  210 U2=Y(2)
  220 ARG1=-2.0*LOG(U1)
      ARG2=2.0*PI*U2
      SQRT1=SQRT(ARG1)
      Z1=SQRT1*COS(ARG2)
      Z2=SQRT1*SIN(ARG2)
      X(I)=Z1
      IF(I.EQ.N)GOTO200
      X(IP1)=Z2
  200 CONTINUE
C
C     GENERATE N FOLDED NORMAL RANDOM NUMBERS
C     USING THE DEFINITION THAT
C     A FOLDED NORMAL VARIATE
C     EQUALS THE ABSOLUTE VALUE OF A NORMAL VARIATE WITH
C     MEAN U AND STANDARD DEVIATION SD.
C
      DO400I=1,N
      X(I)=SD*X(I)+U
      IF(X(I).LT.0.0)X(I)=-X(I)
  400 CONTINUE
C
      RETURN
      END
      SUBROUTINE FTCDF(X,NU,CDF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE CUMULATIVE DISTRIBUTION
C              FUNCTION VALUE FOR THE FOLDED T DISTRIBUTION
C              WITH INTEGER DEGREES OF FREEDOM PARAMETER = NU.
C              THIS DISTRIBUTION IS DEFINED FOR NON-NEGATIVE X
C              AND IS THE ABSOLUTE VALUE OF THE STUDENT'S T
C              DISTRIBUTION.
C              THE CUMULATIVE DISTRIBUTION FUNCTION IS COMPUTED
C              FROM THE CORRESPONDING T CDF FUNCTION
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE AT
C                                WHICH THE CUMULATIVE DISTRIBUTION
C                                FUNCTION IS TO BE EVALUATED.
C                                X SHOULD BE NON-NEGATIVE.
C                     --NU     = THE INTEGER NUMBER OF DEGREES
C                                OF FREEDOM.
C                                NU SHOULD BE POSITIVE.
C     OUTPUT ARGUMENTS--CDF    = THE SINGLE PRECISION PROBABILITY
C                                DENSITY FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION PROBABILITY DENSITY
C             FUNCTION VALUE CDF FOR THE FODLED T DISTRIBUTION
C             WITH DEGREES OF FREEDOM PARAMETER = NU.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--NU SHOULD BE A POSITIVE INTEGER VARIABLE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--TCDF.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--NONE.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--JOHNSON, KOTZ, AND BALAKRISHNAN, "CONTINUOUS
C                 UNIVARIATE DISTRIBUTIONS, VOLUME 2, 1994, PAGE 403,
C                 JOHN WILEY.
C                 PAGES 132-134.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING LABORATORY (205.03)
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE:  301-975-2855
C     ORIGINAL VERSION--NOVEMBER  2003.
C     UPDATED         --OCTOBER   2006. CALL LIST TO TCDF
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C---------------------------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(X.LT.0.0)THEN
        WRITE(ICOUT,4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,5)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)X
        CALL DPWRST('XXX','BUG ')
        CDF=0.0
        GOTO9999
      ENDIF
      IF(NU.LE.0)THEN
        WRITE(ICOUT,15)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,47)NU
        CALL DPWRST('XXX','BUG ')
        CDF=0.0
        GOTO9999
      ENDIF
    4 FORMAT('***** NON-FATAL DIAGNOSTIC--THE FIRST  INPUT ARGUMENT')
    5 FORMAT('      TO THE FOLDED T CDF SUBROUTINE IS NEGATIVE *****')
   15 FORMAT('***** FATAL ERROR--THE DEGREES OF FREEDOM ARGUMENT ',
     1       'TO THE FOLDED T CDF SUBROUTINE IS NON-POSITIVE *****')
   46 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',E15.8,' *****')
   47 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',I8,' *****')
C
C-----START POINT-----------------------------------------------------
C
      CALL TCDF(X,REAL(NU),CDF)
      CDF=2.0*CDF - 1.0
C
 9999 CONTINUE
      RETURN
      END 
      SUBROUTINE FTPDF(X,NU,PDF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE PROBABILITY DENSITY
C              FUNCTION VALUE FOR THE FOLDED T DISTRIBUTION
C              WITH INTEGER DEGREES OF FREEDOM PARAMETER = NU.
C              THIS DISTRIBUTION IS DEFINED FOR NON-NEGATIVE X
C              AND IS THE ABSOLUTE VALUE OF THE STUDENT'S T
C              DISTRIBUTION.
C              THE PROBABILITY DENSITY FUNCTION IS GIVEN
C              IN THE REFERENCES BELOW.
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE AT
C                                WHICH THE PROBABILITY DENSITY
C                                FUNCTION IS TO BE EVALUATED.
C                                X SHOULD BE NON-NEGATIVE.
C                     --NU     = THE INTEGER NUMBER OF DEGREES
C                                OF FREEDOM.
C                                NU SHOULD BE POSITIVE.
C     OUTPUT ARGUMENTS--PDF    = THE SINGLE PRECISION PROBABILITY
C                                DENSITY FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION PROBABILITY DENSITY
C             FUNCTION VALUE PDF FOR THE FODLED T DISTRIBUTION
C             WITH DEGREES OF FREEDOM PARAMETER = NU.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--NU SHOULD BE A POSITIVE INTEGER VARIABLE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--TPDF.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--NONE.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--JOHNSON, KOTZ, AND BALAKRISHNAN, "CONTINUOUS
C                 UNIVARIATE DISTRIBUTIONS, VOLUME 2, 1994, PAGE 403,
C                 JOHN WILEY.
C                 PAGES 132-134.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING LABORATORY (205.03)
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE:  301-975-2855
C     ORIGINAL VERSION--NOVEMBER  2003.
C     UPDATED         --OCTOBER   2006. CALL LIST TO TPDF
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C---------------------------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(X.LT.0.0)THEN
        WRITE(ICOUT,4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,5)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)X
        CALL DPWRST('XXX','BUG ')
        PDF=0.0
        GOTO9999
      ENDIF
      IF(NU.LE.0)THEN
        WRITE(ICOUT,15)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,47)NU
        CALL DPWRST('XXX','BUG ')
        PDF=0.0
        GOTO9999
      ENDIF
    4 FORMAT('***** NON-FATAL DIAGNOSTIC--THE FIRST  INPUT ARGUMENT')
    5 FORMAT('      TO THE FOLDED T PDF SUBROUTINE IS NEGATIVE *****')
   15 FORMAT('***** FATAL ERROR--THE DEGREES OF FREEDOM ARGUMENT ',
     1       'TO THE FOLDED T PDF SUBROUTINE IS NON-POSITIVE *****')
   46 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',E15.8,' *****')
   47 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',I8,' *****')
C
C-----START POINT-----------------------------------------------------
C
      CALL TPDF(X,REAL(NU),PDF)
      PDF=2.0*PDF
C
 9999 CONTINUE
      RETURN
      END 
      SUBROUTINE FTPPF(P,NU,PPF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE PERCENT POINT
C              FUNCTION VALUE FOR THE FOLDED T DISTRIBUTION
C              WITH INTEGER DEGREES OF FREEDOM PARAMETER = NU.
C              THIS DISTRIBUTION IS DEFINED FOR NON-NEGATIVE X
C              AND IS THE ABSOLUTE VALUE OF THE STUDENT'S T
C              DISTRIBUTION.
C              THE PERCENT POINT FUNCTION IS COMPUTED
C              FROM THE CORRESPONDING T PPF FUNCTION
C     INPUT  ARGUMENTS--P      = THE SINGLE PRECISION VALUE (BETWEEN
C                                0.0 AND 1.0) AT WHICH THE PERCENT
C                                POINT FUNCTION IS TO BE EVALUATED.
C                     --NU     = THE INTEGER NUMBER OF DEGREES
C                                OF FREEDOM.
C                                NU SHOULD BE POSITIVE.
C     OUTPUT ARGUMENTS--PPF    = THE SINGLE PRECISION PERCENT POINT
C                                FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION PERCENT POINT
C             FUNCTION VALUE PPF FOR THE FODLED T DISTRIBUTION
C             WITH DEGREES OF FREEDOM PARAMETER = NU.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--NU SHOULD BE A POSITIVE INTEGER VARIABLE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--TPPF.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--NONE.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--JOHNSON, KOTZ, AND BALAKRISHNAN, "CONTINUOUS
C                 UNIVARIATE DISTRIBUTIONS, VOLUME 2, 1994, PAGE 403,
C                 JOHN WILEY.
C                 PAGES 132-134.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING LABORATORY (205.03)
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE:  301-975-2855
C     ORIGINAL VERSION--NOVEMBER  2003.
C     UPDATED         --OCTOBER   2006. CALL LIST TO TPPF
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C---------------------------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(P.LT.0.0 .OR. P.GE.1.0)THEN
        WRITE(ICOUT,4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,5)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,6)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,46)P
        CALL DPWRST('XXX','BUG ')
        PPF=0.0
        GOTO9999
      ENDIF
      IF(NU.LE.0)THEN
        WRITE(ICOUT,15)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,47)NU
        CALL DPWRST('XXX','BUG ')
        PPF=0.0
        GOTO9999
      ENDIF
    4 FORMAT('***** NON-FATAL DIAGNOSTIC--THE FIRST  INPUT ARGUMENT')
    5 FORMAT('      TO THE FOLDED T PPF SUBROUTINE IS OUTSIDE THE ')
    6 FORMAT('      ALLOWABLE (0,1] INTERVAL.')
   15 FORMAT('***** FATAL ERROR--THE DEGREES OF FREEDOM ARGUMENT ',
     1       'TO THE FOLDED T PPF SUBROUTINE IS NON-POSITIVE *****')
   46 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',E15.8,' *****')
   47 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',I8,' *****')
C
C-----START POINT-----------------------------------------------------
C
      ARG=(1.0+P)/2.0
      CALL TPPF(ARG,REAL(NU),PPF)
      IF(PPF.LE.0.0)PPF=0.0
C
 9999 CONTINUE
      RETURN
      END 
      SUBROUTINE FTRAN(N,NU,ISEED,X)
C
C     PURPOSE--THIS SUBROUTINE GENERATES A RANDOM SAMPLE OF SIZE N
C              FROM THE FOLDED T DISTRIBUTION
C              WITH INTEGER DEGREES OF FREEDOM PARAMETER = NU.
C              THE FOLDED T IS THE ABSOLUTE VALUE OF THE
C              STUDENT'S T DISTRIBUTION.
C     INPUT  ARGUMENTS--N      = THE DESIRED INTEGER NUMBER
C                                OF RANDOM NUMBERS TO BE
C                                GENERATED.
C                     --NU     = THE INTEGER DEGREES OF FREEDOM
C                                (PARAMETER) FOR THE FOLDED T
C                                DISTRIBUTION.
C     OUTPUT ARGUMENTS--X      = A SINGLE PRECISION VECTOR
C                                (OF DIMENSION AT LEAST N)
C                                INTO WHICH THE GENERATED
C                                RANDOM SAMPLE WILL BE PLACED.
C     OUTPUT--A RANDOM SAMPLE OF SIZE N
C             FROM THE FOLDED T DISTRIBUTION
C             WITH DEGREES OF FREEDOM PARAMETER = NU.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--THERE IS NO RESTRICTION ON THE MAXIMUM VALUE
C                   OF N FOR THIS SUBROUTINE.
C                 --NU SHOULD BE A POSITIVE INTEGER VARIABLE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--UNIRAN.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--LOG, SQRT, SIN, COS.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--JOHNSON, KOTZ, AND BALAKRISHNAN, "CONTINUOUS
C                 UNIVARIATE DISTRIBUTIONS, VOLUME 2", 1994,
C                 JOHN WILEY, P. 403.
C                 ALGORITHM IS TO FIND T RANDOM NUMBERS AND THEN
C                 TAKE ABSOLUTE VALUE.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1966)
C     VERSION NUMBER--2003.11
C     ORIGINAL VERSION--NOVEMBER  2003.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C---------------------------------------------------------------------
C
      DIMENSION X(*)
      DIMENSION Y(2),Z(2)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----DATA STATEMENTS-------------------------------------------------
C
      DATA PI/3.14159265359/
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(N.LT.1)THEN
        WRITE(ICOUT,5)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,47)N
        CALL DPWRST('XXX','BUG ')
        GOTO9999
      ENDIF
      IF(NU.LE.0)THEN
        WRITE(ICOUT,15)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,47)NU
        CALL DPWRST('XXX','BUG ')
        GOTO9999
      ENDIF
    5 FORMAT('***** FATAL ERROR--FOR THE FOLDED T DISTRIBUTION, THE',
     1'REQUESTED NUMBER OF RANDOM NUMBERS WAS NON-POSITIVE.')
   15 FORMAT('***** FATAL ERROR--FOR THE FOLDED T DISTRIBUTION, THE',
     1'SPECIFIED SHAPE PARAMETER WAS NON-POSITIVE.')
   47 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',I8,' *****')
C
C     GENERATE N STUDENT'S T RANDOM NUMBERS
C     USING THE DEFINITION THAT
C     A STUDENT'S T VARIATE WITH NU DEGREES OF FREEDOM
C     EQUALS A NORMAL VARIATE DIVIDED BY
C     A STANDARDIZED CHI VARIATE
C     (WHERE THE LATTER EQUALS SQRT(CHI-SQUARED/NU).
C     FIRST GENERATE A NORMAL RANDOM NUMBER,
C     THEN GENERATE A STANDARDIZED CHI RANDOM NUMBER,
C     THEN FORM THE RATIO OF THE FIRST DIVIDED BY
C     THE SECOND.
C
C     FOR FOLDED T, TAKE THE ABSOLUTE VALUE.
C
      ANU=NU
      DO100I=1,N
C
      CALL UNIRAN(2,ISEED,Y)
      ARG1=-2.0*LOG(Y(1))
      ARG2=2.0*PI*Y(2)
      ZNORM=(SQRT(ARG1))*(COS(ARG2))
C
      SUM=0.0
      DO200J=1,NU,2
      CALL UNIRAN(2,ISEED,Y)
      ARG1=-2.0*LOG(Y(1))
      ARG2=2.0*PI*Y(2)
      Z(1)=(SQRT(ARG1))*(COS(ARG2))
      Z(2)=(SQRT(ARG1))*(SIN(ARG2))
      SUM=SUM+Z(1)*Z(1)
      IF(J.EQ.NU)GOTO200
      SUM=SUM+Z(2)*Z(2)
  200 CONTINUE
C
      X(I)=ABS(ZNORM/SQRT(SUM/ANU))
C
  100 CONTINUE
C
 9999 CONTINUE
      RETURN
      END
      SUBROUTINE FORSLV(NR,N,A,X,B)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C
C PURPOSE
C -------
C SOLVE  AX=B  WHERE A IS LOWER TRIANGULAR MATRIX
C
C PARAMETERS
C ----------
C NR           --> ROW DIMENSION OF MATRIX
C N            --> DIMENSION OF PROBLEM
C A(N,N)       --> LOWER TRIANGULAR MATRIX (PRESERVED)
C X(N)        <--  SOLUTION VECTOR
C B(N)         --> RIGHT-HAND SIDE VECTOR
C
C NOTE
C ----
C IF B IS NO LONGER REQUIRED BY CALLING ROUTINE,
C THEN VECTORS B AND X MAY SHARE THE SAME STORAGE.
C
      DIMENSION A(NR,*),X(*),B(*)
C
C SOLVE LX=B. (FOREWARD SOLVE)
C
      X(1)=B(1)/A(1,1)
      IF(N.EQ.1) RETURN
      DO 20 I=2,N
        SUM=0.0D0
        IM1=I-1
        DO 10 J=1,IM1
          SUM=SUM+A(I,J)*X(J)
   10   CONTINUE
        X(I)=(B(I)-SUM)/A(I,I)
   20 CONTINUE
      RETURN
      END
      SUBROUTINE FOUTRA(Y1,Y2,YC,SCRTCH,N1,ITCASE,IWRITE,Y12,IFTEXP,
     1                  IFTORD,Y3,Y4,N3,
     1                  IBUGA3,IERROR)
C
C     PURPOSE--CARRY OUT FOURIER TRANSFORM-TYPE OPERATIONS
C              OF THE COMPLEX DATA IN Y1 AND Y2.
C
C     OPERATIONS--FOURIER TRANSFORM
C                 INVERSE FOURIER TRANSFORM
C                 FFT
C                 INVERSE FFT
C
C     EXAMPLES--LET T1 T2 = FOURIER TRANSFORM Y1 Y2
C               LET Y1 Y2 = INVERSE FOURIER TRANSFORM T1 T2
C               LET T1 T2 = FFT Y1 Y2
C               LET Y1 Y2 = INVERSE FFT T1 T2
C     INPUT  ARGUMENTS--Y1 (REAL PART)       Y2 (IMAGINARY PART)
C     OUTPUT ARGUMENTS--Y3 (REAL PART)       Y4 (IMAGINARY PART)
C
C     NOTE--FOR THE FOURIER TRANSFORM AND THE FFT--
C              Y3(1) = A0 =
C              Y3(2) = A1
C              Y3(3) = A2
C              .
C              .
C              .
C              Y3(N) = A(N-1) =
C
C              Y4(1) = B0 =
C              Y4(2) = B1
C              Y4(3) = B2
C              .
C              .
C              .
C              Y4(N) = B(N-1) =
C
C     NOTE--IT IS NOT PERMISSIBLE TO HAVE THE OUTPUT VECTORS Y3(.) AND Y4(.)
C           BEING IDENTICAL TO THE INPUT VECTORS Y1(.) AND Y2(.).
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--87/5
C     ORIGINAL VERSION--APRIL    1987.
C     UPDATED--SEPTEMBER 1987   (FFT AND INVERSE FFT)
C     UPDATED--AUGUST    1995   REPLACE NUMERICAL RECIPES ROUTINE
C                               WITH CMLIB ROUTINE.  ALSO, GO FROM
C                               1 TO N RATHER THAN -N/2 TO N/2.
C     UPDATED--DECEMBER  2009   MAKE YC REAL RATHER THAN COMPLEX
C                               TO ACCOMODATE INTEL VERSION 11
C                               COMPILER
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 ITCASE
      CHARACTER*4 IWRITE
      CHARACTER*4 IFTEXP
CCCCC AUGUST 1995.  ADD FOLLOWING LINE
      CHARACTER*4 IFTORD
      CHARACTER*4 IBUGA3
      CHARACTER*4 IERROR
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
C
      CHARACTER*4 ITCAS2
C
C-----DOUBLE PRECISION STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      DOUBLE PRECISION DPI
      DOUBLE PRECISION DN1
      DOUBLE PRECISION DI
      DOUBLE PRECISION DK
      DOUBLE PRECISION DKM1
      DOUBLE PRECISION DOMEGA
      DOUBLE PRECISION DY1K
      DOUBLE PRECISION DY2K
C
      DOUBLE PRECISION DC
      DOUBLE PRECISION DS
      DOUBLE PRECISION DTCR
      DOUBLE PRECISION DTSR
      DOUBLE PRECISION DTCI
      DOUBLE PRECISION DTSI
      DOUBLE PRECISION DSUMCR
      DOUBLE PRECISION DSUMSR
      DOUBLE PRECISION DSUMCI
      DOUBLE PRECISION DSUMSI
CCCCC AUGUST 1995.  ADD FOLLOWING LINE
CCCCC COMPLEX YC
C
C---------------------------------------------------------------------
C
      DIMENSION Y1(*)
      DIMENSION Y2(*)
      DIMENSION Y3(*)
      DIMENSION Y4(*)
      DIMENSION Y12(*)
CCCCC AUGUST 1995.  ADD FOLLOWING 2 LINES.
      DIMENSION YC(*)
      DIMENSION SCRTCH(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='FOUT'
      ISUBN2='RA  '
      IERROR='NO'
C
      DN1=(-999.0D0)
      ITCAS2='-999'
      DPI=3.14159265358979D0
C
      IF(IBUGA3.EQ.'ON')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,51)
   51   FORMAT('***** AT THE BEGINNING OF FOUTRA--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,52)IBUGA3,ITCASE,IWRITE,IFTEXP
   52   FORMAT('IBUGA3,ITCASE,IWRITE,IFTEXP = ',3(A4,2X),A4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,54)N1
   54   FORMAT('N1 = ',I8)
        CALL DPWRST('XXX','BUG ')
        DO55I=1,N1
          WRITE(ICOUT,56)I,Y1(I),Y2(I),Y12(I)
   56     FORMAT('I,Y1(I),Y2(I),Y12(I) = ',I8,3G15.7)
          CALL DPWRST('XXX','BUG ')
   55   CONTINUE
      ENDIF
C
C               ***************************************************
C               **  CARRY OUT FOURIER TRANSFORM-TYPE OPERATIONS  **
C               ***************************************************
C
C               ********************************************
C               **  STEP 11--                             **
C               **  CHECK NUMBER OF INPUT OBSERVATIONS.   **
C               ********************************************
C
      IF(N1.LT.1)GOTO1100
      GOTO1190
C
 1100 CONTINUE
      IERROR='YES'
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1151)
 1151 FORMAT('***** ERROR IN FOUTRA--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1152)
 1152 FORMAT('      THE INPUT NUMBER OF OBSERVATIONS')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1153)
 1153 FORMAT('      IN THE VARIABLE FOR WHICH')
      CALL DPWRST('XXX','BUG ')
      IF(ITCASE.EQ.'FOUT'.OR.ITCASE.EQ.'FOU1')WRITE(ICOUT,1154)
 1154 FORMAT('      THE FOURIER TRANSFORM IS TO BE ',
     1'COMPUTED')
      IF(ITCASE.EQ.'FOUT'.OR.ITCASE.EQ.'FOU1')CALL DPWRST('XXX','BUG ')
      IF(ITCASE.EQ.'IFOU'.OR.ITCASE.EQ.'IFO1')WRITE(ICOUT,1155)
 1155 FORMAT('      THE INVERSE FOURIER TRANSFORM IS TO BE ',
     1'COMPUTED')
      IF(ITCASE.EQ.'IFOU'.OR.ITCASE.EQ.'IFO1')CALL DPWRST('XXX','BUG ')
      IF(ITCASE.EQ.'FFT'.OR.ITCASE.EQ.'FFT1')WRITE(ICOUT,1156)
 1156 FORMAT('      THE FFT IS TO BE ',
     1'COMPUTED')
      IF(ITCASE.EQ.'FFT'.OR.ITCASE.EQ.'FFT1')CALL DPWRST('XXX','BUG ')
      IF(ITCASE.EQ.'IFFT'.OR.ITCASE.EQ.'IFF1')WRITE(ICOUT,1157)
 1157 FORMAT('      THE INVERSE FFT IS TO BE ',
     1'COMPUTED')
      IF(ITCASE.EQ.'IFFT'.OR.ITCASE.EQ.'IFF1')CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1181)
 1181 FORMAT('      MUST BE 1 OR LARGER.')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1182)
 1182 FORMAT('      SUCH WAS NOT THE CASE HERE.')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1183)N1
 1183 FORMAT('      THE INPUT NUMBER OF OBSERVATIONS HERE = ',I8,
     1'.')
      CALL DPWRST('XXX','BUG ')
      GOTO9000
C
 1190 CONTINUE
C
C               *********************************
C               **  STEP 12--                  **
C               **  BRANCH TO THE PROPER CASE  **
C               *********************************
C
      IF(ITCASE.EQ.'FOUT')GOTO2100
      IF(ITCASE.EQ.'FOU1')GOTO2100
      IF(ITCASE.EQ.'IFOU')GOTO2100
      IF(ITCASE.EQ.'IFO1')GOTO2100
      IF(ITCASE.EQ.'FFT')GOTO2300
      IF(ITCASE.EQ.'FFT1')GOTO2300
      IF(ITCASE.EQ.'IFFT')GOTO2300
      IF(ITCASE.EQ.'IFF1')GOTO2300
C
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1211)
 1211 FORMAT('***** INTERNAL ERROR IN FOUTRA--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1212)
 1212 FORMAT('      ITCASE NOT EQUAL TO')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1213)
 1213 FORMAT('      FOUT, FOU1, IFOU, IFO1')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1214)
 1214 FORMAT('      FFT, FFT1, IFFT, OR IFF1')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1215)
 1215 FORMAT('      ITCASE = ',A4)
      CALL DPWRST('XXX','BUG ')
      IERROR='YES'
      GOTO9000
C
C               ************************************************
C               **  STEP 21--                                 **
C               **  TREAT THE FOURIER TRANSFORM         CASE  **
C               **  TREAT THE INVERSE FOURIER TRANSFORM CASE  **
C               **  BY OPERATING ON THE REAL AND              **
C               **  COMPLEX PARTS,                            **
C               **  BY TAKING                                 **
C               **     COSINE TRANSFORM OF REAL      PART     **
C               **     SINE   TRANSFORM OF REAL      PART     **
C               **     COSINE TRANSFORM OF IMAGINARY PART     **
C               **     SINE   TRANSFORM OF IMAGINARY PART,    **
C               **  AND BY COMBINING PROPERLY.                **
C               ************************************************
C
 2100 CONTINUE
C
      DN1=N1
CCCCC AUGUST 1995.  FOLLOWING DEFINITION FOR FOURIER EXPONENT
CCCCC "+" CASE.  FOURIER EXPONENT "-" CASE USES OPPOSSITE
CCCCC DEFINITIONS.
CCCCC IF(ITCASE.EQ.'FOUT')ITCAS2='FT'
CCCCC IF(ITCASE.EQ.'FOU1')ITCAS2='FT'
CCCCC IF(ITCASE.EQ.'IFOU')ITCAS2='IFT'
CCCCC IF(ITCASE.EQ.'IFO1')ITCAS2='IFT'
      IF(IFTEXP.EQ.'+')THEN
        IF(ITCASE.EQ.'FOUT')ITCAS2='FT'
        IF(ITCASE.EQ.'FOU1')ITCAS2='FT'
        IF(ITCASE.EQ.'IFOU')ITCAS2='IFT'
        IF(ITCASE.EQ.'IFO1')ITCAS2='IFT'
      ELSE
        IF(ITCASE.EQ.'FOUT')ITCAS2='IFT'
        IF(ITCASE.EQ.'FOU1')ITCAS2='IFT'
        IF(ITCASE.EQ.'IFOU')ITCAS2='FT'
        IF(ITCASE.EQ.'IFO1')ITCAS2='FT'
      ENDIF
C
      L=N1/2
      M=0
      DO2110IP1=1,N1
      I=IP1-1
      L=L+1
      IF(L.GT.N1)L=1
      M=M+1
      DI=I
      DOMEGA=2.0*DPI*(DI/DN1)
      DSUMCR=0.0
      DSUMSR=0.0
      DSUMCI=0.0
      DSUMSI=0.0
C
CCCCC AUGUST 1995.  FOR 'STANDARD' ORDERING.
      IF(IFTORD.EQ.'STAN')THEN
        M2=0
      ELSE
        IF(ITCAS2.EQ.'FT')M2=0
        IF(ITCAS2.EQ.'IFT')M2=N1/2
      ENDIF
CCCCC END CHANGE
      DO2120K=1,N1
      DK=K
      DKM1=DK-1.0D0
      M2=M2+1
      IF(M2.GT.N1)M2=1
      DY1K=Y1(M2)
      DY2K=Y2(M2)
CCCCC DSUMCR=DSUMCR+DY1K*DCOS(DOMEGA*DKM1)
CCCCC DSUMSR=DSUMSR+DY1K*DSIN(DOMEGA*DKM1)
CCCCC DSUMCI=DSUMCI+DY2K*DCOS(DOMEGA*DKM1)
CCCCC DSUMSI=DSUMSI+DY2K*DSIN(DOMEGA*DKM1)
      DC=DCOS(DOMEGA*DKM1)
      DS=DSIN(DOMEGA*DKM1)
      DTCR=DC*DY1K
      DTSR=DS*DY1K
      DTCI=DC*DY2K
      DTSI=DS*DY2K
      DSUMCR=DSUMCR+DTCR
      DSUMSR=DSUMSR+DTSR
      DSUMCI=DSUMCI+DTCI
      DSUMSI=DSUMSI+DTSI
      IF(IBUGA3.EQ.'OFF')GOTO779
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,774)I,K,M2,DY1K,DY2K
  774 FORMAT('I,K,M2,DY1K,DY2K = ',3I8,2E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,775)DKM1,DOMEGA,DC,DS
  775 FORMAT('DKM1,DOMEGA,DC,DS = ',4E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,776)DTCR,DTSR,DTCI,DTSI
  776 FORMAT('DTCR,DTSR,DTCI,DTSI = ',4E15.7)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,778)DSUMCR,DSUMSR,DSUMCI,DSUMSI
  778 FORMAT('DSUMCR,DSUMSR,DSUMCI,DSUMSI = ',4E15.7)
      CALL DPWRST('XXX','BUG ')
  779 CONTINUE
 2120 CONTINUE
C
C     THE FOLLOWING COMMENTED OUT CODE IS APPROPRIATE
C     IF THE FORWARD TRANSFORM IS DEFINED WITH A - IN THE EXPONENT
C     (AS IS THE USUAL CLASSIC DEFINITION)
C
CCCCC IF(ITCAS2.EQ.'FT')Y3(L)=DSUMCR+DSUMSI
CCCCC IF(ITCAS2.EQ.'FT')Y4(L)=DSUMCI-DSUMSR
CCCCC IF(ITCAS2.EQ.'IFT')Y3(M)=(DSUMCR-DSUMSI)/DN1
CCCCC IF(ITCAS2.EQ.'IFT')Y4(M)=(DSUMCI+DSUMSR)/DN1
C
C     THE FOLLOWING CODE IS APPROPRIATE
C     IF THE FORWARD TRANSFORM IS DEFINED WITH A + IN THE EXPONENT
C     (AS DEFINED BY PRESS ET AL (NUMERICAL RECIPES))
C
CCCCC AUGUST 1995.  FIX FOR STANDARD ORDERING
      IF(IFTORD.EQ.'STAN')THEN
        IF(ITCAS2.EQ.'FT')Y3(M)=DSUMCR-DSUMSI
        IF(ITCAS2.EQ.'FT')Y4(M)=DSUMCI+DSUMSR
        IF(ITCAS2.EQ.'IFT')Y3(M)=(DSUMCR+DSUMSI)/DN1
        IF(ITCAS2.EQ.'IFT')Y4(M)=(DSUMCI-DSUMSR)/DN1
      ELSE
        IF(ITCAS2.EQ.'FT')Y3(L)=DSUMCR-DSUMSI
        IF(ITCAS2.EQ.'FT')Y4(L)=DSUMCI+DSUMSR
        IF(ITCAS2.EQ.'IFT')Y3(M)=(DSUMCR+DSUMSI)/DN1
        IF(ITCAS2.EQ.'IFT')Y4(M)=(DSUMCI-DSUMSR)/DN1
      ENDIF
C
      IF(IBUGA3.EQ.'ON')WRITE(ICOUT,2121)I,IP1,L,M,DN1,DI
 2121 FORMAT('I,IP1,L,M,DN1,DI = ',4I8,2D15.7)
      IF(IBUGA3.EQ.'ON')CALL DPWRST('XXX','BUG ')
      IF(IBUGA3.EQ.'ON')WRITE(ICOUT,2122)DSUMCR,DSUMSR,DSUMCI,DSUMSI
 2122 FORMAT('DSUMCR,DSUMSR,DSUMCI,DSUMSI = ',4D15.7)
      IF(IBUGA3.EQ.'ON')CALL DPWRST('XXX','BUG ')
      IF(IBUGA3.EQ.'ON')WRITE(ICOUT,999)
      IF(IBUGA3.EQ.'ON')CALL DPWRST('XXX','BUG ')
C
 2110 CONTINUE
      N3=N1
      GOTO9000
C
C               ************************************************
C               **  STEP 23--                                 **
C               **  TREAT THE FFT                       CASE  **
C               **  TREAT THE INVERSE FFT               CASE  **
C               **  (NOTE--N1 IS ASSUMED TO BE A POWER OF 2)  **
C               ************************************************
C
 2300 CONTINUE
C
      AN1=N1
      NN2=2*N1
C
CCCCC AUGUST 1995.  SET ISIGN CORRECTLY
      IF(IFTEXP.EQ.'+')THEN
        ISIGN=1
        IF(ITCASE.EQ.'IFFT')ISIGN=(-1)
        IF(ITCASE.EQ.'IFF1')ISIGN=(-1)
      ELSE
        ISIGN=(-1)
        IF(ITCASE.EQ.'IFFT')ISIGN=1
        IF(ITCASE.EQ.'IFF1')ISIGN=1
      ENDIF
CCCCC IF(ITCASE.EQ.'FFT')GOTO2310
CCCCC IF(ITCASE.EQ.'FFT1')GOTO2310
CCCCC AUGUST 1995.  BE CONSISTENT IN SCALING!!!
CCCCC ADD FOLLOWING 2 LINES
CCCCC IF(ITCASE.EQ.'IFFT')GOTO2310
CCCCC IF(ITCASE.EQ.'IFF1')GOTO2310
CCCCC GOTO2319
C2310 CONTINUE
CCCCC J=(-1)
CCCCC DO2311I=1,N1
CCCCC J=J+2
CCCCC JP1=J+1
CCCCC Y12(J)=Y1(I)
CCCCC Y12(JP1)=Y2(I)
C2311 CONTINUE
C2319 CONTINUE
C
CCCCC AUGUST 1995.  BE CONSISTENT IN SCALING!!!
CCCCC COMMENT OUT FOLLOWING 2 LINES
CCCCC IF(ITCASE.EQ.'IFFT')GOTO2320
CCCCC IF(ITCASE.EQ.'IFF1')GOTO2320
CCCCC GOTO2329
C2320 CONTINUE
CCCCC J=N1-1
CCCCC DO2321I=1,N1
CCCCC J=J+2
CCCCC IF(J.GT.NN2)J=1
CCCCC JP1=J+1
CCCCC Y12(J)=Y1(I)
CCCCC Y12(JP1)=Y2(I)
C2321 CONTINUE
C2329 CONTINUE
C
CCCCC AUGUST 1995.  FOR CMLIB ROUTINE, STORE IN A COMPLEX ARRAY.
CCCCC NOTE THAT DATAPLOT ORDER IMPLIES (-N/2,N/2) RATHER THAN
CCCCC (1,N).
C
      IF(IFTORD.EQ.'STAN')THEN
        DO2360I=1,N1
          I1=2*(I-1)+1
          I2=I1+1
CCCCC     YC(I)=CMPLX(Y1(I),Y2(I))
          YC(I1)=Y1(I1)
          YC(I2)=Y2(I2)
 2360   CONTINUE
      ELSE
        IF(ISIGN.LT.0)THEN
          J=N1/2
          DO2363I=1,N1
            J=J+1
            IF(J.GT.N1)J=1
            I1=2*(I-1)+1
            I2=I1+1
CCCCC       YC(J)=CMPLX(Y1(I),Y2(I))
            YC(I1)=Y1(I1)
            YC(I2)=Y2(I2)
 2363     CONTINUE
        ELSE
          DO2368I=1,N1
            I1=2*(I-1)+1
            I2=I1+1
CCCCC       YC(I)=CMPLX(Y1(I),Y2(I))
            YC(I1)=Y1(I1)
            YC(I2)=Y2(I2)
 2368     CONTINUE
        ENDIF
      ENDIF
C
CCCCC AUGUST 1995.  DETERMINE VALUE OF ISIGN BEFORE CREATE INPUT FILE.
CCCCC ISIGN=1
CCCCC IF(ITCASE.EQ.'IFFT')ISIGN=(-1)
CCCCC IF(ITCASE.EQ.'IFF1')ISIGN=(-1)
CCCCC IF(IFTEXP.EQ.'+')ISIGN=(-ISIGN)
C
      IF(IBUGA3.EQ.'OFF')GOTO2333
      DO2331I=1,NN2
CCCCC WRITE(ICOUT,2332)I,NN2,Y12(I)
      I1=2*(I-1)+1
      I2=I1+1
      WRITE(ICOUT,2332)I,NN2,YC(I1),YC(I2)
 2332 FORMAT('I,NN2,YC(I) = ',2I8,2E15.7)
      CALL DPWRST('XXX','BUG ')
 2331 CONTINUE
 2333 CONTINUE
C
CCCCC CALL FOUR1(Y12,NN2,ISIGN)
CCCCC AUGUST 1995.  REPLACE NUMERICAL RECIPES ROUTINES WITH
CCCCC CMLIB ROUTINE.
CCCCC CALL FOUR1(Y12,N1,ISIGN)
      CALL CFFTI(N1,SCRTCH)
      IF(ISIGN.LT.0)THEN
        CALL CFFTF(N1,YC,SCRTCH)
      ELSE
        CALL CFFTB(N1,YC,SCRTCH)
      ENDIF
C
      IF(IBUGA3.EQ.'OFF')GOTO2337
      DO2335I=1,NN2
CCCCC WRITE(ICOUT,2336)I,NN2,Y12(I)
      I1=2*(I-1)+1
      I2=I1+1
      WRITE(ICOUT,2336)I,NN2,YC(I1),YC(I2)
 2336 FORMAT('I,NN2,YC(I) = ',2I8,2E15.7)
      CALL DPWRST('XXX','BUG ')
 2335 CONTINUE
 2337 CONTINUE
C
CCCCC AUGUST 1995.  BE CONSISTENT IN SCALING!!!
CCCCC COMMENT OUT FOLLOWING 2 LINES
CCCCC IF(ITCASE.EQ.'FFT')GOTO2340
CCCCC IF(ITCASE.EQ.'FFT1')GOTO2340
CCCCC GOTO2349
C2340 CONTINUE
CCCCC J=N1-1
CCCCC DO2341I=1,N1
CCCCC J=J+2
CCCCC IF(J.GT.NN2)J=1
CCCCC JP1=J+1
CCCCC Y3(I)=Y12(J)
CCCCC Y4(I)=Y12(JP1)
C2341 CONTINUE
C2349 CONTINUE
C
CCCCC AUGUST 1995.  BE CONSISTENT IN SCALING!!!
CCCCC ADD FOLLOWING 2 LINES
CCCCC IF(ITCASE.EQ.'FFT')GOTO2350
CCCCC IF(ITCASE.EQ.'FFT1')GOTO2350
CCCCC IF(ITCASE.EQ.'IFFT')GOTO2350
CCCCC IF(ITCASE.EQ.'IFF1')GOTO2350
CCCCC GOTO2359
C2350 CONTINUE
CCCCC J=(-1)
CCCCC AUGUST 1995.  RETURN THE DATA IN "STANDARD" ORDER OR IN
CCCCC "DATAPLOT" ORDER.  "STANDARD" ORDER IS WHAT IS RETURNED BY
CCCCC CFFTF AND CFFTB ROUTINES
      IF(IFTORD.EQ.'STAN')THEN
        DO2351I=1,N1
CCCCC     J=J+2
CCCCC     JP1=J+1
CCCCC     Y3(I)=Y12(J)/AN1
CCCCC     Y4(I)=Y12(JP1)/AN1
          I1=2*(I-1)+1
          I2=I1+1
CCCCC     Y3(I)=REAL(YC(I))
CCCCC     Y4(I)=AIMAG(YC(I))
          Y3(I)=YC(I1)
          Y4(I)=YC(I2)
 2351   CONTINUE
      ELSE
        IF(ISIGN.GT.0)THEN
          J=N1/2
          DO2356I=1,N1
            J=J+1
            IF(J.GT.N1)J=1
            I1=2*(J-1)+1
            I2=I1+1
CCCCCC      Y3(I)=REAL(YC(J))
CCCCCC      Y4(I)=AIMAG(YC(J))
            Y3(I)=YC(I1)
            Y4(I)=YC(I2)
 2356     CONTINUE
        ELSE
          DO2358I=1,N1
            I1=2*(I-1)+1
            I2=I1+1
CCCCC       Y3(I)=REAL(YC(I))
CCCCC       Y4(I)=AIMAG(YC(I))
            Y3(I)=YC(I1)
            Y4(I)=YC(I2)
 2358     CONTINUE
        ENDIF
      ENDIF
C2359 CONTINUE
C
C
CCCCC AUGUST 1995.  DIVIDE BY N IF ISIGN IS -1
      IF(ISIGN.LT.0.0)THEN
        DO2370I=1,N1
          Y3(I)=Y3(I)/AN1
          Y4(I)=Y4(I)/AN1
 2370   CONTINUE
      ENDIF
C
      N3=N1
      GOTO9000
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT.      **
C               *****************
C
 9000 CONTINUE
C
      IF(IBUGA3.EQ.'OFF')GOTO9090
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9011)
 9011 FORMAT('***** AT THE END       OF FOUTRA--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9012)IBUGA3,ITCASE,IWRITE,IERROR
 9012 FORMAT('IBUGA3,ITCASE,IWRITE,IERROR = ',A4,2X,A4,2X,A4,2X,A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9013)IFTEXP
 9013 FORMAT('IFTEXP = ',A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9014)N1,N3,NN2,ISIGN,ITCAS2
 9014 FORMAT('N1,N3,NN2,ISIGN,ITCAS2 = ',4I8,2X,A4)
      CALL DPWRST('XXX','BUG ')
      DO9015I=1,N1
      WRITE(ICOUT,9016)I,Y1(I),Y2(I),Y3(I),Y4(I)
 9016 FORMAT('I,Y1(I),Y2(I),Y3(I),Y4(I) = ',I8,4E15.7)
      CALL DPWRST('XXX','BUG ')
 9015 CONTINUE
      DO9025I=1,NN2
      WRITE(ICOUT,9026)I,NN2,YC(I)
 9026 FORMAT('I,NN2,YC(I) = ',2I8,2E15.7)
      CALL DPWRST('XXX','BUG ')
 9025 CONTINUE
 9090 CONTINUE
C
      RETURN
      END
      SUBROUTINE FPDF(X,NU1,NU2,PDF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE PROBABILITY DENSITY
C              FUNCTION VALUE FOR F DISTRIBUTION
C              WITH INTEGER DEGREES OF FREEDOM PARAMETER = NU1 AND NU2.
C              THIS DISTRIBUTION IS DEFINED FOR ALL NON-NEGATIVE X.
C              THE PROBABILITY DENSITY FUNCTION IS GIVEN
C              IN THE REFERENCES BELOW.
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE AT
C                                WHICH THE PROBABILITY DENSITY
C                                FUNCTION IS TO BE EVALUATED.
C                                X SHOULD BE NON-NEGATIVE.
C                     --NU1    = THE INTEGER NUMBER OF DEGREES
C                                OF FREEDOM.
C                                NU1 SHOULD BE POSITIVE.
C                     --NU2    = THE INTEGER NUMBER OF DEGREES
C                                OF FREEDOM.
C                                NU2 SHOULD BE POSITIVE.
C     OUTPUT ARGUMENTS--PDF    = THE SINGLE PRECISION PROBABILITY
C                                DENSITY FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION PROBABILITY DENSITY
C             FUNCTION VALUE PDF FOR THE STUDENT'S T DISTRIBUTION
C             WITH DEGREES OF FREEDOM PARAMETER = NU.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--NU1 AND NU2 SHOULD BE A POSITIVE INTEGER VARIABLE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--NONE.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--DSQRT, DATAN.
C     MODE OF INTERNAL OPERATIONS--DOUBLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY APPLIED MATHMATICS
C                 SERIES 55, 1964, PAGE 946, FORMULA 26.6.1.
C               --JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--2, 1970, PAGES XXX.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1966)
C     VERSION NUMBER--82/7
C     ORIGINAL VERSION--AUGUST    1977.
C     UPDATED         --NOVEMBER  1981.
C     UPDATED         --MAY       1982.
C     UPDATED         --JANUARY   2021. SET PRINT TYPE TO "ERRO" (USER
C                                       CAN SUPPRESS ERROR MESSAGE IF
C                                       "SET ERROR MESSAGE OFF" ENTERED.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C---------------------------------------------------------------------
C
      DOUBLE PRECISION DX
      DOUBLE PRECISION DNU1
      DOUBLE PRECISION DNU2
      DOUBLE PRECISION DNU1H
      DOUBLE PRECISION DNU2H
      DOUBLE PRECISION DNU12H
      DOUBLE PRECISION DGF1
      DOUBLE PRECISION DGF2
      DOUBLE PRECISION DGF12
      DOUBLE PRECISION DTERM
      DOUBLE PRECISION DTERM1
      DOUBLE PRECISION DTERM2
      DOUBLE PRECISION DTERM3
      DOUBLE PRECISION DTERM4
      DOUBLE PRECISION DTERM5
      DOUBLE PRECISION DCONST
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C               ********************************************
C               **  STEP 1--                              **
C               **  CHECK THE INPUT ARGUMENTS FOR ERRORS  **
C               ********************************************
C
      PDF=0.0
      IF(NU1.LE.0)THEN
        WRITE(ICOUT,115)
  115   FORMAT('***** ERROR--THE SECOND ARGUMENT TO FPDF IS ',
     1         'NON-POSITIVE.')
        CALL DPWRST('XXX','ERRO')
        WRITE(ICOUT,117)NU1
  117   FORMAT('***** THE VALUE OF THE ARGUMENT IS ',I8,'.')
        CALL DPWRST('XXX','ERRO')
        GOTO9000
      ELSEIF(NU2.LE.0)THEN
        WRITE(ICOUT,125)
  125   FORMAT('***** ERROR--THE SECOND ARGUMENT TO FPDF IS ',
     1         'NON-POSITIVE.')
        CALL DPWRST('XXX','ERRO')
        WRITE(ICOUT,117)NU2
        CALL DPWRST('XXX','ERRO')
        GOTO9000
      ENDIF
C
C               ****************************************************************
C               **  STEP 2--
C               **  COMPUTE THE CONSTANT = ((NU1**(NU1/2))*(NU2**(NU2/2))/(BETA(
C               ****************************************************************
C
      DX=X
      DNU1=NU1
      DNU2=NU2
      DNU1H=DNU1/2.0
      DNU2H=DNU2/2.0
C
      DTERM1=DNU1**DNU1H
      DTERM2=DNU2**DNU2H
      CALL DGAMMF(DNU1H,DGF1)
      CALL DGAMMF(DNU2H,DGF2)
      DNU12H=DNU1H+DNU2H
      CALL DGAMMF(DNU12H,DGF12)
      DTERM3=(DGF1*DGF2)/DGF12
      DCONST=(DTERM1*DTERM2)/DTERM3
C
C               ************************************
C               **  STEP 3--                      **
C               **  COMPUTE THE DENSITY FUNCTION  **
C               ************************************
C
      IF(DX.LE.0.0D0)PDF=0.0
      IF(DX.LE.0.0D0)GOTO9000
C
      DTERM4=DX**(DNU1H-1.0D0)
      DTERM5=(DNU2+DNU1*DX)**(-DNU1H-DNU2H)
      DTERM=DTERM4*DTERM5
      PDF=DCONST*DTERM
      GOTO9000
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE F2PDF(X,ANU1,ANU2,PDF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE PROBABILITY DENSITY
C              FUNCTION VALUE FOR THE F DISTRIBUTION WHERE FRACTIONAL
C              DEGREES OF FREEDOM ARE SUPPORTED.  IT IS BASED ON THE
C              RELATIONSHIP BETWEEN AN F DISTRIBUTION AND A BETA
C              DISTRIBUTION.
C
C                 IF X IS DISTRIBUTED AS F WITH V1 AND V2 DEGREES
C                 OF FREEDOM, THEN
C
C                      (V1*X/V2)/(1 + (V1*X/V2))
C
C                 IS DISTRIBUTED AS A BETA WITH PARAMETERS
C                 V1/2 AND V2/2.
C
C              THIS DISTRIBUTION IS DEFINED FOR ALL NON-NEGATIVE X.
C     INPUT  ARGUMENTS--X      = THE SINGLE PRECISION VALUE AT
C                                WHICH THE PROBABILITY DENSITY
C                                FUNCTION IS TO BE EVALUATED.
C                                X SHOULD BE NON-NEGATIVE.
C                     --ANU1   = THE REAL DEGREES OF FREEDOM
C                                FOR THE NUMERATOR OF THE F RATIO.
C                                ANU1 SHOULD BE POSITIVE.
C                     --ANU2   = THE REAL DEGREES OF FREEDOM
C                                FOR THE DENOMINATOR OF THE F RATIO.
C                                ANU2 SHOULD BE POSITIVE.
C     OUTPUT ARGUMENTS--PDF    = THE SINGLE PRECISION PROBABILITY
C                                DENSITY FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION PROBABILITY DENSITY FUNCTION
C             VALUE PDF FOR THE F DISTRIBUTION WITH DEGREES OF FREEDOM
C             PARAMETERS NU1 AND NU2.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--X SHOULD BE NON-NEGATIVE.
C                 --ANU1 SHOULD BE POSITIVE.
C                 --ANU2 SHOULD BE POSITIVE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--BETPDF.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--NONE
C     MODE OF INTERNAL OPERATIONS--DOUBLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--XX
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2023/06
C     ORIGINAL VERSION--JUNE      2023.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C---------------------------------------------------------------------
C
C-----COMMON----------------------------------------------------------
C
      EXTERNAL F2FUN
      COMMON/F2COMM/ZNU1,ZNU2
C
      INCLUDE 'DPCOP2.INC'
C
C-----DATA STATEMENTS-------------------------------------------------
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      PDF=0.0
      IF(ANU1.LE.0.0)THEN
        WRITE(ICOUT,15)
   15   FORMAT('***** ERROR--THE SECOND ARGUMENT TO F2PDF IS ',
     1         'NON-POSITIVE.')
        CALL DPWRST('XXX','ERRO')
        WRITE(ICOUT,4)ANU1
        CALL DPWRST('XXX','ERRO')
        GOTO9000
      ELSEIF(ANU2.LE.0.0)THEN
        WRITE(ICOUT,23)
   23   FORMAT('***** ERROR--THE THIRD ARGUMENT TO F2PDF IS ',
     1         'NON-POSITIVE.')
        CALL DPWRST('XXX','ERRO')
        WRITE(ICOUT,4)ANU2
        CALL DPWRST('XXX','ERRO')
        GOTO9000
      ELSEIF(X.LT.0.0)THEN
        WRITE(ICOUT,4)
    4   FORMAT('***** ERROR--THE FIRST ARGUMENT TO FPDF IS NEGATIVE.')
        CALL DPWRST('XXX','ERRO')
        WRITE(ICOUT,46)X
   46   FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7,'.')
        CALL DPWRST('XXX','ERRO')
        GOTO9000
      ENDIF
C
      IF(X.EQ.0)GOTO9000
C
C     CHECK FOR CASES WHERE FRACTIONAL DEGREES OF FREEDOM DON'T MATTER
C
      IDF11=INT(ANU1)
      IDF12=IDF11 + 1
      IDF21=INT(ANU1)
      IDF22=IDF21+1
      IF(IDF11.GE.1 .AND. IDF21.GE.1)THEN
        ICASE1=1
        ICASE2=1
        AVAL1=ANU1-REAL(IDF11)
        IF(ABS(AVAL1).LE.0.000001)ICASE1=0
        AVAL2=ANU2-REAL(IDF21)
        IF(ABS(AVAL2).LE.0.000001)ICASE2=0
        IF(ICASE1.EQ.1 .AND. ICASE2.EQ.1)THEN
C
C         CASE WHERE BOTH DEGREES OF FREEDOM ARE FRACTIONAL
C
          CALL FPDF(X,IDF11,IDF21,FPDF1)
          CALL FPDF(X,IDF12,IDF21,FPDF2)
          CALL FPDF(X,IDF11,IDF22,FPDF3)
          CALL FPDF(X,IDF12,IDF22,FPDF4)
          XLOW=MIN(FPDF1,FPDF2,FPDF3,FPDF4)
          XUPP=MAX(FPDF1,FPDF2,FPDF3,FPDF4)
          XDIFF=XUPP-XLOW
          IF(XDIFF.LE.0.000001)THEN
            PDF=(FPDF1+FPDF2+FPDF3+FPDF4)/4.0
            GOTO9000
          ENDIF
        ELSEIF(ICASE1.EQ.0 .AND. ICASE2.EQ.1)THEN
C
C         CASE WHERE ANU1 IS INTEGER AND ANU2 IS FRACTIONAL
C
          CALL FPDF(X,IDF11,IDF21,FPDF1)
          CALL FPDF(X,IDF11,IDF22,FPDF3)
          XLOW=MIN(FPDF1,FPDF3)
          XUPP=MAX(FPDF1,FPDF3)
          XDIFF=XUPP-XLOW
          IF(XDIFF.LE.0.000001)THEN
            PDF=(FPDF1+FPDF3)/2.0
            GOTO9000
          ENDIF
        ELSEIF(ICASE1.EQ.1 .AND. ICASE2.EQ.0)THEN
C
C         CASE WHERE ANU1 IS FRACTIONAL AND ANU2 IS INTEGER
C
          CALL FPDF(X,IDF11,IDF21,FPDF1)
          CALL FPDF(X,IDF12,IDF21,FPDF2)
          XLOW=MIN(FPDF1,FPDF2)
          XUPP=MAX(FPDF1,FPDF2)
          XDIFF=XUPP-XLOW
          IF(XDIFF.LE.0.000001)THEN
            PDF=(FPDF1+FPDF2)/2.0
            GOTO9000
          ENDIF
        ELSEIF(ICASE1.EQ.0 .AND. ICASE2.EQ.0)THEN
C
C         CASE WHERE BOTH DEGREES OF FREEDOM ARE ESSENTIALLY INTEGER
C
          CALL FPDF(X,IDF11,IDF21,PDF)
          GOTO9000
        ENDIF
      ENDIF
C
CCCCC TERM1=ANU1*X/ANU2
CCCCC X=TERM1/(1.0 + TERM1)
C
CCCCC ANU1=ANU1/2.0D0
CCCCC ANU2=ANU2/2.0D0
CCCCC CALL BETPDF(X,ANU1,ANU2,PDF)
C
C     COMPUTE PDF FUNCTION BY TAKING DERIVATIVE OF
C     CDF FUNCTION
C
      ZNU1=ANU1
      ZNU2=ANU2
      IORD=1
      EPS=0.0
      ACCUR=0.0
      XMIN=MAX(0.0,X-5.0)
      XMAX=MAX(X,X+5.0)
      CALL DIFF(IORD,X,XMIN,XMAX,F2FUN,EPS,ACCUR,XDER,ERROR,IFAIL)
C
      IF(IFAIL.EQ.0 .OR. IFAIL.EQ.1)THEN
        PDF=XDER
      ELSEIF(IFAIL.EQ.2)THEN
        WRITE(ICOUT,104)
  104   FORMAT('***** ERROR IN FPDF FOR FRACTIONAL DEGREES OF FREEDOM')
        CALL DPWRST('XXX','ERRO')
        WRITE(ICOUT,106)
  106   FORMAT('      THE INPUT DATA IS INCORRECT.')
        CALL DPWRST('XXX','ERRO')
      ELSEIF(IFAIL.EQ.3)THEN
        WRITE(ICOUT,104)
        CALL DPWRST('XXX','ERRO')
        WRITE(ICOUT,108)
  108   FORMAT('      UNABLE TO DETERMINE THE DERIVATIVE.')
        CALL DPWRST('XXX','ERRO')
      ENDIF
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE FPPF(P,NU1,NU2,PPF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE PERCENT POINT
C              FOR THE F DISTRIBUTION
C              WITH INTEGER DEGREES OF FREEDOM
C              PARAMETERS = NU1 AND NU2.
C              THIS DISTRIBUTION IS DEFINED FOR ALL NON-NEGATIVE X.
C              THE PROBABILITY DENSITY FUNCTION IS GIVEN
C              IN THE REFERENCES BELOW.
C     INPUT  ARGUMENTS--P      = THE SINGLE PRECISION VALUE
C                                (BETWEEN 0.0 AND 1.0)
C                                AT WHICH THE PERCENT POINT
C                                FUNCTION IS TO BE EVALUATED.
C                     --NU1    = THE INTEGER DEGREES OF FREEDOM
C                                FOR THE NUMERATOR OF THE F RATIO.
C                                NU1 SHOULD BE POSITIVE.
C                     --NU2    = THE INTEGER DEGREES OF FREEDOM
C                                FOR THE DENOMINATOR OF THE F RATIO.
C                                NU2 SHOULD BE POSITIVE.
C     OUTPUT ARGUMENTS--PPF    = THE SINGLE PRECISION PERCENT POINT
C                                FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION PERCENT POINT
C             FUNCTION VALUE PPF FOR THE F DISTRIBUTION
C             WITH DEGREES OF FREEDOM
C             PARAMETERS = NU1 AND NU2.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--P SHOULD BE BETWEEN
C                   0.0 (INCLUSIVELY) AND 1.0 (EXCLUSIVELY).
C                 --NU1 SHOULD BE A POSITIVE INTEGER VARIABLE.
C                 --NU2 SHOULD BE A POSITIVE INTEGER VARIABLE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--FCDF, NORCDF, CHSCDF.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--DSQRT, DATAN.
C     MODE OF INTERNAL OPERATIONS--DOUBLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY APPLIED MATHEMATICS
C                 SERIES 55, 1964, PAGES 946-947,
C                 FORMULAE 26.6.4, 26.6.5, 26.6.8, AND 26.6.15.
C               --JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--2, 1970, PAGE 83, FORMULA 20,
C                 AND PAGE 84, THIRD FORMULA.
C               --PAULSON, AN APPROXIMATE NORMAILIZATION
C                 OF THE ANALYSIS OF VARIANCE DISTRIBUTION,
C                 ANNALS OF MATHEMATICAL STATISTICS, 1942,
C                 NUMBER 13, PAGES 233-135.
C               --SCHEFFE AND TUKEY, A FORMULA FOR SAMPLE SIZES
C                 FOR POPULATION TOLERANCE LIMITS, 1944,
C                 NUMBER 15, PAGE 217.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1966)
C               EXCEPTION--HOLLERITH STRINGS IN FORMAT STATEMENTS
C                          DENOTED BY QUOTES RATHER THAN NH.
C     VERSION NUMBER--82/7
C     ORIGINAL VERSION--MAY       1978.
C     UPDATED         --AUGUST    1979.
C     UPDATED         --DECEMBER  1981.
C     UPDATED         --MAY       1982.
C     UPDATED         --JANUARY   2021. SET PRINT TYPE TO "ERRO" (USER
C                                       CAN SUPPRESS ERROR MESSAGE IF
C                                       "SET ERROR MESSAGE OFF" ENTERED.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      PPF=0.0
      IF(NU1.LE.0)THEN
        WRITE(ICOUT,15)
   15   FORMAT('***** ERROR--THE SECOND ARGUMENT TO FPPF IS ',
     1         'NON-POSITIVE.')
        CALL DPWRST('XXX','ERRO')
        WRITE(ICOUT,47)NU1
        CALL DPWRST('XXX','ERRO')
        GOTO9000
      ELSEIF(NU2.LE.0)THEN
        WRITE(ICOUT,23)
   23   FORMAT('***** ERROR--THE THIRD ARGUMENT TO FPPF IS ',
     1         'NON-POSITIVE.')
        CALL DPWRST('XXX','ERRO')
        WRITE(ICOUT,47)NU2
        CALL DPWRST('XXX','ERRO')
        GOTO9000
      ELSEIF(P.LT.0.0.OR.P.GE.1.0)THEN
        WRITE(ICOUT,4)
    4   FORMAT('***** ERROR--THE FIRST ARGUMENT TO FPPF IS ',
     1         'OUTSIDE THE ALLOWABLE (0,1) INTERVAL.')
        CALL DPWRST('XXX','ERRO')
        WRITE(ICOUT,46)P
        CALL DPWRST('XXX','ERRO')
        GOTO9000
      ENDIF
   46 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7,'.')
   47 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',I8,'.')
C
C-----START POINT-----------------------------------------------------
C
      IF(P.EQ.0.0)THEN
        PPF=0.0
        GOTO9000
      ENDIF
C
C     2023/06: DECREASE THE TOLERANCE AND INCREASE MAX ITERATIONS
C
      IBUG=0
CCCCC TOL=0.000001
      TOL=0.00000001
      MAXIT=500
      XMIN=0.0
      XMAX=10.0**30
      XLOW=XMIN
      XUP=XMAX
C
      ANU1=NU1
      ANU2=NU2
C
      EXPF=0.5*((1.0/ANU2)-(1.0/ANU1))
      SDF=SQRT(0.5*((1.0/ANU2)+(1.0/ANU1)))
      CALL NORPPF(P,ZN)
      XN=EXPF+ZN*SDF
      XMID=EXP(2.0*XN)
      IF(IBUG.EQ.1)THEN
        WRITE(ICOUT,101)XMID
  101   FORMAT('XMID = ',G15.7)
        CALL DPWRST('XXX','BUG ')
      ENDIF
C
      ICOUNT=0
C
  200 CONTINUE
      X=XMID
      CALL FCDF(X,NU1,NU2,PCALC)
      IF(PCALC.EQ.P)GOTO240
      IF(PCALC.GT.P)GOTO220
C
  210 CONTINUE
      XLOW=XMID
      X=XMID*2.0
      IF(X.GE.XUP)GOTO211
      XMID=X
      IF(IBUG.EQ.1)THEN
        WRITE(ICOUT,101)XMID
        CALL DPWRST('XXX','BUG ')
      ENDIF
      CALL FCDF(X,NU1,NU2,PCALC)
      IF(PCALC.EQ.P)GOTO240
      IF(PCALC.LT.P)GOTO210
      XUP=X
  211 CONTINUE
      XMID=(XLOW+XUP)/2.0
      IF(IBUG.EQ.1)THEN
        WRITE(ICOUT,101)XMID
        CALL DPWRST('XXX','BUG ')
      ENDIF
      GOTO230
C
  220 CONTINUE
      XUP=XMID
      X=XMID/2.0
      IF(X.LE.XLOW)GOTO221
      XMID=X
      IF(IBUG.EQ.1)THEN
        WRITE(ICOUT,101)XMID
        CALL DPWRST('XXX','BUG ')
      ENDIF
      CALL FCDF(X,NU1,NU2,PCALC)
      IF(PCALC.EQ.P)GOTO240
      IF(PCALC.GT.P)GOTO220
      XLOW=X
  221 CONTINUE
      XMID=(XLOW+XUP)/2.0
      IF(IBUG.EQ.1)WRITE(ICOUT,101)XMID
      IF(IBUG.EQ.1)CALL DPWRST('XXX','BUG ')
      GOTO230
C
  230 CONTINUE
      XDEL=ABS(XMID-XLOW)
      ICOUNT=ICOUNT+1
      IF(XDEL.LT.TOL.OR.ICOUNT.GT.MAXIT)GOTO240
      GOTO200
C
  240 CONTINUE
      PPF=XMID
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE F2PPF(P,ANU1,ANU2,PPF)
C
C     PURPOSE--THIS SUBROUTINE COMPUTES THE PERCENT POINT FUNCTION FOR
C              THE F DISTRIBUTION FOR FRACTIONAL DEGREES OF FREEDOM
C              PARAMETERS = ANU1 AND ANU2.
C              THIS DISTRIBUTION IS DEFINED FOR ALL NON-NEGATIVE X.
C     INPUT  ARGUMENTS--P      = THE SINGLE PRECISION VALUE
C                                (BETWEEN 0.0 AND 1.0)
C                                AT WHICH THE PERCENT POINT
C                                FUNCTION IS TO BE EVALUATED.
C                     --ANU1   = THE REAL DEGREES OF FREEDOM (POSITIVE)
C                                FOR THE NUMERATOR OF THE F RATIO.
C                     --ANU2   = THE REAL DEGREES OF FREEDOM (POSITIVE)
C                                FOR THE DENOMINATOR OF THE F RATIO.
C     OUTPUT ARGUMENTS--PPF    = THE SINGLE PRECISION PERCENT POINT
C                                FUNCTION VALUE.
C     OUTPUT--THE SINGLE PRECISION PERCENT POINT FUNCTION VALUE PPF FOR
C             THE F DISTRIBUTION WITH DEGREES OF FREEDOM PARAMETERS =
C             ANU1 AND ANU2.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--P SHOULD BE BETWEEN
C                   0.0 (INCLUSIVELY) AND 1.0 (EXCLUSIVELY).
C                 --ANU1 SHOULD BE >= 1.
C                 --ANU2 SHOULD BE >= 1.
C     OTHER DATAPAC   SUBROUTINES NEEDED--F2CDF.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--NONE.
C     MODE OF INTERNAL OPERATIONS--DOUBLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--xx
C     WRITTEN BY--ALAN HECKERT
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2899
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--2023/06
C     ORIGINAL VERSION--JUNE      2023.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      PPF=0.0
      IF(ANU1.LT.1.0)THEN
        WRITE(ICOUT,15)
   15   FORMAT('***** ERROR--THE SECOND ARGUMENT TO FPPF IS ',
     1         'NON-POSITIVE.')
        CALL DPWRST('XXX','ERRO')
        WRITE(ICOUT,46)ANU1
        CALL DPWRST('XXX','ERRO')
        GOTO9000
      ELSEIF(ANU2.LT.1.0)THEN
        WRITE(ICOUT,23)
   23   FORMAT('***** ERROR--THE THIRD ARGUMENT TO FPPF IS ',
     1         'NON-POSITIVE.')
        CALL DPWRST('XXX','ERRO')
        WRITE(ICOUT,46)ANU2
        CALL DPWRST('XXX','ERRO')
        GOTO9000
      ELSEIF(P.LT.0.0.OR.P.GE.1.0)THEN
        WRITE(ICOUT,4)
    4   FORMAT('***** ERROR--THE FIRST ARGUMENT TO FPPF IS ',
     1         'OUTSIDE THE ALLOWABLE (0,1) INTERVAL.')
        CALL DPWRST('XXX','ERRO')
        WRITE(ICOUT,46)P
        CALL DPWRST('XXX','ERRO')
        GOTO9000
      ENDIF
   46 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',G15.7,'.')
C
C-----START POINT-----------------------------------------------------
C
      IF(P.EQ.0.0)THEN
        PPF=0.0
        GOTO9000
      ENDIF
C
      TOL=0.0000001
      MAXIT=500
C
C     FIND BOUNDING INTERVAL BY COMPUTING THE INTEGER DEGREES OF
C     FREEDOM FPPF FUNCTION FOR THE NEIGHBORHOOD OF THE FRACTIONAL
C     DEGREES OF FREEDOM.  FRACTIONAL DEGREES OF FREEDOM LESS THAN
C     1 NEED TO BE HANDLED SEPARATELY.
C
      IDF11=INT(ANU1)
      IDF12=IDF11 + 1
      IDF21=INT(ANU1)
      IDF22=IDF21+1
      CALL FPPF(P,IDF11,IDF21,FPPF1)
      CALL FPPF(P,IDF12,IDF21,FPPF2)
      CALL FPPF(P,IDF11,IDF22,FPPF3)
      CALL FPPF(P,IDF12,IDF22,FPPF4)
      XMIN=MIN(FPPF1,FPPF2,FPPF3,FPPF4)
      XMAX=MAX(FPPF1,FPPF2,FPPF3,FPPF4)
      XLOW=XMIN
      XUP=XMAX
      XMID=(XMIN+XMAX)/2.0
C
C     NOW USE BISECTION METHOD
      ICOUNT=0
C
  200 CONTINUE
      X=XMID
      CALL F2CDF(X,ANU1,ANU2,PCALC)
      IF(PCALC.EQ.P)GOTO240
      IF(PCALC.GT.P)GOTO220
C
  210 CONTINUE
      XLOW=XMID
      X=XMID*2.0
      IF(X.GE.XUP)GOTO211
      XMID=X
      CALL F2CDF(X,ANU1,ANU2,PCALC)
      IF(PCALC.EQ.P)GOTO240
      IF(PCALC.LT.P)GOTO210
      XUP=X
  211 CONTINUE
      XMID=(XLOW+XUP)/2.0
      GOTO230
C
  220 CONTINUE
      XUP=XMID
      X=XMID/2.0
      IF(X.LE.XLOW)GOTO221
      XMID=X
      CALL F2CDF(X,ANU1,ANU2,PCALC)
      IF(PCALC.EQ.P)GOTO240
      IF(PCALC.GT.P)GOTO220
      XLOW=X
  221 CONTINUE
      XMID=(XLOW+XUP)/2.0
      GOTO230
C
  230 CONTINUE
      XDEL=ABS(XMID-XLOW)
      ICOUNT=ICOUNT+1
      IF(XDEL.LT.TOL.OR.ICOUNT.GT.MAXIT)GOTO240
      GOTO200
C
  240 CONTINUE
      PPF=XMID
C
 9000 CONTINUE
      RETURN
      END
      DOUBLE PRECISION FUNCTION fpser(a,b,x,eps)
C-----------------------------------------------------------------------
C
C                 EVALUATION OF I (A,B)
C                                X
C
C          FOR B .LT. MIN(EPS,EPS*A) AND X .LE. 0.5.
C
C-----------------------------------------------------------------------
C
C                  SET  FPSER = X**A
C
C     .. Scalar Arguments ..
      DOUBLE PRECISION a,b,eps,x
C     ..
C     .. Local Scalars ..
      DOUBLE PRECISION an,c,s,t,tol
C     ..
C     .. External Functions ..
      DOUBLE PRECISION exparg
      EXTERNAL exparg
C     ..
C     .. Intrinsic Functions ..
      INTRINSIC abs,dlog,exp
C     ..
C     .. Executable Statements ..

      fpser = 1.0D0
      IF (a.LE.1.D-3*eps) GO TO 10
      fpser = 0.0D0
      t = a*dlog(x)
      IF (t.LT.exparg(1)) RETURN
      fpser = exp(t)
C
C                NOTE THAT 1/B(A,B) = B
C
   10 fpser = (b/a)*fpser
      tol = eps/a
      an = a + 1.0D0
      t = x
      s = t/an
   20 an = an + 1.0D0
      t = x*t
      c = t/an
      s = s + c
      IF (abs(c).GT.tol) GO TO 20
C
      fpser = fpser* (1.0D0+a*s)
      RETURN

      END
      SUBROUTINE FRACTA(X1,Y1,N1,IWRITE,
     1X2,Y2,N2,IBUGA3,IERROR)
C
C     PURPOSE--CARRY OUT FRACTAL GENERATION
C              OF THE DATA IN X1 AND Y1.
C
C     EXAMPLES--LET X1 Y1 = FRACTAL X2 Y2
C     INPUT  ARGUMENTS--X1 (X COOR)       Y1 (Y COOR)
C     OUTPUT ARGUMENTS--X2 (X COOR)       Y2 (Y COOR)
C
C     NOTE--FOR STEP 1 OF THE LOOP
C           (2 POINTS IN AND 5 POINTS OUT)
C           (1 LINE IN AND 4 LINES OUT)--
C
C            X2(1) = X1(1)
C            X2(2) = X1(1) + (1/3)DELX
C            X2(3) = X1(1) + (1/2)DELX - (SQRT(3)/6)DELY
C            X2(4) = X1(1) + (2/3)DELX
C            X2(5) = X1(2)
C
C            Y2(1) = Y1(1)
C            Y2(2) = Y1(1) + (1/3)DELY
C            Y2(3) = Y1(1) + (1/2)DELY + (SQRT(3)/6)DELX
C            Y2(4) = Y1(1) + (2/3)DELY
C            Y2(5) = Y1(2)
C
C     NOTE--IT IS NOT PERMISSIBLE TO HAVE THE OUTPUT VECTORS X2(.) AND Y2(.)
C           BEING IDENTICAL TO THE INPUT VECTORS X1(.) AND Y1(.).
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCE--RUCKER. INFINITY AND THE MIND, PAGE 9.
C     VERSION NUMBER--88/10
C     ORIGINAL VERSION--JULY     1988.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 IWRITE
      CHARACTER*4 IBUGA3
      CHARACTER*4 IERROR
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
C
C---------------------------------------------------------------------
C
      DIMENSION X1(*)
      DIMENSION Y1(*)
      DIMENSION X2(*)
      DIMENSION Y2(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='FRAC'
      ISUBN2='TA  '
      IERROR='NO'
C
      IF(IBUGA3.EQ.'OFF')GOTO90
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,51)
   51   FORMAT('***** AT THE BEGINNING OF FRACTA--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,52)IBUGA3,IWRITE
   52   FORMAT('IBUGA3,IWRITE = ',A4,2X,A4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,54)N1
   54   FORMAT('N1 = ',I8)
        CALL DPWRST('XXX','BUG ')
        DO55I=1,N1
        WRITE(ICOUT,56)I,X1(I),Y1(I)
   56   FORMAT('I,X1(I),Y1(I) = ',I8,2E15.7)
        CALL DPWRST('XXX','BUG ')
   55   CONTINUE
   90 CONTINUE
C
C                 *******************************************************
C                 **  CARRY OUT FOURIER FRACTAL-GENERATION OPERATIONS  **
C                 *******************************************************
C
C                 ********************************************
C                 **  STEP 11--                             **
C                 **  CHECK NUMBER OF INPUT OBSERVATIONS.   **
C                 ********************************************
C
        IF(N1.LT.2)GOTO1100
        GOTO1190
C
 1100 CONTINUE
      IERROR='YES'
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1151)
 1151 FORMAT('***** ERROR IN FRACTA--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1152)
 1152 FORMAT('        THE INPUT NUMBER OF OBSERVATIONS')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1153)
 1153 FORMAT('        IN THE VARIABLES FROM WHICH')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1154)
 1154 FORMAT('        THE AUGMENTED FRACTAL VARIABLE IS TO BE ')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1181)
 1181 FORMAT('        CREATED, MUST BE 2 OR LARGER.')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1182)
 1182 FORMAT('        SUCH WAS NOT THE CASE HERE.')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,1183)N1
 1183 FORMAT('        THE INPUT NUMBER OF OBSERVATIONS HERE = ',I8,
     1'.')
      CALL DPWRST('XXX','BUG ')
      GOTO9000
C
 1190 CONTINUE
C
C                 ************************************************
C                 **  STEP 21--                                 **
C                 **  COMPUTE THE FRACTAL SET OF POINTS         **
C                 ************************************************
C
C2100 CONTINUE
C
      C=SQRT(3.0)/6.0
      N1M1=N1-1
      L=0
      DO2110I=1,N1M1
      IP1=I+1
      A1=X1(I)
      B1=Y1(I)
      A5=X1(IP1)
      B5=Y1(IP1)
      DELX=A5-A1
      DELY=B5-B1
      A2=A1+DELX/3
      A3=A1+DELX/2-C*DELY
      A4=A1+2*DELX/3
      B2=B1+DELY/3
      B3=B1+DELY/2+C*DELX
      B4=B1+2*DELY/3
      L=L+1
      X2(L)=A1
      Y2(L)=B1
      L=L+1
      X2(L)=A2
      Y2(L)=B2
      L=L+1
      X2(L)=A3
      Y2(L)=B3
      L=L+1
      X2(L)=A4
      Y2(L)=B4
      L=L+1
      X2(L)=A5
      Y2(L)=B5
 2110 CONTINUE
      N2=L
C
C                 *****************
C                 **  STEP 90--  **
C                 **  EXIT.      **
C                 *****************
C
 9000 CONTINUE
C
      IF(IBUGA3.EQ.'OFF')GOTO9090
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9011)
 9011 FORMAT('***** AT THE END         OF FRACTA--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9012)IBUGA3,IWRITE,IERROR
 9012 FORMAT('IBUGA3,IWRITE,IERROR = ',A4,2X,A4,2X,A4)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9014)N1,N2
 9014 FORMAT('N1,N2 = ',2I8)
      CALL DPWRST('XXX','BUG ')
      DO9015I=1,N1
      WRITE(ICOUT,9016)I,X1(I),Y1(I)
 9016 FORMAT('I,X1(I),Y1(I) = ',I8,2E15.7)
      CALL DPWRST('XXX','BUG ')
 9015 CONTINUE
      DO9017I=1,N2
      WRITE(ICOUT,9018)I,X2(I),Y2(I)
 9018 FORMAT('I,X2(I),Y2(I) = ',I8,2E15.7)
      CALL DPWRST('XXX','BUG ')
 9017 CONTINUE
 9090 CONTINUE
C
      RETURN
      END
      SUBROUTINE FRAN(N,ANU1,ANU2,ISEED,X)
C
C     PURPOSE--THIS SUBROUTINE GENERATES A RANDOM SAMPLE OF SIZE N
C              FROM THE F DISTRIBUTION
C              WITH INTEGER DEGREES OF FREEDOM
C              PARAMETERS = NU1 AND NU2.
C              THIS DISTRIBUTION IS DEFINED FOR ALL NON-NEGATIVE X.
C              THE PROBABILITY DENSITY FUNCTION IS GIVEN
C              IN THE REFERENCES BELOW.
C     INPUT  ARGUMENTS--N      = THE DESIRED INTEGER NUMBER
C                                OF RANDOM NUMBERS TO BE
C                                GENERATED.
C                     --NU1    = THE INTEGER DEGREES OF FREEDOM
C                                FOR THE NUMERATOR OF THE F RATIO.
C                     --NU2    = THE INTEGER DEGREES OF FREEDOM
C                                FOR THE DENOMINATOR OF THE F RATIO.
C     OUTPUT ARGUMENTS--X      = A SINGLE PRECISION VECTOR
C                                (OF DIMENSION AT LEAST N)
C                                INTO WHICH THE GENERATED
C                                RANDOM SAMPLE WILL BE PLACED.
C     OUTPUT--A RANDOM SAMPLE OF SIZE N
C             FROM THE F DISTRIBUTION
C             WITH DEGREES OF FREEDOM
C             PARAMETERS = NU1 AND NU2.
C     PRINTING--NONE UNLESS AN INPUT ARGUMENT ERROR CONDITION EXISTS.
C     RESTRICTIONS--THERE IS NO RESTRICTION ON THE MAXIMUM VALUE
C                   OF N FOR THIS SUBROUTINE.
C                 --NU1 SHOULD BE A POSITIVE INTEGER VARIABLE.
C                 --NU2 SHOULD BE A POSITIVE INTEGER VARIABLE.
C     OTHER DATAPAC   SUBROUTINES NEEDED--UNIRAN.
C     FORTRAN LIBRARY SUBROUTINES NEEDED--LOG, SQRT, SIN, COS.
C     MODE OF INTERNAL OPERATIONS--SINGLE PRECISION.
C     LANGUAGE--ANSI FORTRAN (1977)
C     REFERENCES--MOOD AND GRABLE, INTRODUCTION TO THE
C                 THEORY OF STATISTICS, 1963, PAGES 231-232.
C               --JOHNSON AND KOTZ, CONTINUOUS UNIVARIATE
C                 DISTRIBUTIONS--2, 1970, PAGES 75-93.
C               --HASTINGS AND PEACOCK, STATISTICAL
C                 DISTRIBUTIONS--A HANDBOOK FOR
C                 STUDENTS AND PRACTITIONERS, 1975,
C                 PAGE 64.
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1966)
C     VERSION NUMBER--82/7
C     ORIGINAL VERSION--NOVEMBER  1975.
C     UPDATED         --DECEMBER  1981.
C     UPDATED         --MAY       1982.
C     UPDATED         --MAY       2004. SUPPORT REAL VALUES FOR
C                                       DEGREES OF FREEDOM PARAMETERS
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
C---------------------------------------------------------------------
C
      CHARACTER*4 ICASE
C
      DIMENSION X(*)
      DIMENSION Y(2),Z(2)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----DATA STATEMENTS-------------------------------------------------
C
      DATA PI/3.14159265359/
      DATA EPS/0.00001/
C
C-----START POINT-----------------------------------------------------
C
C     CHECK THE INPUT ARGUMENTS FOR ERRORS
C
      IF(N.LT.1)THEN
        WRITE(ICOUT,5)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,47)N
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(ANU1.LE.0.0)THEN
        WRITE(ICOUT,15)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,47)NU1
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ELSEIF(ANU2.LE.0.0)THEN
        WRITE(ICOUT,25)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,47)NU2
        CALL DPWRST('XXX','BUG ')
        GOTO9000
      ENDIF
    5 FORMAT('***** ERROR--THE FIRST ARGUMENT TO FRAN ',
     1       'IS NON-POSITIVE.')
   15 FORMAT('***** ERROR--THE SECOND ARGUMENT TO FRAN ',
     1       'IS NON-POSITIVE.')
   25 FORMAT('***** ERROR--THE THIRD ARGUMENT TO FRAN ',
     1        'IS NON-POSITIVE.')
   47 FORMAT('***** THE VALUE OF THE ARGUMENT IS ',I8,'.')
C
      NU1=INT(ANU1+0.1)
      ANU12=REAL(NU1)
      NU2=INT(ANU2+0.1)
      ANU22=REAL(NU2)
      IF(ABS(ANU1-ANU12).LE.EPS .AND. ABS(ANU2-ANU22).LE.EPS)THEN
        ICASE='INTE'
        IF(NU1.EQ.0 .OR. NU2.EQ.0)THEN
          ICASE='REAL'
        ENDIF
      ELSE
        ICASE='REAL'
      ENDIF
C
C     CASE 1: INTEGER DEGREES OF FREEDOM
C
      IF(ICASE.EQ.'INTE')THEN
C       GENERATE N F RANDOM NUMBERS
C       USING THE DEFINITION THAT
C       A F VARIATE WITH NU1 AND NU2 DEGREES OF FREEDOM
C       EQUALS (CHS1/NU1)/(CHS2/NU2)
C       WHERE CHS1 IS A CHI-SQUARED VARIATE
C       WITH NU1 DEGREES OF FREEDOM,
C       AND   CHS2 IS A CHI-SQUARED VARIATE
C       WITH NU2 DEGREES OF FREEDOM.
C       FIRST GENERATE UNIFORM (0,1) RANDOM NUMBERS,
C       THEN GENERATE NORMAL RANDOM NUMBERS,
C       THEN CHI-SQUARED RANDOM NUMBERS WITH NU1 DEGREES
C       OF FREEDOM,
C       THEN CHI-SQUARED RANDOM NUMBERS WITH NU2 DEGREES
C       OF FREEDOM,
C       AND THEN FINALLY THE F RANDOM NUMBER.
C
        ANU1=NU1
        ANU2=NU2
        DO100I=1,N
C
          SUM=0.0
          DO200J=1,NU1,2
            CALL UNIRAN(2,ISEED,Y)
            ARG1=-2.0*LOG(Y(1))
            ARG2=2.0*PI*Y(2)
            Z(1)=(SQRT(ARG1))*(COS(ARG2))
            Z(2)=(SQRT(ARG1))*(SIN(ARG2))
            SUM=SUM+Z(1)*Z(1)
            IF(J.EQ.NU1)GOTO200
            SUM=SUM+Z(2)*Z(2)
  200     CONTINUE
          CHS1=SUM
C
          SUM=0.0
          DO300J=1,NU2,2
            CALL UNIRAN(2,ISEED,Y)
            ARG1=-2.0*LOG(Y(1))
            ARG2=2.0*PI*Y(2)
            Z(1)=(SQRT(ARG1))*(COS(ARG2))
            Z(2)=(SQRT(ARG1))*(SIN(ARG2))
            SUM=SUM+Z(1)*Z(1)
            IF(J.EQ.NU2)GOTO300
            SUM=SUM+Z(2)*Z(2)
  300     CONTINUE
          CHS2=SUM
C
          X(I)=(CHS1/ANU1)/(CHS2/ANU2)
C
  100   CONTINUE
C
      ELSE
        P=ANU1/2.0
        Q=ANU2/2.0
        CALL BETRAN(N,P,Q,ISEED,X)
        DO500I=1,N
          ATEMP=X(I)
          X(I)=ANU2*ATEMP/(ANU1*(1.0-ATEMP))
  500   CONTINUE
      ENDIF
C
 9000 CONTINUE
      RETURN
      END
      SUBROUTINE FREQUE(X,NX,D,ND,NUMVAR,IWRITE,
     1                  Y,NY,IBUGA3,IERROR)
C
C     PURPOSE--COMPUTE FREQUENCIES FOR SPECIFIED VALUES OF A VARIABLE
C              (OR IF NO VALUES SPECIFIED, COMPUTE FREQUENCIES
C              FOR DISTINCT VALUES OF A VARIABLE).
C     NOTE--IT IS PERMISSIBLE TO HAVE THE OUTPUT VECTOR Y(.)
C           BEING IDENTICAL TO THE INPUT VECTOR X(.).
C     WRITTEN BY--JAMES J. FILLIBEN
C                 STATISTICAL ENGINEERING DIVISION
C                 INFORMATION TECHNOLOGY LABORATORY
C                 NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY
C                 GAITHERSBURG, MD 20899
C                 PHONE--301-975-2855
C     NOTE--DATAPLOT IS A REGISTERED TRADEMARK
C           OF THE NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.
C     LANGUAGE--ANSI FORTRAN (1977)
C     VERSION NUMBER--82/7
C     ORIGINAL VERSION--FEBRUARY  1979.
C     UPDATED         --APRIL     1979.
C     UPDATED         --AUGUST    1981.
C     UPDATED         --MAY       1982.
C
C-----CHARACTER STATEMENTS FOR NON-COMMON VARIABLES-------------------
C
      CHARACTER*4 IWRITE
      CHARACTER*4 IBUGA3
      CHARACTER*4 IERROR
C
      CHARACTER*4 ISUBN1
      CHARACTER*4 ISUBN2
C
C---------------------------------------------------------------------
C
      DIMENSION X(*)
      DIMENSION D(*)
      DIMENSION Y(*)
C
C-----COMMON----------------------------------------------------------
C
      INCLUDE 'DPCOP2.INC'
C
C-----START POINT-----------------------------------------------------
C
      ISUBN1='FREQ'
      ISUBN2='UE  '
      IERROR='NO'
C
      IF(IBUGA3.EQ.'ON')THEN
        WRITE(ICOUT,999)
  999   FORMAT(1X)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,51)
   51   FORMAT('***** AT THE BEGINNING OF FREQUE--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,52)IBUGA3,IWRITE
   52   FORMAT('IBUGA3,IWRITE = ',A4,2X,A4)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,53)NX,ND,NUMVAR
   53   FORMAT('NX,ND,NUMVAR = ',3I8)
        CALL DPWRST('XXX','BUG ')
        DO55I=1,NX
          WRITE(ICOUT,56)I,X(I)
   56     FORMAT('I,X(I) = ',I8,G15.7)
          CALL DPWRST('XXX','BUG ')
   55   CONTINUE
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        DO60I=1,ND
          WRITE(ICOUT,61)I,D(I)
   61     FORMAT('I,D(I) = ',I8,G15.7)
          CALL DPWRST('XXX','BUG ')
   60   CONTINUE
      ENDIF
C
C               ********************************
C               **  STEP 1--                  **
C               **  COMPUTE DISTINCT VALUES  **
C               **  (IF NECESSARY)            **
C               ********************************
C
      IF(NUMVAR.GE.2)GOTO190
C
      ND=0
      IF(NX.LT.1)GOTO150
      DO100I=1,NX
      IF(I.EQ.1)GOTO130
      DO120J=1,ND
      IF(X(I).EQ.D(J))GOTO100
  120 CONTINUE
  130 CONTINUE
      ND=ND+1
      D(ND)=X(I)
  100 CONTINUE
      GOTO190
C
  150 CONTINUE
      IERROR='YES'
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,151)
  151 FORMAT('***** ERROR IN FREQUE--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,152)
  152 FORMAT('      THE INPUT NUMBER OF OBSERVATIONS')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,153)
  153 FORMAT('      IN THE VARIABLE FOR WHICH')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,154)
  154 FORMAT('      THE DISTINCT VALUES ARE TO BE FOUND')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,155)
  155 FORMAT('      MUST BE 1 OR LARGER.')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,156)
  156 FORMAT('      SUCH WAS NOT THE CASE HERE.')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,157)NX
  157 FORMAT('      THE INPUT NUMBER OF OBSERVATIONS HERE = ',I8,
     1'.')
      CALL DPWRST('XXX','BUG ')
C
  190 CONTINUE
C
C               ***************************
C               **  STEP 2--             **
C               **  COMPUTE FREQUENCIES  **
C               ***************************
C
      NY=ND
      IF(ND.LT.1)GOTO250
      DO210J=1,ND
      ISUM=0
      DO220I=1,NX
      IF(X(I).EQ.D(J))GOTO230
      GOTO220
  230 CONTINUE
      ISUM=ISUM+1
  220 CONTINUE
      Y(J)=ISUM
  210 CONTINUE
      GOTO290
C
  250 CONTINUE
      IERROR='YES'
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,251)
  251 FORMAT('***** ERROR IN FREQUE--')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,252)
  252 FORMAT('      THE INPUT NUMBER OF DISTINCT VALUES')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,253)
  253 FORMAT('      OF THE VARIABLE FOR WHICH')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,254)
  254 FORMAT('      FREQUENCIES ARE TO BE FOUND')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,255)
  255 FORMAT('      MUST BE 1 OR LARGER.')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,256)
  256 FORMAT('      SUCH WAS NOT THE CASE HERE.')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,257)ND
  257 FORMAT('      THE INPUT NUMBER OF OBSERVATIONS HERE = ',I8,
     1'.')
      CALL DPWRST('XXX','BUG ')
C
  290 CONTINUE
C
C               *****************
C               **  STEP 90--  **
C               **  EXIT.      **
C               *****************
C
      IF(IBUGA3.EQ.'ON')THEN
        WRITE(ICOUT,999)
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9011)
 9011   FORMAT('***** AT THE END       OF FREQUE--')
        CALL DPWRST('XXX','BUG ')
        WRITE(ICOUT,9013)IERROR,NX,ND,NY
 9013   FORMAT('IERROR,NX,ND,NY = ',A4,2X,3I8)
        CALL DPWRST('XXX','BUG ')
        DO9015I=1,NX
          WRITE(ICOUT,9016)I,X(I),D(I),Y(I)
 9016     FORMAT('I,X(I),D(I),Y(I) = ',I8,3E15.7)
          CALL DPWRST('XXX','BUG ')
 9015   CONTINUE
      ENDIF
C
      RETURN
      END
      SUBROUTINE FSTOCD (N, X, SX, RNOISE, G)
CCCCC SUBROUTINE FSTOCD (N, X, OPTFCN, SX, RNOISE, G)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C PURPOSE
C -------
C FIND CENTRAL DIFFERENCE APPROXIMATION G TO THE FIRST DERIVATIVE
C (GRADIENT) OF THE FUNCTION DEFINED BY FCN AT THE POINT X.
C
C PARAMETERS
C ----------
C N            --> DIMENSION OF PROBLEM
C X            --> POINT AT WHICH GRADIENT IS TO BE APPROXIMATED.
C FCN          --> NAME OF SUBROUTINE TO EVALUATE FUNCTION.
C SX           --> DIAGONAL SCALING MATRIX FOR X.
C RNOISE       --> RELATIVE NOISE IN FCN [F(X)].
C G           <--  CENTRAL DIFFERENCE APPROXIMATION TO GRADIENT.
C
C
      DIMENSION X(N)
      DIMENSION SX(N)
      DIMENSION G(N)
      DIMENSION FHAT(1)
C
C FIND I TH  STEPSIZE, EVALUATE TWO NEIGHBORS IN DIRECTION OF I TH
C UNIT VECTOR, AND EVALUATE I TH  COMPONENT OF GRADIENT.
C
      THIRD = 1.0/3.0
      DO 10 I = 1, N
         STEPI = RNOISE**THIRD * MAX(ABS(X(I)), 1.0/SX(I))
         XTEMPI = X(I)
         X(I) = XTEMPI + STEPI
         CALL OPTFCN (N, X, FHAT)
         FPLUS=FHAT(1)
         X(I) = XTEMPI - STEPI
         CALL OPTFCN (N, X, FHAT)
         FMINUS=FHAT(1)
         X(I) = XTEMPI
         G(I) = (FPLUS - FMINUS)/(2.0*STEPI)
   10 CONTINUE
      RETURN
      END
      SUBROUTINE FSTOFD(NR,M,N,XPLS,FPLS,A,SX,RNOISE,FHAT,
CDPLT SUBROUTINE FSTOFD(NR,M,N,XPLS,OPTFCN,FPLS,A,SX,RNOISE,FHAT,
     +ICASE)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C PURPOSE
C -------
C FIND FIRST ORDER FORWARD FINITE DIFFERENCE APPROXIMATION "A" TO THE
C FIRST DERIVATIVE OF THE FUNCTION DEFINED BY THE SUBPROGRAM "FNAME"
C EVALUATED AT THE NEW ITERATE "XPLS".
C
C
C FOR OPTIMIZATION USE THIS ROUTINE TO ESTIMATE:
C 1) THE FIRST DERIVATIVE (GRADIENT) OF THE OPTIMIZATION FUNCTION "FCN
C    ANALYTIC USER ROUTINE HAS BEEN SUPPLIED;
C 2) THE SECOND DERIVATIVE (HESSIAN) OF THE OPTIMIZATION FUNCTION
C    IF NO ANALYTIC USER ROUTINE HAS BEEN SUPPLIED FOR THE HESSIAN BUT
C    ONE HAS BEEN SUPPLIED FOR THE GRADIENT ("FCN") AND IF THE
C    OPTIMIZATION FUNCTION IS INEXPENSIVE TO EVALUATE
C
C NOTE
C ----
C _M=1 (OPTIMIZATION) ALGORITHM ESTIMATES THE GRADIENT OF THE FUNCTION
C      (FCN).   FCN(X) # F: R(N)-->R(1)
C _M=N (SYSTEMS) ALGORITHM ESTIMATES THE JACOBIAN OF THE FUNCTION
C      FCN(X) # F: R(N)-->R(N).
C _M=N (OPTIMIZATION) ALGORITHM ESTIMATES THE HESSIAN OF THE OPTIMIZATIO
C      FUNCTION, WHERE THE HESSIAN IS THE FIRST DERIVATIVE OF "FCN"
C
C PARAMETERS
C ----------
C NR           --> ROW DIMENSION OF MATRIX
C M            --> NUMBER OF ROWS IN A
C N            --> NUMBER OF COLUMNS IN A; DIMENSION OF PROBLEM
C XPLS(N)      --> NEW ITERATE:  X[K]
C OPTFCN       --> NAME OF SUBROUTINE TO EVALUATE FUNCTION
C FPLS(M)      --> _M=1 (OPTIMIZATION) FUNCTION VALUE AT NEW ITERATE:
C                       FCN(XPLS)
C                  _M=N (OPTIMIZATION) VALUE OF FIRST DERIVATIVE
C                       (GRADIENT) GIVEN BY USER FUNCTION FCN
C                  _M=N (SYSTEMS)  FUNCTION VALUE OF ASSOCIATED
C                       MINIMIZATION FUNCTION
C A(NR,N)     <--  FINITE DIFFERENCE APPROXIMATION (SEE NOTE).  ONLY
C                  LOWER TRIANGULAR MATRIX AND DIAGONAL ARE RETURNED
C SX(N)        --> DIAGONAL SCALING MATRIX FOR X
C RNOISE       --> RELATIVE NOISE IN FCN [F(X)]
C FHAT(M)      --> WORKSPACE
C ICASE        --> =1 OPTIMIZATION (GRADIENT)
C                  =2 SYSTEMS
C                  =3 OPTIMIZATION (HESSIAN)
C
C INTERNAL VARIABLES
C ------------------
C STEPSZ - STEPSIZE IN THE J-TH VARIABLE DIRECTION
C
CDPLT DIMENSION XPLS(N),FPLS(M)
CDPLT DIMENSION FHAT(M)
CDPLT DIMENSION SX(N)
      DIMENSION XPLS(*),FPLS(*)
      DIMENSION FHAT(*)
      DIMENSION SX(*)
      DIMENSION A(NR,1)
CDPLT EXTERNAL OPTFCN
C
C FIND J-TH COLUMN OF A
C EACH COLUMN IS DERIVATIVE OF F(FCN) WITH RESPECT TO XPLS(J)
C
      DO 30 J=1,N
        STEPSZ=SQRT(RNOISE)*MAX(ABS(XPLS(J)),1.D0/SX(J))
        XTMPJ=XPLS(J)
        XPLS(J)=XTMPJ+STEPSZ
        CALL OPTFCN(N,XPLS,FHAT)
        XPLS(J)=XTMPJ
        DO 20 I=1,M
          A(I,J)=(FHAT(I)-FPLS(I))/STEPSZ
   20   CONTINUE
   30 CONTINUE
      IF(ICASE.NE.3) RETURN
C
C IF COMPUTING HESSIAN, A MUST BE SYMMETRIC
C
      IF(N.EQ.1) RETURN
      NM1=N-1
      DO 50 J=1,NM1
        JP1=J+1
        DO 40 I=JP1,M
          A(I,J)=(A(I,J)+A(J,I))/2.0D0
   40   CONTINUE
   50 CONTINUE
      RETURN
      END
      subroutine fts(x,n,np,trend,work)
c
c  This routine is part of the Bill Cleveland seasonal loess
c  program.
c
      integer n, np
      real x(n), trend(n), work(n)
      call ma(x,n,np,trend)
      call ma(trend,n-np+1,np,work)
      call ma(work,n-2*np+2,3,trend)
      return
      end
      subroutine fexact (nrow, ncol, table, ldtabl, expect, percnt,
     &                   emin, prt, pre,
     &                   rwrk,dwrk,iwrk,iwkmax)
c-----------------------------------------------------------------------
c  Name:       FEXACT
c
c  Purpose:    Computes Fisher's exact test probabilities and a hybrid
c              approximation to Fisher exact test probabilities for a
c              contingency table using the network algorithm.
c
c  Usage:      CALL FEXACT (NROW, NCOL, TABLE, LDTABL, EXPECT, PERCNT,
c                          EMIN, PRT, PRE)
c
c  Arguments:
c     NROW   - The number of rows in the table.  (Input)
c     NCOL   - The number of columns in the table.  (Input)
c     TABLE  - NROW by NCOL matrix containing the contingency table.
c              (Input)
c     LDTABL - Leading dimension of TABLE exactly as specified in the
c              dimension statement in the calling program.  (Input)
c     EXPECT - Expected value used in the hybrid algorithm for
c              deciding when to use asymptotic theory probabilities.
c              (Input)
c              If EXPECT .LE. 0.0 then asymptotic theory probabilities
c              are not used and Fisher exact test probabilities are
c              computed.  Otherwise, if PERCNT or more of the cells in
c              the remaining table have estimated expected values of
c              EXPECT or more, with no remaining cell having expected
c              value less than EMIN, then asymptotic chi-squared
c              probabilities are used.  See the algorithm section of the
c              manual document for details.  Use EXPECT = 5.0 to obtain
c              the 'Cochran' condition.
c     PERCNT - Percentage of remaining cells that must have estimated
c              expected  values greater than EXPECT before asymptotic
c              probabilities can be used.  (Input)
c              See argument EXPECT for details.  Use PERCNT = 80.0 to
c              obtain the 'Cochran' condition.
c     EMIN   - Minimum cell estimated expected value allowed for
c              asymptotic chi-squared probabilities to be used.  (Input)
c              See argument EXPECT for details.  Use EMIN = 1.0 to
c              obtain the 'Cochran' condition.
c     PRT    - Probability of the observed table for fixed marginal
c              totals.  (Output)
c     PRE    - Table p-value.  (Output)
c              PRE is the probability of a more extreme table, where
c              'extreme' is in a probabilistic sense.
c              If EXPECT .LT. 0 then the Fisher exact probability
c              is returned.  Otherwise, an approximation to the
c              Fisher exact probability is computed based upon
c              asymptotic chi-squared probabilities for ``large''
c              table expected values.  The user defines ``large''
c              through the arguments EXPECT, PERCNT, and EMIN.
c
c  Remarks:
c  1. For many problems one megabyte or more of workspace can be 
c     required.  If the environment supports it, the user should begin 
c     by increasing the workspace used to 200,000 units. 
c
c  2. In FEXACT, LDSTP = 30*LDKEY.  The proportion of table space used 
c     by STP may be changed by changing the line MULT = 30 below to 
c     another value.
c
c  3. FEXACT may be converted to single precision by setting IREAL = 3,
c     and converting all DOUBLE PRECISION specifications (except the 
c     specifications for RWRK, IWRK, and DWRK) to REAL.  This will 
c     require changing the names and specifications of the intrinsic
c     functions LOG, AMAX1, AMIN1, EXP, and REAL.  In addition, the
c     machine specific constants will need to be changed, and the name
c     DWRK will need to be changed to RWRK in the call to F2XACT.
c
c  4. Machine specific constants are specified and documented in F2XACT.
c     A missing value code is specified in both FEXACT and F2XACT.
c
c  5. Although not a restriction, is is not generally practical to call
c     this routine with large tables which are not sparse and in
c     which the 'hybrid' algorithm has little effect.  For example,
c     although it is feasible to compute exact probabilities for the
c     table
c            1 8 5 4 4 2 2
c            5 3 3 4 3 1 0
c           10 1 4 0 0 0 0,
c     computing exact probabilities for a similar table which has been
c     enlarged by the addition of an extra row (or column) may not be
c     feasible.
c-----------------------------------------------------------------------
c                                  SPECIFICATIONS FOR ARGUMENTS
      integer    nrow, ncol, ldtabl
      double precision expect, percnt, emin, prt, pre, table(ldtabl,*)
c                                  SPECIFICATIONS FOR LOCAL VARIABLES
      integer    i, i1, i10, i2, i3, i3a, i3b, i3c, i4, i5, i6, i7,
     &           i8, i9, i9a, iiwk, ireal, irwk, iwkmax, iwkpt,
     &           j, k, kk, ldkey, ldstp, mult, nco, nro,
     &           ntot, numb
c                                  SPECIFICATIONS FOR INTRINSICS
      intrinsic  max0
ccccc integer    max0
c                                  SPECIFICATIONS FOR SUBROUTINES
ccccc external   prterr, f2xact
      external   f2xact
c                                  SPECIFICATIONS FOR FUNCTIONS
      external   iwork
      integer    iwork
c***********************************************************************
c                                  To increase workspace, increase the
c                                  size of of rwrk and set the value of 
c                                  IWKMAX to the new dimension
c
c                                  When changing precision, the 
c                                  following declarations should not be
c                                  changed.
c***********************************************************************
ccccc real       rwrk(200000)
ccccc double precision dwrk(100000)
ccccc integer    iwrk(100000)
ccccc equivalence (rwrk(1), iwrk(1)), (rwrk(1),dwrk(1))
      real rwrk(*)
      double precision dwrk(*)
      integer iwrk(*)
c                                  Set workspace size
      INCLUDE 'DPCOP2.INC'
C
      RWRK(1)=0.0
ccccc iwkmax = 200000
c
c***********************************************************************
c                                  To increase the length of the table
c                                  of paste path lengths relative to the
c                                  length of the hash table,  increase
c                                  MULT 
c***********************************************************************
      mult   = 30
c***********************************************************************
c                                  Set IREAL = 4 for DOUBLE PRECISION
c                                  Set IREAL = 3 for SINGLE PRECISION
c***********************************************************************
      ireal  = 4
c***********************************************************************
c                                  AMISS is a missing value indicator
c                                  which is returned when the
c                                  probability is not defined.
c***********************************************************************
      amiss = -12345.0d0
c
      iwkpt  = 1
c
CCCCC print *,'fexact: nrow,ncol,ldtabl=',nrow,ncol,ldtabl
CCCCC print *,'table(1,1) = ',table(1,1)
CCCCC print *,'table(2,1) = ',table(2,1)
CCCCC print *,'table(1,2) = ',table(1,2)
CCCCC print *,'table(2,2) = ',table(2,2)
CCCCC print *,'expect,percnt,emin=',expect,percnt,emin
c
      if (nrow .gt. ldtabl) then
CCCCC    call prterr (1, 'NROW must be less than or equal to '//
CCCCC&               'LDTABL.')
      WRITE(ICOUT,999)
  999 FORMAT(1X)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9011)
 9011 FORMAT('***** ERROR FROM FEXACT.')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9013)
 9013 FORMAT('      NROW must be less than or equal to LDTABL.')
      CALL DPWRST('XXX','BUG ')
      end if
      ntot = 0
      do 20  i=1, nrow
         do 10  j=1, ncol
            if (table(i,j) .lt. 0) then
CCCCC          call prterr (2, 'All elements of TABLE must '//
CCCCC&                     'be positive.')
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9011)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9113)
 9113 FORMAT('      All elements of TABLE must be non-negative.')
      CALL DPWRST('XXX','BUG ')
            end if
            ntot = ntot + int(table(i,j))
   10    continue
   20 continue
      if (ntot .eq. 0) then
ccccc    call prterr (3, 'All elements of TABLE are zero.  '//
ccccc&               'PRT and PRE are set to missing values '//
ccccc&               '(NaN, not a number).')
      WRITE(ICOUT,999)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9011)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9213)
 9213 FORMAT('      All elements of TABLE are zero.  PRT and PRE are')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9215)
 9215 FORMAT('      set to missing values (NaN, not a number).')
      CALL DPWRST('XXX','BUG ')
         prt = amiss
         pre = amiss
         go to 9000
      end if
c
      nco = max0(nrow,ncol)
      nro = nrow + ncol - nco
      k   = nrow + ncol + 1
      kk  = k*max0(nrow,ncol)
c
      i1   = iwork(iwkmax,iwkpt,ntot+1,ireal)
      i2   = iwork(iwkmax,iwkpt,nco,2)
      i3   = iwork(iwkmax,iwkpt,nco,2)
      i3a  = iwork(iwkmax,iwkpt,nco,2)
      i3b  = iwork(iwkmax,iwkpt,nro,2)
      i3c  = iwork(iwkmax,iwkpt,nro,2)
      iiwk = iwork(iwkmax,iwkpt,max0(5*k+2*kk,800+7*max0(nrow,ncol)),2)
      irwk = iwork(iwkmax,iwkpt,max0(400+max0(nrow,ncol)+1,k),ireal)
c                                  Double precision
      if (ireal .eq. 4) then
         numb  = 18 + 10*mult
         ldkey = (iwkmax-iwkpt+1)/numb
      else
c                                  Real workspace
         numb  = 12 + 8*mult
         ldkey = (iwkmax-iwkpt+1)/numb
      end if
c
      ldstp = mult*ldkey
      i4    = iwork(iwkmax,iwkpt,2*ldkey,2)
      i5    = iwork(iwkmax,iwkpt,2*ldkey,2)
      i6    = iwork(iwkmax,iwkpt,2*ldstp,ireal)
      i7    = iwork(iwkmax,iwkpt,6*ldstp,2)
      i8    = iwork(iwkmax,iwkpt,2*ldkey,ireal)
      i9    = iwork(iwkmax,iwkpt,2*ldkey,ireal)
      i9a   = iwork(iwkmax,iwkpt,2*ldkey,ireal)
      i10   = iwork(iwkmax,iwkpt,2*ldkey,2)
c***********************************************************************
c                                  To convert to double precision,
c                                  change RWRK to WWRK in the next CALL
c***********************************************************************
c
      call f2xact (nrow, ncol, table, ldtabl, expect, percnt, emin,
     &             prt, pre, dwrk(i1), iwrk(i2), iwrk(i3), iwrk(i3a),
     &             iwrk(i3b), iwrk(i3c), iwrk(i4), ldkey, iwrk(i5),
     &             dwrk(i6), ldstp, iwrk(i7), dwrk(i8), dwrk(i9),
     &             dwrk(i9a), iwrk(i10), iwrk(iiwk), dwrk(irwk))
c
 9000 return
      end
      subroutine f2xact (nrow, ncol, table, ldtabl, expect, percnt,
     &                   emin, prt, pre, fact, ico, iro, kyy, idif,
     &                   irn, key, ldkey, ipoin, stp, ldstp, ifrq,
     &                   dlp, dsp, tm, key2, iwk, rwk)
c-----------------------------------------------------------------------
c  Name:       F2XACT
c
c  Purpose:    Computes Fisher's exact test for a contingency table,
c              routine with workspace variables specified.
c
c  Usage:      CALL F2XACT (NROW, NCOL, TABLE, LDTABL, EXPECT, PERCNT,
c                          EMIN, PRT, PRE, FACT, ICO, IRO, KYY, IDIF,
c                          IRN, KEY, LDKEY, IPOIN, STP, LDSTP, IFRQ,
c                          DLP, DSP, TM, KEY2, IWK, RWK)
c-----------------------------------------------------------------------
c                                  SPECIFICATIONS FOR ARGUMENTS
      integer    nrow, ncol, ldtabl, ldkey, ldstp, ico(*), iro(*),
     &           kyy(*), idif(*), irn(*), key(*), ipoin(*), ifrq(*),
     &           key2(*), iwk(*)
      double precision expect, percnt, emin, prt, pre, table(ldtabl,*),
     &           fact(0:*), stp(*), dlp(*), dsp(*), tm(*), rwk(*)
c                                  SPECIFICATIONS FOR LOCAL VARIABLES
      integer    i, i31, i310, i311, i32, i33, i34, i35, i36, i37,
     &           i38, i39, i41, i42, i43, i44, i45, i46, i47, i48,
     &           iflag, ifreq, ii, ikkey, ikstp, ikstp2, ipn, ipo,
     &           itmp, itop, itp, j, jkey, jstp, jstp2, jstp3, jstp4,
     &           k, k1, kb, kd, kmax, ks, kval, last, n, ncell, nco,
     &           nrb, nro, nro2, ntot, ifault, imax
      double precision dd, ddf, df, drn, dro, dspt, emn, obs, obs2, 
     &           obs3, pastp, pv, tmp, tol
      logical    chisq, ipsh
c                                  SPECIFICATIONS FOR INTRINSICS
      intrinsic  dlog, dmax1, dmin1, dexp, max0, min0, mod, nint, dble
ccccc integer    max0, min0, mod, nint
ccccc double precision dlog, dmax1, dmin1, dexp, dble
c                                  SPECIFICATIONS FOR SUBROUTINES
ccccc external   prterr, f3xact, f4xact, f5xact, f6xact, f7xact, isort
      external   f3xact, f4xact, f5xact, f6xact, f7xact, isort
c                                  SPECIFICATIONS FOR FUNCTIONS
      external   f9xact, gammds
      double precision f9xact, gammds
C
      INCLUDE 'DPCOP2.INC'
C
c***********************************************************************
c                                  IMAX is the largest representable
c                                  integer on the machine
c***********************************************************************
      data imax/2147483647/
c***********************************************************************
c                                  AMISS is a missing value indicator
c                                  which is returned when the
c                                  probability is not defined.
c***********************************************************************
      data amiss/-12345.0d0/
c***********************************************************************
c                                  TOL is chosen as the square root of
c                                  the smallest relative spacing
c***********************************************************************
      data tol/3.45254d-07/
c***********************************************************************
c                                  EMX is a large positive value used 
c                                  in comparing expected values
c***********************************************************************
      data emx/1.0d30/
c                                  Initialize KEY array
      chisq = .true.
      tmp=0.0d0
c
      do 10  i=1, 2*ldkey
         key(i)  = -9999
         key2(i) = -9999
   10 continue
c                                  Initialize parameters
      pre  = 0.0
      itop = 0
      if (expect .gt. 0.0d0) then
         emn = emin
      else
         emn = emx
      end if
c                                  Initialize pointers for workspace
      k = max0(nrow,ncol)
c                                  f3xact
      i31  = 1
      i32  = i31 + k
      i33  = i32 + k
      i34  = i33 + k
      i35  = i34 + k
      i36  = i35 + k
      i37  = i36 + k
      i38  = i37 + k
      i39  = i38 + 400
      i310 = 1
      i311 = 401
c                                  f4xact
      k   = nrow + ncol + 1
      i41 = 1
      i42 = i41 + k
      i43 = i42 + k
      i44 = i43 + k
      i45 = i44 + k
      i46 = i45 + k
      i47 = i46 + k*max0(nrow,ncol)
      i48 = 1
c                                  Check table dimensions
      if (nrow .gt. ldtabl) then
CCCCC    call prterr (1, 'NROW must be less than or equal to '//
CCCCC&               'LDTABL.')
         WRITE(ICOUT,999)
  999    FORMAT(1X)
         CALL DPWRST('XXX','BUG ')
         WRITE(ICOUT,9011)
 9011    FORMAT('***** ERROR IN F2XACT--')
         CALL DPWRST('XXX','BUG ')
         WRITE(ICOUT,9013)
 9013    FORMAT('      NROW must be less than or equal to LDTABL.')
         CALL DPWRST('XXX','BUG ')
      end if
      if (ncol .le. 1) then
ccccc    call prterr (4, 'NCOL must be greater than 1.0.')
         WRITE(ICOUT,999)
         CALL DPWRST('XXX','BUG ')
         WRITE(ICOUT,9011)
         CALL DPWRST('XXX','BUG ')
         WRITE(ICOUT,9113)
 9113    FORMAT('      NCOL must be greater than 1.0.')
         CALL DPWRST('XXX','BUG ')
      end if
c                                  Compute row marginals and total
      ntot = 0
      do 30  i=1, nrow
         iro(i) = 0
         do 20  j=1, ncol
            if (table(i,j) .lt. -0.0001d0) then
CCCCC          call prterr (2, 'All elements of TABLE must be '//
CCCCC&                     'positive.')
         WRITE(ICOUT,999)
         CALL DPWRST('XXX','BUG ')
         WRITE(ICOUT,9011)
         CALL DPWRST('XXX','BUG ')
         WRITE(ICOUT,9123)
 9123    FORMAT('       All elements of TABLE must be positive.')
         CALL DPWRST('XXX','BUG ')
            end if
            iro(i) = iro(i) + nint(table(i,j))
            ntot   = ntot + nint(table(i,j))
   20    continue
   30 continue
c
      if (ntot .eq. 0) then
CCCCC    call prterr (3, 'All elements of TABLE are zero.  '//
CCCCC&               'PRT and PRE are set to missing values '//
CCCCC&               '(NaN, not a number).')
         WRITE(ICOUT,999)
         CALL DPWRST('XXX','BUG ')
         WRITE(ICOUT,9011)
         CALL DPWRST('XXX','BUG ')
         WRITE(ICOUT,9133)
 9133    FORMAT('       All elements of TABLE are zero.  PRT and PRE')
         CALL DPWRST('XXX','BUG ')
         WRITE(ICOUT,9135)
 9135    FORMAT('       are set to missing values (NaN, not a ',
     &          'number).')
         CALL DPWRST('XXX','BUG ')
         prt = amiss
         pre = amiss
         go to 9000
      end if
c                                  Column marginals
      do 50  i=1, ncol
         ico(i) = 0
         do 40  j=1, nrow
            ico(i) = ico(i) + nint(table(j,i))
   40    continue
   50 continue
c                                  sort
      call isort (nrow, iro)
      call isort (ncol, ico)
c                                  Determine row and column marginals
c
      if (nrow .gt. ncol) then
         nro = ncol
         nco = nrow
c                                  Interchange row and column marginals
         do 60  i=1, nrow
            itmp = iro(i)
            if (i .le. ncol) iro(i) = ico(i)
            ico(i) = itmp
   60    continue
      else
         nro = nrow
         nco = ncol
      end if
c
c                                  Get multiplers for stack
      kyy(1) = 1
      do 70  i=2, nro
c                                  Hash table multipliers
         if (iro(i-1)+1 .le. imax/kyy(i-1)) then
            kyy(i) = kyy(i-1)*(iro(i-1)+1)
            j      = j/kyy(i-1)
         else
CCCCC       call prterr (5, 'The hash table key cannot be computed'//
CCCCC&                  ' because the largest key is larger than the'//
CCCCC&                  ' largest representable integer.  The '//
CCCCC&                  'algorithm cannot proceed.')
         WRITE(ICOUT,999)
         CALL DPWRST('XXX','BUG ')
         WRITE(ICOUT,9011)
         CALL DPWRST('XXX','BUG ')
         WRITE(ICOUT,9143)
 9143    FORMAT('       The hash table key cannot be computed because')
         CALL DPWRST('XXX','BUG ')
         WRITE(ICOUT,9145)
 9145    FORMAT('       the largest key is larger than the largest')
         CALL DPWRST('XXX','BUG ')
         WRITE(ICOUT,9147)
 9147    FORMAT('       representable integer.  The algorithm cannot',
     &          ' proceed.')
         CALL DPWRST('XXX','BUG ')
         end if
   70 continue
c                                  Maximum product
      if (iro(nro-1)+1 .le. imax/kyy(nro-1)) then
         kmax = (iro(nro)+1)*kyy(nro-1)
      else
ccccc    call prterr (5, 'The hash table key cannot be computed'//
ccccc&               ' because the largest key is larger than the'//
ccccc&               ' largest representable integer.  The '//
ccccc&               'algorithm cannot proceed.')
         WRITE(ICOUT,999)
         CALL DPWRST('XXX','BUG ')
         WRITE(ICOUT,9011)
         CALL DPWRST('XXX','BUG ')
         WRITE(ICOUT,9143)
         CALL DPWRST('XXX','BUG ')
         WRITE(ICOUT,9145)
         CALL DPWRST('XXX','BUG ')
         WRITE(ICOUT,9147)
         CALL DPWRST('XXX','BUG ')
         go to 9000
      end if
c                                  Compute log factorials
      fact(0) = 0.0d0
      fact(1) = 0.0d0
      fact(2) = dlog(2.0d0)
      do 80  i=3, ntot, 2
         fact(i) = fact(i-1) + dlog(dble(i))
         j       = i + 1
         if (j .le. ntot) fact(j) = fact(i) + fact(2) + fact(j/2) -
     &       fact(j/2-1)
   80 continue
c                                  Compute observed path length: OBS
      obs  = tol
      ntot = 0
      do 100  j=1, nco
         dd = 0.0
         do 90  i=1, nro
            if (nrow .le. ncol) then
               dd   = dd + fact(nint(table(i,j)))
               ntot = ntot + nint(table(i,j))
            else
               dd   = dd + fact(nint(table(j,i)))
               ntot = ntot + nint(table(j,i))
            end if
   90    continue
         obs = obs + fact(ico(j)) - dd
  100 continue
c                                  Denominator of observed table: DRO
      dro = f9xact(nro,ntot,iro,fact)
      prt = dexp(obs-dro)
c                                  Initialize pointers
      k        = nco
      last     = ldkey + 1
      jkey     = ldkey + 1
      jstp     = ldstp + 1
      jstp2    = 3*ldstp + 1
      jstp3    = 4*ldstp + 1
      jstp4    = 5*ldstp + 1
      ikkey    = 0
      ikstp    = 0
      ikstp2   = 2*ldstp
      ipo      = 1
      ipoin(1) = 1
      stp(1)   = 0.0
      ifrq(1)  = 1
      ifrq(ikstp2+1) = -1
c
  110 kb = nco - k + 1
      ks   = 0
      n    = ico(kb)
      kd   = nro + 1
      kmax = nro
c                                  IDIF is the difference in going to th
c                                  daughter
      do 120  i=1, nro
         idif(i) = 0
  120 continue
c                                  Generate the first daughter
  130 kd = kd - 1
      ntot     = min0(n,iro(kd))
      idif(kd) = ntot
      if (idif(kmax) .eq. 0) kmax = kmax - 1
      n = n - ntot
      if (n.gt.0 .and. kd.ne.1) go to 130
      if (n .ne. 0) go to 310
c
      k1   = k - 1
      n    = ico(kb)
      ntot = 0
      do 140  i=kb + 1, nco
         ntot = ntot + ico(i)
  140 continue
c                                  Arc to daughter length=ICO(KB)
  150 do 160  i=1, nro
         irn(i) = iro(i) - idif(i)
  160 continue
c                                  Sort irn
      if (k1 .gt. 1) then
         if (nro .eq. 2) then
            if (irn(1) .gt. irn(2)) then
               ii     = irn(1)
               irn(1) = irn(2)
               irn(2) = ii
            end if
         else if (nro .eq. 3) then
            ii = irn(1)
            if (ii .gt. irn(3)) then
               if (ii .gt. irn(2)) then
                  if (irn(2) .gt. irn(3)) then
                     irn(1) = irn(3)
                     irn(3) = ii
                  else
                     irn(1) = irn(2)
                     irn(2) = irn(3)
                     irn(3) = ii
                  end if
               else
                  irn(1) = irn(3)
                  irn(3) = irn(2)
                  irn(2) = ii
               end if
            else if (ii .gt. irn(2)) then
               irn(1) = irn(2)
               irn(2) = ii
            else if (irn(2) .gt. irn(3)) then
               ii     = irn(2)
               irn(2) = irn(3)
               irn(3) = ii
            end if
         else
            do 180  j=2, nro
               i  = j - 1
               ii = irn(j)
  170          if (ii .lt. irn(i)) then
                  irn(i+1) = irn(i)
                  i        = i - 1
                  if (i .gt. 0) go to 170
               end if
               irn(i+1) = ii
  180       continue
         end if
c                                  Adjust start for zero
         do 190  i=1, nro
            if (irn(i) .ne. 0) go to 200
  190    continue
  200    nrb = i
         nro2 = nro - i + 1
      else
         nrb  = 1
         nro2 = nro
      end if
c                                  Some table values
      ddf = f9xact(nro,n,idif,fact)
      drn = f9xact(nro2,ntot,irn(nrb),fact) - dro + ddf
c                                  Get hash value
      if (k1 .gt. 1) then
         kval = irn(1) + irn(2)*kyy(2)
         do 210  i=3, nro
            kval = kval + irn(i)*kyy(i)
  210    continue
c                                  Get hash table entry
         i = mod(kval,2*ldkey) + 1
c                                  Search for unused location
         do 220  itp=i, 2*ldkey
            ii = key2(itp)
            if (ii .eq. kval) then
               go to 240
            else if (ii .lt. 0) then
               key2(itp) = kval
               dlp(itp)  = 1.0d0
               dsp(itp)  = 1.0d0
               go to 240
            end if
  220    continue
c
         do 230  itp=1, i - 1
            ii = key2(itp)
            if (ii .eq. kval) then
               go to 240
            else if (ii .lt. 0) then
               key2(itp) = kval
               dlp(itp)  = 1.0
               go to 240
            end if
  230    continue
c
ccccc    call prterr (6, 'LDKEY is too small.  It is not possible to '//
ccccc&               'give thevalue of LDKEY required, but you could '//
ccccc&               'try doubling LDKEY (and possibly LDSTP).')
         WRITE(ICOUT,999)
         CALL DPWRST('XXX','BUG ')
         WRITE(ICOUT,9011)
         CALL DPWRST('XXX','BUG ')
         WRITE(ICOUT,9153)
 9153    FORMAT('        LDKEY is too small.  It is not possible to ')
         CALL DPWRST('XXX','BUG ')
         WRITE(ICOUT,9155)
 9155    FORMAT('        give the value of LDKEY required, but you')
         CALL DPWRST('XXX','BUG ')
         WRITE(ICOUT,9157)
 9157    FORMAT('        could try doubling LDKEY (and possibly ',
     &          'LDSTP).')
         CALL DPWRST('XXX','BUG ')
      end if
c
  240 ipsh = .true.
c                                  Recover pastp
      ipn   = ipoin(ipo+ikkey)
      pastp = stp(ipn+ikstp)
      ifreq = ifrq(ipn+ikstp)
c                                  Compute shortest and longest path
      if (k1 .gt. 1) then
         obs2 = obs - fact(ico(kb+1)) - fact(ico(kb+2)) - ddf
         do 250  i=3, k1
            obs2 = obs2 - fact(ico(kb+i))
  250    continue
c
         if (dlp(itp) .gt. 0.0d0) then
            dspt = obs - obs2 - ddf
c                                  Compute longest path
            dlp(itp) = 0.0d0
            call f3xact (nro2, irn(nrb), k1, ico(kb+1), dlp(itp),
     &                   ntot, fact, iwk(i31), iwk(i32), iwk(i33),
     &                   iwk(i34), iwk(i35), iwk(i36), iwk(i37),
     &                   iwk(i38), iwk(i39), rwk(i310), rwk(i311), tol)
            dlp(itp) = dmin1(0.0d0,dlp(itp))
c                                  Compute shortest path
            dsp(itp) = dspt
            call f4xact (nro2, irn(nrb), k1, ico(kb+1), dsp(itp),
     &                   fact, iwk(i47), iwk(i41), iwk(i42), iwk(i43),
     &                   iwk(i44), iwk(i45), iwk(i46), rwk(i48), tol)
            dsp(itp) = dmin1(0.0d0,dsp(itp)-dspt)
c                                  Use chi-squared approximation?
            if (dble(irn(nrb)*ico(kb+1))/dble(ntot) .gt. emn) then
               ncell = 0
               do 270  i=1, nro2
                  do 260  j=1, k1
                     if (irn(nrb+i-1)*ico(kb+j) .ge. ntot*expect) then
                        ncell = ncell + 1
                     end if
  260             continue
  270          continue
               if (ncell*100 .ge. k1*nro2*percnt) then
                  tmp = 0.0
                  do 280  i=1, nro2
                     tmp = tmp + fact(irn(nrb+i-1)) -
     &                     fact(irn(nrb+i-1)-1)
  280             continue
                  tmp = tmp*(k1-1)
                  do 290  j=1, k1
                     tmp = tmp + (nro2-1)*(fact(ico(kb+j))-fact(ico(kb+
     &                     j)-1))
  290             continue
                  df      = (nro2-1)*(k1-1)
                  tmp     = tmp + df*1.83787706640934548356065947281d0
                  tmp     = tmp - (nro2*k1-1)*(fact(ntot)-fact(ntot-1))
                  tm(itp) = -2.0d0*(obs-dro) - tmp
               else
c                                  tm(itp) set to a flag value
                  tm(itp) = -9876.0d0
               end if
            else
               tm(itp) = -9876.0d0
            end if
         end if
         obs3 = obs2 - dlp(itp)
         obs2 = obs2 - dsp(itp)
         if (tm(itp) .eq. -9876.0d0) then
            chisq = .false.
         else
            chisq = .true.
            tmp   = tm(itp)
         end if
      else
         obs2 = obs - drn - dro
         obs3 = obs2
      end if
c                                  Process node with new PASTP
  300 if (pastp .le. obs3) then
c                                  Update pre
         pre = pre + dble(ifreq)*dexp(pastp+drn)
c
      else if (pastp .lt. obs2) then
         if (chisq) then
            df  = (nro2-1)*(k1-1)
            pv  = 1.0 - gammds(dmax1(0.0d0,tmp+2.0d0*(pastp+drn))/
     &            2.0d0,df/2.0d0,ifault)
            pre = pre + dble(ifreq)*dexp(pastp+drn)*pv
         else
c                                  Put daughter on queue
            call f5xact (pastp+ddf, tol, kval, key(jkey), ldkey,
     &                   ipoin(jkey), stp(jstp), ldstp, ifrq(jstp),
     &                   ifrq(jstp2), ifrq(jstp3), ifrq(jstp4), ifreq,
     &                   itop, ipsh)
            ipsh = .false.
         end if
      end if
c                                  Get next PASTP on chain
      ipn = ifrq(ipn+ikstp2)
      if (ipn .gt. 0) then
         pastp = stp(ipn+ikstp)
         ifreq = ifrq(ipn+ikstp)
         go to 300
      end if
c                                  Generate a new daughter node
      call f7xact (kmax, iro, idif, kd, ks, iflag)
      if (iflag .ne. 1) go to 150
c                                  Go get a new mother from stage K
  310 iflag = 1
      call f6xact (nro, iro, iflag, kyy, key(ikkey+1), ldkey, last,
     &             ipo)
c                                  Update pointers
      if (iflag .eq. 3) then
         k      = k - 1
         itop   = 0
         ikkey  = jkey - 1
         ikstp  = jstp - 1
         ikstp2 = jstp2 - 1
         jkey   = ldkey - jkey + 2
         jstp   = ldstp - jstp + 2
         jstp2  = 2*ldstp + jstp
         do 320  i=1, 2*ldkey
            key2(i) = -9999
  320    continue
         if (k .ge. 2) go to 310
      else
         go to 110
      end if
c
 9000 return
      end
      subroutine f3xact (nrow, irow, ncol, icol, dlp, mm, fact, ico,
     &                   iro, it, lb, nr, nt, nu, itc, ist, stv, alen,
     &                   tol)
c-----------------------------------------------------------------------
c  Name:       F3XACT
c
c  Purpose:    Computes the shortest path length for a given table.
c
c  Usage:      CALL F3XACT (NROW, IROW, NCOL, ICOL, DLP, MM, FACT, ICO,
c                          IRO, IT, LB, NR, NT, NU, ITC, IST, STV, ALEN,
c                          TOL)
c
c  Arguments:
c     NROW   - The number of rows in the table.  (Input)
c     IROW   - Vector of length NROW containing the row sums for the
c              table.  (Input)
c     NCOL   - The number of columns in the table.  (Input)
c     ICOL   - Vector of length K containing the column sums for the
c              table.  (Input)
c     DLP    - The longest path for the table.  (Output)
c     MM     - The total count in the table.  (Output)
c     FACT   - Vector containing the logarithms of factorials.  (Input)
c     ICO    - Work vector of length MAX(NROW,NCOL).
c     IRO    - Work vector of length MAX(NROW,NCOL).
c     IT     - Work vector of length MAX(NROW,NCOL).
c     LB     - Work vector of length MAX(NROW,NCOL).
c     NR     - Work vector of length MAX(NROW,NCOL).
c     NT     - Work vector of length MAX(NROW,NCOL).
c     NU     - Work vector of length MAX(NROW,NCOL).
c     ITC    - Work vector of length 400.
c     IST    - Work vector of length 400.
c     STV    - Work vector of length 400.
c     ALEN   - Work vector of length MAX(NROW,NCOL).
c     TOL    - Tolerance.  (Input)
c-----------------------------------------------------------------------
c                                  SPECIFICATIONS FOR ARGUMENTS
      integer    nrow, ncol, mm, irow(*), icol(*), ico(*), iro(*),
     &           it(*), lb(*), nr(*), nt(*), nu(*), itc(*), ist(*)
      double precision dlp, tol, fact(0:*), stv(*), alen(0:*)
c                                  SPECIFICATIONS FOR LOCAL VARIABLES
      integer    i, ic1, ic2, ii, ipn, irl, itp, k, key, ks, kyy, lev,
     &           n11, n12, nc1, nc1s, nco, nct, nn, nn1, nr1, nro, nrt
      double precision v, val, vmn
      logical    xmin
c                                  SPECIFICATIONS FOR SAVE VARIABLES
      integer    ldst, nitc, nst
      save       ldst, nitc, nst
c                                  SPECIFICATIONS FOR INTRINSICS
      intrinsic  dmin1, int, mod, dble
ccccc integer    int, mod
ccccc double precision dmin1, dble
c                                  SPECIFICATIONS FOR SUBROUTINES
ccccc external   prterr, f10act, isort
      external   f10act, isort
C
      INCLUDE 'DPCOP2.INC'
C
c***********************************************************************
c
      data ldst/200/, nst/0/, nitc/0/
c
      do 10  i=0, ncol
         alen(i) = 0.0
   10 continue
      do 20  i=1, 400
         ist(i) = -1
   20 continue
c                                  nrow is 1
      if (nrow .le. 1) then
         if (nrow .gt. 0) then
            dlp = dlp - fact(icol(1))
            do 30  i=2, ncol
               dlp = dlp - fact(icol(i))
   30       continue
         end if
         go to 9000
      end if
c                                  ncol is 1
      if (ncol .le. 1) then
         if (ncol .gt. 0) then
            dlp = dlp - fact(irow(1)) - fact(irow(2))
            do 40  i=3, nrow
               dlp = dlp - fact(irow(i))
   40       continue
         end if
         go to 9000
      end if
c                                  2 by 2 table
      if (nrow*ncol .eq. 4) then
         n11 = (irow(1)+1)*(icol(1)+1)/(mm+2)
         n12 = irow(1) - n11
         dlp = dlp - fact(n11) - fact(n12) - fact(icol(1)-n11) -
     &         fact(icol(2)-n12)
         go to 9000
      end if
c                                  Test for optimal table
      val  = 0.0
      xmin = .false.
      if (irow(nrow) .le. irow(1)+ncol) then
         call f10act (nrow, irow, ncol, icol, val, xmin, fact, lb, nu,
     &                nr)
      end if
      if (.not.xmin) then
         if (icol(ncol) .le. icol(1)+nrow) then
            call f10act (ncol, icol, nrow, irow, val, xmin, fact, lb,
     &                   nu, nr)
         end if
      end if
c
      if (xmin) then
         dlp = dlp - val
         go to 9000
      end if
c                                  Setup for dynamic programming
      nn = mm
c                                  Minimize ncol
      if (nrow .ge. ncol) then
         nro = nrow
         nco = ncol
c
         do 50  i=1, nrow
            iro(i) = irow(i)
   50    continue
c
         ico(1) = icol(1)
         nt(1)  = nn - ico(1)
         do 60  i=2, ncol
            ico(i) = icol(i)
            nt(i)  = nt(i-1) - ico(i)
   60    continue
      else
         nro = ncol
         nco = nrow
c
         ico(1) = irow(1)
         nt(1)  = nn - ico(1)
         do 70  i=2, nrow
            ico(i) = irow(i)
            nt(i)  = nt(i-1) - ico(i)
   70    continue
c
         do 80  i=1, ncol
            iro(i) = icol(i)
   80    continue
      end if
c                                  Initialize pointers
      vmn  = 1.0d10
      nc1s = nco - 1
      irl  = 1
      ks   = 0
      k    = ldst
      kyy  = ico(nco) + 1
      go to 100
c                                  Test for optimality
   90 xmin = .false.
      if (iro(nro) .le. iro(irl)+nco) then
         call f10act (nro, iro(irl), nco, ico, val, xmin, fact, lb,
     &                nu, nr)
      end if
      if (.not.xmin) then
         if (ico(nco) .le. ico(1)+nro) then
            call f10act (nco, ico, nro, iro(irl), val, xmin, fact, lb,
     &                   nu, nr)
         end if
      end if
c
      if (xmin) then
         if (val .lt. vmn) vmn = val
         go to 200
      end if
c                                  Setup to generate new node
  100 lev = 1
      nr1   = nro - 1
      nrt   = iro(irl)
      nct   = ico(1)
      lb(1) = int(dble((nrt+1)*(nct+1))/dble(nn+nr1*nc1s+1)-tol) - 1
      nu(1) = int(dble((nrt+nc1s)*(nct+nr1))/dble(nn+nr1+nc1s)) -
     &        lb(1) + 1
      nr(1) = nrt - lb(1)
c                                  Generate a node
  110 nu(lev) = nu(lev) - 1
      if (nu(lev) .eq. 0) then
         if (lev .eq. 1) go to 200
         lev = lev - 1
         go to 110
      end if
      lb(lev) = lb(lev) + 1
      nr(lev) = nr(lev) - 1
  120 alen(lev) = alen(lev-1) + fact(lb(lev))
      if (lev .lt. nc1s) then
         nn1     = nt(lev)
         nrt     = nr(lev)
         lev     = lev + 1
         nc1     = nco - lev
         nct     = ico(lev)
         lb(lev) = int(dble((nrt+1)*(nct+1))/dble(nn1+nr1*nc1+1) - tol)
         nu(lev) = int(dble((nrt+nc1)*(nct+nr1))/dble(nn1+nr1+nc1) -
     &             lb(lev) + 1)
         nr(lev) = nrt - lb(lev)
         go to 120
      end if
      alen(nco) = alen(lev) + fact(nr(lev))
      lb(nco)   = nr(lev)
c
      v = val + alen(nco)
      if (nro .eq. 2) then
c                                  Only 1 row left
         v = v + fact(ico(1)-lb(1)) + fact(ico(2)-lb(2))
         do 130  i=3, nco
            v = v + fact(ico(i)-lb(i))
  130    continue
         if (v .lt. vmn) vmn = v
      else if (nro.eq.3 .and. nco.eq.2) then
c                                  3 rows and 2 columns
         nn1 = nn - iro(irl) + 2
         ic1 = ico(1) - lb(1)
         ic2 = ico(2) - lb(2)
         n11 = (iro(irl+1)+1)*(ic1+1)/nn1
         n12 = iro(irl+1) - n11
         v   = v + fact(n11) + fact(n12) + fact(ic1-n11) +
     &         fact(ic2-n12)
         if (v .lt. vmn) vmn = v
      else
c                                  Column marginals are new node
         do 140  i=1, nco
            it(i) = ico(i) - lb(i)
  140    continue
c                                  Sort column marginals
         if (nco .eq. 2) then
            if (it(1) .gt. it(2)) then
               ii    = it(1)
               it(1) = it(2)
               it(2) = ii
            end if
         else if (nco .eq. 3) then
            ii = it(1)
            if (ii .gt. it(3)) then
               if (ii .gt. it(2)) then
                  if (it(2) .gt. it(3)) then
                     it(1) = it(3)
                     it(3) = ii
                  else
                     it(1) = it(2)
                     it(2) = it(3)
                     it(3) = ii
                  end if
               else
                  it(1) = it(3)
                  it(3) = it(2)
                  it(2) = ii
               end if
            else if (ii .gt. it(2)) then
               it(1) = it(2)
               it(2) = ii
            else if (it(2) .gt. it(3)) then
               ii    = it(2)
               it(2) = it(3)
               it(3) = ii
            end if
         else
            call isort (nco, it)
         end if
c                                  Compute hash value
         key = it(1)*kyy + it(2)
         do 150  i=3, nco
            key = it(i) + key*kyy
  150    continue
c                                  Table index
         ipn = mod(key,ldst) + 1
c                                  Find empty position
         ii = ks + ipn
         do 160  itp=ipn, ldst
            if (ist(ii) .lt. 0) then
               go to 180
            else if (ist(ii) .eq. key) then
               go to 190
            end if
            ii = ii + 1
  160    continue
c
         ii = ks + 1
         do 170  itp=1, ipn - 1
            if (ist(ii) .lt. 0) then
               go to 180
            else if (ist(ii) .eq. key) then
               go to 190
            end if
            ii = ii + 1
  170    continue
c
CCCCC    call prterr (30, 'Stack length exceeded in f3xact.'//
CCCCC&               '  This problem should not occur.')
         WRITE(ICOUT,999)
  999    FORMAT(1X)
         CALL DPWRST('XXX','BUG ')
         WRITE(ICOUT,9011)
 9011    FORMAT('***** ERROR IN R3XACT--')
         CALL DPWRST('XXX','BUG ')
         WRITE(ICOUT,9013)
 9013    FORMAT('      Stack length exceeded in f3xact.  This ',
     1          'problem should not occur.')
         CALL DPWRST('XXX','BUG ')
c                                  Push onto stack
  180    ist(ii) = key
         stv(ii) = v
         nst     = nst + 1
         ii      = nst + ks
         itc(ii) = itp
         go to 110
c                                  Marginals already on stack
  190    stv(ii) = dmin1(v,stv(ii))
      end if
      go to 110
c                                  Pop item from stack
  200 if (nitc .gt. 0) then
c                                  Stack index
         itp      = itc(nitc+k) + k
         nitc     = nitc - 1
         val      = stv(itp)
         key      = ist(itp)
         ist(itp) = -1
c                                  Compute marginals
         do 210  i=nco, 2, -1
            ico(i) = mod(key,kyy)
            key    = key/kyy
  210    continue
         ico(1) = key
c                                  Set up nt array
         nt(1) = nn - ico(1)
         do 220  i=2, nco
            nt(i) = nt(i-1) - ico(i)
  220    continue
         go to 90
c
      else if (nro.gt.2 .and. nst.gt.0) then
c                                  Go to next level
         nitc = nst
         nst  = 0
         k    = ks
         ks   = ldst - ks
         nn   = nn - iro(irl)
         irl  = irl + 1
         nro  = nro - 1
         go to 200
      end if
c
      dlp = dlp - vmn
 9000 return
      end
      subroutine f4xact (nrow, irow, ncol, icol, dsp, fact, icstk,
     &                   ncstk, lstk, mstk, nstk, nrstk, irstk, ystk,
     &                   tol)
c-----------------------------------------------------------------------
c  Name:       F4XACT
c
c  Purpose:    Computes the longest path length for a given table.
c
c  Usage:      CALL F4XACT (NROW, IROW, NCOL, ICOL, DSP, FACT, ICSTK,
c                          NCSTK, LSTK, MSTK, NSTK, NRSTK, IRSTK, YSTK,
c                          TOL)
c
c  Arguments:
c     NROW   - The number of rows in the table.  (Input)
c     IROW   - Vector of length NROW containing the row sums for the
c              table.  (Input)
c     NCOL   - The number of columns in the table.  (Input)
c     ICOL   - Vector of length K containing the column sums for the
c              table.  (Input)
c     DSP    - The shortest path for the table.  (Output)
c     FACT   - Vector containing the logarithms of factorials.  (Input)
c     ICSTK  - NCOL by NROW+NCOL+1 work array.
c     NCSTK  - Work vector of length NROW+NCOL+1.
c     LSTK   - Work vector of length NROW+NCOL+1.
c     MSTK   - Work vector of length NROW+NCOL+1.
c     NSTK   - Work vector of length NROW+NCOL+1.
c     NRSTK  - Work vector of length NROW+NCOL+1.
c     IRSTK  - NROW by MAX(NROW,NCOL) work array.
c     YSTK   - Work vector of length NROW+NCOL+1.
c     TOL    - Tolerance.  (Input)
c-----------------------------------------------------------------------
c                                  SPECIFICATIONS FOR ARGUMENTS
      integer    nrow, ncol, irow(*), icol(*), icstk(ncol,*),
     &           ncstk(*), lstk(*), mstk(*), nstk(*), nrstk(*),
     &           irstk(nrow,*)
      double precision dsp, tol, fact(0:*), ystk(*)
c                                  SPECIFICATIONS FOR LOCAL VARIABLES
      integer    i, ic1, ict, ir1, irt, istk, j, k, l, m, mn, n, nco,
     &           nro
      double precision amx, y
c                                  SPECIFICATIONS FOR SUBROUTINES
      external   f11act, f8xact
c                                  Take care of the easy cases firstkt
      if (nrow .eq. 1) then
         do 10  i=1, ncol
            dsp = dsp - fact(icol(i))
   10    continue
         go to 9000
      end if
c
      if (ncol .eq. 1) then
         do 20  i=1, nrow
            dsp = dsp - fact(irow(i))
   20    continue
         go to 9000
      end if
c
      if (nrow*ncol .eq. 4) then
         if (irow(2) .le. icol(2)) then
            dsp = dsp - fact(irow(2)) - fact(icol(1)) -
     &            fact(icol(2)-irow(2))
         else
            dsp = dsp - fact(icol(2)) - fact(irow(1)) -
     &            fact(irow(2)-icol(2))
         end if
         go to 9000
      end if
c                                  initialization before loop
      do 30  i=1, nrow
         irstk(i,1) = irow(nrow-i+1)
   30 continue
c
      do 40  j=1, ncol
         icstk(j,1) = icol(ncol-j+1)
   40 continue
c
      nro      = nrow
      nco      = ncol
      nrstk(1) = nro
      ncstk(1) = nco
      ystk(1)  = 0.0
      y        = 0.0
      istk     = 1
      l        = 1
      amx      = 0.0
c
   50 ir1 = irstk(1,istk)
      ic1 = icstk(1,istk)
      if (ir1 .gt. ic1) then
         if (nro .ge. nco) then
            m = nco - 1
            n = 2
         else
            m = nro
            n = 1
         end if
      else if (ir1 .lt. ic1) then
         if (nro .le. nco) then
            m = nro - 1
            n = 1
         else
            m = nco
            n = 2
         end if
      else
         if (nro .le. nco) then
            m = nro - 1
            n = 1
         else
            m = nco - 1
            n = 2
         end if
      end if
c
   60 if (n .eq. 1) then
         i = l
         j = 1
      else
         i = 1
         j = l
      end if
c
      irt = irstk(i,istk)
      ict = icstk(j,istk)
      mn  = irt
      if (mn .gt. ict) mn = ict
      y = y + fact(mn)
      if (irt .eq. ict) then
         nro = nro - 1
         nco = nco - 1
         call f11act (irstk(1,istk), i, nro, irstk(1,istk+1))
         call f11act (icstk(1,istk), j, nco, icstk(1,istk+1))
      else if (irt .gt. ict) then
         nco = nco - 1
         call f11act (icstk(1,istk), j, nco, icstk(1,istk+1))
         call f8xact (irstk(1,istk), irt-ict, i, nro, irstk(1,istk+1))
      else
         nro = nro - 1
         call f11act (irstk(1,istk), i, nro, irstk(1,istk+1))
         call f8xact (icstk(1,istk), ict-irt, j, nco, icstk(1,istk+1))
      end if
c
      if (nro .eq. 1) then
         do 70  k=1, nco
            y = y + fact(icstk(k,istk+1))
   70    continue
         go to 90
      end if
c
      if (nco .eq. 1) then
         do 80  k=1, nro
            y = y + fact(irstk(k,istk+1))
   80    continue
         go to 90
      end if
c
      lstk(istk)  = l
      mstk(istk)  = m
      nstk(istk)  = n
      istk        = istk + 1
      nrstk(istk) = nro
      ncstk(istk) = nco
      ystk(istk)  = y
      l           = 1
      go to 50
c
   90 if (y .gt. amx) then
         amx = y
         if (dsp-amx .le. tol) then
            dsp = 0.0
            go to 9000
         end if
      end if
c
  100 istk = istk - 1
      if (istk .eq. 0) then
         dsp = dsp - amx
         if (dsp-amx .le. tol) dsp = 0.0
         go to 9000
      end if
      l = lstk(istk) + 1
c
  110 if (l .gt. mstk(istk)) go to 100
      n   = nstk(istk)
      nro = nrstk(istk)
      nco = ncstk(istk)
      y   = ystk(istk)
      if (n .eq. 1) then
         if (irstk(l,istk) .lt. irstk(l-1,istk)) go to 60
      else if (n .eq. 2) then
         if (icstk(l,istk) .lt. icstk(l-1,istk)) go to 60
      end if
c
      l = l + 1
      go to 110
 9000 return
      end
      subroutine f5xact (pastp, tol, kval, key, ldkey, ipoin, stp,
     &                   ldstp, ifrq, npoin, nr, nl, ifreq, itop, ipsh)
c-----------------------------------------------------------------------
c  Name:       F5XACT
c
c  Purpose:    Put node on stack in network algorithm.
c
c  Usage:      CALL F5XACT (PASTP, TOL, KVAL, KEY, LDKEY, IPOIN, STP,
c                          LDSTP, IFRQ, NPOIN, NR, NL, IFREQ, ITOP,
c                          IPSH)
c
c  Arguments:
c     PASTP  - The past path length.  (Input)
c     TOL    - Tolerance for equivalence of past path lengths.  (Input)
c     KVAL   - Key value.  (Input)
c     KEY    - Vector of length LDKEY containing the key values.
c              (Input/output)
c     LDKEY  - Length of vector KEY.  (Input)
c     IPOIN  - Vector of length LDKEY pointing to the linked list
c              of past path lengths.  (Input/output)
c     STP    - Vector of length LSDTP containing the linked lists
c              of past path lengths.  (Input/output)
c     LDSTP  - Length of vector STP.  (Input)
c     IFRQ   - Vector of length LDSTP containing the past path
c              frequencies.  (Input/output)
c     NPOIN  - Vector of length LDSTP containing the pointers to
c              the next past path length.  (Input/output)
c     NR     - Vector of length LDSTP containing the right object
c              pointers in the tree of past path lengths.
c              (Input/output)
c     NL     - Vector of length LDSTP containing the left object
c              pointers in the tree of past path lengths.
c              (Input/output)
c     IFREQ  - Frequency of the current path length.  (Input)
c     ITOP   - Pointer to the top of STP.  (Input)
c     IPSH   - Option parameter.  (Input)
c              If IPSH is true, the past path length is found in the
c              table KEY.  Otherwise the location of the past path
c              length is assumed known and to have been found in
c              a previous call.
c-----------------------------------------------------------------------
c                                  SPECIFICATIONS FOR ARGUMENTS
      integer    kval, ldkey, ldstp, ifreq, itop, key(*), ipoin(*),
     &           ifrq(*), npoin(*), nr(*), nl(*)
      double precision pastp, tol, stp(*)
      logical    ipsh
c                                  SPECIFICATIONS FOR LOCAL VARIABLES
      integer    ipn, irdzz, itmp
      double precision test1, test2
c                                  SPECIFICATIONS FOR SAVE VARIABLES
      integer    itp
      save       itp
c                                  SPECIFICATIONS FOR INTRINSICS
      intrinsic  mod
ccccc integer    mod
c                                  SPECIFICATIONS FOR SUBROUTINES
ccccc external   prterr
c
      INCLUDE 'DPCOP2.INC'
C
      if (ipsh) then
c                                  Convert KVAL to integer in range
c                                  1, ..., LDKEY.
         irdzz = mod(kval,ldkey) + 1
c                                  Search for an unused location
         do 10  itp=irdzz, ldkey
            if (key(itp) .eq. kval) go to 40
            if (key(itp) .lt. 0) go to 30
   10    continue
c
         do 20  itp=1, irdzz - 1
            if (key(itp) .eq. kval) go to 40
            if (key(itp) .lt. 0) go to 30
   20    continue
c                                  Return if KEY array is full
CCCCC    call prterr(6, 'LDKEY is too small for this problem.  It is '//
CCCCC&               'not possible to estimate the value of LDKEY '//
CCCCC&               'required, but twice the current value may be '//
CCCCC&               'sufficient.')
      WRITE(ICOUT,999)
  999 FORMAT(1X)
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9011)
 9011 FORMAT('***** ERROR IN FISHER EXACT TEST.')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9013)
 9013 FORMAT('      LDKEY is too small for this proble,.  It is not')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9015)
 9015 FORMAT('      possible to estimate the value of LDKEY required,')
      CALL DPWRST('XXX','BUG ')
      WRITE(ICOUT,9017)
 9017 FORMAT('      possible to estimate the value of LDKEY required,')
      CALL DPWRST('XXX','BUG ')
c                                  Update KEY
   30    key(itp) = kval
         itop       = itop + 1
         ipoin(itp) = itop
c                                  Return if STP array full
         if (itop .gt. ldstp) then
CCCCC       call prterr(7, 'LDSTP is too small for this problem.  It '//
CCCCC&                  'is not possible to estimate the value of '//
CCCCC&                  'LDSTP required, but twice the current value '//
CCCCC&                  'may be sufficient.')
            WRITE(ICOUT,999)
            CALL DPWRST('XXX','BUG ')
            WRITE(ICOUT,9111)
            CALL DPWRST('XXX','BUG ')
            WRITE(ICOUT,9113)
            CALL DPWRST('XXX','BUG ')
            WRITE(ICOUT,9115)
            CALL DPWRST('XXX','BUG ')
            WRITE(ICOUT,9117)
            CALL DPWRST('XXX','BUG ')
         end if
 9111 FORMAT('***** ERROR IN FISHER EXACT TEST.')
 9113 FORMAT('      LDSTP is too small for this problem.  It is not')
 9115 FORMAT('      possible to estimate the value of LDSTP required,')
 9117 FORMAT('      but twice the current value may be sufficient.')
c                                  Update STP, etc.
         npoin(itop) = -1
         nr(itop)    = -1
         nl(itop)    = -1
         stp(itop)   = pastp
         ifrq(itop)  = ifreq
         go to 9000
      end if
c                                  Find location, if any, of pastp
   40 ipn = ipoin(itp)
      test1 = pastp - tol
      test2 = pastp + tol
c
   50 if (stp(ipn) .lt. test1) then
         ipn = nl(ipn)
         if (ipn .gt. 0) go to 50
      else if (stp(ipn) .gt. test2) then
         ipn = nr(ipn)
         if (ipn .gt. 0) go to 50
      else
         ifrq(ipn) = ifrq(ipn) + ifreq
         go to 9000
      end if
c                                  Return if STP array full
      itop = itop + 1
      if (itop .gt. ldstp) then
ccccc    call prterr(7, 'LDSTP is too small for this problem.  It is '//
ccccc&               'not possible to estimate the value of LDSTP '//
ccccc&               'rerquired, but twice the current value may be '//
ccccc&               'sufficient.')
            WRITE(ICOUT,999)
            CALL DPWRST('XXX','BUG ')
            WRITE(ICOUT,9111)
            CALL DPWRST('XXX','BUG ')
            WRITE(ICOUT,9113)
            CALL DPWRST('XXX','BUG ')
            WRITE(ICOUT,9115)
            CALL DPWRST('XXX','BUG ')
            WRITE(ICOUT,9117)
            CALL DPWRST('XXX','BUG ')
         go to 9000
      end if
c                                  Find location to add value
      ipn  = ipoin(itp)
      itmp = ipn
   60 if (stp(ipn) .lt. test1) then
         itmp = ipn
         ipn  = nl(ipn)
         if (ipn .gt. 0) then
            go to 60
         else
            nl(itmp) = itop
         end if
      else if (stp(ipn) .gt. test2) then
         itmp = ipn
         ipn  = nr(ipn)
         if (ipn .gt. 0) then
            go to 60
         else
            nr(itmp) = itop
         end if
      end if
c                                  Update STP, etc.
      npoin(itop) = npoin(itmp)
      npoin(itmp) = itop
      stp(itop)   = pastp
      ifrq(itop)  = ifreq
      nl(itop)    = -1
      nr(itop)    = -1
c
 9000 return
      end
      subroutine f6xact (nrow, irow, iflag, kyy, key, ldkey, last, ipn)
c-----------------------------------------------------------------------
c  Name:       F6XACT
c
c  Purpose:    Pop a node off the stack.
c
c  Usage:      CALL F6XACT (NROW, IROW, IFLAG, KYY, KEY, LDKEY, LAST,
c                          IPN)
c
c  Arguments:
c     NROW   - The number of rows in the table.  (Input)
c     IROW   - Vector of length nrow containing the row sums on output.
c              (Output)
c     IFLAG  - Set to 3 if there are no additional nodes to process.
c              (Output)
c     KYY    - Constant mutlipliers used in forming the hash table key.
c              (Input)
c     KEY    - Vector of length LDKEY containing the hash table keys.
c              (Input/output)
c     LDKEY  - Length of vector KEY.  (Input)
c     LAST   - Index of the last key popped off the stack.
c              (Input/output)
c     IPN    - Pointer to the linked list of past path lengths.
c              (Output)
c-----------------------------------------------------------------------
c                                  SPECIFICATIONS FOR ARGUMENTS
      integer    nrow, iflag, ldkey, last, ipn, irow(*), kyy(*), key(*)
c                                  SPECIFICATIONS FOR LOCAL VARIABLES
      integer    j, kval
c                                  SPECIFICATIONS FOR SAVE VARIABLES
c
   10 last = last + 1
      if (last .le. ldkey) then
         if (key(last) .lt. 0) go to 10
c                                  Get KVAL from the stack
         kval      = key(last)
         key(last) = -9999
         do 20  j=nrow, 2, -1
            irow(j) = kval/kyy(j)
            kval    = kval - irow(j)*kyy(j)
   20    continue
         irow(1) = kval
         ipn     = last
      else
         last  = 0
         iflag = 3
      end if
      return
      end
      subroutine f7xact (nrow, imax, idif, k, ks, iflag)
c-----------------------------------------------------------------------
c  Name:       F7XACT
c
c  Purpose:    Generate the new nodes for given marinal totals.
c
c  Usage:      CALL F7XACT (NROW, IMAX, IDIF, K, KS, IFLAG)
c
c  Arguments:
c     NROW   - The number of rows in the table.  (Input)
c     IMAX   - The row marginal totals.  (Input)
c     IDIF   - The column counts for the new column.  (Input/output)
c     K      - Indicator for the row to decrement.  (Input/output)
c     KS     - Indicator for the row to increment.  (Input/output)
c     IFLAG  - Status indicator.  (Output)
c              If IFLAG is zero, a new table was generated.  For
c              IFLAG = 1, no additional tables could be generated.
c-----------------------------------------------------------------------
c                                  SPECIFICATIONS FOR ARGUMENTS
      integer    nrow, k, ks, iflag, imax(*), idif(*)
c                                  SPECIFICATIONS FOR LOCAL VARIABLES
      integer    i, k1, m, mm
c                                  SPECIFICATIONS FOR INTRINSICS
      intrinsic  min0
ccccc integer    min0
c
      iflag = 0
c                                  Find node which can be
c                                  incremented, ks
      if (ks .eq. 0) then
   10    ks = ks + 1
         if (idif(ks) .eq. imax(ks)) go to 10
      end if
c                                 Find node to decrement (>ks)
      if (idif(k).gt.0 .and. k.gt.ks) then
         idif(k) = idif(k) - 1
   30    k = k - 1
         if (imax(k) .eq. 0) go to 30
         m = k
c                                 Find node to increment (>=ks)
   40    if (idif(m) .ge. imax(m)) then
            m = m - 1
            go to 40
         end if
         idif(m) = idif(m) + 1
c                                 Change ks
         if (m .eq. ks) then
            if (idif(m) .eq. imax(m)) ks = k
         end if
      else
c                                 Check for finish
   50    do 60  k1=k + 1, nrow
            if (idif(k1) .gt. 0) go to 70
   60    continue
         iflag = 1
         go to 9000
c                                 Reallocate counts
   70    mm = 1
         do 80  i=1, k
            mm      = mm + idif(i)
            idif(i) = 0
   80    continue
         k = k1
   90    k = k - 1
         m       = min0(mm,imax(k))
         idif(k) = m
         mm      = mm - m
         if (mm.gt.0 .and. k.ne.1) go to 90
c                                 Check that all counts
c                                 reallocated
         if (mm .gt. 0) then
            if (k1 .ne. nrow) then
               k = k1
               go to 50
            end if
            iflag = 1
            go to 9000
         end if
c                                 Get ks
         idif(k1) = idif(k1) - 1
         ks       = 0
  100    ks = ks + 1
         if (ks .gt. k) go to 9000
         if (idif(ks) .ge. imax(ks)) go to 100
      end if
c
 9000 return
      end
      subroutine f8xact (irow, is, i1, izero, new)
c-----------------------------------------------------------------------
c  Name:       F8XACT
c
c  Purpose:    Routine for reducing a vector when there is a zero
c              element.
c
c  Usage:      CALL F8XACT (IROW, IS, I1, IZERO, NEW)
c
c  Arguments:
c     IROW   - Vector containing the row counts.  (Input)
c     IS     - Indicator.  (Input)
c     I1     - Indicator.  (Input)
c     IZERO  - Position of the zero.  (Input)
c     NEW    - Vector of new row counts.  (Output)
c-----------------------------------------------------------------------
c                                  SPECIFICATIONS FOR ARGUMENTS
      integer    is, i1, izero, irow(*), new(*)
c                                  SPECIFICATIONS FOR LOCAL VARIABLES
      integer    i
c
      do 10  i=1, i1 - 1
         new(i) = irow(i)
   10 continue
c
      do 20  i=i1, izero - 1
         if (is .ge. irow(i+1)) go to 30
         new(i) = irow(i+1)
   20 continue
c
      i = izero
   30 new(i) = is
   40 i = i + 1
      if (i .gt. izero) return
      new(i) = irow(i)
      go to 40
      end
      double precision function f9xact (n, mm, ir, fact)
c-----------------------------------------------------------------------
c  Name:       F9XACT
c
c  Purpose:    Computes the log of a multinomial coefficient.
c
c  Usage:      F9XACT(N, MM, IR, FACT)
c
c  Arguments:
c     N      - Length of IR.  (Input)
c     MM     - Number for factorial in numerator.  (Input)
c     IR     - Vector of length N containing the numebers for the
c              denominator of the factorial.  (Input)
c     FACT   - Table of log factorials.  (Input)
c     F9XACT  - The log of the multinomal coefficient.  (Output)
c-----------------------------------------------------------------------
c                                  SPECIFICATIONS FOR ARGUMENTS
      integer    n, mm, ir(*)
      double precision fact(0:*)
c                                  SPECIFICATIONS FOR LOCAL VARIABLES
      integer    k
c
      f9xact = fact(mm)
      do 10  k=1, n
         f9xact = f9xact - fact(ir(k))
   10 continue
c
      return
      end
      subroutine f10act (nrow, irow, ncol, icol, val, xmin, fact, nd,
     &                   ne, m)
c----------------------------------------------------------------------
c  Name:       F10ACT
c
c  Purpose:    Computes the shortest path length for special tables.
c
c  Usage:      CALL F10ACT(NROW, IROW, NCOL, ICOL, VAL, XMIN, FACT, ND,
c                          NE, M)
c
c  Arguments:
c     NROW   - The number of rows in the table.  (Input)
c     IROW   - Vector of length NROW containing the row totals. (Input)
c     NCOL   - The number of columns in the table.  (Input)
c     ICO    - Vector of length NCOL containing the column totals.
c              (Input)
c     VAL    - The shortest path.  (Output)
c     XMIN   - Set to true if shortest path obtained.  (Output)
c     FACT   - Vector containing the logarithms of factorials.
c              (Input)
c     ND     - Workspace vector of length NROW.
c     NE     - Workspace vector of length NCOL.
c     M      - Workspace vector of length NCOL.
c
c  Chapter:    STAT/LIBRARY Categorical and Discrete Data Analysis
c----------------------------------------------------------------------
c                                  SPECIFICATIONS FOR ARGUMENTS
      integer    nrow, ncol, irow(*), icol(*), nd(*), ne(*), m(*)
      double precision val, fact(0:*)
      logical    xmin
c                                  SPECIFICATIONS FOR LOCAL VARIABLES
      integer    i, is, ix, nrw1
c
      do 10  i=1, nrow - 1
         nd(i) = 0
   10 continue
c
      is    = icol(1)/nrow
      ne(1) = is
      ix    = icol(1) - nrow*is
      m(1)  = ix
      if (ix .ne. 0) nd(ix) = nd(ix) + 1
c
      do 20  i=2, ncol
         ix    = icol(i)/nrow
         ne(i) = ix
         is    = is + ix
         ix    = icol(i) - nrow*ix
         m(i)  = ix
         if (ix .ne. 0) nd(ix) = nd(ix) + 1
   20 continue
c
      do 30  i=nrow - 2, 1, -1
         nd(i) = nd(i) + nd(i+1)
   30 continue
c
      ix   = 0
      nrw1 = nrow + 1
      do 40  i=nrow, 2, -1
         ix = ix + is + nd(nrw1-i) - irow(i)
         if (ix .lt. 0) return
   40 continue
c
      do 50  i=1, ncol
         ix  = ne(i)
         is  = m(i)
         val = val + is*fact(ix+1) + (nrow-is)*fact(ix)
   50 continue
      xmin = .true.
c
      return
      end
      subroutine f11act (irow, i1, i2, new)
c---------------------------------------------------------------------
c  Name:       F11ACT
c
c  Purpose:    Routine for revising row totals.
c
c  Usage:      CALL F11ACT (IROW, I1, I2, NEW)
c
c  Arguments:
c     IROW   - Vector containing the row totals.  (Input)
c     I1     - Indicator.  (Input)
c     I2     - Indicator.  (Input)
c     NEW    - Vector containing the row totals.  (Input)
c----------------------------------------------------------------------
c                                  SPECIFICATIONS FOR ARGUMENTS
      integer    i1, i2, irow(*), new(*)
c                                  SPECIFICATIONS FOR LOCAL VARIABLES
      integer    i
c
      do 10  i=1, i1 - 1
         new(i) = irow(i)
   10 continue
c
      do 20  i=i1, i2
         new(i) = irow(i+1)
   20 continue
c
      return
      end
      double precision function ff (x)
c
c     NOTE: This subroutine used in computing the consensus mean
c           using the Iyer and Wang generalized tolerance interval
c           approach.
c
c           Modified for Dataplot 3/2006.
c
c           Modified for Dataplot 4/2021.
c
c           1) Allow maximum of 1,000 labs
c
      implicit none
c
      double precision  x
c
      integer kk
ccccc double precision aa, ybar, cc, bb(100), yy(100)
      double precision aa, ybar, cc, bb(1000), yy(1000)
      common /cmn1/ kk
      common /cmn2/ aa, ybar, cc, bb, yy
c
      integer i
      double precision s1, s2, s3, s4, s5, tmp
c
      if (x .le. 0.0d0) then
          ff = aa - cc
          return
      end if
c
      s1 = 0.0d0
      s2 = 0.0d0
      s3 = 0.0d0
      s4 = 0.0d0
      s5 = 0.0d0
c
      do 10 i = 1, kk
         tmp = x + bb(i)
         s1 = s1 + yy(i)**2/tmp
         s2 = s2 + yy(i)/tmp
         s3 = s3 + 1.0d0/tmp
         s4 = s4 + yy(i)*bb(i)/tmp
         s5 = s5 + bb(i)/tmp
   10 continue
c
      ff = s1 - 2.0d0*ybar*s2 + ybar**2 * s3 - (s4 - ybar*s5)**2/
     1     (x * (kk - s5)) - cc
c
      return
      end
      SUBROUTINE FACCUR(H0,H1,FACC,X0,F,TWOINF,F0,F1)
      REAL H0,H1,FACC,A0,A1,F00,F2,DELTAF,T0,T1,X0,F,DF(5),F0,F1
     +        ,TWOINF
      INTEGER J
      EXTERNAL F
C
      INCLUDE 'DPCOMC.INC'
      INCLUDE 'DPCOP2.INC'
C
      T0 = 0.
      T1 = 0.
      IF(H0.NE.0.) THEN
          IF(X0+H0.NE.0.) THEN
              F00 = F1
          ELSE
              H0 = 0.875*H0
              F00 = F(X0+H0)
          ENDIF
          IF(ABS(H1) .GE. 32.*TWOINF) H1 = H1/8.
          IF(16.*ABS(H1) .GT. ABS(H0)) H1 = SIGN(H1,1.)*ABS(H0)/16.
          IF(F(X0+H0-H1) .EQ. F00) THEN 
              IF(256.*ABS(H1) .LE. ABS(H0)) THEN
                  H1 = 2.*H1
   10             IF(F(X0+H0-H1).NE.F00 .OR. 256.*ABS(H1).GT.ABS(H0)) 
     +                    GOTO 20
                  H1 = 2.*H1
                  GOTO 10
   20             H1 = 8.*H1
  
              ELSE
                  H1 = SIGN(H1,1.)*ABS(H0)/16.
              ENDIF 
          ELSE
              IF(256.*TWOINF .LE. ABS(H0)) THEN
   30             IF(F(X0+H0-H1/2.).EQ.F00 .OR. ABS(H1).LT.4.*TWOINF) 
     +                GOTO 40 
                  H1 = H1/2.
                  GOTO 30
   40             CONTINUE
                  H1 = 8.*H1
                  IF(16.*ABS(H1) .GT. ABS(H0)) H1 = SIGN(H1,1.)
     +                     *ABS(H0)/16. 
              ELSE
                  H1 = SIGN(H1,1.)*ABS(H0)/16.
              ENDIF 
          ENDIF
      ELSE
          F00 = F0
      ENDIF
  
      DO 50 J = 1,5 
          F2 = F(X0+H0-FLOAT(2*J-1)*H1) 
          DF(J) = F2 - F00
          T0 = T0+DF(J)
          T1 = T1+FLOAT(2*J-1)*DF(J)
   50 CONTINUE
      A0 = (33.*T0-5.*T1)/73. 
      A1 = (-5.*T0+1.2*T1)/73.
      FACC = ABS(A0)
      DO 70 J = 1,5 
          DELTAF = ABS(DF(J)-(A0+FLOAT(2*J-1)*A1))
          IF(FACC.LT.DELTAF) FACC = DELTAF
   70 CONTINUE
      FACC = 2.*FACC
      RETURN
      END 
      subroutine fastg(xreal, ximag, n, itype)
c
c       Algorithm AS 83.2 Appl. Statist. (1975) vol.24, no.1
c
c       Radix 4 complex discrete fast Fourier transform without
c       unscrambling, suitable for convolutions or other applications
c       which do not require unscrambling.   Called by subroutine
c       FASTF which also does the unscrambling.
c
        implicit double precision (A-H, O-Z)
      double precision  xreal(n), ximag(n)
      data    zero, half, one, one5, two, four
     +          /0.0D0,  0.5D0, 1.0D0,  1.5D0, 2.0D0,  4.0D0/
c
      sw2=0.0d0
      sw3=0.0d0
      cw3=0.0d0
      cw2=0.0d0
c
      pi = four * atan(one)
      ifaca = n / 4
      if (itype .eq. 0) return
      if (itype .gt. 0) go to 5
c
c       ITYPE < 0 indicates inverse transform required.
c       Calculate conjugate.
c
      do 4 k = 1, n
        ximag(k) = -ximag(k)
    4 continue
c
c       Following code is executed for IFACA = N/4, N/16, N/64, ...
c       until IFACA <= 1.
c
    5   ifcab = ifaca * 4
      z = pi / ifcab
      bcos = -two * sin(z)**2
      bsin = sin(two * z)
      cw1 = one
      sw1 = zero
      do 10 litla = 1, ifaca
        do 8 i0 = litla, n, ifcab
          i1 = i0 + ifaca
          i2 = i1 + ifaca
          i3 = i2 + ifaca
          xs0 = xreal(i0) + xreal(i2)
          xs1 = xreal(i0) - xreal(i2)
          ys0 = ximag(i0) + ximag(i2)
          ys1 = ximag(i0) - ximag(i2)
          xs2 = xreal(i1) + xreal(i3)
          xs3 = xreal(i1) - xreal(i3)
          ys2 = ximag(i1) + ximag(i3)
          ys3 = ximag(i1) - ximag(i3)
          xreal(i0) = xs0 + xs2
          ximag(i0) = ys0 + ys2
          x1 = xs1 + ys3
          y1 = ys1 - xs3
          x2 = xs0 - xs2
          y2 = ys0 - ys2
          x3 = xs1 - ys3
          y3 = ys1 + xs3
          if (litla .eq. 1) then
            xreal(i2) = x1
            ximag(i2) = y1
            xreal(i1) = x2
            ximag(i1) = y2
            xreal(i3) = x3
            ximag(i3) = y3
          else
            xreal(i2) = x1 * cw1 + y1 * sw1
            ximag(i2) = y1 * cw1 - x1 * sw1
            xreal(i1) = x2 * cw2 + y2 * sw2
            ximag(i1) = y2 * cw2 - x2 * sw2
            xreal(i3) = x3 * cw3 + y3 * sw3
            ximag(i3) = y3 * cw3 - x3 * sw3
          end if
    8     continue
c
c       Calculate a new set of twiddle factors.
c
        if (litla .lt. ifaca) then
          z = cw1 * bcos - sw1 * bsin + cw1
          sw1 = bcos * sw1 + bsin * cw1 + sw1
          tempr = one5 - half * (z * z + sw1 * sw1)
          cw1 = z * tempr
          sw1 = sw1 * tempr
          cw2 = cw1 * cw1 - sw1 * sw1
          sw2 = two * cw1 * sw1
          cw3 = cw1 * cw2 - sw1 * sw2
          sw3 = cw1 * sw2 + cw2 * sw1
        end if
   10   continue
      if (ifaca .le. 1) go to 14
c
c       Set up the transform split for the next stage.
c
      ifaca = ifaca / 4
      if (ifaca .gt. 0) go to 5
c
c       Radix 2 calculation, if needed.
c
      if (ifaca .lt. 0) return
      do 13 k = 1, n, 2
        tempr = xreal(k) + xreal(k+1)
        xreal(k+1) = xreal(k) - xreal(k+1)
        xreal(k) = tempr
        tempr = ximag(k) + ximag(k+1)
        ximag(k+1) = ximag(k) - ximag(k+1)
        ximag(k) = tempr
   13   continue
   14   if (itype .lt. 0) then
c
c       Inverse transform; conjugate the result.
c
        do 16 k = 1, n
          ximag(k) = -ximag(k)
   16   continue
        return
      end if
c
c       Forward transform
c
      z = one / n
      do 18 k = 1, n
        xreal(k) = xreal(k) * z
        ximag(k) = ximag(k) * z
   18   continue
c
      return
      end
      SUBROUTINE FORRT(X, M)
C
C     ALGORITHM AS 97  APPL. STATIST. (1976) VOL.25, NO. 2
C
C     Forward discrete Fourier transform in one dimension of real
C     data using complex transform subroutine FASTG.
C
C     X = array of real input data, type real, dimension M.
C     M = length of the transform, must be a power of 2.
C     The minimum length is 8, maximum 2**21.
C
C     The result is placed in X as described in the text of the paper.
C
C     Auxiliary routines required: SCRAG (or SCRAM) & FASTG from AS 83,
C     but with SCRAG modified as described on page 168 of the paper for
C     this algorithm.
C
      IMPLICIT DOUBLE PRECISION (A-H, O-Z)
      DOUBLE PRECISION X(M)
      DATA ZERO/0.0D0/, QUART/0.25D0/, HALF/0.5D0/, ONE/1.0D0/,
     *  ONE5/1.5D0/, TWO/2.0D0/, FOUR/4.0D0/
C
C     Check for valid transform size.
C
      II = 8
      DO 2 K = 3, 21
      IPOW = K
      IF (II .EQ. M) GO TO 3
      II = II * 2
    2 CONTINUE
C
C     If this point is reached, an illegal size was specified.
C
      RETURN
    3 PIE = FOUR * ATAN(ONE)
C
C     Separate odd and even parts into two halves.
C     First bit reverse the whole array of length M.
C
      CALL SCRAG(X, M, IPOW)
C
C     Next bit reverse the half arrays separately.
C
      N = M / 2
      JPOW = IPOW - 1
      CALL SCRAG(X, N, JPOW)
      CALL SCRAG(X(N+1), N, JPOW)
C
C     Faster alternative to the two lines above to SCRAM.
C           CALL SCRAM(X, X(N+1), N, JPOW)
C
C     Now do the transform.
C
      CALL FASTG(X, X(N+1), N, 1)
C
C     Unscramble the transform results.
C
      CALL SCRAG(X, N, JPOW)
      CALL SCRAG(X(N+1), N, JPOW)
C
C     Faster alternative to the two lines above to SCRAM.
C           CALL SCRAM(X, X(N+1), N, JPOW)
C
      NN = N / 2
C
C     Now unravel the result; first the special cases.
C
      Z = HALF * (X(1) + X(N+1))
      X(N+1) = HALF * (X(1) - X(N+1))
      X(1) = Z
      NN1 = NN + 1
      NN2 = NN1 + N
      X(NN1) = HALF * X(NN1)
      X(NN2) = -HALF * X(NN2)
      Z = PIE / N
      BCOS = -TWO * (SIN(Z / TWO) **2)
      BSIN = SIN(Z)
      UN = ONE
      VN = ZERO
      DO 4 K = 2, NN
      Z = UN * BCOS + VN * BSIN + UN
      VN = VN * BCOS - UN * BSIN + VN
      SAVE1 = ONE5 - HALF * (Z * Z + VN * VN)
      UN = Z * SAVE1
      VN = VN * SAVE1
      KI = N + K
      L = N + 2 - K
      LI = N + L
      AN = QUART * (X(K) + X(L))
      BN = QUART * (X(KI) - X(LI))
      CN = QUART * (X(KI) + X(LI))
      DN = QUART * (X(L) - X(K))
      XN = UN * CN - VN * DN
      YN = UN * DN + VN * CN
      X(K) = AN + XN
      X(KI) = BN + YN
      X(L) = AN - XN
      X(LI) = YN - BN
    4 CONTINUE
      RETURN
      END
      DOUBLE PRECISION FUNCTION FULSUM(S, CENTER, HWIDTH, X, G, F)
*
****  To compute fully symmetric basic rule sum
*
      EXTERNAL F
      INTEGER S, IXCHNG, LXCHNG, I, L
      DOUBLE PRECISION CENTER(S), HWIDTH(S), X(S), G(S), F
      DOUBLE PRECISION INTSUM, GL, GI
      FULSUM = 0
      LXCHNG = 0
*
*     Compute centrally symmetric sum for permutation of G
*
 10   INTSUM = 0
      DO 100 I = 1,S
         X(I) = CENTER(I) + G(I)*HWIDTH(I)
 100  CONTINUE
 20   INTSUM = INTSUM + F(S,X)
      DO 200 I = 1,S
         G(I) = -G(I)
         X(I) = CENTER(I) + G(I)*HWIDTH(I)
         IF ( G(I) .LT. 0 ) GO TO 20
 200  CONTINUE
      FULSUM = FULSUM + INTSUM
*     
*     Find next distinct permuation of G and loop back for next sum
*     
      DO 300 I = 2,S
         IF ( G(I-1) .GT. G(I) ) THEN
            GI = G(I)
            IXCHNG = I - 1
            DO 400 L = 1,(I-1)/2
               GL = G(L)
               G(L) = G(I-L)
               G(I-L) = GL
               IF (  GL  .LE. GI ) IXCHNG = IXCHNG - 1
               IF ( G(L) .GT. GI ) LXCHNG = L
  400       CONTINUE
            IF ( G(IXCHNG) .LE. GI ) IXCHNG = LXCHNG
            G(I) = G(IXCHNG)
            G(IXCHNG) = GI
            GO TO 10
         ENDIF
  300 CONTINUE
*     
*     End loop for permutations of G and associated sums
*     
*     Restore original order to G's
*     
      DO 500 I = 1,S/2
         GI = G(I)
         G(I) = G(S+1-I)
         G(S+1-I) = GI 
 500  CONTINUE
C
      RETURN
      END
      SUBROUTINE FZERO(F,B,C,R,RE,AE,IFLAG)
C
C   ADDED TO DATAPLOT 12/2003.  USE THIS ROUTINE FOR INTERNAL
C   COMPUTATIONS (THE ROOTS COMMAND IMPLEMENTS FOR USER DEFINED
C   FUNCTIONS).  THIS ROUTINE CAN BE MORE EFFICIENT FOR INTERNAL
C   USE SINCE WE CAN AVOID OVERHEAD OF FUNCTION PARSING, ETC.
C
C***BEGIN PROLOGUE  FZERO
C***DATE WRITTEN   700901   (YYMMDD)
C***REVISION DATE  860411   (YYMMDD)
C***CATEGORY NO.  F1B
C***KEYWORDS  BISECTION,NONLINEAR,ROOTS,ZEROS
C***AUTHOR  SHAMPINE,L.F.,SNLA
C           WATTS,H.A.,SNLA
C***PURPOSE  FZERO searches for a zero of a function F(X) in a given
C            interval (B,C).  It is designed primarily for problems
C            where F(B) and F(C) have opposite signs.
C***DESCRIPTION
C
C    From the book "Numerical Methods and Software"
C       by  D. Kahaner, C. Moler, S. Nash
C           Prentice Hall 1988
C
C     Based on a method by T J Dekker
C     written by L F Shampine and H A Watts
C
C            FZERO searches for a zero of a function F(X) between
C            the given values B and C until the width of the interval
C            (B,C) has collapsed to within a tolerance specified by
C            the stopping criterion, ABS(B-C) .LE. 2.*(RW*ABS(B)+AE).
C            The method used is an efficient combination of bisection
C            and the secant rule.
C
C     Description Of Arguments
C
C     F,B,C,R,RE and AE are input parameters
C     B,C and IFLAG are output parameters (flagged by an * below)
C
C        F     - Name of the real valued external function.  This name
C                must be in an EXTERNAL statement in the calling
C                program.  F must be a function of one real argument.
C
C       *B     - One end of the interval (B,C).  The value returned for
C                B usually is the better approximation to a zero of F.
C
C       *C     - The other end of the interval (B,C)
C
C        R     - A (better) guess of a zero of F which could help in
C                speeding up convergence.  If F(B) and F(R) have
C                opposite signs, a root will be found in the interval
C                (B,R); if not, but F(R) and F(C) have opposite
C                signs, a root will be found in the interval (R,C);
C                otherwise, the interval (B,C) will be searched for a
C                possible root.  When no better guess is known, it is
C                recommended that r be set to B or C; because if R is
C                not interior to the interval (B,C), it will be ignored.
C
C        RE    - Relative error used for RW in the stopping criterion.
C                If the requested RE is less than machine precision,
C                then RW is set to approximately machine precision.
C
C        AE    - Absolute error used in the stopping criterion.  If the
C                given interval (B,C) contains the origin, then a
C                nonzero value should be chosen for AE.
C
C       *IFLAG - A status code.  User must check IFLAG after each call.
C                Control returns to the user from FZERO in all cases.
C
C                1  B is within the requested tolerance of a zero.
C                   The interval (B,C) collapsed to the requested
C                   tolerance, the function changes sign in (B,C), and
C                   F(X) decreased in magnitude as (B,C) collapsed.
C
C                2  F(B) = 0.  However, the interval (B,C) may not have
C                   collapsed to the requested tolerance.
C
C                3  B may be near a singular point of F(X).
C                   The interval (B,C) collapsed to the requested tol-
C                   erance and the function changes sign in (B,C), but
C                   F(X) increased in magnitude as (B,C) collapsed,i.e.
C                     abs(F(B out)) .GT. max(abs(F(B in)),abs(F(C in)))
C
C                4  No change in sign of F(X) was found although the
C                   interval (B,C) collapsed to the requested tolerance.
C                   The user must examine this case and decide whether
C                   B is near a local minimum of F(X), or B is near a
C                   zero of even multiplicity, or neither of these.
C
C                5  Too many (.GT. 500) function evaluations used.
C***REFERENCES  L. F. SHAMPINE AND H. A. WATTS, *FZERO, A ROOT-SOLVING
C                 CODE*, SC-TM-70-631, SEPTEMBER 1970.
C               T. J. DEKKER, *FINDING A ZERO BY MEANS OF SUCCESSIVE
C                 LINEAR INTERPOLATION*, 'CONSTRUCTIVE ASPECTS OF THE
C                 FUNDAMENTAL THEOREM OF ALGEBRA', EDITED BY B. DEJON
C                 P. HENRICI, 1969.
C***ROUTINES CALLED  R1MACH
C***END PROLOGUE  FZERO
      REAL A,ACBS,ACMB,AE,AW,B,C,CMB,ER,FA,FB,FC,FX,FZ,P,Q,R
      REAL RE,RW,T,TOL,Z
      INTEGER IC,IFLAG,KOUNT
C
      INCLUDE 'DPCOMC.INC'
      INCLUDE 'DPCOP2.INC'
C
C     ER IS TWO TIMES THE COMPUTER UNIT ROUNDOFF VALUE WHICH IS
C     DEFINED HERE BY THE FUNCTION R1MACH.
C
C***FIRST EXECUTABLE STATEMENT  FZERO
      ER = 2.0E0 * R1MACH(4)
C
C     INITIALIZE
C
      Z=R
      IF(R.LE.AMIN1(B,C).OR.R.GE.AMAX1(B,C)) Z=C
      RW=AMAX1(RE,ER)
      AW=AMAX1(AE,0.0)
      IC=0
      T=Z
      FZ=F(T)
      FC=FZ
      T=B
      FB=F(T)
      KOUNT=2
      IF(SIGN(1.0E0,FZ).EQ.SIGN(1.0E0,FB)) GO TO 1
      C=Z
      GO TO 2
    1 IF(Z.EQ.C) GO TO 2
      T=C
      FC=F(T)
      KOUNT=3
      IF(SIGN(1.0E0,FZ).EQ.SIGN(1.0E0,FC)) GO TO 2
      B=Z
      FB=FZ
    2 A=C
      FA=FC
      ACBS=ABS(B-C)
      FX=AMAX1(ABS(FB),ABS(FC))
C
    3 IF (ABS(FC) .GE. ABS(FB)) GO TO 4
C     PERFORM INTERCHANGE
      A=B
      FA=FB
      B=C
      FB=FC
      C=A
      FC=FA
C
    4 CMB=0.5*(C-B)
      ACMB=ABS(CMB)
      TOL=RW*ABS(B)+AW
C
C     TEST STOPPING CRITERION AND FUNCTION COUNT
C
      IF (ACMB .LE. TOL) GO TO 10
      IF(FB.EQ.0.E0) GO TO 11
      IF(KOUNT.GE.500) GO TO 14
C
C     CALCULATE NEW ITERATE IMPLICITLY AS B+P/Q
C     WHERE WE ARRANGE P .GE. 0.
C     THE IMPLICIT FORM IS USED TO PREVENT OVERFLOW.
C
      P=(B-A)*FB
      Q=FA-FB
      IF (P .GE. 0.) GO TO 5
      P=-P
      Q=-Q
C
C     UPDATE A AND CHECK FOR SATISFACTORY REDUCTION
C     IN THE SIZE OF THE BRACKETING INTERVAL.
C     IF NOT, PERFORM BISECTION.
C
    5 A=B
      FA=FB
      IC=IC+1
      IF (IC .LT. 4) GO TO 6
      IF (8.*ACMB .GE. ACBS) GO TO 8
      IC=0
      ACBS=ACMB
C
C     TEST FOR TOO SMALL A CHANGE
C
    6 IF (P .GT. ABS(Q)*TOL) GO TO 7
C
C     INCREMENT BY TOLERANCE
C
      B=B+SIGN(TOL,CMB)
      GO TO 9
C
C     ROOT OUGHT TO BE BETWEEN B AND (C+B)/2.
C
    7 IF (P .GE. CMB*Q) GO TO 8
C
C     USE SECANT RULE
C
      B=B+P/Q
      GO TO 9
C
C     USE BISECTION
C
    8 B=0.5*(C+B)
C
C     HAVE COMPLETED COMPUTATION FOR NEW ITERATE B
C
    9 T=B
      FB=F(T)
      KOUNT=KOUNT+1
C
C     DECIDE WHETHER NEXT STEP IS INTERPOLATION OR EXTRAPOLATION
C
      IF (SIGN(1.0,FB) .NE. SIGN(1.0,FC)) GO TO 3
      C=A
      FC=FA
      GO TO 3
C
C
C     FINISHED. PROCESS RESULTS FOR PROPER SETTING OF IFLAG
C
   10 IF (SIGN(1.0,FB) .EQ. SIGN(1.0,FC)) GO TO 13
      IF (ABS(FB) .GT. FX) GO TO 12
      IFLAG = 1
      RETURN
   11 IFLAG = 2
      RETURN
   12 IFLAG = 3
      RETURN
   13 IFLAG = 4
      RETURN
   14 IFLAG = 5
      RETURN
      END
      SUBROUTINE FZEROY(F,B,C,R,RE,AE,IFLAG,XTEMP,YTEMP)
C
C   ADDED TO DATAPLOT 12/2003.  USE THIS ROUTINE FOR INTERNAL
C   COMPUTATIONS (THE ROOTS COMMAND IMPLEMENTS FOR USER DEFINED
C   FUNCTIONS).  THIS ROUTINE CAN BE MORE EFFICIENT FOR INTERNAL
C   USE SINCE WE CAN AVOID OVERHEAD OF FUNCTION PARSING, ETC.
C
C   COPY OF FZERO.  ADDS XTEMP AND YTEMP TO FUNCTION CALL
C   (NEEDED BY DPMLYU AND DPMLWA).
C
C***BEGIN PROLOGUE  FZERO
C***DATE WRITTEN   700901   (YYMMDD)
C***REVISION DATE  860411   (YYMMDD)
C***CATEGORY NO.  F1B
C***KEYWORDS  BISECTION,NONLINEAR,ROOTS,ZEROS
C***AUTHOR  SHAMPINE,L.F.,SNLA
C           WATTS,H.A.,SNLA
C***PURPOSE  FZERO searches for a zero of a function F(X) in a given
C            interval (B,C).  It is designed primarily for problems
C            where F(B) and F(C) have opposite signs.
C***DESCRIPTION
C
C    From the book "Numerical Methods and Software"
C       by  D. Kahaner, C. Moler, S. Nash
C           Prentice Hall 1988
C
C     Based on a method by T J Dekker
C     written by L F Shampine and H A Watts
C
C            FZERO searches for a zero of a function F(X) between
C            the given values B and C until the width of the interval
C            (B,C) has collapsed to within a tolerance specified by
C            the stopping criterion, ABS(B-C) .LE. 2.*(RW*ABS(B)+AE).
C            The method used is an efficient combination of bisection
C            and the secant rule.
C
C     Description Of Arguments
C
C     F,B,C,R,RE and AE are input parameters
C     B,C and IFLAG are output parameters (flagged by an * below)
C
C        F     - Name of the real valued external function.  This name
C                must be in an EXTERNAL statement in the calling
C                program.  F must be a function of one real argument.
C
C       *B     - One end of the interval (B,C).  The value returned for
C                B usually is the better approximation to a zero of F.
C
C       *C     - The other end of the interval (B,C)
C
C        R     - A (better) guess of a zero of F which could help in
C                speeding up convergence.  If F(B) and F(R) have
C                opposite signs, a root will be found in the interval
C                (B,R); if not, but F(R) and F(C) have opposite
C                signs, a root will be found in the interval (R,C);
C                otherwise, the interval (B,C) will be searched for a
C                possible root.  When no better guess is known, it is
C                recommended that r be set to B or C; because if R is
C                not interior to the interval (B,C), it will be ignored.
C
C        RE    - Relative error used for RW in the stopping criterion.
C                If the requested RE is less than machine precision,
C                then RW is set to approximately machine precision.
C
C        AE    - Absolute error used in the stopping criterion.  If the
C                given interval (B,C) contains the origin, then a
C                nonzero value should be chosen for AE.
C
C       *IFLAG - A status code.  User must check IFLAG after each call.
C                Control returns to the user from FZERO in all cases.
C
C                1  B is within the requested tolerance of a zero.
C                   The interval (B,C) collapsed to the requested
C                   tolerance, the function changes sign in (B,C), and
C                   F(X) decreased in magnitude as (B,C) collapsed.
C
C                2  F(B) = 0.  However, the interval (B,C) may not have
C                   collapsed to the requested tolerance.
C
C                3  B may be near a singular point of F(X).
C                   The interval (B,C) collapsed to the requested tol-
C                   erance and the function changes sign in (B,C), but
C                   F(X) increased in magnitude as (B,C) collapsed,i.e.
C                     abs(F(B out)) .GT. max(abs(F(B in)),abs(F(C in)))
C
C                4  No change in sign of F(X) was found although the
C                   interval (B,C) collapsed to the requested tolerance.
C                   The user must examine this case and decide whether
C                   B is near a local minimum of F(X), or B is near a
C                   zero of even multiplicity, or neither of these.
C
C                5  Too many (.GT. 500) function evaluations used.
C***REFERENCES  L. F. SHAMPINE AND H. A. WATTS, *FZERO, A ROOT-SOLVING
C                 CODE*, SC-TM-70-631, SEPTEMBER 1970.
C               T. J. DEKKER, *FINDING A ZERO BY MEANS OF SUCCESSIVE
C                 LINEAR INTERPOLATION*, 'CONSTRUCTIVE ASPECTS OF THE
C                 FUNDAMENTAL THEOREM OF ALGEBRA', EDITED BY B. DEJON
C                 P. HENRICI, 1969.
C***ROUTINES CALLED  R1MACH
C***END PROLOGUE  FZERO
      REAL A,ACBS,ACMB,AE,AW,B,C,CMB,ER,FA,FB,FC,FX,FZ,P,Q,R
      REAL RE,RW,T,TOL,Z
      INTEGER IC,IFLAG,KOUNT
C
      REAL YTEMP(*)
      REAL XTEMP(*)
C
      INCLUDE 'DPCOMC.INC'
      INCLUDE 'DPCOP2.INC'
C
C     ER IS TWO TIMES THE COMPUTER UNIT ROUNDOFF VALUE WHICH IS
C     DEFINED HERE BY THE FUNCTION R1MACH.
C
C***FIRST EXECUTABLE STATEMENT  FZERO
      ER = 2.0E0 * R1MACH(4)
C
C     INITIALIZE
C
      Z=R
      IF(R.LE.AMIN1(B,C).OR.R.GE.AMAX1(B,C)) Z=C
      RW=AMAX1(RE,ER)
      AW=AMAX1(AE,0.0)
      IC=0
      T=Z
      FZ=F(T,XTEMP,YTEMP)
      FC=FZ
      T=B
      FB=F(T,XTEMP,YTEMP)
      KOUNT=2
      IF(SIGN(1.0E0,FZ).EQ.SIGN(1.0E0,FB)) GO TO 1
      C=Z
      GO TO 2
    1 IF(Z.EQ.C) GO TO 2
      T=C
      FC=F(T,XTEMP,YTEMP)
      KOUNT=3
      IF(SIGN(1.0E0,FZ).EQ.SIGN(1.0E0,FC)) GO TO 2
      B=Z
      FB=FZ
    2 A=C
      FA=FC
      ACBS=ABS(B-C)
      FX=AMAX1(ABS(FB),ABS(FC))
C
    3 IF (ABS(FC) .GE. ABS(FB)) GO TO 4
C     PERFORM INTERCHANGE
      A=B
      FA=FB
      B=C
      FB=FC
      C=A
      FC=FA
C
    4 CMB=0.5*(C-B)
      ACMB=ABS(CMB)
      TOL=RW*ABS(B)+AW
C
C     TEST STOPPING CRITERION AND FUNCTION COUNT
C
      IF (ACMB .LE. TOL) GO TO 10
      IF(FB.EQ.0.E0) GO TO 11
      IF(KOUNT.GE.500) GO TO 14
C
C     CALCULATE NEW ITERATE IMPLICITLY AS B+P/Q
C     WHERE WE ARRANGE P .GE. 0.
C     THE IMPLICIT FORM IS USED TO PREVENT OVERFLOW.
C
      P=(B-A)*FB
      Q=FA-FB
      IF (P .GE. 0.) GO TO 5
      P=-P
      Q=-Q
C
C     UPDATE A AND CHECK FOR SATISFACTORY REDUCTION
C     IN THE SIZE OF THE BRACKETING INTERVAL.
C     IF NOT, PERFORM BISECTION.
C
    5 A=B
      FA=FB
      IC=IC+1
      IF (IC .LT. 4) GO TO 6
      IF (8.*ACMB .GE. ACBS) GO TO 8
      IC=0
      ACBS=ACMB
C
C     TEST FOR TOO SMALL A CHANGE
C
    6 IF (P .GT. ABS(Q)*TOL) GO TO 7
C
C     INCREMENT BY TOLERANCE
C
      B=B+SIGN(TOL,CMB)
      GO TO 9
C
C     ROOT OUGHT TO BE BETWEEN B AND (C+B)/2.
C
    7 IF (P .GE. CMB*Q) GO TO 8
C
C     USE SECANT RULE
C
      B=B+P/Q
      GO TO 9
C
C     USE BISECTION
C
    8 B=0.5*(C+B)
C
C     HAVE COMPLETED COMPUTATION FOR NEW ITERATE B
C
    9 T=B
      FB=F(T,XTEMP,YTEMP)
      KOUNT=KOUNT+1
C
C     DECIDE WHETHER NEXT STEP IS INTERPOLATION OR EXTRAPOLATION
C
      IF (SIGN(1.0,FB) .NE. SIGN(1.0,FC)) GO TO 3
      C=A
      FC=FA
      GO TO 3
C
C
C     FINISHED. PROCESS RESULTS FOR PROPER SETTING OF IFLAG
C
   10 IF (SIGN(1.0,FB) .EQ. SIGN(1.0,FC)) GO TO 13
      IF (ABS(FB) .GT. FX) GO TO 12
      IFLAG = 1
      RETURN
   11 IFLAG = 2
      RETURN
   12 IFLAG = 3
      RETURN
   13 IFLAG = 4
      RETURN
   14 IFLAG = 5
      RETURN
      END
